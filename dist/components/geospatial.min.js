(function(){var e=X3D.define,t=X3D.require;e("standard/Math/Geometry/Spheroid3",[],function(){"use strict";function e(e,t){switch(arguments.length){case 0:this.semiMajorAxis=0;this.semiMinorAxis=0;break;case 2:this.semiMajorAxis=e;this.semiMinorAxis=t;break;case 3:var i=arguments[1];this.semiMajorAxis=e;this.semiMinorAxis=e*(1-1/i);break}}e.prototype={constructor:e,getSemiMajorAxis:function(){return this.semiMajorAxis},getSemiMinorAxis:function(){return this.semiMinorAxis},toString:function(){return this.semiMajorAxis+" "+this.semiMinorAxis}};return e});e("standard/Geospatial/ReferenceEllipsoids",["standard/Math/Geometry/Spheroid3"],function(e){"use strict";var t={AA:new e(6377563.396,299.3249646,true),AM:new e(6377340.189,299.3249646,true),AN:new e(6378160,298.25,true),BN:new e(6377483.865,299.1528128,true),BR:new e(6377397.155,299.1528128,true),CC:new e(6378206.4,294.9786982,true),CD:new e(6378249.145,293.465,true),EA:new e(6377276.345,300.8017,true),EB:new e(6377298.556,300.8017,true),EC:new e(6377301.243,300.8017,true),ED:new e(6377295.664,300.8017,true),EE:new e(6377304.063,300.8017,true),EF:new e(6377309.613,300.8017,true),FA:new e(6378155,298.3,true),HE:new e(6378200,298.3,true),HO:new e(6378270,297,true),ID:new e(6378160,298.247,true),IN:new e(6378388,297,true),KA:new e(6378245,298.3,true),RF:new e(6378137,298.257222101,true),SA:new e(6378160,298.25,true),WD:new e(6378135,298.26,true),WE:new e(6378137,298.257223563,true),SUN:new e(696342e3,1/9e-6,true),MERCURY:new e(2439700,2439700),VENUS:new e(6051800,6051800),MOON:new e(1738140,1735970),MARS:new e(3395428,3377678),JUPITER:new e(71492e3,66854e3),SATURN:new e(60268e3,54364e3),URANUS:new e(2555e3,24973e3),NEPTUNE:new e(24764e3,24341e3),PLUTO:new e(1153e3,1153e3)};return t});e("standard/Geospatial/Geodetic",["standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(e,t){"use strict";var i=.001,n=1e-10,o=30;function r(e,t,i){this.longitudeFirst=!t;this.degrees=!i;this.a=e.getSemiMajorAxis();this.c=e.getSemiMinorAxis();this.c2a2=Math.pow(e.getSemiMinorAxis()/this.a,2);this.ecc2=1-this.c2a2}r.prototype={constructor:r,convert:function(e,t){var i=e.z;if(this.longitudeFirst){var n=e.y,o=e.x}else{var n=e.x,o=e.y}if(this.degrees){n*=Math.PI/180;o*=Math.PI/180}return this.convertRadians(n,o,i,t)},convertRadians:function(e,t,i,n){var o=Math.sin(e),r=Math.pow(o,2),s=Math.cos(e),a=this.a/Math.sqrt(1-this.ecc2*r),l=(a+i)*s;return n.set(l*Math.cos(t),l*Math.sin(t),(a*this.c2a2+i)*o)},apply:function(e,t){this.applyRadians(e,t);if(this.degrees){t.x*=180/Math.PI;t.y*=180/Math.PI}if(this.longitudeFirst){var i=t.x;t.x=t.y;t.y=i}return t},applyRadians:function(e,t){var r=e.x,s=e.y,a=e.z;var l=Math.sqrt(r*r+s*s);if(l==0)return t.set(Math.PI,0,a-this.c);var h=0,d=Math.atan2(s,r),u=0;var c=this.a,p=c,g=this.ecc2;for(var _=0;_<o;++_){var f=u,w=h;h=Math.atan(a/l/(1-g*p/(p+u)));var m=Math.sin(h);p=c/Math.sqrt(1-g*m*m);u=l/Math.cos(h)-p;if(Math.abs(u-f)<i&&Math.abs(h-w)<n)break}return t.set(h,d,u)},normal:function(e,t){var i=this.applyRadians(e,t);var n=i.x,o=i.y;var r=Math.cos(n);var s=Math.cos(o)*r,a=Math.sin(o)*r,l=Math.sin(n);return t.set(s,a,l)}};return r});e("standard/Geospatial/UniversalTransverseMercator",["standard/Geospatial/Geodetic","standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(e,t,i){"use strict";var n=1e7,o=5e5,r=.9996;function s(t,n,o,s){var a=t.getSemiMajorAxis(),l=1-Math.pow(t.getSemiMinorAxis()/a,2),h=l/(1-l),d=(1-Math.sqrt(1-l))/(1+Math.sqrt(1-l));this.southernHemisphere=!o;this.eastingFirst=!s;this.a=a;this.ecc2=l;this.EE=h;this.E8=8*h;this.E9=9*h;this.E252=252*h;this.e1=d;this.A=r*(a*(1-l/4-3*l*l/64-5*l*l*l/256));this.B=3*d/2-7*d*d*d/32;this.C=21*d*d/16-55*d*d*d*d/32;this.D=151*d*d*d/96;this.E=a*(1-l);this.W=1-l/4-3*l*l/64-5*l*l*l/256;this.X=3*l/8+3*l*l/32+45*l*l*l/1024;this.Y=15*l*l/256+45*l*l*l/1024;this.Z=35*l*l*l/3072;this.longitude0=i.radians(n*6-183);this.geodeticConverter=new e(t,true,true)}s.prototype={constructor:s,convert:function(e,t){if(this.eastingFirst){var i=e.y,s=e.x}else{var i=e.x,s=e.y}var a=this.southernHemisphere;if(i<0){a=!this.southernHemisphere;i=-i}if(a)i-=n;s-=o;var l=i/this.A,h=l+this.B*Math.sin(2*l)+this.C*Math.sin(4*l)+this.D*Math.sin(6*l);var d=Math.pow(Math.sin(h),2),u=Math.cos(h),c=Math.tan(h);var p=this.a/Math.sqrt(1-this.ecc2*d),g=Math.pow(c,2),_=Math.pow(c,8),f=this.EE*g,w=f*f,m=this.E/Math.pow(1-this.ecc2*d,1.5),y=s/(p*r);var x=(5+3*g+10*f-4*w-this.E9)*Math.pow(y,4)/24,O=(61+90*g+298*f+45*_-this.E252-3*w)*Math.pow(y,6)/720,S=(5-2*f+28*g-3*w+this.E8+24*_)*Math.pow(y,5)/120;var v=h-p*c/m*(y*y/2-x+O),F=this.longitude0+(y-(1+2*g+f)*Math.pow(y,3)/6+S)/u;return this.geodeticConverter.convertRadians(v,F,e.z,t)},apply:function(e,t){var i=this.geodeticConverter.applyRadians(e,t),s=i.x,a=i.y;var l=Math.tan(s),h=Math.cos(s);var d=this.EE,u=this.a/Math.sqrt(1-this.ecc2*Math.pow(Math.sin(s),2)),c=l*l,p=c*c*c,g=d*h*h,_=h*(a-this.longitude0);var f=this.a*(this.W*s-this.X*Math.sin(2*s)+this.Y*Math.sin(4*s)-this.Z*Math.sin(6*s));var w=r*u*(_+(1-c+g)*Math.pow(_,3)/6+(5-18*p+72*g-58*d)*Math.pow(_,5)/120)+o;var m=r*(f+u*l*(_*_/2+(5-c+9*g+4*g*g)*Math.pow(_,4)/24+(61-58*p+600*g-330*d)*Math.pow(_,6)/720));if(s<0){m+=n;if(!this.southernHemisphere)m=-m}else{if(this.southernHemisphere)m=-m}if(this.eastingFirst)return t.set(w,m,i.z);return t.set(m,w,i.z)}};return s});e("x_ite/Browser/Geospatial/Geocentric",["standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(e,t){"use strict";function i(){}i.prototype={constructor:i,convert:function(e,t){return t.assign(e)},apply:function(e,t){return t.assign(e)},slerp:function(e,i,n){var o=e.abs(),r=i.abs();e.normalize();i.normalize();return t.simpleSlerp(e,i,n).multiply(t.lerp(o,r,n))}};return i});e("x_ite/Browser/Geospatial/Geospatial",["standard/Geospatial/ReferenceEllipsoids","standard/Geospatial/Geodetic","standard/Geospatial/UniversalTransverseMercator","x_ite/Browser/Geospatial/Geocentric"],function(e,t,i,n){"use strict";var o=0,r=o++,s=o++,a=o++;var l={GD:r,GDC:r,UTM:s,GC:a,GCC:a,GS:a};var h=/^Z(\d+)$/;var d={GD:r,UTM:s,GC:a,getReferenceFrame:function(o,l){switch(this.getCoordinateSystem(o)){case r:{return new t(this.getEllipsoid(o),this.getLatitudeFirst(o),l)}case s:{return new i(this.getEllipsoid(o),this.getZone(o),this.getNorthernHemisphere(o),this.getNorthingFirst(o))}case a:{return new n}}return new t(e.WE,true,l)},getElevationFrame:function(e,i){return new t(this.getEllipsoid(e),true,i)},getCoordinateSystem:function(e){for(var t=0,i=e.length;t<i;++t){var n=l[e[t]];if(n!==undefined)return n}return r},getEllipsoid:function(t){for(var i=0,n=t.length;i<n;++i){var o=e[t[i]];if(o!==undefined)return o}return e.WE},getEllipsoidString:function(t){for(var i=0,n=t.length;i<n;++i){var o=e[t[i]];if(o!==undefined)return t[i]}return"WE"},isStandardOrder:function(e){switch(this.getCoordinateSystem(e)){case r:{return this.getLatitudeFirst(e)}case s:{return this.getNorthingFirst(e)}case a:{return true}}return this.getLatitudeFirst(e)},getLatitudeFirst:function(e){for(var t=0,i=e.length;t<i;++t){if(e[t]==="longitude_first")return false}return true},getNorthingFirst:function(e){for(var t=0,i=e.length;t<i;++t){if(e[t]==="easting_first")return false}return true},getZone:function(e){for(var t=0,i=e.length;t<i;++t){var n=e[t].match(h);if(n)return parseInt(n[1])}return 1},getNorthernHemisphere:function(e){for(var t=0,i=e.length;t<i;++t){if(e[t]==="S")return false}return true}};return d});e("x_ite/Components/Geospatial/X3DGeospatialObject",["x_ite/Bits/X3DConstants","x_ite/Browser/Geospatial/Geospatial","x_ite/Bits/X3DCast","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(e,t,i,n,o){"use strict";var r=new n(0,0,0),s=new n(0,0,0),a=new n(0,0,0),l=new n(0,0,0),h=new n(0,0,0),d=new n(0,0,0);function u(t){this.addType(e.X3DGeospatialObject);this.radians=false;this.origin=new n(0,0,0);this.originMatrix=new o;this.invOriginMatrix=new o}u.prototype={constructor:u,initialize:function(){this.geoSystem_.addInterest("set_geoSystem__",this);this.geoOrigin_.addInterest("set_geoOrigin__",this);this.set_geoSystem__();this.set_geoOrigin__()},set_geoSystem__:function(){this.coordinateSystem=t.getCoordinateSystem(this.geoSystem_);this.referenceFrame=t.getReferenceFrame(this.geoSystem_,this.radians);this.elevationFrame=t.getElevationFrame(this.geoSystem_,this.radians);this.standardOrder=t.isStandardOrder(this.geoSystem_)},set_geoOrigin__:function(){if(this.geoOriginNode){this.geoOriginNode.removeInterest("set_origin__",this);this.geoOriginNode.removeInterest("set_rotateYUp__",this);this.geoOriginNode.removeInterest("addNodeEvent",this)}this.geoOriginNode=i(e.GeoOrigin,this.geoOrigin_);if(this.geoOriginNode){this.geoOriginNode.addInterest("set_origin__",this);this.geoOriginNode.addInterest("set_rotateYUp__",this);this.geoOriginNode.addInterest("addNodeEvent",this)}this.set_origin__();this.set_rotateYUp__()},set_origin__:function(){if(this.geoOriginNode)this.geoOriginNode.getOrigin(this.origin);else this.origin.set(0,0,0);this.set_originMatrix__()},set_originMatrix__:function(){try{if(this.geoOriginNode){var e=this.origin;this.elevationFrame.normal(e,h);l.set(0,0,1).cross(h);if(l.equals(n.Zero))l.set(1,0,0);d.assign(l).cross(h);l.normalize();d.normalize();this.originMatrix.set(l.x,l.y,l.z,0,h.x,h.y,h.z,0,d.x,d.y,d.z,0,e.x,e.y,e.z,1);this.invOriginMatrix.assign(this.originMatrix).inverse()}}catch(e){}},set_rotateYUp__:function(){if(this.geoOriginNode&&this.geoOriginNode.rotateYUp_.getValue()){this.getCoord=c;this.getGeoCoord=p;this.getGeoUpVector=g;this.getLocationMatrix=_}else{delete this.getCoord;delete this.getGeoCoord;delete this.getGeoUpVector;delete this.getLocationMatrix}},getReferenceFrame:function(){return this.referenceFrame},getStandardOrder:function(){return this.standardOrder},getCoord:function(e,t){return this.referenceFrame.convert(e,t).subtract(this.origin)},getGeoCoord:function(e,t){return this.referenceFrame.apply(r.assign(e).add(this.origin),t)},getGeoElevation:function(e){return this.getGeoCoord(e,s).z},getGeoUpVector:function(e,t){return this.elevationFrame.normal(r.assign(e).add(this.origin),t)},getLocationMatrix:function(e,t){var i=this.origin,n=f.call(this,e,t);n[12]-=i.x;n[13]-=i.y;n[14]-=i.z;return n}};function c(e,t){return this.invOriginMatrix.multVecMatrix(this.referenceFrame.convert(e,t))}function p(e,t){return this.referenceFrame.apply(this.originMatrix.multVecMatrix(r.assign(e)),t)}function g(e,t){return this.invOriginMatrix.multDirMatrix(this.elevationFrame.normal(this.originMatrix.multVecMatrix(r.assign(e)),t))}function _(e,t){return f.call(this,e,t).multRight(this.invOriginMatrix)}function f(e,t){this.referenceFrame.convert(e,a);this.elevationFrame.normal(a,h);l.set(0,0,1).cross(h);if(l.equals(n.Zero))l.set(1,0,0);d.assign(l).cross(h);l.normalize();d.normalize();return t.set(l.x,l.y,l.z,0,h.x,h.y,h.z,0,d.x,d.y,d.z,0,a.x,a.y,a.z,1)}return u});e("x_ite/Components/Geospatial/GeoCoordinate",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DCoordinateNode","x_ite/Components/Geospatial/X3DGeospatialObject","x_ite/Bits/X3DConstants","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector3"],function(e,t,i,n,o,r,s,a){"use strict";function l(e){n.call(this,e);o.call(this,e);this.addType(r.GeoCoordinate)}l.prototype=Object.assign(Object.create(n.prototype),o.prototype,{constructor:l,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"geoOrigin",new e.SFNode),new t(r.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new t(r.inputOutput,"point",new e.MFVec3d)]),getTypeName:function(){return"GeoCoordinate"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"coord"},initialize:function(){n.prototype.initialize.call(this);o.prototype.initialize.call(this);this.point_.addInterest("set_point__",this);this.set_point__()},set_point__:function(){this.point=this.point_.getValue();this.length=this.point_.length},isEmpty:function(){return this.length===0},getSize:function(){return this.length},get1Point:function(){var e=new a(0,0,0);return function(t,i){if(t<this.length){const n=this.point;t*=3;return this.getCoord(e.set(n[t],n[t+1],n[t+2]),i)}else{return i.set(0,0,0)}}}(),addPoint:function(){var e=new a(0,0,0),t=new a(0,0,0);return function(i,n){if(i<this.length){const o=this.point;i*=3;this.getCoord(e.set(o[i],o[i+1],o[i+2]),t);n.push(t[0],t[1],t[2],1)}else{n.push(0,0,0,1)}}}(),addPoints:function(){var e=new a(0,0,0),t=new a(0,0,0);return function(i,n){const o=this.point;for(var r=0,s=this.length*3;r<s;r+=3){this.getCoord(e.set(o[r],o[r+1],o[r+2]),t);i.push(t[0],t[1],t[2],1)}for(var r=s,s=n*3;r<s;r+=3)i.push(0,0,0,1)}}(),getNormal:function(){var e=new a(0,0,0),t=new a(0,0,0),i=new a(0,0,0);return function(n,o,r){var l=this.length;if(n<l&&o<l&&r<l){return s.normal(this.get1Point(n,e),this.get1Point(o,t),this.get1Point(r,i),new a(0,0,0))}return new a(0,0,0)}}(),getQuadNormal:function(){var e=new a(0,0,0),t=new a(0,0,0),i=new a(0,0,0),n=new a(0,0,0);return function(o,r,l,h){var d=this.length;if(o<d&&r<d&&l<d&&h<d){return s.quadNormal(this.get1Point(o,e),this.get1Point(r,t),this.get1Point(l,i),this.get1Point(h,n),new a(0,0,0))}return new a(0,0,0)}}()});return l});e("x_ite/Components/Geospatial/GeoElevationGrid",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Components/Geospatial/X3DGeospatialObject","x_ite/Bits/X3DConstants","x_ite/Bits/X3DCast","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(e,t,i,n,o,r,s,a,l,h){"use strict";function d(e){n.call(this,e);o.call(this,e);this.addType(r.GeoElevationGrid);this.creaseAngle_.setUnit("angle");this.height_.setUnit("length");this.colorNode=null;this.texCoordNode=null;this.normalNode=null}d.prototype=Object.assign(Object.create(n.prototype),o.prototype,{constructor:d,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"geoOrigin",new e.SFNode),new t(r.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new t(r.initializeOnly,"geoGridOrigin",new e.SFVec3d),new t(r.initializeOnly,"xDimension",new e.SFInt32),new t(r.initializeOnly,"zDimension",new e.SFInt32),new t(r.initializeOnly,"xSpacing",new e.SFDouble(1)),new t(r.initializeOnly,"zSpacing",new e.SFDouble(1)),new t(r.inputOutput,"yScale",new e.SFFloat(1)),new t(r.initializeOnly,"solid",new e.SFBool(true)),new t(r.initializeOnly,"ccw",new e.SFBool(true)),new t(r.initializeOnly,"creaseAngle",new e.SFDouble),new t(r.initializeOnly,"colorPerVertex",new e.SFBool(true)),new t(r.initializeOnly,"normalPerVertex",new e.SFBool(true)),new t(r.inputOutput,"color",new e.SFNode),new t(r.inputOutput,"texCoord",new e.SFNode),new t(r.inputOutput,"normal",new e.SFNode),new t(r.inputOutput,"height",new e.MFDouble(0,0))]),getTypeName:function(){return"GeoElevationGrid"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this);o.prototype.initialize.call(this);this.color_.addInterest("set_color__",this);this.texCoord_.addInterest("set_texCoord__",this);this.normal_.addInterest("set_normal__",this);this.set_color__();this.set_texCoord__();this.set_normal__()},set_color__:function(){if(this.colorNode){this.colorNode.removeInterest("requestRebuild",this);this.colorNode.removeInterest("set_transparent__",this)}this.colorNode=s(r.X3DColorNode,this.color_);if(this.colorNode){this.colorNode.addInterest("requestRebuild",this);this.colorNode.addInterest("set_transparent__",this);this.set_transparent__()}else this.transparent_=false},set_transparent__:function(){this.transparent_=this.colorNode.isTransparent()},set_texCoord__:function(){if(this.texCoordNode)this.texCoordNode.removeInterest("requestRebuild",this);this.texCoordNode=s(r.X3DTextureCoordinateNode,this.texCoord_);if(this.texCoordNode)this.texCoordNode.addInterest("requestRebuild",this);this.setCurrentTexCoord(this.texCoordNode)},set_normal__:function(){if(this.normalNode)this.normalNode.removeInterest("requestRebuild",this);this.normalNode=s(r.X3DNormalNode,this.normal_);if(this.normalNode)this.normalNode.addInterest("requestRebuild",this)},getColor:function(){return this.colorNode},getTexCoord:function(){return this.texCoordNode},getNormal:function(){return this.normalNode},getHeight:function(e){if(e<this.height_.length)return this.height_[e]*this.yScale_.getValue();return 0},createTexCoords:function(){var e=[],t=this.xDimension_.getValue(),i=this.zDimension_.getValue(),n=t-1,o=i-1;for(var r=0;r<i;++r){for(var s=0;s<t;++s)e.push(new l(s/n,r/o))}return e},createNormals:function(e,t,i){var n=!this.ccw_.getValue(),o=[],r=[];for(var s=0;s<e.length;++s)o[s]=[];for(var l=0;l<t.length;l+=3){var d=t[l],u=t[l+1],c=t[l+2];o[d].push(r.length);o[u].push(r.length+1);o[c].push(r.length+2);var p=a.normal(e[d],e[u],e[c],new h(0,0,0));if(n)p.negate();r.push(p);r.push(p);r.push(p)}return this.refineNormals(o,r,this.creaseAngle_.getValue())},createCoordIndex:function(){var e=[],t=this.xDimension_.getValue(),i=this.zDimension_.getValue(),n=t-1,o=i-1;for(var r=0;r<o;++r){for(var s=0;s<n;++s){var a=r*t+s,l=(r+1)*t+s,h=(r+1)*t+(s+1),d=r*t+(s+1);e.push(a);e.push(h);e.push(l);e.push(a);e.push(d);e.push(h)}}return e},createPoints:function(){var e=[],t=this.xDimension_.getValue(),i=this.zDimension_.getValue(),n=this.xSpacing_.getValue(),o=this.zSpacing_.getValue();if(this.getStandardOrder()){for(var r=0;r<i;++r){for(var s=0;s<t;++s){var a=new h(o*r,n*s,this.getHeight(s+r*t));a.add(this.geoGridOrigin_.getValue());e.push(this.getCoord(a,a))}}}else{for(var r=0;r<i;++r){for(var s=0;s<t;++s){var a=new h(n*s,o*r,this.getHeight(s+r*t));a.add(this.geoGridOrigin_.getValue());e.push(this.getCoord(a,a))}}}return e},build:function(){if(this.xDimension_.getValue()<2||this.zDimension_.getValue()<2)return;var e=this.colorPerVertex_.getValue(),t=this.normalPerVertex_.getValue(),i=this.createCoordIndex(),n=this.getColor(),o=this.getTexCoord(),r=this.getNormal(),s=this.createPoints(),a=this.getColors(),l=this.getMultiTexCoords(),h=this.getNormals(),d=this.getVertices(),u=0;if(o){o.init(l)}else{var c=this.createTexCoords(),p=this.getTexCoords();l.push(p)}for(var g=0;g<i.length;++u){for(var _=0;_<6;++_,++g){var f=i[g],w=s[f];if(n){if(e)n.addColor(f,a);else n.addColor(u,a)}if(o){o.addTexCoord(f,l)}else{var m=c[f];p.push(m.x,m.y,0,1)}if(r){if(t)r.addVector(f,h);else r.addVector(u,h)}d.push(w.x,w.y,w.z,1)}}if(!r){var y=this.createNormals(s,i);for(var x=0;x<y.length;++x){var O=y[x];h.push(O.x,O.y,O.z)}}this.setSolid(this.solid_.getValue());this.setCCW(this.ccw_.getValue())}});return d});e("x_ite/Components/Geospatial/GeoLOD",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Components/Geospatial/X3DGeospatialObject","x_ite/Bits/X3DConstants","x_ite/Bits/TraverseType","x_ite/Components/Grouping/Group","x_ite/Components/Networking/Inline","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Box3"],function(e,t,i,n,o,r,s,a,l,h,d,u,c){"use strict";var p=new d(0,0,0);function g(e){n.call(this,e);o.call(this,e);r.call(this,e);this.addType(s.GeoLOD);this.range_.setUnit("length");this.rootGroup=new l(this.getBrowser().getPrivateScene());this.rootInline=new h(e);this.child1Inline=new h(e);this.child2Inline=new h(e);this.child3Inline=new h(e);this.child4Inline=new h(e);this.childrenLoaded=false;this.childBBox=new c;this.keepCurrentLevel=false;this.modelViewMatrix=new u}g.prototype=Object.assign(Object.create(n.prototype),o.prototype,r.prototype,{constructor:g,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.initializeOnly,"geoOrigin",new e.SFNode),new t(s.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new t(s.initializeOnly,"rootUrl",new e.MFString),new t(s.initializeOnly,"child1Url",new e.MFString),new t(s.initializeOnly,"child2Url",new e.MFString),new t(s.initializeOnly,"child3Url",new e.MFString),new t(s.initializeOnly,"child4Url",new e.MFString),new t(s.initializeOnly,"center",new e.SFVec3d),new t(s.initializeOnly,"range",new e.SFFloat(10)),new t(s.outputOnly,"level_changed",new e.SFInt32(-1)),new t(s.initializeOnly,"rootNode",new e.MFNode),new t(s.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(s.initializeOnly,"bboxCenter",new e.SFVec3f),new t(s.outputOnly,"children",new e.MFNode)]),getTypeName:function(){return"GeoLOD"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this);o.prototype.initialize.call(this);r.prototype.initialize.call(this);this.rootNode_.addFieldInterest(this.rootGroup.children_);this.rootGroup.children_=this.rootNode_;this.rootGroup.setPrivate(true);this.rootGroup.setup();this.rootInline.loadState_.addInterest("set_rootLoadState__",this);this.child1Inline.loadState_.addInterest("set_childLoadState__",this);this.child2Inline.loadState_.addInterest("set_childLoadState__",this);this.child3Inline.loadState_.addInterest("set_childLoadState__",this);this.child4Inline.loadState_.addInterest("set_childLoadState__",this);this.rootUrl_.addFieldInterest(this.rootInline.url_);this.child1Url_.addFieldInterest(this.child1Inline.url_);this.child2Url_.addFieldInterest(this.child2Inline.url_);this.child3Url_.addFieldInterest(this.child3Inline.url_);this.child4Url_.addFieldInterest(this.child4Inline.url_);this.rootInline.load_=true;this.child1Inline.load_=false;this.child2Inline.load_=false;this.child3Inline.load_=false;this.child4Inline.load_=false;this.rootInline.url_=this.rootUrl_;this.child1Inline.url_=this.child1Url_;this.child2Inline.url_=this.child2Url_;this.child3Inline.url_=this.child3Url_;this.child4Inline.url_=this.child4Url_;this.rootInline.setup();this.child1Inline.setup();this.child2Inline.setup();this.child3Inline.setup();this.child4Inline.setup()},getBBox:function(e){if(this.bboxSize_.getValue().equals(this.defaultBBoxSize)){var t=this.level_changed_.getValue();switch(this.childrenLoaded?t:0){case 0:{if(this.rootNode_.length)return this.rootGroup.getBBox(e);return this.rootInline.getBBox(e)}case 1:{e.set();e.add(this.child1Inline.getBBox(this.childBBox));e.add(this.child2Inline.getBBox(this.childBBox));e.add(this.child3Inline.getBBox(this.childBBox));e.add(this.child4Inline.getBBox(this.childBBox));return e}}return e.set()}return e.set(this.bboxSize_.getValue(),this.bboxCenter_.getValue())},set_rootLoadState__:function(){if(this.level_changed_.getValue()!==0)return;if(this.rootNode_.length)return;if(this.rootInline.checkLoadState()===s.COMPLETE_STATE){this.children_=this.rootInline.getInternalScene().getRootNodes();this.childrenLoaded=false}},set_childLoadState__:function(){var t=new e.MFNode;return function(){if(this.level_changed_.getValue()!==1)return;var e=0;if(this.child1Inline.checkLoadState()===s.COMPLETE_STATE){var i=this.child1Inline.getInternalScene().getRootNodes();for(var n=0,o=i.length;n<o;++n)t.push(i[n]);++e}else if(this.child1Inline.checkLoadState()===s.FAILED_STATE)++e;if(this.child2Inline.checkLoadState()===s.COMPLETE_STATE){var i=this.child2Inline.getInternalScene().getRootNodes();for(var n=0,o=i.length;n<o;++n)t.push(i[n]);++e}else if(this.child2Inline.checkLoadState()===s.FAILED_STATE)++e;if(this.child3Inline.checkLoadState()===s.COMPLETE_STATE){var i=this.child3Inline.getInternalScene().getRootNodes();for(var n=0,o=i.length;n<o;++n)t.push(i[n]);++e}else if(this.child3Inline.checkLoadState()===s.FAILED_STATE)++e;if(this.child4Inline.checkLoadState()===s.COMPLETE_STATE){var i=this.child4Inline.getInternalScene().getRootNodes();for(var n=0,o=i.length;n<o;++n)t.push(i[n]);++e}else if(this.child4Inline.checkLoadState()===s.FAILED_STATE)++e;if(e===4){this.childrenLoaded=true;this.children_.assign(t)}}}(),getLevel:function(e){var t=this.getDistance(e);if(t<this.range_.getValue())return 1;return 0},getDistance:function(e){e.translate(this.getCoord(this.center_.getValue(),p));return e.origin.abs()},traverse:function(e,t){if(e==a.DISPLAY){var i=this.getLevel(this.modelViewMatrix.assign(t.getModelViewMatrix().get()));if(i!==this.level_changed_.getValue()){this.level_changed_=i;switch(i){case 0:{if(this.rootNode_.length){this.children_=this.rootNode_;this.childrenLoaded=false}else{if(this.rootInline.checkLoadState()==s.COMPLETE_STATE){this.children_=this.rootInline.getInternalScene().getRootNodes();this.childrenLoaded=false}}this.child1Inline.load_=false;this.child2Inline.load_=false;this.child3Inline.load_=false;this.child4Inline.load_=false;break}case 1:{this.child1Inline.load_=true;this.child2Inline.load_=true;this.child3Inline.load_=true;this.child4Inline.load_=true;break}}}}switch(this.childrenLoaded?this.level_changed_.getValue():0){case 0:{if(this.rootNode_.length)this.rootGroup.traverse(e,t);else this.rootInline.traverse(e,t);break}case 1:{this.child1Inline.traverse(e,t);this.child2Inline.traverse(e,t);this.child3Inline.traverse(e,t);this.child4Inline.traverse(e,t);break}}}});return g});e("x_ite/Components/Geospatial/GeoLocation",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DTransformMatrix3DNode","x_ite/Components/Geospatial/X3DGeospatialObject","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4"],function(e,t,i,n,o,r,s){"use strict";var a=new s;function l(e){n.call(this,e);o.call(this,e);this.addType(r.GeoLocation)}l.prototype=Object.assign(Object.create(n.prototype),o.prototype,{constructor:l,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new t(r.inputOutput,"geoCoords",new e.SFVec3d),new t(r.initializeOnly,"geoOrigin",new e.SFNode),new t(r.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(r.initializeOnly,"bboxCenter",new e.SFVec3f),new t(r.inputOnly,"addChildren",new e.MFNode),new t(r.inputOnly,"removeChildren",new e.MFNode),new t(r.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"GeoLocation"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this);o.prototype.initialize.call(this);this.addInterest("eventsProcessed",this);this.eventsProcessed()},eventsProcessed:function(){this.setMatrix(this.getLocationMatrix(this.geoCoords_.getValue(),a))}});return l});e("x_ite/Components/Geospatial/GeoMetadata",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DInfoNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,o){"use strict";function r(e){n.call(this,e);this.addType(o.GeoMetadata)}r.prototype=Object.assign(Object.create(n.prototype),{constructor:r,fieldDefinitions:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"url",new e.MFString),new t(o.inputOutput,"summary",new e.MFString),new t(o.inputOutput,"data",new e.MFNode)]),getTypeName:function(){return"GeoMetadata"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"children"}});return r});e("x_ite/Components/Geospatial/GeoOrigin",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants","x_ite/Browser/Geospatial/Geospatial"],function(e,t,i,n,o,r){"use strict";function s(e){n.call(this,e);this.addType(o.GeoOrigin);this.radians=false}s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new t(o.inputOutput,"geoCoords",new e.SFVec3d),new t(o.initializeOnly,"rotateYUp",new e.SFBool)]),getTypeName:function(){return"GeoOrigin"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"geoOrigin"},initialize:function(){n.prototype.initialize.call(this);this.geoSystem_.addInterest("set_geoSystem__",this);this.set_geoSystem__()},set_geoSystem__:function(){this.referenceFrame=r.getReferenceFrame(this.geoSystem_,this.radians)},getOrigin:function(e){return this.referenceFrame.convert(this.geoCoords_.getValue(),e)}});return s});e("x_ite/Components/Geospatial/GeoPositionInterpolator",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Components/Geospatial/X3DGeospatialObject","x_ite/Browser/Geospatial/Geocentric","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n,o,r,s,a){"use strict";function l(e){n.call(this,e);o.call(this,e);this.addType(s.GeoPositionInterpolator);this.value_changed_.setUnit("length");this.geocentric=new r}l.prototype=Object.assign(Object.create(n.prototype),o.prototype,{constructor:l,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.initializeOnly,"geoOrigin",new e.SFNode),new t(s.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new t(s.inputOnly,"set_fraction",new e.SFFloat),new t(s.inputOutput,"key",new e.MFFloat),new t(s.inputOutput,"keyValue",new e.MFVec3d),new t(s.outputOnly,"value_changed",new e.SFVec3d),new t(s.outputOnly,"geovalue_changed",new e.SFVec3d)]),keyValue0:new a(0,0,0),keyValue1:new a(0,0,0),geovalue:new a(0,0,0),value:new a(0,0,0),getTypeName:function(){return"GeoPositionInterpolator"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"children"},setup:function(){o.prototype.initialize.call(this);n.prototype.setup.call(this)},initialize:function(){n.prototype.initialize.call(this);this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){var t=this.key_,i=this.keyValue_;if(i.length<t.length)i.resize(t.length,i.length?i[i.length-1]:new e.SFVec3f)},interpolate:function(e,t,i){try{this.getCoord(this.keyValue_[e].getValue(),this.keyValue0);this.getCoord(this.keyValue_[t].getValue(),this.keyValue1);var n=this.geocentric.slerp(this.keyValue0,this.keyValue1,i);this.geovalue_changed_=this.getGeoCoord(n,this.geovalue);this.value_changed_=n}catch(e){}}});return l});e("x_ite/Components/Geospatial/GeoProximitySensor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode","x_ite/Components/Geospatial/X3DGeospatialObject","x_ite/Components/EnvironmentalSensor/ProximitySensor","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n,o,r,s,a){"use strict";var l=new a(0,0,0);function h(e){n.call(this,e);o.call(this,e);this.addType(s.GeoProximitySensor);this.position_changed_.setUnit("length");this.centerOfRotation_changed_.setUnit("length");this.proximitySensor=new r(e);this.setCameraObject(this.proximitySensor.getCameraObject())}h.prototype=Object.assign(Object.create(n.prototype),o.prototype,{constructor:h,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.initializeOnly,"geoOrigin",new e.SFNode),new t(s.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new t(s.inputOutput,"enabled",new e.SFBool(true)),new t(s.inputOutput,"size",new e.SFVec3f),new t(s.inputOutput,"center",new e.SFVec3f),new t(s.outputOnly,"isActive",new e.SFBool),new t(s.outputOnly,"enterTime",new e.SFTime),new t(s.outputOnly,"exitTime",new e.SFTime),new t(s.outputOnly,"geoCoord_changed",new e.SFVec3d),new t(s.outputOnly,"position_changed",new e.SFVec3f),new t(s.outputOnly,"orientation_changed",new e.SFRotation),new t(s.outputOnly,"centerOfRotation_changed",new e.SFVec3f)]),getTypeName:function(){return"GeoProximitySensor"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this);o.prototype.initialize.call(this)
;this.enabled_.addFieldInterest(this.proximitySensor.enabled_);this.size_.addFieldInterest(this.proximitySensor.size_);this.center_.addFieldInterest(this.proximitySensor.center_);this.proximitySensor.isCameraObject_.addFieldInterest(this.isCameraObject_);this.proximitySensor.isActive_.addFieldInterest(this.isActive_);this.proximitySensor.enterTime_.addFieldInterest(this.enterTime_);this.proximitySensor.exitTime_.addFieldInterest(this.exitTime_);this.proximitySensor.position_changed_.addFieldInterest(this.position_changed_);this.proximitySensor.orientation_changed_.addFieldInterest(this.orientation_changed_);this.proximitySensor.centerOfRotation_changed_.addFieldInterest(this.centerOfRotation_changed_);this.proximitySensor.position_changed_.addInterest("set_position__",this);this.proximitySensor.enabled_=this.enabled_;this.proximitySensor.size_=this.size_;this.proximitySensor.center_=this.center_;this.proximitySensor.setup()},set_position__:function(e){this.geoCoord_changed_=this.getGeoCoord(this.proximitySensor.position_changed_.getValue(),l)},traverse:function(e,t){this.proximitySensor.traverse(e,t)}});return h});e("x_ite/Components/Geospatial/GeoTouchSensor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/PointingDeviceSensor/X3DTouchSensorNode","x_ite/Components/Geospatial/X3DGeospatialObject","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(e,t,i,n,o,r,s,a){"use strict";var l=new a,h=new s(0,0,0);function d(e){n.call(this,e);o.call(this,e);this.addType(r.GeoTouchSensor);this.hitPoint_changed_.setUnit("length")}d.prototype=Object.assign(Object.create(n.prototype),o.prototype,{constructor:d,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"geoOrigin",new e.SFNode),new t(r.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new t(r.inputOutput,"enabled",new e.SFBool(true)),new t(r.inputOutput,"description",new e.SFString),new t(r.outputOnly,"hitTexCoord_changed",new e.SFVec2f),new t(r.outputOnly,"hitNormal_changed",new e.SFVec3f),new t(r.outputOnly,"hitPoint_changed",new e.SFVec3f),new t(r.outputOnly,"hitGeoCoord_changed",new e.SFVec3d),new t(r.outputOnly,"isOver",new e.SFBool),new t(r.outputOnly,"isActive",new e.SFBool),new t(r.outputOnly,"touchTime",new e.SFTime)]),getTypeName:function(){return"GeoTouchSensor"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this);o.prototype.initialize.call(this)},set_over__:function(e,t,i,o,r){try{n.prototype.set_over__.call(this,e,t,i,o,r);if(this.isOver_.getValue()){var s=t.intersection;l.assign(i).inverse();this.hitTexCoord_changed_=s.texCoord;this.hitNormal_changed_=i.multMatrixDir(s.normal.copy()).normalize();this.hitPoint_changed_=l.multVecMatrix(s.point.copy());this.hitGeoCoord_changed_=this.getGeoCoord(this.hitPoint_changed_.getValue(),h)}}catch(e){console.log(e)}}});return d});e("x_ite/Components/Geospatial/GeoTransform",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DTransformMatrix3DNode","x_ite/Components/Geospatial/X3DGeospatialObject","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4"],function(e,t,i,n,o,r,s){"use strict";var a=new s,l=new s;function h(e){n.call(this,e);o.call(this,e);this.addType(r.GeoTransform);this.translation_.setUnit("length")}h.prototype=Object.assign(Object.create(n.prototype),o.prototype,{constructor:h,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"translation",new e.SFVec3f),new t(r.inputOutput,"rotation",new e.SFRotation),new t(r.inputOutput,"scale",new e.SFVec3f(1,1,1)),new t(r.inputOutput,"scaleOrientation",new e.SFRotation),new t(r.initializeOnly,"geoOrigin",new e.SFNode),new t(r.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new t(r.inputOutput,"geoCenter",new e.SFVec3d),new t(r.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(r.initializeOnly,"bboxCenter",new e.SFVec3f),new t(r.inputOnly,"addChildren",new e.MFNode),new t(r.inputOnly,"removeChildren",new e.MFNode),new t(r.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"GeoTransform"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this);o.prototype.initialize.call(this);this.addInterest("eventsProcessed",this);this.eventsProcessed()},eventsProcessed:function(){try{this.setHidden(this.scale_.x===0||this.scale_.y===0||this.scale_.z===0);this.getLocationMatrix(this.geoCenter_.getValue(),l);a.set(this.translation_.getValue(),this.rotation_.getValue(),this.scale_.getValue(),this.scaleOrientation_.getValue());this.setMatrix(a.multRight(l).multLeft(l.inverse()))}catch(e){this.setHidden(true)}}});return h});e("x_ite/Components/Geospatial/GeoViewpoint",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Navigation/X3DViewpointNode","x_ite/Components/Geospatial/X3DGeospatialObject","x_ite/Components/Interpolation/ScalarInterpolator","x_ite/Components/Navigation/NavigationInfo","x_ite/Bits/X3DConstants","standard/Math/Geometry/Camera","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Algorithm"],function(e,t,i,n,o,r,s,a,l,h,d,u,c,p){"use strict";function g(e,t){n.prototype.traverse.call(this,e,t);this.navigationInfoNode.traverse(e,t)}function _(e){n.call(this,e);o.call(this,e);this.addType(a.GeoViewpoint);this.centerOfRotation_.setUnit("length");this.fieldOfView_.setUnit("angle");this.navigationInfoNode=new s(e);this.fieldOfViewInterpolator=new r(this.getBrowser().getPrivateScene());this.projectionMatrix=new c;this.elevation=0;switch(e.specificationVersion){case"2.0":case"3.0":case"3.1":case"3.2":this.traverse=g;break}}_.prototype=Object.assign(Object.create(n.prototype),o.prototype,{constructor:_,fieldDefinitions:new i([new t(a.inputOutput,"metadata",new e.SFNode),new t(a.initializeOnly,"geoOrigin",new e.SFNode),new t(a.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new t(a.inputOnly,"set_bind",new e.SFBool),new t(a.inputOutput,"description",new e.SFString),new t(a.inputOutput,"position",new e.SFVec3d(0,0,1e5)),new t(a.inputOutput,"orientation",new e.SFRotation),new t(a.inputOutput,"centerOfRotation",new e.SFVec3d),new t(a.inputOutput,"fieldOfView",new e.SFFloat(.7854)),new t(a.inputOutput,"jump",new e.SFBool(true)),new t(a.inputOutput,"retainUserOffsets",new e.SFBool),new t(a.inputOutput,"navType",new e.MFString("EXAMINE","ANY")),new t(a.inputOutput,"headlight",new e.SFBool(true)),new t(a.initializeOnly,"speedFactor",new e.SFFloat(1)),new t(a.outputOnly,"isBound",new e.SFBool),new t(a.outputOnly,"bindTime",new e.SFTime)]),getTypeName:function(){return"GeoViewpoint"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this);o.prototype.initialize.call(this);this.position_.addInterest("set_position__",this);this.positionOffset_.addInterest("set_position__",this);this.navType_.addFieldInterest(this.navigationInfoNode.type_);this.headlight_.addFieldInterest(this.navigationInfoNode.headlight_);this.navigationInfoNode.setup();this.set_position__();this.fieldOfViewInterpolator.key_=[0,1];this.fieldOfViewInterpolator.setup();this.getEaseInEaseOut().modifiedFraction_changed_.addFieldInterest(this.fieldOfViewInterpolator.set_fraction_);this.fieldOfViewInterpolator.value_changed_.addFieldInterest(this.fieldOfViewScale_)},setInterpolators:function(e){if(e.getType().indexOf(a.GeoViewpoint)<0){this.fieldOfViewInterpolator.keyValue_=[this.fieldOfViewScale_.getValue(),this.fieldOfViewScale_.getValue()]}else{var t=e.getFieldOfView()/this.fieldOfView_.getValue();this.fieldOfViewInterpolator.keyValue_=[t,this.fieldOfViewScale_.getValue()];this.fieldOfViewScale_=t}},setPosition:function(){var e=new d(0,0,0);return function(t){this.position_.setValue(this.getGeoCoord(t,e))}}(),getPosition:function(){var e=new d(0,0,0);return function(){return this.getCoord(this.position_.getValue(),e)}}(),set_position__:function(){var e=new d(0,0,0);return function(){this.getCoord(this.position_.getValue(),e);this.elevation=this.getGeoElevation(e.add(this.positionOffset_.getValue()))}}(),setOrientation:function(){var e=new c,t=new u(0,0,1,0);return function(i){var n=this.getLocationMatrix(this.position_.getValue(),e).submatrix;t.setMatrix(n);this.orientation_.setValue(t.inverse().multLeft(i))}}(),getOrientation:function(){var e=new c,t=new u(0,0,1,0);return function(){var i=this.getLocationMatrix(this.position_.getValue(),e).submatrix;t.setMatrix(i);return t.multLeft(this.orientation_.getValue())}}(),getCenterOfRotation:function(){var e=new d(0,0,0);return function(){return this.getCoord(this.centerOfRotation_.getValue(),e)}}(),getFieldOfView:function(){var e=this.fieldOfView_*this.fieldOfViewScale_;return e>0&&e<Math.PI?e:Math.PI/4},getMaxFarValue:function(){return this.getBrowser().getRenderingProperty("LogarithmicDepthBuffer")?1e10:1e9},getUpVector:function(){var e=new d(0,0,0),t=new d(0,0,0);return function(){this.getCoord(this.position_.getValue(),e);return this.getGeoUpVector.call(this,e.add(this.positionOffset_.getValue()),t)}}(),getSpeedFactor:function(){return(Math.max(this.elevation,0)+10)/10*this.speedFactor_.getValue()},getScreenScale:function(){var e=new d(0,0,0);return function(t,i){var n=i[2],o=i[3],r=Math.abs(t.z)*Math.tan(this.getFieldOfView()/2)*2;if(n>o)r/=o;else r/=n;return e.set(r,r,r)}}(),getViewportSize:function(){var e=new h(0,0);return function(t,i){var n=t[2],o=t[3],r=i*Math.tan(this.getFieldOfView()/2)*2,s=n/o;if(s>1)return e.set(r*s,r);return e.set(r,r/s)}}(),getLookAtDistance:function(e){return e.size.abs()/2/Math.tan(this.getFieldOfView()/2)},getProjectionMatrixWithLimits:function(e,t,i,n){if(n||this.getBrowser().getRenderingProperty("LogarithmicDepthBuffer"))return l.perspective(this.getFieldOfView(),e,t,i[2],i[3],this.projectionMatrix);var o=Math.max(p.lerp(Math.min(e,1e4),1e4,this.elevation/1e7),1),r=Math.max(p.lerp(1e6,Math.max(t,1e6),this.elevation/1e7),1e6);return l.perspective(this.getFieldOfView(),o,r,i[2],i[3],this.projectionMatrix)}});return _});e(["x_ite/Configuration/SupportedNodes","x_ite/Components/Geospatial/GeoCoordinate","x_ite/Components/Geospatial/GeoElevationGrid","x_ite/Components/Geospatial/GeoLOD","x_ite/Components/Geospatial/GeoLocation","x_ite/Components/Geospatial/GeoMetadata","x_ite/Components/Geospatial/GeoOrigin","x_ite/Components/Geospatial/GeoPositionInterpolator","x_ite/Components/Geospatial/GeoProximitySensor","x_ite/Components/Geospatial/GeoTouchSensor","x_ite/Components/Geospatial/GeoTransform","x_ite/Components/Geospatial/GeoViewpoint","x_ite/Components/Geospatial/X3DGeospatialObject"],function(e,t,i,n,o,r,s,a,l,h,d,u,c){"use strict";var p={GeoCoordinate:t,GeoElevationGrid:i,GeoLOD:n,GeoLocation:o,GeoMetadata:r,GeoOrigin:s,GeoPositionInterpolator:a,GeoProximitySensor:l,GeoTouchSensor:h,GeoTransform:d,GeoViewpoint:u};var g={X3DGeospatialObject:c};for(var _ in p)e.addType(_,p[_]);for(var _ in g)e.addAbstractType(_,g[_]);return p})})();
