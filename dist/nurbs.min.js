!function(){var e=X3D.define,t=X3D.require;e("x_ite/Components/NURBS/Contour2D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants"],function(e,t,n,i,r){"use strict";function o(e){i.call(this,e),this.addType(r.Contour2D)}return o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,fieldDefinitions:new n([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"addChildren",new e.MFNode),new t(r.inputOnly,"removeChildren",new e.MFNode),new t(r.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"Contour2D"},getComponentName:function(){return"NURBS"},getContainerField:function(){return"trimmingContour"}}),o}),e("x_ite/Components/NURBS/X3DNurbsControlCurveNode",["x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function n(n){e.call(this,n),this.addType(t.X3DNurbsControlCurveNode)}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n}),n}),e("x_ite/Components/NURBS/ContourPolyline2D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/NURBS/X3DNurbsControlCurveNode","x_ite/Bits/X3DConstants"],function(e,t,n,i,r){"use strict";function o(e){i.call(this,e),this.addType(r.ContourPolyline2D)}return o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,fieldDefinitions:new n([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"controlPoint",new e.MFVec2d)]),getTypeName:function(){return"ContourPolyline2D"},getComponentName:function(){return"NURBS"},getContainerField:function(){return"children"},tessellate:function(e){var t=this.controlPoint_,n=[];if(e)for(var i=0,r=t.length;i<r;++i){var o=t[i];n.push(o.x,0,o.y)}else for(var i=0,r=t.length;i<r;++i){var o=t[i];n.push(o.x,o.y)}return n}}),o}),e("x_ite/Components/NURBS/CoordinateDouble",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DCoordinateNode","x_ite/Bits/X3DConstants"],function(e,t,n,i,r){"use strict";function o(e){i.call(this,e),this.addType(r.CoordinateDouble)}return o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,fieldDefinitions:new n([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"point",new e.MFVec3d)]),getTypeName:function(){return"CoordinateDouble"},getComponentName:function(){return"NURBS"},getContainerField:function(){return"coord"}}),o}),e("x_ite/Browser/NURBS/NURBS",["standard/Math/Numbers/Vector3"],function(e){"use strict";return{getTessellation:function(e,t){return e>0?e+1:e<0?-e*t+1:2*t+1},getClosed2D:function(e,t,n,i){var r=i.length;return!(n.length===r&&n[0]!==n[r-1]||!i[0].equals(i[r-1])||!this.isPeriodic(e,r,t))},getClosed:function(){var t=new e(0,0,0),n=new e(0,0,0);return function(e,i,r,o){var s=o.getSize();return!(r.length===s&&r[0]!==r[s-1]||!o.get1Point(0,t).equals(o.get1Point(s-1,n))||!this.isPeriodic(e,s,i))}}(),getUClosed:function(){var t=new e(0,0,0),n=new e(0,0,0);return function(e,i,r,o,s,u){for(var a=s.length===u.getSize(),l=0,c=r;l<c;++l){var h=l*i,d=l*i+i-1;if(a&&s[h]!==s[d])return!1;if(!u.get1Point(h,t).equals(u.get1Point(d,n)))return!1}return!!this.isPeriodic(e,i,o)}}(),getVClosed:function(){var t=new e(0,0,0),n=new e(0,0,0);return function(e,i,r,o,s,u){for(var a=s.length===u.getSize(),l=0,c=i;l<c;++l){var h=l,d=(r-1)*i+l;if(a&&s[h]!==s[d])return!1;if(!u.get1Point(h,t).equals(u.get1Point(d,n)))return!1}return!!this.isPeriodic(e,r,o)}}(),isPeriodic:function(e,t,n){if(n.length===t+e){for(var i=1,r=1,o=e;r<o;++r)i+=n[r]===n[0];if(i===e)return!1;for(var i=1,r=n.length-e,o=n.length-1;r<o;++r)i+=n[r]===n[o];if(i===e)return!1}return!0},getKnots:function(e,t,n,i){for(var r=[],o=0,s=i.length;o<s;++o)r.push(i[o]);var u=!0;if(r.length===n+t){u=!1;for(var a=0,o=1,s=r.length;o<s;++o)r[o]==r[o-1]?++a:a=0,a>t-1&&(u=!0),r[o-1]>r[o]&&(u=!0)}if(u)for(var o=0,s=n+t;o<s;++o)r[o]=o/(s-1);if(e)for(var o=1,s=t-1;o<s;++o)r.push(r[r.length-1]+(r[o]-r[o-1]));return r},getWeights:function(e,t,n,i){if(i.length===n){for(var r=[],o=0;o<n;++o)r.push(i[o]);if(e)for(var o=1,s=t-1;o<s;++o)r.push(r[o]);return r}},getUVWeights:function(e,t,n,i,r,o,s){if(s.length===r*o){for(var u=[],a=0;a<r;++a){var l=[];u.push(l);for(var c=0;c<o;++c)l.push(s[c*r+a]);if(t)for(var h=1,d=i-1;h<d;++h)l.push(l[h])}if(e)for(var h=1,d=n-1;h<d;++h)u.push(u[h]);return u}},getControlPoints2D:function(){new e(0,0,0);return function(e,t,n){for(var i=[],r=n.length,o=0;o<r;++o){var s=n[o];i.push([s.x,s.y,0])}if(e)for(var o=1,u=t-1;o<u;++o)i.push(i[o]);return i}}(),getControlPoints:function(){var t=new e(0,0,0);return function(e,n,i){for(var r=[],o=i.getSize(),s=0;s<o;++s)r.push(Array.prototype.slice.call(i.get1Point(s,t)));if(e)for(var s=1,u=n-1;s<u;++s)r.push(r[s]);return r}}(),getUVControlPoints:function(){var t=new e(0,0,0);return function(e,n,i,r,o,s,u){for(var a=[],l=0;l<o;++l){var c=[];a.push(c);for(var h=0;h<s;++h)c.push(Array.prototype.slice.call(u.get1Point(h*o+l,t)));if(n)for(var d=1,p=r-1;d<p;++d)c.push(c[d])}if(e)for(var d=1,p=i-1;d<p;++d)a.push(a[d]);return a}}()}}),e("x_ite/Components/NURBS/X3DParametricGeometryNode",["x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DConstants","x_ite/Browser/NURBS/NURBS"],function(e,t,n){"use strict";function i(n){e.call(this,n),this.addType(t.X3DParametricGeometryNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,getKnots:function(e,t,i,r){return n.getKnots(e,t,i,r)}}),i}),e("nurbs/src/utils/is-ndarray",[],function(){"use strict";return function(e){return!!e&&(!!e.dtype&&new RegExp("function View[0-9]+d(:?"+e.dtype+")+").test(String(e.constructor)))}}),e("nurbs/src/utils/is-ndarray-like",[],function(){"use strict";return function(e){return!!e&&(void 0!==e.data&&Array.isArray(e.shape)&&void 0!==e.offset&&void 0!==e.stride)}}),e("nurbs/src/utils/is-array-like",[],function(){"use strict";return function(e){return Array.isArray(e)||ArrayBuffer.isView(e)||void 0!==e.length}}),e("nurbs/src/utils/infer-type",["nurbs/src/utils/is-ndarray","nurbs/src/utils/is-ndarray-like","nurbs/src/utils/is-array-like"],function(e,t,n){"use strict";function i(r){if(r){if(e(r)||t(r))return"generic"===r.dtype?i.GENERIC_NDARRAY:i.NDARRAY;if(n(r))return i.ARRAY_OF_ARRAYS;throw new Error("Unhandled data type. Got type: "+typeof r)}}return i.ARRAY_OF_ARRAYS="Arr",i.NDARRAY="Nd",i.GENERIC_NDARRAY="GenNd",i.PACKED="PackArr",i}),e("nurbs/src/utils/cache-key",["nurbs/src/utils/is-array-like"],function(e){"use strict";function t(e){return e[0].toUpperCase()+e.slice(1)}return function(n,i,r,o,s,u){var a,l=[],c=!1;for(a=0;a<n.splineDimension;a++){var h=e(n.knots)&&e(n.knots[a]);h&&(c=!0),l.push("Deg"+n.degree[a]+(h?"":"Uniform")+t(n.boundary[a]))}var d=[[c?"NU":"",n.weights?"RBS":"BS"].join("")+n.dimension+"D",l.join("_")];return o&&d.push(o+"Pts"),s&&d.push(s+"Wts"),u&&d.push(u+"Kts"),i&&d.push("debug"),r&&d.push("chk"),d.join("_")}}),e("nurbs/src/utils/variable",[],function(){"use strict";var e=function e(t,n){return function(n,i){void 0===n||Array.isArray(n)||(n=[n]);for(var r=[],o=0;o<n.length;o++)r.push(e.sum(n[o]));if(i)for(n=0;n<r.length;n++)void 0!==i[n]&&(r[n]="("+r[n]+" + "+i[n]+") % "+i[n]);return t+r.join("_")}};return e.sum=function(e){return e=Array.isArray(e)?e:[e],e=e.filter(function(e){return void 0!==e&&0!==e}),0===e.length&&e.push(0),e.join(" + ")},e}),e("nurbs/src/utils/create-accessors",["nurbs/src/utils/infer-type","nurbs/src/utils/variable"],function(e,t){"use strict";function n(e){return function(n,i){void 0===n||Array.isArray(n)||(n=[n]);for(var r=[],o=0;o<n.length;o++)r.push(t.sum(n[o]));if(i)for(n=0;n<r.length;n++)void 0!==i[n]&&(r[n]="("+r[n]+" + "+i[n]+") % "+i[n]);return e(r)}}function i(t,i){var r;if(i)switch(e(i)){case e.ARRAY_OF_ARRAYS:return n(function(e){return t+"["+e.join("][")+"]"});case e.GENERIC_NDARRAY:return n(function(e){return t+".get("+e.join(",")+")"});case e.NDARRAY:return n(function(e){var n=[t+"Offset"];for(r=0;r<e.length;r++)n.push(t+"Stride"+r+" * ("+e[r]+")");return t+"["+n.join(" + ")+"]"});case e.PACKED:default:return}}return function(e){var t,n={};return t=i("x",e.points),t&&(n.point=t),t=i("w",e.weights),t&&(n.weight=t),t=i("k",e.knots),t&&(n.knot=t),n}}),e("nurbs/src/numerical-derivative",[],function(){"use strict";var e=[],t=[];return function(n,i,r){if(1!==i)throw new Error("Numerical derivative not implemented for order n = "+i+".");var o,s=void 0===arguments[this.splineDimension+3]?1e-4:arguments[this.splineDimension+3];for(e.length=this.splineDimension,o=0;o<this.splineDimension;o++)e[o+1]=arguments[o+3];var u,a,l,c=this.domain,h=c[r][0],d=c[r][1],p=e[r+1],f=(d-h)*s;for("closed"===this.boundary[r]?(l=d-h,u=h+(p-h-f+l)%l,a=h+(p-h+f+l)%l,f*=2):(u=Math.min(d,Math.max(h,p-f)),a=Math.min(d,Math.max(h,p+f)),f=a-u),e[r+1]=u,e[0]=t,this.evaluate.apply(null,e),e[r+1]=a,e[0]=n,this.evaluate.apply(null,e),o=0;o<this.dimension;o++)n[o]=(n[o]-t[o])/f;return n}}),e("nurbs/src/utils/ndloop",[],function(){"use strict";return function(e,t){for(var n=1,i=0,r=[];i<e.length;i++)n*=Array.isArray(e[i])?e[i][1]-e[i][0]:e[i],r[i]=Array.isArray(e[i])?e[i][0]:0;for(var o=0;o<n;o++)for(t(r.slice()),i=e.length-1;i>=0;i--){if(r[i]!==(Array.isArray(e[i])?e[i][1]:e[i])-1){r[i]++;break}r[i]=Array.isArray(e[i])?e[i][0]:0}}}),e("nurbs/src/utils/accessor-preamble",["nurbs/src/utils/infer-type"],function(e){"use strict";return function(t,n,i,r){var o=[];switch(e(r)){case e.NDARRAY:o.push("  var "+n+" = "+i+".data;"),o.push("  var "+n+"Offset = "+i+".offset;");for(var s=0;s<r.dimension;s++)o.push("  var "+n+"Stride"+s+" = "+i+".stride["+s+"];");break;case e.ARRAY_OF_ARRAYS:o.push("  var "+n+" = "+i+";")}return o.join("\n")}}),e("nurbs/src/utils/size-getter",["nurbs/src/utils/is-ndarray-like"],function(e){"use strict";return function(t,n,i){if(t){if(e(t))return n+".shape["+i+"]";for(var r=n,o=0;o<i;o++)r+="[0]";return r+".length"}return"this.size["+i+"]"}}),e("nurbs/src/evaluate",["nurbs/src/utils/ndloop","nurbs/src/utils/variable","nurbs/src/utils/accessor-preamble","nurbs/src/utils/infer-type","nurbs/src/utils/is-array-like","nurbs/src/utils/size-getter"],function(e,t,n,i,r,o){"use strict";var s={},u={};return function(a,l,c,h,d,p,f){function g(e){V.push("  "+(e||""))}function _(e){h&&g(e)}function m(e,t,n){return"("+e+") ? ("+t+") : ("+n+")"}var v,w,y,b,N,C,S=l.splineDimension,D=l.points,O=l.degree,x=l.weights,F=void 0!==x,B=l.knots,R=l.dimension,P=l.boundary;if(void 0!==f&&null!==f){Array.isArray(f)||(f=[f]);var A=0;for(v=0;v<S;v++)void 0===f[v]&&(f[v]=0),A+=f[v];if(F&&A>1)throw new Error("Analytical derivative not implemented for rational b-splines with order n = "+A+".")}p&&(a="Basis"+a),f&&(a="Der"+f.join("_")+"_"+a);var j=s[a];if(h)var z="function"==typeof h?h:console.log;if(j)return h&&z(u[a]),j.bind(l);var V=[],k="evaluate"+a,T=c.point;p&&(T=function(e,t){for(var n=[],i=0;i<e.length;i++){for(var r=e[i],o=[],s=0;s<r.length;s++)0!==r[s]&&o.push(r[s]);r=o.join(" + "),t[i]&&(r="("+r+" + "+t[i]+") % "+t[i]),n.push(r+" === "+E(i))}return"(("+n.join(" && ")+") ? 1 : 0)"});var I=c.weight,U=c.knot,X=t("k"),M=t("x"),G=t("w"),E=t("i"),K=t("t"),Y=h?"domain":"d",q=t(h?"size":"s"),W=t(h?"knotIndex":"j"),L=!0;for(N=0;N<S;N++)r(B)&&r(B[N])&&(L=!1);if(p)var H=[];var J=[];for(v=0;v<S;v++)p&&H.push(E([v])),J.push(K([v]));for(V.push("function "+k+" ("+(p?"":"out, ")+J.join(", ")+(p?", "+H.join(", "):"")+") {"),g("var h, m, a, b;"),d&&(g("var "+Y+" = this.domain;"),g("for (var i = 0; i < this.splineDimension; i++) {"),g("  a = arguments[i + 1];"),g("  if (a < "+Y+"[i][0] || a > "+Y+"[i][1] || a === undefined || isNaN(a)) {"),g("    throw new Error('Invalid Spline parameter in dimension '+i+'. Valid domain is ['+"+Y+"[i][0]+', '+"+Y+"[i][1]+']. but got t'+i+' = '+arguments[i + 1]+'.');"),g("  }"),g("}")),N=0;N<S;N++)g("var "+q(N)+" = "+o(D,"this.points",N)+";");V.push(n(l,"x","this.points",D)),F&&V.push(n(l,"w","this.weights",x)),L||V.push(n(l,"k","this.knots",B));var Q=[];for(N=0;N<S;N++)switch(i(B)){case i.NDARRAY:Q[N]=!0;break;case i.ARRAY_OF_ARRAYS:Q[N]=r(B[N])}for(N=0;N<S;N++)if(Q[N])for(_("\n  // Bisect to locate the knot interval in dimension "+N+"\n"),g("var "+W(N)+" = 0;"),g("h = "+q(N)+";"),g("while(h > "+W(N)+" + 1) {"),g("  m = 0.5 * (h + "+W(N)+") | 0;"),g("  if ("+U([N,"m"])+" > "+K(N)+") h = m;"),g("  else "+W(N)+" = m;"),g("}"),_("\n  // Fetch knots for dimension "+N+"\n"),v=1-O[N];v<=O[N];v++)g("closed"===P[N]?v<0?"var "+X([N,v+O[N]-1])+" = "+m(W(N)+" < "+-v,U([N,0])+" + "+U([N,[q(N),W(N),v]])+" - "+U([N,[q(N)]]),U([N,[W(N),v]]))+";":v>0?"var "+X([N,v+O[N]-1])+" = "+m(W(N)+" + "+v+" > "+q(N),U([N,q(N)])+" + "+U([N,v+" + "+W(N)+" - "+q(N)])+" - "+U([N,0]),U([N,[W(N),v]]))+";":"var "+X([N,v+O[N]-1])+" = "+U([N,[W(N),v]])+";":"var "+X([N,v+O[N]-1])+" = "+U([N,[W(N),v]])+";");else{for(_("\n  // Directly compute knot interval for dimension "+N+"\n"),"closed"===P[N]?g(W(N)+" = ("+K(N)+" | 0) % "+q(N)+";"):(g(W(N)+" = ("+K(N)+" | 0);"),g("if ("+W(N)+" < "+O[N]+") "+W(N)+" = "+O[N]+";"),g("if ("+W(N)+" > "+q(N)+" - 1) "+W(N)+" = "+q(N)+" - 1;")),_("\n  // Compute and clamp knots for dimension "+N+"\n"),v=1-O[N];v<=O[N];v++)C=X([N,v+O[N]-1]),g("var "+C+" = "+W(N)+" + "+v+";");if("clamped"===P[N])for(v=1-O[N];v<=O[N];v++)C=X([N,v+O[N]-1]),v<0&&g("if ("+C+" < "+O[N]+") "+C+" = "+O[N]+";"),v>0&&g("if ("+C+" > "+q(N)+") "+C+" = "+q(N)+";");"closed"===P[N]&&(_("\n  // Wrap the B-Spline parameter for closed boundary"),g(K(N)+" %= "+q(N)+";"))}for(N=0,y=[];N<S;N++)y[N]=O[N]+1;for(F&&(_("\n  // Fetch weights\n"),e(y,function(e){for(var t=[],n=[],i=0;i<S;i++)t[i]=[W(i),e[i]-O[i]],"closed"===P[i]&&e[i]-O[i]<0&&(n[i]=q(i));g("var "+G(e)+" = "+I(t,n)+";")})),h&&g(F?"\n  // Fetch points and project into homogeneous (weighted) coordinates\n":"\n  // Fetch points\n"),e(y,function(e){for(var t=[],n=[],i=0;i<S;i++)t[i]=[W(i),e[i]-O[i]],"closed"===P[i]&&e[i]-O[i]<0&&(n[i]=q(i));if(p)g(F?"var "+M(e)+" = "+T(t,n)+" * "+G(e)+";":"var "+M(e)+" = "+T(t,n)+";");else for(i=0;i<R;i++){var r=e.concat(i);t[S]=i,g(F?"var "+M(r)+" = "+T(t,n)+" * "+G(e)+";":"var "+M(r)+" = "+T(t,n)+";")}}),_("\n"),_("// Perform De Boor's algorithm"),N=y.length-1;N>=0;N--)for(y[N]=[O[N],O[N]+1],v=0;v<O[N];v++)for(_("\n  // Degree "+O[N]+" evaluation in dimension "+N+", step "+(v+1)+"\n"),w=O[N];w>v;w--){var Z=f&&O[N]-v-f[N]<=0;Z?(g("m = 1 / ("+X([N,w-v+O[N]-1])+" - "+X([N,w-1])+");"),F&&(g("a = ("+K(N)+" - "+X([N,w-1])+") * m;"),g("b = 1 - a;"))):(g("a = ("+K(N)+" - "+X([N,w-1])+") / ("+X([N,w-v+O[N]-1])+" - "+X([N,w-1])+");"),g("b = 1 - a;")),F&&e(y,function(e){var t=e.slice(),n=e.slice();t[N]=w,n[N]=w-1,Z&&F&&g("h = "+G(t)+";"),g(G(t)+" = b * "+G(n)+" + a * "+G(t)+";")}),e(y,function(e){var t,n,i,r=e.slice(),o=e.slice();if(r[N]=w,o[N]=w-1,Z){var s=v+1;if(p)t=F?"h * "+G(o)+" / "+G(r)+" * ":"",n=M(r)+(F?" / h":""),i=M(o)+(F?" / "+G(o):""),g(M(r)+" = "+s+" * "+t+"("+n+" - "+i+") * m;");else{var u=r.slice(),a=o.slice();for(b=0;b<R;b++)u[S]=a[S]=b,t=F?"h * "+G(o)+" / "+G(r)+" * ":"",n=M(u)+(F?" / h":""),i=M(a)+(F?" / "+G(o):""),g(M(u)+" = "+s+" * "+t+"("+n+" - "+i+") * m;")}}else if(p)g(M(r)+" = b * "+M(o)+" + a * "+M(r)+";");else for(b=0;b<R;b++)r[S]=o[S]=b,g(M(r)+" = b * "+M(o)+" + a * "+M(r)+";")}),_("\n")}if(h&&g(F?"\n  // Project back from homogeneous coordinates and return final output\n":"\n  // Return final output\n"),p)g(F?"return "+M(O)+" / "+G(O)+";":"return "+M(O)+";");else for(N=0;N<R;N++)g(F?"out["+N+"] = "+M(O.concat([N]))+" / "+G(O)+";":"out["+N+"] = "+M(O.concat([N]))+";");if(p||g("return out;"),V.push("}"),h){var $=V.join("\n");z($),u[a]=$}var ee=new Function([V.join("\n"),"; return ",k].join(""))();return s[a]=ee,ee.bind(l)}}),e("nurbs/src/transform",["nurbs/src/utils/accessor-preamble","nurbs/src/utils/size-getter","nurbs/src/utils/variable"],function(e,t,n){"use strict";var i={};return function(r,o,s,u){var a,l,c,h,d,p,f,g,_=i[r];if(_)return _.bind(o);var m=[],v="transform"+r;m.push("function "+v+"(m) {"),m.push("var i, w;"),m.push(e(o,"x","this.points",o.points));var w=n(u?"size":"s");for(a=0;a<o.splineDimension;a++)m.push("var "+w(a)+" = "+t(o.points,"this.points",a)+";");for(h=[],a=0;a<o.splineDimension;a++)c="i"+a,h.push(c),m.push("for ("+c+" = "+w(a)+"- 1; "+c+" >= 0; "+c+"--) {");for(a=0;a<o.dimension;a++)m.push("x"+a+" = "+s.point(h.concat([a])));for(d=[],a=0;a<o.dimension;a++)d.push("m["+((o.dimension+1)*(a+1)-1)+"] * x"+a);for(d.push("m["+((o.dimension+1)*(o.dimension+1)-1)+"]"),m.push("var w = ("+d.join(" + ")+") || 1.0;"),a=0;a<o.dimension;a++){for(d=[],p=o.dimension,l=0;l<p;l++)d.push("m["+(l*(p+1)+a)+"] * x"+l);d.push("m["+(l*(p+1)+a)+"]"),g=s.point(h.concat([a])),f="("+d.join(" + ")+") / w",m.push(g+" = "+f+";")}for(a=o.splineDimension-1;a>=0;a--)m.push("}");m.push("return this;"),m.push("}");var y=new Function([m.join("\n"),"; return ",v].join(""))();return u&&console.log(m.join("\n")),i[r]=y,y.bind(o)}}),e("nurbs/src/support",["nurbs/src/utils/ndloop","nurbs/src/utils/variable","nurbs/src/utils/accessor-preamble","nurbs/src/utils/infer-type","nurbs/src/utils/is-array-like","nurbs/src/utils/size-getter"],function(e,t,n,i,r,o){"use strict";var s={};return function(u,a,l,c,h){function d(e){N.push("  "+(e||""))}function p(e,t){d(void 0===t?"out["+P+++"] = "+e.join(" + ")+";":"out["+P+++"] = ("+e.join(" + ")+" + "+t+") % "+t+";")}var f=s[u];if(f)return f.bind(a);var g,_,m,v=a.degree,w=a.knots,y=a.splineDimension,b=a.boundary,N=[],C="support"+u,S=l.knot,D=t("t"),O=c?"domain":"d",x=t(c?"size":"s"),F=t(c?"knotIndex":"i"),B=!0;for(m=0;m<y;m++)r(w)&&r(w[m])&&(B=!1);var R=[];for(g=0;g<y;g++)R.push(D([g]));N.push("function "+C+" (out, "+R.join(", ")+") {");var P=0;for(d("var h, m;"),d("var c = 0;"),h&&(d("var "+O+" = this.domain;"),d("for (var i = 0; i < this.splineDimension; i++) {"),d("  a = arguments[i + 1];"),d("  if (a < "+O+"[i][0] || a > "+O+"[i][1] || a === undefined || isNaN(a)) {"),d("    throw new Error('Invalid Spline parameter in dimension '+i+'. Valid domain is ['+"+O+"[i][0]+', '+"+O+"[i][1]+']. but got t'+i+' = '+arguments[i + 1]+'.');"),d("  }"),d("}")),m=0;m<y;m++)d("var "+x(m)+" = "+o(a.points,"this.points",m)+";");B||N.push(n(a,"k","this.knots",w));var A=[];for(m=0;m<y;m++)switch(i(w)){case i.NDARRAY:A[m]=!0;break;case i.ARRAY_OF_ARRAYS:A[m]=r(w[m])}for(m=0;m<y;m++)A[m]?(d("var "+F(m)+" = 0;"),d("h = "+x(m)+";"),d("while(h > "+F(m)+" + 1) {"),d("  m = 0.5 * (h + "+F(m)+") | 0;"),d("  if ("+S([m,"m"])+" > "+D(m)+") h = m;"),d("  else "+F(m)+" = m;"),d("}")):"closed"===b[m]?d(F(m)+" = ("+D(m)+" | 0) % "+x(m)+";"):(d(F(m)+" = ("+D(m)+" | 0);"),d("if ("+F(m)+" < "+v[m]+") "+F(m)+" = "+v[m]+";"),d("if ("+F(m)+" > "+x(m)+" - 1) "+F(m)+" = "+x(m)+" - 1;"));for(m=0,_=[];m<y;m++)_[m]=v[m]+1;e(_,function(e){for(var t=[],n=[],i=0;i<y;i++)t[i]=[F(i),e[i]-v[i]],"closed"===b[i]&&e[i]-v[i]<0&&(n[i]=x(i));for(i=0;i<y;i++)p(t[i],n[i])}),d("out.length = "+P+";"),d("return out;"),N.push("}"),c&&console.log(N.join("\n"));var j=new Function([N.join("\n"),"; return ",C].join(""))();return s[u]=j,j.bind(a)}}),e("nurbs/extras/sample",[],function(){"use strict";function e(e,t){var n=t[0],i=t[1],r=t[2],o=Math.sqrt(n*n+i*i+r*r);return o>0&&(e[0]=t[0]/o,e[1]=t[1]/o,e[2]=t[2]/o),e}function t(e,t,n){var i=t[0],r=t[1],o=t[2],s=n[0],u=n[1],a=n[2];return e[0]=r*a-o*u,e[1]=o*s-i*a,e[2]=i*u-r*s,e}var n=[],i=[];return function(r,o,s){r=r||{},s=s||{};var u=r.points=r.points||[],a=r.normals=r.normals||[],l=r.faces=r.faces||[];if(Array.isArray(s.resolution))var c=s.resolution;else var h=void 0===s.resolution?31:s.resolution,c=new Array(o.splineDimension).fill(h);switch(o.splineDimension){case 1:for(var d=c[0],p=d+("closed"!==o.boundary[0]),f=3*p,g=o.evaluator([1,0]),_=o.domain,m=_[0],v=0;v<p;++v){var w=m[0]+(m[1]-m[0])*v/d,y=3*v;o.evaluate(n,w),u[y]=n[0],u[y+1]=n[1],u[y+2]=n[2]}u.length=f;break;case 2:for(var d=c[0],b=c[1],p=d+("closed"!==o.boundary[0]),N=b+("closed"!==o.boundary[1]),f=p*N*3,g=o.evaluator([1,0]),C=o.evaluator([0,1]),_=o.domain,m=_[0],S=_[1],v=0;v<p;++v)for(var w=m[0]+(m[1]-m[0])*v/d,D=0;D<N;++D){var O=S[0]+(S[1]-S[0])*D/b,y=3*(v+p*D);o.evaluate(n,w,O),u[y]=n[0],u[y+1]=n[1],u[y+2]=n[2],e(n,t(n,g(n,w,O),C(i,w,O))),a[y]=n[0],a[y+1]=n[1],a[y+2]=n[2]}a.length=f,u.length=f;for(var x=0,v=0;v<d;++v){var F=v,B=v+1;"closed"===o.boundary[0]&&(B%=d);for(var D=0;D<b;++D){var R=D,P=D+1;"closed"===o.boundary[1]&&(P%=b),l[x++]=F+p*R,l[x++]=B+p*R,l[x++]=B+p*P,l[x++]=F+p*R,l[x++]=B+p*P,l[x++]=F+p*P}}l.length=x;break;default:throw new Error("Can only sample curves and surfaces")}return r}}),e("nurbs/nurbs",["nurbs/src/utils/infer-type","nurbs/src/utils/cache-key","nurbs/src/utils/is-ndarray","nurbs/src/utils/is-ndarray-like","nurbs/src/utils/create-accessors","nurbs/src/numerical-derivative","nurbs/src/utils/is-array-like","nurbs/src/evaluate","nurbs/src/transform","nurbs/src/support","nurbs/extras/sample"],function(e,t,n,i,r,o,s,u,a,l,c){"use strict";function h(e){return void 0===e||null===e}function d(i,c,d,p,f,_){var m,v;!i||s(i)||n(i)?(_=_||{},this.weights=p,this.knots=d,this.degree=c,this.points=i,this.boundary=f,this.debug=_.debug,this.checkBounds=!!_.checkBounds,Object.defineProperty(this,"size",{value:_.size,writable:!0,configurable:!0})):(_=i,this.debug=i.debug,this.checkBounds=!!i.checkBounds,this.weights=i.weights,this.knots=i.knots,this.degree=i.degree,this.boundary=i.boundary,this.points=i.points,Object.defineProperty(this,"size",{value:_.size,writable:!0,configurable:!0}));var w=e(this.points),y=e(this.weights),b=e(this.knots);if(this.points)switch(w){case e.GENERIC_NDARRAY:case e.NDARRAY:Object.defineProperties(this,{splineDimension:{value:this.points.shape.length-1,writable:!1,configurable:!0},dimension:{value:this.points.shape[this.points.shape.length-1],writable:!1,configurable:!0},size:{get:function(){return this.points.shape.slice(0,this.points.shape.length-1)},set:function(){throw new Error("Cannot assign to read only property 'size'")},configurable:!0}});break;case e.ARRAY_OF_ARRAYS:var N=0,C=this.size||[];C.length=0;for(var S=this.points;s(S[0]);S=S[0])N++,C.push(S.length);if(0===N)throw new Error("Expected an array of points");Object.defineProperties(this,{splineDimension:{value:N,writable:!1,configurable:!0},dimension:{value:S.length,writable:!1,configurable:!0},size:{get:function(){var e=[];e.length=0;for(var t=0,n=this.points;t<this.splineDimension;t++,n=n[0])e[t]=n.length;return e},set:function(){throw new Error("Cannot assign to read only property 'size'")},configurable:!0}});break;case e.PACKED:default:throw new Error("Expected either a packed array, array of arrays, or ndarray of points")}else{if(void 0===this.size||null===this.size)throw new Error("Either points or a control hull size must be provided.");if(s(this.size)||Object.defineProperty(this,"size",{value:[this.size],writable:!0,configurable:!0}),0===this.size.length)throw new Error("`size` must be a number or an array of length at least one.");Object.defineProperties(this,{splineDimension:{value:this.size.length,writable:!1,configurable:!0},dimension:{value:0,writable:!1,configurable:!0}})}if(s(this.degree)){for(m=0;m<this.splineDimension;m++)if(h(this.degree[m]))throw new Error("Missing degree in dimension "+(m+1))}else{var D=!h(this.degree),O=h(this.degree)?2:this.degree;for(this.degree=[],m=0;m<this.splineDimension;m++)if(this.size[m]<=O){if(D)throw new Error("Expected at least "+(O+1)+" points for degree "+O+" spline in dimension "+(m+1)+" but got only "+this.size[m]);this.degree[m]=this.size[m]-1}else this.degree[m]=O}if(v="string"!=typeof this.boundary?"open":this.boundary,!g[v])throw new Error("Boundary type must be one of "+Object.keys(g)+". Got "+v);for(this.boundary=s(this.boundary)?this.boundary:[],this.boundary.length=this.splineDimension,m=0;m<this.splineDimension;m++)if(this.boundary[m]=h(this.boundary[m])?v:this.boundary[m],!g[v])throw new Error("Boundary type must be one of "+Object.keys(g)+". Got "+v+" for dimension "+(m+1));switch(b){case e.ARRAY_OF_ARRAYS:for(s(this.knots)&&this.knots.length>0&&!s(this.knots[0])&&(this.knots=[this.knots]),m=0;m<this.splineDimension;m++){if(this.size[m]<=this.degree[m])throw new Error("Expected at least "+(this.degree[m]+1)+" points in dimension "+(m+1)+" but got "+this.size[m]+".");if(s(this.knots[m])){if("closed"!==this.boundary[m]&&this.knots[m].length!==this.degree[m]+this.size[m]+1)throw new Error("Expected "+(this.degree[m]+this.size[m]+1)+" knots in dimension "+(m+1)+" but got "+this.knots[m].length+".");if("closed"===this.boundary[m]&&this.knots[m].length!==this.size[m]+1){if(!(this.knots[m].length===this.size[m]+this.degree[m]+1))throw new Error("Expected "+(this.size[m]+1)+" knots for closed spline in dimension "+(m+1)+" but got "+this.knots[m].length+".")}}}break;case e.NDARRAY:}var x=t(this,this.debug,this.checkBounds,w,y,b);if(x!==this.__cacheKey){this.__cacheKey=x;var F=r(this);this.evaluate=u(this.__cacheKey,this,F,this.debug,this.checkBounds,!1),this.transform=a(this.__cacheKey,this,F,this.debug),this.support=l(this.__cacheKey,this,F,this.debug,this.checkBounds),this.evaluator=function(e,t){return u(this.__cacheKey,this,F,this.debug,this.checkBounds,t,e)}}return this.numericalDerivative=o.bind(this),this}function p(){var e,t=[],n=this.points;n?i(n)&&(e=n.shape):e=this.size;for(var r=0;r<this.splineDimension;r++){var o=e?e[r]:n.length,s=this.degree[r],u="closed"===this.boundary[r];if(this.knots&&this.knots[r]){var a=this.knots[r];t[r]=[a[u?0:s],a[o]]}else t[r]=[u?0:s,o];n&&(n=n[0])}return t}function f(e,t,n,i,r,o){var s=function(e,t,n,i,r,o){return u(e,t,n,i,r,o),s},u=d.bind(s);return Object.defineProperty(s,"domain",{get:p}),u(e,t,n,i,r,o),s}var g={open:"open",closed:"closed",clamped:"clamped"};return f.sample=c,f}),e("nurbs",["nurbs/nurbs"],function(e){return e}),e("x_ite/Components/NURBS/NurbsCurve",["x_ite/Bits/X3DCast","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/NURBS/X3DParametricGeometryNode","x_ite/Components/Rendering/X3DLineGeometryNode","x_ite/Bits/X3DConstants","x_ite/Browser/NURBS/NURBS","nurbs"],function(e,t,n,i,r,o,s,u,a){"use strict";function l(e){r.call(this,e),this.addType(s.NurbsCurve),this.setGeometryType(1),this.mesh={},this.sampleOptions={resolution:[]}}return l.prototype=Object.assign(Object.create(r.prototype),o.prototype,{constructor:l,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new t.SFNode),new n(s.inputOutput,"tessellation",new t.SFInt32),new n(s.initializeOnly,"closed",new t.SFBool),new n(s.initializeOnly,"order",new t.SFInt32(3)),new n(s.initializeOnly,"knot",new t.MFDouble),new n(s.inputOutput,"weight",new t.MFDouble),new n(s.inputOutput,"controlPoint",new t.SFNode)]),getTypeName:function(){return"NurbsCurve"},getComponentName:function(){return"NURBS"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.controlPoint_.addInterest("set_controlPoint__",this),this.setPrimitiveMode(this.getBrowser().getContext().LINES),this.setSolid(!1),this.set_controlPoint__()},set_controlPoint__:function(){this.controlPointNode&&this.controlPointNode.removeInterest("requestRebuild",this),this.controlPointNode=e(s.X3DCoordinateNode,this.controlPoint_),this.controlPointNode&&this.controlPointNode.addInterest("requestRebuild",this)},getTessellation:function(e){return u.getTessellation(this.tessellation_.getValue(),e-this.order_.getValue())},getClosed:function(e,t,n,i){return!!this.closed_.getValue()&&u.getClosed(e,t,n,i)},getWeights:function(e,t,n,i){return u.getWeights(e,t,n,i)},getControlPoints:function(e,t,n){return u.getControlPoints(e,t,n)},tessellate:function(){if(this.order_.getValue()<2)return[];if(!this.controlPointNode)return[];if(this.controlPointNode.getSize()<this.order_.getValue())return[];for(var e=this.getVertices(),t=[],n=0,i=e.length;n<i;n+=8)t.push(e[n],e[n+1],e[n+2]);return t.push(e[i-4],e[i-3],e[i-2]),t},build:function(){if(!(this.order_.getValue()<2)&&this.controlPointNode&&!(this.controlPointNode.getSize()<this.order_.getValue())){var e=this.getClosed(this.order_.getValue(),this.knot_,this.weight_,this.controlPointNode),t=this.getControlPoints(e,this.order_.getValue(),this.controlPointNode),n=this.getKnots(e,this.order_.getValue(),this.controlPointNode.getSize(),this.knot_),i=(n[n.length-1],n[0],this.getWeights(e,this.order_.getValue(),this.controlPointNode.getSize(),this.weight_)),r=this.order_.getValue()-1,o=this.surface=(this.surface||a)({boundary:["open"],degree:[r],knots:[n],weights:i,points:t,debug:!1});this.sampleOptions.resolution[0]=this.getTessellation(n.length);for(var s=a.sample(this.mesh,o,this.sampleOptions),u=s.points,l=this.getVertices(),c=3,h=u.length;c<h;c+=3){var d=c-3;l.push(u[d],u[d+1],u[d+2],1),l.push(u[c],u[c+1],u[c+2],1)}}}}),l}),e("x_ite/Components/NURBS/NurbsCurve2D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/NURBS/X3DNurbsControlCurveNode","x_ite/Bits/X3DConstants","x_ite/Browser/NURBS/NURBS","nurbs"],function(e,t,n,i,r,o,s){"use strict";function u(e){i.call(this,e),this.addType(r.NurbsCurve2D),this.mesh={},this.sampleOptions={resolution:[]}}return u.prototype=Object.assign(Object.create(i.prototype),{constructor:u,fieldDefinitions:new n([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"tessellation",new e.SFInt32),new t(r.initializeOnly,"closed",new e.SFBool),new t(r.initializeOnly,"order",new e.SFInt32(3)),new t(r.initializeOnly,"knot",new e.MFDouble),new t(r.inputOutput,"weight",new e.MFDouble),new t(r.inputOutput,"controlPoint",new e.MFVec2d)]),getTypeName:function(){return"NurbsCurve2D"},getComponentName:function(){return"NURBS"},getContainerField:function(){return"children"},getTessellation:function(e){return o.getTessellation(this.tessellation_.getValue(),e-this.order_.getValue())},getClosed:function(e,t,n,i){return!!this.closed_.getValue()&&o.getClosed2D(e,t,n,i)},getKnots:function(e,t,n,i){return o.getKnots(e,t,n,i)},getWeights:function(e,t,n,i){return o.getWeights(e,t,n,i)},getControlPoints:function(e,t,n){return o.getControlPoints2D(e,t,n)},tessellate:function(e){if(this.order_.getValue()<2)return[];if(this.controlPoint_.length<this.order_.getValue())return[];var t=this.getClosed(this.order_.getValue(),this.knot_,this.weight_,this.controlPoint_),n=this.getControlPoints(t,this.order_.getValue(),this.controlPoint_),i=this.getKnots(t,this.order_.getValue(),this.controlPoint_.length,this.knot_),r=(i[i.length-1],i[0],this.getWeights(t,this.order_.getValue(),this.controlPoint_.length,this.weight_)),o=this.order_.getValue()-1,u=this.surface=(this.surface||s)({boundary:["open"],degree:[o],knots:[i],weights:r,points:n,debug:!1});this.sampleOptions.resolution[0]=this.getTessellation(i.length);var a=s.sample(this.mesh,u,this.sampleOptions),l=a.points,c=[];if(e)for(var h=0,d=l.length;h<d;h+=3)c.push(l[h],0,l[h+1]);else for(var h=0,d=l.length;h<d;h+=3)c.push(l[h],l[h+1]);return c}}),u}),e("x_ite/Components/NURBS/NurbsOrientationInterpolator",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(e,t,n,i,r){"use strict";function o(e){i.call(this,e),this.addType(r.NurbsOrientationInterpolator)}return o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,fieldDefinitions:new n([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_fraction",new e.SFFloat),new t(r.inputOutput,"order",new e.SFInt32(3)),new t(r.inputOutput,"knot",new e.MFDouble),new t(r.inputOutput,"weight",new e.MFDouble),new t(r.inputOutput,"controlPoint",new e.SFNode),new t(r.outputOnly,"value_changed",new e.SFRotation)]),getTypeName:function(){return"NurbsOrientationInterpolator"},getComponentName:function(){return"NURBS"},getContainerField:function(){return"children"}}),o}),
e("x_ite/Components/NURBS/X3DNurbsSurfaceGeometryNode",["x_ite/Components/NURBS/X3DParametricGeometryNode","x_ite/Bits/X3DConstants","x_ite/Bits/X3DCast","x_ite/Browser/NURBS/NURBS","nurbs"],function(e,t,n,i,r){"use strict";function o(n){e.call(this,n),this.addType(t.X3DNurbsSurfaceGeometryNode),this.tessellationScale=1,this.mesh={},this.sampleOptions={resolution:[]}}return o.prototype=Object.assign(Object.create(e.prototype),{constructor:o,initialize:function(){e.prototype.initialize.call(this),this.texCoord_.addInterest("set_texCoord__",this),this.controlPoint_.addInterest("set_controlPoint__",this),this.set_texCoord__(),this.set_controlPoint__()},set_texCoord__:function(){this.texCoordNode&&this.texCoordNode.removeInterest("requestRebuild",this),this.nurbsTexCoordNode&&this.nurbsTexCoordNode.removeInterest("requestRebuild",this),this.texCoordNode=n(t.X3DTextureCoordinateNode,this.texCoord_),this.nurbsTexCoordNode=n(t.NurbsTextureCoordinate,this.texCoord_),this.texCoordNode&&this.texCoordNode.addInterest("requestRebuild",this),this.nurbsTexCoordNode&&this.nurbsTexCoordNode.addInterest("requestRebuild",this)},set_controlPoint__:function(){this.controlPointNode&&this.controlPointNode.removeInterest("requestRebuild",this),this.controlPointNode=n(t.X3DCoordinateNode,this.controlPoint_),this.controlPointNode&&this.controlPointNode.addInterest("requestRebuild",this)},setTessellationScale:function(e){this.tessellationScale=e,this.requestRebuild()},getUTessellation:function(e){return i.getTessellation(this.uTessellation_.getValue(),e-this.uOrder_.getValue())},getVTessellation:function(e){return i.getTessellation(this.vTessellation_.getValue(),e-this.vOrder_.getValue())},getUClosed:function(e,t,n,r,o,s){return!!this.uClosed_.getValue()&&i.getUClosed(e,t,n,r,o,s)},getVClosed:function(e,t,n,r,o,s){return!!this.vClosed_.getValue()&&i.getVClosed(e,t,n,r,o,s)},getUVWeights:function(e,t,n,r,o,s,u){return i.getUVWeights(e,t,n,r,o,s,u)},getUVControlPoints:function(e,t,n,r,o,s,u){return i.getUVControlPoints(e,t,n,r,o,s,u)},build:function(){if(!(this.uOrder_.getValue()<2)&&!(this.vOrder_.getValue()<2)&&!(this.uDimension_.getValue()<this.uOrder_.getValue())&&!(this.vDimension_.getValue()<this.vOrder_.getValue())&&this.controlPointNode&&this.controlPointNode.getSize()===this.uDimension_.getValue()*this.vDimension_.getValue()){var e=this.getUClosed(this.uOrder_.getValue(),this.uDimension_.getValue(),this.vDimension_.getValue(),this.uKnot_,this.weight_,this.controlPointNode),t=this.getVClosed(this.vOrder_.getValue(),this.uDimension_.getValue(),this.vDimension_.getValue(),this.vKnot_,this.weight_,this.controlPointNode),n=this.getUVControlPoints(e,t,this.uOrder_.getValue(),this.vOrder_.getValue(),this.uDimension_.getValue(),this.vDimension_.getValue(),this.controlPointNode),i=this.getKnots(e,this.uOrder_.getValue(),this.uDimension_.getValue(),this.uKnot_),o=this.getKnots(t,this.vOrder_.getValue(),this.vDimension_.getValue(),this.vKnot_),s=(i[i.length-1],i[0],o[o.length-1],o[0],this.getUVWeights(e,t,this.uOrder_.getValue(),this.vOrder_.getValue(),this.uDimension_.getValue(),this.vDimension_.getValue(),this.weight_)),u=this.uOrder_.getValue()-1,a=this.vOrder_.getValue()-1,l=this.surface=(this.surface||r)({boundary:["open","open"],degree:[u,a],knots:[i,o],weights:s,points:n,debug:!1});this.sampleOptions.resolution[0]=Math.floor(this.getUTessellation(i.length)*this.tessellationScale),this.sampleOptions.resolution[1]=Math.floor(this.getVTessellation(o.length)*this.tessellationScale);for(var c=r.sample(this.mesh,l,this.sampleOptions),h=c.faces,d=c.normals,p=c.points,f=this.getNormals(),g=this.getVertices(),_=0,m=h.length;_<m;++_){var v=3*h[_];f.push(d[v],d[v+1],d[v+2]),g.push(p[v],p[v+1],p[v+2],1)}this.setSolid(this.solid_.getValue()),this.setCCW(!0)}}}),o}),e("x_ite/Components/NURBS/NurbsPatchSurface",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/NURBS/X3DNurbsSurfaceGeometryNode","x_ite/Bits/X3DConstants"],function(e,t,n,i,r){"use strict";function o(e){i.call(this,e),this.addType(r.NurbsPatchSurface)}return o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,fieldDefinitions:new n([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"solid",new e.SFBool(!0)),new t(r.inputOutput,"uTessellation",new e.SFInt32),new t(r.inputOutput,"vTessellation",new e.SFInt32),new t(r.initializeOnly,"uClosed",new e.SFBool),new t(r.initializeOnly,"vClosed",new e.SFBool),new t(r.initializeOnly,"uOrder",new e.SFInt32(3)),new t(r.initializeOnly,"vOrder",new e.SFInt32(3)),new t(r.initializeOnly,"uDimension",new e.SFInt32),new t(r.initializeOnly,"vDimension",new e.SFInt32),new t(r.initializeOnly,"uKnot",new e.MFDouble),new t(r.initializeOnly,"vKnot",new e.MFDouble),new t(r.inputOutput,"weight",new e.MFDouble),new t(r.inputOutput,"texCoord",new e.SFNode),new t(r.inputOutput,"controlPoint",new e.SFNode)]),getTypeName:function(){return"NurbsPatchSurface"},getComponentName:function(){return"NURBS"},getContainerField:function(){return"geometry"}}),o}),e("x_ite/Components/NURBS/NurbsPositionInterpolator",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(e,t,n,i,r){"use strict";function o(e){i.call(this,e),this.addType(r.NurbsPositionInterpolator)}return o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,fieldDefinitions:new n([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_fraction",new e.SFFloat),new t(r.inputOutput,"order",new e.SFInt32(3)),new t(r.inputOutput,"knot",new e.MFDouble),new t(r.inputOutput,"weight",new e.MFDouble),new t(r.inputOutput,"controlPoint",new e.SFNode),new t(r.outputOnly,"value_changed",new e.SFVec3f)]),getTypeName:function(){return"NurbsPositionInterpolator"},getComponentName:function(){return"NURBS"},getContainerField:function(){return"children"}}),o}),e("x_ite/Components/NURBS/NurbsSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Bits/X3DConstants","x_ite/Bits/X3DCast"],function(e,t,n,i,r,o,s){"use strict";function u(e,t,n,i,r,o){function s(e){return u[getId(e)]}for(var u={},a=r;a<o;++a)u[getId(i[a])]=!0;return e.remove(t,n,s)}function a(e){i.call(this,e),r.call(this,e),this.addType(o.NurbsSet),this.geometryNodes=[]}return a.prototype=Object.assign(Object.create(i.prototype),r.prototype,{constructor:a,fieldDefinitions:new n([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"tessellationScale",new e.SFFloat(1)),new t(o.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(o.initializeOnly,"bboxCenter",new e.SFVec3f),new t(o.inputOnly,"addGeometry",new e.MFNode),new t(o.inputOnly,"removeGeometry",new e.MFNode),new t(o.inputOutput,"geometry",new e.MFNode)]),getTypeName:function(){return"NurbsSet"},getComponentName:function(){return"NURBS"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),r.prototype.initialize.call(this),this.tessellationScale_.addInterest("set_tessellationScale__",this),this.addGeometry_.addInterest("set_addGeometry__",this),this.removeGeometry_.addInterest("set_removeGeometry__",this),this.geometry_.addInterest("set_geometry__",this),this.set_geometry__()},set_tessellationScale__:function(){for(var e=0,t=this.geometryNodes.length;e<t;++e)this.geometryNodes[e].setTessellationScale(this.tessellationScale_.getValue())},set_addGeometry__:function(){this.addGeometry_.setTainted(!0),this.addGeometry_.erase(u(this.addGeometry_,0,this.addGeometry_.length,this.geometry_,0,this.geometry_.length),this.addGeometry_.length);for(var e=0,t=this.addGeometry_.length;e<t;++e)this.geometry_.push(this.addGeometry_[e]);this.addGeometry_.setTainted(!1)},set_removeGeometry__:function(){this.geometry_.erase(u(this.geometry_,0,this.geometry_.length,this.removeGeometry_,0,this.removeGeometry_.length),this.geometry__.length)},set_geometry__:function(){for(var e=0,t=this.geometryNodes.length;e<t;++e)this.geometryNodes[e].setTessellationScale(1);this.geometryNodes.length=0;for(var e=0,t=this.geometry_.length;e<t;++e){var n=s(o.X3DNurbsSurfaceGeometryNode,this.geometry_[e]);n&&this.geometryNodes.push(n)}this.set_tessellationScale__()}}),a}),e("x_ite/Components/NURBS/NurbsSurfaceInterpolator",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(e,t,n,i,r){"use strict";function o(e){i.call(this,e),this.addType(r.NurbsSurfaceInterpolator)}return o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,fieldDefinitions:new n([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_fraction",new e.SFVec2f),new t(r.initializeOnly,"uOrder",new e.SFInt32(3)),new t(r.initializeOnly,"vOrder",new e.SFInt32(3)),new t(r.initializeOnly,"uDimension",new e.SFInt32),new t(r.initializeOnly,"vDimension",new e.SFInt32),new t(r.initializeOnly,"uKnot",new e.MFDouble),new t(r.initializeOnly,"vKnot",new e.MFDouble),new t(r.inputOutput,"weight",new e.MFDouble),new t(r.inputOutput,"controlPoint",new e.SFNode),new t(r.outputOnly,"normal_changed",new e.SFVec3f),new t(r.outputOnly,"position_changed",new e.SFVec3f)]),getTypeName:function(){return"NurbsSurfaceInterpolator"},getComponentName:function(){return"NURBS"},getContainerField:function(){return"children"}}),o}),e("x_ite/Components/NURBS/NurbsSweptSurface",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Geometry3D/Extrusion","x_ite/Components/NURBS/X3DParametricGeometryNode","x_ite/Bits/X3DConstants","x_ite/Bits/X3DCast"],function(e,t,n,i,r,o,s){"use strict";function u(e){r.call(this,e),this.addType(o.NurbsSweptSurface),this.extrusion=new i(e)}return u.prototype=Object.assign(Object.create(r.prototype),{constructor:u,fieldDefinitions:new n([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.initializeOnly,"solid",new e.SFBool(!0)),new t(o.initializeOnly,"ccw",new e.SFBool(!0)),new t(o.inputOutput,"crossSectionCurve",new e.SFNode),new t(o.inputOutput,"trajectoryCurve",new e.SFNode)]),getTypeName:function(){return"NurbsSweptSurface"},getComponentName:function(){return"NURBS"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.crossSectionCurve_.addInterest("set_crossSectionCurve__",this),this.trajectoryCurve_.addInterest("set_trajectoryCurve__",this);var e=this.extrusion;e.beginCap_=!1,e.endCap_=!1,e.solid_=!0,e.ccw_=!0,e.convex_=!0,e.creaseAngle_=Math.PI,e.setup(),e.crossSection_.setTainted(!0),e.spine_.setTainted(!0),this.set_crossSectionCurve__(),this.set_trajectoryCurve__()},set_crossSectionCurve__:function(){this.crossSectionCurveNode&&this.crossSectionCurveNode.removeInterest("requestRebuild",this),this.crossSectionCurveNode=s(o.X3DNurbsControlCurveNode,this.crossSectionCurve_),this.crossSectionCurveNode&&this.crossSectionCurveNode.addInterest("requestRebuild",this)},set_trajectoryCurve__:function(){this.trajectoryCurveNode&&this.trajectoryCurveNode.rebuild_.removeInterest("requestRebuild",this),this.trajectoryCurveNode=s(o.NurbsCurve,this.trajectoryCurve_),this.trajectoryCurveNode&&this.trajectoryCurveNode.rebuild_.addInterest("requestRebuild",this)},build:function(){if(this.crossSectionCurveNode&&this.trajectoryCurveNode){var e=this.extrusion;if(e.crossSection_=this.crossSectionCurveNode.tessellate(),e.spine_=this.trajectoryCurveNode.tessellate(),e.rebuild(),this.getColors().assign(e.getColors()),this.getTexCoords().assign(e.getTexCoords()),this.getNormals().assign(e.getNormals()),this.getVertices().assign(e.getVertices()),!this.ccw_.getValue())for(var t=this.getNormals(),n=0,i=t.length;n<i;++n)t[n]=-t[n];this.setSolid(this.solid_.getValue()),this.setCCW(this.ccw_.getValue())}}}),u}),e("x_ite/Components/NURBS/NurbsSwungSurface",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Geometry3D/Extrusion","x_ite/Components/NURBS/X3DParametricGeometryNode","x_ite/Bits/X3DConstants","x_ite/Bits/X3DCast"],function(e,t,n,i,r,o,s){"use strict";function u(e){r.call(this,e),this.addType(o.NurbsSwungSurface),this.extrusion=new i(e)}return u.prototype=Object.assign(Object.create(r.prototype),{constructor:u,fieldDefinitions:new n([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.initializeOnly,"solid",new e.SFBool(!0)),new t(o.initializeOnly,"ccw",new e.SFBool(!0)),new t(o.inputOutput,"profileCurve",new e.SFNode),new t(o.inputOutput,"trajectoryCurve",new e.SFNode)]),getTypeName:function(){return"NurbsSwungSurface"},getComponentName:function(){return"NURBS"},getContainerField:function(){return"geometry"},initialize:function(){r.prototype.initialize.call(this),this.profileCurve_.addInterest("set_profileCurve__",this),this.trajectoryCurve_.addInterest("set_trajectoryCurve__",this);var e=this.extrusion;e.beginCap_=!1,e.endCap_=!1,e.solid_=!0,e.ccw_=!0,e.convex_=!0,e.creaseAngle_=Math.PI,e.setup(),e.crossSection_.setTainted(!0),e.spine_.setTainted(!0),this.set_profileCurve__(),this.set_trajectoryCurve__()},set_profileCurve__:function(){this.profileCurveNode&&this.profileCurveNode.removeInterest("requestRebuild",this),this.profileCurveNode=s(o.X3DNurbsControlCurveNode,this.profileCurve_),this.profileCurveNode&&this.profileCurveNode.addInterest("requestRebuild",this)},set_trajectoryCurve__:function(){this.trajectoryCurveNode&&this.trajectoryCurveNode.removeInterest("requestRebuild",this),this.trajectoryCurveNode=s(o.X3DNurbsControlCurveNode,this.trajectoryCurve_),this.trajectoryCurveNode&&this.trajectoryCurveNode.addInterest("requestRebuild",this)},build:function(){if(this.profileCurveNode&&this.trajectoryCurveNode){var e=this.extrusion;if(e.crossSection_=this.profileCurveNode.tessellate(),e.spine_=this.trajectoryCurveNode.tessellate(!0),e.rebuild(),this.getColors().assign(e.getColors()),this.getTexCoords().assign(e.getTexCoords()),this.getNormals().assign(e.getNormals()),this.getVertices().assign(e.getVertices()),!this.ccw_.getValue())for(var t=this.getNormals(),n=0,i=t.length;n<i;++n)t[n]=-t[n];this.setSolid(this.solid_.getValue()),this.setCCW(this.ccw_.getValue())}}}),u}),e("x_ite/Components/NURBS/NurbsTextureCoordinate",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants"],function(e,t,n,i,r){"use strict";function o(e){i.call(this,e),this.addType(r.NurbsTextureCoordinate)}return o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,fieldDefinitions:new n([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"uOrder",new e.SFInt32(3)),new t(r.initializeOnly,"vOrder",new e.SFInt32(3)),new t(r.initializeOnly,"uDimension",new e.SFInt32),new t(r.initializeOnly,"vDimension",new e.SFInt32),new t(r.initializeOnly,"uKnot",new e.MFDouble),new t(r.initializeOnly,"vKnot",new e.MFDouble),new t(r.inputOutput,"weight",new e.MFFloat),new t(r.inputOutput,"controlPoint",new e.MFVec2f)]),getTypeName:function(){return"NurbsTextureCoordinate"},getComponentName:function(){return"NURBS"},getContainerField:function(){return"texCoord"}}),o}),e("x_ite/Components/NURBS/NurbsTrimmedSurface",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/NURBS/X3DNurbsSurfaceGeometryNode","x_ite/Bits/X3DConstants"],function(e,t,n,i,r){"use strict";function o(e){i.call(this,e),this.addType(r.NurbsTrimmedSurface)}return o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,fieldDefinitions:new n([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"solid",new e.SFBool(!0)),new t(r.inputOutput,"uTessellation",new e.SFInt32),new t(r.inputOutput,"vTessellation",new e.SFInt32),new t(r.initializeOnly,"uClosed",new e.SFBool),new t(r.initializeOnly,"vClosed",new e.SFBool),new t(r.initializeOnly,"uOrder",new e.SFInt32(3)),new t(r.initializeOnly,"vOrder",new e.SFInt32(3)),new t(r.initializeOnly,"uDimension",new e.SFInt32),new t(r.initializeOnly,"vDimension",new e.SFInt32),new t(r.initializeOnly,"uKnot",new e.MFDouble),new t(r.initializeOnly,"vKnot",new e.MFDouble),new t(r.inputOutput,"weight",new e.MFDouble),new t(r.inputOutput,"texCoord",new e.SFNode),new t(r.inputOutput,"controlPoint",new e.SFNode),new t(r.inputOnly,"addTrimmingContour",new e.MFNode),new t(r.inputOnly,"removeTrimmingContour",new e.MFNode),new t(r.inputOutput,"trimmingContour",new e.MFNode)]),getTypeName:function(){return"NurbsTrimmedSurface"},getComponentName:function(){return"NURBS"},getContainerField:function(){return"geometry"}}),o}),t(["x_ite/Configuration/SupportedNodes","x_ite/Components/NURBS/Contour2D","x_ite/Components/NURBS/ContourPolyline2D","x_ite/Components/NURBS/CoordinateDouble","x_ite/Components/NURBS/NurbsCurve","x_ite/Components/NURBS/NurbsCurve2D","x_ite/Components/NURBS/NurbsOrientationInterpolator","x_ite/Components/NURBS/NurbsPatchSurface","x_ite/Components/NURBS/NurbsPositionInterpolator","x_ite/Components/NURBS/NurbsSet","x_ite/Components/NURBS/NurbsSurfaceInterpolator","x_ite/Components/NURBS/NurbsSweptSurface","x_ite/Components/NURBS/NurbsSwungSurface","x_ite/Components/NURBS/NurbsTextureCoordinate","x_ite/Components/NURBS/NurbsTrimmedSurface"],function(e,t,n,i,r,o,s,u,a,l,c,h,d,p,f){"use strict";function g(e){return new this(e)}var _={Contour2D:t,ContourPolyline2D:n,CoordinateDouble:i,NurbsCurve:r,NurbsCurve2D:o,NurbsOrientationInterpolator:s,NurbsPatchSurface:u,NurbsPositionInterpolator:a,NurbsSet:l,NurbsSurfaceInterpolator:c,NurbsSweptSurface:h,NurbsSwungSurface:d,NurbsTextureCoordinate:p,NurbsTrimmedSurface:f};for(var m in _){var v=_[m];v.createInstance=g.bind(v),e[m]=v,e[m.toUpperCase()]=v}return _}),e("components/nurbs",function(){})}();
