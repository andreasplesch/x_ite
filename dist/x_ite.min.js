/* X_ITE X3D v4.2.14a-494
 * See LICENSE.txt for a detailed listing of used licences. */
!function(){var x_iteNoConfict={sprintf:window.sprintf,vsprintf:window.vsprintf},requirejs,require,define;!function(global,setTimeout){function commentReplace(e,t){return t||""}function isFunction(e){return"[object Function]"===ostring.call(e)}function isArray(e){return"[object Array]"===ostring.call(e)}function each(e,t){if(e){var i;for(i=0;i<e.length&&(!e[i]||!t(e[i],i,e));i+=1);}}function eachReverse(e,t){if(e){var i;for(i=e.length-1;i>-1&&(!e[i]||!t(e[i],i,e));i-=1);}}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var i;for(i in e)if(hasProp(e,i)&&t(e[i],i))break}function mixin(e,t,i,n){return t&&eachProp(t,function(t,r){!i&&hasProp(e,r)||(!n||"object"!=typeof t||!t||isArray(t)||isFunction(t)||t instanceof RegExp?e[r]=t:(e[r]||(e[r]={}),mixin(e[r],t,i,n)))}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(e){throw e}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeError(e,t,i,n){var r=new Error(t+"\nhttps://requirejs.org/docs/errors.html#"+e);return r.requireType=e,r.requireModules=n,i&&(r.originalError=i),r}function newContext(e){function t(e){var t,i;for(t=0;t<e.length;t++)if("."===(i=e[t]))e.splice(t,1),t-=1;else if(".."===i){if(0===t||1===t&&".."===e[2]||".."===e[t-1])continue;t>0&&(e.splice(t-1,2),t-=2)}}function i(e,i,n){var r,s,o,a,u,l,h,c,d,p,f,g,m=i&&i.split("/"),_=S.map,x=_&&_["*"];if(e&&(e=e.split("/"),h=e.length-1,S.nodeIdCompat&&jsSuffixRegExp.test(e[h])&&(e[h]=e[h].replace(jsSuffixRegExp,"")),"."===e[0].charAt(0)&&m&&(g=m.slice(0,m.length-1),e=g.concat(e)),t(e),e=e.join("/")),n&&_&&(m||x)){o=e.split("/");e:for(a=o.length;a>0;a-=1){if(l=o.slice(0,a).join("/"),m)for(u=m.length;u>0;u-=1)if((s=getOwn(_,m.slice(0,u).join("/")))&&(s=getOwn(s,l))){c=s,d=a;break e}!p&&x&&getOwn(x,l)&&(p=getOwn(x,l),f=a)}!c&&p&&(c=p,d=f),c&&(o.splice(0,d,c),e=o.join("/"))}return r=getOwn(S.pkgs,e),r?r:e}function n(e){isBrowser&&each(scripts(),function(t){if(t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===v.contextName)return t.parentNode.removeChild(t),!0})}function r(e){var t=getOwn(S.paths,e);if(t&&isArray(t)&&t.length>1)return t.shift(),v.require.undef(e),v.makeRequire(null,{skipMap:!0})([e]),!0}function s(e){var t,i=e?e.indexOf("!"):-1;return i>-1&&(t=e.substring(0,i),e=e.substring(i+1,e.length)),[t,e]}function o(e,t,n,r){var o,a,u,l,h=null,c=t?t.name:null,d=e,p=!0,f="";return e||(p=!1,e="_@r"+(E+=1)),l=s(e),h=l[0],e=l[1],h&&(h=i(h,c,r),a=getOwn(N,h)),e&&(h?f=n?e:a&&a.normalize?a.normalize(e,function(e){return i(e,c,r)}):e.indexOf("!")===-1?i(e,c,r):e:(f=i(e,c,r),l=s(f),h=l[0],f=l[1],n=!0,o=v.nameToUrl(f))),u=!h||a||n?"":"_unnormalized"+(V+=1),{prefix:h,name:f,parentMap:t,unnormalized:!!u,url:o,originalName:d,isDefine:p,id:(h?h+"!"+f:f)+u}}function a(e){var t=e.id,i=getOwn(C,t);return i||(i=C[t]=new v.Module(e)),i}function u(e,t,i){var n=e.id,r=getOwn(C,n);!hasProp(N,n)||r&&!r.defineEmitComplete?(r=a(e),r.error&&"error"===t?i(r.error):r.on(t,i)):"defined"===t&&i(N[n])}function l(e,t){var i=e.requireModules,n=!1;t?t(e):(each(i,function(t){var i=getOwn(C,t);i&&(i.error=e,i.events.error&&(n=!0,i.emit("error",e)))}),n||req.onError(e))}function h(){globalDefQueue.length&&(each(globalDefQueue,function(e){var t=e[0];"string"==typeof t&&(v.defQueueMap[t]=!0),O.push(e)}),globalDefQueue=[])}function c(e){delete C[e],delete T[e]}function d(e,t,i){var n=e.map.id;e.error?e.emit("error",e.error):(t[n]=!0,each(e.depMaps,function(n,r){var s=n.id,o=getOwn(C,s);!o||e.depMatched[r]||i[s]||(getOwn(t,s)?(e.defineDep(r,N[s]),e.check()):d(o,t,i))}),i[n]=!0)}function p(){var e,t,i=1e3*S.waitSeconds,s=i&&v.startTime+i<(new Date).getTime(),o=[],a=[],u=!1,h=!0;if(!x){if(x=!0,eachProp(T,function(e){var i=e.map,l=i.id;if(e.enabled&&(i.isDefine||a.push(e),!e.error))if(!e.inited&&s)r(l)?(t=!0,u=!0):(o.push(l),n(l));else if(!e.inited&&e.fetched&&i.isDefine&&(u=!0,!i.prefix))return h=!1}),s&&o.length)return e=makeError("timeout","Load timeout for modules: "+o,null,o),e.contextName=v.contextName,l(e);h&&each(a,function(e){d(e,{},{})}),s&&!t||!u||!isBrowser&&!isWebWorker||b||(b=setTimeout(function(){b=0,p()},50)),x=!1}}function f(e){hasProp(N,e[0])||a(o(e[0],null,!0)).init(e[1],e[2])}function g(e,t,i,n){e.detachEvent&&!isOpera?n&&e.detachEvent(n,t):e.removeEventListener(i,t,!1)}function m(e){var t=e.currentTarget||e.srcElement;return g(t,v.onScriptLoad,"load","onreadystatechange"),g(t,v.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function _(){var e;for(h();O.length;){if(e=O.shift(),null===e[0])return l(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));f(e)}v.defQueueMap={}}var x,y,v,w,b,S={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},C={},T={},F={},O=[],N={},M={},D={},E=1,V=1;return w={require:function(e){return e.require?e.require:e.require=v.makeRequire(e.map)},exports:function(e){if(e.usingExports=!0,e.map.isDefine)return e.exports?N[e.map.id]=e.exports:e.exports=N[e.map.id]={}},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){return getOwn(S.config,e.map.id)||{}},exports:e.exports||(e.exports={})}}},y=function(e){this.events=getOwn(F,e.id)||{},this.map=e,this.shim=getOwn(S.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},y.prototype={init:function(e,t,i,n){n=n||{},this.inited||(this.factory=t,i?this.on("error",i):this.events.error&&(i=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=i,this.inited=!0,this.ignore=n.ignore,n.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,v.startTime=(new Date).getTime();var e=this.map;if(!this.shim)return e.prefix?this.callPlugin():this.load();v.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()}))}},load:function(){var e=this.map.url;M[e]||(M[e]=!0,v.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,i=this.map.id,n=this.depExports,r=this.exports,s=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(s)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{r=v.execCb(i,s,n,r)}catch(t){e=t}else r=v.execCb(i,s,n,r);if(this.map.isDefine&&void 0===r&&(t=this.module,t?r=t.exports:this.usingExports&&(r=this.exports)),e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",l(this.error=e)}else r=s;if(this.exports=r,this.map.isDefine&&!this.ignore&&(N[i]=r,req.onResourceLoad)){var o=[];each(this.depMaps,function(e){o.push(e.normalizedMap||e)}),req.onResourceLoad(v,this.map,o)}c(i),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else hasProp(v.defQueueMap,i)||this.fetch()}},callPlugin:function(){var e=this.map,t=e.id,n=o(e.prefix);this.depMaps.push(n),u(n,"defined",bind(this,function(n){var r,s,h,d=getOwn(D,this.map.id),p=this.map.name,f=this.map.parentMap?this.map.parentMap.name:null,g=v.makeRequire(e.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(n.normalize&&(p=n.normalize(p,function(e){return i(e,f,!0)})||""),s=o(e.prefix+"!"+p,this.map.parentMap,!0),u(s,"defined",bind(this,function(e){this.map.normalizedMap=s,this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),void((h=getOwn(C,s.id))&&(this.depMaps.push(s),this.events.error&&h.on("error",bind(this,function(e){this.emit("error",e)})),h.enable()))):d?(this.map.url=v.nameToUrl(d),void this.load()):(r=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),r.error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[t],eachProp(C,function(e){0===e.map.id.indexOf(t+"_unnormalized")&&c(e.map.id)}),l(e)}),r.fromText=bind(this,function(i,n){var s=e.name,u=o(s),h=useInteractive;n&&(i=n),h&&(useInteractive=!1),a(u),hasProp(S.config,t)&&(S.config[s]=S.config[t]);try{req.exec(i)}catch(e){return l(makeError("fromtexteval","fromText eval for "+t+" failed: "+e,e,[t]))}h&&(useInteractive=!0),this.depMaps.push(u),v.completeLoad(s),g([s],r)}),void n.load(e.name,g,r,S))})),v.enable(n,this),this.pluginMaps[n.id]=n},enable:function(){T[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var i,n,r;if("string"==typeof e){if(e=o(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,r=getOwn(w,e.id))return void(this.depExports[t]=r(this));this.depCount+=1,u(e,"defined",bind(this,function(e){this.undefed||(this.defineDep(t,e),this.check())})),this.errback?u(e,"error",bind(this,this.errback)):this.events.error&&u(e,"error",bind(this,function(e){this.emit("error",e)}))}i=e.id,n=C[i],hasProp(w,i)||!n||n.enabled||v.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=getOwn(C,e.id);t&&!t.enabled&&v.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var i=this.events[e];i||(i=this.events[e]=[]),i.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},v={config:S,contextName:e,registry:C,defined:N,urlFetched:M,defQueue:O,defQueueMap:{},Module:y,makeModuleMap:o,nextTick:req.nextTick,onError:l,configure:function(e){if(e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/"),"string"==typeof e.urlArgs){var t=e.urlArgs;e.urlArgs=function(e,i){return(i.indexOf("?")===-1?"?":"&")+t}}var i=S.shim,n={paths:!0,bundles:!0,config:!0,map:!0};eachProp(e,function(e,t){n[t]?(S[t]||(S[t]={}),mixin(S[t],e,!0,!0)):S[t]=e}),e.bundles&&eachProp(e.bundles,function(e,t){each(e,function(e){e!==t&&(D[e]=t)})}),e.shim&&(eachProp(e.shim,function(e,t){isArray(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=v.makeShimExports(e)),i[t]=e}),S.shim=i),e.packages&&each(e.packages,function(e){var t,i;e="string"==typeof e?{name:e}:e,i=e.name,t=e.location,t&&(S.paths[i]=e.location),S.pkgs[i]=e.name+"/"+(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(C,function(e,t){e.inited||e.map.unnormalized||(e.map=o(t,null,!0))}),(e.deps||e.callback)&&v.require(e.deps||[],e.callback)},makeShimExports:function(e){function t(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}return t},makeRequire:function(t,r){function s(i,n,u){var h,c,d;return r.enableBuildCallback&&n&&isFunction(n)&&(n.__requireJsBuild=!0),"string"==typeof i?isFunction(n)?l(makeError("requireargs","Invalid require call"),u):t&&hasProp(w,i)?w[i](C[t.id]):req.get?req.get(v,i,t,s):(c=o(i,t,!1,!0),h=c.id,hasProp(N,h)?N[h]:l(makeError("notloaded",'Module name "'+h+'" has not been loaded yet for context: '+e+(t?"":". Use require([])")))):(_(),v.nextTick(function(){_(),d=a(o(null,t)),d.skipMap=r.skipMap,d.init(i,n,u,{enabled:!0}),p()}),s)}return r=r||{},mixin(s,{isBrowser:isBrowser,toUrl:function(e){var n,r=e.lastIndexOf("."),s=e.split("/")[0],o="."===s||".."===s;return r!==-1&&(!o||r>1)&&(n=e.substring(r,e.length),e=e.substring(0,r)),v.nameToUrl(i(e,t&&t.id,!0),n,!0)},defined:function(e){return hasProp(N,o(e,t,!1,!0).id)},specified:function(e){return e=o(e,t,!1,!0).id,hasProp(N,e)||hasProp(C,e)}}),t||(s.undef=function(e){h();var i=o(e,t,!0),r=getOwn(C,e);r.undefed=!0,n(e),delete N[e],delete M[i.url],delete F[e],eachReverse(O,function(t,i){t[0]===e&&O.splice(i,1)}),delete v.defQueueMap[e],r&&(r.events.defined&&(F[e]=r.events),c(e))}),s},enable:function(e){getOwn(C,e.id)&&a(e).enable()},completeLoad:function(e){var t,i,n,s=getOwn(S.shim,e)||{},o=s.exports;for(h();O.length;){if(i=O.shift(),null===i[0]){if(i[0]=e,t)break;t=!0}else i[0]===e&&(t=!0);f(i)}if(v.defQueueMap={},n=getOwn(C,e),!t&&!hasProp(N,e)&&n&&!n.inited){if(!(!S.enforceDefine||o&&getGlobal(o)))return r(e)?void 0:l(makeError("nodefine","No define call for "+e,null,[e]));f([e,s.deps||[],s.exportsFn])}p()},nameToUrl:function(e,t,i){var n,r,s,o,a,u,l,h=getOwn(S.pkgs,e);if(h&&(e=h),l=getOwn(D,e))return v.nameToUrl(l,t,i);if(req.jsExtRegExp.test(e))a=e+(t||"");else{for(n=S.paths,r=e.split("/"),s=r.length;s>0;s-=1)if(o=r.slice(0,s).join("/"),u=getOwn(n,o)){isArray(u)&&(u=u[0]),r.splice(0,s,u);break}a=r.join("/"),a+=t||(/^data\:|^blob\:|\?/.test(a)||i?"":".js"),a=("/"===a.charAt(0)||a.match(/^[\w\+\.\-]+:/)?"":S.baseUrl)+a}return S.urlArgs&&!/^blob\:/.test(a)?a+S.urlArgs(e,a):a},load:function(e,t){req.load(v,e,t)},execCb:function(e,t,i,n){return t.apply(n,i)},onScriptLoad:function(e){if("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=m(e);v.completeLoad(t.id)}},onScriptError:function(e){var t=m(e);if(!r(t.id)){var i=[];return eachProp(C,function(e,n){0!==n.indexOf("_@r")&&each(e.depMaps,function(e){if(e.id===t.id)return i.push(n),!0})}),l(makeError("scripterror",'Script error for "'+t.id+(i.length?'", needed by: '+i.join(", "):'"'),e,[t.id]))}}},v.require=v.makeRequire(),v}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(e){if("interactive"===e.readyState)return interactiveScript=e}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.3.6",commentRegExp=/\/\*[\s\S]*?\*\/|([^:"'=]|^)\/\/.*$/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if(void 0===define){if(void 0!==requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}void 0===require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(e,t,i,n){var r,s,o="_";return isArray(e)||"string"==typeof e||(s=e,isArray(t)?(e=t,t=i,i=n):e=[]),s&&s.context&&(o=s.context),r=getOwn(contexts,o),r||(r=contexts[o]=req.s.newContext(o)),s&&r.configure(s),r.require(e,t,i)},req.config=function(e){return req(e)},req.nextTick=void 0!==setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version="2.3.6",req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(e){req[e]=function(){var t=contexts._;return t.require[e].apply(t,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],(baseElement=document.getElementsByTagName("base")[0])&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(e,t,i){var n=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return n.type=e.scriptType||"text/javascript",n.charset="utf-8",n.async=!0,n},req.load=function(e,t,i){var n,r=e&&e.config||{};if(isBrowser)return n=req.createNode(r,t,i),n.setAttribute("data-requirecontext",e.contextName),n.setAttribute("data-requiremodule",t),!n.attachEvent||n.attachEvent.toString&&n.attachEvent.toString().indexOf("[native code")<0||isOpera?(n.addEventListener("load",e.onScriptLoad,!1),n.addEventListener("error",e.onScriptError,!1)):(useInteractive=!0,n.attachEvent("onreadystatechange",e.onScriptLoad)),n.src=i,r.onNodeCreated&&r.onNodeCreated(n,r,t,i),currentlyAddingScript=n,baseElement?head.insertBefore(n,baseElement):head.appendChild(n),currentlyAddingScript=null,n;if(isWebWorker)try{setTimeout(function(){},0),importScripts(i),e.completeLoad(t)}catch(n){e.onError(makeError("importscripts","importScripts failed for "+t+" at "+i,n,[t]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(e){if(head||(head=e.parentNode),dataMain=e.getAttribute("data-main"))return mainScript=dataMain,cfg.baseUrl||mainScript.indexOf("!")!==-1||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0}),define=function(e,t,i){var n,r;"string"!=typeof e&&(i=t,t=e,e=null),isArray(t)||(i=t,t=null),!t&&isFunction(i)&&(t=[],i.length&&(i.toString().replace(/\/\*[\s\S]*?\*\/|([^:"'=]|^)\/\/.*$/gm,commentReplace).replace(/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,function(e,i){t.push(i)}),t=(1===i.length?["require"]:["require","exports","module"]).concat(t))),useInteractive&&(n=currentlyAddingScript||getInteractiveScript())&&(e||(e=n.getAttribute("data-requiremodule")),r=contexts[n.getAttribute("data-requirecontext")]),r?(r.defQueue.push([e,t,i]),r.defQueueMap[e]=!0):globalDefQueue.push([e,t,i])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this,"undefined"==typeof setTimeout?void 0:setTimeout),define("../node_modules/requirejs/require.js",function(){}),function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function i(e,t,i){t=t||oe;var n,r=t.createElement("script");if(r.text=e,i)for(n in ve)i[n]&&(r[n]=i[n]);t.head.appendChild(r).parentNode.removeChild(r)}function n(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?de[pe.call(e)]||"object":typeof e}function r(e){var t=!!e&&"length"in e&&e.length,i=n(e);return!xe(e)&&!ye(e)&&("array"===i||0===t||"number"==typeof t&&t>0&&t-1 in e)}function s(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}function o(e,t,i){return xe(t)?we.grep(e,function(e,n){return!!t.call(e,n,e)!==i}):t.nodeType?we.grep(e,function(e){return e===t!==i}):"string"!=typeof t?we.grep(e,function(e){return ce.call(t,e)>-1!==i}):we.filter(t,e,i)}function a(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function u(e){var t={};return we.each(e.match(Ee)||[],function(e,i){t[i]=!0}),t}function l(e){return e}function h(e){throw e}function c(e,t,i,n){var r;try{e&&xe(r=e.promise)?r.call(e).done(t).fail(i):e&&xe(r=e.then)?r.call(e,t,i):t.apply(void 0,[e].slice(n))}catch(e){i.apply(void 0,[e])}}function d(){oe.removeEventListener("DOMContentLoaded",d),e.removeEventListener("load",d),we.ready()}function p(e,t){return t.toUpperCase()}function f(e){return e.replace(Ae,"ms-").replace(Pe,p)}function g(){this.expando=we.expando+g.uid++}function m(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:ke.test(e)?JSON.parse(e):e)}function _(e,t,i){var n;if(void 0===i&&1===e.nodeType)if(n="data-"+t.replace(Xe,"-$&").toLowerCase(),"string"==typeof(i=e.getAttribute(n))){try{i=m(i)}catch(e){}ze.set(e,t,i)}else i=void 0;return i}function x(e,t,i,n){var r,s,o=20,a=n?function(){return n.cur()}:function(){return we.css(e,t,"")},u=a(),l=i&&i[3]||(we.cssNumber[t]?"":"px"),h=(we.cssNumber[t]||"px"!==l&&+u)&&je.exec(we.css(e,t));if(h&&h[3]!==l){for(u/=2,l=l||h[3],h=+u||1;o--;)we.style(e,t,h+l),(1-s)*(1-(s=a()/u||.5))<=0&&(o=0),h/=s;h*=2,we.style(e,t,h+l),i=i||[]}return i&&(h=+h||+u||0,r=i[1]?h+(i[1]+1)*i[2]:+i[2],n&&(n.unit=l,n.start=h,n.end=r)),r}function y(e){var t,i=e.ownerDocument,n=e.nodeName,r=We[n];return r?r:(t=i.body.appendChild(i.createElement(n)),r=we.css(t,"display"),t.parentNode.removeChild(t),"none"===r&&(r="block"),We[n]=r,r)}function v(e,t){for(var i,n,r=[],s=0,o=e.length;s<o;s++)n=e[s],n.style&&(i=n.style.display,t?("none"===i&&(r[s]=Le.get(n,"display")||null,r[s]||(n.style.display="")),""===n.style.display&&qe(n)&&(r[s]=y(n))):"none"!==i&&(r[s]="none",Le.set(n,"display",i)));for(s=0;s<o;s++)null!=r[s]&&(e[s].style.display=r[s]);return e}function w(e,t){var i;return i=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&s(e,t)?we.merge([e],i):i}function b(e,t){for(var i=0,n=e.length;i<n;i++)Le.set(e[i],"globalEval",!t||Le.get(t[i],"globalEval"))}function S(e,t,i,r,s){for(var o,a,u,l,h,c,d=t.createDocumentFragment(),p=[],f=0,g=e.length;f<g;f++)if((o=e[f])||0===o)if("object"===n(o))we.merge(p,o.nodeType?[o]:o);else if(Ze.test(o)){for(a=a||d.appendChild(t.createElement("div")),u=($e.exec(o)||["",""])[1].toLowerCase(),l=Qe[u]||Qe._default,a.innerHTML=l[1]+we.htmlPrefilter(o)+l[2],c=l[0];c--;)a=a.lastChild;we.merge(p,a.childNodes),a=d.firstChild,a.textContent=""}else p.push(t.createTextNode(o));for(d.textContent="",f=0;o=p[f++];)if(r&&we.inArray(o,r)>-1)s&&s.push(o);else if(h=we.contains(o.ownerDocument,o),a=w(d.appendChild(o),"script"),h&&b(a),i)for(c=0;o=a[c++];)Ke.test(o.type||"")&&i.push(o);return d}function C(){return!0}function T(){return!1}function F(){try{return oe.activeElement}catch(e){}}function O(e,t,i,n,r,s){var o,a;if("object"==typeof t){"string"!=typeof i&&(n=n||i,i=void 0);for(a in t)O(e,a,i,n,t[a],s);return e}if(null==n&&null==r?(r=i,n=i=void 0):null==r&&("string"==typeof i?(r=n,n=void 0):(r=n,n=i,i=void 0)),r===!1)r=T;else if(!r)return e;return 1===s&&(o=r,r=function(e){return we().off(e),o.apply(this,arguments)},r.guid=o.guid||(o.guid=we.guid++)),e.each(function(){we.event.add(this,t,r,n,i)})}function N(e,t){return s(e,"table")&&s(11!==t.nodeType?t:t.firstChild,"tr")?we(e).children("tbody")[0]||e:e}function M(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function D(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function E(e,t){var i,n,r,s,o,a,u,l;if(1===t.nodeType){if(Le.hasData(e)&&(s=Le.access(e),o=Le.set(t,s),l=s.events)){delete o.handle,o.events={};for(r in l)for(i=0,n=l[r].length;i<n;i++)we.event.add(t,r,l[r][i])}ze.hasData(e)&&(a=ze.access(e),u=we.extend({},a),ze.set(t,u))}}function V(e,t){var i=t.nodeName.toLowerCase();"input"===i&&Ye.test(e.type)?t.checked=e.checked:"input"!==i&&"textarea"!==i||(t.defaultValue=e.defaultValue)}function B(e,t,n,r){t=le.apply([],t);var s,o,a,u,l,h,c=0,d=e.length,p=d-1,f=t[0],g=xe(f);if(g||d>1&&"string"==typeof f&&!_e.checkClone&&rt.test(f))return e.each(function(i){var s=e.eq(i);g&&(t[0]=f.call(this,i,s.html())),B(s,t,n,r)});if(d&&(s=S(t,e[0].ownerDocument,!1,e,r),o=s.firstChild,1===s.childNodes.length&&(s=o),o||r)){for(a=we.map(w(s,"script"),M),u=a.length;c<d;c++)l=s,c!==p&&(l=we.clone(l,!0,!0),u&&we.merge(a,w(l,"script"))),n.call(e[c],l,c);if(u)for(h=a[a.length-1].ownerDocument,we.map(a,D),c=0;c<u;c++)l=a[c],Ke.test(l.type||"")&&!Le.access(l,"globalEval")&&we.contains(h,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?we._evalUrl&&we._evalUrl(l.src):i(l.textContent.replace(st,""),h,l))}return e}function I(e,t,i){for(var n,r=t?we.filter(t,e):e,s=0;null!=(n=r[s]);s++)i||1!==n.nodeType||we.cleanData(w(n)),n.parentNode&&(i&&we.contains(n.ownerDocument,n)&&b(w(n,"script")),n.parentNode.removeChild(n));return e}function A(e,t,i){var n,r,s,o,a=e.style;return i=i||at(e),i&&(o=i.getPropertyValue(t)||i[t],""!==o||we.contains(e.ownerDocument,e)||(o=we.style(e,t)),!_e.pixelBoxStyles()&&ot.test(o)&&ut.test(t)&&(n=a.width,r=a.minWidth,s=a.maxWidth,a.minWidth=a.maxWidth=a.width=o,o=i.width,a.width=n,a.minWidth=r,a.maxWidth=s)),void 0!==o?o+"":o}function P(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function R(e){if(e in ft)return e;for(var t=e[0].toUpperCase()+e.slice(1),i=pt.length;i--;)if((e=pt[i]+t)in ft)return e}function L(e){var t=we.cssProps[e];return t||(t=we.cssProps[e]=R(e)||e),t}function z(e,t,i){var n=je.exec(t);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):t}function k(e,t,i,n,r,s){var o="width"===t?1:0,a=0,u=0;if(i===(n?"border":"content"))return 0;for(;o<4;o+=2)"margin"===i&&(u+=we.css(e,i+Ge[o],!0,r)),n?("content"===i&&(u-=we.css(e,"padding"+Ge[o],!0,r)),"margin"!==i&&(u-=we.css(e,"border"+Ge[o]+"Width",!0,r))):(u+=we.css(e,"padding"+Ge[o],!0,r),"padding"!==i?u+=we.css(e,"border"+Ge[o]+"Width",!0,r):a+=we.css(e,"border"+Ge[o]+"Width",!0,r));return!n&&s>=0&&(u+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-s-u-a-.5))),u}function X(e,t,i){var n=at(e),r=A(e,t,n),s="border-box"===we.css(e,"boxSizing",!1,n),o=s;if(ot.test(r)){if(!i)return r;r="auto"}return o=o&&(_e.boxSizingReliable()||r===e.style[t]),("auto"===r||!parseFloat(r)&&"inline"===we.css(e,"display",!1,n))&&(r=e["offset"+t[0].toUpperCase()+t.slice(1)],o=!0),(r=parseFloat(r)||0)+k(e,t,i||(s?"border":"content"),o,n,r)+"px"}function U(e,t,i,n,r){return new U.prototype.init(e,t,i,n,r)}function j(){mt&&(oe.hidden===!1&&e.requestAnimationFrame?e.requestAnimationFrame(j):e.setTimeout(j,we.fx.interval),we.fx.tick())}function G(){return e.setTimeout(function(){gt=void 0}),gt=Date.now()}function q(e,t){var i,n=0,r={height:e};for(t=t?1:0;n<4;n+=2-t)i=Ge[n],r["margin"+i]=r["padding"+i]=e;return t&&(r.opacity=r.width=e),r}function H(e,t,i){for(var n,r=($.tweeners[t]||[]).concat($.tweeners["*"]),s=0,o=r.length;s<o;s++)if(n=r[s].call(i,t,e))return n}function W(e,t,i){var n,r,s,o,a,u,l,h,c="width"in t||"height"in t,d=this,p={},f=e.style,g=e.nodeType&&qe(e),m=Le.get(e,"fxshow");i.queue||(o=we._queueHooks(e,"fx"),null==o.unqueued&&(o.unqueued=0,a=o.empty.fire,o.empty.fire=function(){o.unqueued||a()}),o.unqueued++,d.always(function(){d.always(function(){o.unqueued--,we.queue(e,"fx").length||o.empty.fire()})}));for(n in t)if(r=t[n],_t.test(r)){if(delete t[n],s=s||"toggle"===r,r===(g?"hide":"show")){if("show"!==r||!m||void 0===m[n])continue;g=!0}p[n]=m&&m[n]||we.style(e,n)}if((u=!we.isEmptyObject(t))||!we.isEmptyObject(p)){c&&1===e.nodeType&&(i.overflow=[f.overflow,f.overflowX,f.overflowY],l=m&&m.display,null==l&&(l=Le.get(e,"display")),h=we.css(e,"display"),"none"===h&&(l?h=l:(v([e],!0),l=e.style.display||l,h=we.css(e,"display"),v([e]))),("inline"===h||"inline-block"===h&&null!=l)&&"none"===we.css(e,"float")&&(u||(d.done(function(){f.display=l}),null==l&&(h=f.display,l="none"===h?"":h)),f.display="inline-block")),i.overflow&&(f.overflow="hidden",d.always(function(){f.overflow=i.overflow[0],f.overflowX=i.overflow[1],f.overflowY=i.overflow[2]})),u=!1;for(n in p)u||(m?"hidden"in m&&(g=m.hidden):m=Le.access(e,"fxshow",{display:l}),s&&(m.hidden=!g),g&&v([e],!0),d.done(function(){g||v([e]),Le.remove(e,"fxshow");for(n in p)we.style(e,n,p[n])})),u=H(g?m[n]:0,n,d),n in m||(m[n]=u.start,g&&(u.end=u.start,u.start=0))}}function Y(e,t){var i,n,r,s,o;for(i in e)if(n=f(i),r=t[n],s=e[i],Array.isArray(s)&&(r=s[1],s=e[i]=s[0]),i!==n&&(e[n]=s,delete e[i]),(o=we.cssHooks[n])&&"expand"in o){s=o.expand(s),delete e[n];for(i in s)i in e||(e[i]=s[i],t[i]=r)}else t[n]=r}function $(e,t,i){var n,r,s=0,o=$.prefilters.length,a=we.Deferred().always(function(){delete u.elem}),u=function(){if(r)return!1;for(var t=gt||G(),i=Math.max(0,l.startTime+l.duration-t),n=i/l.duration||0,s=1-n,o=0,u=l.tweens.length;o<u;o++)l.tweens[o].run(s);return a.notifyWith(e,[l,s,i]),s<1&&u?i:(u||a.notifyWith(e,[l,1,0]),a.resolveWith(e,[l]),!1)},l=a.promise({elem:e,props:we.extend({},t),opts:we.extend(!0,{specialEasing:{},easing:we.easing._default},i),originalProperties:t,originalOptions:i,startTime:gt||G(),duration:i.duration,tweens:[],createTween:function(t,i){var n=we.Tween(e,l.opts,t,i,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(n),n},stop:function(t){var i=0,n=t?l.tweens.length:0;if(r)return this;for(r=!0;i<n;i++)l.tweens[i].run(1);return t?(a.notifyWith(e,[l,1,0]),a.resolveWith(e,[l,t])):a.rejectWith(e,[l,t]),this}}),h=l.props;for(Y(h,l.opts.specialEasing);s<o;s++)if(n=$.prefilters[s].call(l,e,h,l.opts))return xe(n.stop)&&(we._queueHooks(l.elem,l.opts.queue).stop=n.stop.bind(n)),n;return we.map(h,H,l),xe(l.opts.start)&&l.opts.start.call(e,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),we.fx.timer(we.extend(u,{elem:e,anim:l,queue:l.opts.queue})),l}function K(e){return(e.match(Ee)||[]).join(" ")}function Q(e){return e.getAttribute&&e.getAttribute("class")||""}function Z(e){return Array.isArray(e)?e:"string"==typeof e?e.match(Ee)||[]:[]}function J(e,t,i,r){var s;if(Array.isArray(t))we.each(t,function(t,n){i||Nt.test(e)?r(e,n):J(e+"["+("object"==typeof n&&null!=n?t:"")+"]",n,i,r)});else if(i||"object"!==n(t))r(e,t);else for(s in t)J(e+"["+s+"]",t[s],i,r)}function ee(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var n,r=0,s=t.toLowerCase().match(Ee)||[];if(xe(i))for(;n=s[r++];)"+"===n[0]?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(i)):(e[n]=e[n]||[]).push(i)}}function te(e,t,i,n){function r(a){var u;return s[a]=!0,we.each(e[a]||[],function(e,a){var l=a(t,i,n);return"string"!=typeof l||o||s[l]?o?!(u=l):void 0:(t.dataTypes.unshift(l),r(l),!1)}),u}var s={},o=e===At;return r(t.dataTypes[0])||!s["*"]&&r("*")}function ie(e,t){var i,n,r=we.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((r[i]?e:n||(n={}))[i]=t[i]);return n&&we.extend(!0,e,n),e}function ne(e,t,i){for(var n,r,s,o,a=e.contents,u=e.dataTypes;"*"===u[0];)u.shift(),void 0===n&&(n=e.mimeType||t.getResponseHeader("Content-Type"));if(n)for(r in a)if(a[r]&&a[r].test(n)){u.unshift(r);break}if(u[0]in i)s=u[0];else{for(r in i){if(!u[0]||e.converters[r+" "+u[0]]){s=r;break}o||(o=r)}s=s||o}if(s)return s!==u[0]&&u.unshift(s),i[s]}function re(e,t,i,n){var r,s,o,a,u,l={},h=e.dataTypes.slice();if(h[1])for(o in e.converters)l[o.toLowerCase()]=e.converters[o];for(s=h.shift();s;)if(e.responseFields[s]&&(i[e.responseFields[s]]=t),!u&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=s,s=h.shift())if("*"===s)s=u;else if("*"!==u&&u!==s){if(!(o=l[u+" "+s]||l["* "+s]))for(r in l)if(a=r.split(" "),a[1]===s&&(o=l[u+" "+a[0]]||l["* "+a[0]])){o===!0?o=l[r]:l[r]!==!0&&(s=a[0],h.unshift(a[1]));break}if(o!==!0)if(o&&e.throws)t=o(t);else try{t=o(t)}catch(e){return{state:"parsererror",error:o?e:"No conversion from "+u+" to "+s}}}return{state:"success",data:t}}var se=[],oe=e.document,ae=Object.getPrototypeOf,ue=se.slice,le=se.concat,he=se.push,ce=se.indexOf,de={},pe=de.toString,fe=de.hasOwnProperty,ge=fe.toString,me=ge.call(Object),_e={},xe=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},ye=function(e){return null!=e&&e===e.window},ve={type:!0,src:!0,noModule:!0},we=function(e,t){return new we.fn.init(e,t)};we.fn=we.prototype={jquery:"3.3.1",constructor:we,length:0,toArray:function(){return ue.call(this)},get:function(e){return null==e?ue.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=we.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return we.each(this,e)},map:function(e){return this.pushStack(we.map(this,function(t,i){return e.call(t,i,t)}))},slice:function(){return this.pushStack(ue.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(e<0?t:0);return this.pushStack(i>=0&&i<t?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:he,sort:se.sort,splice:se.splice},we.extend=we.fn.extend=function(){var e,t,i,n,r,s,o=arguments[0]||{},a=1,u=arguments.length,l=!1;for("boolean"==typeof o&&(l=o,o=arguments[a]||{},a++),"object"==typeof o||xe(o)||(o={}),a===u&&(o=this,a--);a<u;a++)if(null!=(e=arguments[a]))for(t in e)i=o[t],n=e[t],
o!==n&&(l&&n&&(we.isPlainObject(n)||(r=Array.isArray(n)))?(r?(r=!1,s=i&&Array.isArray(i)?i:[]):s=i&&we.isPlainObject(i)?i:{},o[t]=we.extend(l,s,n)):void 0!==n&&(o[t]=n));return o},we.extend({expando:"jQuery"+("3.3.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,i;return!(!e||"[object Object]"!==pe.call(e))&&(!(t=ae(e))||"function"==typeof(i=fe.call(t,"constructor")&&t.constructor)&&ge.call(i)===me)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e){i(e)},each:function(e,t){var i,n=0;if(r(e))for(i=e.length;n<i&&t.call(e[n],n,e[n])!==!1;n++);else for(n in e)if(t.call(e[n],n,e[n])===!1)break;return e},trim:function(e){return null==e?"":(e+"").replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},makeArray:function(e,t){var i=t||[];return null!=e&&(r(Object(e))?we.merge(i,"string"==typeof e?[e]:e):he.call(i,e)),i},inArray:function(e,t,i){return null==t?-1:ce.call(t,e,i)},merge:function(e,t){for(var i=+t.length,n=0,r=e.length;n<i;n++)e[r++]=t[n];return e.length=r,e},grep:function(e,t,i){for(var n=[],r=0,s=e.length,o=!i;r<s;r++)!t(e[r],r)!==o&&n.push(e[r]);return n},map:function(e,t,i){var n,s,o=0,a=[];if(r(e))for(n=e.length;o<n;o++)null!=(s=t(e[o],o,i))&&a.push(s);else for(o in e)null!=(s=t(e[o],o,i))&&a.push(s);return le.apply([],a)},guid:1,support:_e}),"function"==typeof Symbol&&(we.fn[Symbol.iterator]=se[Symbol.iterator]),we.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){de["[object "+t+"]"]=t.toLowerCase()});var be=function(e){function t(e,t,i,n){var r,s,o,a,u,h,d,p=t&&t.ownerDocument,f=t?t.nodeType:9;if(i=i||[],"string"!=typeof e||!e||1!==f&&9!==f&&11!==f)return i;if(!n&&((t?t.ownerDocument||t:z)!==E&&D(t),t=t||E,B)){if(11!==f&&(u=ge.exec(e)))if(r=u[1]){if(9===f){if(!(o=t.getElementById(r)))return i;if(o.id===r)return i.push(o),i}else if(p&&(o=p.getElementById(r))&&R(t,o)&&o.id===r)return i.push(o),i}else{if(u[2])return K.apply(i,t.getElementsByTagName(e)),i;if((r=u[3])&&v.getElementsByClassName&&t.getElementsByClassName)return K.apply(i,t.getElementsByClassName(r)),i}if(v.qsa&&!G[e+" "]&&(!I||!I.test(e))){if(1!==f)p=t,d=e;else if("object"!==t.nodeName.toLowerCase()){for((a=t.getAttribute("id"))?a=a.replace(ye,ve):t.setAttribute("id",a=L),h=C(e),s=h.length;s--;)h[s]="#"+a+" "+c(h[s]);d=h.join(","),p=me.test(e)&&l(t.parentNode)||t}if(d)try{return K.apply(i,p.querySelectorAll(d)),i}catch(e){}finally{a===L&&t.removeAttribute("id")}}}return F(e.replace(se,"$1"),t,i,n)}function i(){function e(i,n){return t.push(i+" ")>w.cacheLength&&delete e[t.shift()],e[i+" "]=n}var t=[];return e}function n(e){return e[L]=!0,e}function r(e){var t=E.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function s(e,t){for(var i=e.split("|"),n=i.length;n--;)w.attrHandle[i[n]]=t}function o(e,t){var i=t&&e,n=i&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function a(e){return function(t){return"form"in t?t.parentNode&&t.disabled===!1?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&be(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function u(e){return n(function(t){return t=+t,n(function(i,n){for(var r,s=e([],i.length,t),o=s.length;o--;)i[r=s[o]]&&(i[r]=!(n[r]=i[r]))})})}function l(e){return e&&void 0!==e.getElementsByTagName&&e}function h(){}function c(e){for(var t=0,i=e.length,n="";t<i;t++)n+=e[t].value;return n}function d(e,t,i){var n=t.dir,r=t.next,s=r||n,o=i&&"parentNode"===s,a=X++;return t.first?function(t,i,r){for(;t=t[n];)if(1===t.nodeType||o)return e(t,i,r);return!1}:function(t,i,u){var l,h,c,d=[k,a];if(u){for(;t=t[n];)if((1===t.nodeType||o)&&e(t,i,u))return!0}else for(;t=t[n];)if(1===t.nodeType||o)if(c=t[L]||(t[L]={}),h=c[t.uniqueID]||(c[t.uniqueID]={}),r&&r===t.nodeName.toLowerCase())t=t[n]||t;else{if((l=h[s])&&l[0]===k&&l[1]===a)return d[2]=l[2];if(h[s]=d,d[2]=e(t,i,u))return!0}return!1}}function p(e){return e.length>1?function(t,i,n){for(var r=e.length;r--;)if(!e[r](t,i,n))return!1;return!0}:e[0]}function f(e,i,n){for(var r=0,s=i.length;r<s;r++)t(e,i[r],n);return n}function g(e,t,i,n,r){for(var s,o=[],a=0,u=e.length,l=null!=t;a<u;a++)(s=e[a])&&(i&&!i(s,n,r)||(o.push(s),l&&t.push(a)));return o}function m(e,t,i,r,s,o){return r&&!r[L]&&(r=m(r)),s&&!s[L]&&(s=m(s,o)),n(function(n,o,a,u){var l,h,c,d=[],p=[],m=o.length,_=n||f(t||"*",a.nodeType?[a]:a,[]),x=!e||!n&&t?_:g(_,d,e,a,u),y=i?s||(n?e:m||r)?[]:o:x;if(i&&i(x,y,a,u),r)for(l=g(y,p),r(l,[],a,u),h=l.length;h--;)(c=l[h])&&(y[p[h]]=!(x[p[h]]=c));if(n){if(s||e){if(s){for(l=[],h=y.length;h--;)(c=y[h])&&l.push(x[h]=c);s(null,y=[],l,u)}for(h=y.length;h--;)(c=y[h])&&(l=s?Z(n,c):d[h])>-1&&(n[l]=!(o[l]=c))}}else y=g(y===o?y.splice(m,y.length):y),s?s(null,o,y,u):K.apply(o,y)})}function _(e){for(var t,i,n,r=e.length,s=w.relative[e[0].type],o=s||w.relative[" "],a=s?1:0,u=d(function(e){return e===t},o,!0),l=d(function(e){return Z(t,e)>-1},o,!0),h=[function(e,i,n){var r=!s&&(n||i!==O)||((t=i).nodeType?u(e,i,n):l(e,i,n));return t=null,r}];a<r;a++)if(i=w.relative[e[a].type])h=[d(p(h),i)];else{if(i=w.filter[e[a].type].apply(null,e[a].matches),i[L]){for(n=++a;n<r&&!w.relative[e[n].type];n++);return m(a>1&&p(h),a>1&&c(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(se,"$1"),i,a<n&&_(e.slice(a,n)),n<r&&_(e=e.slice(n)),n<r&&c(e))}h.push(i)}return p(h)}function x(e,i){var r=i.length>0,s=e.length>0,o=function(n,o,a,u,l){var h,c,d,p=0,f="0",m=n&&[],_=[],x=O,y=n||s&&w.find.TAG("*",l),v=k+=null==x?1:Math.random()||.1,b=y.length;for(l&&(O=o===E||o||l);f!==b&&null!=(h=y[f]);f++){if(s&&h){for(c=0,o||h.ownerDocument===E||(D(h),a=!B);d=e[c++];)if(d(h,o||E,a)){u.push(h);break}l&&(k=v)}r&&((h=!d&&h)&&p--,n&&m.push(h))}if(p+=f,r&&f!==p){for(c=0;d=i[c++];)d(m,_,o,a);if(n){if(p>0)for(;f--;)m[f]||_[f]||(_[f]=Y.call(u));_=g(_)}K.apply(u,_),l&&!n&&_.length>0&&p+i.length>1&&t.uniqueSort(u)}return l&&(k=v,O=x),m};return r?n(o):o}var y,v,w,b,S,C,T,F,O,N,M,D,E,V,B,I,A,P,R,L="sizzle"+1*new Date,z=e.document,k=0,X=0,U=i(),j=i(),G=i(),q=function(e,t){return e===t&&(M=!0),0},H={}.hasOwnProperty,W=[],Y=W.pop,$=W.push,K=W.push,Q=W.slice,Z=function(e,t){for(var i=0,n=e.length;i<n;i++)if(e[i]===t)return i;return-1},J="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ee="[\\x20\\t\\r\\n\\f]",te="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",ie="\\["+ee+"*("+te+")(?:"+ee+"*([*^$|!~]?=)"+ee+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+te+"))|)"+ee+"*\\]",ne=":("+te+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+ie+")*)|.*)\\)|)",re=new RegExp(ee+"+","g"),se=new RegExp("^"+ee+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ee+"+$","g"),oe=new RegExp("^"+ee+"*,"+ee+"*"),ae=new RegExp("^"+ee+"*([>+~]|"+ee+")"+ee+"*"),ue=new RegExp("="+ee+"*([^\\]'\"]*?)"+ee+"*\\]","g"),le=new RegExp(ne),he=new RegExp("^"+te+"$"),ce={ID:new RegExp("^#("+te+")"),CLASS:new RegExp("^\\.("+te+")"),TAG:new RegExp("^("+te+"|[*])"),ATTR:new RegExp("^"+ie),PSEUDO:new RegExp("^"+ne),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ee+"*(even|odd|(([+-]|)(\\d*)n|)"+ee+"*(?:([+-]|)"+ee+"*(\\d+)|))"+ee+"*\\)|)","i"),bool:new RegExp("^(?:"+J+")$","i"),needsContext:new RegExp("^"+ee+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ee+"*((?:-\\d)?\\d*)"+ee+"*\\)|)(?=[^-]|$)","i")},de=/^(?:input|select|textarea|button)$/i,pe=/^h\d$/i,fe=/^[^{]+\{\s*\[native \w/,ge=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,me=/[+~]/,_e=new RegExp("\\\\([\\da-f]{1,6}"+ee+"?|("+ee+")|.)","ig"),xe=function(e,t,i){var n="0x"+t-65536;return n!==n||i?t:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},ye=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ve=function(e,t){return t?"\0"===e?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},we=function(){D()},be=d(function(e){return e.disabled===!0&&("form"in e||"label"in e)},{dir:"parentNode",next:"legend"});try{K.apply(W=Q.call(z.childNodes),z.childNodes),W[z.childNodes.length].nodeType}catch(e){K={apply:W.length?function(e,t){$.apply(e,Q.call(t))}:function(e,t){for(var i=e.length,n=0;e[i++]=t[n++];);e.length=i-1}}}v=t.support={},S=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},D=t.setDocument=function(e){var t,i,n=e?e.ownerDocument||e:z;return n!==E&&9===n.nodeType&&n.documentElement?(E=n,V=E.documentElement,B=!S(E),z!==E&&(i=E.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",we,!1):i.attachEvent&&i.attachEvent("onunload",we)),v.attributes=r(function(e){return e.className="i",!e.getAttribute("className")}),v.getElementsByTagName=r(function(e){return e.appendChild(E.createComment("")),!e.getElementsByTagName("*").length}),v.getElementsByClassName=fe.test(E.getElementsByClassName),v.getById=r(function(e){return V.appendChild(e).id=L,!E.getElementsByName||!E.getElementsByName(L).length}),v.getById?(w.filter.ID=function(e){var t=e.replace(_e,xe);return function(e){return e.getAttribute("id")===t}},w.find.ID=function(e,t){if(void 0!==t.getElementById&&B){var i=t.getElementById(e);return i?[i]:[]}}):(w.filter.ID=function(e){var t=e.replace(_e,xe);return function(e){var i=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return i&&i.value===t}},w.find.ID=function(e,t){if(void 0!==t.getElementById&&B){var i,n,r,s=t.getElementById(e);if(s){if((i=s.getAttributeNode("id"))&&i.value===e)return[s];for(r=t.getElementsByName(e),n=0;s=r[n++];)if((i=s.getAttributeNode("id"))&&i.value===e)return[s]}return[]}}),w.find.TAG=v.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):v.qsa?t.querySelectorAll(e):void 0}:function(e,t){var i,n=[],r=0,s=t.getElementsByTagName(e);if("*"===e){for(;i=s[r++];)1===i.nodeType&&n.push(i);return n}return s},w.find.CLASS=v.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&B)return t.getElementsByClassName(e)},A=[],I=[],(v.qsa=fe.test(E.querySelectorAll))&&(r(function(e){V.appendChild(e).innerHTML="<a id='"+L+"'></a><select id='"+L+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&I.push("[*^$]="+ee+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||I.push("\\["+ee+"*(?:value|"+J+")"),e.querySelectorAll("[id~="+L+"-]").length||I.push("~="),e.querySelectorAll(":checked").length||I.push(":checked"),e.querySelectorAll("a#"+L+"+*").length||I.push(".#.+[+~]")}),r(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=E.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&I.push("name"+ee+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&I.push(":enabled",":disabled"),V.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&I.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),I.push(",.*:")})),(v.matchesSelector=fe.test(P=V.matches||V.webkitMatchesSelector||V.mozMatchesSelector||V.oMatchesSelector||V.msMatchesSelector))&&r(function(e){v.disconnectedMatch=P.call(e,"*"),P.call(e,"[s!='']:x"),A.push("!=",ne)}),I=I.length&&new RegExp(I.join("|")),A=A.length&&new RegExp(A.join("|")),t=fe.test(V.compareDocumentPosition),R=t||fe.test(V.contains)?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},q=t?function(e,t){if(e===t)return M=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i?i:(i=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&i||!v.sortDetached&&t.compareDocumentPosition(e)===i?e===E||e.ownerDocument===z&&R(z,e)?-1:t===E||t.ownerDocument===z&&R(z,t)?1:N?Z(N,e)-Z(N,t):0:4&i?-1:1)}:function(e,t){if(e===t)return M=!0,0;var i,n=0,r=e.parentNode,s=t.parentNode,a=[e],u=[t];if(!r||!s)return e===E?-1:t===E?1:r?-1:s?1:N?Z(N,e)-Z(N,t):0;if(r===s)return o(e,t);for(i=e;i=i.parentNode;)a.unshift(i);for(i=t;i=i.parentNode;)u.unshift(i);for(;a[n]===u[n];)n++;return n?o(a[n],u[n]):a[n]===z?-1:u[n]===z?1:0},E):E},t.matches=function(e,i){return t(e,null,null,i)},t.matchesSelector=function(e,i){if((e.ownerDocument||e)!==E&&D(e),i=i.replace(ue,"='$1']"),v.matchesSelector&&B&&!G[i+" "]&&(!A||!A.test(i))&&(!I||!I.test(i)))try{var n=P.call(e,i);if(n||v.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){}return t(i,E,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==E&&D(e),R(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==E&&D(e);var i=w.attrHandle[t.toLowerCase()],n=i&&H.call(w.attrHandle,t.toLowerCase())?i(e,t,!B):void 0;return void 0!==n?n:v.attributes||!B?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},t.escape=function(e){return(e+"").replace(ye,ve)},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,i=[],n=0,r=0;if(M=!v.detectDuplicates,N=!v.sortStable&&e.slice(0),e.sort(q),M){for(;t=e[r++];)t===e[r]&&(n=i.push(r));for(;n--;)e.splice(i[n],1)}return N=null,e},b=t.getText=function(e){var t,i="",n=0,r=e.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=b(e)}else if(3===r||4===r)return e.nodeValue}else for(;t=e[n++];)i+=b(t);return i},w=t.selectors={cacheLength:50,createPseudo:n,match:ce,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(_e,xe),e[3]=(e[3]||e[4]||e[5]||"").replace(_e,xe),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,i=!e[6]&&e[2];return ce.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":i&&le.test(i)&&(t=C(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(_e,xe).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=U[e+" "];return t||(t=new RegExp("(^|"+ee+")"+e+"("+ee+"|$)"))&&U(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,i,n){return function(r){var s=t.attr(r,e);return null==s?"!="===i:!i||(s+="","="===i?s===n:"!="===i?s!==n:"^="===i?n&&0===s.indexOf(n):"*="===i?n&&s.indexOf(n)>-1:"$="===i?n&&s.slice(-n.length)===n:"~="===i?(" "+s.replace(re," ")+" ").indexOf(n)>-1:"|="===i&&(s===n||s.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,i,n,r){var s="nth"!==e.slice(0,3),o="last"!==e.slice(-4),a="of-type"===t;return 1===n&&0===r?function(e){return!!e.parentNode}:function(t,i,u){var l,h,c,d,p,f,g=s!==o?"nextSibling":"previousSibling",m=t.parentNode,_=a&&t.nodeName.toLowerCase(),x=!u&&!a,y=!1;if(m){if(s){for(;g;){for(d=t;d=d[g];)if(a?d.nodeName.toLowerCase()===_:1===d.nodeType)return!1;f=g="only"===e&&!f&&"nextSibling"}return!0}if(f=[o?m.firstChild:m.lastChild],o&&x){for(d=m,c=d[L]||(d[L]={}),h=c[d.uniqueID]||(c[d.uniqueID]={}),l=h[e]||[],p=l[0]===k&&l[1],y=p&&l[2],d=p&&m.childNodes[p];d=++p&&d&&d[g]||(y=p=0)||f.pop();)if(1===d.nodeType&&++y&&d===t){h[e]=[k,p,y];break}}else if(x&&(d=t,c=d[L]||(d[L]={}),h=c[d.uniqueID]||(c[d.uniqueID]={}),l=h[e]||[],p=l[0]===k&&l[1],y=p),y===!1)for(;(d=++p&&d&&d[g]||(y=p=0)||f.pop())&&((a?d.nodeName.toLowerCase()!==_:1!==d.nodeType)||!++y||(x&&(c=d[L]||(d[L]={}),h=c[d.uniqueID]||(c[d.uniqueID]={}),h[e]=[k,y]),d!==t)););return(y-=r)===n||y%n==0&&y/n>=0}}},PSEUDO:function(e,i){var r,s=w.pseudos[e]||w.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return s[L]?s(i):s.length>1?(r=[e,e,"",i],w.setFilters.hasOwnProperty(e.toLowerCase())?n(function(e,t){for(var n,r=s(e,i),o=r.length;o--;)n=Z(e,r[o]),e[n]=!(t[n]=r[o])}):function(e){return s(e,0,r)}):s}},pseudos:{not:n(function(e){var t=[],i=[],r=T(e.replace(se,"$1"));return r[L]?n(function(e,t,i,n){for(var s,o=r(e,null,n,[]),a=e.length;a--;)(s=o[a])&&(e[a]=!(t[a]=s))}):function(e,n,s){return t[0]=e,r(t,null,s,i),t[0]=null,!i.pop()}}),has:n(function(e){return function(i){return t(e,i).length>0}}),contains:n(function(e){return e=e.replace(_e,xe),function(t){return(t.textContent||t.innerText||b(t)).indexOf(e)>-1}}),lang:n(function(e){return he.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(_e,xe).toLowerCase(),function(t){var i;do if(i=B?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(i=i.toLowerCase())===e||0===i.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType)return!1}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===V},focus:function(e){return e===E.activeElement&&(!E.hasFocus||E.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:a(!1),disabled:a(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!w.pseudos.empty(e)},header:function(e){return pe.test(e.nodeName)},input:function(e){return de.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:u(function(){return[0]}),last:u(function(e,t){return[t-1]}),eq:u(function(e,t,i){return[i<0?i+t:i]}),even:u(function(e,t){for(var i=0;i<t;i+=2)e.push(i);return e}),odd:u(function(e,t){for(var i=1;i<t;i+=2)e.push(i);return e}),lt:u(function(e,t,i){for(var n=i<0?i+t:i;--n>=0;)e.push(n);return e}),gt:u(function(e,t,i){for(var n=i<0?i+t:i;++n<t;)e.push(n);return e})}},w.pseudos.nth=w.pseudos.eq;for(y in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})w.pseudos[y]=function(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}(y);for(y in{submit:!0,reset:!0})w.pseudos[y]=function(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}(y);return h.prototype=w.filters=w.pseudos,w.setFilters=new h,C=t.tokenize=function(e,i){var n,r,s,o,a,u,l,h=j[e+" "];if(h)return i?0:h.slice(0);for(a=e,u=[],l=w.preFilter;a;){n&&!(r=oe.exec(a))||(r&&(a=a.slice(r[0].length)||a),u.push(s=[])),n=!1,(r=ae.exec(a))&&(n=r.shift(),s.push({value:n,type:r[0].replace(se," ")}),a=a.slice(n.length));for(o in w.filter)!(r=ce[o].exec(a))||l[o]&&!(r=l[o](r))||(n=r.shift(),s.push({value:n,type:o,matches:r}),a=a.slice(n.length));if(!n)break}return i?a.length:a?t.error(e):j(e,u).slice(0)},T=t.compile=function(e,t){var i,n=[],r=[],s=G[e+" "];if(!s){for(t||(t=C(e)),i=t.length;i--;)s=_(t[i]),s[L]?n.push(s):r.push(s);s=G(e,x(r,n)),s.selector=e}return s},F=t.select=function(e,t,i,n){var r,s,o,a,u,h="function"==typeof e&&e,d=!n&&C(e=h.selector||e);if(i=i||[],1===d.length){if(s=d[0]=d[0].slice(0),s.length>2&&"ID"===(o=s[0]).type&&9===t.nodeType&&B&&w.relative[s[1].type]){if(!(t=(w.find.ID(o.matches[0].replace(_e,xe),t)||[])[0]))return i;h&&(t=t.parentNode),e=e.slice(s.shift().value.length)}for(r=ce.needsContext.test(e)?0:s.length;r--&&(o=s[r],!w.relative[a=o.type]);)if((u=w.find[a])&&(n=u(o.matches[0].replace(_e,xe),me.test(s[0].type)&&l(t.parentNode)||t))){if(s.splice(r,1),!(e=n.length&&c(s)))return K.apply(i,n),i;break}}return(h||T(e,d))(n,t,!B,i,!t||me.test(e)&&l(t.parentNode)||t),i},v.sortStable=L.split("").sort(q).join("")===L,v.detectDuplicates=!!M,D(),v.sortDetached=r(function(e){return 1&e.compareDocumentPosition(E.createElement("fieldset"))}),r(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||s("type|href|height|width",function(e,t,i){if(!i)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),v.attributes&&r(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||s("value",function(e,t,i){if(!i&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),r(function(e){return null==e.getAttribute("disabled")})||s(J,function(e,t,i){var n;if(!i)return e[t]===!0?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null}),t}(e);we.find=be,we.expr=be.selectors,we.expr[":"]=we.expr.pseudos,we.uniqueSort=we.unique=be.uniqueSort,we.text=be.getText,we.isXMLDoc=be.isXML,we.contains=be.contains,we.escapeSelector=be.escape;var Se=function(e,t,i){for(var n=[],r=void 0!==i;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(r&&we(e).is(i))break;n.push(e)}return n},Ce=function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i},Te=we.expr.match.needsContext,Fe=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;we.filter=function(e,t,i){var n=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===n.nodeType?we.find.matchesSelector(n,e)?[n]:[]:we.find.matches(e,we.grep(t,function(e){return 1===e.nodeType}))},we.fn.extend({find:function(e){var t,i,n=this.length,r=this;if("string"!=typeof e)return this.pushStack(we(e).filter(function(){for(t=0;t<n;t++)if(we.contains(r[t],this))return!0}));for(i=this.pushStack([]),t=0;t<n;t++)we.find(e,r[t],i);return n>1?we.uniqueSort(i):i},filter:function(e){return this.pushStack(o(this,e||[],!1))},not:function(e){return this.pushStack(o(this,e||[],!0))},is:function(e){return!!o(this,"string"==typeof e&&Te.test(e)?we(e):e||[],!1).length}});var Oe,Ne=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(we.fn.init=function(e,t,i){var n,r;if(!e)return this;if(i=i||Oe,"string"==typeof e){if(!(n="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:Ne.exec(e))||!n[1]&&t)return!t||t.jquery?(t||i).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof we?t[0]:t,we.merge(this,we.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:oe,!0)),Fe.test(n[1])&&we.isPlainObject(t))for(n in t)xe(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}return r=oe.getElementById(n[2]),r&&(this[0]=r,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):xe(e)?void 0!==i.ready?i.ready(e):e(we):we.makeArray(e,this)}).prototype=we.fn,Oe=we(oe);var Me=/^(?:parents|prev(?:Until|All))/,De={children:!0,contents:!0,next:!0,prev:!0};we.fn.extend({has:function(e){var t=we(e,this),i=t.length;return this.filter(function(){for(var e=0;e<i;e++)if(we.contains(this,t[e]))return!0})},closest:function(e,t){var i,n=0,r=this.length,s=[],o="string"!=typeof e&&we(e);if(!Te.test(e))for(;n<r;n++)for(i=this[n];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(o?o.index(i)>-1:1===i.nodeType&&we.find.matchesSelector(i,e))){s.push(i);break}return this.pushStack(s.length>1?we.uniqueSort(s):s)},index:function(e){return e?"string"==typeof e?ce.call(we(e),this[0]):ce.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(we.uniqueSort(we.merge(this.get(),we(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),we.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return Se(e,"parentNode")},parentsUntil:function(e,t,i){return Se(e,"parentNode",i)},next:function(e){return a(e,"nextSibling")},prev:function(e){return a(e,"previousSibling")},nextAll:function(e){return Se(e,"nextSibling")},prevAll:function(e){return Se(e,"previousSibling")},nextUntil:function(e,t,i){return Se(e,"nextSibling",i)},prevUntil:function(e,t,i){return Se(e,"previousSibling",i)},siblings:function(e){return Ce((e.parentNode||{}).firstChild,e)},children:function(e){return Ce(e.firstChild)},contents:function(e){return s(e,"iframe")?e.contentDocument:(s(e,"template")&&(e=e.content||e),we.merge([],e.childNodes))}},function(e,t){we.fn[e]=function(i,n){var r=we.map(this,t,i);return"Until"!==e.slice(-5)&&(n=i),n&&"string"==typeof n&&(r=we.filter(n,r)),this.length>1&&(De[e]||we.uniqueSort(r),Me.test(e)&&r.reverse()),this.pushStack(r)}});var Ee=/[^\x20\t\r\n\f]+/g;we.Callbacks=function(e){e="string"==typeof e?u(e):we.extend({},e);var t,i,r,s,o=[],a=[],l=-1,h=function(){for(s=s||e.once,r=t=!0;a.length;l=-1)for(i=a.shift();++l<o.length;)o[l].apply(i[0],i[1])===!1&&e.stopOnFalse&&(l=o.length,i=!1);e.memory||(i=!1),t=!1,s&&(o=i?[]:"")},c={add:function(){return o&&(i&&!t&&(l=o.length-1,a.push(i)),function t(i){we.each(i,function(i,r){xe(r)?e.unique&&c.has(r)||o.push(r):r&&r.length&&"string"!==n(r)&&t(r)})}(arguments),i&&!t&&h()),this},remove:function(){return we.each(arguments,function(e,t){for(var i;(i=we.inArray(t,o,i))>-1;)o.splice(i,1),i<=l&&l--}),this},has:function(e){return e?we.inArray(e,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return s=a=[],o=i="",this},disabled:function(){return!o},lock:function(){return s=a=[],i||t||(o=i=""),this},locked:function(){return!!s},fireWith:function(e,i){return s||(i=i||[],i=[e,i.slice?i.slice():i],a.push(i),t||h()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!r}};return c},we.extend({Deferred:function(t){var i=[["notify","progress",we.Callbacks("memory"),we.Callbacks("memory"),2],["resolve","done",we.Callbacks("once memory"),we.Callbacks("once memory"),0,"resolved"],["reject","fail",we.Callbacks("once memory"),we.Callbacks("once memory"),1,"rejected"]],n="pending",r={state:function(){return n},always:function(){return s.done(arguments).fail(arguments),this},catch:function(e){return r.then(null,e)},pipe:function(){var e=arguments;return we.Deferred(function(t){we.each(i,function(i,n){var r=xe(e[n[4]])&&e[n[4]];s[n[1]](function(){var e=r&&r.apply(this,arguments);e&&xe(e.promise)?e.promise().progress(t.notify).done(t.resolve).fail(t.reject):t[n[0]+"With"](this,r?[e]:arguments)})}),e=null}).promise()},then:function(t,n,r){function s(t,i,n,r){return function(){var a=this,u=arguments,c=function(){var e,c;if(!(t<o)){if((e=n.apply(a,u))===i.promise())throw new TypeError("Thenable self-resolution");c=e&&("object"==typeof e||"function"==typeof e)&&e.then,xe(c)?r?c.call(e,s(o,i,l,r),s(o,i,h,r)):(o++,c.call(e,s(o,i,l,r),s(o,i,h,r),s(o,i,l,i.notifyWith))):(n!==l&&(a=void 0,u=[e]),(r||i.resolveWith)(a,u))}},d=r?c:function(){try{c()}catch(e){we.Deferred.exceptionHook&&we.Deferred.exceptionHook(e,d.stackTrace),t+1>=o&&(n!==h&&(a=void 0,u=[e]),i.rejectWith(a,u))}};t?d():(we.Deferred.getStackHook&&(d.stackTrace=we.Deferred.getStackHook()),e.setTimeout(d))}}var o=0;return we.Deferred(function(e){i[0][3].add(s(0,e,xe(r)?r:l,e.notifyWith)),i[1][3].add(s(0,e,xe(t)?t:l)),i[2][3].add(s(0,e,xe(n)?n:h))}).promise()},promise:function(e){return null!=e?we.extend(e,r):r}},s={};return we.each(i,function(e,t){var o=t[2],a=t[5];r[t[1]]=o.add,a&&o.add(function(){n=a},i[3-e][2].disable,i[3-e][3].disable,i[0][2].lock,i[0][3].lock),o.add(t[3].fire),s[t[0]]=function(){return s[t[0]+"With"](this===s?void 0:this,arguments),this},s[t[0]+"With"]=o.fireWith}),r.promise(s),t&&t.call(s,s),s},when:function(e){var t=arguments.length,i=t,n=Array(i),r=ue.call(arguments),s=we.Deferred(),o=function(e){return function(i){n[e]=this,r[e]=arguments.length>1?ue.call(arguments):i,--t||s.resolveWith(n,r)}};if(t<=1&&(c(e,s.done(o(i)).resolve,s.reject,!t),"pending"===s.state()||xe(r[i]&&r[i].then)))return s.then();for(;i--;)c(r[i],o(i),s.reject);return s.promise()}});var Ve=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;we.Deferred.exceptionHook=function(t,i){e.console&&e.console.warn&&t&&Ve.test(t.name)&&e.console.warn("jQuery.Deferred exception: "+t.message,t.stack,i)},we.readyException=function(t){e.setTimeout(function(){throw t})};var Be=we.Deferred();we.fn.ready=function(e){return Be.then(e).catch(function(e){we.readyException(e)}),this},we.extend({isReady:!1,readyWait:1,ready:function(e){(e===!0?--we.readyWait:we.isReady)||(we.isReady=!0,e!==!0&&--we.readyWait>0||Be.resolveWith(oe,[we]))}}),we.ready.then=Be.then,"complete"===oe.readyState||"loading"!==oe.readyState&&!oe.documentElement.doScroll?e.setTimeout(we.ready):(oe.addEventListener("DOMContentLoaded",d),e.addEventListener("load",d));var Ie=function(e,t,i,r,s,o,a){var u=0,l=e.length,h=null==i;if("object"===n(i)){s=!0;for(u in i)Ie(e,t,u,i[u],!0,o,a)}else if(void 0!==r&&(s=!0,xe(r)||(a=!0),h&&(a?(t.call(e,r),t=null):(h=t,t=function(e,t,i){return h.call(we(e),i)})),t))for(;u<l;u++)t(e[u],i,a?r:r.call(e[u],u,t(e[u],i)));return s?e:h?t.call(e):l?t(e[0],i):o},Ae=/^-ms-/,Pe=/-([a-z])/g,Re=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};g.uid=1,g.prototype={cache:function(e){var t=e[this.expando];return t||(t={},Re(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,i){var n,r=this.cache(e);if("string"==typeof t)r[f(t)]=i;else for(n in t)r[f(n)]=t[n];return r},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][f(t)]},access:function(e,t,i){return void 0===t||t&&"string"==typeof t&&void 0===i?this.get(e,t):(this.set(e,t,i),void 0!==i?i:t)},remove:function(e,t){var i,n=e[this.expando];if(void 0!==n){if(void 0!==t){Array.isArray(t)?t=t.map(f):(t=f(t),t=t in n?[t]:t.match(Ee)||[]),i=t.length;for(;i--;)delete n[t[i]]}(void 0===t||we.isEmptyObject(n))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!we.isEmptyObject(t)}};var Le=new g,ze=new g,ke=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Xe=/[A-Z]/g;we.extend({hasData:function(e){return ze.hasData(e)||Le.hasData(e)},data:function(e,t,i){return ze.access(e,t,i)},removeData:function(e,t){ze.remove(e,t)},_data:function(e,t,i){return Le.access(e,t,i)},_removeData:function(e,t){Le.remove(e,t)}}),we.fn.extend({data:function(e,t){var i,n,r,s=this[0],o=s&&s.attributes;if(void 0===e){if(this.length&&(r=ze.get(s),1===s.nodeType&&!Le.get(s,"hasDataAttrs"))){for(i=o.length;i--;)o[i]&&(n=o[i].name,0===n.indexOf("data-")&&(n=f(n.slice(5)),_(s,n,r[n])));Le.set(s,"hasDataAttrs",!0)}return r}return"object"==typeof e?this.each(function(){ze.set(this,e)}):Ie(this,function(t){var i;if(s&&void 0===t){if(void 0!==(i=ze.get(s,e)))return i;if(void 0!==(i=_(s,e)))return i}else this.each(function(){ze.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){ze.remove(this,e)})}}),we.extend({queue:function(e,t,i){var n;if(e)return t=(t||"fx")+"queue",n=Le.get(e,t),i&&(!n||Array.isArray(i)?n=Le.access(e,t,we.makeArray(i)):n.push(i)),n||[]},dequeue:function(e,t){t=t||"fx";var i=we.queue(e,t),n=i.length,r=i.shift(),s=we._queueHooks(e,t),o=function(){we.dequeue(e,t)};"inprogress"===r&&(r=i.shift(),n--),r&&("fx"===t&&i.unshift("inprogress"),delete s.stop,r.call(e,o,s)),!n&&s&&s.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return Le.get(e,i)||Le.access(e,i,{empty:we.Callbacks("once memory").add(function(){Le.remove(e,[t+"queue",i])})})}}),we.fn.extend({queue:function(e,t){var i=2;return"string"!=typeof e&&(t=e,e="fx",i--),arguments.length<i?we.queue(this[0],e):void 0===t?this:this.each(function(){var i=we.queue(this,e,t);we._queueHooks(this,e),"fx"===e&&"inprogress"!==i[0]&&we.dequeue(this,e)})},dequeue:function(e){return this.each(function(){we.dequeue(this,e)})},clearQueue:function(e){
return this.queue(e||"fx",[])},promise:function(e,t){var i,n=1,r=we.Deferred(),s=this,o=this.length,a=function(){--n||r.resolveWith(s,[s])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";o--;)(i=Le.get(s[o],e+"queueHooks"))&&i.empty&&(n++,i.empty.add(a));return a(),r.promise(t)}});var Ue=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,je=new RegExp("^(?:([+-])=|)("+Ue+")([a-z%]*)$","i"),Ge=["Top","Right","Bottom","Left"],qe=function(e,t){return e=t||e,"none"===e.style.display||""===e.style.display&&we.contains(e.ownerDocument,e)&&"none"===we.css(e,"display")},He=function(e,t,i,n){var r,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];r=i.apply(e,n||[]);for(s in t)e.style[s]=o[s];return r},We={};we.fn.extend({show:function(){return v(this,!0)},hide:function(){return v(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){qe(this)?we(this).show():we(this).hide()})}});var Ye=/^(?:checkbox|radio)$/i,$e=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,Ke=/^$|^module$|\/(?:java|ecma)script/i,Qe={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Qe.optgroup=Qe.option,Qe.tbody=Qe.tfoot=Qe.colgroup=Qe.caption=Qe.thead,Qe.th=Qe.td;var Ze=/<|&#?\w+;/;!function(){var e=oe.createDocumentFragment(),t=e.appendChild(oe.createElement("div")),i=oe.createElement("input");i.setAttribute("type","radio"),i.setAttribute("checked","checked"),i.setAttribute("name","t"),t.appendChild(i),_e.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",_e.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var Je=oe.documentElement,et=/^key/,tt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,it=/^([^.]*)(?:\.(.+)|)/;we.event={global:{},add:function(e,t,i,n,r){var s,o,a,u,l,h,c,d,p,f,g,m=Le.get(e);if(m)for(i.handler&&(s=i,i=s.handler,r=s.selector),r&&we.find.matchesSelector(Je,r),i.guid||(i.guid=we.guid++),(u=m.events)||(u=m.events={}),(o=m.handle)||(o=m.handle=function(t){return void 0!==we&&we.event.triggered!==t.type?we.event.dispatch.apply(e,arguments):void 0}),t=(t||"").match(Ee)||[""],l=t.length;l--;)a=it.exec(t[l])||[],p=g=a[1],f=(a[2]||"").split(".").sort(),p&&(c=we.event.special[p]||{},p=(r?c.delegateType:c.bindType)||p,c=we.event.special[p]||{},h=we.extend({type:p,origType:g,data:n,handler:i,guid:i.guid,selector:r,needsContext:r&&we.expr.match.needsContext.test(r),namespace:f.join(".")},s),(d=u[p])||(d=u[p]=[],d.delegateCount=0,c.setup&&c.setup.call(e,n,f,o)!==!1||e.addEventListener&&e.addEventListener(p,o)),c.add&&(c.add.call(e,h),h.handler.guid||(h.handler.guid=i.guid)),r?d.splice(d.delegateCount++,0,h):d.push(h),we.event.global[p]=!0)},remove:function(e,t,i,n,r){var s,o,a,u,l,h,c,d,p,f,g,m=Le.hasData(e)&&Le.get(e);if(m&&(u=m.events)){for(t=(t||"").match(Ee)||[""],l=t.length;l--;)if(a=it.exec(t[l])||[],p=g=a[1],f=(a[2]||"").split(".").sort(),p){for(c=we.event.special[p]||{},p=(n?c.delegateType:c.bindType)||p,d=u[p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=s=d.length;s--;)h=d[s],!r&&g!==h.origType||i&&i.guid!==h.guid||a&&!a.test(h.namespace)||n&&n!==h.selector&&("**"!==n||!h.selector)||(d.splice(s,1),h.selector&&d.delegateCount--,c.remove&&c.remove.call(e,h));o&&!d.length&&(c.teardown&&c.teardown.call(e,f,m.handle)!==!1||we.removeEvent(e,p,m.handle),delete u[p])}else for(p in u)we.event.remove(e,p+t[l],i,n,!0);we.isEmptyObject(u)&&Le.remove(e,"handle events")}},dispatch:function(e){var t,i,n,r,s,o,a=we.event.fix(e),u=new Array(arguments.length),l=(Le.get(this,"events")||{})[a.type]||[],h=we.event.special[a.type]||{};for(u[0]=a,t=1;t<arguments.length;t++)u[t]=arguments[t];if(a.delegateTarget=this,!h.preDispatch||h.preDispatch.call(this,a)!==!1){for(o=we.event.handlers.call(this,a,l),t=0;(r=o[t++])&&!a.isPropagationStopped();)for(a.currentTarget=r.elem,i=0;(s=r.handlers[i++])&&!a.isImmediatePropagationStopped();)a.rnamespace&&!a.rnamespace.test(s.namespace)||(a.handleObj=s,a.data=s.data,void 0!==(n=((we.event.special[s.origType]||{}).handle||s.handler).apply(r.elem,u))&&(a.result=n)===!1&&(a.preventDefault(),a.stopPropagation()));return h.postDispatch&&h.postDispatch.call(this,a),a.result}},handlers:function(e,t){var i,n,r,s,o,a=[],u=t.delegateCount,l=e.target;if(u&&l.nodeType&&!("click"===e.type&&e.button>=1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||l.disabled!==!0)){for(s=[],o={},i=0;i<u;i++)n=t[i],r=n.selector+" ",void 0===o[r]&&(o[r]=n.needsContext?we(r,this).index(l)>-1:we.find(r,this,null,[l]).length),o[r]&&s.push(n);s.length&&a.push({elem:l,handlers:s})}return l=this,u<t.length&&a.push({elem:l,handlers:t.slice(u)}),a},addProp:function(e,t){Object.defineProperty(we.Event.prototype,e,{enumerable:!0,configurable:!0,get:xe(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[we.expando]?e:new we.Event(e)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==F()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===F()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&s(this,"input"))return this.click(),!1},_default:function(e){return s(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},we.removeEvent=function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i)},we.Event=function(e,t){if(!(this instanceof we.Event))return new we.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?C:T,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&we.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[we.expando]=!0},we.Event.prototype={constructor:we.Event,isDefaultPrevented:T,isPropagationStopped:T,isImmediatePropagationStopped:T,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=C,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=C,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=C,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},we.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&et.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&tt.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},we.event.addProp),we.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){we.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,n=this,r=e.relatedTarget,s=e.handleObj;return r&&(r===n||we.contains(n,r))||(e.type=s.origType,i=s.handler.apply(this,arguments),e.type=t),i}}}),we.fn.extend({on:function(e,t,i,n){return O(this,e,t,i,n)},one:function(e,t,i,n){return O(this,e,t,i,n,1)},off:function(e,t,i){var n,r;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,we(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof e){for(r in e)this.off(r,t,e[r]);return this}return t!==!1&&"function"!=typeof t||(i=t,t=void 0),i===!1&&(i=T),this.each(function(){we.event.remove(this,e,i,t)})}});var nt=/<script|<style|<link/i,rt=/checked\s*(?:[^=]|=\s*.checked.)/i,st=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;we.extend({htmlPrefilter:function(e){return e.replace(/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,"<$1></$2>")},clone:function(e,t,i){var n,r,s,o,a=e.cloneNode(!0),u=we.contains(e.ownerDocument,e);if(!(_e.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||we.isXMLDoc(e)))for(o=w(a),s=w(e),n=0,r=s.length;n<r;n++)V(s[n],o[n]);if(t)if(i)for(s=s||w(e),o=o||w(a),n=0,r=s.length;n<r;n++)E(s[n],o[n]);else E(e,a);return o=w(a,"script"),o.length>0&&b(o,!u&&w(e,"script")),a},cleanData:function(e){for(var t,i,n,r=we.event.special,s=0;void 0!==(i=e[s]);s++)if(Re(i)){if(t=i[Le.expando]){if(t.events)for(n in t.events)r[n]?we.event.remove(i,n):we.removeEvent(i,n,t.handle);i[Le.expando]=void 0}i[ze.expando]&&(i[ze.expando]=void 0)}}}),we.fn.extend({detach:function(e){return I(this,e,!0)},remove:function(e){return I(this,e)},text:function(e){return Ie(this,function(e){return void 0===e?we.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return B(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){N(this,e).appendChild(e)}})},prepend:function(){return B(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=N(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return B(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return B(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(we.cleanData(w(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return we.clone(this,e,t)})},html:function(e){return Ie(this,function(e){var t=this[0]||{},i=0,n=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!nt.test(e)&&!Qe[($e.exec(e)||["",""])[1].toLowerCase()]){e=we.htmlPrefilter(e);try{for(;i<n;i++)t=this[i]||{},1===t.nodeType&&(we.cleanData(w(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return B(this,arguments,function(t){var i=this.parentNode;we.inArray(this,e)<0&&(we.cleanData(w(this)),i&&i.replaceChild(t,this))},e)}}),we.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){we.fn[e]=function(e){for(var i,n=[],r=we(e),s=r.length-1,o=0;o<=s;o++)i=o===s?this:this.clone(!0),we(r[o])[t](i),he.apply(n,i.get());return this.pushStack(n)}});var ot=new RegExp("^("+Ue+")(?!px)[a-z%]+$","i"),at=function(t){var i=t.ownerDocument.defaultView;return i&&i.opener||(i=e),i.getComputedStyle(t)},ut=new RegExp(Ge.join("|"),"i");!function(){function t(){if(l){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",Je.appendChild(u).appendChild(l);var t=e.getComputedStyle(l);n="1%"!==t.top,a=12===i(t.marginLeft),l.style.right="60%",o=36===i(t.right),r=36===i(t.width),l.style.position="absolute",s=36===l.offsetWidth||"absolute",Je.removeChild(u),l=null}}function i(e){return Math.round(parseFloat(e))}var n,r,s,o,a,u=oe.createElement("div"),l=oe.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",_e.clearCloneStyle="content-box"===l.style.backgroundClip,we.extend(_e,{boxSizingReliable:function(){return t(),r},pixelBoxStyles:function(){return t(),o},pixelPosition:function(){return t(),n},reliableMarginLeft:function(){return t(),a},scrollboxSize:function(){return t(),s}}))}();var lt=/^(none|table(?!-c[ea]).+)/,ht=/^--/,ct={position:"absolute",visibility:"hidden",display:"block"},dt={letterSpacing:"0",fontWeight:"400"},pt=["Webkit","Moz","ms"],ft=oe.createElement("div").style;we.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=A(e,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,i,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,s,o,a=f(t),u=ht.test(t),l=e.style;if(u||(t=L(a)),o=we.cssHooks[t]||we.cssHooks[a],void 0===i)return o&&"get"in o&&void 0!==(r=o.get(e,!1,n))?r:l[t];s=typeof i,"string"===s&&(r=je.exec(i))&&r[1]&&(i=x(e,t,r),s="number"),null!=i&&i===i&&("number"===s&&(i+=r&&r[3]||(we.cssNumber[a]?"":"px")),_e.clearCloneStyle||""!==i||0!==t.indexOf("background")||(l[t]="inherit"),o&&"set"in o&&void 0===(i=o.set(e,i,n))||(u?l.setProperty(t,i):l[t]=i))}},css:function(e,t,i,n){var r,s,o,a=f(t);return ht.test(t)||(t=L(a)),o=we.cssHooks[t]||we.cssHooks[a],o&&"get"in o&&(r=o.get(e,!0,i)),void 0===r&&(r=A(e,t,n)),"normal"===r&&t in dt&&(r=dt[t]),""===i||i?(s=parseFloat(r),i===!0||isFinite(s)?s||0:r):r}}),we.each(["height","width"],function(e,t){we.cssHooks[t]={get:function(e,i,n){if(i)return!lt.test(we.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?X(e,t,n):He(e,ct,function(){return X(e,t,n)})},set:function(e,i,n){var r,s=at(e),o="border-box"===we.css(e,"boxSizing",!1,s),a=n&&k(e,t,n,o,s);return o&&_e.scrollboxSize()===s.position&&(a-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(s[t])-k(e,t,"border",!1,s)-.5)),a&&(r=je.exec(i))&&"px"!==(r[3]||"px")&&(e.style[t]=i,i=we.css(e,t)),z(e,i,a)}}}),we.cssHooks.marginLeft=P(_e.reliableMarginLeft,function(e,t){if(t)return(parseFloat(A(e,"marginLeft"))||e.getBoundingClientRect().left-He(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),we.each({margin:"",padding:"",border:"Width"},function(e,t){we.cssHooks[e+t]={expand:function(i){for(var n=0,r={},s="string"==typeof i?i.split(" "):[i];n<4;n++)r[e+Ge[n]+t]=s[n]||s[n-2]||s[0];return r}},"margin"!==e&&(we.cssHooks[e+t].set=z)}),we.fn.extend({css:function(e,t){return Ie(this,function(e,t,i){var n,r,s={},o=0;if(Array.isArray(t)){for(n=at(e),r=t.length;o<r;o++)s[t[o]]=we.css(e,t[o],!1,n);return s}return void 0!==i?we.style(e,t,i):we.css(e,t)},e,t,arguments.length>1)}}),we.Tween=U,U.prototype={constructor:U,init:function(e,t,i,n,r,s){this.elem=e,this.prop=i,this.easing=r||we.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=s||(we.cssNumber[i]?"":"px")},cur:function(){var e=U.propHooks[this.prop];return e&&e.get?e.get(this):U.propHooks._default.get(this)},run:function(e){var t,i=U.propHooks[this.prop];return this.options.duration?this.pos=t=we.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):U.propHooks._default.set(this),this}},U.prototype.init.prototype=U.prototype,U.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=we.css(e.elem,e.prop,""),t&&"auto"!==t?t:0)},set:function(e){we.fx.step[e.prop]?we.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[we.cssProps[e.prop]]&&!we.cssHooks[e.prop]?e.elem[e.prop]=e.now:we.style(e.elem,e.prop,e.now+e.unit)}}},U.propHooks.scrollTop=U.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},we.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},we.fx=U.prototype.init,we.fx.step={};var gt,mt,_t=/^(?:toggle|show|hide)$/,xt=/queueHooks$/;we.Animation=we.extend($,{tweeners:{"*":[function(e,t){var i=this.createTween(e,t);return x(i.elem,e,je.exec(t),i),i}]},tweener:function(e,t){xe(e)?(t=e,e=["*"]):e=e.match(Ee);for(var i,n=0,r=e.length;n<r;n++)i=e[n],$.tweeners[i]=$.tweeners[i]||[],$.tweeners[i].unshift(t)},prefilters:[W],prefilter:function(e,t){t?$.prefilters.unshift(e):$.prefilters.push(e)}}),we.speed=function(e,t,i){var n=e&&"object"==typeof e?we.extend({},e):{complete:i||!i&&t||xe(e)&&e,duration:e,easing:i&&t||t&&!xe(t)&&t};return we.fx.off?n.duration=0:"number"!=typeof n.duration&&(n.duration in we.fx.speeds?n.duration=we.fx.speeds[n.duration]:n.duration=we.fx.speeds._default),null!=n.queue&&n.queue!==!0||(n.queue="fx"),n.old=n.complete,n.complete=function(){xe(n.old)&&n.old.call(this),n.queue&&we.dequeue(this,n.queue)},n},we.fn.extend({fadeTo:function(e,t,i,n){return this.filter(qe).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(e,t,i,n){var r=we.isEmptyObject(e),s=we.speed(t,i,n),o=function(){var t=$(this,we.extend({},e),s);(r||Le.get(this,"finish"))&&t.stop(!0)};return o.finish=o,r||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,t,i){var n=function(e){var t=e.stop;delete e.stop,t(i)};return"string"!=typeof e&&(i=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,r=null!=e&&e+"queueHooks",s=we.timers,o=Le.get(this);if(r)o[r]&&o[r].stop&&n(o[r]);else for(r in o)o[r]&&o[r].stop&&xt.test(r)&&n(o[r]);for(r=s.length;r--;)s[r].elem!==this||null!=e&&s[r].queue!==e||(s[r].anim.stop(i),t=!1,s.splice(r,1));!t&&i||we.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,i=Le.get(this),n=i[e+"queue"],r=i[e+"queueHooks"],s=we.timers,o=n?n.length:0;for(i.finish=!0,we.queue(this,e,[]),r&&r.stop&&r.stop.call(this,!0),t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;t<o;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete i.finish})}}),we.each(["toggle","show","hide"],function(e,t){var i=we.fn[t];we.fn[t]=function(e,n,r){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(q(t,!0),e,n,r)}}),we.each({slideDown:q("show"),slideUp:q("hide"),slideToggle:q("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){we.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}}),we.timers=[],we.fx.tick=function(){var e,t=0,i=we.timers;for(gt=Date.now();t<i.length;t++)(e=i[t])()||i[t]!==e||i.splice(t--,1);i.length||we.fx.stop(),gt=void 0},we.fx.timer=function(e){we.timers.push(e),we.fx.start()},we.fx.interval=13,we.fx.start=function(){mt||(mt=!0,j())},we.fx.stop=function(){mt=null},we.fx.speeds={slow:600,fast:200,_default:400},we.fn.delay=function(t,i){return t=we.fx?we.fx.speeds[t]||t:t,i=i||"fx",this.queue(i,function(i,n){var r=e.setTimeout(i,t);n.stop=function(){e.clearTimeout(r)}})},function(){var e=oe.createElement("input"),t=oe.createElement("select"),i=t.appendChild(oe.createElement("option"));e.type="checkbox",_e.checkOn=""!==e.value,_e.optSelected=i.selected,e=oe.createElement("input"),e.value="t",e.type="radio",_e.radioValue="t"===e.value}();var yt,vt=we.expr.attrHandle;we.fn.extend({attr:function(e,t){return Ie(this,we.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){we.removeAttr(this,e)})}}),we.extend({attr:function(e,t,i){var n,r,s=e.nodeType;if(3!==s&&8!==s&&2!==s)return void 0===e.getAttribute?we.prop(e,t,i):(1===s&&we.isXMLDoc(e)||(r=we.attrHooks[t.toLowerCase()]||(we.expr.match.bool.test(t)?yt:void 0)),void 0!==i?null===i?void we.removeAttr(e,t):r&&"set"in r&&void 0!==(n=r.set(e,i,t))?n:(e.setAttribute(t,i+""),i):r&&"get"in r&&null!==(n=r.get(e,t))?n:(n=we.find.attr(e,t),null==n?void 0:n))},attrHooks:{type:{set:function(e,t){if(!_e.radioValue&&"radio"===t&&s(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}},removeAttr:function(e,t){var i,n=0,r=t&&t.match(Ee);if(r&&1===e.nodeType)for(;i=r[n++];)e.removeAttribute(i)}}),yt={set:function(e,t,i){return t===!1?we.removeAttr(e,i):e.setAttribute(i,i),i}},we.each(we.expr.match.bool.source.match(/\w+/g),function(e,t){var i=vt[t]||we.find.attr;vt[t]=function(e,t,n){var r,s,o=t.toLowerCase();return n||(s=vt[o],vt[o]=r,r=null!=i(e,t,n)?o:null,vt[o]=s),r}});var wt=/^(?:input|select|textarea|button)$/i,bt=/^(?:a|area)$/i;we.fn.extend({prop:function(e,t){return Ie(this,we.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[we.propFix[e]||e]})}}),we.extend({prop:function(e,t,i){var n,r,s=e.nodeType;if(3!==s&&8!==s&&2!==s)return 1===s&&we.isXMLDoc(e)||(t=we.propFix[t]||t,r=we.propHooks[t]),void 0!==i?r&&"set"in r&&void 0!==(n=r.set(e,i,t))?n:e[t]=i:r&&"get"in r&&null!==(n=r.get(e,t))?n:e[t]},propHooks:{tabIndex:{get:function(e){var t=we.find.attr(e,"tabindex");return t?parseInt(t,10):wt.test(e.nodeName)||bt.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),_e.optSelected||(we.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),we.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){we.propFix[this.toLowerCase()]=this}),we.fn.extend({addClass:function(e){var t,i,n,r,s,o,a,u=0;if(xe(e))return this.each(function(t){we(this).addClass(e.call(this,t,Q(this)))});if(t=Z(e),t.length)for(;i=this[u++];)if(r=Q(i),n=1===i.nodeType&&" "+K(r)+" "){for(o=0;s=t[o++];)n.indexOf(" "+s+" ")<0&&(n+=s+" ");a=K(n),r!==a&&i.setAttribute("class",a)}return this},removeClass:function(e){var t,i,n,r,s,o,a,u=0;if(xe(e))return this.each(function(t){we(this).removeClass(e.call(this,t,Q(this)))});if(!arguments.length)return this.attr("class","");if(t=Z(e),t.length)for(;i=this[u++];)if(r=Q(i),n=1===i.nodeType&&" "+K(r)+" "){for(o=0;s=t[o++];)for(;n.indexOf(" "+s+" ")>-1;)n=n.replace(" "+s+" "," ");a=K(n),r!==a&&i.setAttribute("class",a)}return this},toggleClass:function(e,t){var i=typeof e,n="string"===i||Array.isArray(e);return"boolean"==typeof t&&n?t?this.addClass(e):this.removeClass(e):xe(e)?this.each(function(i){we(this).toggleClass(e.call(this,i,Q(this),t),t)}):this.each(function(){var t,r,s,o;if(n)for(r=0,s=we(this),o=Z(e);t=o[r++];)s.hasClass(t)?s.removeClass(t):s.addClass(t);else void 0!==e&&"boolean"!==i||(t=Q(this),t&&Le.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||e===!1?"":Le.get(this,"__className__")||""))})},hasClass:function(e){var t,i,n=0;for(t=" "+e+" ";i=this[n++];)if(1===i.nodeType&&(" "+K(Q(i))+" ").indexOf(t)>-1)return!0;return!1}});we.fn.extend({val:function(e){var t,i,n,r=this[0];if(arguments.length)return n=xe(e),this.each(function(i){var r;1===this.nodeType&&(r=n?e.call(this,i,we(this).val()):e,null==r?r="":"number"==typeof r?r+="":Array.isArray(r)&&(r=we.map(r,function(e){return null==e?"":e+""})),(t=we.valHooks[this.type]||we.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,r,"value")||(this.value=r))});if(r)return(t=we.valHooks[r.type]||we.valHooks[r.nodeName.toLowerCase()])&&"get"in t&&void 0!==(i=t.get(r,"value"))?i:(i=r.value,"string"==typeof i?i.replace(/\r/g,""):null==i?"":i)}}),we.extend({valHooks:{option:{get:function(e){var t=we.find.attr(e,"value");return null!=t?t:K(we.text(e))}},select:{get:function(e){var t,i,n,r=e.options,o=e.selectedIndex,a="select-one"===e.type,u=a?null:[],l=a?o+1:r.length;for(n=o<0?l:a?o:0;n<l;n++)if(i=r[n],(i.selected||n===o)&&!i.disabled&&(!i.parentNode.disabled||!s(i.parentNode,"optgroup"))){if(t=we(i).val(),a)return t;u.push(t)}return u},set:function(e,t){for(var i,n,r=e.options,s=we.makeArray(t),o=r.length;o--;)n=r[o],(n.selected=we.inArray(we.valHooks.option.get(n),s)>-1)&&(i=!0);return i||(e.selectedIndex=-1),s}}}}),we.each(["radio","checkbox"],function(){we.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=we.inArray(we(e).val(),t)>-1}},_e.checkOn||(we.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),_e.focusin="onfocusin"in e;var St=/^(?:focusinfocus|focusoutblur)$/,Ct=function(e){e.stopPropagation()};we.extend(we.event,{trigger:function(t,i,n,r){var s,o,a,u,l,h,c,d,p=[n||oe],f=fe.call(t,"type")?t.type:t,g=fe.call(t,"namespace")?t.namespace.split("."):[];if(o=d=a=n=n||oe,3!==n.nodeType&&8!==n.nodeType&&!St.test(f+we.event.triggered)&&(f.indexOf(".")>-1&&(g=f.split("."),f=g.shift(),g.sort()),l=f.indexOf(":")<0&&"on"+f,t=t[we.expando]?t:new we.Event(f,"object"==typeof t&&t),t.isTrigger=r?2:3,t.namespace=g.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),i=null==i?[t]:we.makeArray(i,[t]),c=we.event.special[f]||{},r||!c.trigger||c.trigger.apply(n,i)!==!1)){if(!r&&!c.noBubble&&!ye(n)){for(u=c.delegateType||f,St.test(u+f)||(o=o.parentNode);o;o=o.parentNode)p.push(o),a=o;a===(n.ownerDocument||oe)&&p.push(a.defaultView||a.parentWindow||e)}for(s=0;(o=p[s++])&&!t.isPropagationStopped();)d=o,t.type=s>1?u:c.bindType||f,h=(Le.get(o,"events")||{})[t.type]&&Le.get(o,"handle"),h&&h.apply(o,i),(h=l&&o[l])&&h.apply&&Re(o)&&(t.result=h.apply(o,i),t.result===!1&&t.preventDefault());return t.type=f,r||t.isDefaultPrevented()||c._default&&c._default.apply(p.pop(),i)!==!1||!Re(n)||l&&xe(n[f])&&!ye(n)&&(a=n[l],a&&(n[l]=null),we.event.triggered=f,t.isPropagationStopped()&&d.addEventListener(f,Ct),n[f](),t.isPropagationStopped()&&d.removeEventListener(f,Ct),we.event.triggered=void 0,a&&(n[l]=a)),t.result}},simulate:function(e,t,i){var n=we.extend(new we.Event,i,{type:e,isSimulated:!0});we.event.trigger(n,null,t)}}),we.fn.extend({trigger:function(e,t){return this.each(function(){we.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];if(i)return we.event.trigger(e,t,i,!0)}}),_e.focusin||we.each({focus:"focusin",blur:"focusout"},function(e,t){var i=function(e){we.event.simulate(t,e.target,we.event.fix(e))};we.event.special[t]={setup:function(){var n=this.ownerDocument||this,r=Le.access(n,t);r||n.addEventListener(e,i,!0),Le.access(n,t,(r||0)+1)},teardown:function(){var n=this.ownerDocument||this,r=Le.access(n,t)-1;r?Le.access(n,t,r):(n.removeEventListener(e,i,!0),Le.remove(n,t))}}});var Tt=e.location,Ft=Date.now(),Ot=/\?/;we.parseXML=function(t){var i;if(!t||"string"!=typeof t)return null;try{i=(new e.DOMParser).parseFromString(t,"text/xml")}catch(e){i=void 0}return i&&!i.getElementsByTagName("parsererror").length||we.error("Invalid XML: "+t),i};var Nt=/\[\]$/,Mt=/^(?:submit|button|image|reset|file)$/i,Dt=/^(?:input|select|textarea|keygen)/i;we.param=function(e,t){var i,n=[],r=function(e,t){var i=xe(t)?t():t;n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==i?"":i)};if(Array.isArray(e)||e.jquery&&!we.isPlainObject(e))we.each(e,function(){r(this.name,this.value)});else for(i in e)J(i,e[i],t,r);return n.join("&")},we.fn.extend({serialize:function(){return we.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=we.prop(this,"elements");return e?we.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!we(this).is(":disabled")&&Dt.test(this.nodeName)&&!Mt.test(e)&&(this.checked||!Ye.test(e))}).map(function(e,t){var i=we(this).val();return null==i?null:Array.isArray(i)?we.map(i,function(e){return{name:t.name,value:e.replace(/\r?\n/g,"\r\n")}}):{name:t.name,value:i.replace(/\r?\n/g,"\r\n")}}).get()}});var Et=/^(.*?):[ \t]*([^\r\n]*)$/gm,Vt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Bt=/^(?:GET|HEAD)$/,It={},At={},Pt="*/".concat("*"),Rt=oe.createElement("a");Rt.href=Tt.href,we.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Tt.href,type:"GET",isLocal:Vt.test(Tt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Pt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":we.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?ie(ie(e,we.ajaxSettings),t):ie(we.ajaxSettings,e)},ajaxPrefilter:ee(It),ajaxTransport:ee(At),ajax:function(t,i){function n(t,i,n,a){var l,d,p,v,w,b=i;h||(h=!0,u&&e.clearTimeout(u),r=void 0,o=a||"",S.readyState=t>0?4:0,l=t>=200&&t<300||304===t,n&&(v=ne(f,S,n)),v=re(f,v,S,l),l?(f.ifModified&&(w=S.getResponseHeader("Last-Modified"),w&&(we.lastModified[s]=w),(w=S.getResponseHeader("etag"))&&(we.etag[s]=w)),204===t||"HEAD"===f.type?b="nocontent":304===t?b="notmodified":(b=v.state,d=v.data,p=v.error,l=!p)):(p=b,!t&&b||(b="error",t<0&&(t=0))),S.status=t,S.statusText=(i||b)+"",l?_.resolveWith(g,[d,b,S]):_.rejectWith(g,[S,b,p]),S.statusCode(y),y=void 0,c&&m.trigger(l?"ajaxSuccess":"ajaxError",[S,f,l?d:p]),x.fireWith(g,[S,b]),c&&(m.trigger("ajaxComplete",[S,f]),--we.active||we.event.trigger("ajaxStop")))}"object"==typeof t&&(i=t,t=void 0),i=i||{};var r,s,o,a,u,l,h,c,d,p,f=we.ajaxSetup({},i),g=f.context||f,m=f.context&&(g.nodeType||g.jquery)?we(g):we.event,_=we.Deferred(),x=we.Callbacks("once memory"),y=f.statusCode||{},v={},w={},b="canceled",S={readyState:0,getResponseHeader:function(e){var t;if(h){if(!a)for(a={};t=Et.exec(o);)a[t[1].toLowerCase()]=t[2];t=a[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return h?o:null},setRequestHeader:function(e,t){return null==h&&(e=w[e.toLowerCase()]=w[e.toLowerCase()]||e,v[e]=t),this},overrideMimeType:function(e){return null==h&&(f.mimeType=e),this},statusCode:function(e){var t;if(e)if(h)S.always(e[S.status]);else for(t in e)y[t]=[y[t],e[t]];return this},abort:function(e){var t=e||b;return r&&r.abort(t),n(0,t),this}};if(_.promise(S),f.url=((t||f.url||Tt.href)+"").replace(/^\/\//,Tt.protocol+"//"),f.type=i.method||i.type||f.method||f.type,f.dataTypes=(f.dataType||"*").toLowerCase().match(Ee)||[""],null==f.crossDomain){l=oe.createElement("a");try{l.href=f.url,l.href=l.href,f.crossDomain=Rt.protocol+"//"+Rt.host!=l.protocol+"//"+l.host}catch(e){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!=typeof f.data&&(f.data=we.param(f.data,f.traditional)),te(It,f,i,S),h)return S;c=we.event&&f.global,c&&0==we.active++&&we.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!Bt.test(f.type),s=f.url.replace(/#.*$/,""),f.hasContent?f.data&&f.processData&&0===(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&(f.data=f.data.replace(/%20/g,"+")):(p=f.url.slice(s.length),f.data&&(f.processData||"string"==typeof f.data)&&(s+=(Ot.test(s)?"&":"?")+f.data,delete f.data),f.cache===!1&&(s=s.replace(/([?&])_=[^&]*/,"$1"),p=(Ot.test(s)?"&":"?")+"_="+Ft+++p),f.url=s+p),f.ifModified&&(we.lastModified[s]&&S.setRequestHeader("If-Modified-Since",we.lastModified[s]),we.etag[s]&&S.setRequestHeader("If-None-Match",we.etag[s])),(f.data&&f.hasContent&&f.contentType!==!1||i.contentType)&&S.setRequestHeader("Content-Type",f.contentType),S.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+Pt+"; q=0.01":""):f.accepts["*"]);for(d in f.headers)S.setRequestHeader(d,f.headers[d]);if(f.beforeSend&&(f.beforeSend.call(g,S,f)===!1||h))return S.abort();if(b="abort",x.add(f.complete),S.done(f.success),S.fail(f.error),r=te(At,f,i,S)){if(S.readyState=1,c&&m.trigger("ajaxSend",[S,f]),h)return S;f.async&&f.timeout>0&&(u=e.setTimeout(function(){S.abort("timeout")},f.timeout));try{h=!1,r.send(v,n)}catch(e){if(h)throw e;n(-1,e)}}else n(-1,"No Transport");return S},getJSON:function(e,t,i){return we.get(e,t,i,"json")},getScript:function(e,t){return we.get(e,void 0,t,"script")}}),
we.each(["get","post"],function(e,t){we[t]=function(e,i,n,r){return xe(i)&&(r=r||n,n=i,i=void 0),we.ajax(we.extend({url:e,type:t,dataType:r,data:i,success:n},we.isPlainObject(e)&&e))}}),we._evalUrl=function(e){return we.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},we.fn.extend({wrapAll:function(e){var t;return this[0]&&(xe(e)&&(e=e.call(this[0])),t=we(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(e){return xe(e)?this.each(function(t){we(this).wrapInner(e.call(this,t))}):this.each(function(){var t=we(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=xe(e);return this.each(function(i){we(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){we(this).replaceWith(this.childNodes)}),this}}),we.expr.pseudos.hidden=function(e){return!we.expr.pseudos.visible(e)},we.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},we.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(e){}};var Lt={0:200,1223:204},zt=we.ajaxSettings.xhr();_e.cors=!!zt&&"withCredentials"in zt,_e.ajax=zt=!!zt,we.ajaxTransport(function(t){var i,n;if(_e.cors||zt&&!t.crossDomain)return{send:function(r,s){var o,a=t.xhr();if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(o in t.xhrFields)a[o]=t.xhrFields[o];t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest");for(o in r)a.setRequestHeader(o,r[o]);i=function(e){return function(){i&&(i=n=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===e?a.abort():"error"===e?"number"!=typeof a.status?s(0,"error"):s(a.status,a.statusText):s(Lt[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=i(),n=a.onerror=a.ontimeout=i("error"),void 0!==a.onabort?a.onabort=n:a.onreadystatechange=function(){4===a.readyState&&e.setTimeout(function(){i&&n()})},i=i("abort");try{a.send(t.hasContent&&t.data||null)}catch(e){if(i)throw e}},abort:function(){i&&i()}}}),we.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),we.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return we.globalEval(e),e}}}),we.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),we.ajaxTransport("script",function(e){if(e.crossDomain){var t,i;return{send:function(n,r){t=we("<script>").prop({charset:e.scriptCharset,src:e.url}).on("load error",i=function(e){t.remove(),i=null,e&&r("error"===e.type?404:200,e.type)}),oe.head.appendChild(t[0])},abort:function(){i&&i()}}}});var kt=[],Xt=/(=)\?(?=&|$)|\?\?/;we.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=kt.pop()||we.expando+"_"+Ft++;return this[e]=!0,e}}),we.ajaxPrefilter("json jsonp",function(t,i,n){var r,s,o,a=t.jsonp!==!1&&(Xt.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Xt.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return r=t.jsonpCallback=xe(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(Xt,"$1"+r):t.jsonp!==!1&&(t.url+=(Ot.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return o||we.error(r+" was not called"),o[0]},t.dataTypes[0]="json",s=e[r],e[r]=function(){o=arguments},n.always(function(){void 0===s?we(e).removeProp(r):e[r]=s,t[r]&&(t.jsonpCallback=i.jsonpCallback,kt.push(r)),o&&xe(s)&&s(o[0]),o=s=void 0}),"script"}),_e.createHTMLDocument=function(){var e=oe.implementation.createHTMLDocument("").body;return e.innerHTML="<form></form><form></form>",2===e.childNodes.length}(),we.parseHTML=function(e,t,i){if("string"!=typeof e)return[];"boolean"==typeof t&&(i=t,t=!1);var n,r,s;return t||(_e.createHTMLDocument?(t=oe.implementation.createHTMLDocument(""),n=t.createElement("base"),n.href=oe.location.href,t.head.appendChild(n)):t=oe),r=Fe.exec(e),s=!i&&[],r?[t.createElement(r[1])]:(r=S([e],t,s),s&&s.length&&we(s).remove(),we.merge([],r.childNodes))},we.fn.load=function(e,t,i){var n,r,s,o=this,a=e.indexOf(" ");return a>-1&&(n=K(e.slice(a)),e=e.slice(0,a)),xe(t)?(i=t,t=void 0):t&&"object"==typeof t&&(r="POST"),o.length>0&&we.ajax({url:e,type:r||"GET",dataType:"html",data:t}).done(function(e){s=arguments,o.html(n?we("<div>").append(we.parseHTML(e)).find(n):e)}).always(i&&function(e,t){o.each(function(){i.apply(this,s||[e.responseText,t,e])})}),this},we.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){we.fn[t]=function(e){return this.on(t,e)}}),we.expr.pseudos.animated=function(e){return we.grep(we.timers,function(t){return e===t.elem}).length},we.offset={setOffset:function(e,t,i){var n,r,s,o,a,u,l,h=we.css(e,"position"),c=we(e),d={};"static"===h&&(e.style.position="relative"),a=c.offset(),s=we.css(e,"top"),u=we.css(e,"left"),l=("absolute"===h||"fixed"===h)&&(s+u).indexOf("auto")>-1,l?(n=c.position(),o=n.top,r=n.left):(o=parseFloat(s)||0,r=parseFloat(u)||0),xe(t)&&(t=t.call(e,i,we.extend({},a))),null!=t.top&&(d.top=t.top-a.top+o),null!=t.left&&(d.left=t.left-a.left+r),"using"in t?t.using.call(e,d):c.css(d)}},we.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){we.offset.setOffset(this,e,t)});var t,i,n=this[0];if(n)return n.getClientRects().length?(t=n.getBoundingClientRect(),i=n.ownerDocument.defaultView,{top:t.top+i.pageYOffset,left:t.left+i.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var e,t,i,n=this[0],r={top:0,left:0};if("fixed"===we.css(n,"position"))t=n.getBoundingClientRect();else{for(t=this.offset(),i=n.ownerDocument,e=n.offsetParent||i.documentElement;e&&(e===i.body||e===i.documentElement)&&"static"===we.css(e,"position");)e=e.parentNode;e&&e!==n&&1===e.nodeType&&(r=we(e).offset(),r.top+=we.css(e,"borderTopWidth",!0),r.left+=we.css(e,"borderLeftWidth",!0))}return{top:t.top-r.top-we.css(n,"marginTop",!0),left:t.left-r.left-we.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===we.css(e,"position");)e=e.offsetParent;return e||Je})}}),we.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var i="pageYOffset"===t;we.fn[e]=function(n){return Ie(this,function(e,n,r){var s;if(ye(e)?s=e:9===e.nodeType&&(s=e.defaultView),void 0===r)return s?s[t]:e[n];s?s.scrollTo(i?s.pageXOffset:r,i?r:s.pageYOffset):e[n]=r},e,n,arguments.length)}}),we.each(["top","left"],function(e,t){we.cssHooks[t]=P(_e.pixelPosition,function(e,i){if(i)return i=A(e,t),ot.test(i)?we(e).position()[t]+"px":i})}),we.each({Height:"height",Width:"width"},function(e,t){we.each({padding:"inner"+e,content:t,"":"outer"+e},function(i,n){we.fn[n]=function(r,s){var o=arguments.length&&(i||"boolean"!=typeof r),a=i||(r===!0||s===!0?"margin":"border");return Ie(this,function(t,i,r){var s;return ye(t)?0===n.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(s=t.documentElement,Math.max(t.body["scroll"+e],s["scroll"+e],t.body["offset"+e],s["offset"+e],s["client"+e])):void 0===r?we.css(t,i,a):we.style(t,i,r,a)},t,o?r:void 0,o)}})}),we.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,t){we.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}),we.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),we.fn.extend({bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)}}),we.proxy=function(e,t){var i,n,r;if("string"==typeof t&&(i=e[t],t=e,e=i),xe(e))return n=ue.call(arguments,2),r=function(){return e.apply(t||this,n.concat(ue.call(arguments)))},r.guid=e.guid=e.guid||we.guid++,r},we.holdReady=function(e){e?we.readyWait++:we.ready(!0)},we.isArray=Array.isArray,we.parseJSON=JSON.parse,we.nodeName=s,we.isFunction=xe,we.isWindow=ye,we.camelCase=f,we.type=n,we.now=Date.now,we.isNumeric=function(e){var t=we.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},"function"==typeof define&&define.amd&&define("jquery",[],function(){return we});var Ut=e.jQuery,jt=e.$;return we.noConflict=function(t){return e.$===we&&(e.$=jt),t&&e.jQuery===we&&(e.jQuery=Ut),we},t||(e.jQuery=e.$=we),we}),define("jquery/dist/jquery",function(){}),define("x_ite/Error",["jquery"],function(e){"use strict";function t(i,n){e(function(){var r=e("X3DCanvas");t.fallback(r,i);for(var s=0;s<n.length;++s){var o=n[s];"function"==typeof o&&o(r,i)}})}function i(t,i){console.log(i);var n=e(".x_ite-console");n.length&&n.append(document.createTextNode(i)),t.addClass("x_ite-browser-fallback"),t.children(".x_ite-private-browser").hide(),t.children(":not(.x_ite-private-browser)").addClass("x_ite-fallback"),t.children(":not(.x_ite-private-browser)").show()}return t.fallback=i,t}),define("x_ite/Basic/X3DFieldDefinition",[],function(){"use strict";function e(e,t,i){this.accessType=e,this.dataType=i.getType(),this.name=t,this.value=i,Object.preventExtensions(this),Object.freeze(this),Object.seal(this)}return e.prototype.constructor=e,e}),define("x_ite/Basic/FieldDefinitionArray",[],function(){"use strict";function e(e){this.array=e,this.index={};for(var i=0,n=e.length;i<n;++i)this.index[e[i].name]=e[i];return new Proxy(this,t)}var t={get:function(e,t){var i=e[t];return void 0!==i?i:e.array[t]},set:function(e,t,i){return!1}};return Object.assign(e.prototype,{constructor:e,add:function(e){this.array.push(e),this.index[e.name]=e},get:function(e){return this.index[e]},getValue:function(){return this.array}}),Object.defineProperty(e.prototype,"length",{get:function(){return this.array.length},enumerable:!1,configurable:!1}),e}),define("x_ite/Bits/X3DConstants",[],function(){"use strict";var e=0,t=0,i=0,n={NOT_STARTED_STATE:e++,IN_PROGRESS_STATE:e++,COMPLETE_STATE:e++,FAILED_STATE:e++,initializeOnly:parseInt("001",2),inputOnly:parseInt("010",2),outputOnly:parseInt("100",2),inputOutput:parseInt("111",2),SFBool:t++,SFColor:t++,SFColorRGBA:t++,SFDouble:t++,SFFloat:t++,SFImage:t++,SFInt32:t++,SFMatrix3d:t++,SFMatrix3f:t++,SFMatrix4d:t++,SFMatrix4f:t++,SFNode:t++,SFRotation:t++,SFString:t++,SFTime:t++,SFVec2d:t++,SFVec2f:t++,SFVec3d:t++,SFVec3f:t++,SFVec4d:t++,SFVec4f:t++,VrmlMatrix:t++,MFBool:t++,MFColor:t++,MFColorRGBA:t++,MFDouble:t++,MFFloat:t++,MFImage:t++,MFInt32:t++,MFMatrix3d:t++,MFMatrix3f:t++,MFMatrix4d:t++,MFMatrix4f:t++,MFNode:t++,MFRotation:t++,MFString:t++,MFTime:t++,MFVec2d:t++,MFVec2f:t++,MFVec3d:t++,MFVec3f:t++,MFVec4d:t++,MFVec4f:t++,Anchor:i++,Appearance:i++,Arc2D:i++,ArcClose2D:i++,AudioClip:i++,Background:i++,BallJoint:i++,Billboard:i++,BlendedVolumeStyle:i++,BooleanFilter:i++,BooleanSequencer:i++,BooleanToggle:i++,BooleanTrigger:i++,BoundaryEnhancementVolumeStyle:i++,BoundedPhysicsModel:i++,Box:i++,CADAssembly:i++,CADFace:i++,CADLayer:i++,CADPart:i++,CartoonVolumeStyle:i++,Circle2D:i++,ClipPlane:i++,CollidableOffset:i++,CollidableShape:i++,CollisionCollection:i++,Collision:i++,CollisionSensor:i++,CollisionSpace:i++,ColorChaser:i++,ColorDamper:i++,ColorInterpolator:i++,Color:i++,ColorRGBA:i++,ComposedCubeMapTexture:i++,ComposedShader:i++,ComposedTexture3D:i++,ComposedVolumeStyle:i++,ConeEmitter:i++,Cone:i++,Contact:i++,Contour2D:i++,ContourPolyline2D:i++,CoordinateChaser:i++,CoordinateDamper:i++,CoordinateDouble:i++,CoordinateInterpolator2D:i++,CoordinateInterpolator:i++,Coordinate:i++,Cylinder:i++,CylinderSensor:i++,DirectionalLight:i++,DISEntityManager:i++,DISEntityTypeMapping:i++,Disk2D:i++,DoubleAxisHingeJoint:i++,EaseInEaseOut:i++,EdgeEnhancementVolumeStyle:i++,ElevationGrid:i++,EspduTransform:i++,ExplosionEmitter:i++,Extrusion:i++,FillProperties:i++,FloatVertexAttribute:i++,FogCoordinate:i++,Fog:i++,FontStyle:i++,ForcePhysicsModel:i++,GeneratedCubeMapTexture:i++,GeoCoordinate:i++,GeoElevationGrid:i++,GeoLocation:i++,GeoLOD:i++,GeoMetadata:i++,GeoOrigin:i++,GeoPositionInterpolator:i++,GeoProximitySensor:i++,GeoTouchSensor:i++,GeoTransform:i++,GeoViewpoint:i++,Group:i++,HAnimDisplacer:i++,HAnimHumanoid:i++,HAnimJoint:i++,HAnimSegment:i++,HAnimSite:i++,ImageCubeMapTexture:i++,ImageTexture3D:i++,ImageTexture:i++,IndexedFaceSet:i++,IndexedLineSet:i++,IndexedQuadSet:i++,IndexedTriangleFanSet:i++,IndexedTriangleSet:i++,IndexedTriangleStripSet:i++,Inline:i++,IntegerSequencer:i++,IntegerTrigger:i++,IsoSurfaceVolumeData:i++,KeySensor:i++,Layer:i++,LayerSet:i++,LayoutGroup:i++,LayoutLayer:i++,Layout:i++,LinePickSensor:i++,LineProperties:i++,LineSet:i++,LoadSensor:i++,LocalFog:i++,LOD:i++,Material:i++,Matrix3VertexAttribute:i++,Matrix4VertexAttribute:i++,MetadataBoolean:i++,MetadataDouble:i++,MetadataFloat:i++,MetadataInteger:i++,MetadataSet:i++,MetadataString:i++,MotorJoint:i++,MovieTexture:i++,MultiTextureCoordinate:i++,MultiTexture:i++,MultiTextureTransform:i++,NavigationInfo:i++,NormalInterpolator:i++,Normal:i++,NurbsCurve2D:i++,NurbsCurve:i++,NurbsOrientationInterpolator:i++,NurbsPatchSurface:i++,NurbsPositionInterpolator:i++,NurbsSet:i++,NurbsSurfaceInterpolator:i++,NurbsSweptSurface:i++,NurbsSwungSurface:i++,NurbsTextureCoordinate:i++,NurbsTrimmedSurface:i++,OpacityMapVolumeStyle:i++,OrientationChaser:i++,OrientationDamper:i++,OrientationInterpolator:i++,OrthoViewpoint:i++,PackagedShader:i++,ParticleSystem:i++,PickableGroup:i++,PixelTexture3D:i++,PixelTexture:i++,PlaneSensor:i++,PointEmitter:i++,PointLight:i++,PointPickSensor:i++,PointSet:i++,Polyline2D:i++,PolylineEmitter:i++,Polypoint2D:i++,PositionChaser2D:i++,PositionChaser:i++,PositionDamper2D:i++,PositionDamper:i++,PositionInterpolator2D:i++,PositionInterpolator:i++,PrimitivePickSensor:i++,ProgramShader:i++,ProjectionVolumeStyle:i++,ProximitySensor:i++,QuadSet:i++,ReceiverPdu:i++,Rectangle2D:i++,RigidBodyCollection:i++,RigidBody:i++,ScalarChaser:i++,ScalarDamper:i++,ScalarInterpolator:i++,ScreenFontStyle:i++,ScreenGroup:i++,Script:i++,SegmentedVolumeData:i++,ShadedVolumeStyle:i++,ShaderPart:i++,ShaderProgram:i++,Shape:i++,SignalPdu:i++,SilhouetteEnhancementVolumeStyle:i++,SingleAxisHingeJoint:i++,SliderJoint:i++,Sound:i++,Sphere:i++,SphereSensor:i++,SplinePositionInterpolator2D:i++,SplinePositionInterpolator:i++,SplineScalarInterpolator:i++,SpotLight:i++,SquadOrientationInterpolator:i++,StaticGroup:i++,StringSensor:i++,SurfaceEmitter:i++,Switch:i++,TexCoordChaser2D:i++,TexCoordDamper2D:i++,Text:i++,TextureBackground:i++,TextureCoordinate3D:i++,TextureCoordinate4D:i++,TextureCoordinateGenerator:i++,TextureCoordinate:i++,TextureProperties:i++,TextureTransform3D:i++,TextureTransformMatrix3D:i++,TextureTransform:i++,TimeSensor:i++,TimeTrigger:i++,ToneMappedVolumeStyle:i++,TouchGroup:i++,TouchSensor:i++,Transform:i++,TransformSensor:i++,TransmitterPdu:i++,TriangleFanSet:i++,TriangleSet2D:i++,TriangleSet:i++,TriangleStripSet:i++,TwoSidedMaterial:i++,UniversalJoint:i++,ViewpointGroup:i++,Viewpoint:i++,Viewport:i++,VisibilitySensor:i++,VolumeData:i++,VolumeEmitter:i++,VolumePickSensor:i++,WindPhysicsModel:i++,WorldInfo:i++,X3DBaseNode:i++,X3DAppearanceChildNode:i++,X3DAppearanceNode:i++,X3DBackgroundNode:i++,X3DBindableNode:i++,X3DBoundedObject:i++,X3DChaserNode:i++,X3DChildNode:i++,X3DColorNode:i++,X3DComposableVolumeRenderStyleNode:i++,X3DComposedGeometryNode:i++,X3DCoordinateNode:i++,X3DDamperNode:i++,X3DDragSensorNode:i++,X3DEnvironmentalSensorNode:i++,X3DEnvironmentTextureNode:i++,X3DFogObject:i++,X3DFollowerNode:i++,X3DFontStyleNode:i++,X3DGeometricPropertyNode:i++,X3DGeometryNode:i++,X3DGeospatialObject:i++,X3DGroupingNode:i++,X3DInfoNode:i++,X3DInterpolatorNode:i++,X3DKeyDeviceSensorNode:i++,X3DLayerNode:i++,X3DLayoutNode:i++,X3DLightNode:i++,X3DLineGeometryNode:i++,X3DMaterialNode:i++,X3DMetadataObject:i++,X3DNBodyCollidableNode:i++,X3DNBodyCollisionSpaceNode:i++,X3DNetworkSensorNode:i++,X3DNode:i++,X3DNormalNode:i++,X3DNurbsControlCurveNode:i++,X3DNurbsSurfaceGeometryNode:i++,X3DParametricGeometryNode:i++,X3DParticleEmitterNode:i++,X3DParticlePhysicsModelNode:i++,X3DPickableObject:i++,X3DPickSensorNode:i++,X3DPointingDeviceSensorNode:i++,X3DProductStructureChildNode:i++,X3DProgrammableShaderObject:i++,X3DPrototypeInstance:i++,X3DRigidJointNode:i++,X3DScriptNode:i++,X3DSensorNode:i++,X3DSequencerNode:i++,X3DShaderNode:i++,X3DShapeNode:i++,X3DSoundNode:i++,X3DSoundSourceNode:i++,X3DTexture2DNode:i++,X3DTexture3DNode:i++,X3DTextureCoordinateNode:i++,X3DTextureNode:i++,X3DTextureTransformNode:i++,X3DTimeDependentNode:i++,X3DTouchSensorNode:i++,X3DTransformMatrix3DNode:i++,X3DTransformNode:i++,X3DTriggerNode:i++,X3DUrlObject:i++,X3DVertexAttributeNode:i++,X3DViewpointNode:i++,X3DViewportNode:i++,X3DVolumeDataNode:i++,X3DVolumeRenderStyleNode:i++,X3DProtoDeclarationNode:i++,X3DProtoDeclaration:i++,X3DExternProtoDeclaration:i++,BlendMode:i++};return Object.preventExtensions(n),Object.freeze(n),Object.seal(n),n}),define("x_ite/InputOutput/Generator",["x_ite/Bits/X3DConstants"],function(e){"use strict";function t(){this.indent="",this.indentChar="  ",this.executionContextStack=[null],this.importedNodesIndex={},this.exportedNodesIndex={},this.nodes={},this.names={},this.namesByNode={},this.importedNames={},this.routeNodes={},this.level=0,this.newName=0,this.containerFields=[],this.units=!0,this.unitCategories=[]}return t.prototype={constructor:t,Indent:function(){return this.indent},IncIndent:function(){this.indent+=this.indentChar},DecIndent:function(){this.indent=this.indent.substr(0,this.indent.length-this.indentChar.length)},PushExecutionContext:function(e){this.executionContextStack.push(e),this.importedNodesIndex[e.getId()]||(this.importedNodesIndex[e.getId()]={}),this.exportedNodesIndex[e.getId()]||(this.exportedNodesIndex[e.getId()]={})},PopExecutionContext:function(){this.executionContextStack.pop(),this.ExecutionContext()||(this.importedNodesIndex={},this.exportedNodesIndex={})},ExecutionContext:function(){return this.executionContextStack[this.executionContextStack.length-1]},EnterScope:function(){0===this.level&&(this.newName=0),++this.level},LeaveScope:function(){0===--this.level&&(this.nodes={},this.names={},this.namesByNode={},this.importedNames={},this.importedNodes={})},ExportedNodes:function(e){},ImportedNodes:function(e){var t=this.importedNodesIndex[this.ExecutionContext().getId()];for(var i in e)try{t[e[i].getInlineNode().getId()]=!0}catch(e){}},AddImportedNode:function(e,t){this.importedNames[e.getId()]=t},AddRouteNode:function(e){this.routeNodes[e.getId()]=!0},ExistsRouteNode:function(e){return!!this.routeNodes[e.getId()]},IsSharedNode:function(e){return!1},AddNode:function(e){this.nodes[e.getId()]=!0,this.AddRouteNode(e)},ExistsNode:function(e){return void 0!==this.nodes[e.getId()]},Name:function(e){var t=this.namesByNode[e.getId()];if(void 0!==t)return t;if(0===e.getName().length){if(this.NeedsName(e)){var t=this.UniqueName();return this.names[t]=e,this.namesByNode[e.getId()]=t,t}return e.getName()}var t=e.getName(),i=null!==t.match(/(_\d+$)/);if(t=t.replace(/(_\d+$)/,""),0===t.length){if(!this.NeedsName(e))return"";t=this.UniqueName()}else{for(var n=0,r=i?t+"_"+ ++n:t;void 0!==this.names[r];)r=t+"_"+ ++n;t=r}return this.names[t]=e,this.namesByNode[e.getId()]=t,t},NeedsName:function(e){if(e.getCloneCount()>1)return!0;if(e.hasRoutes())return!0;var t=e.getExecutionContext(),i=this.importedNodesIndex[t.getId()];if(i&&i[e.getId()])return!0;var i=this.exportedNodesIndex[t.getId()];return!(!i||!i[e.getId()])},UniqueName:function(){for(;;){var e="_"+ ++this.newName;if(void 0===this.names[e])return e}},LocalName:function(e){var t=this.importedNames[e.getId()];if(void 0!==t)return t;if(this.ExistsNode(e))return this.Name(e);throw new Error("Couldn't get local name for node '"+e.getTypeName()+"'.")},PushContainerField:function(e){this.containerFields.push(e)},PopContainerField:function(){this.containerFields.pop()},ContainerField:function(){return this.containerFields.length?this.containerFields[this.containerFields.length-1]:null},AccessType:function(t){switch(t){case e.initializeOnly:return"initializeOnly";case e.inputOnly:return"inputOnly";case e.outputOnly:return"outputOnly";case e.inputOutput:return"inputOutput"}},SetUnits:function(e){this.units=e},GetUnits:function(){return this.units},PushUnitCategory:function(e){this.unitCategories.push(e)},PopUnitCategory:function(){this.unitCategories.pop()},Unit:function(e){var t=this.unitCategories.length;return 0==t?e:this.unitCategories[t-1]},ToUnit:function(e,t){if(this.units){var i=this.ExecutionContext();if(i)return i.toUnit(e,t)}return t},XMLEncode:function(e){return e.replace(/&/g,"&amp;").replace(/\\/g,"&#92;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,'\\"')},escapeCDATA:function(e){return e.replace(/\]\]\>/g,"\\]\\]\\>")}},t.Get=function(e){return e.generator||(e.generator=new t),e.generator},t}),define("x_ite/Base/X3DObject",["x_ite/InputOutput/Generator"],function(e){"use strict";function t(){return this._id}function i(){}var n=0;return i.prototype={constructor:i,_id:0,_name:"",_interests:new Map,getId:function(){return this.getId=t,this._id=++n},setName:function(e){this._name=e},getName:function(){return this._name},hasInterest:function(e,t){return this._interests.has(t.getId()+e)},addInterest:function(e,t){this.hasOwnProperty("_interests")||(this._interests=new Map);var i=Array.prototype.slice.call(arguments,0);i[0]=t,i[1]=this,this._interests.set(t.getId()+e,Function.prototype.bind.apply(t[e],i))},removeInterest:function(e,t){this._interests.delete(t.getId()+e)},getInterests:function(){return this._interests},processInterests:function(){this._interests.forEach(function(e){e()})},toString:function(t){var i={string:""};return t&&e.Get(i).PushExecutionContext(t),this.toStream(i),i.string},toVRMLString:function(){},toXMLString:function(){var e={string:""};return this.toXMLStream(e),e.string},dispose:function(){}},i}),define("x_ite/Base/X3DChildObject",["x_ite/Base/X3DObject"],function(e){"use strict";function t(){e.call(this)}return t.prototype=Object.assign(Object.create(e.prototype),{constructor:t,_tainted:!1,_parents:new Map,setTainted:function(e){this._tainted=e},getTainted:function(){return this._tainted},addEvent:function(){this._tainted||this._parents.forEach(function(e){e.addEvent(this)},this)},addEventObject:function(e,t){this._parents.forEach(function(e){e.addEventObject(this,t)},this)},addParent:function(e){this.hasOwnProperty("_parents")||(this._parents=new Map),this._parents.set(e.getId(),e)},removeParent:function(e){this._parents.delete(e.getId())},getParents:function(){return this._parents},addClones:Function.prototype,removeClones:Function.prototype,dispose:function(){this._parents.clear(),e.prototype.dispose.call(this)}}),t}),define("x_ite/Base/Events",[],function(){"use strict";return{stack:[],create:function(e){if(this.stack.length){var t=this.stack.pop();return t.field=e,t.clear(),t}var t=new Set;return t.field=e,t},copy:function(e){if(this.stack.length){var t=this.stack.pop();return t.field=e.field,t.clear(),e.forEach(function(e){this.add(e)},t),t}var t=new Set(e);return t.field=e.field,t},push:function(e){this.stack.push(e)},clear:function(){this.stack.length=0}}}),define("x_ite/Basic/X3DField",["jquery","x_ite/Base/X3DChildObject","x_ite/Bits/X3DConstants","x_ite/Base/Events"],function(e,t,i,n){"use strict";function r(e){return t.call(this),this._value=e,this}return r.prototype=Object.assign(Object.create(t.prototype),{constructor:r,_value:null,_accessType:i.initializeOnly,_unit:null,_set:!1,_uniformLocation:null,_references:new Map,_fieldInterests:new Map,_fieldCallbacks:new Map,_inputRoutes:new Map,_outputRoutes:new Map,_routeCallbacks:new Map,clone:function(){return this.copy()},equals:function(e){return this._value===e.valueOf()},assign:function(e){this.set(e.getValue()),this.addEvent()},set:function(e){this._value=e},setValue:function(e){this.set(e instanceof this.constructor?e.getValue():e),this.addEvent()},getValue:function(){return this._value},setAccessType:function(e){this._accessType=e},getAccessType:function(){return this._accessType},isInitializable:function(){return this.getAccessType()&i.initializeOnly},isInput:function(){return this.getAccessType()&i.inputOnly},isOutput:function(){return this.getAccessType()&i.outputOnly},isReadable:function(){return this.getAccessType()!==i.inputOnly},isWritable:function(){return this.getAccessType()!==i.initializeOnly},setUnit:function(e){return this._unit=e},getUnit:function(){return this._unit},setSet:function(e){return this._set=e},getSet:function(){return this._set},hasReferences:function(){return!!this.hasOwnProperty("_references")&&0!==this._references.size},isReference:function(e){return e===this.getAccessType()||e===i.inputOutput},addReference:function(e){var t=this.getReferences();if(!t.has(e.getId()))switch(t.set(e.getId(),e),this.getAccessType()&e.getAccessType()){case i.initializeOnly:return e.addFieldInterest(this),void this.set(e.getValue(),e.length);case i.inputOnly:return void e.addFieldInterest(this);case i.outputOnly:return void this.addFieldInterest(e);case i.inputOutput:return e.addFieldInterest(this),this.addFieldInterest(e),void this.set(e.getValue(),e.length)}},getReferences:function(){return this.hasOwnProperty("_references")||(this._references=new Map),this._references},updateReferences:function(){if(this.hasOwnProperty("_references"))for(var e of this._references.values())switch(this.getAccessType()&e.getAccessType()){case i.inputOnly:case i.outputOnly:continue;case i.initializeOnly:case i.inputOutput:this.set(e.getValue(),e.length);continue}},addFieldInterest:function(e){this.hasOwnProperty("_fieldInterests")||(this._fieldInterests=new Map),this._fieldInterests.set(e.getId(),e)},removeFieldInterest:function(e){this._fieldInterests.delete(e.getId())},getFieldInterests:function(){return this._fieldInterests},addFieldCallback:function(e,t){this.hasOwnProperty("_fieldCallbacks")||(this._fieldCallbacks=new Map),this._fieldCallbacks.set(e,t)},removeFieldCallback:function(e){this._fieldCallbacks.delete(e)},getFieldCallbacks:function(){return this._fieldCallbacks},addInputRoute:function(e){this.hasOwnProperty("_inputRoutes")||(this._inputRoutes=new Map),this._inputRoutes.set(e.getId(),e),this.processRouteCallbacks()},removeInputRoute:function(e){this._inputRoutes.delete(e.getId()),this.processRouteCallbacks()},getInputRoutes:function(){return this._inputRoutes},addOutputRoute:function(e){this.hasOwnProperty("_outputRoutes")||(this._outputRoutes=new Map),this._outputRoutes.set(e.getId(),e),this.processRouteCallbacks()},removeOutputRoute:function(e){this._outputRoutes.delete(e.getId()),this.processRouteCallbacks()},getOutputRoutes:function(){return this._outputRoutes},addRouteCallback:function(e,t){this.hasOwnProperty("_routeCallbacks")||(this._routeCallbacks=new Map),this._routeCallbacks.set(e,t)},removeRouteCallback:function(e){this._routeCallbacks.delete(e)},getRouteCallbacks:function(){return this._routeCallbacks},processRouteCallbacks:function(){this._routeCallbacks.size&&new Map(this._routeCallbacks).forEach(function(e){e()})},processEvent:function(e){if(!e.has(this.getId())){e.add(this.getId()),this.setTainted(!1);var t=e.field;t!==this&&this.set(t.getValue(),t.length),this.processInterests();var i=!0;this._fieldInterests.forEach(function(t){i?(i=!1,t.addEventObject(this,e)):t.addEventObject(this,n.copy(e))},this),i&&n.push(e),this._fieldCallbacks.size&&new Map(this._fieldCallbacks).forEach(function(e){e(this.valueOf())},this)}},valueOf:function(){return this},fromString:function(e,t){var i=require("x_ite/Parser/Parser"),n=new i(t);n.setUnits(Boolean(t)),n.setInput(e),n.fieldValue(this),this.addEvent()}}),r}),define("x_ite/Basic/X3DArrayField",["x_ite/Basic/X3DField"],function(e){"use strict";function t(t){e.call(this,t)}return t.prototype=Object.assign(Object.create(e.prototype),{constructor:t}),t}),define("x_ite/Fields/SFBool",["x_ite/Basic/X3DField","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function i(t){return this instanceof i?e.call(this,Boolean(t)):e.call(Object.create(i.prototype),Boolean(t))}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,copy:function(){return new i(this.getValue())},isDefaultValue:function(){return this.getValue()===!1},set:function(t){e.prototype.set.call(this,Boolean(t))},getTypeName:function(){return"SFBool"},getType:function(){return t.SFBool},valueOf:function(){return this.getValue()},toStream:function(e){e.string+=this.getValue()?"TRUE":"FALSE"},toXMLStream:function(e){e.string+=this.getValue()?"true":"false"}}),i}),define("standard/Math/Algorithm",[],function(){"use strict";var e={signum:function(e){return(0<e)-(e<0)},radians:function(e){return e*(Math.PI/180)},degrees:function(e){return e*(180/Math.PI)},random:function(e,t){return e+Math.random()*(t-e)},clamp:function(e,t,i){return Math.min(Math.max(e,t),i)},interval:function(e,t,i){return e>=i?(e-t)%(i-t)+t:e<t?(e-i)%(i-t)+i:e},lerp:function(e,t,i){return e+i*(t-e)},slerp:function(e,t,i){var n=e.dot(t);if(n<=-1)throw new Error("slerp is not possible: vectors are inverse collinear.");if(n>=1)return e;n<0&&(n=-n,t.negate());var r=Math.acos(n),s=Math.sin(r),o=Math.sin((1-i)*r)/s,a=Math.sin(i*r)/s;return e.x=e.x*o+t.x*a,e.y=e.y*o+t.y*a,e.z=e.z*o+t.z*a,e.w=e.w*o+t.w*a,e},simpleSlerp:function(e,t,i){var n=e.dot(t);if(n<=-1)throw new Error("slerp is not possible: vectors are inverse collinear.");if(n>=1)return e;var r=Math.acos(n),s=Math.sin(r),o=Math.sin((1-i)*r)/s,a=Math.sin(i*r)/s;return e.x=e.x*o+t.x*a,e.y=e.y*o+t.y*a,e.z=e.z*o+t.z*a,e.w=e.w*o+t.w*a,e},isPowerOfTwo:function(e){return 0==(e-1&e)},nextPowerOfTwo:function(e){--e;for(var t=1;!(32&t);t<<=1)e|=e>>t;return++e},less:function(e,t){return e<t},greater:function(e,t){return e>t},lowerBound:function(e,t,i,n,r){for(var s=0,o=0,a=i-t;a>0;)o=a>>>1,s=t+o,r(e[s],n)?(t=++s,a-=o+1):a=o;return t},upperBound:function(e,t,i,n,r){for(var s=0,o=0,a=i-t;a>0;)o=a>>>1,s=t+o,r(n,e[s])?a=o:(t=++s,a-=o+1);return t},set_difference:function(e,t,i){for(var n in e)n in t||(i[n]=e[n]);return i}};return Object.preventExtensions(e),Object.freeze(e),Object.seal(e),e}),define("standard/Math/Numbers/Color3",["standard/Math/Algorithm"],function(e){"use strict";function t(e,t,n){arguments.length?(this.r_=i(e,0,1),this.g_=i(t,0,1),this.b_=i(n,0,1)):(this.r_=0,this.g_=0,this.b_=0)}var i=e.clamp;t.prototype={constructor:t,length:3,copy:function(){var e=Object.create(t.prototype);return e.r_=this.r_,e.g_=this.g_,e.b_=this.b_,e},assign:function(e){this.r_=e.r_,this.g_=e.g_,this.b_=e.b_},set:function(e,t,n){this.r_=i(e,0,1),this.g_=i(t,0,1),this.b_=i(n,0,1)},equals:function(e){return this.r_===e.r_&&this.g_===e.g_&&this.b_===e.b_},getHSV:function(e){var t,i,n,r=Math.min(this.r_,this.g_,this.b_),s=Math.max(this.r_,this.g_,this.b_);n=s;var o=s-r;return 0!==s&&0!==o?(i=o/s,t=this.r_===s?(this.g_-this.b_)/o:this.g_===s?2+(this.b_-this.r_)/o:4+(this.r_-this.g_)/o,(t*=Math.PI/3)<0&&(t+=2*Math.PI)):i=t=0,e[0]=t,e[1]=i,e[2]=n,e},setHSV:function(t,n,r){if(n=i(n,0,1),r=i(r,0,1),0===n)this.r_=this.g_=this.b_=r;else{var s=e.degrees(e.interval(t,0,2*Math.PI))/60,o=Math.floor(s),a=s-o,u=r*(1-n),l=r*(1-n*a),h=r*(1-n*(1-a));switch(o%6){case 0:this.r_=r,this.g_=h,this.b_=u;break;case 1:this.r_=l,this.g_=r,this.b_=u;break;case 2:this.r_=u,this.g_=r,this.b_=h;break
;case 3:this.r_=u,this.g_=l,this.b_=r;break;case 4:this.r_=h,this.g_=u,this.b_=r;break;default:this.r_=r,this.g_=u,this.b_=l}}},toString:function(){return this.r_+" "+this.g_+" "+this.b_}};var n={get:function(){return this.r_},set:function(e){this.r_=i(e,0,1)},enumerable:!0,configurable:!1},r={get:function(){return this.g_},set:function(e){this.g_=i(e,0,1)},enumerable:!0,configurable:!1},s={get:function(){return this.b_},set:function(e){this.b_=i(e,0,1)},enumerable:!0,configurable:!1};return Object.defineProperty(t.prototype,"r",n),Object.defineProperty(t.prototype,"g",r),Object.defineProperty(t.prototype,"b",s),n.enumerable=!1,r.enumerable=!1,s.enumerable=!1,Object.defineProperty(t.prototype,"0",n),Object.defineProperty(t.prototype,"1",r),Object.defineProperty(t.prototype,"2",s),Object.assign(t,{HSV:function(e,t,i){var n=Object.create(this.prototype);return n.setHSV(e,t,i),n},lerp:function(e,t,i,n){var r=e[0],s=t[0],o=e[1],a=t[1],u=e[2],l=t[2];0===o&&(r=s),0===a&&(s=r);var h=Math.abs(s-r);if(h<=Math.PI)return n[0]=r+i*(s-r),n[1]=o+i*(a-o),n[2]=u+i*(l-u),n;var c=2*Math.PI,d=(c-h)*i,p=r<s?r-d:r+d;return p<0?p+=c:p>c&&(p-=c),n[0]=p,n[1]=o+i*(a-o),n[2]=u+i*(l-u),n}}),t}),define("x_ite/Fields/SFColor",["standard/Math/Numbers/Color3","x_ite/Basic/X3DField","x_ite/Bits/X3DConstants"],function(e,t,i){"use strict";function n(i,r,s){return this instanceof n?arguments.length?arguments[0]instanceof e?t.call(this,arguments[0]):t.call(this,new e(+i,+r,+s)):t.call(this,new e):n.apply(Object.create(n.prototype),arguments)}n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,copy:function(){return new n(this.getValue().copy())},getTypeName:function(){return"SFColor"},getType:function(){return i.SFColor},equals:function(e){return this.getValue().equals(e.getValue())},isDefaultValue:function(){return 0===this.getValue().r&&0===this.getValue().g&&0===this.getValue().b},set:function(e){this.getValue().assign(e)},getHSV:function(){return this.getValue().getHSV([])},setHSV:function(e,t,i){this.getValue().setHSV(e,t,i),this.addEvent()},lerp:function(){var t=[],i=[],r=[];return function(s,o){var a=new n;return this.getValue().getHSV(t),s.getValue().getHSV(i),e.lerp(t,i,o,r),a.setHSV(r[0],r[1],r[2],r[3]),a}}(),toStream:function(e){e.string+=this.getValue().toString()},toXMLStream:function(e){this.toStream(e)}});var r={get:function(){return this.getValue().r},set:function(e){this.getValue().r=e,this.addEvent()},enumerable:!0,configurable:!1},s={get:function(){return this.getValue().g},set:function(e){this.getValue().g=e,this.addEvent()},enumerable:!0,configurable:!1},o={get:function(){return this.getValue().b},set:function(e){this.getValue().b=e,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(n.prototype,"r",r),Object.defineProperty(n.prototype,"g",s),Object.defineProperty(n.prototype,"b",o),r.enumerable=!1,s.enumerable=!1,o.enumerable=!1,Object.defineProperty(n.prototype,"0",r),Object.defineProperty(n.prototype,"1",s),Object.defineProperty(n.prototype,"2",o),n}),define("standard/Math/Numbers/Color4",["standard/Math/Numbers/Color3","standard/Math/Algorithm"],function(e,t){"use strict";function i(e,t,i,r){arguments.length?(this.r_=n(e,0,1),this.g_=n(t,0,1),this.b_=n(i,0,1),this.a_=n(r,0,1)):(this.r_=0,this.g_=0,this.b_=0,this.a_=0)}var n=t.clamp;i.prototype={constructor:i,length:4,copy:function(){var e=Object.create(i.prototype);return e.r_=this.r_,e.g_=this.g_,e.b_=this.b_,e.a_=this.a_,e},assign:function(e){this.r_=e.r_,this.g_=e.g_,this.b_=e.b_,this.a_=e.a_},set:function(e,t,i,r){this.r_=n(e,0,1),this.g_=n(t,0,1),this.b_=n(i,0,1),this.a_=n(r,0,1)},equals:function(e){return this.r_===e.r_&&this.g_===e.g_&&this.b_===e.b_&&this.a_===e.a_},getHSVA:function(t){return e.prototype.getHSV.call(this,t),t[3]=this.a_,t},setHSVA:function(t,i,r,s){e.prototype.setHSV.call(this,t,i,r),this.a_=n(s,0,1)},toString:function(){return this.r_+" "+this.g_+" "+this.b_+" "+this.a_}};var r={get:function(){return this.r_},set:function(e){this.r_=n(e,0,1)},enumerable:!0,configurable:!1},s={get:function(){return this.g_},set:function(e){this.g_=n(e,0,1)},enumerable:!0,configurable:!1},o={get:function(){return this.b_},set:function(e){this.b_=n(e,0,1)},enumerable:!0,configurable:!1},a={get:function(){return this.a_},set:function(e){this.a_=n(e,0,1)},enumerable:!0,configurable:!1};return Object.defineProperty(i.prototype,"r",r),Object.defineProperty(i.prototype,"g",s),Object.defineProperty(i.prototype,"b",o),Object.defineProperty(i.prototype,"a",a),r.enumerable=!1,s.enumerable=!1,o.enumerable=!1,a.enumerable=!1,Object.defineProperty(i.prototype,"0",r),Object.defineProperty(i.prototype,"1",s),Object.defineProperty(i.prototype,"2",o),Object.defineProperty(i.prototype,"3",a),Object.assign(i,{HSVA:function(e,t,i,n){var r=Object.create(this.prototype);return r.setHSVA(e,t,i,n),r},lerp:function(t,i,n,r){var s=t[3];return e.lerp(t,i,n,r),r[3]=s+n*(i[3]-s),r}}),i}),define("x_ite/Fields/SFColorRGBA",["x_ite/Basic/X3DField","x_ite/Fields/SFColor","x_ite/Bits/X3DConstants","standard/Math/Numbers/Color4"],function(e,t,i,n){"use strict";function r(t,i,s,o){return this instanceof r?arguments.length?arguments[0]instanceof n?e.call(this,arguments[0]):e.call(this,new n(+t,+i,+s,+o)):e.call(this,new n):r.apply(Object.create(r.prototype),arguments)}r.prototype=Object.assign(Object.create(e.prototype),{constructor:r,copy:function(){return new r(this.getValue().copy())},getTypeName:function(){return"SFColorRGBA"},getType:function(){return i.SFColorRGBA},equals:t.prototype.equals,isDefaultValue:function(){return 0===this.getValue().r&&0===this.getValue().g&&0===this.getValue().b&&0===this.getValue().a},set:t.prototype.set,getHSVA:function(){return this.getValue().getHSVA([])},setHSVA:function(e,t,i,n){this.getValue().setHSVA(e,t,i,n),this.addEvent()},lerp:function(){var e=[],t=[],i=[];return function(s,o){var a=new r;return this.getValue().getHSVA(e),s.getValue().getHSVA(t),n.lerp(e,t,o,i),a.setHSVA(i[0],i[1],i[2],i[3]),a}}(),toStream:t.prototype.toStream,toXMLStream:t.prototype.toXMLStream});var s={get:function(){return this.getValue().r},set:function(e){this.getValue().r=e,this.addEvent()},enumerable:!0,configurable:!1},o={get:function(){return this.getValue().g},set:function(e){this.getValue().g=e,this.addEvent()},enumerable:!0,configurable:!1},a={get:function(){return this.getValue().b},set:function(e){this.getValue().b=e,this.addEvent()},enumerable:!0,configurable:!1},u={get:function(){return this.getValue().a},set:function(e){this.getValue().a=e,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(r.prototype,"r",s),Object.defineProperty(r.prototype,"g",o),Object.defineProperty(r.prototype,"b",a),Object.defineProperty(r.prototype,"a",u),s.enumerable=!1,o.enumerable=!1,a.enumerable=!1,u.enumerable=!1,Object.defineProperty(r.prototype,"0",s),Object.defineProperty(r.prototype,"1",o),Object.defineProperty(r.prototype,"2",a),Object.defineProperty(r.prototype,"3",u),r}),define("x_ite/Fields/SFDouble",["x_ite/Basic/X3DField","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(e,t,i){"use strict";function n(t){return this instanceof n?e.call(this,arguments.length?+t:0):e.call(Object.create(n.prototype),arguments.length?+t:0)}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,copy:function(){return new n(this.getValue())},getTypeName:function(){return"SFDouble"},getType:function(){return t.SFDouble},isDefaultValue:function(){return 0===this.getValue()},set:function(t){e.prototype.set.call(this,+t)},valueOf:e.prototype.getValue,toStream:function(e){var t=i.Get(e),n=t.Unit(this.getUnit());e.string+=String(t.ToUnit(n,this.getValue()))},toXMLStream:function(e){this.toStream(e)}}),n}),define("x_ite/Fields/SFFloat",["x_ite/Basic/X3DField","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(e,t,i){"use strict";function n(t){return this instanceof n?e.call(this,arguments.length?+t:0):e.call(Object.create(n.prototype),arguments.length?+t:0)}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,copy:function(){return new n(this.getValue())},getTypeName:function(){return"SFFloat"},getType:function(){return t.SFFloat},isDefaultValue:function(){return 0===this.getValue()},set:function(t){e.prototype.set.call(this,+t)},valueOf:e.prototype.getValue,toStream:function(e){var t=i.Get(e),n=t.Unit(this.getUnit());e.string+=String(t.ToUnit(n,this.getValue()))},toXMLStream:function(e){this.toStream(e)}}),n}),define("x_ite/Fields/SFInt32",["x_ite/Basic/X3DField","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function i(t){return this instanceof i?e.call(this,~~t):e.call(Object.create(i.prototype),~~t)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,copy:function(){return new i(this.getValue())},getTypeName:function(){return"SFInt32"},getType:function(){return t.SFInt32},isDefaultValue:function(){return 0===this.getValue()},set:function(t){e.prototype.set.call(this,~~t)},valueOf:e.prototype.getValue,toStream:function(e,t){e.string+=this.getValue().toString(t)},toXMLStream:function(e){e.string+=this.getValue().toString()}}),i}),define("x_ite/Fields/SFImage",["x_ite/Basic/X3DField","x_ite/Fields/SFInt32","x_ite/Bits/X3DConstants"],function(e,t,i){"use strict";function n(e,t,i,n){var r=require("x_ite/Fields/ArrayFields").MFInt32;this.width=e,this.height=t,this.comp=i,this.array=new r,this.array.setValue(n),this.array.length=e*t}function r(t,i,s,o){if(this instanceof r){var a=require("x_ite/Fields/ArrayFields").MFInt32;return 4===arguments.length?e.call(this,new n(+t,+i,+s,o)):e.call(this,new n(0,0,0,new a)),this.getValue().getArray().addParent(this),this.addInterest("set_size__",this),this}return r.apply(Object.create(r.prototype),arguments)}n.prototype={constructor:n,copy:function(){return new n(this.width,this.height,this.comp,this.array)},equals:function(e){return this.width===e.width&&this.height===e.height&&this.comp===e.comp&&this.array.equals(e.array)},assign:function(e){this.width=e.width,this.height=e.height,this.comp=e.comp,this.array.assign(e.array)},set:function(e,t,i,n){this.width=e,this.height=t,this.comp=i,this.array.assign(n)},setWidth:function(e){this.width=e,this.array.length=this.width*this.height},getWidth:function(){return this.width},setHeight:function(e){this.height=e,this.array.length=this.width*this.height},getHeight:function(){return this.height},setComp:function(e){this.comp=e},getComp:function(){return this.comp},setArray:function(e){this.array.assign(e),this.array.length=this.width*this.height},getArray:function(){return this.array}},r.prototype=Object.assign(Object.create(e.prototype),{constructor:r,set_size__:function(){this.getValue().getArray().length=this.width*this.height},copy:function(){return new r(this.getValue())},equals:function(e){return this.getValue().equals(e.getValue())},isDefaultValue:function(){return 0===this.width&&0===this.height&&0===this.comp},set:function(e){this.getValue().assign(e)},getTypeName:function(){return"SFImage"},getType:function(){return i.SFImage},toStream:function(e){var i=this.array,n=new t;e.string+=this.width+" "+this.height+" "+this.comp;for(var r=0,s=this.width*this.height;r<s;++r)e.string+=" 0x",n.set(i[r]),n.toXMLStream(e)},toXMLStream:function(e){this.toStream(e)}});var s={get:function(){return this.getValue().getWidth()},set:function(e){this.getValue().setWidth(e),this.addEvent()},enumerable:!0,configurable:!1},o={get:function(){return this.getValue().getHeight()},set:function(e){this.getValue().setHeight(e),this.addEvent()},enumerable:!0,configurable:!1},a={get:function(){return this.getValue().getComp()},set:function(e){this.getValue().setComp(e),this.addEvent()},enumerable:!0,configurable:!1},u={get:function(){return this.getValue().getArray()},set:function(e){this.getValue().setArray(e),this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(r.prototype,"width",s),Object.defineProperty(r.prototype,"height",o),Object.defineProperty(r.prototype,"comp",a),Object.defineProperty(r.prototype,"array",u),s.enumerable=!1,o.enumerable=!1,Object.defineProperty(r.prototype,"x",s),Object.defineProperty(r.prototype,"y",o),r}),define("x_ite/Fields/SFMatrixPrototypeTemplate",["x_ite/Basic/X3DField"],function(e){"use strict";return function(t,i){return Object.assign(Object.create(e.prototype),{copy:function(){return new this.constructor(this.getValue().copy())},equals:function(e){return this.getValue().equals(e.getValue())},isDefaultValue:function(){return this.getValue().equals(t.Identity)},set:function(e){this.getValue().assign(e)},setTransform:function(e,t,i,n,r){e=e?e.getValue():null,t=t?t.getValue():null,i=i?i.getValue():null,n=n?n.getValue():null,r=r?r.getValue():null,this.getValue().set(e,t,i,n,r)},getTransform:function(e,t,i,n,r){e=e?e.getValue():null,t=t?t.getValue():null,i=i?i.getValue():null,n=n?n.getValue():null,r=r?r.getValue():null,this.getValue().get(e,t,i,n,r)},transpose:function(){return new this.constructor(t.transpose(this.getValue()))},inverse:function(){return new this.constructor(t.inverse(this.getValue()))},multLeft:function(e){return new this.constructor(t.multLeft(this.getValue(),e.getValue()))},multRight:function(e){return new this.constructor(t.multRight(this.getValue(),e.getValue()))},multVecMatrix:function(e){return new i(this.getValue().multVecMatrix(e.getValue().copy()))},multMatrixVec:function(e){return new i(this.getValue().multMatrixVec(e.getValue().copy()))},multDirMatrix:function(e){return new i(this.getValue().multDirMatrix(e.getValue().copy()))},multMatrixDir:function(e){return new i(this.getValue().multMatrixDir(e.getValue().copy()))},toStream:function(e){e.string+=this.getValue().toString()},toXMLStream:function(e){this.toStream(e)}})}}),define("x_ite/Fields/SFVecPrototypeTemplate",["x_ite/Basic/X3DField","x_ite/InputOutput/Generator"],function(e,t){"use strict";return function(i){return Object.assign(Object.create(e.prototype),{copy:function(){return new this.constructor(this.getValue().copy())},equals:function(e){return this.getValue().equals(e.getValue())},isDefaultValue:function(e){return this.getValue().equals(i.Zero)},set:function(e){this.getValue().assign(e)},add:function(e){return new this.constructor(i.add(this.getValue(),e.getValue()))},distance:function(e){return this.getValue().distance(e.getValue())},divide:function(e){return new this.constructor(i.divide(this.getValue(),e))},divVec:function(e){return new this.constructor(i.divVec(this.getValue(),e.getValue()))},dot:function(e){return this.getValue().dot(e.getValue())},length:function(){return this.getValue().abs()},lerp:function(e,t){return new this.constructor(i.lerp(this.getValue(),e,t))},multiply:function(e){return new this.constructor(i.multiply(this.getValue(),e))},multVec:function(e){return new this.constructor(i.multVec(this.getValue(),e.getValue()))},negate:function(){return new this.constructor(i.negate(this.getValue().copy()))},normalize:function(e){return new this.constructor(i.normalize(this.getValue()))},subtract:function(e){return new this.constructor(i.subtract(this.getValue(),e.getValue()))},toStream:function(e){for(var i=t.Get(e),n=this.getValue(),r=i.Unit(this.getUnit()),s=0,o=n.length-1;s<o;++s)e.string+=String(i.ToUnit(r,n[s])),e.string+=" ";e.string+=String(i.ToUnit(r,n[s]))},toXMLStream:function(e){this.toStream(e)}})}}),define("standard/Math/Numbers/Vector2",["standard/Math/Algorithm"],function(e){"use strict";function t(e,t){this.x=e,this.y=t}return t.prototype={constructor:t,length:2,copy:function(){var e=Object.create(t.prototype);return e.x=this.x,e.y=this.y,e},assign:function(e){return this.x=e.x,this.y=e.y,this},set:function(e,t){return this.x=e,this.y=t,this},equals:function(e){return this.x===e.x&&this.y===e.y},negate:function(){return this.x=-this.x,this.y=-this.y,this},add:function(e){return this.x+=e.x,this.y+=e.y,this},subtract:function(e){return this.x-=e.x,this.y-=e.y,this},multiply:function(e){return this.x*=e,this.y*=e,this},multVec:function(e){return this.x*=e.x,this.y*=e.y,this},divide:function(e){return this.x/=e,this.y/=e,this},divVec:function(e){return this.x/=e.x,this.y/=e.y,this},normalize:function(){var e=this.x,t=this.y,i=Math.sqrt(e*e+t*t);return i&&(this.x=e/i,this.y=t/i),this},dot:function(e){return this.x*e.x+this.y*e.y},norm:function(){var e=this.x,t=this.y;return e*e+t*t},abs:function(){var e=this.x,t=this.y;return Math.sqrt(e*e+t*t)},distance:function(e){var t=this.x-e.x,i=this.y-e.y;return Math.sqrt(t*t+i*i)},lerp:function(e,t){var i=this.x,n=this.y;return this.x=i+t*(e.x-i),this.y=n+t*(e.y-n),this},min:function(e){for(var t=this.x,i=this.y,n=0,r=arguments.length;n<r;++n){var e=arguments[n];t=Math.min(t,e.x),i=Math.min(i,e.y)}return this.x=t,this.y=i,this},max:function(e){for(var t=this.x,i=this.y,n=0,r=arguments.length;n<r;++n){var e=arguments[n];t=Math.max(t,e.x),i=Math.max(i,e.y)}return this.x=t,this.y=i,this},toString:function(){return this.x+" "+this.y}},Object.defineProperty(t.prototype,"0",{get:function(){return this.x},set:function(e){this.x=e},enumerable:!1,configurable:!1}),Object.defineProperty(t.prototype,"1",{get:function(){return this.y},set:function(e){this.y=e},enumerable:!1,configurable:!1}),Object.assign(t,{Zero:new t(0,0),One:new t(1,1),negate:function(e){var t=Object.create(this.prototype);return t.x=-e.x,t.y=-e.y,t},add:function(e,t){var i=Object.create(this.prototype);return i.x=e.x+t.x,i.y=e.y+t.y,i},subtract:function(e,t){var i=Object.create(this.prototype);return i.x=e.x-t.x,i.y=e.y-t.y,i},multiply:function(e,t){var i=Object.create(this.prototype);return i.x=e.x*t,i.y=e.y*t,i},multVec:function(e,t){var i=Object.create(this.prototype);return i.x=e.x*t.x,i.y=e.y*t.y,i},divide:function(e,t){var i=Object.create(this.prototype);return i.x=e.x/t,i.y=e.y/t,i},divVec:function(e,t){var i=Object.create(this.prototype);return i.x=e.x/t.x,i.y=e.y/t.y,i},normalize:function(e){var t=Object.create(this.prototype),i=e.x,n=e.y,r=Math.sqrt(i*i+n*n);return r?(t.x=i/r,t.y=n/r):(t.x=0,t.y=0),t},dot:function(e,t){return e.dot(t)},lerp:function(e,i,n){var r=e.x,s=e.y;return new t(r+n*(i.x-r),s+n*(i.y-s))},min:function(e,i){for(var n=e.x,r=e.y,s=1,o=arguments.length;s<o;++s){var a=arguments[s];n=Math.min(n,a.x),r=Math.min(r,a.y)}return new t(n,r)},max:function(e,i){for(var n=e.x,r=e.y,s=1,o=arguments.length;s<o;++s){var a=arguments[s];n=Math.max(n,a.x),r=Math.max(r,a.y)}return new t(n,r)}}),t}),define("x_ite/Fields/SFVec2",["x_ite/Basic/X3DField","x_ite/Fields/SFVecPrototypeTemplate","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2"],function(e,t,i,n){"use strict";function r(i,r){function s(t,i){return arguments.length?arguments[0]instanceof n?e.call(this,arguments[0]):e.call(this,new n(+t,+i)):e.call(this,new n(0,0))}s.prototype=Object.assign(Object.create(e.prototype),t(n),{constructor:s,getTypeName:function(){return i},getType:function(){return r}});var o={get:function(){return this.getValue().x},set:function(e){this.getValue().x=e,this.addEvent()},enumerable:!0,configurable:!1},a={get:function(){return this.getValue().y},set:function(e){this.getValue().y=e,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(s.prototype,"x",o),Object.defineProperty(s.prototype,"y",a),o.enumerable=!1,a.enumerable=!1,Object.defineProperty(s.prototype,"0",o),Object.defineProperty(s.prototype,"1",a),s}return{SFVec2d:r("SFVec2d",i.SFVec2d),SFVec2f:r("SFVec2f",i.SFVec2f)}}),define("standard/Math/Numbers/Vector3",["standard/Math/Algorithm"],function(e){"use strict";function t(e,t,i){this.x=e,this.y=t,this.z=i}t.prototype={constructor:t,length:3,copy:function(){var e=Object.create(t.prototype);return e.x=this.x,e.y=this.y,e.z=this.z,e},assign:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},set:function(e,t,i){return this.x=e,this.y=t,this.z=i,this},equals:function(e){return this.x===e.x&&this.y===e.y&&this.z===e.z},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},add:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this},subtract:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this},multiply:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multVec:function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this},divide:function(e){return this.x/=e,this.y/=e,this.z/=e,this},divVec:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},cross:function(e){var t=this.x,i=this.y,n=this.z;return this.x=i*e.z-n*e.y,this.y=n*e.x-t*e.z,this.z=t*e.y-i*e.x,this},normalize:function(){var e=this.x,t=this.y,i=this.z,n=Math.sqrt(e*e+t*t+i*i);return n&&(this.x=e/n,this.y=t/n,this.z=i/n),this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},norm:function(){var e=this.x,t=this.y,i=this.z;return e*e+t*t+i*i},abs:function(){var e=this.x,t=this.y,i=this.z;return Math.sqrt(e*e+t*t+i*i)},distance:function(e){var t=this.x-e.x,i=this.y-e.y,n=this.z-e.z;return Math.sqrt(t*t+i*i+n*n)},lerp:function(e,t){var i=this.x,n=this.y,r=this.z;return this.x=i+t*(e.x-i),this.y=n+t*(e.y-n),this.z=r+t*(e.z-r),this},slerp:function(t,n){return e.simpleSlerp(this,i.assign(t),n)},min:function(e){for(var t=this.x,i=this.y,n=this.z,r=0,s=arguments.length;r<s;++r){var e=arguments[r];t=Math.min(t,e.x),i=Math.min(i,e.y),n=Math.min(n,e.z)}return this.x=t,this.y=i,this.z=n,this},max:function(e){for(var t=this.x,i=this.y,n=this.z,r=0,s=arguments.length;r<s;++r){var e=arguments[r];t=Math.max(t,e.x),i=Math.max(i,e.y),n=Math.max(n,e.z)}return this.x=t,this.y=i,this.z=n,this},toString:function(){return this.x+" "+this.y+" "+this.z}},Object.defineProperty(t.prototype,"0",{get:function(){return this.x},set:function(e){this.x=e},enumerable:!1,configurable:!1}),Object.defineProperty(t.prototype,"1",{get:function(){return this.y},set:function(e){this.y=e},enumerable:!1,configurable:!1}),Object.defineProperty(t.prototype,"2",{get:function(){return this.z},set:function(e){this.z=e},enumerable:!1,configurable:!1}),Object.assign(t,{Zero:new t(0,0,0),One:new t(1,1,1),xAxis:new t(1,0,0),yAxis:new t(0,1,0),zAxis:new t(0,0,1),negate:function(e){var t=Object.create(this.prototype);return t.x=-e.x,t.y=-e.y,t.z=-e.z,t},add:function(e,t){var i=Object.create(this.prototype);return i.x=e.x+t.x,i.y=e.y+t.y,i.z=e.z+t.z,i},subtract:function(e,t){var i=Object.create(this.prototype);return i.x=e.x-t.x,i.y=e.y-t.y,i.z=e.z-t.z,i},multiply:function(e,t){var i=Object.create(this.prototype);return i.x=e.x*t,i.y=e.y*t,i.z=e.z*t,i},multVec:function(e,t){var i=Object.create(this.prototype);return i.x=e.x*t.x,i.y=e.y*t.y,i.z=e.z*t.z,i},divide:function(e,t){var i=Object.create(this.prototype);return i.x=e.x/t,i.y=e.y/t,i.z=e.z/t,i},divVec:function(e,t){var i=Object.create(this.prototype);return i.x=e.x/t.x,i.y=e.y/t.y,i.z=e.z/t.z,i},cross:function(e,t){var i=Object.create(this.prototype);return i.x=e.y*t.z-e.z*t.y,i.y=e.z*t.x-e.x*t.z,i.z=e.x*t.y-e.y*t.x,i},normalize:function(e){var t=Object.create(this.prototype),i=e.x,n=e.y,r=e.z,s=Math.sqrt(i*i+n*n+r*r);return s?(t.x=i/s,t.y=n/s,t.z=r/s):(t.x=0,t.y=0,t.z=0),t},dot:function(e,t){return e.dot(t)},lerp:function(e,i,n){var r=e.x,s=e.y,o=e.z;return new t(r+n*(i.x-r),s+n*(i.y-s),o+n*(i.z-o))},slerp:function(t,n,r){return e.simpleSlerp(t.copy(),i.assign(n),r)},min:function(e,i){for(var n=e.x,r=e.y,s=e.z,o=1,a=arguments.length;o<a;++o){var u=arguments[o];n=Math.min(n,u.x),r=Math.min(r,u.y),s=Math.min(s,u.z)}return new t(n,r,s)},max:function(e,i){for(var n=e.x,r=e.y,s=e.z,o=1,a=arguments.length;o<a;++o){var u=arguments[o];n=Math.max(n,u.x),r=Math.max(r,u.y),s=Math.max(s,u.z)}return new t(n,r,s)}});var i=new t(0,0,0);return t}),define("standard/Math/Numbers/Matrix2",["standard/Math/Numbers/Vector2","standard/Math/Algorithm"],function(e,t){"use strict";function i(){arguments.length?(this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3]):this.identity()}return i.prototype={constructor:i,order:2,length:4,copy:function(){var e=Object.create(i.prototype);return e[0]=this[0],e[1]=this[1],e[2]=this[2],e[3]=this[3],e},assign:function(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this},equals:function(e){return this[0]===e[0]&&this[1]===e[1]&&this[2]===e[2]&&this[3]===e[3]},set1:function(e,t,i){this[e*this.order+t]=i},get1:function(e,t){return this[e*this.order+t]},set:function(){switch(arguments.length){case 0:this.identity();break;case 4:this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3]}},determinant1:function(){return this[0]},determinant:function(){return this[0]*this[3]-this[1]*this[2]},transpose:function(){var e=this[1];return this[1]=this[2],this[2]=e,this},inverse:function(){var e=this.determinant();if(0===e)throw new Error("Matrix2 .inverse: determinant is 0.");return this[0]=array[0]/e,this[1]=-array[1]/e,this[2]=-array[2]/e,this[3]=array[3]/e,this},multLeft:function(e){var t=this[0],i=this[1],n=this[2],r=this[3],s=e[0],o=e[1],a=e[2],u=e[3];return this[0]=t*s+n*o,this[1]=i*s+r*o,this[2]=t*a+n*u,this[3]=i*a+r*u,this},multRight:function(e){var t=this[0],i=this[1],n=this[2],r=this[3],s=e[0],o=e[1],a=e[2],u=e[3];return this[0]=s*t+a*i,this[1]=o*t+u*i,this[2]=s*n+a*r,this[3]=o*n+u*r,this},identity:function(){this[0]=1,this[1]=0,this[2]=0,this[3]=1},toString:function(){return this[0]+" "+this[1]+" "+this[2]+" "+this[3]}},Object.defineProperty(i.prototype,"x",{get:function(){var t=new e(0,0);return function(){return t.set(this[0],this[1])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(i.prototype,"xAxis",{get:function(){return this[0]},enumerable:!1,configurable:!1}),Object.defineProperty(i.prototype,"origin",{get:function(){return this[2]},enumerable:!1,configurable:!1}),Object.defineProperty(i.prototype,"submatrix",{get:function(){return this[0]},enumerable:!1,configurable:!1}),Object.assign(i,{Identity:new i}),i}),define("standard/Math/Algorithms/eigendecomposition",[],function(){"use strict";return function(e){var t,i,n,r,s,o,a,u,l,h,c,d,p,f=e.order,g=new Array(f),m=new Array(f),_=new Array(f),x=new Array(f),y=new Array(f),v=e.length;for(d=0;d<f;++d)for(m[d]=new Array(f),_[d]=new Array(f),x[d]=g[d]=e.get1(d,d),y[d]=0,p=0;p<f;++p)m[d][p]=d===p?1:0,_[d][p]=e.get1(p,d);for(d=0;d<50;++d){for(t=0,h=0;h<f-1;++h)for(c=h+1;c<f;++c)t+=Math.abs(_[h][c]);if(0===t)break;for(l=d<3?.2*t/v:0,h=0;h<f-1;++h)for(c=h+1;c<f;++c)if(u=100*Math.abs(_[h][c]),d>3&&Math.abs(g[h])+u===Math.abs(g[h])&&Math.abs(g[c])+u===Math.abs(g[c]))_[h][c]=0;else if(Math.abs(_[h][c])>l){for(a=g[c]-g[h],Math.abs(a)+u===Math.abs(a)?s=_[h][c]/a:(i=.5*a/_[h][c],s=1/(Math.abs(i)+Math.sqrt(1+i*i)),i<0&&(s=-s)),n=1/Math.sqrt(1+s*s),r=s*n,o=r/(1+n),a=s*_[h][c],y[h]-=a,y[c]+=a,g[h]-=a,g[c]+=a,_[h][c]=0,p=0;p<h;++p)u=_[p][h],a=_[p][c],_[p][h]=u-r*(a+u*o),_[p][c]=a+r*(u-a*o);for(p=h+1;p<c;++p)u=_[h][p],a=_[p][c],_[h][p]=u-r*(a+u*o),_[p][c]=a+r*(u-a*o);for(p=c+1;p<f;++p)u=_[h][p],a=_[c][p],_[h][p]=u-r*(a+u*o),_[c][p]=a+r*(u-a*o);for(p=0;p<f;++p)u=m[p][h],a=m[p][c],m[p][h]=u-r*(a+u*o),m[p][c]=a+r*(u-a*o)}for(h=0;h<f;++h)g[h]=x[h]+=y[h],y[h]=0}return{values:g,vectors:m}}}),define("standard/Math/Numbers/Matrix3",["standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix2","standard/Math/Algorithms/eigendecomposition"],function(e,t,i,n){"use strict";function r(){arguments.length?(this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3],this[4]=arguments[4],this[5]=arguments[5],this[6]=arguments[6],this[7]=arguments[7],this[8]=arguments[8]):this.identity()}var s=new e(0,0),o=new t(0,0,0),a=new e(0,0),u=new t(0,0,0),l=new e(0,0),h=new i,c=new i,d=new i,p=new i,f=new e(0,0),g=new i;return r.prototype={constructor:r,order:3,length:9,copy:function(){var e=Object.create(r.prototype);return e[0]=this[0],e[1]=this[1],e[2]=this[2],e[3]=this[3],e[4]=this[4],e[5]=this[5],e[6]=this[6],e[7]=this[7],e[8]=this[8],e},assign:function(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this},equals:function(e){return this[0]===e[0]&&this[1]===e[1]&&this[2]===e[2]&&this[3]===e[3]&&this[4]===e[4]&&this[5]===e[5]&&this[6]===e[6]&&this[7]===e[7]&&this[8]===e[8]},rotation:function(){return math.atan2(this[1],this[0])},set1:function(e,t,i){return this[e*this.order+t]=i,this},get1:function(e,t){return this[e*this.order+t]},set:function(t,i,n,r,s){switch(arguments.length){case 0:this.identity();break;case 1:null===t&&(t=e.Zero),this.identity(),this.translate(t);break;case 2:null===t&&(t=e.Zero),null===i&&(i=0),this.identity(),this.translate(t),0!==i&&this.rotate(i);break;case 3:null===t&&(t=e.Zero),null===i&&(i=0),null===n&&(n=e.One),this.identity(),this.translate(t),0!==i&&this.rotate(i),n.equals(e.One)||this.scale(n);break;case 4:if(null===t&&(t=e.Zero),null===i&&(i=0),null===n&&(n=e.One),null===r&&(r=0),this.identity(),this.translate(t),0!==i&&this.rotate(i),!n.equals(e.One)){0!==r?(this.rotate(r),this.scale(n),this.rotate(-r)):this.scale(n)}break;case 5:null===t&&(t=e.Zero),null===i&&(i=0),null===n&&(n=e.One),null===r&&(r=0),null===s&&(s=e.Zero),this.identity(),this.translate(t);var o=!s.equals(e.Zero);o&&this.translate(s),0!==i&&this.rotate(i),n.equals(e.One)||(0!==r?(this.rotate(r),this.scale(n),this.rotate(-r)):this.scale(n)),o&&this.translate(e.negate(s));break;case 9:this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3],this[4]=arguments[4],this[5]=arguments[5],this[6]=arguments[6],this[7]=arguments[7],this[8]=arguments[8]}return this},get:function(e,t,i,n,h){switch(null===e&&(e=s),null===t&&(t=o),null===i&&(i=a),null===n&&(n=u),null===h&&(h=l),arguments.length){case 1:e.set(this[6],this[7]);break;case 2:this.factor(e,d,a,p),t[0]=d[0],t[1]=d[1],t[2]=Math.atan2(d[1],d[0]);break;case 3:this.factor(e,d,i,p),t[0]=d[0],t[1]=d[1],t[2]=Math.atan2(d[1],d[0]);break;case 4:this.factor(e,d,i,p),t[0]=d[0],t[1]=d[1],t[2]=Math.atan2(d[1],d[0]),n[0]=p[0],n[1]=p[1],n[2]=Math.atan2(p[1],p[0]);break;case 5:var c=new r;c.set(f.assign(h).negate()),c.multLeft(this),c.translate(h),c.get(e,t,i,n)}},factor:function(e,t,i,r){e.set(this[6],this[7]);var s=this.submatrix,o=s.determinant(),a=o<0?-1:1;if(0===o)return!1;g.assign(s).transpose().multLeft(s);var u=n(g);return r.set(u.vectors[0][0],u.vectors[0][1],u.vectors[1][0],u.vectors[1][1]),i.x=a*Math.sqrt(u.values[0]),i.y=a*Math.sqrt(u.values[1]),h[0]=1/i.x,h[3]=1/i.y,t.assign(c.assign(r).multRight(h).transpose().multLeft(r).multRight(s)),r.transpose(),!0},determinant2:function(){return this[0]*this[4]-this[1]*this[3]},determinant:function(){var e=this[0],t=this[1],i=this[2],n=this[3],r=this[4],s=this[5],o=this[6],a=this[7],u=this[8];return e*(r*u-s*a)-t*(n*u-s*o)+i*(n*a-r*o)},transpose:function(){var e;return e=this[1],this[1]=this[3],this[3]=e,e=this[2],this[2]=this[6],this[6]=e,e=this[5],this[5]=this[7],this[7]=e,this},inverse:function(){var e=this[0],t=this[1],i=this[2],n=this[3],r=this[4],s=this[5],o=this[6],a=this[7],u=this[8],l=e*r,h=e*a,c=n*t,d=n*a,p=o*t,f=o*r,g=l*u-h*s-c*u+d*i+p*s-f*i;if(0===g)throw new Error("Matrix3 .inverse: determinant is 0.");g=1/g;var m=(r*u-a*s)*g,_=-(t*u-a*i)*g,x=(t*s-r*i)*g,y=-(n*u-o*s)*g,v=(e*u-o*i)*g,w=-(e*s-n*i)*g;return this[0]=m,this[1]=_,this[2]=x,this[3]=y,this[4]=v,this[5]=w,this[6]=(d-f)*g,this[7]=-(h-p)*g,this[8]=(l-c)*g,this},multLeft:function(e){var t=this[0],i=this[1],n=this[2],r=this[3],s=this[4],o=this[5],a=this[6],u=this[7],l=this[8],h=e[0],c=e[1],d=e[2],p=e[3],f=e[4],g=e[5],m=e[6],_=e[7],x=e[8];return this[0]=t*h+r*c+a*d,this[1]=i*h+s*c+u*d,this[2]=n*h+o*c+l*d,this[3]=t*p+r*f+a*g,this[4]=i*p+s*f+u*g,this[5]=n*p+o*f+l*g,this[6]=t*m+r*_+a*x,this[7]=i*m+s*_+u*x,this[8]=n*m+o*_+l*x,this},multRight:function(e){var t=this[0],i=this[1],n=this[2],r=this[3],s=this[4],o=this[5],a=this[6],u=this[7],l=this[8],h=e[0],c=e[1],d=e[2],p=e[3],f=e[4],g=e[5],m=e[6],_=e[7],x=e[8];return this[0]=t*h+i*p+n*m,this[1]=t*c+i*f+n*_,this[2]=t*d+i*g+n*x,this[3]=r*h+s*p+o*m,this[4]=r*c+s*f+o*_,this[5]=r*d+s*g+o*x,
this[6]=a*h+u*p+l*m,this[7]=a*c+u*f+l*_,this[8]=a*d+u*g+l*x,this},multVecMatrix:function(e){if(2===e.length){var t=e.x,i=e.y,n=t*this[2]+i*this[5]+this[8];return e.x=(t*this[0]+i*this[3]+this[6])/n,e.y=(t*this[1]+i*this[4]+this[7])/n,e}var t=e.x,i=e.y,r=e.z;return e.x=t*this[0]+i*this[3]+r*this[6],e.y=t*this[1]+i*this[4]+r*this[7],e.z=t*this[2]+i*this[5]+r*this[8],e},multMatrixVec:function(e){if(2===e.length){var t=e.x,i=e.y,n=t*this[6]+i*this[7]+this[8];return e.x=(t*this[0]+i*this[1]+this[2])/n,e.y=(t*this[3]+i*this[4]+this[5])/n,e}var t=e.x,i=e.y,r=e.z;return e.x=t*this[0]+i*this[1]+r*this[2],e.y=t*this[3]+i*this[4]+r*this[5],e.z=t*this[6]+i*this[7]+r*this[8],e},multDirMatrix:function(e){var t=e.x,i=e.y;return e.x=t*this[0]+i*this[3],e.y=t*this[1]+i*this[4],e},multMatrixDir:function(e){var t=e.x,i=e.y;return e.x=t*this[0]+i*this[1],e.y=t*this[3]+i*this[4],e},identity:function(){this[0]=1,this[1]=0,this[2]=0,this[3]=0,this[4]=1,this[5]=0,this[6]=0,this[7]=0,this[8]=1},translate:function(e){var t=e.x,i=e.y;return this[6]+=this[0]*t+this[3]*i,this[7]+=this[1]*t+this[4]*i,this},rotate:function(e){return this.multLeft(r.Rotation(e)),this},scale:function(e){var t=e.x,i=e.y;return this[0]*=t,this[3]*=i,this[1]*=t,this[4]*=i,this},toString:function(){return this[0]+" "+this[1]+" "+this[2]+" "+this[3]+" "+this[4]+" "+this[5]+" "+this[6]+" "+this[7]+" "+this[8]}},Object.defineProperty(r.prototype,"x",{get:function(){var e=new t(0,0,0);return function(){return e.set(this[0],this[1],this[2])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"y",{get:function(){var e=new t(0,0,0);return function(){return e.set(this[3],this[4],this[5])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"xAxis",{get:function(){var t=new e(0,0);return function(){return t.set(this[0],this[1])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"yAxis",{get:function(){var t=new e(0,0);return function(){return t.set(this[3],this[4])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"origin",{get:function(){var t=new e(0,0);return function(){return t.set(this[6],this[7])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"submatrix",{get:function(){var e=new i;return function(){return e[0]=this[0],e[1]=this[1],e[2]=this[3],e[3]=this[4],e}}(),enumerable:!1,configurable:!1}),Object.assign(r,{Identity:new r,Rotation:function(e){var t=Math.sin(e),i=Math.cos(e);return new r(i,t,0,-t,i,0,0,0,1)},Matrix2:function(e){return new r(e[0],e[1],0,e[2],e[3],0,0,0,1)},transpose:function(e){var t=Object.create(this.prototype);return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],t},inverse:function(e){var t=Object.create(this.prototype),i=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],u=e[6],l=e[7],h=e[8],c=i*o,d=i*l,p=s*n,f=s*l,g=u*n,m=u*o,_=c*h-d*a-p*h+f*r+g*a-m*r;if(0===_)throw new Error("Matrix3 .inverse: determinant is 0.");_=1/_;var x=(o*h-l*a)*_,y=-(n*h-l*r)*_,v=(n*a-o*r)*_,w=-(s*h-u*a)*_,b=(i*h-u*r)*_,S=-(i*a-s*r)*_;return t[0]=x,t[1]=y,t[2]=v,t[3]=w,t[4]=b,t[5]=S,t[6]=(f-m)*_,t[7]=-(d-g)*_,t[8]=(c-p)*_,t},multLeft:function(e,t){var i=Object.create(this.prototype),n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],u=e[5],l=e[6],h=e[7],c=e[8],d=t[0],p=t[1],f=t[2],g=t[3],m=t[4],_=t[5],x=t[6],y=t[7],v=t[8];return i[0]=n*d+o*p+l*f,i[1]=r*d+a*p+h*f,i[2]=s*d+u*p+c*f,i[3]=n*g+o*m+l*_,i[4]=r*g+a*m+h*_,i[5]=s*g+u*m+c*_,i[6]=n*x+o*y+l*v,i[7]=r*x+a*y+h*v,i[8]=s*x+u*y+c*v,i},multRight:function(e,t){var i=Object.create(this.prototype),n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],u=e[5],l=e[6],h=e[7],c=e[8],d=t[0],p=t[1],f=t[2],g=t[3],m=t[4],_=t[5],x=t[6],y=t[7],v=t[8];return i[0]=n*d+r*g+s*x,i[1]=n*p+r*m+s*y,i[2]=n*f+r*_+s*v,i[3]=o*d+a*g+u*x,i[4]=o*p+a*m+u*y,i[5]=o*f+a*_+u*v,i[6]=l*d+h*g+c*x,i[7]=l*p+h*m+c*y,i[8]=l*f+h*_+c*v,i}}),r}),define("x_ite/Fields/SFMatrix3",["x_ite/Basic/X3DField","x_ite/Fields/SFMatrixPrototypeTemplate","x_ite/Fields/SFVec2","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix3"],function(e,t,i,n,r){"use strict";function s(i,n,s){function o(t,i,n,s,o,a,u,l,h){return arguments.length?arguments[0]instanceof r?e.call(this,arguments[0]):e.call(this,new r(+t,+i,+n,+s,+o,+a,+u,+l,+h)):e.call(this,new r)}o.prototype=Object.assign(Object.create(e.prototype),t(r,s),{constructor:o,getTypeName:function(){return i},getType:function(){return n},setTransform:function(e,t,i,n,r){e=e?e.getValue():null,t=t?t:0,i=i?i.getValue():null,n=n?n:0,r=r?r.getValue():null,this.getValue().set(e,t,i,n,r)}});for(var a=0;a<r.prototype.length;++a)!function(e){Object.defineProperty(o.prototype,e,{get:function(){return this.getValue()[e]},set:function(t){this.getValue()[e]=t,this.addEvent()},enumerable:!1,configurable:!1})}(a);return o}return{SFMatrix3d:s("SFMatrix3d",n.SFMatrix3d,i.SFVec2d),SFMatrix3f:s("SFMatrix3f",n.SFMatrix3f,i.SFVec2f)}}),define("x_ite/Fields/SFVec3",["x_ite/Basic/X3DField","x_ite/Fields/SFVecPrototypeTemplate","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n){"use strict";function r(i,r){function s(t,i,r){return arguments.length?arguments[0]instanceof n?e.call(this,arguments[0]):e.call(this,new n(+t,+i,+r)):e.call(this,new n(0,0,0))}s.prototype=Object.assign(Object.create(e.prototype),t(n),{constructor:s,getTypeName:function(){return i},getType:function(){return r},cross:function(e){return new this.constructor(n.cross(this.getValue(),e.getValue()))}});var o={get:function(){return this.getValue().x},set:function(e){this.getValue().x=e,this.addEvent()},enumerable:!0,configurable:!1},a={get:function(){return this.getValue().y},set:function(e){this.getValue().y=e,this.addEvent()},enumerable:!0,configurable:!1},u={get:function(){return this.getValue().z},set:function(e){this.getValue().z=e,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(s.prototype,"x",o),Object.defineProperty(s.prototype,"y",a),Object.defineProperty(s.prototype,"z",u),o.enumerable=!1,a.enumerable=!1,u.enumerable=!1,Object.defineProperty(s.prototype,"0",o),Object.defineProperty(s.prototype,"1",a),Object.defineProperty(s.prototype,"2",u),s}return{SFVec3d:r("SFVec3d",i.SFVec3d),SFVec3f:r("SFVec3f",i.SFVec3f)}}),define("standard/Math/Numbers/Vector4",["standard/Math/Algorithm"],function(e){"use strict";function t(e,t,i,n){this.x=e,this.y=t,this.z=i,this.w=n}return t.prototype={constructor:t,length:4,copy:function(){var e=Object.create(t.prototype);return e.x=this.x,e.y=this.y,e.z=this.z,e.w=this.w,e},assign:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},set:function(e,t,i,n){return this.x=e,this.y=t,this.z=i,this.w=n,this},equals:function(e){return this.x===e.x&&this.y===e.y&&this.z===e.z&&this.w===e.w},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},add:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this},subtract:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this},multiply:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},multVec:function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this},divide:function(e){return this.x/=e,this.y/=e,this.z/=e,this.w/=e,this},divVec:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this},normalize:function(){var e=this.x,t=this.y,i=this.z,n=this.w,r=Math.sqrt(e*e+t*t+i*i+n*n);return r&&(this.x=e/r,this.y=t/r,this.z=i/r,this.w=n/r),this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},norm:function(){var e=this.x,t=this.y,i=this.z,n=this.w;return e*e+t*t+i*i+n*n},abs:function(){var e=this.x,t=this.y,i=this.z,n=this.w;return Math.sqrt(e*e+t*t+i*i+n*n)},distance:function(e){var t=this.x-e.x,i=this.y-e.y,n=this.z-e.z,r=this.w-e.w;return Math.sqrt(t*t+i*i+n*n+r*r)},lerp:function(e,t){var i=this.x,n=this.y,r=this.z,s=this.w;return this.x=i+t*(e.x-i),this.y=n+t*(e.y-n),this.z=r+t*(e.z-r),this.w=s+t*(e.w-s),this},min:function(e){for(var t=this.x,i=this.y,n=this.z,r=this.w,s=0,o=arguments.length;s<o;++s){var e=arguments[s];t=Math.min(t,e.x),i=Math.min(i,e.y),n=Math.min(n,e.z),r=Math.min(r,e.w)}return this.x=t,this.y=i,this.z=n,this.w=r,this},max:function(e){for(var t=this.x,i=this.y,n=this.z,r=this.w,s=0,o=arguments.length;s<o;++s){var e=arguments[s];t=Math.max(t,e.x),i=Math.max(i,e.y),n=Math.max(n,e.z),r=Math.max(r,e.w)}return this.x=t,this.y=i,this.z=n,this.w=r,this},toString:function(){return this.x+" "+this.y+" "+this.z+" "+this.w}},Object.defineProperty(t.prototype,"0",{get:function(){return this.x},set:function(e){this.x=e},enumerable:!1,configurable:!1}),Object.defineProperty(t.prototype,"1",{get:function(){return this.y},set:function(e){this.y=e},enumerable:!1,configurable:!1}),Object.defineProperty(t.prototype,"2",{get:function(){return this.z},set:function(e){this.z=e},enumerable:!1,configurable:!1}),Object.defineProperty(t.prototype,"3",{get:function(){return this.w},set:function(e){this.w=e},enumerable:!1,configurable:!1}),Object.assign(t,{Zero:new t(0,0,0,0),One:new t(1,1,1,1),xAxis:new t(1,0,0,0),yAxis:new t(0,1,0,0),zAxis:new t(0,0,1,0),wAxis:new t(0,0,0,1),negate:function(e){var t=Object.create(this.prototype);return t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t},add:function(e,t){var i=Object.create(this.prototype);return i.x=e.x+t.x,i.y=e.y+t.y,i.z=e.z+t.z,i.w=e.w+t.w,i},subtract:function(e,t){var i=Object.create(this.prototype);return i.x=e.x-t.x,i.y=e.y-t.y,i.z=e.z-t.z,i.w=e.w-t.w,i},multiply:function(e,t){var i=Object.create(this.prototype);return i.x=e.x*t,i.y=e.y*t,i.z=e.z*t,i.w=e.w*t,i},multVec:function(e,t){var i=Object.create(this.prototype);return i.x=e.x*t.x,i.y=e.y*t.y,i.z=e.z*t.z,i.w=e.w*t.w,i},divide:function(e,t){var i=Object.create(this.prototype);return i.x=e.x/t,i.y=e.y/t,i.z=e.z/t,i.w=e.w/t,i},divVec:function(e,t){var i=Object.create(this.prototype);return i.x=e.x/t.x,i.y=e.y/t.y,i.z=e.z/t.z,i.w=e.w/t.w,i},normalize:function(e){var t=Object.create(this.prototype),i=e.x,n=e.y,r=e.z,s=e.w,o=Math.sqrt(i*i+n*n+r*r+s*s);return o?(t.x=i/o,t.y=n/o,t.z=r/o,t.w=s/o):(t.x=0,t.y=0,t.z=0,t.w=0),t},dot:function(e,t){return e.dot(t)},lerp:function(e,i,n){var r=e.x,s=e.y,o=e.z,a=e.w;return new t(r+n*(i.x-r),s+n*(i.y-s),o+n*(i.z-o),a+n*(i.w-a))},min:function(e,i){for(var n=e.x,r=e.y,s=e.z,o=e.w,a=1,u=arguments.length;a<u;++a){var l=arguments[a];n=Math.min(n,l.x),r=Math.min(r,l.y),s=Math.min(s,l.z),o=Math.min(o,l.w)}return new t(n,r,s,o)},max:function(e,i){for(var n=e.x,r=e.y,s=e.z,o=e.w,a=1,u=arguments.length;a<u;++a){var l=arguments[a];n=Math.max(n,l.x),r=Math.max(r,l.y),s=Math.max(s,l.z),o=Math.max(o,l.w)}return new t(n,r,s,o)}}),t}),define("standard/Math/Numbers/Quaternion",["standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(t,i){"use strict";function n(e,t,i,n){this.x=e,this.y=t,this.z=i,this.w=n}n.prototype={constructor:n,length:4,copy:function(){var e=Object.create(n.prototype);return e.x=this.x,e.y=this.y,e.z=this.z,e.w=this.w,e},assign:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},set:function(e,t,i,n){return this.x=e,this.y=t,this.z=i,this.w=n,this},setMatrix:function(e){var t;t=e[0]>e[4]?e[0]>e[8]?0:2:e[4]>e[8]?1:2;var i=e[0]+e[4]+e[8];if(i>e[3*t+t]){this[3]=Math.sqrt(i+1)/2;var n=4*this[3];this[0]=(e[5]-e[7])/n,this[1]=(e[6]-e[2])/n,this[2]=(e[1]-e[3])/n}else{var r=(t+1)%3,s=(t+2)%3;this[t]=Math.sqrt(e[3*t+t]-e[3*r+r]-e[3*s+s]+1)/2;var n=4*this[t];this[r]=(e[3*t+r]+e[3*r+t])/n,this[s]=(e[3*t+s]+e[3*s+t])/n,this[3]=(e[3*r+s]-e[3*s+r])/n}return this},getMatrix:function(e){var t=this.x,i=this.y,n=this.z,r=this.w,s=t*t,o=t*i,a=i*i,u=i*n,l=n*t,h=n*n,c=r*t,d=r*i,p=r*n;return e[0]=1-2*(a+h),e[1]=2*(o+p),e[2]=2*(l-d),e[3]=2*(o-p),e[4]=1-2*(h+s),e[5]=2*(u+c),e[6]=2*(l+d),e[7]=2*(u-c),e[8]=1-2*(a+s),e},isReal:function(){return!(this.x||this.y||this.z)},isImag:function(){return!this.w},equals:function(e){return this.x===e.x&&this.y===e.y&&this.z===e.z&&this.w===e.w},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},inverse:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},add:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this},subtract:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this},multiply:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},multLeft:function(e){var t=this.x,i=this.y,n=this.z,r=this.w,s=e.x,o=e.y,a=e.z,u=e.w;return this.x=r*s+t*u+i*a-n*o,this.y=r*o+i*u+n*s-t*a,this.z=r*a+n*u+t*o-i*s,this.w=r*u-t*s-i*o-n*a,this},multRight:function(e){var t=this.x,i=this.y,n=this.z,r=this.w,s=e.x,o=e.y,a=e.z,u=e.w;return this.x=u*t+s*r+o*n-a*i,this.y=u*i+o*r+a*t-s*n,this.z=u*n+a*r+s*i-o*t,this.w=u*r-s*t-o*i-a*n,this},divide:function(e){return this.x/=e,this.y/=e,this.z/=e,this.w/=e,this},multVecQuat:function(e){var t=this.x,i=this.y,n=this.z,r=this.w,s=e.x,o=e.y,a=e.z,u=r*r-t*t-i*i-n*n,l=2*(s*t+o*i+a*n),h=2*r;return e.x=u*s+l*t+h*(i*a-n*o),e.y=u*o+l*i+h*(n*s-t*a),e.z=u*a+l*n+h*(t*o-i*s),e},multQuatVec:function(e){var t=this.x,i=this.y,n=this.z,r=this.w,s=e.x,o=e.y,a=e.z,u=r*r-t*t-i*i-n*n,l=2*(s*t+o*i+a*n),h=2*r;return e.x=u*s+l*t-h*(i*a-n*o),e.y=u*o+l*i-h*(n*s-t*a),e.z=u*a+l*n-h*(t*o-i*s),e},normalize:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return e&&(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},norm:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},abs:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},pow:function(t){if(t instanceof n)return this.assign(e.assign(t).multRight(this.log()).exp());if(this.isReal())return this.set(0,0,0,Math.pow(this.w,t));var i=this.abs(),r=Math.acos(this.w/i),s=this.imag.abs(),o=Math.pow(i,t),a=t*r,u=o/s*Math.sin(a);return this.x*=u,this.y*=u,this.z*=u,this.w=o*Math.cos(a),this},log:function(){if(this.isReal())return this.w>0?this.set(0,0,0,Math.log(this.w)):this.set(Math.PI,0,0,Math.log(-this.w));var e=this.abs(),t=this.imag.normalize().multiply(Math.acos(this.w/e)),i=Math.log(e);return this.x=t.x,this.y=t.y,this.z=t.z,this.w=i,this},exp:function(){if(this.isReal())return this.set(0,0,0,Math.exp(this.w));var e=this.imag,t=e.abs(),i=Math.exp(this.w),n=i*Math.cos(t),r=e.multiply(i*Math.sin(t)/t);return this.x=r.x,this.y=r.y,this.z=r.z,this.w=n,this},slerp:function(e,t){return i.slerp(this,r.assign(e),t)},squad:function(e,t,n,a){return i.slerp(i.slerp(this,r.assign(n),a),i.slerp(s.assign(e),o.assign(t),a),2*a*(1-a))},toString:function(){return this.x+" "+this.y+" "+this.z+" "+this.w}},Object.defineProperty(n.prototype,"0",{get:function(){return this.x},set:function(e){this.x=e},enumerable:!1,configurable:!1}),Object.defineProperty(n.prototype,"1",{get:function(){return this.y},set:function(e){this.y=e},enumerable:!1,configurable:!1}),Object.defineProperty(n.prototype,"2",{get:function(){return this.z},set:function(e){this.z=e},enumerable:!1,configurable:!1}),Object.defineProperty(n.prototype,"3",{get:function(){return this.w},set:function(e){this.w=e},enumerable:!1,configurable:!1}),Object.defineProperty(n.prototype,"real",{get:function(){return this.w},enumerable:!1,configurable:!1}),Object.defineProperty(n.prototype,"imag",{get:function(){var e=new t(0,0,0);return function(){return e.set(this.x,this.y,this.z)}}(),enumerable:!1,configurable:!1}),Object.assign(n,{negate:function(e){var t=Object.create(this.prototype);return t.x=-this.x,t.y=-this.y,t.z=-this.z,t.w=-this.w,t},inverse:function(e){var t=Object.create(this.prototype);return t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=e.w,t},add:function(e,t){var i=Object.create(this.prototype);return i.x=e.x+t.x,i.y=e.y+t.y,i.z=e.z+t.z,i.w=e.w+t.w,i},subtract:function(e,t){var i=Object.create(this.prototype);return i.x=e.x-t.x,i.y=e.y-t.y,i.z=e.z-t.z,i.w=e.w-t.w,i},multiply:function(e,t){var i=Object.create(this.prototype);return i.x=e.x*t,i.y=e.y*t,i.z=e.z*t,i.w=e.w*t,i},multLeft:function(e,t){var i=Object.create(this.prototype),n=e.x,r=e.y,s=e.z,o=e.w,a=t.x,u=t.y,l=t.z,h=t.w;return i.x=o*a+n*h+r*l-s*u,i.y=o*u+r*h+s*a-n*l,i.z=o*l+s*h+n*u-r*a,i.w=o*h-n*a-r*u-s*l,i},multRight:function(e,t){var i=Object.create(this.prototype),n=e.x,r=e.y,s=e.z,o=e.w,a=t.x,u=t.y,l=t.z,h=t.w;return i.x=h*n+a*o+u*s-l*r,i.y=h*r+u*o+l*n-a*s,i.z=h*s+l*o+a*r-u*n,i.w=h*o-a*n-u*r-l*s,i},divide:function(e,t){var i=Object.create(this.prototype);return i.x=e.x/t,i.y=e.y/t,i.z=e.z/t,i.w=e.w/t,i},normalize:function(e){var t=Object.create(this.prototype),i=e.x,n=e.y,r=e.z,s=e.w,o=Math.sqrt(i*i+n*n+r*r+s*s);return o?(o=1/o,t.x=i*o,t.y=n*o,t.z=r*o,t.w=s*o):(t.x=0,t.y=0,t.z=0,t.w=0),t},slerp:function(e,t,n){return i.slerp(e.copy(),s.assign(t),n)},squad:function(e,t,n,a,u){return i.slerp(i.slerp(e.copy(),r.assign(a),u),i.slerp(s.assign(t),o.assign(n),u),2*u*(1-u))},spline:function(e,t,i){return a.assign(e),u.assign(t),l.assign(i),a.dot(u)<0&&a.negate(),l.dot(u)<0&&l.negate(),h.assign(u).inverse(),u.multRight(r.assign(h).multRight(a).log().add(s.assign(h).multRight(l).log()).divide(-4).exp()).normalize().copy()}});var r=new n(0,0,0,1),s=new n(0,0,0,1),o=new n(0,0,0,1),a=new n(0,0,0,1),u=new n(0,0,0,1),l=new n(0,0,0,1),h=new n(0,0,0,1);return n}),define("standard/Math/Numbers/Rotation4",["standard/Math/Numbers/Quaternion","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Algorithm"],function(e,t,i,n){"use strict";function r(i,n,r,s){switch(this.x_=0,this.y_=0,this.z_=1,this.angle_=0,arguments.length){case 0:return void(this.value=new e(0,0,0,1));case 1:return this.value=arguments[0],void this.update();case 2:var o=arguments[0],a=arguments[1];return this.value=new e(0,0,0,1),a instanceof t?this.setFromToVec(o,a):void this.set(o.x,o.y,o.z,a);case 4:return this.value=new e(0,0,0,1),void this.set(i,n,r,s)}}r.prototype={constructor:r,length:4,update:function(){var e=this.get();return this.x_=e.x,this.y_=e.y,this.z_=e.z,this.angle_=e.w,this},copy:function(){var e=Object.create(r.prototype);return e.x_=this.x_,e.y_=this.y_,e.z_=this.z_,e.angle_=this.angle_,e.value=this.value.copy(),e},assign:function(e){return this.x_=e.x_,this.y_=e.y_,this.z_=e.z_,this.angle_=e.angle_,this.value.assign(e.value),this},set:function(e,t,i,r){this.x_=e,this.y_=t,this.z_=i,this.angle_=r;var s=Math.sqrt(e*e+t*t+i*i);if(0===s)return this.value.set(0,0,0,1),this;var o=n.interval(r/2,0,Math.PI),s=Math.sin(o)/s;return this.value.set(e*s,t*s,i*s,Math.cos(o)),this},get:function(){var e=new i(0,0,0,0);return function(){var t=this.value;if(Math.abs(t.w>1))return i.zAxis;var n=2*Math.acos(t.w),r=Math.sin(n/2);if(0===r)return i.zAxis;var s=t.imag.divide(r);return e.set(s.x,s.y,s.z,n)}}(),setAxisAngle:function(e,t){return this.set(e.x,e.y,e.z,t)},setFromToVec:function(){var e=new t(0,0,0),i=new t(0,0,0),r=new t(0,0,0),s=new t(0,0,0);return function(o,a){e.assign(o).normalize(),i.assign(a).normalize();var u=n.clamp(e.dot(i),-1,1),l=r.assign(e).cross(i).normalize();return 0===l.abs()?u>0?this.value.set(0,0,0,1):(s.assign(e).cross(t.xAxis),0===s.norm()&&s.assign(e).cross(t.yAxis),s.normalize(),this.value.set(s.x,s.y,s.z,0)):(l.multiply(Math.sqrt(Math.abs(1-u)/2)),this.value.set(l.x,l.y,l.z,Math.sqrt(Math.abs(1+u)/2))),this.update(),this}}(),setAxis:function(e){this.set(e.x,e.y,e.z,this.angle_)},getAxis:function(){var e=new t(0,0,0);return function(){return e.set(this.x_,this.y_,this.z_)}}(),setMatrix:function(e){return this.value.setMatrix(e).normalize(),this.update(),this},getMatrix:function(e){return this.value.getMatrix(e)},equals:function(e){return this.value.equals(e.value)},inverse:function(){return this.value.inverse(),this.update(),this},multLeft:function(e){return this.value.multLeft(e.value).normalize(),this.update(),this},multRight:function(e){return this.value.multRight(e.value).normalize(),this.update(),this},multVecRot:function(e){return this.value.multVecQuat(e)},multRotVec:function(e){return this.value.multQuatVec(e)},normalize:function(){return this.value.normalize(),this.update(),this},pow:function(e){return this.value.pow(e),this.update(),this},slerp:function(e,t){return this.value.slerp(e.value,t),this.update(),this},squad:function(e,t,i,n){return this.value.squad(e.value,t.value,i.value,n),this.update(),this},toString:function(){return this.x_+" "+this.y_+" "+this.z_+" "+this.angle_}};var s={get:function(){return this.x_},set:function(e){this.x_=e,this.set(e,this.y_,this.z_,this.angle_)},enumerable:!0,configurable:!1},o={get:function(){return this.y_},set:function(e){this.y_=e,this.set(this.x_,e,this.z_,this.angle_)},enumerable:!0,configurable:!1},a={get:function(){return this.z_},set:function(e){this.z_=e,this.set(this.x_,this.y_,e,this.angle_)},enumerable:!0,configurable:!1},u={get:function(){return this.angle_},set:function(e){this.angle_=e,this.set(this.x_,this.y_,this.z_,e)},enumerable:!0,configurable:!1};return Object.defineProperty(r.prototype,"x",s),Object.defineProperty(r.prototype,"y",o),Object.defineProperty(r.prototype,"z",a),Object.defineProperty(r.prototype,"angle",u),s.enumerable=!1,o.enumerable=!1,a.enumerable=!1,u.enumerable=!1,Object.defineProperty(r.prototype,"0",s),Object.defineProperty(r.prototype,"1",o),Object.defineProperty(r.prototype,"2",a),Object.defineProperty(r.prototype,"3",u),Object.assign(r,{Identity:new r,inverse:function(t){var i=Object.create(this.prototype);return i.value=e.inverse(t.value),i.update(),i},multRight:function(t,i){var n=Object.create(this.prototype);return n.value=e.multRight(t.value,i.value),n.update(),n},normalize:function(){var e=Object.create(this.prototype);return e.value=rotation.value.copy(),e.update(),e},slerp:function(t,i,n){var r=Object.create(this.prototype);return r.value=e.slerp(t.value,i.value,n),r.update(),r},squad:function(t,i,n,r,s){var o=Object.create(this.prototype);return o.value=e.squad(t.value,i,n,r.value,s),o.update(),o},bezier:function(t,i,n,r,s){var o=Object.create(this.prototype);return o.value=e.bezier(t.value,i,n,r.value,s),o.update(),o},spline:function(t,i,n){var r=Object.create(this.prototype);return r.value=e.spline(t.value,i.value,n.value),r.update(),r}}),r}),define("standard/Math/Numbers/Matrix4",["standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix3","standard/Math/Algorithms/eigendecomposition"],function(e,t,i,n,r){"use strict";function s(){arguments.length?(this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3],this[4]=arguments[4],this[5]=arguments[5],this[6]=arguments[6],this[7]=arguments[7],this[8]=arguments[8],this[9]=arguments[9],this[10]=arguments[10],this[11]=arguments[11],this[12]=arguments[12],this[13]=arguments[13],this[14]=arguments[14],this[15]=arguments[15]):this.identity()}var o=new e(0,0,0),a=new i,u=new e(0,0,0),l=new i,h=new e(0,0,0),c=new n,d=new n,p=new n,f=new n,g=new e(0,0,0),m=new n;s.prototype={constructor:s,order:4,length:16,copy:function(){var e=Object.create(s.prototype);return e[0]=this[0],e[1]=this[1],e[2]=this[2],e[3]=this[3],e[4]=this[4],e[5]=this[5],e[6]=this[6],e[7]=this[7],e[8]=this[8],e[9]=this[9],e[10]=this[10],e[11]=this[11],e[12]=this[12],e[13]=this[13],e[14]=this[14],e[15]=this[15],e},assign:function(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this},equals:function(e){return this[0]===e[0]&&this[1]===e[1]&&this[2]===e[2]&&this[3]===e[3]&&this[4]===e[4]&&this[5]===e[5]&&this[6]===e[6]&&this[7]===e[7]&&this[8]===e[8]&&this[9]===e[9]&&this[10]===e[10]&&this[11]===e[11]&&this[12]===e[12]&&this[13]===e[13]&&this[14]===e[14]&&this[15]===e[15]},set1:function(e,t,i){return this[e*this.order+t]=i,this},get1:function(e,t){return this[e*this.order+t]},set:function(t,n,r,s,o){switch(arguments.length){case 0:this.identity();break;case 1:null===t&&(t=e.Zero),this.identity(),this.translate(t);break;case 2:null===t&&(t=e.Zero),null===n&&(n=i.Identity),this.identity(),this.translate(t),n.equals(i.Identity)||this.rotate(n);break;case 3:null===t&&(t=e.Zero),null===n&&(n=i.Identity),null===r&&(r=e.One),this.identity(),this.translate(t),n.equals(i.Identity)||this.rotate(n),r.equals(e.One)||this.scale(r);break;case 4:if(null===t&&(t=e.Zero),null===n&&(n=i.Identity),null===r&&(r=e.One),null===s&&(s=i.Identity),this.identity(),this.translate(t),n.equals(i.Identity)||this.rotate(n),!r.equals(e.One)){!s.equals(i.Identity)?(this.rotate(s),this.scale(r),this.rotate(i.inverse(s))):this.scale(r)}break;case 5:null===t&&(t=e.Zero),null===n&&(n=i.Identity),null===r&&(r=e.One),null===s&&(s=i.Identity),null===o&&(o=e.Zero),this.identity(),this.translate(t);var a=!o.equals(e.Zero);a&&this.translate(o),n.equals(i.Identity)||this.rotate(n),r.equals(e.One)||(s.equals(i.Identity)?this.scale(r):(this.rotate(s),this.scale(r),this.rotate(i.inverse(s)))),a&&this.translate(e.negate(o));break;case 16:this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3],this[4]=arguments[4],this[5]=arguments[5],this[6]=arguments[6],this[7]=arguments[7],this[8]=arguments[8],this[9]=arguments[9],this[10]=arguments[10],this[11]=arguments[11],this[12]=arguments[12],this[13]=arguments[13],this[14]=arguments[14],this[15]=arguments[15]}return this},get:function(e,t,i,n,r){switch(null===e&&(e=o),null===t&&(t=a),null===i&&(i=u),null===n&&(n=l),null===r&&(r=h),arguments.length){case 1:e.set(this[12],this[13],this[14]);break;case 2:this.factor(e,c,u,d),t.setMatrix(c);break;case 3:this.factor(e,c,i,d),t.setMatrix(c);break;case 4:this.factor(e,c,i,d),t.setMatrix(c),n.setMatrix(d);break;case 5:var p=new s;p.set(g.assign(r).negate()),p.multLeft(this),p.translate(r),p.get(e,t,i,n)}},setRotation:function(e){return this.setQuaternion(e.value)},setQuaternion:function(e){var t=e.x,i=e.y,n=e.z,r=e.w,s=i*i,o=n*n,a=t*i,u=n*r,l=n*t,h=i*r,c=t*t,d=i*n,p=t*r;return this[0]=1-2*(s+o),this[1]=2*(a+u),this[2]=2*(l-h),this[3]=0,this[4]=2*(a-u),this[5]=1-2*(o+c),this[6]=2*(d+p),this[7]=0,this[8]=2*(l+h),this[9]=2*(d-p),this[10]=1-2*(s+c),this[11]=0,this[12]=0,this[13]=0,this[14]=0,this[15]=1,this},factor:function(e,t,i,n){e.set(this[12],this[13],this[14]);var s=this.submatrix,o=s.determinant(),a=o<0?-1:1;if(0===o)return!1;m.assign(s).transpose().multLeft(s);var u=r(m);return n.set(u.vectors[0][0],u.vectors[0][1],u.vectors[0][2],u.vectors[1][0],u.vectors[1][1],u.vectors[1][2],u.vectors[2][0],u.vectors[2][1],u.vectors[2][2]),i.x=a*Math.sqrt(u.values[0]),i.y=a*Math.sqrt(u.values[1]),i.z=a*Math.sqrt(u.values[2]),p[0]=1/i.x,p[4]=1/i.y,p[8]=1/i.z,t.assign(f.assign(n).multRight(p).transpose().multLeft(n).multRight(s)),n.transpose(),!0},determinant3:function(){var e=this[0],t=this[1],i=this[2],n=this[4],r=this[5],s=this[6],o=this[8],a=this[9],u=this[10];return e*(r*u-s*a)-t*(n*u-s*o)+i*(n*a-r*o)},determinant:function(){var e=this[0],t=this[1],i=this[2],n=this[3],r=this[4],s=this[5],o=this[6],a=this[7],u=this[8],l=this[9],h=this[10],c=this[11],d=this[12],p=this[13],f=this[14],g=this[15],m=h*g,_=f*c,x=o*g,y=f*a,v=o*c,w=h*a,b=i*g,S=f*n,C=i*c,T=h*n,F=i*a,O=o*n;return e*(m*s+y*l+v*p-_*s-x*l-w*p)+r*(_*t+b*l+T*p-m*t-S*l-C*p)+u*(x*t+S*s+F*p-y*t-b*s-O*p)+d*(w*t+C*s+O*l-v*t-T*s-F*l)},transpose:function(){var e;return e=this[1],this[1]=this[4],this[1]=e,e=this[2],this[2]=this[8],this[2]=e,e=this[3],this[3]=this[12],this[3]=e,e=this[6],this[6]=this[9],this[6]=e,e=this[7],this[7]=this[13],this[7]=e,e=this[11],this[11]=this[14],this[11]=e,this},inverse:function(){var e=this[0],t=this[1],i=this[2],n=this[3],r=this[4],s=this[5],o=this[6],a=this[7],u=this[8],l=this[9],h=this[10],c=this[11],d=this[12],p=this[13],f=this[14],g=this[15],m=h*g,_=f*c,x=o*g,y=f*a,v=o*c,w=h*a,b=i*g,S=f*n,C=i*c,T=h*n,F=i*a,O=o*n,N=u*p,M=d*l,D=r*p,E=d*s,V=r*l,B=u*s,I=e*p,A=d*t,P=e*l,R=u*t,L=e*s,z=r*t,k=m*s+y*l+v*p-(_*s+x*l+w*p),X=_*t+b*l+T*p-(m*t+S*l+C*p),U=x*t+S*s+F*p-(y*t+b*s+O*p),j=w*t+C*s+O*l-(v*t+T*s+F*l),G=e*k+r*X+u*U+d*j;if(0===G)throw new Error("Matrix4 .inverse: determinant is 0.");return G=1/G,this[0]=G*k,this[1]=G*X,this[2]=G*U,this[3]=G*j,this[4]=G*(_*r+x*u+w*d-m*r-y*u-v*d),this[5]=G*(m*e+S*u+C*d-_*e-b*u-T*d),this[6]=G*(y*e+b*r+O*d-x*e-S*r-F*d),this[7]=G*(v*e+T*r+F*u-w*e-C*r-O*u),this[8]=G*(N*a+E*c+V*g-M*a-D*c-B*g),this[9]=G*(M*n+I*c+R*g-N*n-A*c-P*g),this[10]=G*(D*n+A*a+L*g-E*n-I*a-z*g),this[11]=G*(B*n+P*a+z*c-V*n-R*a-L*c),this[12]=G*(D*h+B*f+M*o-V*f-N*o-E*h),this[13]=G*(P*f+N*i+A*h-I*h-R*f-M*i),this[14]=G*(I*o+z*f+E*i-L*f-D*i-A*o),this[15]=G*(L*h+V*i+R*o-P*o-z*h-B*i),this},multLeft:function(e){var t=this[0],i=this[1],n=this[2],r=this[3],s=this[4],o=this[5],a=this[6],u=this[7],l=this[8],h=this[9],c=this[10],d=this[11],p=this[12],f=this[13],g=this[14],m=this[15],_=e[0],x=e[1],y=e[2],v=e[3],w=e[4],b=e[5],S=e[6],C=e[7],T=e[8],F=e[9],O=e[10],N=e[11],M=e[12],D=e[13],E=e[14],V=e[15];return this[0]=t*_+s*x+l*y+p*v,this[1]=i*_+o*x+h*y+f*v,this[2]=n*_+a*x+c*y+g*v,this[3]=r*_+u*x+d*y+m*v,this[4]=t*w+s*b+l*S+p*C,this[5]=i*w+o*b+h*S+f*C,this[6]=n*w+a*b+c*S+g*C,this[7]=r*w+u*b+d*S+m*C,this[8]=t*T+s*F+l*O+p*N,this[9]=i*T+o*F+h*O+f*N,this[10]=n*T+a*F+c*O+g*N,this[11]=r*T+u*F+d*O+m*N,this[12]=t*M+s*D+l*E+p*V,this[13]=i*M+o*D+h*E+f*V,this[14]=n*M+a*D+c*E+g*V,this[15]=r*M+u*D+d*E+m*V,this},multRight:function(e){var t=this[0],i=this[1],n=this[2],r=this[3],s=this[4],o=this[5],a=this[6],u=this[7],l=this[8],h=this[9],c=this[10],d=this[11],p=this[12],f=this[13],g=this[14],m=this[15],_=e[0],x=e[1],y=e[2],v=e[3],w=e[4],b=e[5],S=e[6],C=e[7],T=e[8],F=e[9],O=e[10],N=e[11],M=e[12],D=e[13],E=e[14],V=e[15];return this[0]=t*_+i*w+n*T+r*M,this[1]=t*x+i*b+n*F+r*D,this[2]=t*y+i*S+n*O+r*E,this[3]=t*v+i*C+n*N+r*V,this[4]=s*_+o*w+a*T+u*M,this[5]=s*x+o*b+a*F+u*D,this[6]=s*y+o*S+a*O+u*E,this[7]=s*v+o*C+a*N+u*V,this[8]=l*_+h*w+c*T+d*M,this[9]=l*x+h*b+c*F+d*D,this[10]=l*y+h*S+c*O+d*E,this[11]=l*v+h*C+c*N+d*V,this[12]=p*_+f*w+g*T+m*M,this[13]=p*x+f*b+g*F+m*D,this[14]=p*y+f*S+g*O+m*E,this[15]=p*v+f*C+g*N+m*V,this},multVecMatrix:function(e){if(3===e.length){var t=e.x,i=e.y,n=e.z,r=1/(t*this[3]+i*this[7]+n*this[11]+this[15]);return e.x=(t*this[0]+i*this[4]+n*this[8]+this[12])*r,e.y=(t*this[1]+i*this[5]+n*this[9]+this[13])*r,e.z=(t*this[2]+i*this[6]+n*this[10]+this[14])*r,e}var t=e.x,i=e.y,n=e.z,r=e.w;return e.x=t*this[0]+i*this[4]+n*this[8]+r*this[12],e.y=t*this[1]+i*this[5]+n*this[9]+r*this[13],e.z=t*this[2]+i*this[6]+n*this[10]+r*this[14],e.w=t*this[3]+i*this[7]+n*this[11]+r*this[15],e},multMatrixVec:function(e){if(3===e.length){var t=e.x,i=e.y,n=e.z,r=1/(t*this[12]+i*this[13]+n*this[14]+this[15]);return e.x=(t*this[0]+i*this[1]+n*this[2]+this[3])*r,e.y=(t*this[4]+i*this[5]+n*this[6]+this[7])*r,e.z=(t*this[8]+i*this[9]+n*this[10]+this[11])*r,e}var t=e.x,i=e.y,n=e.z,r=e.w;return e.x=t*this[0]+i*this[1]+n*this[2]+r*this[3],e.y=t*this[4]+i*this[5]+n*this[6]+r*this[7],e.z=t*this[8]+i*this[9]+n*this[10]+r*this[11],e.w=t*this[12]+i*this[13]+n*this[14]+r*this[15],e},multDirMatrix:function(e){var t=e.x,i=e.y,n=e.z;return e.x=t*this[0]+i*this[4]+n*this[8],e.y=t*this[1]+i*this[5]+n*this[9],e.z=t*this[2]+i*this[6]+n*this[10],e},multMatrixDir:function(e){var t=e.x,i=e.y,n=e.z;return e.x=t*this[0]+i*this[1]+n*this[2],e.y=t*this[4]+i*this[5]+n*this[6],e.z=t*this[8]+i*this[9]+n*this[10],e},identity:function(){this[0]=1,this[1]=0,this[2]=0,this[3]=0,this[4]=0,this[5]=1,this[6]=0,this[7]=0,this[8]=0,this[9]=0,this[10]=1,this[11]=0,this[12]=0,this[13]=0,this[14]=0,this[15]=1},translate:function(e){var t=e.x,i=e.y,n=e.z;return this[12]+=this[0]*t+this[4]*i+this[8]*n,this[13]+=this[1]*t+this[5]*i+this[9]*n,this[14]+=this[2]*t+this[6]*i+this[10]*n,this},rotate:function(e){return this.multLeft(_.setQuaternion(e.value)),this},scale:function(e){var t=e.x,i=e.y,n=e.z;return this[0]*=t,this[4]*=i,this[8]*=n,this[1]*=t,this[5]*=i,this[9]*=n,this[2]*=t,this[6]*=i,this[10]*=n,this},getDepth:function(e){var t=e.x,i=e.y,n=e.z,r=1/(t*this[3]+i*this[7]+n*this[11]+this[15])
;return(t*this[2]+i*this[6]+n*this[10]+this[14])*r},toString:function(){return this[0]+" "+this[1]+" "+this[2]+" "+this[3]+" "+this[4]+" "+this[5]+" "+this[6]+" "+this[7]+" "+this[8]+" "+this[9]+" "+this[10]+" "+this[11]+" "+this[12]+" "+this[13]+" "+this[14]+" "+this[15]}},Object.defineProperty(s.prototype,"x",{get:function(){var e=new t(0,0,0,0);return function(){return e.set(this[0],this[1],this[2],this[3])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(s.prototype,"y",{get:function(){var e=new t(0,0,0,0);return function(){return e.set(this[4],this[5],this[6],this[7])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(s.prototype,"z",{get:function(){var e=new t(0,0,0,0);return function(){return e.set(this[8],this[9],this[10],this[11])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(s.prototype,"xAxis",{get:function(){var t=new e(0,0,0);return function(){return t.set(this[0],this[1],this[2])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(s.prototype,"yAxis",{get:function(){var t=new e(0,0,0);return function(){return t.set(this[4],this[5],this[6])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(s.prototype,"zAxis",{get:function(){var t=new e(0,0,0);return function(){return t.set(this[8],this[9],this[10])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(s.prototype,"origin",{get:function(){var t=new e(0,0,0);return function(){return t.set(this[12],this[13],this[14])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(s.prototype,"submatrix",{get:function(){var e=new n;return function(){return e[0]=this[0],e[1]=this[1],e[2]=this[2],e[3]=this[4],e[4]=this[5],e[5]=this[6],e[6]=this[8],e[7]=this[9],e[8]=this[10],e}}(),enumerable:!1,configurable:!1}),Object.assign(s,{Identity:new s,Rotation:function(e){return Object.create(this.prototype).setQuaternion(e.value)},Quaternion:function(e){return Object.create(this.prototype).setQuaternion(e)},Matrix3:function(e){return new s(e[0],e[1],e[2],0,e[3],e[4],e[5],0,e[6],e[7],e[8],0,0,0,0,1)},transpose:function(e){var t=Object.create(this.prototype);return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t},inverse:function(e){var t=Object.create(this.prototype),i=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],u=e[6],l=e[7],h=e[8],c=e[9],d=e[10],p=e[11],f=e[12],g=e[13],m=e[14],_=e[15],x=d*_,y=m*p,v=u*_,w=m*l,b=u*p,S=d*l,C=r*_,T=m*s,F=r*p,O=d*s,N=r*l,M=u*s,D=h*g,E=f*c,V=o*g,B=f*a,I=o*c,A=h*a,P=i*g,R=f*n,L=i*c,z=h*n,k=i*a,X=o*n,U=x*a+w*c+b*g-(y*a+v*c+S*g),j=y*n+C*c+O*g-(x*n+T*c+F*g),G=v*n+T*a+N*g-(w*n+C*a+M*g),q=S*n+F*a+M*c-(b*n+O*a+N*c),H=i*U+o*j+h*G+f*q;if(0==H)throw new Error("Matrix4 .inverse: determinant is 0.");return H=1/H,t[0]=H*U,t[1]=H*j,t[2]=H*G,t[3]=H*q,t[4]=H*(y*o+v*h+S*f-x*o-w*h-b*f),t[5]=H*(x*i+T*h+F*f-y*i-C*h-O*f),t[6]=H*(w*i+C*o+M*f-v*i-T*o-N*f),t[7]=H*(b*i+O*o+N*h-S*i-F*o-M*h),t[8]=H*(D*l+B*p+I*_-E*l-V*p-A*_),t[9]=H*(E*s+P*p+z*_-D*s-R*p-L*_),t[10]=H*(V*s+R*l+k*_-B*s-P*l-X*_),t[11]=H*(A*s+L*l+X*p-I*s-z*l-k*p),t[12]=H*(V*d+A*m+E*u-I*m-D*u-B*d),t[13]=H*(L*m+D*r+R*d-P*d-z*m-E*r),t[14]=H*(P*u+X*m+B*r-k*m-V*r-R*u),t[15]=H*(k*d+I*r+z*u-L*u-X*d-A*r),t},multLeft:function(e,t){var i=Object.create(this.prototype),n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],u=e[5],l=e[6],h=e[7],c=e[8],d=e[9],p=e[10],f=e[11],g=e[12],m=e[13],_=e[14],x=e[15],y=t[0],v=t[1],w=t[2],b=t[3],S=t[4],C=t[5],T=t[6],F=t[7],O=t[8],N=t[9],M=t[10],D=t[11],E=t[12],V=t[13],B=t[14],I=t[15];return i[0]=n*y+a*v+c*w+g*b,i[1]=r*y+u*v+d*w+m*b,i[2]=s*y+l*v+p*w+_*b,i[3]=o*y+h*v+f*w+x*b,i[4]=n*S+a*C+c*T+g*F,i[5]=r*S+u*C+d*T+m*F,i[6]=s*S+l*C+p*T+_*F,i[7]=o*S+h*C+f*T+x*F,i[8]=n*O+a*N+c*M+g*D,i[9]=r*O+u*N+d*M+m*D,i[10]=s*O+l*N+p*M+_*D,i[11]=o*O+h*N+f*M+x*D,i[12]=n*E+a*V+c*B+g*I,i[13]=r*E+u*V+d*B+m*I,i[14]=s*E+l*V+p*B+_*I,i[15]=o*E+h*V+f*B+x*I,i},multRight:function(e,t){var i=Object.create(this.prototype),n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],u=e[5],l=e[6],h=e[7],c=e[8],d=e[9],p=e[10],f=e[11],g=e[12],m=e[13],_=e[14],x=e[15],y=t[0],v=t[1],w=t[2],b=t[3],S=t[4],C=t[5],T=t[6],F=t[7],O=t[8],N=t[9],M=t[10],D=t[11],E=t[12],V=t[13],B=t[14],I=t[15];return i[0]=n*y+r*S+s*O+o*E,i[1]=n*v+r*C+s*N+o*V,i[2]=n*w+r*T+s*M+o*B,i[3]=n*b+r*F+s*D+o*I,i[4]=a*y+u*S+l*O+h*E,i[5]=a*v+u*C+l*N+h*V,i[6]=a*w+u*T+l*M+h*B,i[7]=a*b+u*F+l*D+h*I,i[8]=c*y+d*S+p*O+f*E,i[9]=c*v+d*C+p*N+f*V,i[10]=c*w+d*T+p*M+f*B,i[11]=c*b+d*F+p*D+f*I,i[12]=g*y+m*S+_*O+x*E,i[13]=g*v+m*C+_*N+x*V,i[14]=g*w+m*T+_*M+x*B,i[15]=g*b+m*F+_*D+x*I,i}});var _=new s;return s}),define("x_ite/Fields/SFMatrix4",["x_ite/Basic/X3DField","x_ite/Fields/SFMatrixPrototypeTemplate","x_ite/Fields/SFVec3","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r){"use strict";function s(i,n,s){function o(t,i,n,s,o,a,u,l,h,c,d,p,f,g,m,_){return arguments.length?arguments[0]instanceof r?e.call(this,arguments[0]):e.call(this,new r(+t,+i,+n,+s,+o,+a,+u,+l,+h,+c,+d,+p,+f,+g,+m,+_)):e.call(this,new r)}o.prototype=Object.assign(Object.create(e.prototype),t(r,s),{constructor:o,getTypeName:function(){return i},getType:function(){return n}});for(var a=0;a<r.prototype.length;++a)!function(e){Object.defineProperty(o.prototype,e,{get:function(){return this.getValue()[e]},set:function(t){this.getValue()[e]=t,this.addEvent()},enumerable:!1,configurable:!1})}(a);return o}return{SFMatrix4d:s("SFMatrix4d",n.SFMatrix4d,i.SFVec3d),SFMatrix4f:s("SFMatrix4f",n.SFMatrix4f,i.SFVec3f),VrmlMatrix:s("VrmlMatrix",n.VrmlMatrix,i.SFVec3f)}}),define("x_ite/Fields/SFNode",["x_ite/Basic/X3DField","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(e,t,i){"use strict";function n(t){return this instanceof n?(t?(t.addParent(this),e.call(this,t)):e.call(this,null),new Proxy(this,r)):n.call(Object.create(n.prototype),t)}var r={get:function(e,i){try{var n=e[i];if(void 0!==n)return n;var r=e.getValue().getField(i);if(r.getAccessType()===t.inputOnly)return;return r.valueOf()}catch(e){return}},set:function(e,i,n){if(i in e)return e[i]=n,!0;try{var r=e.getValue().getField(i);return r.getAccessType()!==t.outputOnly&&r.setValue(n),!0}catch(t){return console.error(e,i,t),!1}}};return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,_cloneCount:0,clone:function(){return new n(this.getValue())},copy:function(e){var t=this.getValue();return t?new n(t.copy(e)):new n},getTypeName:function(){return"SFNode"},getType:function(){return t.SFNode},equals:function(e){return e?this.getValue()===e.getValue():null===this.getValue()},isDefaultValue:function(){return null===this.getValue()},set:function(t){var i=this.getValue();i&&(i.removeClones(this._cloneCount),i.removeParent(this)),t?(t.addParent(this),t.addClones(this._cloneCount),e.prototype.set.call(this,t)):e.prototype.set.call(this,null)},getNodeTypeName:function(){var e=this.getValue();if(e)return e.getTypeName();throw new Error("SFNode.getNodeTypeName: node is null.")},getNodeName:function(){var e=this.getValue();if(e)return e.getName();throw new Error("SFNode.getNodeName: node is null.")},getNodeType:function(){var e=this.getValue();if(e)return e.getType().slice();throw new Error("SFNode.getNodeType: node is null.")},getFieldDefinitions:function(){var e=this.getValue();if(e)return e.getFieldDefinitions();throw new Error("SFNode.getFieldDefinitions: node is null.")},addClones:function(e){var t=this.getValue();this._cloneCount+=e,t&&t.addClones(e)},removeClones:function(e){var t=this.getValue();this._cloneCount-=e,t&&t.removeClones(e)},valueOf:function(){return this.getValue()?this:null},toStream:function(e){var t=this.getValue();t?t.toStream(e):e.string+="NULL"},toVRMLString:function(){},toVRMLStream:function(e){var t=this.getValue();t?t.toVRMLStream(e):e.string+="NULL"},toXMLString:function(){var e={string:""},t=i.Get(e),n=this.getValue();return t.PushExecutionContext(n.getExecutionContext()),this.toXMLStream(e),t.PopExecutionContext(),e.string},toXMLStream:function(e){var t=this.getValue();t?t.toXMLStream(e):e.string+="NULL"},dispose:function(){this.set(null),e.prototype.dispose.call(this)}}),n}),define("x_ite/Fields/SFRotation",["x_ite/Fields/SFVec3","x_ite/Basic/X3DField","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator","standard/Math/Numbers/Rotation4"],function(e,t,i,n,r){"use strict";function s(e,i,n,a){if(this instanceof s)switch(arguments.length){case 1:return t.call(this,arguments[0]);case 2:return arguments[1]instanceof o?t.call(this,new r(arguments[0].getValue(),arguments[1].getValue())):t.call(this,new r(arguments[0].getValue(),+arguments[1]));case 4:return t.call(this,new r(+e,+i,+n,+a));default:return t.call(this,new r)}return s.apply(Object.create(s.prototype),arguments)}var o=e.SFVec3f;s.prototype=Object.assign(Object.create(t.prototype),{constructor:s,copy:function(){return new s(this.getValue().copy())},equals:function(e){return this.getValue().equals(e.getValue())},isDefaultValue:function(){return this.getValue().equals(r.Identity)},getTypeName:function(){return"SFRotation"},getType:function(){return i.SFRotation},set:function(e){this.getValue().assign(e)},setAxis:function(e){this.getValue().setAxis(e.getValue()),this.addEvent()},getAxis:function(){return new o(this.getValue().getAxis().copy())},inverse:function(){return new s(r.inverse(this.getValue()))},multiply:function(e){return new s(r.multRight(this.getValue(),e.getValue()))},multVec:function(e){return new o(this.getValue().multVecRot(e.getValue().copy()))},slerp:function(e,t){return new s(r.slerp(this.getValue(),e.getValue(),t))},toStream:function(e){var t=n.Get(e),i=this.getValue();e.string+=i.x+" "+i.y+" "+i.z+" "+t.ToUnit("angle",i.angle)},toXMLStream:function(e){this.toStream(e)}});var a={get:function(){return this.getValue().x},set:function(e){this.getValue().x=e,this.addEvent()},enumerable:!0,configurable:!1},u={get:function(){return this.getValue().y},set:function(e){this.getValue().y=e,this.addEvent()},enumerable:!0,configurable:!1},l={get:function(){return this.getValue().z},set:function(e){this.getValue().z=e,this.addEvent()},enumerable:!0,configurable:!1},h={get:function(){return this.getValue().angle},set:function(e){this.getValue().angle=e,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(s.prototype,"x",a),Object.defineProperty(s.prototype,"y",u),Object.defineProperty(s.prototype,"z",l),Object.defineProperty(s.prototype,"angle",h),a.enumerable=!1,u.enumerable=!1,l.enumerable=!1,h.enumerable=!1,Object.defineProperty(s.prototype,"0",a),Object.defineProperty(s.prototype,"1",u),Object.defineProperty(s.prototype,"2",l),Object.defineProperty(s.prototype,"3",h),s}),define("x_ite/Fields/SFString",["x_ite/Basic/X3DField","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(e,t,i){"use strict";function n(t){return this instanceof n?e.call(this,arguments.length?String(t):""):e.call(Object.create(n.prototype),arguments.length?String(t):"")}return Object.assign(n,{unescape:function(e){return e.replace(/\\([\\"])/g,"$1")},escape:function(e){return e.replace(/([\\"])/g,"\\$1")}}),n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,copy:function(){return new n(this.getValue())},getTypeName:function(){return"SFString"},getType:function(){return t.SFString},isDefaultValue:function(){return""===this.getValue()},set:function(t){e.prototype.set.call(this,String(t))},valueOf:e.prototype.getValue,toStream:function(e){e.string+='"'+n.escape(this.getValue())+'"'},toXMLStream:function(e){e.string+=i.Get(e).XMLEncode(this.getValue())}}),Object.defineProperty(n.prototype,"length",{get:function(){return this.getValue().length},enumerable:!0,configurable:!1}),n}),define("x_ite/Fields/SFTime",["x_ite/Basic/X3DField","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function i(t){return this instanceof i?e.call(this,arguments.length?+t:0):e.call(Object.create(i.prototype),arguments.length?+t:0)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,copy:function(){return new i(this.getValue())},getTypeName:function(){return"SFTime"},getType:function(){return t.SFTime},isDefaultValue:function(){return 0===this.getValue()},set:function(t){e.prototype.set.call(this,+t)},valueOf:e.prototype.getValue,toStream:function(e){e.string+=String(this.getValue())},toXMLStream:function(e){this.toStream(e)}}),i}),define("x_ite/Fields/SFVec4",["x_ite/Basic/X3DField","x_ite/Fields/SFVecPrototypeTemplate","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector4"],function(e,t,i,n){"use strict";function r(i,r){function s(t,i,r,s){return arguments.length?arguments[0]instanceof n?e.call(this,arguments[0]):e.call(this,new n(+t,+i,+r,+s)):e.call(this,new n(0,0,0,0))}s.prototype=Object.assign(Object.create(e.prototype),t(n),{constructor:s,getTypeName:function(){return i},getType:function(){return r}});var o={get:function(){return this.getValue().x},set:function(e){this.getValue().x=e,this.addEvent()},enumerable:!0,configurable:!1},a={get:function(){return this.getValue().y},set:function(e){this.getValue().y=e,this.addEvent()},enumerable:!0,configurable:!1},u={get:function(){return this.getValue().z},set:function(e){this.getValue().z=e,this.addEvent()},enumerable:!0,configurable:!1},l={get:function(){return this.getValue().w},set:function(e){this.getValue().w=e,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(s.prototype,"x",o),Object.defineProperty(s.prototype,"y",a),Object.defineProperty(s.prototype,"z",u),Object.defineProperty(s.prototype,"w",l),o.enumerable=!1,a.enumerable=!1,u.enumerable=!1,l.enumerable=!1,Object.defineProperty(s.prototype,"0",o),Object.defineProperty(s.prototype,"1",a),Object.defineProperty(s.prototype,"2",u),Object.defineProperty(s.prototype,"3",l),s}return{SFVec4d:r("SFVec4d",i.SFVec4d),SFVec4f:r("SFVec4f",i.SFVec4f)}}),define("x_ite/Basic/X3DObjectArrayField",["jquery","x_ite/Basic/X3DField","x_ite/Basic/X3DArrayField","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(e,t,i,n,r){"use strict";function s(e){return i.call(this,[]),this._target=this,e[0]instanceof Array&&(e=e[0]),s.prototype.push.apply(this,e),new Proxy(this,o)}var o={get:function(e,t){try{var i=Number(t);if(Number.isInteger(i)){var n=e.getValue();return i>=n.length&&e.resize(i+1),n[i].valueOf()}return e[t]}catch(i){if("symbol"==typeof t)return;console.log(e,typeof t,t,i)}},set:function(e,t,i){try{if(t in e)return e[t]=i,!0;var n=e.getValue(),r=parseInt(t);return r>=n.length&&e.resize(r+1),n[r].setValue(i),!0}catch(i){return console.log(e,t,i),!1}},has:function(e,t){return t in e.getValue()},enumerate:function(e){return Object.keys(e.getValue())[Symbol.iterator]()}};return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,getTarget:function(){return this._target},copy:function(){var e=this._target,t=new e.constructor,i=e.getValue();return s.prototype.push.apply(t,i),t},equals:function(e){var t=this._target,i=t.getValue(),n=e.getValue(),r=i.length;if(i===n)return!0;if(r!==n.length)return!1;for(var s=0;s<r;++s)if(!i[s].equals(n[s]))return!1;return!0},set:function(e){var i=this._target;i.resize(e.length,void 0,!0);for(var n=i.getValue(),r=0,s=e.length;r<s;++r)n[r].set(e[r]instanceof t?e[r].getValue():e[r])},isDefaultValue:function(){return 0===this.length},setValue:function(e){var t=this._target;t.set(e instanceof s?e.getValue():e),t.addEvent()},unshift:function(e){for(var t=this._target,i=t.getValue(),n=arguments.length-1;n>=0;--n){var r=new(t.getSingleType());r.setValue(arguments[n]),t.addChildObject(r),i.unshift(r)}return t.addEvent(),i.length},shift:function(){var e=this._target,t=e.getValue();if(t.length){var i=t.shift();return e.removeChildObject(i),e.addEvent(),i.valueOf()}},push:function(e){for(var t=this._target,i=t.getValue(),n=0,r=arguments.length;n<r;++n){var s=new(t.getSingleType());s.setValue(arguments[n]),t.addChildObject(s),i.push(s)}return t.addEvent(),i.length},pop:function(){var e=this._target,t=e.getValue();if(t.length){var i=t.pop();return e.removeChildObject(i),e.addEvent(),i.valueOf()}},splice:function(e,t){var i=this._target,n=i.getValue();e>n.length&&(e=n.length),e+t>n.length&&(t=n.length-e);var r=i.erase(e,e+t);return arguments.length>2&&i.insert(e,arguments,2,arguments.length),r},insert:function(e,t,i,n){for(var r=this._target,s=[e,0],o=i;o<n;++o){var a=new(r.getSingleType());a.setValue(t[o]),r.addChildObject(a),s.push(a)}Array.prototype.splice.apply(r.getValue(),s),r.addEvent()},find:function(t,i,n){var r=this._target;if(e.isFunction(n)){for(var s=r.getValue(),o=t;o<i;++o)if(n(s[o].valueOf()))return o;return i}for(var s=r.getValue(),o=t;o<i;++o)if(s[o].equals(n))return o;return i},remove:function(t,i,n){var r=this._target;if(e.isFunction(n)){var s=r.getValue();if((t=r.find(t,i,n))!==i)for(var o=t;++o<i;){var a=s[o];if(!n(a.valueOf())){var u=s[t];s[t++]=a,s[o]=u}}return t!==i&&r.addEvent(),t}var s=r.getValue();if((t=r.find(t,i,n))!==i)for(var o=t;++o<i;){var a=s[o];if(!a.equals(n)){var u=s[t];s[t++]=a,s[o]=u}}return t!==i&&r.addEvent(),t},erase:function(e,t){for(var i=this._target,n=i.getValue().splice(e,t-e),r=0,s=n.length;r<s;++r)i.removeChildObject(n[r]);return i.addEvent(),new i.constructor(n)},resize:function(e,t,i){var n=this._target,r=n.getValue();if(e<r.length){for(var s=e,o=r.length;s<o;++s)n.removeChildObject(r[s]);r.length=e,i||n.addEvent()}else if(e>r.length){for(var s=r.length;s<e;++s){var a=new(n.getSingleType());void 0!==t&&a.setValue(t),n.addChildObject(a),r.push(a)}i||n.addEvent()}},addChildObject:function(e){e.addParent(this._target)},removeChildObject:function(e){e.removeParent(this._target)},toStream:function(e){var t=this._target,i=t.getValue(),n=r.Get(e);switch(i.length){case 0:e.string+="[ ]";break;case 1:n.PushUnitCategory(t.getUnit()),i[0].toStream(e),n.PopUnitCategory();break;default:n.PushUnitCategory(t.getUnit()),e.string+="[\n",n.IncIndent();for(var s=0,o=i.length-1;s<o;++s)e.string+=n.Indent(),i[s].toStream(e),e.string+=",\n";e.string+=n.Indent(),i[o].toStream(e),e.string+="\n",n.DecIndent(),e.string+=n.Indent(),e.string+="]",n.PopUnitCategory()}},toXMLStream:function(e){var t=this._target,i=t.length;if(i){var n=r.Get(e),s=t.getValue();n.PushUnitCategory(t.getUnit());for(var o=0,a=i-1;o<a;++o)s[o].toXMLStream(e),e.string+=", ";s[a].toXMLStream(e),n.PopUnitCategory()}},dispose:function(){for(var e=this._target,t=e.getValue(),n=0,r=e.length;n<r;++n)e.removeChildObject(t[n]);t.length=0,i.prototype.dispose.call(e)}}),Object.defineProperty(s.prototype,"length",{get:function(){return this._target.getValue().length},set:function(e){this._target.resize(e)},enumerable:!1,configurable:!1}),s}),define("x_ite/Basic/X3DTypedArrayField",["x_ite/Basic/X3DArrayField","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator","standard/Math/Algorithm"],function(e,t,i,n){"use strict";function r(t){return e.call(this,new(this.getArrayType())(2)),this._target=this,this._tmp=[],t[0]instanceof Array&&(t=t[0]),r.prototype.push.apply(this,t),new Proxy(this,a)}function s(e,t,i,n){for(var r=e.getValue(),s=e._tmp,o=0;o<n;++o,++t)s[o]=r[t];return i.set.apply(i,s),i}function o(e,t,i,n){for(var r=e.getValue(),s=0;s<n;++s,++t)r[t]=i[s];e.addEvent()}var a={get:function(e,t){try{var i=Number(t);if(Number.isInteger(i)){var n=e.getValue(),r=e.getComponents(),a=e.getValueType();if(i>=e._length&&(n=e.resize(i+1)),1===r)return a(n[i]);var u=new a,l=u.getValue(),h=i*r;return u.addEvent=function(){return o(e,h,l,r)},u.getValue=function(){return s(e,h,l,r)},u}return e[t]}catch(i){if("symbol"==typeof t)return;console.log(e,typeof t,t,i)}},set:function(e,t,i){try{if(t in e)return e[t]=i,!0;var n=parseInt(t),r=e.getValue(),s=e.getComponents();if(n>=e._length&&(r=e.resize(n+1)),1===s)r[n]=i;else{n*=s;for(var o=0;o<s;++o,++n)r[n]=i[o]}return e.addEvent(),!0}catch(i){return console.log(e,t,i),!1}},has:function(e,t){return t in e.getValue()},enumerate:function(e){return Object.keys(e.getValue())[Symbol.iterator]()}};return r.prototype=Object.assign(Object.create(e.prototype),{constructor:r,_length:0,getTarget:function(){return this._target},copy:function(){var t=this._target,i=t.getValue(),n=new t.constructor,r=new(t.getArrayType())(i);return n._length=t._length,e.prototype.set.call(n,r,t._length),n},equals:function(e){if(this===e)return!0;var t=this._target,i=t._length;if(i!==e._length)return!1;for(var n=t.getValue(),r=e.getValue(),s=0,o=i*t.getComponents();s<o;++s)if(n[s]!==r[s])return!1;return!0},assign:function(e){var t=this._target;t.set(e.getValue(),e.length),t.addEvent()},set:function(e,t){var i=this._target,n=i.getComponents(),r=i.getValue(),s=i._length,o=void 0!==t?t*n:e.length,a=o%n;a&&(o-=a,console.warn("Array length must be multiple of components size, which is "+n+".")),o/=n,r.length<e.length?(r=i.grow(e.length),r.set(e),a&&r.fill(0,o*n,o*n+a)):(r.set(e),o<s&&r.fill(0,o*n,s*n)),i._length=o},isDefaultValue:function(){return 0===this._length},setValue:function(e){var t=this._target;e instanceof t.constructor?t.assign(e):(t.set(e),t.addEvent())},unshift:function(e){var t=this._target,i=t.getComponents(),n=t._length,r=arguments.length,s=t.grow((n+r)*i);if(s.copyWithin(r*i,0,n*i),1===i)s.set(arguments,0);else for(var o=0,a=0;a<r;++a)for(var u=arguments[a],l=0;l<i;++l,++o)s[o]=u[l];return t._length+=r,t.addEvent(),s.length},shift:function(){var e=this._target,t=e.getValue();if(t.length){var i=e.getComponents(),n=e.getValueType(),r=e._length,s=r-1;if(1===i)var o=n(t[0]);else{for(var a=e._tmp,u=0;u<i;++u)a[u]=t[u];var o=Object.create(n.prototype);n.apply(o,a)}return t.copyWithin(0,i,r*i),t.fill(0,i*s,r*i),e._length=s,e.addEvent(),o}},push:function(e){var t=this._target,i=t.getComponents(),n=t._length,r=arguments.length,s=t.grow((n+r)*i);if(1===i)s.set(arguments,n);else for(var o=n*i,a=0;a<r;++a)for(var u=arguments[a],l=0;l<i;++l,++o)s[o]=u[l];return t._length+=r,t.addEvent(),t._length},pop:function(){var e=this._target,t=e.getValue();if(t.length){var i=e.getComponents(),n=e.getValueType(),r=e._length,s=r-1;if(1===i)var o=n(t[r-1]);else{for(var a=e._tmp,u=0,l=s*i;u<i;++u,++l)a[u]=t[l];var o=Object.create(n.prototype);n.apply(o,a)}return t.fill(0,s*i,r*i),e._length=s,e.addEvent(),o}},splice:function(e,t){var i=this._target,n=i._length;e>n&&(e=n),e+t>n&&(t=n-e);var r=i.erase(e,e+t);return arguments.length>2&&i.spliceInsert(e,Array.prototype.splice.call(arguments,2)),i.addEvent(),r},spliceInsert:function(e,t){var i=this._target,n=i.getComponents(),r=i._length,s=t.length;e*=n;var o=i.grow((r+s)*n);if(o.copyWithin(e+s*n,e,r*n),1===n)o.set(t,e);else for(var a=0,u=e;a<s;++a)for(var l=t[a],h=0;h<n;++h,++u)o[u]=l[h];i._length+=s},insert:function(e,t,i,n){var r=this._target,s=r._length,o=t.getValue(),a=r.getComponents(),u=n-i;e*=a,i*=a,n*=a;var l=r.grow((s+u)*a);for(l.copyWithin(e+u*a,e,s*a);i<n;++e,++i)l[e]=o[i];r._length+=u,r.addEvent()},erase:function(e,t){var i=this._target,n=i.getValue(),r=i.getComponents(),s=t-e,o=i._length,a=o-s,u=new i.constructor;e*=r,t*=r;for(var l=u.grow(s*r),h=0,c=e;c<t;++h,++c)l[h]=n[c];return n.copyWithin(e,t,o*r),n.fill(0,a*r,o*r),i._length=a,u._length=s,i.addEvent(),u},resize:function(e,t,i){var n=this._target,r=n._length,s=n.getValue(),o=n.getComponents();if(e<r)s.fill(0,e*o,r*o),i||n.addEvent();else if(e>r){if(s=n.grow(e*o),void 0!==t)if(1===o)s.fill(t,r*o,e*o);else for(var a=r*o,u=e*o;a<u;)for(var l=0;l<o;++l,++a)s[a]=t[l];i||n.addEvent()}return n._length=e,s},grow:function(t){var i=this._target,r=i.getValue();if(t<r.length)return r;var s=n.nextPowerOfTwo(t),o=new(i.getArrayType())(s);return o.set(r),e.prototype.set.call(i,o),o},shrinkToFit:function(){var t=this._target,i=t.getValue(),n=t._length*t.getComponents();if(i.length==n)return i;var r=i.subarray(0,n);return e.prototype.set.call(t,r),r},toStream:function(e){var t=this._target,n=i.Get(e),r=t.getValue(),s=t._length,o=t.getComponents(),a=new(t.getSingleType());switch(s){case 0:e.string+="[ ]";break;case 1:if(n.PushUnitCategory(t.getUnit()),1===o)a.set(r[0]),a.toStream(e);else{for(var u=0,l=0;u<o;++u,++l)a[u]=r[l];a.toStream(e)}n.PopUnitCategory();break;default:if(n.PushUnitCategory(t.getUnit()),e.string+="[\n",n.IncIndent(),1===o){for(var h=0,c=s-1;h<c;++h)e.string+=n.Indent(),a.set(r[h*o]),a.toStream(e),e.string+=",\n";e.string+=n.Indent(),a.set(r[c*o]),a.toStream(e),e.string+="\n"}else{for(var h=0,c=s-1;h<c;++h){e.string+=n.Indent();for(var u=0,l=h*o;u<o;++u,++l)a[u]=r[l];a.toStream(e),e.string+=",\n"}e.string+=n.Indent();for(var u=0,l=c*o;u<o;++u,++l)a[u]=r[l];a.toStream(e),e.string+="\n"}n.DecIndent(),e.string+=n.Indent(),e.string+="]",n.PopUnitCategory()}},toXMLStream:function(e){var t=this._target,n=t._length;if(n){var r=i.Get(e),s=t.getValue(),o=t.getComponents(),a=new(t.getSingleType());if(r.PushUnitCategory(t.getUnit()),1===o){for(var u=0,l=n-1;u<l;++u)a.set(s[u*o]),a.toXMLStream(e),e.string+=", ";a.set(s[l*o]),a.toXMLStream(e)}else{for(var u=0,l=n-1;u<l;++u){for(var h=0,c=u*o;h<o;++h,++c)a[h]=s[c];a.toXMLStream(e),e.string+=", "}for(var h=0,c=l*o;h<o;++h,++c)a[h]=s[c];a.toXMLStream(e)}r.PopUnitCategory()}},dispose:function(){e.prototype.dispose.call(this._target)}}),Object.defineProperty(r.prototype,"length",{get:function(){return this._length},set:function(e){this._target.resize(e)},enumerable:!1,configurable:!1}),r}),define("x_ite/Fields/ArrayFields",["x_ite/Fields/SFBool","x_ite/Fields/SFColor","x_ite/Fields/SFColorRGBA","x_ite/Fields/SFDouble","x_ite/Fields/SFFloat","x_ite/Fields/SFImage","x_ite/Fields/SFInt32","x_ite/Fields/SFMatrix3","x_ite/Fields/SFMatrix4","x_ite/Fields/SFNode","x_ite/Fields/SFRotation","x_ite/Fields/SFString","x_ite/Fields/SFTime","x_ite/Fields/SFVec2","x_ite/Fields/SFVec3","x_ite/Fields/SFVec4","x_ite/Basic/X3DObjectArrayField","x_ite/Basic/X3DTypedArrayField","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(e,t,i,n,r,s,o,a,u,l,h,c,d,p,f,g,m,_,x,y){"use strict";function v(e){return this instanceof v?m.call(this,arguments):m.call(Object.create(v.prototype),arguments)}function w(e){return this instanceof w?m.call(this,arguments):m.call(Object.create(w.prototype),arguments)}function b(e,t,i,n,r,s){function o(e){return this instanceof o?_.call(this,arguments):_.call(Object.create(o.prototype),arguments)}return o.prototype=Object.assign(Object.create(_.prototype),{constructor:o,getSingleType:function(){return i},getValueType:function(){return n},getArrayType:function(){return r},getComponents:function(){return s},getTypeName:function(){return e},getType:function(){return t}}),o}var S=a.SFMatrix3d,C=a.SFMatrix3f,T=u.SFMatrix4d,F=u.SFMatrix4f,O=p.SFVec2d,N=p.SFVec2f,M=f.SFVec3d,D=f.SFVec3f,E=g.SFVec4d,V=g.SFVec4f;v.prototype=Object.assign(Object.create(m.prototype),{constructor:v,_cloneCount:0,getSingleType:function(){return l},getValueType:function(){return l},getArrayType:function(){return Array},getComponents:function(){return 1},getTypeName:function(){return"MFNode"},getType:function(){return x.MFNode},clone:function(){var e=new v;return e.setValue(this),e},copy:function(e){for(var t=new v,i=this.getValue(),n=0,r=i.length;n<r;++n)t.push(i[n].copy(e));return t},addClones:function(e){var t=this.getValue();this._cloneCount+=e;for(var i=0,n=t.length;i<n;++i)t[i].addClones(e)},removeClones:function(e){var t=this.getValue();this._cloneCount+=e;for(var i=0,n=t.length;i<n;++i)t[i].removeClones(e)},addChildObject:function(e){m.prototype.addChildObject.call(this,e),e.addClones(this._cloneCount)},removeChildObject:function(e){m.prototype.removeChildObject.call(this,e),e.removeClones(this._cloneCount)},toXMLStream:function(e){var t=y.Get(e),i=this.length;if(i){t.EnterScope();for(var n=this.getValue(),r=0,s=i-1;r<s;++r){var o=n[r].getValue();o?(o.toXMLStream(e),e.string+="\n"):(e.string+=t.Indent(),e.string+="<!-- NULL -->\n")}var o=n[s].getValue();o?o.toXMLStream(e):(e.string+=t.Indent(),e.string+="<!-- NULL -->"),t.LeaveScope()}}}),w.prototype=Object.assign(Object.create(m.prototype),{constructor:w,getValueType:function(){return String},getSingleType:function(){return c},getArrayType:function(){return Array},getComponents:function(){return 1},getTypeName:function(){return"MFString"},getType:function(){return x.MFString},toXMLStream:function(e){var t=this.length;if(t){for(var i=this.getValue(),n=0,r=t-1;n<r;++n)e.string+='"',i[n].toXMLStream(e),e.string+='"',e.string+=", ";e.string+='"',i[r].toXMLStream(e),e.string+='"'}}});var B={MFBool:b("MFBool",x.MFBool,e,Boolean,Uint8Array,1),MFColor:b("MFColor",x.MFColor,t,t,Float32Array,3),MFColorRGBA:b("MFColorRGBA",x.MFColorRGBA,i,i,Float32Array,4),MFDouble:b("MFDouble",x.MFDouble,n,Number,Float64Array,1),MFFloat:b("MFFloat",x.MFFloat,r,Number,Float32Array,1),MFImage:function(e,t,i,n,r,s){function o(e){return this instanceof o?m.call(this,arguments):m.call(Object.create(o.prototype),arguments)}return o.prototype=Object.assign(Object.create(m.prototype),{constructor:o,getSingleType:function(){return i},getValueType:function(){return n},getArrayType:function(){return r},getComponents:function(){return s},getTypeName:function(){return e},getType:function(){return t}}),o}("MFImage",x.MFImage,s,s,Array,1),MFInt32:b("MFInt32",x.MFInt32,o,Number,Int32Array,1),MFMatrix3d:b("MFMatrix3d",x.MFMatrix3d,S,S,Float64Array,9),MFMatrix3f:b("MFMatrix3f",x.MFMatrix3f,C,C,Float32Array,9),MFMatrix4d:b("MFMatrix4d",x.MFMatrix4d,T,T,Float64Array,16),MFMatrix4f:b("MFMatrix4f",x.MFMatrix4f,F,F,Float32Array,16),MFNode:v,MFRotation:b("MFRotation",x.MFRotation,h,h,Float64Array,4),MFString:w,MFTime:b("MFTime",x.MFTime,d,Number,Float64Array,1),MFVec2d:b("MFVec2d",x.MFVec2d,O,O,Float64Array,2),MFVec2f:b("MFVec2f",x.MFVec2f,N,N,Float32Array,2),MFVec3d:b("MFVec3d",x.MFVec3d,M,M,Float64Array,3),MFVec3f:b("MFVec3f",x.MFVec3f,D,D,Float32Array,3),MFVec4d:b("MFVec4d",x.MFVec4d,E,E,Float64Array,4),MFVec4f:b("MFVec4f",x.MFVec4f,V,V,Float32Array,4)};return Object.preventExtensions(B),Object.freeze(B),Object.seal(B),B}),define("x_ite/Fields",["x_ite/Fields/SFBool","x_ite/Fields/SFColor","x_ite/Fields/SFColorRGBA","x_ite/Fields/SFDouble","x_ite/Fields/SFFloat","x_ite/Fields/SFImage","x_ite/Fields/SFInt32","x_ite/Fields/SFMatrix3","x_ite/Fields/SFMatrix4","x_ite/Fields/SFNode","x_ite/Fields/SFRotation","x_ite/Fields/SFString","x_ite/Fields/SFTime","x_ite/Fields/SFVec2","x_ite/Fields/SFVec3","x_ite/Fields/SFVec4","x_ite/Fields/ArrayFields"],function(e,t,i,n,r,s,o,a,u,l,h,c,d,p,f,g,m){"use strict";var _=Object.assign({SFBool:e,SFColor:t,SFColorRGBA:i,SFDouble:n,SFFloat:r,SFImage:s,SFInt32:o,SFMatrix3d:a.SFMatrix3d,SFMatrix3f:a.SFMatrix3f,SFMatrix4d:u.SFMatrix4d,SFMatrix4f:u.SFMatrix4f,SFNode:l,SFRotation:h,SFString:c,SFTime:d,SFVec2d:p.SFVec2d,SFVec2f:p.SFVec2f,SFVec3d:f.SFVec3d,SFVec3f:f.SFVec3f,SFVec4d:g.SFVec4d,SFVec4f:g.SFVec4f,VrmlMatrix:u.VrmlMatrix},m);return Object.preventExtensions(_),Object.freeze(_),Object.seal(_),_}),define("x_ite/Browser/VERSION",[],function(){return"4.2.14a"}),define("x_ite/Base/X3DEventObject",["x_ite/Base/X3DChildObject","x_ite/Base/Events"],function(e,t){"use strict";function i(t){e.call(this),this._browser=t}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,getBrowser:function(){return this._browser},getExtendedEventHandling:function(){return!0},addEvent:function(e){e.setSet(!0),e.getTainted()||(e.setTainted(!0),this.addEventObject(e,t.create(e)))},addEventObject:function(e,t){var i=this.getBrowser();e.setSet(!0),i.addBrowserEvent(),i.addTaintedField(e,t),this.getTainted()||(e.isInput()||this.getExtendedEventHandling()&&!e.isOutput())&&(this.setTainted(!0),i.addTaintedNode(this))},addNodeEvent:function(){if(!this.getTainted()){var e=this.getBrowser();this.setTainted(!0),e.addTaintedNode(this),e.addBrowserEvent()}},processEvents:function(){this.setTainted(!1),this.processInterests()}}),i}),define("x_ite/Basic/X3DBaseNode",["x_ite/Base/X3DEventObject","x_ite/Base/Events","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Fields","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(e,t,i,n,r,s,o){"use strict";function a(){return this.isLive_}function u(t){
if(!this.hasOwnProperty("_executionContext")){e.call(this,t.getBrowser()),this._executionContext=t,this._type=[s.X3DBaseNode],this._fields=new Map,this._predefinedFields=new Map,this._userDefinedFields=new Map,this._cloneCount=0,this.hasUserDefinedFields()&&(this.fieldDefinitions=new n(this.fieldDefinitions.getValue().slice()));for(var i=this.fieldDefinitions.getValue(),r=0,o=i.length;r<o;++r)this.addField(i[r])}}return u.prototype=Object.assign(Object.create(e.prototype),{constructor:u,fieldDefinitions:new n([]),_private:!1,_live:!0,_initialized:!1,setExecutionContext:function(e){this._executionContext=e},getExecutionContext:function(){return this._executionContext},getScene:function(){for(var e=this._executionContext;!e.isRootContext();)e=e.getExecutionContext();return e},getMasterScene:function(){for(var e=this._executionContext.getScene();!e.isMasterContext();)e=e.getScene();return e},addType:function(e){this._type.push(e)},getType:function(){return this._type},getInnerNode:function(){return this},isLive:function(){return this.isLive=a,this.addChildObjects("isLive",new r.SFBool(this.getLiveState())),this.isLive_.removeParent(this),this._executionContext!==this&&this._executionContext.isLive().addInterest("_set_live__",this),this.isLive()},setLive:function(e){this._live=e.valueOf(),this._set_live__()},getLive:function(){return this._live},getLiveState:function(){return this!==this._executionContext?this.getLive()&&this._executionContext.isLive().getValue():this.getLive()},_set_live__:function(){var e=this.getLiveState(),i=this.isLive();if(e){if(i.getValue())return;i.setValue(!0),i.processEvent(t.create(i))}else i.getValue()&&(i.setValue(!1),i.processEvent(t.create(i)))},setInitialized:function(e){this._initialized=e},isInitialized:function(){return this._initialized},setup:function(){if(!this._initialized){this._initialized=!0;for(var e=this.fieldDefinitions.getValue(),t=0,i=e.length;t<i;++t){var n=this._fields.get(e[t].name);n.updateReferences(),n.setTainted(!1)}this.initialize()}},initialize:function(){},eventsProcessed:function(){},create:function(e){return new this.constructor(e)},copy:function(e){var t=this.getName();if(t.length)try{return e.getNamedNode(t).getValue()}catch(e){}else(function(e){return e.getCloneCount()>1||!!e.hasRoutes()})(this)&&this.getExecutionContext().updateNamedNode(this.getExecutionContext().getUniqueName(t),this);var i=this.create(e);t.length&&e.updateNamedNode(t,i);var n=this.getPredefinedFields();for(var r of n.values())try{var o=i.getField(r.getName());if(o.setSet(r.getSet()),r.hasReferences()){var a=r.getReferences();for(var u of a.values())try{o.addReference(e.getField(u.getName()))}catch(e){console.error(e.message)}}else if(r.getAccessType()&s.initializeOnly)switch(r.getType()){case s.SFNode:case s.MFNode:o.setValue(r.copy(e));break;default:o.setValue(r)}}catch(e){console.log(e.message)}var l=this.getUserDefinedFields();for(var r of l.values()){var o=r.copy(e);if(i.addUserDefinedField(r.getAccessType(),r.getName(),o),o.setSet(r.getSet()),r.hasReferences()){var a=r.getReferences();for(var u of a.values())try{o.addReference(e.getField(u.getName()))}catch(t){console.error("No reference '"+u.getName()+"' inside execution context "+e.getTypeName()+" '"+e.getName()+"'.")}}}return e.addUninitializedNode(i),i},addChildObjects:function(e,t){for(var i=0,n=arguments.length;i<n;i+=2)this.addChildObject(arguments[i],arguments[i+1])},addChildObject:function(e,t){t.addParent(this),t.setName(e),Object.defineProperty(this,e+"_",{get:function(){return t},set:function(e){t.setValue(e)},enumerable:!0,configurable:!1})},addField:function(e){var t=e.accessType,i=e.name,n=e.value.clone();n.setTainted(!0),n.addParent(this),n.setName(i),n.setAccessType(t),this.setField(i,n)},setField:function(e,t,i){if(this._fields.set(e,t),this.getPrivate()||t.addClones(1),i)return void this._userDefinedFields.set(e,t);this._predefinedFields.set(e,t),Object.defineProperty(this,e+"_",{get:function(){return t},set:function(e){t.setValue(e)},enumerable:!0,configurable:!0})},removeField:function(e){var t=this._fields.get(e);if(t){this._fields.delete(e),this._userDefinedFields.delete(e);for(var i=this.fieldDefinitions.getValue(),n=0,r=i.length;n<r;++n)if(i[n].name===e){i.splice(n,1);break}this.getPrivate()||t.removeClones(1)}},getField:function(){return function(e){var t=this._fields.get(e);if(t)return t;var i=e.match(/^set_(.*?)$/);if(i&&(t=this._fields.get(i[1]))&&t.getAccessType()===s.inputOutput)return t;var i=e.match(/^(.*?)_changed$/);if(i&&(t=this._fields.get(i[1]))&&t.getAccessType()===s.inputOutput)return t;throw new Error("Unkown field '"+e+"' in node class "+this.getTypeName()+".")}}(),getFieldDefinitions:function(){return this.fieldDefinitions},hasUserDefinedFields:function(){return!1},addUserDefinedField:function(e,t,n){this._fields.has(t)&&this.removeField(t),n.setTainted(!0),n.addParent(this),n.setName(t),n.setAccessType(e),this.fieldDefinitions.add(new i(e,t,n)),this.setField(t,n,!0)},getUserDefinedFields:function(){return this._userDefinedFields},getPredefinedFields:function(){return this._predefinedFields},getChangedFields:function(e){var t=[],i=this.getPredefinedFields();if(e){var n=this.getUserDefinedFields();for(var r of n.values())t.push(r)}for(var r of i.values())if(e&&(r.getInputRoutes().size||r.getOutputRoutes().size))t.push(r);else{if(0===r.getReferences().size){if(!r.isInitializable())continue;if(this.isDefaultValue(r))continue}t.push(r)}return t},isDefaultValue:function(e){var t=this.getFieldDefinitions().get(e.getName());return t?t.value.equals(e):!e.getSet()},getFields:function(){for(var e=[],t=this.getFieldDefinitions(),i=0,n=t.length;i<n;++i)e.push(this.getField(t[i].name));return e},getSourceText:function(){return null},hasRoutes:function(){for(var e=this.getFieldDefinitions(),t=0,i=e.length;t<i;++t){var n=this.getField(e[t].name);if(0!==n.getInputRoutes().size||0!==n.getOutputRoutes().size)return!0}return!1},getPrivate:function(){return this._private},setPrivate:function(e){if(this._private=e,e)for(var t=this.getFieldDefinitions(),i=0,n=t.length;i<n;++i)this.getField(t[i].name).removeClones(1);else for(var t=this.getFieldDefinitions(),i=0,n=t.length;i<n;++i)this.getField(t[i].name).addClones(1)},getCloneCount:function(){return this._cloneCount},addClones:function(e){0!==e&&(this._cloneCount+=e)},removeClones:function(e){0!==e&&(this._cloneCount-=e)},traverse:function(){},toStream:function(e){e.string+=this.getTypeName()+" { }"},toXMLStream:function(e){var t=o.Get(e);if(t.IsSharedNode(this))return e.string+=t.Indent(),void(e.string+="<!-- NULL -->");t.EnterScope();var i=t.Name(this);if(i.length&&t.ExistsNode(this)){e.string+=t.Indent(),e.string+="<",e.string+=this.getTypeName(),e.string+=" ",e.string+="USE='",e.string+=t.XMLEncode(i),e.string+="'";var n=t.ContainerField();return n&&n.getName()!==this.getContainerField()&&(e.string+=" ",e.string+="containerField='",e.string+=t.XMLEncode(n.getName()),e.string+="'"),e.string+="/>",void t.LeaveScope()}e.string+=t.Indent(),e.string+="<",e.string+=this.getTypeName(),i.length&&(t.AddNode(this),e.string+=" ",e.string+="DEF='",e.string+=t.XMLEncode(i),e.string+="'");var n=t.ContainerField();n&&n.getName()!==this.getContainerField()&&(e.string+=" ",e.string+="containerField='",e.string+=t.XMLEncode(n.getName()),e.string+="'");var r=this.getChangedFields(),a=this.getUserDefinedFields(),u=[],l=[],h=this.getSourceText();h&&0===h.length&&(h=null),t.IncIndent(),t.IncIndent();for(var c=0,d=r.length;c<d;++c){var p=r[c],f=!1;if(t.ExecutionContext()&&p.getAccessType()===s.inputOutput&&0!==p.getReferences().size){var g=!1,m=p.getReferences();for(var _ of m.values())g|=_.isInitializable();g||(f=!0)}if(0===p.getReferences().size||!t.ExecutionContext()||f){if(f&&u.push(p),p.isInitializable())switch(p.getType()){case s.SFNode:case s.MFNode:l.push(p);break;default:if(p===h)break;e.string+="\n",e.string+=t.Indent(),e.string+=p.getName(),e.string+="='",p.toXMLStream(e),e.string+="'"}}else u.push(p)}if(t.DecIndent(),t.DecIndent(),this.hasUserDefinedFields()&&0!==a.size||0!==u.length||0!==l.length||h){if(e.string+=">\n",t.IncIndent(),this.hasUserDefinedFields())for(var p of a.values()){e.string+=t.Indent(),e.string+="<field",e.string+=" ",e.string+="accessType='",e.string+=t.AccessType(p.getAccessType()),e.string+="'",e.string+=" ",e.string+="type='",e.string+=p.getTypeName(),e.string+="'",e.string+=" ",e.string+="name='",e.string+=t.XMLEncode(p.getName()),e.string+="'";var f=!1;if(p.getAccessType()===s.inputOutput&&0!==p.getReferences().size){var g=!1,m=p.getReferences();for(var _ of m.values())g|=_.isInitializable();g||(f=!0)}if(0===p.getReferences().size||!t.ExecutionContext()||f)if(f&&t.ExecutionContext()&&u.push(p),!p.isInitializable()||p.isDefaultValue())e.string+="/>\n";else switch(p.getType()){case s.SFNode:case s.MFNode:t.PushContainerField(null),e.string+=">\n",t.IncIndent(),p.toXMLStream(e),e.string+="\n",t.DecIndent(),e.string+=t.Indent(),e.string+="</field>\n",t.PopContainerField();break;default:e.string+=" ",e.string+="value='",p.toXMLStream(e),e.string+="'",e.string+="/>\n"}else t.ExecutionContext()&&u.push(p),e.string+="/>\n"}if(u.length){e.string+=t.Indent(),e.string+="<IS>",e.string+="\n",t.IncIndent();for(var c=0,d=u.length;c<d;++c){var p=u[c],x=p.getReferences();for(var y of x.values())e.string+=t.Indent(),e.string+="<connect",e.string+=" ",e.string+="nodeField='",e.string+=t.XMLEncode(p.getName()),e.string+="'",e.string+=" ",e.string+="protoField='",e.string+=t.XMLEncode(y.getName()),e.string+="'",e.string+="/>\n"}t.DecIndent(),e.string+=t.Indent(),e.string+="</IS>\n"}for(var c=0,d=l.length;c<d;++c){var p=l[c];t.PushContainerField(p),p.toXMLStream(e),e.string+="\n",t.PopContainerField()}if(h)for(var c=0,d=h.length;c<d;++c){var v=h[c];e.string+="<![CDATA[",e.string+=t.escapeCDATA(v),e.string+="]]>\n"}t.DecIndent(),e.string+=t.Indent(),e.string+="</",e.string+=this.getTypeName(),e.string+=">"}else e.string+="/>";t.LeaveScope()},dispose:function(){var e=this.getPredefinedFields(),t=this.getUserDefinedFields();for(var i of e.values())i.dispose();for(var n of t.values())n.dispose();var s=this.getParents();for(var o of s.values())if(o instanceof r.SFNode){var a=o.getParents();for(var u of a.values())if(u instanceof r.MFNode){var l=u.length;u.erase(u.remove(0,l,o),l)}o.setValue(null)}}}),u.prototype.addAlias=u.prototype.setField,u}),define("x_ite/Browser/Core/PrimitiveQuality",[],function(){"use strict";var e=0,t={LOW:e++,MEDIUM:e++,HIGH:e++};return Object.preventExtensions(t),Object.freeze(t),Object.seal(t),t}),define("x_ite/Browser/Core/Shading",[],function(){"use strict";var e=0,t={POINT:e++,WIREFRAME:e++,FLAT:e++,GOURAUD:e++,PHONG:e++};return Object.preventExtensions(t),Object.freeze(t),Object.seal(t),t}),define("x_ite/Browser/Core/TextureQuality",[],function(){"use strict";var e=0,t={LOW:e++,MEDIUM:e++,HIGH:e++};return Object.preventExtensions(t),Object.freeze(t),Object.seal(t),t}),define("x_ite/Browser/Core/BrowserOptions",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Basic/X3DBaseNode","x_ite/Bits/X3DConstants","x_ite/Browser/Core/PrimitiveQuality","x_ite/Browser/Core/Shading","x_ite/Browser/Core/TextureQuality"],function(e,t,i,n,r,s,o,a){"use strict";function u(e,t){return"true"===e||"TRUE"===e||"false"!==e&&"FALSE"!==e&&t}function l(e){n.call(this,e),this.addAlias("AntiAliased",this.Antialiased_),this.setAttributeSplashScreen(),this.primitiveQuality=s.MEDIUM,this.textureQuality=a.MEDIUM,this.shading=o.GOURAUD}return l.prototype=Object.assign(Object.create(n.prototype),{constructor:l,fieldDefinitions:new i([new t(r.inputOutput,"SplashScreen",new e.SFBool(!0)),new t(r.inputOutput,"Dashboard",new e.SFBool(!0)),new t(r.inputOutput,"Rubberband",new e.SFBool(!0)),new t(r.inputOutput,"EnableInlineViewpoints",new e.SFBool(!0)),new t(r.inputOutput,"Antialiased",new e.SFBool(!0)),new t(r.inputOutput,"TextureQuality",new e.SFString("MEDIUM")),new t(r.inputOutput,"PrimitiveQuality",new e.SFString("MEDIUM")),new t(r.inputOutput,"QualityWhenMoving",new e.SFString("MEDIUM")),new t(r.inputOutput,"Shading",new e.SFString("GOURAUD")),new t(r.inputOutput,"MotionBlur",new e.SFBool),new t(r.inputOutput,"Gravity",new e.SFFloat(9.80665)),new t(r.inputOutput,"StraightenHorizon",new e.SFBool(!0)),new t(r.inputOutput,"LogarithmicDepthBuffer",new e.SFBool(!1))]),getTypeName:function(){return"BrowserOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"browserOptions"},initialize:function(){n.prototype.initialize.call(this),this.SplashScreen_.addInterest("set_splashScreen__",this),this.Rubberband_.addInterest("set_rubberband__",this),this.PrimitiveQuality_.addInterest("set_primitiveQuality__",this),this.TextureQuality_.addInterest("set_textureQuality__",this),this.Shading_.addInterest("set_shading__",this),this.StraightenHorizon_.addInterest("set_straightenHorizon__",this),this.LogarithmicDepthBuffer_.addInterest("set_logarithmicDepthBuffer__",this),this.configure()},configure:function(){if(this.isInitialized()){for(var e=this.getFieldDefinitions(),t=0;t<e.length;++t){var i=e[t],n=this.getField(i.name);void 0===this.getBrowser().getLocalStorage()["BrowserOptions."+i.name]&&(n.equals(i.value)||n.setValue(i.value))}var r=this.getBrowser().getLocalStorage()["BrowserOptions.Rubberband"],s=this.getBrowser().getLocalStorage()["BrowserOptions.PrimitiveQuality"],o=this.getBrowser().getLocalStorage()["BrowserOptions.TextureQuality"],a=this.getBrowser().getLocalStorage()["BrowserOptions.StraightenHorizon"];this.setAttributeSplashScreen(),void 0!==r&&r!==this.Rubberband_.getValue()&&(this.Rubberband_=r),void 0!==s&&s!==this.PrimitiveQuality_.getValue().toUpperCase()&&(this.PrimitiveQuality_=s),void 0!==o&&o!==this.TextureQuality_.getValue().toUpperCase()&&(this.TextureQuality_=o),void 0!==a&&a!==this.StraightenHorizon_.getValue()&&(this.StraightenHorizon_=a),this.LogarithmicDepthBuffer_=!1}},setAttributeSplashScreen:function(){this.SplashScreen_.set(this.getSplashScreen())},getCache:function(){return u(this.getBrowser().getElement().attr("cache"),!0)},getContextMenu:function(){return u(this.getBrowser().getElement().attr("contextMenu"),!0)},getDebug:function(){return u(this.getBrowser().getElement().attr("debug"),!1)},getNotifications:function(){return u(this.getBrowser().getElement().attr("notifications"),!0)},getSplashScreen:function(){return u(this.getBrowser().getElement().attr("splashScreen"),!0)},getTimings:function(){return u(this.getBrowser().getElement().attr("timings"),!0)},getPrimitiveQuality:function(){return this.primitiveQuality},getShading:function(){return this.shading},getTextureQuality:function(){return this.textureQuality},set_splashScreen__:function(e){this.getBrowser().getElement().attr("splashScreen",e.getValue()?"true":"false")},set_rubberband__:function(e){this.getBrowser().getLocalStorage()["BrowserOptions.Rubberband"]=e.getValue()},set_primitiveQuality__:function(e){var t=e.getValue().toUpperCase();this.getBrowser().getLocalStorage()["BrowserOptions.PrimitiveQuality"]=t;var i=this.getBrowser().getArc2DOptions(),n=this.getBrowser().getArcClose2DOptions(),r=this.getBrowser().getCircle2DOptions(),o=this.getBrowser().getDisk2DOptions(),a=this.getBrowser().getConeOptions(),u=this.getBrowser().getCylinderOptions(),l=this.getBrowser().getSphereOptions();switch(t){case"LOW":this.primitiveQuality=s.LOW,i.dimension_=20,n.dimension_=20,r.dimension_=20,o.dimension_=20,a.xDimension_=16,u.xDimension_=16,l.xDimension_=20,l.yDimension_=9;break;case"HIGH":this.primitiveQuality=s.HIGH,i.dimension_=80,n.dimension_=80,r.dimension_=80,o.dimension_=80,a.xDimension_=32,u.xDimension_=32,l.xDimension_=64,l.yDimension_=31;break;default:this.primitiveQuality=s.MEDIUM,i.dimension_=40,n.dimension_=40,r.dimension_=40,o.dimension_=40,a.xDimension_=20,u.xDimension_=20,l.xDimension_=32,l.yDimension_=15}},set_textureQuality__:function(e){var t=e.getValue().toUpperCase();this.getBrowser().getLocalStorage()["BrowserOptions.TextureQuality"]=t;var i=this.getBrowser().getDefaultTextureProperties();switch(t){case"LOW":this.textureQuality=a.LOW,i.magnificationFilter_="AVG_PIXEL",i.minificationFilter_="AVG_PIXEL",i.textureCompression_="FASTEST",i.generateMipMaps_=!0;break;case"HIGH":this.textureQuality=a.HIGH,i.magnificationFilter_="NICEST",i.minificationFilter_="NICEST",i.textureCompression_="NICEST",i.generateMipMaps_=!0;break;default:this.textureQuality=a.MEDIUM,i.magnificationFilter_="NICEST",i.minificationFilter_="AVG_PIXEL_AVG_MIPMAP",i.textureCompression_="NICEST",i.generateMipMaps_=!0}},set_shading__:function(e){switch(e.getValue().toUpperCase()){case"POINT":case"POINTSET":this.shading=o.POINT;break;case"WIREFRAME":this.shading=o.WIREFRAME;break;case"FLAT":this.shading=o.FLAT;break;case"PHONG":this.shading=o.PHONG;break;default:this.shading=o.GOURAUD}this.getBrowser().setShading(this.shading)},set_straightenHorizon__:function(e){this.getBrowser().getLocalStorage()["BrowserOptions.StraightenHorizon"]=e.getValue()},set_logarithmicDepthBuffer__:function(e){try{var t=this.getBrowser();if((e=e.getValue()&&t.getExtension("EXT_frag_depth"))===t.getRenderingProperties().LogarithmicDepthBuffer_.getValue())return;t.getRenderingProperties().LogarithmicDepthBuffer_=e,t.getPointShader().parts_[0].url_.addEvent(),t.getPointShader().parts_[1].url_.addEvent(),t.getLineShader().parts_[0].url_.addEvent(),t.getLineShader().parts_[1].url_.addEvent(),t.getGouraudShader().parts_[0].url_.addEvent(),t.getGouraudShader().parts_[1].url_.addEvent(),t.getPhongShader().parts_[0].url_.addEvent(),t.getPhongShader().parts_[1].url_.addEvent(),t.getShadowShader().parts_[0].url_.addEvent(),t.getShadowShader().parts_[1].url_.addEvent()}catch(e){}}}),l}),define("x_ite/Browser/Core/BrowserProperties",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Basic/X3DBaseNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.initializeOnly,"ABSTRACT_NODES",new e.SFBool(!0)),new t(r.initializeOnly,"CONCRETE_NODES",new e.SFBool(!0)),new t(r.initializeOnly,"EXTERNAL_INTERACTIONS",new e.SFBool(!0)),new t(r.initializeOnly,"PROTOTYPE_CREATE",new e.SFBool(!0)),new t(r.initializeOnly,"DOM_IMPORT",new e.SFBool(!0)),new t(r.initializeOnly,"XML_ENCODING",new e.SFBool(!0)),new t(r.initializeOnly,"CLASSIC_VRML_ENCODING",new e.SFBool(!0)),new t(r.initializeOnly,"BINARY_ENCODING",new e.SFBool)]),getTypeName:function(){return"BrowserProperties"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"browserProperties"}}),s}),define("x_ite/Browser/Core/RenderingProperties",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Basic/X3DBaseNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addAlias("AntiAliased",this.Antialiased_)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.outputOnly,"Shading",new e.SFString),new t(r.outputOnly,"MaxTextureSize",new e.SFInt32),new t(r.outputOnly,"TextureUnits",new e.SFInt32),new t(r.outputOnly,"MaxLights",new e.SFInt32),new t(r.outputOnly,"Antialiased",new e.SFBool(!0)),new t(r.outputOnly,"ColorDepth",new e.SFInt32),new t(r.outputOnly,"TextureMemory",new e.SFDouble),new t(r.outputOnly,"LogarithmicDepthBuffer",new e.SFBool(!1))]),getTypeName:function(){return"RenderingProperties"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"renderingProperties"},initialize:function(){n.prototype.initialize.call(this);var e=this.getBrowser();this.MaxTextureSize_=e.getMaxTextureSize(),this.TextureUnits_=e.getCombinedTextureUnits(),this.MaxLights_=e.getMaxLights(),this.ColorDepth_=e.getColorDepth(),this.TextureMemory_=e.getTextureMemory(),e.getBrowserOptions().Shading_.addInterest("set_shading__",this),this.set_shading__(e.getBrowserOptions().Shading_)},set_shading__:function(e){this.Shading_=e}}),s}),define("x_ite/Browser/Core/Notification",["jquery","x_ite/Fields/SFString","x_ite/Basic/X3DBaseNode"],function(e,t,i){"use strict";function n(e){i.call(this,e),this.addChildObjects("string",new t)}return e.fn.textWidth=function(t){var i=e(this).children(),n=e(this).html(),r="<span>"+n+"</span>";e(this).html(r);var s=e(this).find("span:first").width();return e(this).empty(),e(this).append(i),s},n.prototype=Object.assign(Object.create(i.prototype),{constructor:n,getTypeName:function(){return"Notification"},getComponentName:function(){return"X_ITE"},initialize:function(){i.prototype.initialize.call(this),this.element=e("<div></div>").addClass("x_ite-private-notification").appendTo(this.getBrowser().getElement().find(".x_ite-private-surface")).animate({width:0}),e("<span></span>").appendTo(this.element),this.string_.addInterest("set_string__",this)},set_string__:function(){this.getBrowser().getBrowserOptions().getNotifications()&&0!==this.string_.length&&(this.element.children().text(this.string_.getValue()),this.element.stop(!0,!0).fadeIn(0).animate({width:this.element.textWidth()}).animate({delay:1},5e3).animate({width:0}).fadeOut(0))}}),n}),define("text/text",["module"],function(e){"use strict";function t(e,t){return void 0===e||""===e?t:e}function i(e,i,n,r){if(i===r)return!0;if(e===n){if("http"===e)return t(i,"80")===t(r,"80");if("https"===e)return t(i,"443")===t(r,"443")}return!1}var n,r,s,o,a,u=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],l="undefined"!=typeof location&&location.href,h=l&&location.protocol&&location.protocol.replace(/\:/,""),c=l&&location.hostname,d=l&&(location.port||void 0),p={},f=e.config&&e.config()||{};return n={version:"2.0.15",strip:function(e){if(e){e=e.replace(/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,"");var t=e.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:f.createXhr||function(){var e,t,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;t<3;t+=1){i=u[t];try{e=new ActiveXObject(i)}catch(e){}if(e){u=[i];break}}return e},parseName:function(e){var t,i,n,r=!1,s=e.lastIndexOf("."),o=0===e.indexOf("./")||0===e.indexOf("../");return s!==-1&&(!o||s>1)?(t=e.substring(0,s),i=e.substring(s+1)):t=e,n=i||t,s=n.indexOf("!"),s!==-1&&(r="strip"===n.substring(s+1),n=n.substring(0,s),i?i=n:t=n),{moduleName:t,ext:i,strip:r}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,r,s){var o,a,u,l=n.xdRegExp.exec(e);return!l||(o=l[2],a=l[3],a=a.split(":"),u=a[1],a=a[0],(!o||o===t)&&(!a||a.toLowerCase()===r.toLowerCase())&&(!u&&!a||i(o,u,t,s)))},finishLoad:function(e,t,i,r){i=t?n.strip(i):i,f.isBuild&&(p[e]=i),r(i)},load:function(e,t,i,r){if(r&&r.isBuild&&!r.inlineText)return void i();f.isBuild=r&&r.isBuild;var s=n.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),a=t.toUrl(o),u=f.useXhr||n.useXhr;if(0===a.indexOf("empty:"))return void i();!l||u(a,h,c,d)?n.get(a,function(t){n.finishLoad(e,s.strip,t,i)},function(e){i.error&&i.error(e)}):t([o],function(e){n.finishLoad(s.moduleName+"."+s.ext,s.strip,e,i)})},write:function(e,t,i,r){if(p.hasOwnProperty(t)){var s=n.jsEscape(p[t]);i.asModule(e+"!"+t,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,t,i,r,s){var o=n.parseName(t),a=o.ext?"."+o.ext:"",u=o.moduleName+a,l=i.toUrl(o.moduleName+a)+".js";n.load(u,i,function(t){var i=function(e){return r(l,e)};i.asModule=function(e,t){return r.asModule(e,l,t)},n.write(e,u,i,s)},s)}},"node"===f.env||!f.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(r=require.nodeRequire("fs"),n.get=function(e,t,i){try{var n=r.readFileSync(e,"utf8");"\ufeff"===n[0]&&(n=n.substring(1)),t(n)}catch(e){i&&i(e)}}):"xhr"===f.env||!f.env&&n.createXhr()?n.get=function(e,t,i,r){var s,o=n.createXhr();if(o.open("GET",e,!0),r)for(s in r)r.hasOwnProperty(s)&&o.setRequestHeader(s.toLowerCase(),r[s]);f.onXhr&&f.onXhr(o,e),o.onreadystatechange=function(n){var r,s;4===o.readyState&&(r=o.status||0,r>399&&r<600?(s=new Error(e+" HTTP status: "+r),s.xhr=o,i&&i(s)):t(o.responseText),f.onXhrComplete&&f.onXhrComplete(o,e))},o.send(null)}:"rhino"===f.env||!f.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?n.get=function(e,t){var i,n,r=new java.io.File(e),s=java.lang.System.getProperty("line.separator"),o=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),"utf-8")),a="";try{for(i=new java.lang.StringBuffer,n=o.readLine(),n&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&i.append(n);null!==(n=o.readLine());)i.append(s),i.append(n);a=String(i.toString())}finally{o.close()}t(a)}:("xpconnect"===f.env||!f.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(s=Components.classes,o=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),a="@mozilla.org/windows-registry-key;1"in s,n.get=function(e,t){var i,n,r,u={};a&&(e=e.replace(/\//g,"\\")),r=new FileUtils.File(e);try{i=s["@mozilla.org/network/file-input-stream;1"].createInstance(o.nsIFileInputStream),i.init(r,1,0,!1),n=s["@mozilla.org/intl/converter-input-stream;1"].createInstance(o.nsIConverterInputStream),n.init(i,"utf-8",i.available(),o.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),n.readString(i.available(),u),n.close(),i.close(),t(u.value)}catch(e){throw new Error((r&&r.path||"")+": "+e)}}),n}),define("text",["text/text"],function(e){return e}),define("text!locale/de.po",[],function(){return'msgid ""\nmsgstr ""\n"Project-Id-Version: X_ITE\\n"\n"POT-Creation-Date: 2015-12-23 04:56+0100\\n"\n"PO-Revision-Date: 2015-12-23 04:57+0100\\n"\n"Last-Translator: Holger Seelig <holger.seelig@yahoo.de>\\n"\n"Language-Team: \\n"\n"Language: de\\n"\n"MIME-Version: 1.0\\n"\n"Content-Type: text/plain; charset=UTF-8\\n"\n"Content-Transfer-Encoding: 8bit\\n"\n"X-Generator: Poedit 1.8.4\\n"\n"X-Poedit-Basepath: ../x_ite\\n"\n"Plural-Forms: nplurals=2; plural=(n != 1);\\n"\n"X-Poedit-SourceCharset: UTF-8\\n"\n"X-Poedit-SearchPath-0: .\\n"\n\n#: Browser/Core/BrowserTimings.js:96\nmsgid "Less Properties"\nmsgstr "Weniger Eigenschaften"\n\n#: Browser/Core/BrowserTimings.js:98\nmsgid "More Properties"\nmsgstr "Mehr Eigenschaften"\n\n#: Browser/Core/BrowserTimings.js:124\nmsgid "Frame rate"\nmsgstr "Bildrate"\n\n#: Browser/Core/BrowserTimings.js:124\nmsgid "fps"\nmsgstr "BpS"\n\n#: Browser/Core/BrowserTimings.js:125\nmsgid "Speed"\nmsgstr "Geschwindigkeit"\n\n#: Browser/Core/BrowserTimings.js:125\nmsgid "m/s"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:125\nmsgid "km/h"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:150\nmsgid "Browser"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:150 Browser/Core/BrowserTimings.js:151\n#: Browser/Core/BrowserTimings.js:152 Browser/Core/BrowserTimings.js:153\n#: Browser/Core/BrowserTimings.js:154 Browser/Core/BrowserTimings.js:155\n#: Browser/Core/BrowserTimings.js:156\nmsgid "ms"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:151\nmsgid "X3D"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:152\nmsgid "Routing"\nmsgstr "Routen"\n\n#: Browser/Core/BrowserTimings.js:153\nmsgid "Picking"\nmsgstr "Zeigegerät"\n\n#: Browser/Core/BrowserTimings.js:154\nmsgid "Camera"\nmsgstr "Kamera"\n\n#: Browser/Core/BrowserTimings.js:155\nmsgid "Collision"\nmsgstr "Kollision"\n\n#: Browser/Core/BrowserTimings.js:156\nmsgid "Display"\nmsgstr "Anzeige"\n\n#: Browser/Core/BrowserTimings.js:157\nmsgid "Shapes"\nmsgstr "Formen"\n\n#: Browser/Core/BrowserTimings.js:158\nmsgid "Sensors"\nmsgstr "Sensoren"\n\n#: Browser/Core/BrowserTimings.js:163 Browser/Core/ContextMenu.js:210\nmsgid "Browser Timings"\nmsgstr "Zeitberechnung"\n\n#: Browser/Core/ContextMenu.js:19\nmsgid "X_ITE Browser"\nmsgstr ""\n\n#: Browser/Core/ContextMenu.js:59\nmsgid "Viewpoints"\nmsgstr "Ansichtspunkte"\n\n#: Browser/Core/ContextMenu.js:87\nmsgid "Available Viewers"\nmsgstr "Verfügbare Betrachter"\n\n#: Browser/Core/ContextMenu.js:145\nmsgid "Straighten Horizon"\nmsgstr "Horizont gerade richten"\n\n#: Browser/Core/ContextMenu.js:95 Browser/Core/ContextMenu.js:107\n#: Browser/Core/ContextMenu.js:121 Browser/Core/ContextMenu.js:135\nmsgid "Primitive Quality"\nmsgstr "Qualität der Grundobjekte"\n\n#: Browser/Core/ContextMenu.js:99 Browser/Core/ContextMenu.js:147\nmsgid "High"\nmsgstr "Hoch"\n\n#: Browser/Core/ContextMenu.js:107 Browser/Core/ContextMenu.js:155\nmsgid "high"\nmsgstr "hoch"\n\n#: Browser/Core/ContextMenu.js:113 Browser/Core/ContextMenu.js:161\nmsgid "Medium"\nmsgstr "Mittel"\n\n#: Browser/Core/ContextMenu.js:121 Browser/Core/ContextMenu.js:169\nmsgid "medium"\nmsgstr "mittel"\n\n#: Browser/Core/ContextMenu.js:127 Browser/Core/ContextMenu.js:175\nmsgid "Low"\nmsgstr "Niedrig"\n\n#: Browser/Core/ContextMenu.js:135 Browser/Core/ContextMenu.js:183\nmsgid "low"\nmsgstr "niedrig"\n\n#: Browser/Core/ContextMenu.js:143 Browser/Core/ContextMenu.js:155\n#: Browser/Core/ContextMenu.js:169 Browser/Core/ContextMenu.js:183\nmsgid "Texture Quality"\nmsgstr "Textur Qualität"\n\n#: Browser/Core/ContextMenu.js:191\nmsgid "Display Rubberband"\nmsgstr "Gummiband anzeigen"\n\n#: Browser/Core/ContextMenu.js:202 Browser/Core/ContextMenu.js:204\nmsgid "Rubberband"\nmsgstr "Gummiband"\n\n#: Browser/Core/ContextMenu.js:202\nmsgid "on"\nmsgstr "an"\n\n#: Browser/Core/ContextMenu.js:204\nmsgid "off"\nmsgstr "aus"\n\n#: Browser/Core/ContextMenu.js:225\nmsgid "Mute Browser"\nmsgstr "Browser stumm schalten"\n\n#: Browser/Core/ContextMenu.js:233\nmsgid "Browser muted"\nmsgstr "Browser stumm geschalten"\n\n#: Browser/Core/ContextMenu.js:233\nmsgid "Browser unmuted"\nmsgstr "Browser Ton an"\n\n#: Browser/Core/ContextMenu.js:239\nmsgid "Leave Fullscreen"\nmsgstr "Vollbild verlassen"\n\n#: Browser/Core/ContextMenu.js:239\nmsgid "Fullscreen"\nmsgstr "Vollbild"\n\n#: Browser/Core/ContextMenu.js:249\nmsgid "About X_ITE"\nmsgstr "Über X_ITE"\n\n#: Browser/Core/ContextMenu.js:342\nmsgid "Examine Viewer"\nmsgstr "Untersuchen"\n\n#: Browser/Core/ContextMenu.js:344\nmsgid "Walk Viewer"\nmsgstr "Laufen"\n\n#: Browser/Core/ContextMenu.js:346\nmsgid "Fly Viewer"\nmsgstr "Fliegen"\n\n#: Browser/Core/ContextMenu.js:348\nmsgid "Plane Viewer"\nmsgstr "Ebenen Betrachter"\n\n#: Browser/Core/ContextMenu.js:350\n#, fuzzy\nmsgid "Look At Viewer"\nmsgstr "Auf Objekte zielen"\n\n#: Browser/Core/ContextMenu.js:352\nmsgid "None Viewer"\nmsgstr "Kein Betrachter"\n\n#: Browser/Networking/X3DNetworkingContext.js:101\n#, javascript-format\nmsgid "Loading %d file"\nmsgstr "Lade %d Datei"\n\n#: Browser/Networking/X3DNetworkingContext.js:101\n#, javascript-format\nmsgid "Loading %d files"\nmsgstr "Lade %d Dateien"\n\n#: Browser/Networking/X3DNetworkingContext.js:104\nmsgid "Loading done"\nmsgstr "Fertig mit Laden"\n\n#: Browser/X3DBrowser.js:313\nmsgid "Failed loading world."\nmsgstr "Laden der Dateien fehlgeschlagen."\n\n#~ msgid "Look At"\n#~ msgstr "Auf Objekte zielen"\n'}),define("text!locale/fr.po",[],function(){
return'msgid ""\nmsgstr ""\n"Project-Id-Version: X_ITE\\n"\n"POT-Creation-Date: 2015-12-23 04:58+0100\\n"\n"PO-Revision-Date: 2015-12-23 05:07+0100\\n"\n"Last-Translator: Holger Seelig <holger.seelig@yahoo.de>\\n"\n"Language-Team: \\n"\n"Language: fr\\n"\n"MIME-Version: 1.0\\n"\n"Content-Type: text/plain; charset=UTF-8\\n"\n"Content-Transfer-Encoding: 8bit\\n"\n"X-Generator: Poedit 1.8.4\\n"\n"X-Poedit-Basepath: ../x_ite\\n"\n"Plural-Forms: nplurals=2; plural=(n != 1);\\n"\n"X-Poedit-SourceCharset: UTF-8\\n"\n"X-Poedit-SearchPath-0: .\\n"\n\n#: Browser/Core/BrowserTimings.js:96\nmsgid "Less Properties"\nmsgstr "Moins de propriétés"\n\n#: Browser/Core/BrowserTimings.js:98\nmsgid "More Properties"\nmsgstr "Plus de propriétés"\n\n#: Browser/Core/BrowserTimings.js:124\nmsgid "Frame rate"\nmsgstr "Fréquence"\n\n#: Browser/Core/BrowserTimings.js:124\nmsgid "fps"\nmsgstr "fps"\n\n#: Browser/Core/BrowserTimings.js:125\nmsgid "Speed"\nmsgstr "Vélocité"\n\n#: Browser/Core/BrowserTimings.js:125\nmsgid "m/s"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:125\nmsgid "km/h"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:150\n#, fuzzy\nmsgid "Browser"\nmsgstr "X_ITE Navigateur"\n\n#: Browser/Core/BrowserTimings.js:150 Browser/Core/BrowserTimings.js:151\n#: Browser/Core/BrowserTimings.js:152 Browser/Core/BrowserTimings.js:153\n#: Browser/Core/BrowserTimings.js:154 Browser/Core/BrowserTimings.js:155\n#: Browser/Core/BrowserTimings.js:156\nmsgid "ms"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:151\nmsgid "X3D"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:152\nmsgid "Routing"\nmsgstr "Routes"\n\n#: Browser/Core/BrowserTimings.js:153\nmsgid "Picking"\nmsgstr "Pointeur"\n\n#: Browser/Core/BrowserTimings.js:154\nmsgid "Camera"\nmsgstr "Caméra"\n\n#: Browser/Core/BrowserTimings.js:155\nmsgid "Collision"\nmsgstr "Collision"\n\n#: Browser/Core/BrowserTimings.js:156\nmsgid "Display"\nmsgstr "Visualisation"\n\n#: Browser/Core/BrowserTimings.js:157\nmsgid "Shapes"\nmsgstr "Formes"\n\n#: Browser/Core/BrowserTimings.js:158\nmsgid "Sensors"\nmsgstr "Senseurs"\n\n#: Browser/Core/BrowserTimings.js:163 Browser/Core/ContextMenu.js:210\nmsgid "Browser Timings"\nmsgstr "Calcul du temps"\n\n#: Browser/Core/ContextMenu.js:19\nmsgid "X_ITE Browser"\nmsgstr "X_ITE Navigateur"\n\n#: Browser/Core/ContextMenu.js:59\nmsgid "Viewpoints"\nmsgstr "Points de vue"\n\n#: Browser/Core/ContextMenu.js:87\nmsgid "Available Viewers"\nmsgstr "Visionneurs disponibles"\n\n#: Browser/Core/ContextMenu.js:145\nmsgid "Straighten Horizon"\nmsgstr "Redresser l\'horizon"\n\n#: Browser/Core/ContextMenu.js:95 Browser/Core/ContextMenu.js:107\n#: Browser/Core/ContextMenu.js:121 Browser/Core/ContextMenu.js:135\nmsgid "Primitive Quality"\nmsgstr "Qualité des objets simples"\n\n#: Browser/Core/ContextMenu.js:99 Browser/Core/ContextMenu.js:147\nmsgid "High"\nmsgstr "Haut"\n\n#: Browser/Core/ContextMenu.js:107 Browser/Core/ContextMenu.js:155\nmsgid "high"\nmsgstr "haut"\n\n#: Browser/Core/ContextMenu.js:113 Browser/Core/ContextMenu.js:161\nmsgid "Medium"\nmsgstr "Moyenne"\n\n#: Browser/Core/ContextMenu.js:121 Browser/Core/ContextMenu.js:169\nmsgid "medium"\nmsgstr "moyenne"\n\n#: Browser/Core/ContextMenu.js:127 Browser/Core/ContextMenu.js:175\nmsgid "Low"\nmsgstr "Faible"\n\n#: Browser/Core/ContextMenu.js:135 Browser/Core/ContextMenu.js:183\nmsgid "low"\nmsgstr "faible"\n\n#: Browser/Core/ContextMenu.js:143 Browser/Core/ContextMenu.js:155\n#: Browser/Core/ContextMenu.js:169 Browser/Core/ContextMenu.js:183\nmsgid "Texture Quality"\nmsgstr "Qualité des textures"\n\n#: Browser/Core/ContextMenu.js:191\nmsgid "Display Rubberband"\nmsgstr "Présenter le bande élastique"\n\n#: Browser/Core/ContextMenu.js:202 Browser/Core/ContextMenu.js:204\nmsgid "Rubberband"\nmsgstr "Bande élastique"\n\n#: Browser/Core/ContextMenu.js:202\nmsgid "on"\nmsgstr "marche"\n\n#: Browser/Core/ContextMenu.js:204\nmsgid "off"\nmsgstr "arrêt"\n\n#: Browser/Core/ContextMenu.js:225\nmsgid "Mute Browser"\nmsgstr "Rendre navigateur muet"\n\n#: Browser/Core/ContextMenu.js:233\nmsgid "Browser muted"\nmsgstr "Navigateur muet"\n\n#: Browser/Core/ContextMenu.js:233\nmsgid "Browser unmuted"\nmsgstr "Son de navigateur réactivé"\n\n#: Browser/Core/ContextMenu.js:239\nmsgid "Leave Fullscreen"\nmsgstr "Sortie en plein écran"\n\n#: Browser/Core/ContextMenu.js:239\nmsgid "Fullscreen"\nmsgstr "Plein écran"\n\n#: Browser/Core/ContextMenu.js:249\nmsgid "About X_ITE"\nmsgstr "À propos de X_ITE"\n\n#: Browser/Core/ContextMenu.js:342\nmsgid "Examine Viewer"\nmsgstr "Examiner"\n\n#: Browser/Core/ContextMenu.js:344\nmsgid "Walk Viewer"\nmsgstr "Aller"\n\n#: Browser/Core/ContextMenu.js:346\nmsgid "Fly Viewer"\nmsgstr "Voler"\n\n#: Browser/Core/ContextMenu.js:348\nmsgid "Plane Viewer"\nmsgstr "Visionneur de la plaine"\n\n#: Browser/Core/ContextMenu.js:350\n#, fuzzy\nmsgid "Look At Viewer"\nmsgstr "Regarder un objet de près"\n\n#: Browser/Core/ContextMenu.js:352\nmsgid "None Viewer"\nmsgstr "Pas de visionneur"\n\n#: Browser/Networking/X3DNetworkingContext.js:101\n#, javascript-format\nmsgid "Loading %d file"\nmsgstr "Télécharger %d fichier"\n\n#: Browser/Networking/X3DNetworkingContext.js:101\n#, javascript-format\nmsgid "Loading %d files"\nmsgstr "Télécharger %d fichiers"\n\n#: Browser/Networking/X3DNetworkingContext.js:104\nmsgid "Loading done"\nmsgstr "Téléchargement fini"\n\n#: Browser/X3DBrowser.js:313\nmsgid "Failed loading world."\nmsgstr "Le chargement des fichiers ayant échoué."\n\n#~ msgid "Look At"\n#~ msgstr "Regarder un objet de près"\n'}),define("locale/gettext",["text!locale/de.po","text!locale/fr.po"],function(e,t){"use strict";function i(e,t){for(var i=null,n=[];i=e.exec(t);)n.push(i);return n}function n(e){var t=r[o];if(void 0===t)return e;var i=t[e];return void 0===i?e:i}var r={en:"C",de:e,fr:t},s=/msgid\s+"(.*?)"\nmsgstr\s+"(.*?)"\n/g,o=function(){for(var e=0;e<navigator.languages;++e){var t=navigator.languages[e].split("-")[0];if(r[t])return t}return(navigator.language||navigator.userLanguage).split("-")[0]}();return function(e){if(r[e])for(var t=i(s,r[e]),n=r[e]={},o=0,a=t.length;o<a;++o)t[o][2].length&&(n[t[o][1]]=t[o][2])}(o),n}),define("x_ite/Browser/Core/BrowserTimings",["jquery","x_ite/Fields/SFBool","x_ite/Basic/X3DBaseNode","locale/gettext"],function(e,t,i,n){"use strict";function r(e){return Math.floor(100*e)/100}function s(e){i.call(this,e),this.addChildObjects("enabled",new t)}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,getTypeName:function(){return"BrowserTimings"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"browserTimings"},initialize:function(){i.prototype.initialize.call(this),this.enabled_.addInterest("set_enabled__",this),this.localeOptions={minimumFractionDigits:2,maximumFractionDigits:2},this.type=this.getBrowser().getLocalStorage()["BrowserTimings.type"]||"LESS",this.startTime=0,this.frames=0,this.element=e("<div></div>").addClass("x_ite-private-browser-timings").appendTo(this.getBrowser().getElement().find(".x_ite-private-surface")),this.table=e("<table></table>").appendTo(this.element),this.header=e("<thead></thead>").append(e("<tr></tr>").append(e("<th colspan='2'></th>"))).appendTo(this.table),this.body=e("<tbody></tbody>").appendTo(this.table),this.footer=e("<tfoot></tfoot>").append(e("<tr></tr>").append(e("<td colspan='2'></td>"))).appendTo(this.table),this.button=e("<button></button>").click(this.set_type__.bind(this)).appendTo(this.footer.find("td")),this.rows=[],this.set_button__(),this.getBrowser().getLocalStorage()["BrowserTimings.enabled"]&&(this.enabled_=!0)},setEnabled:function(e){this.enabled_=e},getEnabled:function(){return this.enabled_.getValue()},set_enabled__:function(e){this.getBrowser().getBrowserOptions().getTimings()&&(this.getBrowser().getLocalStorage()["BrowserTimings.enabled"]=e.getValue(),e.getValue()?(this.element.fadeIn(),this.getBrowser().prepareEvents().addInterest("update",this),this.update()):(this.element.fadeOut(),this.getBrowser().prepareEvents().removeInterest("update",this)))},set_type__:function(){"MORE"===this.type?this.type="LESS":this.type="MORE",this.getBrowser().getLocalStorage()["BrowserTimings.type"]=this.type,this.set_button__(),this.build()},set_button__:function(){"MORE"===this.type?this.button.text(n("Less Properties")):this.button.text(n("More Properties"))},update:function(){var e=this.getBrowser().getCurrentTime();e-this.startTime>1?(this.build(),this.frames=0,this.startTime=e):++this.frames},build:function(){var t=this.getBrowser(),i=t.getCurrentTime(),s=navigator.language||navigator.userLanguage,o=this.localeOptions,a=this.rows,u=0;if(a[u++]=e("<tr></tr>").append(e("<td></td>").text(n("Frame rate")+":")).append(e("<td></td>").text(r(this.frames/(i-this.startTime)).toLocaleString(s,o)+" "+n("fps"))),a[u++]=e("<tr></tr>").append(e("<td></td>").text(n("Speed")+":")).append(e("<td></td>").text(r(this.getSpeed(t.currentSpeed)).toLocaleString(s,o)+" "+this.getSpeedUnit(t.currentSpeed))),"MORE"===this.type){for(var l=t.getWorld().getLayerSet().getLayers(),h=t.getActiveLayer(),c=t.systemTime,d=h&&t.getCollisionCount()?h.collisionTime:0,p=t.collisionTime+d,f=t.browserTime-(t.cameraTime+t.collisionTime+t.displayTime+d),g=t.prepareEvents().getInterests().size-1,m=t.sensorEvents().getInterests().size,_=0,x=0,y=0;y<l.length;++y){var v=l[y];_+=v.numOpaqueShapes,x+=v.numTransparentShapes}a[1].addClass("x_ite-private-more"),a[u++]=e("<tr></tr>").append(e("<td></td>").text(n("Browser")+":")).append(e("<td></td>").text(r(c).toLocaleString(s,o)+" "+n("ms"))),a[u++]=e("<tr></tr>").append(e("<td></td>").text(n("X3D")+":")).append(e("<td></td>").text(r(t.browserTime).toLocaleString(s,o)+" "+n("ms"))),a[u++]=e("<tr></tr>").append(e("<td></td>").text(n("Routing")+":")).append(e("<td></td>").text(r(f).toLocaleString(s,o)+" "+n("ms"))),a[u++]=e("<tr></tr>").append(e("<td></td>").text(n("Picking")+":")).append(e("<td></td>").text(r(t.pickingTime).toLocaleString(s,o)+" "+n("ms"))),a[u++]=e("<tr></tr>").append(e("<td></td>").text(n("Camera")+":")).append(e("<td></td>").text(r(t.cameraTime).toLocaleString(s,o)+" "+n("ms"))),a[u++]=e("<tr></tr>").append(e("<td></td>").text(n("Collision")+":")).append(e("<td></td>").text(r(p).toLocaleString(s,o)+" "+n("ms"))),a[u++]=e("<tr></tr>").append(e("<td></td>").text(n("Display")+":")).append(e("<td></td>").text(r(t.displayTime).toLocaleString(s,o)+" "+n("ms"))),a[u++]=e("<tr></tr>").append(e("<td></td>").text(n("Shapes")+":")).append(e("<td></td>").text(_+" + "+x)),a[u++]=e("<tr></tr>").append(e("<td></td>").text(n("Sensors")+":")).append(e("<td></td>").text(g+m))}a.length=u,this.header.find("th").text(n("Browser Timings")),this.body.empty(),this.body.append(a)},getSpeed:function(e){return e<15?e:3.6*e},getSpeedUnit:function(e){return n(e<15?"m/s":"km/h")}}),s}),function(e){"function"==typeof define&&define.amd?define("contextMenu/dist/jquery.contextMenu",["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){"use strict";function t(e){for(var t,i=e.split(/\s+/),n=[],r=0;t=i[r];r++)t=t.charAt(0).toUpperCase(),n.push(t);return n}function i(t){return t.id&&e('label[for="'+t.id+'"]').val()||t.name}function n(t,r,s){return s||(s=0),r.each(function(){var r,o,a=e(this),u=this,l=this.nodeName.toLowerCase();switch("label"===l&&a.find("input, textarea, select").length&&(r=a.text(),a=a.children().first(),u=a.get(0),l=u.nodeName.toLowerCase()),l){case"menu":o={name:a.attr("label"),items:{}},s=n(o.items,a.children(),s);break;case"a":case"button":o={name:a.text(),disabled:!!a.attr("disabled"),callback:function(){return function(){a.get(0).click()}}()};break;case"menuitem":case"command":switch(a.attr("type")){case void 0:case"command":case"menuitem":o={name:a.attr("label"),disabled:!!a.attr("disabled"),icon:a.attr("icon"),callback:function(){return function(){a.get(0).click()}}()};break;case"checkbox":o={type:"checkbox",disabled:!!a.attr("disabled"),name:a.attr("label"),selected:!!a.attr("checked")};break;case"radio":o={type:"radio",disabled:!!a.attr("disabled"),name:a.attr("label"),radio:a.attr("radiogroup"),value:a.attr("id"),selected:!!a.attr("checked")};break;default:o=void 0}break;case"hr":o="-------";break;case"input":switch(a.attr("type")){case"text":o={type:"text",name:r||i(u),disabled:!!a.attr("disabled"),value:a.val()};break;case"checkbox":o={type:"checkbox",name:r||i(u),disabled:!!a.attr("disabled"),selected:!!a.attr("checked")};break;case"radio":o={type:"radio",name:r||i(u),disabled:!!a.attr("disabled"),radio:!!a.attr("name"),value:a.val(),selected:!!a.attr("checked")};break;default:o=void 0}break;case"select":o={type:"select",name:r||i(u),disabled:!!a.attr("disabled"),selected:a.val(),options:{}},a.children().each(function(){o.options[this.value]=e(this).text()});break;case"textarea":o={type:"textarea",name:r||i(u),disabled:!!a.attr("disabled"),value:a.val()};break;case"label":break;default:o={type:"html",html:a.clone(!0)}}o&&(s++,t["key"+s]=o)}),s}e.support.htmlMenuitem="HTMLMenuItemElement"in window,e.support.htmlCommand="HTMLCommandElement"in window,e.support.eventSelectstart="onselectstart"in document.documentElement,e.ui&&e.widget||(e.cleanData=function(t){return function(i){var n,r,s;for(s=0;null!=i[s];s++){r=i[s];try{n=e._data(r,"events"),n&&n.remove&&e(r).triggerHandler("remove")}catch(e){}}t(i)}}(e.cleanData));var r=null,s=!1,o=e(window),a=0,u={},l={},h={},c={selector:null,appendTo:null,trigger:"right",autoHide:!1,delay:200,reposition:!0,hideOnSecondTrigger:!1,selectableSubMenu:!1,classNames:{hover:"context-menu-hover",disabled:"context-menu-disabled",visible:"context-menu-visible",notSelectable:"context-menu-not-selectable",icon:"context-menu-icon",iconEdit:"context-menu-icon-edit",iconCut:"context-menu-icon-cut",iconCopy:"context-menu-icon-copy",iconPaste:"context-menu-icon-paste",iconDelete:"context-menu-icon-delete",iconAdd:"context-menu-icon-add",iconQuit:"context-menu-icon-quit",iconLoadingClass:"context-menu-icon-loading"},determinePosition:function(t){if(e.ui&&e.ui.position)t.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none");else{var i=this.offset();i.top+=this.outerHeight(),i.left+=this.outerWidth()/2-t.outerWidth()/2,t.css(i)}},position:function(e,t,i){var n;if(!t&&!i)return void e.determinePosition.call(this,e.$menu);if("maintain"===t&&"maintain"===i)n=e.$menu.position();else{var r=e.$menu.offsetParent().offset();n={top:i-r.top,left:t-r.left}}var s=o.scrollTop()+o.height(),a=o.scrollLeft()+o.width(),u=e.$menu.outerHeight(),l=e.$menu.outerWidth();n.top+u>s&&(n.top-=u),n.top<0&&(n.top=0),n.left+l>a&&(n.left-=l),n.left<0&&(n.left=0),e.$menu.css(n)},positionSubmenu:function(t){if(void 0!==t)if(e.ui&&e.ui.position)t.css("display","block").position({my:"left top-5",at:"right top",of:this,collision:"flipfit fit"}).css("display","");else{var i={top:-9,left:this.outerWidth()-5};t.css(i)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{show:e.noop,hide:e.noop,activated:e.noop},callback:null,items:{}},d={timer:null,pageX:null,pageY:null},p=function(e){for(var t=0,i=e;;)if(t=Math.max(t,parseInt(i.css("z-index"),10)||0),!(i=i.parent())||!i.length||"html body".indexOf(i.prop("nodeName").toLowerCase())>-1)break;return t},f={abortevent:function(e){e.preventDefault(),e.stopImmediatePropagation()},contextmenu:function(t){var i=e(this);if("right"===t.data.trigger&&(t.preventDefault(),t.stopImmediatePropagation()),!("right"!==t.data.trigger&&"demand"!==t.data.trigger&&t.originalEvent||!(void 0===t.mouseButton||!t.data||"left"===t.data.trigger&&0===t.mouseButton||"right"===t.data.trigger&&2===t.mouseButton)||i.hasClass("context-menu-active")||i.hasClass("context-menu-disabled"))){if(r=i,t.data.build){var n=t.data.build(r,t);if(n===!1)return;if(t.data=e.extend(!0,{},c,t.data,n||{}),!t.data.items||e.isEmptyObject(t.data.items))throw window.console&&(console.error||console.log).call(console,"No items specified to show in contextMenu"),new Error("No Items specified");t.data.$trigger=r,g.create(t.data)}g.show.call(i,t.data,t.pageX,t.pageY)}},click:function(t){t.preventDefault(),t.stopImmediatePropagation(),e(this).trigger(e.Event("contextmenu",{data:t.data,pageX:t.pageX,pageY:t.pageY}))},mousedown:function(t){var i=e(this);r&&r.length&&!r.is(i)&&r.data("contextMenu").$menu.trigger("contextmenu:hide"),2===t.button&&(r=i.data("contextMenuActive",!0))},mouseup:function(t){var i=e(this);i.data("contextMenuActive")&&r&&r.length&&r.is(i)&&!i.hasClass("context-menu-disabled")&&(t.preventDefault(),t.stopImmediatePropagation(),r=i,i.trigger(e.Event("contextmenu",{data:t.data,pageX:t.pageX,pageY:t.pageY}))),i.removeData("contextMenuActive")},mouseenter:function(t){var i=e(this),n=e(t.relatedTarget),s=e(document);n.is(".context-menu-list")||n.closest(".context-menu-list").length||r&&r.length||(d.pageX=t.pageX,d.pageY=t.pageY,d.data=t.data,s.on("mousemove.contextMenuShow",f.mousemove),d.timer=setTimeout(function(){d.timer=null,s.off("mousemove.contextMenuShow"),r=i,i.trigger(e.Event("contextmenu",{data:d.data,pageX:d.pageX,pageY:d.pageY}))},t.data.delay))},mousemove:function(e){d.pageX=e.pageX,d.pageY=e.pageY},mouseleave:function(t){var i=e(t.relatedTarget);if(!i.is(".context-menu-list")&&!i.closest(".context-menu-list").length){try{clearTimeout(d.timer)}catch(e){}d.timer=null}},layerClick:function(t){var i,n,r=e(this),s=r.data("contextMenuRoot"),a=t.button,u=t.pageX,l=t.pageY,h=void 0===u;t.preventDefault(),setTimeout(function(){if(h)return void(null!==s&&void 0!==s&&null!==s.$menu&&void 0!==s.$menu&&s.$menu.trigger("contextmenu:hide"));var r,c="left"===s.trigger&&0===a||"right"===s.trigger&&2===a;if(document.elementFromPoint&&s.$layer){if(s.$layer.hide(),i=document.elementFromPoint(u-o.scrollLeft(),l-o.scrollTop()),i.isContentEditable){var d=document.createRange(),p=window.getSelection();d.selectNode(i),d.collapse(!0),p.removeAllRanges(),p.addRange(d)}e(i).trigger(t),s.$layer.show()}if(s.hideOnSecondTrigger&&c&&null!==s.$menu&&void 0!==s.$menu)return void s.$menu.trigger("contextmenu:hide");if(s.reposition&&c)if(document.elementFromPoint){if(s.$trigger.is(i))return void s.position.call(s.$trigger,s,u,l)}else if(n=s.$trigger.offset(),r=e(window),n.top+=r.scrollTop(),n.top<=t.pageY&&(n.left+=r.scrollLeft(),n.left<=t.pageX&&(n.bottom=n.top+s.$trigger.outerHeight(),n.bottom>=t.pageY&&(n.right=n.left+s.$trigger.outerWidth(),n.right>=t.pageX))))return void s.position.call(s.$trigger,s,u,l);i&&c&&s.$trigger.one("contextmenu:hidden",function(){e(i).contextMenu({x:u,y:l,button:a})}),null!==s&&void 0!==s&&null!==s.$menu&&void 0!==s.$menu&&s.$menu.trigger("contextmenu:hide")},50)},keyStop:function(e,t){t.isInput||e.preventDefault(),e.stopPropagation()},key:function(e){var t={};r&&(t=r.data("contextMenu")||{}),void 0===t.zIndex&&(t.zIndex=0);var i=0,n=function(e){""!==e.style.zIndex?i=e.style.zIndex:null!==e.offsetParent&&void 0!==e.offsetParent?n(e.offsetParent):null!==e.parentElement&&void 0!==e.parentElement&&n(e.parentElement)};if(n(e.target),!(t.$menu&&parseInt(i,10)>parseInt(t.$menu.css("zIndex"),10))){switch(e.keyCode){case 9:case 38:if(f.keyStop(e,t),t.isInput){if(9===e.keyCode&&e.shiftKey)return e.preventDefault(),t.$selected&&t.$selected.find("input, textarea, select").blur(),void(null!==t.$menu&&void 0!==t.$menu&&t.$menu.trigger("prevcommand"));if(38===e.keyCode&&"checkbox"===t.$selected.find("input, textarea, select").prop("type"))return void e.preventDefault()}else if(9!==e.keyCode||e.shiftKey)return void(null!==t.$menu&&void 0!==t.$menu&&t.$menu.trigger("prevcommand"));break;case 40:if(f.keyStop(e,t),!t.isInput)return void(null!==t.$menu&&void 0!==t.$menu&&t.$menu.trigger("nextcommand"));if(9===e.keyCode)return e.preventDefault(),t.$selected&&t.$selected.find("input, textarea, select").blur(),void(null!==t.$menu&&void 0!==t.$menu&&t.$menu.trigger("nextcommand"));if(40===e.keyCode&&"checkbox"===t.$selected.find("input, textarea, select").prop("type"))return void e.preventDefault();break;case 37:if(f.keyStop(e,t),t.isInput||!t.$selected||!t.$selected.length)break;if(!t.$selected.parent().hasClass("context-menu-root")){var s=t.$selected.parent().parent();return t.$selected.trigger("contextmenu:blur"),void(t.$selected=s)}break;case 39:if(f.keyStop(e,t),t.isInput||!t.$selected||!t.$selected.length)break;var o=t.$selected.data("contextMenu")||{};if(o.$menu&&t.$selected.hasClass("context-menu-submenu"))return t.$selected=null,o.$selected=null,void o.$menu.trigger("nextcommand");break;case 35:case 36:return t.$selected&&t.$selected.find("input, textarea, select").length?void 0:((t.$selected&&t.$selected.parent()||t.$menu).children(":not(."+t.classNames.disabled+", ."+t.classNames.notSelectable+")")[36===e.keyCode?"first":"last"]().trigger("contextmenu:focus"),void e.preventDefault());case 13:if(f.keyStop(e,t),t.isInput){if(t.$selected&&!t.$selected.is("textarea, select"))return void e.preventDefault();break}return void(void 0!==t.$selected&&null!==t.$selected&&t.$selected.trigger("mouseup"));case 32:case 33:case 34:return void f.keyStop(e,t);case 27:return f.keyStop(e,t),void(null!==t.$menu&&void 0!==t.$menu&&t.$menu.trigger("contextmenu:hide"));default:var a=String.fromCharCode(e.keyCode).toUpperCase();if(t.accesskeys&&t.accesskeys[a])return void t.accesskeys[a].$node.trigger(t.accesskeys[a].$menu?"contextmenu:focus":"mouseup")}e.stopPropagation(),void 0!==t.$selected&&null!==t.$selected&&t.$selected.trigger(e)}},prevItem:function(t){t.stopPropagation();var i=e(this).data("contextMenu")||{},n=e(this).data("contextMenuRoot")||{};if(i.$selected){var r=i.$selected;i=i.$selected.parent().data("contextMenu")||{},i.$selected=r}for(var s=i.$menu.children(),o=i.$selected&&i.$selected.prev().length?i.$selected.prev():s.last(),a=o;o.hasClass(n.classNames.disabled)||o.hasClass(n.classNames.notSelectable)||o.is(":hidden");)if(o=o.prev().length?o.prev():s.last(),o.is(a))return;i.$selected&&f.itemMouseleave.call(i.$selected.get(0),t),f.itemMouseenter.call(o.get(0),t);var u=o.find("input, textarea, select");u.length&&u.focus()},nextItem:function(t){t.stopPropagation();var i=e(this).data("contextMenu")||{},n=e(this).data("contextMenuRoot")||{};if(i.$selected){var r=i.$selected;i=i.$selected.parent().data("contextMenu")||{},i.$selected=r}for(var s=i.$menu.children(),o=i.$selected&&i.$selected.next().length?i.$selected.next():s.first(),a=o;o.hasClass(n.classNames.disabled)||o.hasClass(n.classNames.notSelectable)||o.is(":hidden");)if(o=o.next().length?o.next():s.first(),o.is(a))return;i.$selected&&f.itemMouseleave.call(i.$selected.get(0),t),f.itemMouseenter.call(o.get(0),t);var u=o.find("input, textarea, select");u.length&&u.focus()},focusInput:function(){var t=e(this).closest(".context-menu-item"),i=t.data(),n=i.contextMenu,r=i.contextMenuRoot;r.$selected=n.$selected=t,r.isInput=n.isInput=!0},blurInput:function(){var t=e(this).closest(".context-menu-item"),i=t.data(),n=i.contextMenu;i.contextMenuRoot.isInput=n.isInput=!1},menuMouseenter:function(){e(this).data().contextMenuRoot.hovering=!0},menuMouseleave:function(t){var i=e(this).data().contextMenuRoot;i.$layer&&i.$layer.is(t.relatedTarget)&&(i.hovering=!1)},itemMouseenter:function(t){var i=e(this),n=i.data(),r=n.contextMenu,s=n.contextMenuRoot;if(s.hovering=!0,t&&s.$layer&&s.$layer.is(t.relatedTarget)&&(t.preventDefault(),t.stopImmediatePropagation()),(r.$menu?r:s).$menu.children("."+s.classNames.hover).trigger("contextmenu:blur").children(".hover").trigger("contextmenu:blur"),i.hasClass(s.classNames.disabled)||i.hasClass(s.classNames.notSelectable))return void(r.$selected=null);i.trigger("contextmenu:focus")},itemMouseleave:function(t){var i=e(this),n=i.data(),r=n.contextMenu,s=n.contextMenuRoot;if(s!==r&&s.$layer&&s.$layer.is(t.relatedTarget))return void 0!==s.$selected&&null!==s.$selected&&s.$selected.trigger("contextmenu:blur"),t.preventDefault(),t.stopImmediatePropagation(),void(s.$selected=r.$selected=r.$node);r&&r.$menu&&r.$menu.hasClass("context-menu-visible")||i.trigger("contextmenu:blur")},itemClick:function(t){var i,n=e(this),r=n.data(),s=r.contextMenu,o=r.contextMenuRoot,a=r.contextMenuKey;if(!(!s.items[a]||n.is("."+o.classNames.disabled+", .context-menu-separator, ."+o.classNames.notSelectable)||n.is(".context-menu-submenu")&&o.selectableSubMenu===!1)){if(t.preventDefault(),t.stopImmediatePropagation(),e.isFunction(s.callbacks[a])&&Object.prototype.hasOwnProperty.call(s.callbacks,a))i=s.callbacks[a];else{if(!e.isFunction(o.callback))return;i=o.callback}i.call(o.$trigger,a,o,t)!==!1?o.$menu.trigger("contextmenu:hide"):o.$menu.parent().length&&g.update.call(o.$trigger,o)}},inputClick:function(e){e.stopImmediatePropagation()},hideMenu:function(t,i){var n=e(this).data("contextMenuRoot");g.hide.call(n.$trigger,n,i&&i.force)},focusItem:function(t){t.stopPropagation();var i=e(this),n=i.data(),r=n.contextMenu,s=n.contextMenuRoot;i.hasClass(s.classNames.disabled)||i.hasClass(s.classNames.notSelectable)||(i.addClass([s.classNames.hover,s.classNames.visible].join(" ")).parent().find(".context-menu-item").not(i).removeClass(s.classNames.visible).filter("."+s.classNames.hover).trigger("contextmenu:blur"),r.$selected=s.$selected=i,r&&r.$node&&r.$node.hasClass("context-menu-submenu")&&r.$node.addClass(s.classNames.hover),r.$node&&s.positionSubmenu.call(r.$node,r.$menu))},blurItem:function(t){t.stopPropagation();var i=e(this),n=i.data(),r=n.contextMenu,s=n.contextMenuRoot;r.autoHide&&i.removeClass(s.classNames.visible),i.removeClass(s.classNames.hover),r.$selected=null}},g={show:function(t,i,n){var s=e(this),o={};if(e("#context-menu-layer").trigger("mousedown"),t.$trigger=s,t.events.show.call(s,t)===!1)return void(r=null);if(g.update.call(s,t)===!1)return void(r=null);if(t.position.call(s,t,i,n),t.zIndex){var a=t.zIndex;"function"==typeof t.zIndex&&(a=t.zIndex.call(s,t)),o.zIndex=p(s)+a}g.layer.call(t.$menu,t,o.zIndex),t.$menu.find("ul").css("zIndex",o.zIndex+1),t.$menu.css(o)[t.animation.show](t.animation.duration,function(){s.trigger("contextmenu:visible"),g.activated(t),t.events.activated(t)}),s.data("contextMenu",t).addClass("context-menu-active"),e(document).off("keydown.contextMenu").on("keydown.contextMenu",f.key),t.autoHide&&e(document).on("mousemove.contextMenuAutoHide",function(e){var i=s.offset();i.right=i.left+s.outerWidth(),i.bottom=i.top+s.outerHeight(),!t.$layer||t.hovering||e.pageX>=i.left&&e.pageX<=i.right&&e.pageY>=i.top&&e.pageY<=i.bottom||setTimeout(function(){t.hovering||null===t.$menu||void 0===t.$menu||t.$menu.trigger("contextmenu:hide")},50)})},hide:function(t,i){var n=e(this);if(t||(t=n.data("contextMenu")||{}),i||!t.events||t.events.hide.call(n,t)!==!1){if(n.removeData("contextMenu").removeClass("context-menu-active"),t.$layer){setTimeout(function(e){return function(){e.remove()}}(t.$layer),10);try{delete t.$layer}catch(e){t.$layer=null}}r=null,t.$menu.find("."+t.classNames.hover).trigger("contextmenu:blur"),t.$selected=null,t.$menu.find("."+t.classNames.visible).removeClass(t.classNames.visible),e(document).off(".contextMenuAutoHide").off("keydown.contextMenu"),t.$menu&&t.$menu[t.animation.hide](t.animation.duration,function(){t.build&&(t.$menu.remove(),e.each(t,function(e){switch(e){case"ns":case"selector":case"build":case"trigger":return!0;default:t[e]=void 0;try{delete t[e]}catch(e){}return!0}})),setTimeout(function(){n.trigger("contextmenu:hidden")},10)})}},create:function(i,n){function r(t){var i=e("<span></span>");if(t._accesskey)t._beforeAccesskey&&i.append(document.createTextNode(t._beforeAccesskey)),e("<span></span>").addClass("context-menu-accesskey").text(t._accesskey).appendTo(i),t._afterAccesskey&&i.append(document.createTextNode(t._afterAccesskey));else if(t.isHtmlName){if(void 0!==t.accesskey)throw new Error("accesskeys are not compatible with HTML names and cannot be used together in the same item");i.html(t.name)}else i.text(t.name);return i}void 0===n&&(n=i),i.$menu=e('<ul class="context-menu-list"></ul>').addClass(i.className||"").data({contextMenu:i,contextMenuRoot:n}),e.each(["callbacks","commands","inputs"],function(e,t){i[t]={},n[t]||(n[t]={})}),n.accesskeys||(n.accesskeys={}),e.each(i.items,function(s,o){var a=e('<li class="context-menu-item"></li>').addClass(o.className||""),u=null,l=null;if(a.on("click",e.noop),"string"!=typeof o&&"cm_separator"!==o.type||(o={type:"cm_seperator"}),o.$node=a.data({contextMenu:i,contextMenuRoot:n,contextMenuKey:s}),void 0!==o.accesskey)for(var c,d=t(o.accesskey),p=0;c=d[p];p++)if(!n.accesskeys[c]){n.accesskeys[c]=o;var m=o.name.match(new RegExp("^(.*?)("+c+")(.*)$","i"));m&&(o._beforeAccesskey=m[1],o._accesskey=m[2],o._afterAccesskey=m[3]);break}if(o.type&&h[o.type])h[o.type].call(a,o,i,n),e.each([i,n],function(t,n){n.commands[s]=o,!e.isFunction(o.callback)||void 0!==n.callbacks[s]&&void 0!==i.type||(n.callbacks[s]=o.callback)});else{switch("cm_seperator"===o.type?a.addClass("context-menu-separator "+n.classNames.notSelectable):"html"===o.type?a.addClass("context-menu-html "+n.classNames.notSelectable):"sub"!==o.type&&o.type?(u=e("<label></label>").appendTo(a),r(o).appendTo(u),a.addClass("context-menu-input"),i.hasTypes=!0,e.each([i,n],function(e,t){t.commands[s]=o,t.inputs[s]=o})):o.items&&(o.type="sub"),o.type){case"cm_seperator":break;case"text":l=e('<input type="text" value="1" name="" />').attr("name","context-menu-input-"+s).val(o.value||"").appendTo(u);break;case"textarea":l=e('<textarea name=""></textarea>').attr("name","context-menu-input-"+s).val(o.value||"").appendTo(u),o.height&&l.height(o.height);break;case"checkbox":l=e('<input type="checkbox" value="1" name="" />').attr("name","context-menu-input-"+s).val(o.value||"").prop("checked",!!o.selected).prependTo(u);break;case"radio":l=e('<input type="radio" value="1" name="" />').attr("name","context-menu-input-"+o.radio).val(o.value||"").prop("checked",!!o.selected).prependTo(u);break;case"select":l=e('<select name=""></select>').attr("name","context-menu-input-"+s).appendTo(u),o.options&&(e.each(o.options,function(t,i){e("<option></option>").val(t).text(i).appendTo(l)}),l.val(o.selected));break;case"sub":r(o).appendTo(a),o.appendTo=o.$node,a.data("contextMenu",o).addClass("context-menu-submenu"),o.callback=null,"function"==typeof o.items.then?g.processPromises(o,n,o.items):g.create(o,n);break;case"html":e(o.html).appendTo(a);break;default:e.each([i,n],function(t,n){n.commands[s]=o,!e.isFunction(o.callback)||void 0!==n.callbacks[s]&&void 0!==i.type||(n.callbacks[s]=o.callback)}),r(o).appendTo(a)}o.type&&"sub"!==o.type&&"html"!==o.type&&"cm_seperator"!==o.type&&(l.on("focus",f.focusInput).on("blur",f.blurInput),o.events&&l.on(o.events,i)),o.icon&&(e.isFunction(o.icon)?o._icon=o.icon.call(this,this,a,s,o):"string"!=typeof o.icon||"fab "!==o.icon.substring(0,4)&&"fas "!==o.icon.substring(0,4)&&"far "!==o.icon.substring(0,4)&&"fal "!==o.icon.substring(0,4)?"string"==typeof o.icon&&"fa-"===o.icon.substring(0,3)?o._icon=n.classNames.icon+" "+n.classNames.icon+"--fa fa "+o.icon:o._icon=n.classNames.icon+" "+n.classNames.icon+"-"+o.icon:(a.addClass(n.classNames.icon+" "+n.classNames.icon+"--fa5"),o._icon=e('<i class="'+o.icon+'"></i>')),"string"==typeof o._icon?a.addClass(o._icon):a.prepend(o._icon))}o.$input=l,o.$label=u,a.appendTo(i.$menu),!i.hasTypes&&e.support.eventSelectstart&&a.on("selectstart.disableTextSelect",f.abortevent)}),i.$node||i.$menu.css("display","none").addClass("context-menu-root"),i.$menu.appendTo(i.appendTo||document.body)},resize:function(t,i){var n;t.css({position:"absolute",display:"block"}),t.data("width",(n=t.get(0)).getBoundingClientRect?Math.ceil(n.getBoundingClientRect().width):t.outerWidth()+1),t.css({position:"static",minWidth:"0px",maxWidth:"100000px"}),t.find("> li > ul").each(function(){g.resize(e(this),!0)}),i||t.find("ul").addBack().css({position:"",display:"",minWidth:"",maxWidth:""}).outerWidth(function(){return e(this).data("width")})},update:function(t,i){var n=this;void 0===i&&(i=t,g.resize(t.$menu));var r=!1
;return t.$menu.children().each(function(){var s,o=e(this),a=o.data("contextMenuKey"),u=t.items[a],l=e.isFunction(u.disabled)&&u.disabled.call(n,a,i)||u.disabled===!0;if(s=e.isFunction(u.visible)?u.visible.call(n,a,i):void 0===u.visible||u.visible===!0,s&&(r=!0),o[s?"show":"hide"](),o[l?"addClass":"removeClass"](i.classNames.disabled),e.isFunction(u.icon)){o.removeClass(u._icon);var h=u.icon.call(this,n,o,a,u);"string"==typeof h?o.addClass(h):o.prepend(h)}if(u.type)switch(o.find("input, select, textarea").prop("disabled",l),u.type){case"text":case"textarea":u.$input.val(u.value||"");break;case"checkbox":case"radio":u.$input.val(u.value||"").prop("checked",!!u.selected);break;case"select":u.$input.val((0===u.selected?"0":u.selected)||"")}if(u.$menu){g.update.call(n,u,i)&&(r=!0)}}),r},layer:function(t,i){var n=t.$layer=e('<div id="context-menu-layer"></div>').css({height:o.height(),width:o.width(),display:"block",position:"fixed","z-index":i,top:0,left:0,opacity:0,filter:"alpha(opacity=0)","background-color":"#000"}).data("contextMenuRoot",t).insertBefore(this).on("contextmenu",f.abortevent).on("mousedown",f.layerClick);return void 0===document.body.style.maxWidth&&n.css({position:"absolute",height:e(document).height()}),n},processPromises:function(e,t,i){function n(e,t,i){void 0===i&&r(void 0),s(e,t,i)}function r(e,t,i){void 0===i?(i={error:{name:"No items and no error item",icon:"context-menu-icon context-menu-icon-quit"}},window.console&&(console.error||console.log).call(console,'When you reject a promise, provide an "items" object, equal to normal sub-menu items')):"string"==typeof i&&(i={error:{name:i}}),s(e,t,i)}function s(e,t,i){void 0!==t.$menu&&t.$menu.is(":visible")&&(e.$node.removeClass(t.classNames.iconLoadingClass),e.items=i,g.create(e,t,!0),g.update(e,t),t.positionSubmenu.call(e.$node,e.$menu))}e.$node.addClass(t.classNames.iconLoadingClass),i.then(n.bind(this,e,t),r.bind(this,e,t))},activated:function(t){var i=t.$menu,n=i.offset(),r=e(window).height(),s=e(window).scrollTop(),o=i.height();o>r?i.css({height:r+"px","overflow-x":"hidden","overflow-y":"auto",top:s+"px"}):(n.top<s||n.top+o>s+r)&&i.css({top:s+"px"})}};e.fn.contextMenu=function(t){var i=this,n=t;if(this.length>0)if(void 0===t)this.first().trigger("contextmenu");else if(void 0!==t.x&&void 0!==t.y)this.first().trigger(e.Event("contextmenu",{pageX:t.x,pageY:t.y,mouseButton:t.button}));else if("hide"===t){var r=this.first().data("contextMenu")?this.first().data("contextMenu").$menu:null;r&&r.trigger("contextmenu:hide")}else"destroy"===t?e.contextMenu("destroy",{context:this}):e.isPlainObject(t)?(t.context=this,e.contextMenu("create",t)):t?this.removeClass("context-menu-disabled"):t||this.addClass("context-menu-disabled");else e.each(l,function(){this.selector===i.selector&&(n.data=this,e.extend(n.data,{trigger:"demand"}))}),f.contextmenu.call(n.target,n);return this},e.contextMenu=function(t,i){"string"!=typeof t&&(i=t,t="create"),"string"==typeof i?i={selector:i}:void 0===i&&(i={});var n=e.extend(!0,{},c,i||{}),r=e(document),o=r,h=!1;switch(n.context&&n.context.length?(o=e(n.context).first(),n.context=o.get(0),h=!e(n.context).is(document)):n.context=document,t){case"update":if(h)g.update(o);else for(var d in l)l.hasOwnProperty(d)&&g.update(l[d]);break;case"create":if(!n.selector)throw new Error("No selector specified");if(n.selector.match(/.context-menu-(list|item|input)($|\s)/))throw new Error('Cannot bind to selector "'+n.selector+'" as it contains a reserved className');if(!n.build&&(!n.items||e.isEmptyObject(n.items)))throw new Error("No Items specified");if(a++,n.ns=".contextMenu"+a,h||(u[n.selector]=n.ns),l[n.ns]=n,n.trigger||(n.trigger="right"),!s){var p="click"===n.itemClickEvent?"click.contextMenu":"mouseup.contextMenu",m={"contextmenu:focus.contextMenu":f.focusItem,"contextmenu:blur.contextMenu":f.blurItem,"contextmenu.contextMenu":f.abortevent,"mouseenter.contextMenu":f.itemMouseenter,"mouseleave.contextMenu":f.itemMouseleave};m[p]=f.itemClick,r.on({"contextmenu:hide.contextMenu":f.hideMenu,"prevcommand.contextMenu":f.prevItem,"nextcommand.contextMenu":f.nextItem,"contextmenu.contextMenu":f.abortevent,"mouseenter.contextMenu":f.menuMouseenter,"mouseleave.contextMenu":f.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",f.inputClick).on(m,".context-menu-item"),s=!0}switch(o.on("contextmenu"+n.ns,n.selector,n,f.contextmenu),h&&o.on("remove"+n.ns,function(){e(this).contextMenu("destroy")}),n.trigger){case"hover":o.on("mouseenter"+n.ns,n.selector,n,f.mouseenter).on("mouseleave"+n.ns,n.selector,n,f.mouseleave);break;case"left":o.on("click"+n.ns,n.selector,n,f.click);break;case"touchstart":o.on("touchstart"+n.ns,n.selector,n,f.click)}n.build||g.create(n);break;case"destroy":var _;if(h){var x=n.context;e.each(l,function(t,i){if(!i)return!0;if(!e(x).is(i.selector))return!0;_=e(".context-menu-list").filter(":visible"),_.length&&_.data().contextMenuRoot.$trigger.is(e(i.context).find(i.selector))&&_.trigger("contextmenu:hide",{force:!0});try{l[i.ns].$menu&&l[i.ns].$menu.remove(),delete l[i.ns]}catch(e){l[i.ns]=null}return e(i.context).off(i.ns),!0})}else if(n.selector){if(u[n.selector]){_=e(".context-menu-list").filter(":visible"),_.length&&_.data().contextMenuRoot.$trigger.is(n.selector)&&_.trigger("contextmenu:hide",{force:!0});try{l[u[n.selector]].$menu&&l[u[n.selector]].$menu.remove(),delete l[u[n.selector]]}catch(e){l[u[n.selector]]=null}r.off(u[n.selector])}}else r.off(".contextMenu .contextMenuAutoHide"),e.each(l,function(t,i){e(i.context).off(i.ns)}),u={},l={},a=0,s=!1,e("#context-menu-layer, .context-menu-list").remove();break;case"html5":(!e.support.htmlCommand&&!e.support.htmlMenuitem||"boolean"==typeof i&&i)&&e('menu[type="context"]').each(function(){this.id&&e.contextMenu({selector:"[contextmenu="+this.id+"]",items:e.contextMenu.fromMenu(this)})}).css("display","none");break;default:throw new Error('Unknown operation "'+t+'"')}return this},e.contextMenu.setInputValues=function(t,i){void 0===i&&(i={}),e.each(t.inputs,function(e,t){switch(t.type){case"text":case"textarea":t.value=i[e]||"";break;case"checkbox":t.selected=!!i[e];break;case"radio":t.selected=(i[t.radio]||"")===t.value;break;case"select":t.selected=i[e]||""}})},e.contextMenu.getInputValues=function(t,i){return void 0===i&&(i={}),e.each(t.inputs,function(e,t){switch(t.type){case"text":case"textarea":case"select":i[e]=t.$input.val();break;case"checkbox":i[e]=t.$input.prop("checked");break;case"radio":t.$input.prop("checked")&&(i[t.radio]=t.value)}}),i},e.contextMenu.fromMenu=function(t){var i=e(t),r={};return n(r,i.children()),r},e.contextMenu.defaults=c,e.contextMenu.types=h,e.contextMenu.handle=f,e.contextMenu.op=g,e.contextMenu.menus=l}),define("contextMenu",["contextMenu/dist/jquery.contextMenu"],function(e){return e}),define("x_ite/Components/Core/X3DNode",["x_ite/Basic/X3DBaseNode","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,getLayers:function(){return this.findParents(t.X3DLayerNode,this)},findParents:function(e,t){var i=[],n=new Set;return t.getParents().forEach(function(t){this.findParentsImpl(e,t,i,n)},this),i},findParentsImpl:function(i,n,r,s){if(!s.has(n.getId())){if(s.add(n.getId()),n instanceof e){for(var o=n.getType(),a=o.length-1;a>=0;--a){switch(o[a]){case t.X3DProtoDeclarationNode:case t.X3DNode:break;case t.LayerSet:case t.X3DBaseNode:case t.X3DMetadataObject:case t.X3DProgrammableShaderObject:case t.X3DScriptNode:return;default:continue}break}if(n.getType().indexOf(i)!==-1)return void r.push(n)}n.getParents().forEach(function(e){this.findParentsImpl(i,e,r,s)},this)}}}),i}),define("x_ite/Components/Core/X3DChildNode",["x_ite/Fields","x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants"],function(e,t,i){"use strict";function n(n){this.getExecutionContext()||(t.call(this,n),this.addType(i.X3DChildNode),this.addChildObjects("isCameraObject",new e.SFBool))}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,setCameraObject:function(e){e!==this.isCameraObject_.getValue()&&(this.isCameraObject_=e)},getCameraObject:function(){return this.isCameraObject_.getValue()}}),n}),define("x_ite/Components/Core/X3DBindableNode",["x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DBindableNode),this.layers=[]}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,initialize:function(){e.prototype.initialize.call(this),this.set_bind_.addInterest("set_bind__",this)},getCameraObject:function(){return!0},addLayer:function(e){this.layers.push(e)},transitionStart:function(){},set_bind__:function(){if(this.set_bind_.getValue()){this.layers=this.getLayers();for(var e=0;e<this.layers.length;++e)this.bindToLayer(this.layers[e])}else for(var e=0;e<this.layers.length;++e)this.unbindFromLayer(this.layers[e])}}),i}),define("x_ite/Components/Core/X3DSensorNode",["x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DSensorNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i}),i}),define("x_ite/Components/Time/X3DTimeDependentNode",["x_ite/Fields","x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(e,t,i){"use strict";function n(t){this.addType(i.X3DTimeDependentNode),this.addChildObjects("initialized",new e.SFTime,"isEvenLive",new e.SFBool),this.startTimeValue=0,this.pauseTimeValue=0,this.resumeTimeValue=0,this.stopTimeValue=0,this.start=0,this.pause=0,this.pauseInterval=0,this.startTimeout=null,this.pauseTimeout=null,this.resumeTimeout=null,this.stopTimeout=null,this.disabled=!1}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,initialize:function(){t.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this),this.isEvenLive_.addInterest("_set_live__",this),this.initialized_.addInterest("set_loop__",this),this.enabled_.addInterest("set_enabled__",this),this.loop_.addInterest("set_loop__",this),this.startTime_.addInterest("set_startTime__",this),this.pauseTime_.addInterest("set_pauseTime__",this),this.resumeTime_.addInterest("set_resumeTime__",this),this.stopTime_.addInterest("set_stopTime__",this),this.startTimeValue=this.startTime_.getValue(),this.pauseTimeValue=this.pauseTime_.getValue(),this.resumeTimeValue=this.resumeTime_.getValue(),this.stopTimeValue=this.stopTime_.getValue(),this.initialized_=this.getBrowser().getCurrentTime()},getDisabled:function(){return this.disabled},getElapsedTime:function(){return this.getBrowser().getCurrentTime()-this.start-this.pauseInterval},getLiveState:function(){return this.getLive()&&(this.getExecutionContext().isLive().getValue()||this.isEvenLive_.getValue())},set_live__:function(){this.isLive().getValue()?this.disabled&&(this.disabled=!1,this.isActive_.getValue()&&!this.isPaused_.getValue()&&this.real_resume()):this.disabled||!this.isActive_.getValue()||this.isPaused_.getValue()||(this.disabled=!0,this.real_pause())},set_enabled__:function(){this.enabled_.getValue()?this.set_loop__():this.stop()},set_loop__:function(){this.enabled_.getValue()&&this.loop_.getValue()&&this.stopTimeValue<=this.startTimeValue&&this.startTimeValue<=this.getBrowser().getCurrentTime()&&this.do_start()},set_startTime__:function(){this.startTimeValue=this.startTime_.getValue(),this.enabled_.getValue()&&(this.removeTimeout("startTimeout"),this.startTimeValue<=this.getBrowser().getCurrentTime()?this.do_start():this.addTimeout("startTimeout","do_start",this.startTimeValue))},set_pauseTime__:function(){if(this.pauseTimeValue=this.pauseTime_.getValue(),this.enabled_.getValue()){if(this.removeTimeout("pauseTimeout"),this.pauseTimeValue<=this.resumeTimeValue)return;this.pauseTimeValue<=this.getBrowser().getCurrentTime()?this.do_pause():this.addTimeout("pauseTimeout","do_pause",this.pauseTimeValue)}},set_resumeTime__:function(){if(this.resumeTimeValue=this.resumeTime_.getValue(),this.enabled_.getValue()){if(this.removeTimeout("resumeTimeout"),this.resumeTimeValue<=this.pauseTimeValue)return;this.resumeTimeValue<=this.getBrowser().getCurrentTime()?this.do_resume():this.addTimeout("resumeTimeout","do_resume",this.resumeTimeValue)}},set_stopTime__:function(){if(this.stopTimeValue=this.stopTime_.getValue(),this.enabled_.getValue()){if(this.removeTimeout("stopTimeout"),this.stopTimeValue<=this.startTimeValue)return;this.stopTimeValue<=this.getBrowser().getCurrentTime()?this.do_stop():this.addTimeout("stopTimeout","do_stop",this.stopTimeValue)}},do_start:function(){this.isActive_.getValue()||(this.start=this.getBrowser().getCurrentTime(),this.pauseInterval=0,this.isActive_=!0,this.set_start(),this.isLive().getValue()?this.getBrowser().timeEvents().addInterest("set_time",this):(this.disabled=!0,this.real_pause()),this.elapsedTime_=0,this.cycleTime_=this.getBrowser().getCurrentTime())},do_pause:function(){this.isActive_.getValue()&&!this.isPaused_.getValue()&&(this.isPaused_=!0,this.pauseTimeValue!==this.getBrowser().getCurrentTime()&&(this.pauseTimeValue=this.getBrowser().getCurrentTime()),this.isLive().getValue()&&this.real_pause())},real_pause:function(){this.pause=performance.now(),this.set_pause(),this.getBrowser().timeEvents().removeInterest("set_time",this)},do_resume:function(){this.isActive_.getValue()&&this.isPaused_.getValue()&&(this.isPaused_=!1,this.resumeTimeValue!==this.getBrowser().getCurrentTime()&&(this.resumeTimeValue=this.getBrowser().getCurrentTime()),this.isLive().getValue()&&this.real_resume())},real_resume:function(){var e=(performance.now()-this.pause)/1e3;this.pauseInterval+=e,this.set_resume(e),this.getBrowser().timeEvents().addInterest("set_time",this),this.getBrowser().addBrowserEvent()},do_stop:function(){this.stop()},stop:function(){this.isActive_.getValue()&&(this.set_stop(),this.elapsedTime_=this.getElapsedTime(),this.isPaused_.getValue()&&(this.isPaused_=!1),this.isActive_=!1,this.isLive().getValue()&&this.getBrowser().timeEvents().removeInterest("set_time",this))},timeout:function(e){this.enabled_.getValue()&&(this.getBrowser().advanceTime(performance.now()),this[e]())},addTimeout:function(e,t,i){this.removeTimeout(e),this[e]=setTimeout(this.timeout.bind(this,t),1e3*(i-this.getBrowser().getCurrentTime()))},removeTimeout:function(e){clearTimeout(this[e]),this[e]=null},set_start:function(){},set_pause:function(){},set_resume:function(){},set_stop:function(){},set_time:function(){}}),n}),define("x_ite/Components/Time/TimeSensor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DSensorNode","x_ite/Components/Time/X3DTimeDependentNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(t){n.call(this,t),r.call(this,t),this.addType(s.TimeSensor),this.addChildObjects("range",new e.MFFloat(0,0,1)),this.cycle=0,this.interval=0,this.fraction=0,this.first=0,this.last=1,this.scale=1}return o.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:o,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"enabled",new e.SFBool(!0)),new t(s.inputOutput,"cycleInterval",new e.SFTime(1)),new t(s.inputOutput,"loop",new e.SFBool),new t(s.inputOutput,"startTime",new e.SFTime),new t(s.inputOutput,"resumeTime",new e.SFTime),new t(s.inputOutput,"pauseTime",new e.SFTime),new t(s.inputOutput,"stopTime",new e.SFTime),new t(s.outputOnly,"isPaused",new e.SFBool),new t(s.outputOnly,"isActive",new e.SFBool),new t(s.outputOnly,"cycleTime",new e.SFTime),new t(s.outputOnly,"elapsedTime",new e.SFTime),new t(s.outputOnly,"fraction_changed",new e.SFFloat),new t(s.outputOnly,"time",new e.SFTime)]),getTypeName:function(){return"TimeSensor"},getComponentName:function(){return"Time"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this),this.cycleInterval_.addInterest("set_cycleInterval__",this),this.range_.addInterest("set_range__",this)},setRange:function(e,t,i){this.fraction=e>=1?0:e,this.first=t,this.last=i,this.scale=this.last-this.first;var n=(this.fraction-this.first)*this.cycleInterval_.getValue();this.interval=this.cycleInterval_.getValue()*this.scale,this.cycle=this.getBrowser().getCurrentTime()-n},set_cycleInterval__:function(){this.isActive_.getValue()&&this.setRange(this.fraction,this.range_[1],this.range_[2])},set_range__:function(){this.isActive_.getValue()&&(this.setRange(this.range_[0],this.range_[1],this.range_[2]),this.isPaused_.getValue()||this.set_fraction(this.getBrowser().getCurrentTime()))},set_start:function(){this.setRange(this.range_[0],this.range_[1],this.range_[2]),this.fraction_changed_=this.range_[0],this.time_=this.getBrowser().getCurrentTime()},set_resume:function(e){this.setRange(this.fraction,this.range_[1],this.range_[2])},set_fraction:function(e){var t=(e-this.cycle)/this.interval;this.fraction_changed_=this.fraction=this.first+(t-Math.floor(t))*this.scale},set_time:function(){var e=this.getBrowser().getCurrentTime();e-this.cycle>=this.interval?this.loop_.getValue()?this.interval&&(this.cycle+=this.interval*Math.floor((e-this.cycle)/this.interval),this.elapsedTime_=this.getElapsedTime(),this.cycleTime_=e,this.set_fraction(e)):(this.fraction_changed_=this.fraction=this.last,this.stop()):(this.elapsedTime_=this.getElapsedTime(),this.set_fraction(e)),this.time_=e}}),o}),define("x_ite/Components/Interpolation/X3DInterpolatorNode",["x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(e,t,i){"use strict";function n(i){e.call(this,i),this.addType(t.X3DInterpolatorNode)}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,setup:function(){this.set_key__(),this.key_.length&&this.interpolate(0,0,0),e.prototype.setup.call(this)},initialize:function(){e.prototype.initialize.call(this),this.set_fraction_.addInterest("set_fraction__",this),this.key_.addInterest("set_key__",this)},set_fraction__:function(){var e=this.key_,t=e.length,n=this.set_fraction_.getValue();switch(t){case 0:return;case 1:return this.interpolate(0,0,0);default:if(n<=e[0])return this.interpolate(0,1,0);var r=i.upperBound(e,0,t,n,i.less);if(r!==t){var s=r-1,o=(n-e[s])/(e[r]-e[s]);this.interpolate(s,r,i.clamp(o,0,1))}else this.interpolate(t-2,t-1,1)}},set_key__:function(){this.set_keyValue__()},set_keyValue__:function(){},interpolate:function(){}}),n}),define("x_ite/Components/Interpolation/EaseInEaseOut",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.EaseInEaseOut)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_fraction",new e.SFFloat),new t(r.inputOutput,"key",new e.MFFloat),new t(r.inputOutput,"easeInEaseOut",new e.MFVec2f),new t(r.outputOnly,"modifiedFraction_changed",new e.SFFloat)]),getTypeName:function(){return"EaseInEaseOut"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.easeInEaseOut_.addInterest("set_keyValue__",this)},set_keyValue__:function(){this.easeInEaseOut_.length<this.key_.length&&this.easeInEaseOut_.resize(this.key_.length,this.easeInEaseOut_.length?this.easeInEaseOut_[this.easeInEaseOut_.length-1]:new e.SFVec2f)},interpolate:function(e,t,i){var n=this.easeInEaseOut_[e].y,r=this.easeInEaseOut_[t].x,s=n+r;if(s<0)this.modifiedFraction_changed_=i;else{s>1&&(r/=s,n/=s);var o=1/(2-n-r);if(i<n)this.modifiedFraction_changed_=o/n*i*i;else if(i<=1-r)this.modifiedFraction_changed_=o*(2*i-n);else{var a=1-i;this.modifiedFraction_changed_=1-o*a*a/r}}}}),s}),define("x_ite/Components/Interpolation/PositionInterpolator",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.PositionInterpolator)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_fraction",new e.SFFloat),new t(r.inputOutput,"key",new e.MFFloat),new t(r.inputOutput,"keyValue",new e.MFVec3f),new t(r.outputOnly,"value_changed",new e.SFVec3f)]),getTypeName:function(){return"PositionInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){var t=this.key_,i=this.keyValue_;i.length<t.length&&i.resize(t.length,i.length?i[i.length-1]:new e.SFVec3f)},interpolate:function(){var e=new s(0,0,0);return function(t,i,n){this.value_changed_=e.assign(this.keyValue_[t].getValue()).lerp(this.keyValue_[i].getValue(),n)}}()}),o}),define("x_ite/Components/Interpolation/OrientationInterpolator",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Rotation4"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.OrientationInterpolator)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_fraction",new e.SFFloat),new t(r.inputOutput,"key",new e.MFFloat),new t(r.inputOutput,"keyValue",new e.MFRotation),new t(r.outputOnly,"value_changed",new e.SFRotation)]),getTypeName:function(){return"OrientationInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){var t=this.key_,i=this.keyValue_;i.length<t.length&&i.resize(t.length,i.length?i[i.length-1]:new e.SFRotation)},interpolate:function(){var e=new s(0,0,1,0),t=new s(0,0,1,0);return function(i,n,r){try{e.assign(this.keyValue_[i].getValue()),t.assign(this.keyValue_[n].getValue()),this.value_changed_=e.slerp(t,r)}catch(e){console.log(e)}}}()}),o}),define("x_ite/Bits/TraverseType",[],function(){"use strict";var e=0,t={POINTER:e++,CAMERA:e++,COLLISION:e++,DEPTH:e++,DISPLAY:e++};return Object.preventExtensions(t),Object.freeze(t),Object.seal(t),t}),define("x_ite/Components/Navigation/X3DViewpointNode",["x_ite/Fields","x_ite/Components/Core/X3DBindableNode","x_ite/Components/Time/TimeSensor","x_ite/Components/Interpolation/EaseInEaseOut","x_ite/Components/Interpolation/PositionInterpolator","x_ite/Components/Interpolation/OrientationInterpolator","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r,s,o,a,u,l,h,c){"use strict";function d(o){t.call(this,o),this.addType(a.X3DViewpointNode),this.addChildObjects("positionOffset",new e.SFVec3f,"orientationOffset",new e.SFRotation,"scaleOffset",new e.SFVec3f(1,1,1),"scaleOrientationOffset",new e.SFRotation,"centerOfRotationOffset",new e.SFVec3f,"fieldOfViewScale",new e.SFFloat(1)),this.userPosition=new l(0,1,0),this.userOrientation=new h(0,0,1,0),this.userCenterOfRotation=new l(0,0,0),this.modelMatrix=new c,this.cameraSpaceMatrix=new c(1,0,0,0,0,1,0,0,0,0,1,0,0,0,10,1),this.inverseCameraSpaceMatrix=new c(1,0,0,0,0,1,0,0,0,0,1,0,0,0,-10,1);var u=this.getBrowser();this.timeSensor=new i(u.getPrivateScene()),this.easeInEaseOut=new n(u.getPrivateScene()),this.positionInterpolator=new r(u.getPrivateScene()),this.orientationInterpolator=new s(u.getPrivateScene()),this.scaleInterpolator=new r(u.getPrivateScene()),this.scaleOrientationInterpolator=new s(u.getPrivateScene())}return d.prototype=Object.assign(Object.create(t.prototype),{constructor:d,initialize:function(){t.prototype.initialize.call(this),this.timeSensor.stopTime_=1,this.timeSensor.setup(),this.easeInEaseOut.key_=new e.MFFloat(0,1),this.easeInEaseOut.easeInEaseOut_=new e.MFVec2f(new e.SFVec2f(0,0),new e.SFVec2f(0,0)),this.easeInEaseOut.setup(),this.positionInterpolator.key_=new e.MFFloat(0,1),this.orientationInterpolator.key_=new e.MFFloat(0,1),this.scaleInterpolator.key_=new e.MFFloat(0,1),this.scaleOrientationInterpolator.key_=new e.MFFloat(0,1),this.positionInterpolator.setup(),this.orientationInterpolator.setup(),this.scaleInterpolator.setup(),this.scaleOrientationInterpolator.setup(),this.timeSensor.fraction_changed_.addFieldInterest(this.easeInEaseOut.set_fraction_),this.easeInEaseOut.modifiedFraction_changed_.addFieldInterest(this.positionInterpolator.set_fraction_),this.easeInEaseOut.modifiedFraction_changed_.addFieldInterest(this.orientationInterpolator.set_fraction_),this.easeInEaseOut.modifiedFraction_changed_.addFieldInterest(this.scaleInterpolator.set_fraction_),this.easeInEaseOut.modifiedFraction_changed_.addFieldInterest(this.scaleOrientationInterpolator.set_fraction_),this.positionInterpolator.value_changed_.addFieldInterest(this.positionOffset_),this.orientationInterpolator.value_changed_.addFieldInterest(this.orientationOffset_),this.scaleInterpolator.value_changed_.addFieldInterest(this.scaleOffset_),this.scaleOrientationInterpolator.value_changed_.addFieldInterest(this.scaleOrientationOffset_),this.isBound_.addInterest("set_bound__",this)},getEaseInEaseOut:function(){return this.easeInEaseOut},setInterpolators:function(){},bindToLayer:function(e){e.getViewpointStack().push(this)},unbindFromLayer:function(e){e.getViewpointStack().pop(this)},removeFromLayer:function(e){e.getViewpointStack().remove(this)},getPosition:function(){return this.position_.getValue()},getUserPosition:function(){return this.userPosition.assign(this.getPosition()).add(this.positionOffset_.getValue())},getOrientation:function(){return this.orientation_.getValue()},getUserOrientation:function(){return this.userOrientation.assign(this.getOrientation()).multRight(this.orientationOffset_.getValue())},getCenterOfRotation:function(){return this.centerOfRotation_.getValue()},getUserCenterOfRotation:function(){return this.userCenterOfRotation.assign(this.getCenterOfRotation()).add(this.centerOfRotationOffset_.getValue())},getProjectionMatrix:function(e){var t=e.getNavigationInfo();return this.getProjectionMatrixWithLimits(t.getNearValue(),t.getFarValue(this),e.getLayer().getViewport().getRectangle(e.getBrowser()))},getCameraSpaceMatrix:function(){return this.cameraSpaceMatrix},getInverseCameraSpaceMatrix:function(){return this.inverseCameraSpaceMatrix},getModelMatrix:function(){return this.modelMatrix},getMaxFarValue:function(){return this.getBrowser().getRenderingProperty("LogarithmicDepthBuffer")?1e10:1e5},getUpVector:function(){return l.yAxis},getSpeedFactor:function(){return 1},setAnimate:function(e){this.animate=e},getAnimate:function(){return this.animate},transitionStart:function(){var t=new l(0,0,0),i=new h(0,0,1,0),n=new l(0,0,0),r=new h(0,0,1,0);return function(s){try{if(this.jump_.getValue()){var o=this.getLayers();this.retainUserOffsets_.getValue()||this.resetUserOffsets();for(var a=0;a<o.length;++a){var u=o[a].getNavigationInfo();u.transitionStart_=!0;var l=u.getTransitionType(),h=u.transitionTime_.getValue()}switch("2.0"==this.getExecutionContext().getSpecificationVersion()&&(l=this.getAnimate()?"LINEAR":"TELEPORT"),this.setAnimate(!1),l){case"TELEPORT":for(var a=0;a<o.length;++a)o[a].getNavigationInfo().transitionComplete_=!0;return;case"ANIMATE":this.easeInEaseOut.easeInEaseOut_=new e.MFVec2f(new e.SFVec2f(0,1),new e.SFVec2f(1,0));break;default:this.easeInEaseOut.easeInEaseOut_=new e.MFVec2f(new e.SFVec2f(0,0),new e.SFVec2f(0,0))}this.timeSensor.cycleInterval_=h,this.timeSensor.stopTime_=this.getBrowser().getCurrentTime(),this.timeSensor.startTime_=this.getBrowser().getCurrentTime(),this.timeSensor.isActive_.addInterest("set_active__",this),this.getRelativeTransformation(s,t,i,n,r),this.positionInterpolator.keyValue_=new e.MFVec3f(t,this.positionOffset_),this.orientationInterpolator.keyValue_=new e.MFRotation(i,this.orientationOffset_),this.scaleInterpolator.keyValue_=new e.MFVec3f(n,this.scaleOffset_),this.scaleOrientationInterpolator.keyValue_=new e.MFRotation(r,this.scaleOrientationOffset_),this.positionOffset_=t,this.orientationOffset_=i,this.scaleOffset_=n,this.scaleOrientationOffset_=r,this.setInterpolators(s)}else this.getRelativeTransformation(s,t,i,n,r),this.positionOffset_=t,this.orientationOffset_=i,this.scaleOffset_=n,this.scaleOrientationOffset_=r,this.setInterpolators(s)}catch(e){console.log(e)}}}(),transitionStop:function(){this.timeSensor.stopTime_=this.getBrowser().getCurrentTime(),this.timeSensor.isActive_.removeInterest("set_active__",this)},resetUserOffsets:function(){this.positionOffset_=l.Zero,this.orientationOffset_=h.Identity,this.scaleOffset_=l.One,this.scaleOrientationOffset_=h.Identity,this.centerOfRotationOffset_=l.Zero,this.fieldOfViewScale_=1},getRelativeTransformation:function(e,t,i,n,r){this.modelMatrix.copy().multRight(e.getInverseCameraSpaceMatrix()).inverse().get(t,i,n,r),t.subtract(this.getPosition()),i.assign(this.getOrientation().copy().inverse().multRight(i))},lookAtPoint:function(e,t,i){try{if(!this.getBrowser().getActiveLayer())return;this.getCameraSpaceMatrix().multVecMatrix(e),c.inverse(this.getModelMatrix()).multVecMatrix(e);var n=2*this.getBrowser().getActiveLayer().getNavigationInfo().getNearValue();this.lookAt(e,n,t,i)}catch(e){console.error(e)}},lookAtBBox:function(e,t,i){try{if(!this.getBrowser().getActiveLayer())return;e=e.copy().multRight(c.inverse(this.getModelMatrix()));var n=2*this.getBrowser().getActiveLayer().getNavigationInfo().getNearValue();this.lookAt(e.center,n,t,i)}catch(e){}},lookAt:function(t,i,n,r){var s=this.getLayers(),o=t.copy().add(this.getUserOrientation().multVecRot(new l(0,0,i))).subtract(this.getPosition());s.forEach(function(e){e.getNavigationInfo().transitionStart_=!0}),this.timeSensor.cycleInterval_=.2,this.timeSensor.stopTime_=this.getBrowser().getCurrentTime(),this.timeSensor.startTime_=this.getBrowser().getCurrentTime(),this.timeSensor.isActive_.addInterest("set_active__",this),this.easeInEaseOut.easeInEaseOut_=new e.MFVec2f(new e.SFVec2f(0,1),new e.SFVec2f(1,0));var a=l.lerp(this.positionOffset_.getValue(),o,n),u=l.add(this.getPosition(),a).subtract(t),c=h.multRight(this.orientationOffset_.getValue(),new h(this.getUserOrientation().multVecRot(new l(0,0,1)),u));r&&(c=h.inverse(this.getOrientation()).multRight(this.straightenHorizon(h.multRight(this.getOrientation(),c)))),this.positionInterpolator.keyValue_=new e.MFVec3f(this.positionOffset_,a),this.orientationInterpolator.keyValue_=new e.MFRotation(this.orientationOffset_,c),this.scaleInterpolator.keyValue_=new e.MFVec3f(this.scaleOffset_,this.scaleOffset_),this.scaleOrientationInterpolator.keyValue_=new e.MFRotation(this.scaleOrientationOffset_,this.scaleOrientationOffset_),this.setInterpolators(this),this.centerOfRotationOffset_=l.subtract(t,this.getCenterOfRotation()),this.set_bind_=!0},straighten:function(t){this.getLayers().forEach(function(e){e.getNavigationInfo().transitionStart_=!0}),this.timeSensor.cycleInterval_=.4,this.timeSensor.stopTime_=this.getBrowser().getCurrentTime(),this.timeSensor.startTime_=this.getBrowser().getCurrentTime(),this.timeSensor.isActive_.addInterest("set_active__",this),this.easeInEaseOut.easeInEaseOut_=new e.MFVec2f(new e.SFVec2f(0,1),new e.SFVec2f(1,0))
;var i=h.multRight(h.inverse(this.getOrientation()),this.straightenHorizon(this.getUserOrientation()));this.positionInterpolator.keyValue_=new e.MFVec3f(this.positionOffset_,this.positionOffset_),this.orientationInterpolator.keyValue_=new e.MFRotation(this.orientationOffset_,i),this.scaleInterpolator.keyValue_=new e.MFVec3f(this.scaleOffset_,this.scaleOffset_),this.scaleOrientationInterpolator.keyValue_=new e.MFRotation(this.scaleOrientationOffset_,this.scaleOrientationOffset_),this.setInterpolators(this),this.set_bind_=!0},straightenHorizon:function(){var e=new l(0,0,0),t=new l(0,0,0),i=(new l(0,0,0),new h(0,0,1,0));return function(n){n.multVecRot(e.assign(l.xAxis).negate()),n.multVecRot(t.assign(l.zAxis));var r=t.cross(this.getUpVector());return r.equals(l.Zero)?n:(i.setFromToVec(e,r),n.multRight(i))}}(),set_active__:function(e){if(!e.getValue()&&1===this.timeSensor.fraction_changed_.getValue()){for(var t=this.getLayers(),i=0;i<t.length;++i)t[i].getNavigationInfo().transitionComplete_=!0;this.easeInEaseOut.set_fraction_=1}},set_bound__:function(){this.isBound_.getValue()?this.getBrowser().getNotification().string_=this.description_:this.timeSensor.stopTime_=this.getBrowser().getCurrentTime()},traverse:function(e,t){t.getLayer().getViewpoints().push(this),this.modelMatrix.assign(t.getModelViewMatrix().get())},update:function(){try{this.cameraSpaceMatrix.set(this.getUserPosition(),this.getUserOrientation(),this.scaleOffset_.getValue(),this.scaleOrientationOffset_.getValue()),this.cameraSpaceMatrix.multRight(this.modelMatrix),this.inverseCameraSpaceMatrix.assign(this.cameraSpaceMatrix).inverse()}catch(e){console.log(e)}}}),d}),define("standard/Math/Geometry/Spheroid3",[],function(){"use strict";function e(e,t){switch(arguments.length){case 0:this.semiMajorAxis=0,this.semiMinorAxis=0;break;case 2:this.semiMajorAxis=e,this.semiMinorAxis=t;break;case 3:var i=arguments[1];this.semiMajorAxis=e,this.semiMinorAxis=e*(1-1/i)}}return e.prototype={constructor:e,getSemiMajorAxis:function(){return this.semiMajorAxis},getSemiMinorAxis:function(){return this.semiMinorAxis},toString:function(){return this.semiMajorAxis+" "+this.semiMinorAxis}},e}),define("standard/Geospatial/ReferenceEllipsoids",["standard/Math/Geometry/Spheroid3"],function(e){"use strict";return{AA:new e(6377563.396,299.3249646,!0),AM:new e(6377340.189,299.3249646,!0),AN:new e(6378160,298.25,!0),BN:new e(6377483.865,299.1528128,!0),BR:new e(6377397.155,299.1528128,!0),CC:new e(6378206.4,294.9786982,!0),CD:new e(6378249.145,293.465,!0),EA:new e(6377276.345,300.8017,!0),EB:new e(6377298.556,300.8017,!0),EC:new e(6377301.243,300.8017,!0),ED:new e(6377295.664,300.8017,!0),EE:new e(6377304.063,300.8017,!0),EF:new e(6377309.613,300.8017,!0),FA:new e(6378155,298.3,!0),HE:new e(6378200,298.3,!0),HO:new e(6378270,297,!0),ID:new e(6378160,298.247,!0),IN:new e(6378388,297,!0),KA:new e(6378245,298.3,!0),RF:new e(6378137,298.257222101,!0),SA:new e(6378160,298.25,!0),WD:new e(6378135,298.26,!0),WE:new e(6378137,298.257223563,!0),SUN:new e(696342e3,1/9e-6,!0),MERCURY:new e(2439700,2439700),VENUS:new e(6051800,6051800),MOON:new e(1738140,1735970),MARS:new e(3395428,3377678),JUPITER:new e(71492e3,66854e3),SATURN:new e(60268e3,54364e3),URANUS:new e(2555e3,24973e3),NEPTUNE:new e(24764e3,24341e3),PLUTO:new e(1153e3,1153e3)}}),define("standard/Geospatial/Geodetic",["standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(e,t){"use strict";function i(e,t,i){this.longitudeFirst=!t,this.degrees=!i,this.a=e.getSemiMajorAxis(),this.c=e.getSemiMinorAxis(),this.c2a2=Math.pow(e.getSemiMinorAxis()/this.a,2),this.ecc2=1-this.c2a2}return i.prototype={constructor:i,convert:function(e,t){var i=e.z;if(this.longitudeFirst)var n=e.y,r=e.x;else var n=e.x,r=e.y;return this.degrees&&(n*=Math.PI/180,r*=Math.PI/180),this.convertRadians(n,r,i,t)},convertRadians:function(e,t,i,n){var r=Math.sin(e),s=Math.pow(r,2),o=Math.cos(e),a=this.a/Math.sqrt(1-this.ecc2*s),u=(a+i)*o;return n.set(u*Math.cos(t),u*Math.sin(t),(a*this.c2a2+i)*r)},apply:function(e,t){if(this.applyRadians(e,t),this.degrees&&(t.x*=180/Math.PI,t.y*=180/Math.PI),this.longitudeFirst){var i=t.x;t.x=t.y,t.y=i}return t},applyRadians:function(e,t){var i=e.x,n=e.y,r=e.z,s=Math.sqrt(i*i+n*n);if(0==s)return t.set(Math.PI,0,r-this.c);for(var o=0,a=Math.atan2(n,i),u=0,l=this.a,h=l,c=this.ecc2,d=0;d<30;++d){var p=u,f=o;o=Math.atan(r/s/(1-c*h/(h+u)));var g=Math.sin(o);if(h=l/Math.sqrt(1-c*g*g),u=s/Math.cos(o)-h,Math.abs(u-p)<.001&&Math.abs(o-f)<1e-10)break}return t.set(o,a,u)},normal:function(e,t){var i=this.applyRadians(e,t),n=i.x,r=i.y,s=Math.cos(n),o=Math.cos(r)*s,a=Math.sin(r)*s,u=Math.sin(n);return t.set(o,a,u)}},i}),define("standard/Geospatial/UniversalTransverseMercator",["standard/Geospatial/Geodetic","standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(e,t,i){"use strict";function n(t,n,s,o){var a=t.getSemiMajorAxis(),u=1-Math.pow(t.getSemiMinorAxis()/a,2),l=u/(1-u),h=(1-Math.sqrt(1-u))/(1+Math.sqrt(1-u));this.southernHemisphere=!s,this.eastingFirst=!o,this.a=a,this.ecc2=u,this.EE=l,this.E8=8*l,this.E9=9*l,this.E252=252*l,this.e1=h,this.A=r*(a*(1-u/4-3*u*u/64-5*u*u*u/256)),this.B=3*h/2-7*h*h*h/32,this.C=21*h*h/16-55*h*h*h*h/32,this.D=151*h*h*h/96,this.E=a*(1-u),this.W=1-u/4-3*u*u/64-5*u*u*u/256,this.X=3*u/8+3*u*u/32+45*u*u*u/1024,this.Y=15*u*u/256+45*u*u*u/1024,this.Z=35*u*u*u/3072,this.longitude0=i.radians(6*n-183),this.geodeticConverter=new e(t,!0,!0)}var r=.9996;return n.prototype={constructor:n,convert:function(e,t){if(this.eastingFirst)var i=e.y,n=e.x;else var i=e.x,n=e.y;var s=this.southernHemisphere;i<0&&(s=!this.southernHemisphere,i=-i),s&&(i-=1e7),n-=5e5;var o=i/this.A,a=o+this.B*Math.sin(2*o)+this.C*Math.sin(4*o)+this.D*Math.sin(6*o),u=Math.pow(Math.sin(a),2),l=Math.cos(a),h=Math.tan(a),c=this.a/Math.sqrt(1-this.ecc2*u),d=Math.pow(h,2),p=Math.pow(h,8),f=this.EE*d,g=f*f,m=this.E/Math.pow(1-this.ecc2*u,1.5),_=n/(c*r),x=(5+3*d+10*f-4*g-this.E9)*Math.pow(_,4)/24,y=(61+90*d+298*f+45*p-this.E252-3*g)*Math.pow(_,6)/720,v=(5-2*f+28*d-3*g+this.E8+24*p)*Math.pow(_,5)/120,w=a-c*h/m*(_*_/2-x+y),b=this.longitude0+(_-(1+2*d+f)*Math.pow(_,3)/6+v)/l;return this.geodeticConverter.convertRadians(w,b,e.z,t)},apply:function(e,t){var i=this.geodeticConverter.applyRadians(e,t),n=i.x,s=i.y,o=Math.tan(n),a=Math.cos(n),u=this.EE,l=this.a/Math.sqrt(1-this.ecc2*Math.pow(Math.sin(n),2)),h=o*o,c=h*h*h,d=u*a*a,p=a*(s-this.longitude0),f=this.a*(this.W*n-this.X*Math.sin(2*n)+this.Y*Math.sin(4*n)-this.Z*Math.sin(6*n)),g=r*l*(p+(1-h+d)*Math.pow(p,3)/6+(5-18*c+72*d-58*u)*Math.pow(p,5)/120)+5e5,m=r*(f+l*o*(p*p/2+(5-h+9*d+4*d*d)*Math.pow(p,4)/24+(61-58*c+600*d-330*u)*Math.pow(p,6)/720));return n<0?(m+=1e7,this.southernHemisphere||(m=-m)):this.southernHemisphere&&(m=-m),this.eastingFirst?t.set(g,m,i.z):t.set(m,g,i.z)}},n}),define("x_ite/Browser/Geospatial/Geocentric",["standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(e,t){"use strict";function i(){}return i.prototype={constructor:i,convert:function(e,t){return t.assign(e)},apply:function(e,t){return t.assign(e)},slerp:function(e,i,n){var r=e.abs(),s=i.abs();return e.normalize(),i.normalize(),t.simpleSlerp(e,i,n).multiply(t.lerp(r,s,n))}},i}),define("x_ite/Browser/Geospatial/Geospatial",["standard/Geospatial/ReferenceEllipsoids","standard/Geospatial/Geodetic","standard/Geospatial/UniversalTransverseMercator","x_ite/Browser/Geospatial/Geocentric"],function(e,t,i,n){"use strict";var r=0,s=r++,o=r++,a=r++,u={GD:s,GDC:s,UTM:o,GC:a,GCC:a,GS:a};return{GD:s,UTM:o,GC:a,getReferenceFrame:function(r,u){switch(this.getCoordinateSystem(r)){case s:return new t(this.getEllipsoid(r),this.getLatitudeFirst(r),u);case o:return new i(this.getEllipsoid(r),this.getZone(r),this.getNorthernHemisphere(r),this.getNorthingFirst(r));case a:return new n}return new t(e.WE,!0,u)},getElevationFrame:function(e,i){return new t(this.getEllipsoid(e),!0,i)},getCoordinateSystem:function(e){for(var t=0,i=e.length;t<i;++t){var n=u[e[t]];if(void 0!==n)return n}return s},getEllipsoid:function(t){for(var i=0,n=t.length;i<n;++i){var r=e[t[i]];if(void 0!==r)return r}return e.WE},getEllipsoidString:function(t){for(var i=0,n=t.length;i<n;++i){if(void 0!==e[t[i]])return t[i]}return"WE"},isStandardOrder:function(e){switch(this.getCoordinateSystem(e)){case s:return this.getLatitudeFirst(e);case o:return this.getNorthingFirst(e);case a:return!0}return this.getLatitudeFirst(e)},getLatitudeFirst:function(e){for(var t=0,i=e.length;t<i;++t)if("longitude_first"===e[t])return!1;return!0},getNorthingFirst:function(e){for(var t=0,i=e.length;t<i;++t)if("easting_first"===e[t])return!1;return!0},getZone:function(e){for(var t=0,i=e.length;t<i;++t){var n=e[t].match(/^Z(\d+)$/);if(n)return parseInt(n[1])}return 1},getNorthernHemisphere:function(e){for(var t=0,i=e.length;t<i;++t)if("S"===e[t])return!1;return!0}}}),define("x_ite/Bits/X3DCast",["x_ite/Fields"],function(e){"use strict";return function(t,i){try{if(i&&(i instanceof e.SFNode&&(i=i.getValue()),i&&(i=i.getInnerNode(),i.getType().indexOf(t)!==-1)))return i}catch(e){}return null}}),define("x_ite/Components/Geospatial/X3DGeospatialObject",["x_ite/Bits/X3DConstants","x_ite/Browser/Geospatial/Geospatial","x_ite/Bits/X3DCast","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r){"use strict";function s(t){this.addType(e.X3DGeospatialObject),this.radians=!1,this.origin=new n(0,0,0),this.originMatrix=new r,this.invOriginMatrix=new r}function o(e,t){return this.invOriginMatrix.multVecMatrix(this.referenceFrame.convert(e,t))}function a(e,t){return this.referenceFrame.apply(this.originMatrix.multVecMatrix(c.assign(e)),t)}function u(e,t){return this.invOriginMatrix.multDirMatrix(this.elevationFrame.normal(this.originMatrix.multVecMatrix(c.assign(e)),t))}function l(e,t){return h.call(this,e,t).multRight(this.invOriginMatrix)}function h(e,t){return this.referenceFrame.convert(e,p),this.elevationFrame.normal(p,g),f.set(0,0,1).cross(g),f.equals(n.Zero)&&f.set(1,0,0),m.assign(f).cross(g),f.normalize(),m.normalize(),t.set(f.x,f.y,f.z,0,g.x,g.y,g.z,0,m.x,m.y,m.z,0,p.x,p.y,p.z,1)}var c=new n(0,0,0),d=new n(0,0,0),p=new n(0,0,0),f=new n(0,0,0),g=new n(0,0,0),m=new n(0,0,0);return s.prototype={constructor:s,initialize:function(){this.geoSystem_.addInterest("set_geoSystem__",this),this.geoOrigin_.addInterest("set_geoOrigin__",this),this.set_geoSystem__(),this.set_geoOrigin__()},set_geoSystem__:function(){this.coordinateSystem=t.getCoordinateSystem(this.geoSystem_),this.referenceFrame=t.getReferenceFrame(this.geoSystem_,this.radians),this.elevationFrame=t.getElevationFrame(this.geoSystem_,this.radians),this.standardOrder=t.isStandardOrder(this.geoSystem_)},set_geoOrigin__:function(){this.geoOriginNode&&(this.geoOriginNode.removeInterest("set_origin__",this),this.geoOriginNode.removeInterest("set_rotateYUp__",this),this.geoOriginNode.removeInterest("addNodeEvent",this)),this.geoOriginNode=i(e.GeoOrigin,this.geoOrigin_),this.geoOriginNode&&(this.geoOriginNode.addInterest("set_origin__",this),this.geoOriginNode.addInterest("set_rotateYUp__",this),this.geoOriginNode.addInterest("addNodeEvent",this)),this.set_origin__(),this.set_rotateYUp__()},set_origin__:function(){this.geoOriginNode?this.geoOriginNode.getOrigin(this.origin):this.origin.set(0,0,0),this.set_originMatrix__()},set_originMatrix__:function(){try{if(this.geoOriginNode){var e=this.origin;this.elevationFrame.normal(e,g),f.set(0,0,1).cross(g),f.equals(n.Zero)&&f.set(1,0,0),m.assign(f).cross(g),f.normalize(),m.normalize(),this.originMatrix.set(f.x,f.y,f.z,0,g.x,g.y,g.z,0,m.x,m.y,m.z,0,e.x,e.y,e.z,1),this.invOriginMatrix.assign(this.originMatrix).inverse()}}catch(e){}},set_rotateYUp__:function(){this.geoOriginNode&&this.geoOriginNode.rotateYUp_.getValue()?(this.getCoord=o,this.getGeoCoord=a,this.getGeoUpVector=u,this.getLocationMatrix=l):(delete this.getCoord,delete this.getGeoCoord,delete this.getGeoUpVector,delete this.getLocationMatrix)},getReferenceFrame:function(){return this.referenceFrame},getStandardOrder:function(){return this.standardOrder},getCoord:function(e,t){return this.referenceFrame.convert(e,t).subtract(this.origin)},getGeoCoord:function(e,t){return this.referenceFrame.apply(c.assign(e).add(this.origin),t)},getGeoElevation:function(e){return this.getGeoCoord(e,d).z},getGeoUpVector:function(e,t){return this.elevationFrame.normal(c.assign(e).add(this.origin),t)},getLocationMatrix:function(e,t){var i=this.origin,n=h.call(this,e,t);return n[12]-=i.x,n[13]-=i.y,n[14]-=i.z,n}},s}),define("x_ite/Components/Interpolation/ScalarInterpolator",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.ScalarInterpolator)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_fraction",new e.SFFloat),new t(r.inputOutput,"key",new e.MFFloat),new t(r.inputOutput,"keyValue",new e.MFFloat),new t(r.outputOnly,"value_changed",new e.SFFloat)]),getTypeName:function(){return"ScalarInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){var e=this.key_,t=this.keyValue_;t.length<e.length&&t.resize(e.length,t.length?t[t.length-1]:0)},interpolate:function(e,t,i){this.value_changed_=s.lerp(this.keyValue_[e],this.keyValue_[t],i)}}),o}),define("x_ite/Components/Navigation/NavigationInfo",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DBindableNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(s.NavigationInfo),this.addChildObjects("transitionStart",new e.SFBool,"transitionActive",new e.SFBool,"availableViewers",new e.MFString,"viewer",new e.SFString("EXAMINE")),this.avatarSize_.setUnit("length"),this.speed_.setUnit("speed"),this.visibilityLimit_.setUnit("speed")}var a={TELEPORT:!0,LINEAR:!0,ANIMATE:!0};return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOnly,"set_bind",new e.SFBool),new t(s.inputOutput,"type",new e.MFString("EXAMINE","ANY")),new t(s.inputOutput,"avatarSize",new e.MFFloat(.25,1.6,.75)),new t(s.inputOutput,"speed",new e.SFFloat(1)),new t(s.inputOutput,"headlight",new e.SFBool(!0)),new t(s.inputOutput,"visibilityLimit",new e.SFFloat),new t(s.inputOutput,"transitionType",new e.MFString("LINEAR")),new t(s.inputOutput,"transitionTime",new e.SFTime(1)),new t(s.outputOnly,"transitionComplete",new e.SFBool),new t(s.outputOnly,"isBound",new e.SFBool),new t(s.outputOnly,"bindTime",new e.SFTime)]),getTypeName:function(){return"NavigationInfo"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.type_.addInterest("set_type__",this),this.headlight_.addInterest("set_headlight__",this),this.transitionStart_.addInterest("set_transitionStart__",this),this.transitionComplete_.addInterest("set_transitionComplete__",this),this.isBound_.addInterest("set_isBound__",this),this.set_type__(),this.set_headlight__()},getViewer:function(){return this.viewer_.getValue()},getCollisionRadius:function(){return this.avatarSize_.length>0&&this.avatarSize_[0]>0?this.avatarSize_[0]:.25},getAvatarHeight:function(){return this.avatarSize_.length>1?this.avatarSize_[1]:1.6},getStepHeight:function(){return this.avatarSize_.length>2?this.avatarSize_[2]:.75},getNearValue:function(){var e=this.getCollisionRadius();return 0===e?1e-5:e/2},getFarValue:function(e){return this.visibilityLimit_.getValue()?this.visibilityLimit_.getValue():e.getMaxFarValue()},getTransitionType:function(){for(var e=0,t=this.transitionType_.length;e<t;++e){var i=this.transitionType_[e];if(a[i])return i}return"LINEAR"},set_type__:function(){this.availableViewers_.length=0;var e=!1,t=!1,i=!1,n=!1,r=!1,s=!1;this.viewer_="EXAMINE";for(var o=0;o<this.type_.length;++o){var a=this.type_[o];switch(a){case"EXAMINE":case"WALK":case"FLY":case"LOOKAT":case"PLANE":case"NONE":this.viewer_=a;break;case"PLANE_create3000.de":this.viewer_="PLANE";break;default:continue}break}if(this.type_.length)for(var o=0;o<this.type_.length;++o){var a=this.type_[o];switch(a){case"EXAMINE":e=!0;continue;case"WALK":t=!0;continue;case"FLY":i=!0;continue;case"LOOKAT":s=!0;continue;case"PLANE":n=!0;continue;case"NONE":r=!0;continue}if("ANY"==a){e=!0,t=!0,i=!0,n=!0,r=!0,s=!0;break}e=!0}else e=!0,t=!0,i=!0,n=!0,r=!0,s=!0;e&&this.availableViewers_.push("EXAMINE"),t&&this.availableViewers_.push("WALK"),i&&this.availableViewers_.push("FLY"),n&&this.availableViewers_.push("PLANE"),s&&this.availableViewers_.push("LOOKAT"),r&&this.availableViewers_.push("NONE")},set_headlight__:function(){this.headlight_.getValue()?delete this.enable:this.enable=Function.prototype},set_transitionStart__:function(){this.transitionActive_.getValue()||(this.transitionActive_=!0)},set_transitionComplete__:function(){this.transitionActive_.getValue()&&(this.transitionActive_=!1)},set_isBound__:function(){this.isBound_.getValue()||this.transitionActive_.getValue()&&(this.transitionActive_=!1)},bindToLayer:function(e){e.getNavigationInfoStack().push(this)},unbindFromLayer:function(e){e.getNavigationInfoStack().pop(this)},removeFromLayer:function(e){e.getNavigationInfoStack().remove(this)},enable:function(e,t){e===r.DISPLAY&&this.headlight_.getValue()&&t.getGlobalLights().push(t.getBrowser().getHeadlight())},traverse:function(e,t){t.getLayer().getNavigationInfos().push(this)}}),o}),define("standard/Math/Geometry/Camera",["standard/Math/Numbers/Vector3"],function(e){"use strict";var t=new e(0,0,0),i=new e(0,0,0);return{frustum:function(e,t,i,n,r,s,o){var a=t-e,u=n-i,l=s-r,h=2*r,c=(t+e)/a,d=(n+i)/u,p=-(s+r)/l,f=-h*s/l,g=h/a,m=h/u;return o.set(g,0,0,0,0,m,0,0,c,d,p,-1,0,0,f,0)},perspective:function(e,t,i,n,r,s){var o=Math.tan(e/2)*t;if(n>r){var a=n*o/r;return this.frustum(-a,a,-o,o,t,i,s)}var a=r*o/n;return this.frustum(-o,o,-a,a,t,i,s)},perspective2:function(e,t,i,n,r,s){var o=Math.tan(e/2)*t;return this.frustum(-o,o,-o,o,t,i,s)},ortho:function(e,t,i,n,r,s,o){var a=t-e,u=n-i,l=s-r,h=2/a,c=2/u,d=-2/l,p=-(t+e)/a,f=-(n+i)/u,g=-(s+r)/l;return o.set(h,0,0,0,0,c,0,0,0,0,d,0,p,f,g,1)},orthoBox:function(e,n){return e.getExtents(t,i),this.ortho(t.x,i.x,t.y,i.y,-i.z,-t.z,n)}}}),define("x_ite/Components/Geospatial/GeoViewpoint",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Navigation/X3DViewpointNode","x_ite/Components/Geospatial/X3DGeospatialObject","x_ite/Components/Interpolation/ScalarInterpolator","x_ite/Components/Navigation/NavigationInfo","x_ite/Bits/X3DConstants","standard/Math/Geometry/Camera","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Algorithm"],function(e,t,i,n,r,s,o,a,u,l,h,c,d){"use strict";function p(e,t){n.prototype.traverse.call(this,e,t),this.navigationInfoNode.traverse(e,t)}function f(e){switch(n.call(this,e),r.call(this,e),this.addType(a.GeoViewpoint),this.centerOfRotation_.setUnit("length"),this.fieldOfView_.setUnit("angle"),this.navigationInfoNode=new o(e),this.fieldOfViewInterpolator=new s(this.getBrowser().getPrivateScene()),this.projectionMatrix=new c,this.position=new l,this.elevation=0,e.specificationVersion){case"2.0":case"3.0":case"3.1":case"3.2":this.traverse=p}}var g=new l(0,0,1),m=new l(0,0,0),_=new l(0,0,0),x=new l(0,0,0),y=new c,v=new l(0,0,0),w=new h(0,0,1,0),b=new l(0,0,0),S=new l(0,0,0),C=new h(0,0,1,0);return f.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:f,fieldDefinitions:new i([new t(a.inputOutput,"metadata",new e.SFNode),new t(a.initializeOnly,"geoOrigin",new e.SFNode),new t(a.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new t(a.inputOnly,"set_bind",new e.SFBool),new t(a.inputOutput,"description",new e.SFString),new t(a.inputOutput,"position",new e.SFVec3d(0,0,1e5)),new t(a.inputOutput,"orientation",new e.SFRotation),new t(a.inputOutput,"centerOfRotation",new e.SFVec3d),new t(a.inputOutput,"fieldOfView",new e.SFFloat(.7854)),new t(a.inputOutput,"jump",new e.SFBool(!0)),new t(a.inputOutput,"retainUserOffsets",new e.SFBool),new t(a.inputOutput,"navType",new e.MFString("EXAMINE","ANY")),new t(a.inputOutput,"headlight",new e.SFBool(!0)),new t(a.initializeOnly,"speedFactor",new e.SFFloat(1)),new t(a.outputOnly,"isBound",new e.SFBool),new t(a.outputOnly,"bindTime",new e.SFTime)]),getTypeName:function(){return"GeoViewpoint"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this),this.position_.addInterest("set_position__",this),this.positionOffset_.addInterest("set_position__",this),this.navType_.addFieldInterest(this.navigationInfoNode.type_),this.headlight_.addFieldInterest(this.navigationInfoNode.headlight_),this.navigationInfoNode.setup(),this.set_position__(),this.fieldOfViewInterpolator.key_=[0,1],this.fieldOfViewInterpolator.setup(),this.getEaseInEaseOut().modifiedFraction_changed_.addFieldInterest(this.fieldOfViewInterpolator.set_fraction_),this.fieldOfViewInterpolator.value_changed_.addFieldInterest(this.fieldOfViewScale_)},setInterpolators:function(e){if(e.getType().indexOf(a.GeoViewpoint)<0)this.fieldOfViewInterpolator.keyValue_=[this.fieldOfViewScale_.getValue(),this.fieldOfViewScale_.getValue()];else{var t=e.getFieldOfView()/this.fieldOfView_.getValue();this.fieldOfViewInterpolator.keyValue_=[t,this.fieldOfViewScale_.getValue()],this.fieldOfViewScale_=t}},setPosition:function(e){this.position_.setValue(this.getGeoCoord(e,S))},getPosition:function(){return this.getCoord(this.position_.getValue(),v)},set_position__:function(){this.getCoord(this.position_.getValue(),this.position),this.elevation=this.getGeoElevation(v.assign(this.position).add(this.positionOffset_.getValue()))},setOrientation:function(e){var t=this.getLocationMatrix(this.position_.getValue(),y).submatrix;C.setMatrix(t),this.orientation_.setValue(C.inverse().multLeft(e))},getOrientation:function(){var e=this.getLocationMatrix(this.position_.getValue(),y).submatrix;return w.setMatrix(e),w.multLeft(this.orientation_.getValue())},getCenterOfRotation:function(){return this.getCoord(this.centerOfRotation_.getValue(),b)},getFieldOfView:function(){var e=this.fieldOfView_*this.fieldOfViewScale_;return e>0&&e<Math.PI?e:Math.PI/4},getMaxFarValue:function(){return this.getBrowser().getRenderingProperty("LogarithmicDepthBuffer")?1e10:1e9},getUpVector:function(){return this.getGeoUpVector.call(this,v.assign(this.position).add(this.positionOffset_.getValue()),x)},getSpeedFactor:function(){return(Math.max(this.elevation,0)+10)/10*this.speedFactor_.getValue()},getScreenScale:function(e,t){var i=t[2],n=t[3],r=2*Math.tan(this.getFieldOfView()/2)*e.abs();return r*=Math.abs(_.assign(e).normalize().dot(g)),r/=i>n?n:i,m.set(r,r,r)},getLookAtDistance:function(e){return e.size.abs()/2/Math.tan(this.getFieldOfView()/2)},getProjectionMatrixWithLimits:function(e,t,i,n){if(n||this.getBrowser().getRenderingProperty("LogarithmicDepthBuffer"))return u.perspective(this.getFieldOfView(),e,t,i[2],i[3],this.projectionMatrix);var r=Math.max(d.lerp(Math.min(e,1e4),1e4,this.elevation/1e7),1),s=Math.max(d.lerp(1e6,Math.max(t,1e6),this.elevation/1e7),1e6);return u.perspective(this.getFieldOfView(),r,s,i[2],i[3],this.projectionMatrix)}}),f}),define("lib/jquery.fullscreen-min",["jquery"],function(e){function t(e){var t,i;return this.length?(t=this[0],t.ownerDocument?i=t.ownerDocument:(i=t,t=i.documentElement),null==e?i.exitFullscreen||i.webkitExitFullscreen||i.webkitCancelFullScreen||i.msExitFullscreen||i.mozCancelFullScreen?(e=!!(i.fullscreenElement||i.msFullscreenElement||i.webkitIsFullScreen||i.mozFullScreen),e?i.fullscreenElement||i.webkitFullscreenElement||i.webkitCurrentFullScreenElement||i.msFullscreenElement||i.mozFullScreenElement||e:e):null:(e?(e=t.requestFullscreen||t.webkitRequestFullscreen||t.webkitRequestFullScreen||t.msRequestFullscreen||t.mozRequestFullScreen)&&e.call(t):(e=i.exitFullscreen||i.webkitExitFullscreen||i.webkitCancelFullScreen||i.msExitFullscreen||i.mozCancelFullScreen)&&e.call(i),this)):this}e.fn.fullScreen=t,e.fn.toggleFullScreen=function(){return t.call(this,!t.call(this))};var i,n,r;i=document,i.webkitCancelFullScreen?(n="webkitfullscreenchange",r="webkitfullscreenerror"):i.msExitFullscreen?(n="MSFullscreenChange",r="MSFullscreenError"):i.mozCancelFullScreen?(n="mozfullscreenchange",r="mozfullscreenerror"):(n="fullscreenchange",r="fullscreenerror"),e(document).bind(n,function(){e(document).trigger(new e.Event("fullscreenchange"))}),e(document).bind(r,function(){e(document).trigger(new e.Event("fullscreenerror"))})}),define("x_ite/Browser/Core/ContextMenu",["jquery","contextMenu","x_ite/Basic/X3DBaseNode","x_ite/Components/Geospatial/GeoViewpoint","locale/gettext","lib/jquery.fullscreen-min"],function(e,t,i,n,r){"use strict";function s(e){i.call(this,e)}return e("head").append('<style>.x_ite-private-menu-title:before { content: "'+r("X_ITE Browser")+'" }</style>'),s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,getTypeName:function(){return"ContextMenu"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"contextMenu"},initialize:function(){i.prototype.initialize.call(this),this.getBrowser().getBrowserOptions().getContextMenu()&&e.contextMenu({selector:".x_ite-private-surface-"+this.getBrowser().getId(),build:this.build.bind(this)})},build:function(t,i){var s=this.getBrowser().getActiveLayer(),o=s?s.getViewpoint():null,a=this.getBrowser().viewer_.getValue(),u=this.getBrowser().getElement().fullScreen(),l={className:"x_ite-private-menu x_ite-private-menu-title",items:{separator0:"--------",viewpoints:{name:r("Viewpoints"),className:"context-menu-icon x_ite-private-icon-viewpoint",items:this.getViewpoints(),callback:function(t){e("body > ul.context-menu-list").fadeOut(500),t&&(this.getBrowser().bindViewpoint(t),this.getBrowser().getElement().focus())}.bind(this,o)},separator1:"--------",viewer:{name:r(this.getViewerName(a)),className:"context-menu-icon x_ite-private-icon-"+a.toLowerCase()+"-viewer",callback:function(t){e("body > ul.context-menu-list").fadeOut(500),this.getBrowser().viewer_=t,this.getBrowser().getNotification().string_=r(this.getViewerName(t)),this.getBrowser().getElement().focus()}.bind(this,a)},"available-viewers":{name:r("Available Viewers"),items:this.getAvailableViewers()},"straighten-horizon":{name:r("Straighten Horizon"),type:"checkbox",selected:this.getBrowser().getBrowserOption("StraightenHorizon"),events:{click:function(){e("body > ul.context-menu-list").fadeOut(500);var t=!this.getBrowser().getBrowserOption("StraightenHorizon");if(this.getBrowser().setBrowserOption("StraightenHorizon",t),t){this.getBrowser().getNotification().string_=r("Straighten Horizon")+": "+r("on");var i=this.getBrowser().getActiveViewpoint();i&&i.straighten(!0)}else this.getBrowser().getNotification().string_=r("Straighten Horizon")+": "+r("off")}.bind(this)}},separator2:"--------","primitive-quality":{name:r("Primitive Quality"),className:"context-menu-icon x_ite-private-icon-primitive-quality",items:{high:{name:r("High"),type:"radio",radio:"primitive-quality",selected:"HIGH"===this.getBrowser().getBrowserOption("PrimitiveQuality"),events:{click:function(){e("body > ul.context-menu-list").fadeOut(500),this.getBrowser().setBrowserOption("PrimitiveQuality","HIGH"),this.getBrowser().getNotification().string_=r("Primitive Quality")+": "+r("high")}.bind(this)}},medium:{name:r("Medium"),type:"radio",radio:"primitive-quality",selected:"MEDIUM"===this.getBrowser().getBrowserOption("PrimitiveQuality"),events:{click:function(){e("body > ul.context-menu-list").fadeOut(500),this.getBrowser().setBrowserOption("PrimitiveQuality","MEDIUM"),this.getBrowser().getNotification().string_=r("Primitive Quality")+": "+r("medium")}.bind(this)}},low:{name:r("Low"),type:"radio",radio:"primitive-quality",selected:"LOW"===this.getBrowser().getBrowserOption("PrimitiveQuality"),events:{click:function(){e("body > ul.context-menu-list").fadeOut(500),this.getBrowser().setBrowserOption("PrimitiveQuality","LOW"),this.getBrowser().getNotification().string_=r("Primitive Quality")+": "+r("low")}.bind(this)}}}},"texture-quality":{name:r("Texture Quality"),className:"context-menu-icon x_ite-private-icon-texture-quality",items:{high:{name:r("High"),type:"radio",radio:"texture-quality",selected:"HIGH"===this.getBrowser().getBrowserOption("TextureQuality"),events:{click:function(){e("body > ul.context-menu-list").fadeOut(500),this.getBrowser().setBrowserOption("TextureQuality","HIGH"),this.getBrowser().getNotification().string_=r("Texture Quality")+": "+r("high")}.bind(this)}},medium:{name:r("Medium"),type:"radio",radio:"texture-quality",selected:"MEDIUM"===this.getBrowser().getBrowserOption("TextureQuality"),events:{click:function(){e("body > ul.context-menu-list").fadeOut(500),this.getBrowser().setBrowserOption("TextureQuality","MEDIUM"),this.getBrowser().getNotification().string_=r("Texture Quality")+": "+r("medium")}.bind(this)}},low:{name:r("Low"),type:"radio",radio:"texture-quality",selected:"LOW"===this.getBrowser().getBrowserOption("TextureQuality"),events:{click:function(){e("body > ul.context-menu-list").fadeOut(500),this.getBrowser().setBrowserOption("TextureQuality","LOW"),this.getBrowser().getNotification().string_=r("Texture Quality")+": "+r("low")}.bind(this)}}}},"display-rubberband":{name:r("Display Rubberband"),type:"checkbox",selected:this.getBrowser().getBrowserOption("Rubberband"),events:{click:function(){e("body > ul.context-menu-list").fadeOut(500);var t=!this.getBrowser().getBrowserOption("Rubberband");this.getBrowser().setBrowserOption("Rubberband",t),this.getBrowser().getNotification().string_=t?r("Rubberband")+": "+r("on"):r("Rubberband")+": "+r("off")}.bind(this)}},"browser-timings":this.getBrowser().getBrowserOptions().getTimings()?{name:r("Browser Timings"),type:"checkbox",selected:this.getBrowser().getBrowserTimings().getEnabled(),events:{click:function(){e("body > ul.context-menu-list").fadeOut(500),this.getBrowser().getBrowserTimings().setEnabled(!this.getBrowser().getBrowserTimings().getEnabled()),this.getBrowser().getElement().focus()}.bind(this)}}:void 0,"mute-browser":{name:r("Mute Browser"),type:"checkbox",selected:this.getBrowser().mute_.getValue(),events:{click:function(){e("body > ul.context-menu-list").fadeOut(500);var t=!this.getBrowser().mute_.getValue();this.getBrowser().mute_=t,this.getBrowser().getNotification().string_=r(t?"Browser muted":"Browser unmuted")}.bind(this)}},fullscreen:{name:r(u?"Leave Fullscreen":"Fullscreen"),className:"context-menu-icon "+(u?"x_ite-private-icon-leave-fullscreen":"x_ite-private-icon-fullscreen"),callback:function(){e("body > ul.context-menu-list").fadeOut(500),this.getBrowser().getElement().toggleFullScreen()}.bind(this)},separator3:"--------",about:{name:r("About X_ITE"),className:"context-menu-icon x_ite-private-icon-help-about",callback:function(){e("body > ul.context-menu-list").fadeOut(500),window.open("http://create3000.de/x_ite/")}}}};return e.isEmptyObject(l.items.viewpoints.items)&&(delete l.items.separator0,delete l.items.viewpoints),Object.keys(l.items["available-viewers"].items).length<2&&delete l.items["available-viewers"],("EXAMINE"!=this.getBrowser().getCurrentViewer()||this.getBrowser().getActiveViewpoint()instanceof n)&&delete l.items["straighten-horizon"],l},getViewpoints:function(){
var t=this.getBrowser().getActiveLayer();if(!t)return{};for(var i=this.getBrowser().getBrowserOption("EnableInlineViewpoints"),n=this.getBrowser().currentScene,r=t.getViewpoints().get(),s=t.getViewpoint(),o={},a=0;a<r.length;++a){var u=r[a],l=u.description_.getValue();if(""!==l&&(i||u.getScene()===n)){var h={name:l,callback:function(t){e("body > ul.context-menu-list").fadeOut(500),this.getBrowser().bindViewpoint(t),this.getBrowser().getElement().focus()}.bind(this,u)};u===s&&(h.className="context-menu-selected"),o["Viewpoint"+u.getId()]=h}}return o},getAvailableViewers:function(){for(var t=this.getBrowser().viewer_.getValue(),i=this.getBrowser().availableViewers_,n={},s=0;s<i.length;++s){var o=i[s];n[o]={name:r(this.getViewerName(o)),className:"context-menu-icon x_ite-private-icon-"+o.toLowerCase()+"-viewer",callback:function(t){e("body > ul.context-menu-list").fadeOut(500),this.getBrowser().viewer_=t,this.getBrowser().getNotification().string_=r(this.getViewerName(t)),this.getBrowser().getElement().focus()}.bind(this,o)},o===t&&(n[o].className+=" context-menu-selected")}return n},getViewerName:function(e){switch(e){case"EXAMINE":return r("Examine Viewer");case"WALK":return r("Walk Viewer");case"FLY":return r("Fly Viewer");case"PLANE":return r("Plane Viewer");case"LOOKAT":return r("Look At Viewer");case"NONE":return r("None Viewer")}}}),s}),define("x_ite/Configuration/X3DInfoArray",[],function(){"use strict";function e(){return this.array=[],this.index={},new Proxy(this,t)}var t={get:function(e,t){var i=e[t];return void 0!==i?i:(i=e.array[t],void 0!==i?i:e.index[t])},set:function(e,t,i){return!1},has:function(e,t){return t in e.array||t in e.index},enumerate:function(e){return Object.keys(e.array)[Symbol.iterator]()}};return Object.assign(e.prototype,{constructor:e,add:function(e,t){this.array.push(t),this.index[e]=t},get:function(e){return this.index[e]},getValue:function(){return this.array},toXMLStream:function(e){for(var t=this.array,i=0,n=t.length;i<n;++i)try{t[i].toXMLStream(e),e.string+="\n"}catch(e){}}}),e}),define("x_ite/Configuration/ComponentInfo",["x_ite/Fields","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(e,t,i){"use strict";function n(e,t){this.name=t.name,this.level=t.level,this.title=t.title,this.providerUrl=t.providerUrl,Object.preventExtensions(this),Object.freeze(this),Object.seal(this)}return Object.assign(n.prototype,{constructor:n,toXMLStream:function(e){var t=i.Get(e);e.string+=t.Indent(),e.string+="<component",e.string+=" ",e.string+="name='",e.string+=this.name,e.string+="'",e.string+=" ",e.string+="level='",e.string+=this.level,e.string+="'",e.string+="/>"}}),n}),define("x_ite/Configuration/ComponentInfoArray",["x_ite/Configuration/X3DInfoArray","x_ite/Configuration/ComponentInfo"],function(e,t){"use strict";function i(t,i){this.browser=t;var n=e.call(this);if(i)for(var r=0,s=i.length;r<s;++r)this.add(i[r].name,i[r]);return n}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,addComponentInfo:function(e){this.add(e.name,new t(this.browser,e))}}),i}),define("x_ite/Execution/ImportedNode",["x_ite/Fields","x_ite/Basic/X3DBaseNode","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(e,t,i,n){"use strict";function r(e,i,n,r){t.call(this,e),this.inlineNode=i,this.exportedName=n,this.importedName=r,this.routes={},this.inlineNode.loadState_.addInterest("set_loadState__",this)}return r.prototype=Object.assign(Object.create(t.prototype),{constructor:r,getTypeName:function(){return"ImportedNode"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"importedNodes"},getInlineNode:function(){return this.inlineNode},getExportedName:function(){return this.exportedName},getExportedNode:function(){return this.inlineNode.getInternalScene().getExportedNode(this.exportedName)},setImportedName:function(e){this.importedName=e},getImportedName:function(){return this.importedName},addRoute:function(e,t,n,r){var s=e.getId()+"."+t+" "+n.getId()+"."+r;this.routes[s]={sourceNode:e,sourceField:t,destinationNode:n,destinationField:r},this.inlineNode.checkLoadState()===i.COMPLETE_STATE&&this.resolveRoute(s)},resolveRoute:function(e){try{var t=this.routes[e],i=t.sourceNode,n=t.sourceField,s=t.destinationNode,o=t.destinationField;t._route&&t._route.dispose(),i instanceof r&&(i=i.getExportedNode().getValue()),s instanceof r&&(s=s.getExportedNode().getValue()),t._route=this.getExecutionContext().addSimpleRoute(i,n,s,o)}catch(e){console.error(e.message)}},deleteRoutes:function(){var e=this.routes;for(var t in e){var i=e[t];i._route&&(this.getExecutionContext().deleteRoute(i._route),delete i._route)}},set_loadState__:function(){switch(this.inlineNode.checkLoadState()){case i.NOT_STARTED_STATE:case i.FAILED_STATE:this.deleteRoutes();break;case i.COMPLETE_STATE:var e=this.routes;this.deleteRoutes();for(var t in e)this.resolveRoute(t)}},toXMLStream:function(e){var t=n.Get(e);if(!t.ExistsNode(this.getInlineNode()))throw new Error("ImportedNode.toXMLStream: Inline node does not exist.");e.string+=t.Indent(),e.string+="<IMPORT",e.string+=" ",e.string+="inlineDEF='",e.string+=t.XMLEncode(t.Name(this.getInlineNode())),e.string+="'",e.string+=" ",e.string+="importedDEF='",e.string+=t.XMLEncode(this.getExportedName()),e.string+="'",this.getImportedName()!==this.getExportedName()&&(e.string+=" ",e.string+="AS='",e.string+=t.XMLEncode(this.getImportedName()),e.string+="'"),e.string+="/>";try{t.AddRouteNode(this),t.AddImportedNode(this.getExportedNode(),this.getImportedName())}catch(n){var i=this.routes;for(var s in i){var o=i[s],a=o.sourceNode,u=o.sourceField,l=o.destinationNode,h=o.destinationField;if(t.ExistsRouteNode(a)&&t.ExistsRouteNode(l)){if(a instanceof r)var c=a.getImportedName();else var c=t.Name(a);if(l instanceof r)var d=l.getImportedName();else var d=t.Name(l);e.string+="\n",e.string+="\n",e.string+=t.Indent(),e.string+="<ROUTE",e.string+=" ",e.string+="fromNode='",e.string+=t.XMLEncode(c),e.string+="'",e.string+=" ",e.string+="fromField='",e.string+=t.XMLEncode(u),e.string+="'",e.string+=" ",e.string+="toNode='",e.string+=t.XMLEncode(d),e.string+="'",e.string+=" ",e.string+="toField='",e.string+=t.XMLEncode(h),e.string+="'",e.string+="/>"}}}},dispose:function(){this.inlineNode.loadState_.removeInterest("set_loadState__",this),this.deleteRoutes(),t.prototype.dispose.call(this)}}),r}),define("x_ite/Prototype/ExternProtoDeclarationArray",["x_ite/Configuration/X3DInfoArray"],function(e){"use strict";function t(t){return e.call(this)}return t.prototype=Object.assign(Object.create(e.prototype),{constructor:t}),t}),define("x_ite/Prototype/ProtoDeclarationArray",["x_ite/Configuration/X3DInfoArray"],function(e){"use strict";function t(t){return e.call(this)}return t.prototype=Object.assign(Object.create(e.prototype),{constructor:t}),t}),define("x_ite/Routing/RouteArray",[],function(){"use strict";function e(){return this.array=[],new Proxy(this,t)}var t={get:function(e,t){var i=e[t];return void 0!==i?i:e.array[t]},set:function(e,t,i){return!1}};return Object.assign(e.prototype,{constructor:e,getValue:function(){return this.array},toXMLStream:function(e){for(var t=this.array,i=0,n=t.length;i<n;++i)try{t[i].toXMLStream(e),e.string+="\n"}catch(e){}}}),e}),define("x_ite/Routing/X3DRoute",["x_ite/Fields","x_ite/Basic/X3DBaseNode","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(e,t,i,n){"use strict";function r(i,n,r,s,o){t.call(this,i),this.addChildObjects("sourceNode",new e.SFNode(n),"destinationNode",new e.SFNode(s)),this._sourceField=r,this._destinationField=o,r.addFieldInterest(o),r.addOutputRoute(this),o.addInputRoute(this)}return r.prototype=Object.assign(Object.create(t.prototype),{getTypeName:function(){return"X3DRoute"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"routes"},initialize:function(){t.prototype.initialize.call(this),this.sourceNode_.addInterest("set_node",this),this.destinationNode_.addInterest("set_node",this)},set_node:function(){this.sourceNode_.getValue()&&this.destinationNode_.getValue()||this.dispose()},disconnect:function(){this._sourceField.removeFieldInterest(this._destinationField),this._sourceField.removeOutputRoute(this),this._destinationField.removeInputRoute(this),this.sourceNode_.getValue()&&this.sourceNode_.removeInterest("set_node",this),this.destinationNode_.getValue()&&this.destinationNode_.removeInterest("set_node",this)},getSourceNode:function(){return this.sourceNode_.getValue()},getSourceField:function(){return this._sourceField.getName()},getDestinationNode:function(){return this.destinationNode_.getValue()},getDestinationField:function(){return this._destinationField.getName()},toString:function(){return Object.prototype.toString(this)},toXMLStream:function(e){var t=n.Get(e),r=t.LocalName(this.getSourceNode()),s=t.LocalName(this.getDestinationNode());e.string+=t.Indent(),e.string+="<ROUTE",e.string+=" ",e.string+="fromNode='",e.string+=t.XMLEncode(r),e.string+="'",e.string+=" ",e.string+="fromField='",e.string+=t.XMLEncode(this._sourceField.getName()),this._sourceField.getAccessType()===i.inputOutput&&(e.string+="_changed"),e.string+="'",e.string+=" ",e.string+="toNode='",e.string+=t.XMLEncode(s),e.string+="'",e.string+=" ",e.string+="toField='",this._destinationField.getAccessType()===i.inputOutput&&(e.string+="set_"),e.string+=t.XMLEncode(this._destinationField.getName()),e.string+="'",e.string+="/>"},dispose:function(){this.disconnect(),this.getExecutionContext().deleteRoute(this),t.prototype.dispose.call(this)}}),Object.defineProperty(r.prototype,"sourceNode",{get:function(){return this.sourceNode_.clone()},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"sourceField",{get:function(){return this._sourceField.getName()},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"destinationNode",{get:function(){return this.destinationNode_.clone()},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"destinationField",{get:function(){return this._destinationField.getName()},enumerable:!0,configurable:!1}),r}),define("standard/Networking/URI",[],function(){"use strict";function e(e,t){switch(arguments.length){case 2:var i=this.value=e?e.split(t):[];i.separator=t,i.leadingSeparator=!1,i.trailingSeparator=!1,i.length&&0===i[0].length&&(i.shift(),i.leadingSeparator=!0),i.length&&0===i[i.length-1].length&&(i.pop(),i.trailingSeparator=!0);break;case 4:var i=this.value=arguments[0];i.separator=arguments[1],i.leadingSeparator=arguments[2],i.trailingSeparator=arguments[3]}}function t(t,i){var n=s.exec(i);if(n){t.scheme=n[1]||"",t.slashs=n[2]||"",t.path=new e(unescape(n[4]||""),"/"),t.query=n[5]||"",t.fragment=unescape(n[6]||"");var n=o.exec(n[3]||"");n&&(t.host=unescape(n[1]||""),t.port=n[2]?parseInt(n[2]):0),t.absolute=Boolean(t.slashs.length)||"/"===t.path[0],t.local=/^(?:file|data)$/.test(t.scheme)||!t.scheme&&!(t.host||t.port)}else t.path=new e("","/");t.string=i}function i(t){return new e(t,"/").removeDotSegments()}function n(i){var n=this.value={local:!0,absolute:!0,scheme:"",slashs:"",host:"",port:0,path:null,query:"",fragment:"",string:""};switch(arguments.length){case 0:n.path=new e("","/");break;case 1:t(n,i);break;case 9:n.local=arguments[0],n.absolute=arguments[1],n.scheme=arguments[2],n.slashs=arguments[3],n.host=arguments[4],n.port=arguments[5],n.path=arguments[6],n.query=arguments[7],n.fragment=arguments[8],n.string=this.toString()}}e.prototype={copy:function(){var t=this.value;return new e(t.slice(0,t.length),t.separator,t.leadingSeparator,t.trailingSeparator)},get length(){return this.value.length},get leadingSeparator(){return this.value.leadingSeparator},get trailingSeparator(){return this.value.trailingSeparator},get root(){return new e([],this.value.separator,!0,!0)},get base(){return this.value.trailingSeparator?this.copy():this.parent},get parent(){var t=this.value;switch(t.length){case 0:case 1:return t.leadingSeparator?this.root:new e([".."],t.separator,!1,!1);default:return new e(t.slice(0,t.length-1),t.separator,t.leadingSeparator,!0)}},get basename(){var e=this.value,t=e.length;return t?e[t-1]:""},get stem(){var e=this.basename;if(this.trailingSeparator&&e.length){var t=this.extension;if(t.length)return e.substr(0,e.length-t.length)}return e},get extension(){var e=this.basename,t=e.lastIndexOf(".");return t>0?e.substr(t):""},getRelativePath:function(t){if(!t.leadingSeparator)return t;var i,n,r,s=new e([],"/",!1,t.value.trailingSeparator),o=this.removeDotSegments().base,a=t.removeDotSegments();for(i=0,r=Math.min(o.value.length,a.value.length);i<r&&o.value[i]===a.value[i];++i);for(n=i,r=o.value.length;n<r;++n)s.value.push("..");for(n=i,r=a.value.length;n<r;++n)s.value.push(a.value[n]);return 0===s.value.length&&s.value.push("."),s},removeDotSegments:function(){var t=this.value,i=new e([],t.separator,t.leadingSeparator,t.trailingSeparator);if(t.length){for(var n=0;n<t.length;++n){var r=t[n];switch(r){case"":break;case".":i.value.trailingSeparator=!0;break;case"..":i.value.trailingSeparator=!0,i.value.length&&i.value.pop();break;default:i.value.trailingSeparator=!1,i.value.push(r)}}i.value.trailingSeparator=i.value.trailingSeparator||t.trailingSeparator}return i},escape:function(){for(var e=this.copy(),t=e.value,i=0,n=t.length;i<n;++i)t[i]=encodeURI(t[i]);return e},unescape:function(){for(var e=this.copy(),t=e.value,i=0,n=t.length;i<n;++i)t[i]=unescape(t[i]);return e},toString:function(){var e=this.value,t="";return e.leadingSeparator&&(t+=e.separator),t+=e.join(e.separator),e.leadingSeparator&&0===e.length?t:(e.trailingSeparator&&(t+=e.separator),t)}};var r={ftp:21,http:80,https:443,ftps:990},s=/^(?:([^:\/?#]*?):)?(?:(\/\/)([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?$/,o=/^(.*?)(?:\:([^:]*))?$/;return n.prototype={copy:function(){var e=this.value;return new n(e.local,e.absolute,e.scheme,e.slashs,e.host,e.port,e.path.copy(),e.query,e.fragment)},get length(){return this.value.string.length},isRelative:function(){return!this.value.absolute},isAbsolute:function(){return!this.value.absolute},isLocal:function(){return this.value.local},isNetwork:function(){return!this.value.local},isDirectory:function(){var e=this.value;return e.path.length?e.path.trailingSeparator:this.isNetwork()},isFile:function(){return!this.isDirectory()},get hierarchy(){var e=this.value,t="";return t+=e.slashs,t+=this.authority,t+=this.path},get authority(){var e=this.value,t=e.host;return e.port&&(t+=":",t+=e.port),t},get scheme(){return this.value.scheme},get host(){return this.value.host},get port(){return this.value.port},get wellKnownPort(){var e=r[this.value.scheme];return void 0!==e?e:0},get path(){return this.value.path.toString()},set query(e){this.value.query=e},get query(){return this.value.query},set fragment(e){this.value.fragment=e},get fragment(){return this.value.fragment},get location(){return this.toString()},get root(){var t=this.value;return new n(t.local,t.absolute,t.scheme,t.slashs,t.host,t.port,new e("/","/"),"","")},get base(){var e=this.value;return this.isDirectory()?new n(e.local,e.absolute,e.scheme,e.slashs,e.host,e.port,e.path.copy(),"",""):this.parent},get parent(){var e=this.value;return new n(e.local,e.absolute,e.scheme,e.slashs,e.host,e.port,e.path.parent,"","")},get filename(){var e=this.value;return new n(e.local,e.absolute,e.scheme,e.slashs,e.host,e.port,e.path.copy(),"","")},get basename(){return this.value.path.basename},get stem(){return this.value.path.stem},get extension(){return this.value.path.extension},transform:function(e){e instanceof n||(e=new n(e.toString()));var t=this.value,r=!1,s=!1,o="",a="",u="",l=0,h="",c="",d="";if(e.scheme)r=e.isLocal(),s=e.isAbsolute(),o=e.scheme,a=e.value.slashs,u=e.host,l=e.port,h=e.path,c=e.query;else{if(e.authority)r=e.isLocal(),s=e.isAbsolute(),u=e.host,l=e.port,h=e.path,c=e.query;else{if(0===e.path.length)h=this.path,c=e.query?e.query:t.query;else{if("/"===e.path[0])h=e.path;else{var p=this.base;p.path?h+=p.path:h="/",h+=e.path}c=e.query}r=this.isLocal(),s=this.isAbsolute()||e.isAbsolute(),u=t.host,l=t.port}o=t.scheme,a=t.slashs}return d=e.fragment,new n(r,s,o,a,u,l,i(h),c,d)},removeDotSegments:function(){var e=this.value;return new n(e.local,e.absolute,e.scheme,e.slashs,e.host,e.port,e.path.removeDotSegments(),e.query,e.fragment)},getRelativePath:function(e){e instanceof n||(e=new n(e.toString()));var t=this.value;return t.scheme!==e.scheme?e:this.authority!==e.authority?e:new n(!0,!1,"","","",0,t.path.getRelativePath(e.value.path),e.query,e.fragment)},escape:function(){var e=this.value;return new n(e.local,e.absolute,e.scheme,e.slashs,e.host,e.port,e.path.escape(),e.query,escape(e.fragment))},unescape:function(){var e=this.value;return new n(e.local,e.absolute,e.scheme,e.slashs,e.host,e.port,e.path.unescape(),e.query,unescape(e.fragment))},toString:function(){var e=this.value,t=this.value.scheme;return e.scheme&&(t+=":"),t+=this.hierarchy,e.query&&(t+="?"+e.query),e.fragment&&(t+="#"+e.fragment),t}},n}),define("x_ite/Execution/X3DExecutionContext",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Basic/X3DBaseNode","x_ite/Configuration/ComponentInfoArray","x_ite/Execution/ImportedNode","x_ite/Prototype/ExternProtoDeclarationArray","x_ite/Prototype/ProtoDeclarationArray","x_ite/Routing/RouteArray","x_ite/Routing/X3DRoute","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants","standard/Networking/URI","standard/Math/Algorithm","x_ite/InputOutput/Generator"],function(e,t,i,n,r,s,o,a,u,l,h,c,d,p,f){"use strict";function g(t){n.call(this,t),this.addChildObjects("rootNodes",new e.MFNode),this.rootNodes_.addClones(1),this.specificationVersion="3.3",this.encoding="SCRIPTED",this.profile=null,this.components=new r(this.getBrowser()),this.url=new d(window.location),this.uninitializedNodes=[],this.uninitializedNodes2=[],this.namedNodes={},this.importedNodes={},this.protos=new a,this.externprotos=new o,this.routes=new u,this.routeIndex={}}return g.prototype=Object.assign(Object.create(n.prototype),{constructor:g,setup:function(){if(n.prototype.setup.call(this),!(this instanceof require("x_ite/Prototype/X3DProtoDeclaration")))for(;this.uninitializedNodes.length;){var e=this.uninitializedNodes;this.uninitializedNodes=this.uninitializedNodes2,this.uninitializedNodes2=e;for(var t=0,i=e.length;t<i;++t)e[t].setup();e.length=0}},isMasterContext:function(){return!1},isRootContext:function(){return!1},getSpecificationVersion:function(){return this.specificationVersion},setEncoding:function(e){this.encoding=e},getEncoding:function(){return this.encoding},getWorldURL:function(){return this.getURL().location},setURL:function(e){this.url=e},getURL:function(){return this.url},setProfile:function(e){this.profile=e},getProfile:function(e){return this.profile},addComponent:function(e){this.components.add(e.name,e)},getComponents:function(){return this.components},getUnits:function(){return this.getExecutionContext().getUnits()},createNode:function(t,i){var n=this.getBrowser().supportedNodes[t];if(!n)throw new Error("Unknown node type '"+t+"'.");var r=n.createInstance(this);return i===!1?r:(r.setup(),new e.SFNode(r))},createProto:function(e,t){for(var i=this;;){var n=i.protos[e];if(n)return n.createInstance(this,t);var r=i.externprotos[e];if(r)return r.createInstance(this,t);if(i.isRootContext())break;i=i.getExecutionContext()}throw new Error("Unknown proto or externproto type '"+e+"'.")},addUninitializedNode:function(e){this.uninitializedNodes.push(e)},addNamedNode:function(e,t){if(void 0!==this.namedNodes[e])throw new Error("Couldn't add named node: node named '"+e+"' is already in use.");this.updateNamedNode(e,t)},updateNamedNode:function(t,i){if(!(i instanceof e.SFNode||i instanceof n))throw new Error("Couldn't update named node: node must be of type SFNode.");if(t=String(t),i=new e.SFNode(i instanceof e.SFNode?i.getValue():i),!i.getValue())throw new Error("Couldn't update named node: node IS NULL.");if(i.getValue().getExecutionContext()!==this)throw new Error("Couldn't update named node: node does not belong to this execution context.");if(0===t.length)throw new Error("Couldn't update named node: node name is empty.");this.removeNamedNode(i.getValue().getName()),this.removeNamedNode(t),i.getValue().setName(t),this.namedNodes[t]=i},removeNamedNode:function(e){delete this.namedNodes[e]},getNamedNode:function(e){var t=this.namedNodes[e];if(!t)throw new Error("Named node '"+e+"' not found.");return t},getUniqueName:function(e){e=e.replace(/(_\d+$)/,"");for(var t=e,i=64;i&&(this.namedNodes[t]||0===t.length);){var n=i,r=i<<=1;t=e,t+="_",t+=Math.round(p.random(n,r))}return t},addImportedNode:function(e,t,i){if(void 0===i&&(i=t),this.importedNodes[i])throw new Error("Couldn't add imported node: imported name '"+i+"' already in use.");this.updateImportedNode(e,t,i)},updateImportedNode:function(e,t,i){if(e=h(c.Inline,e),t=String(t),i=void 0===i?t:String(i),!e)throw new Error("Node named is not an Inline node.");if(e.getExecutionContext()!==this)throw new Error("Couldn't update imported node: Inline node does not belong to this execution context.");if(0===t.length)throw new Error("Couldn't update imported node: exported name is empty.");if(0===i.length)throw new Error("Couldn't update imported node: imported name is empty.");for(var n in this.importedNodes){var r=this.importedNodes[n];if(r.getInlineNode()===e&&r.getExportedName()===t)return delete this.importedNodes[n],this.importedNodes[i]=r,void r.setImportedName(i)}this.removeImportedNode(i),this.importedNodes[i]=new s(this,e,t,i),this.importedNodes[i].setup()},removeImportedNode:function(e){var t=this.importedNodes[e];t&&t.dispose(),delete this.importedNodes[e]},getImportedNode:function(e){var t=this.importedNodes[e];if(t)return t.getExportedNode();throw new Error("Imported node '"+e+"' not found.")},getImportedNodes:function(){return this.importedNodes},getLocalNode:function(t){try{return this.getNamedNode(t)}catch(n){var i=this.importedNodes[t];if(i)return new e.SFNode(i);throw new Error("Unknown named or imported node '"+t+"'.")}},getLocalName:function(t){if(!(t instanceof e.SFNode))throw new Error("Couldn't get local name: node is NULL.");if(t.getValue().getExecutionContext()===this)return t.getValue().getName();for(var i in this.importedNodes)try{if(this.importedNodes[i].getExportedNode()===t)return i}catch(e){}throw new Error("Couldn't get local name: node is shared.")},setRootNodes:function(){},getRootNodes:function(){return this.rootNodes_},getProtoDeclaration:function(e){return this.protos.get(e)},getProtoDeclarations:function(){return this.protos},getExternProtoDeclaration:function(e){return this.externprotos.get(e)},getExternProtoDeclarations:function(){return this.externprotos},addRoute:function(t,i,n,r){if(i=String(i),r=String(r),!(t instanceof e.SFNode))throw new Error("Bad ROUTE specification: source node must be of type SFNode.");if(!(n instanceof e.SFNode))throw new Error("Bad ROUTE specification: destination node must be of type SFNode.");if(t=t.getValue(),n=n.getValue(),!t)throw new Error("Bad ROUTE specification: source node is NULL.");if(!n)throw new Error("Bad ROUTE specification: destination node is NULL.");var o=t instanceof s?t:null,a=n instanceof s?n:null;try{t.getExecutionContext()!==this&&(o=this.getLocalNode(this.getLocalName(t)))}catch(e){}try{n.getExecutionContext()!==this&&(a=this.getLocalNode(this.getLocalName(n)))}catch(e){}if(o instanceof s&&o.addRoute(o,i,n,r),a instanceof s&&a.addRoute(t,i,a,r),o!==t&&a!==n)return this.addSimpleRoute(t,i,n,r)},addSimpleRoute:function(e,t,i,n){try{if(t=e.getField(t),n=i.getField(n),!t.isOutput())throw new Error("Field named '"+t.getName()+"' in node named '"+e.getName()+"' of type "+e.getTypeName()+" is not an output field.");if(!n.isInput())throw new Error("Field named '"+n.getName()+"' in node named '"+i.getName()+"' of type "+i.getTypeName()+" is not an input field.");if(t.getType()!==n.getType())throw new Error("ROUTE types "+t.getTypeName()+" and "+n.getTypeName()+" do not match.");var r=t.getId()+"."+n.getId();if(this.routeIndex[r])return this.routeIndex[r];var s=new l(this,e,t,i,n);return s.setup(),this.routes.getValue().push(s),this.routeIndex[r]=s,s}catch(e){throw new Error("Bad ROUTE specification: "+e.message)}},deleteRoute:function(e){try{if(4===arguments.length&&!(e=this.getRoute.apply(this,arguments)))return;var t=e._sourceField,i=e._destinationField,n=t.getId()+"."+i.getId(),r=this.routes.getValue().indexOf(e);e.disconnect(),r!==-1&&this.routes.getValue().splice(r,1),delete this.routeIndex[n]}catch(e){console.log(e)}},getRoute:function(e,t,i,n){if(!e.getValue())throw new Error("Bad ROUTE specification: sourceNode is NULL.");if(!i.getValue())throw new Error("Bad ROUTE specification: destinationNode is NULL.");var t=e.getValue().getField(t),n=i.getValue().getField(n),r=t.getId()+"."+n.getId();return this.routeIndex[r]},getRoutes:function(){return this.routes},changeViewpoint:function(e){try{var t=this.getNamedNode(e),i=h(c.X3DViewpointNode,t);if(!i)throw 1;i.setAnimate(!0),i.isBound_.getValue()?i.transitionStart(i):i.set_bind_=!0}catch(t){if(this.isRootContext())throw new Error("Viewpoint named '"+e+"' not found.");this.getExecutionContext().changeViewpoint(e)}},toXMLStream:function(e){var t=f.Get(e);t.PushExecutionContext(this),t.EnterScope(),t.ImportedNodes(this.getImportedNodes()),this.getExternProtoDeclarations().toXMLStream(e),this.getProtoDeclarations().toXMLStream(e);var i=this.getRootNodes();i.length&&(i.toXMLStream(e),e.string+="\n");var n=this.getImportedNodes();for(var r in n)try{n[r].toXMLStream(e),e.string+="\n"}catch(e){}this.getRoutes().toXMLStream(e),t.LeaveScope(),t.PopExecutionContext()}}),Object.defineProperty(g.prototype,"worldURL",{get:function(){return this.getWorldURL()},enumerable:!0,configurable:!1}),Object.defineProperty(g.prototype,"units",{get:function(){return this.getUnits()},enumerable:!0,configurable:!1}),Object.defineProperty(g.prototype,"rootNodes",{get:function(){return this.getRootNodes()},set:function(e){this.setRootNodes(e)},enumerable:!0,configurable:!1}),g}),define("x_ite/Configuration/UnitInfo",["x_ite/InputOutput/Generator"],function(e){"use strict";function t(e,t,i){Object.defineProperty(this,"category",{value:e,writable:!1}),this.name=t,this.conversionFactor=i}return Object.assign(t.prototype,{constructor:t,toXMLStream:function(t){var i=e.Get(t);t.string+=i.Indent(),t.string+="<unit",t.string+=" ",t.string+="category='",t.string+=this.category,t.string+="'",t.string+=" ",t.string+="name='",t.string+=i.XMLEncode(this.name),t.string+="'",t.string+=" ",t.string+="conversionFactor='",t.string+=this.conversionFactor,t.string+="'",t.string+="/>"}}),Object.defineProperty(t.prototype,"conversion_factor",{get:function(){return this.conversionFactor},enumerable:!0,configurable:!1}),t}),define("x_ite/Configuration/UnitInfoArray",["x_ite/Configuration/X3DInfoArray"],function(e){"use strict";function t(){return e.call(this)}return t.prototype=Object.assign(Object.create(e.prototype),{constructor:t}),t}),define("x_ite/Execution/ExportedNode",["x_ite/Fields","x_ite/Base/X3DObject","x_ite/InputOutput/Generator"],function(e,t,i){"use strict";function n(e,i){t.call(this),this.exportedName=e,this.localNode=i}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,getExportedName:function(){return this.exportedName},getLocalNode:function(){return new e.SFNode(this.localNode)},toXMLStream:function(e){var t=i.Get(e),n=t.LocalName(this.localNode);e.string+=t.Indent(),e.string+="<EXPORT",e.string+=" ",e.string+="localDEF='",e.string+=t.XMLEncode(n),e.string+="'",this.exportedName!==n&&(e.string+=" ",e.string+="AS='",e.string+=t.XMLEncode(this.exportedName),e.string+="'"),e.string+="/>"}}),n}),define("x_ite/Execution/X3DScene",["x_ite/Fields","x_ite/Execution/X3DExecutionContext","x_ite/Configuration/UnitInfo","x_ite/Configuration/UnitInfoArray","x_ite/Execution/ExportedNode","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(e,t,i,n,r,s,o){"use strict";function a(e){t.call(this,e),this.getRootNodes().setAccessType(s.inputOutput),this.unitArray=new n,this.unitArray.add("angle",new i("angle","radian",1)),this.unitArray.add("force",new i("force","newton",1)),this.unitArray.add("length",new i("length","metre",1)),this.unitArray.add("mass",new i("mass","kilogram",1)),this.metadata={},this.exportedNodes={},this.setLive(!1)}return a.prototype=Object.assign(Object.create(t.prototype),{constructor:a,isMasterContext:function(){return this===this.getExecutionContext()},isRootContext:function(){return!0},getScene:function(){return this.isMasterContext()?this:this.getExecutionContext().getScene()},updateUnit:function(e,t,i){var n=this.unitArray.get(e);n&&(n.name=t,n.conversionFactor=i)},getUnits:function(){return this.unitArray},fromUnit:function(e,t){switch(e){case"angle":case"force":case"length":case"mass":return t*this.getUnits().get(e).conversionFactor;case"acceleration:":return t*this.getUnits().get("length").conversionFactor;case"angularRate":return t*this.getUnits().get("angle").conversionFactor;case"area":return t*Math.pow(this.getUnits().get("length").conversionFactor,2);case"speed":return t*this.getUnits().get("length").conversionFactor;case"volume":return t*Math.pow(this.getUnits().get("length").conversionFactor,3)}return t},toUnit:function(e,t){switch(e){case"angle":case"force":case"length":case"mass":return t/this.getUnits().get(e).conversionFactor;case"acceleration:":return t/this.getUnits().get("length").conversionFactor;case"angularRate":return t/this.getUnits().get("angle").conversionFactor;case"area":return t/Math.pow(this.getUnits().get("length").conversionFactor,2);case"speed":return t/this.getUnits().get("length").conversionFactor;case"volume":return t/Math.pow(this.getUnits().get("length").conversionFactor,3)}return t},setMetaData:function(e,t){e.length&&(this.metadata[e]=String(t))},removeMetaData:function(e){delete this.metadata[e]},getMetaData:function(e){return this.metadata[e]},getMetadata:function(){return Object.assign({},this.metadata)},addExportedNode:function(e,t){if(this.exportedNodes[e])throw new Error("Couldn't add exported node: exported name '"+e+"' already in use.");this.updateExportedNode(e,t)},updateExportedNode:function(t,i){if(t=String(t),0===t.length)throw new Error("Couldn't update exported node: node exported name is empty.");if(!(i instanceof e.SFNode))throw new Error("Couldn't update exported node: node must be of type SFNode.");if(!i.getValue())throw new Error("Couldn't update exported node: node IS NULL.");this.exportedNodes[t]=new r(t,i.getValue())},removeExportedNode:function(e){delete this.exportedNodes[e]},getExportedNode:function(e){var t=this.exportedNodes[e];if(t)return t.getLocalNode();throw new Error("Exported node '"+e+"' not found.")},getExportedNodes:function(){return this.exportedNodes},addRootNode:function(t){if(null===t&&(t=new e.SFNode),!(t instanceof e.SFNode))throw new Error("Couldn't add root node: node must be of type SFNode.");for(var i=this.getRootNodes(),n=0,r=i.length;n<r;++n)if(i[n].equals(t))return;i.push(t)},removeRootNode:function(t){if(null===t&&(t=new e.SFNode),!(t instanceof e.SFNode))throw new Error("Couldn't remove root node: node must be of type SFNode.");var i=this.getRootNodes(),n=i.length;i.erase(i.remove(0,n,t),n)},setRootNodes:function(e){this.getRootNodes().setValue(e)},toXMLStream:function(e){var i=o.Get(e),n=this.getSpecificationVersion();"2.0"===n&&(n="3.3"),e.string+='<?xml version="1.0" encoding="UTF-8"?>\n',e.string+='<!DOCTYPE X3D PUBLIC "ISO//Web3D//DTD X3D ',e.string+=n,e.string+='//EN" "http://www.web3d.org/specifications/x3d-',e.string+=n,e.string+='.dtd">\n',e.string+="<X3D",e.string+=" ",e.string+="profile='",e.string+=this.getProfile()?this.getProfile().name:"Full",e.string+="'",e.string+=" ",e.string+="version='",e.string+=n,e.string+="'",e.string+=" ",e.string+="xmlns:xsd='http://www.w3.org/2001/XMLSchema-instance'",e.string+=" ",
e.string+="xsd:noNamespaceSchemaLocation='http://www.web3d.org/specifications/x3d-",e.string+=n,e.string+=".xsd'>\n",i.IncIndent(),e.string+=i.Indent(),e.string+="<head>\n",i.IncIndent(),this.getComponents().toXMLStream(e);for(var r=this.getUnits(),s=0,a=r.length;s<a;++s){var u=r[s];1!==u.conversionFactor&&(u.toXMLStream(e),e.string+="\n")}var l=this.metadata;for(var h in l)e.string+=i.Indent(),e.string+="<meta",e.string+=" ",e.string+="name='",e.string+=i.XMLEncode(h),e.string+="'",e.string+=" ",e.string+="content='",e.string+=i.XMLEncode(l[h]),e.string+="'",e.string+="/>\n";i.DecIndent(),e.string+=i.Indent(),e.string+="</head>\n",e.string+=i.Indent(),e.string+="<Scene>\n",i.IncIndent();var c=this.getExportedNodes();i.PushExecutionContext(this),i.EnterScope(),i.ExportedNodes(c),t.prototype.toXMLStream.call(this,e);for(var d in c)c[d].toXMLStream(e),e.string+="\n";i.LeaveScope(),i.PopExecutionContext(),i.DecIndent(),e.string+=i.Indent(),e.string+="</Scene>\n",i.DecIndent(),e.string+="</X3D>\n"}}),a}),define("x_ite/Execution/Scene",["x_ite/Fields","x_ite/Execution/X3DScene"],function(e,t){"use strict";function i(i){this._browser=i,t.call(this,this),this.addChildObjects("initLoadCount",new e.SFInt32,"loadCount",new e.SFInt32),this.loadingObjects={}}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,getTypeName:function(){return"Scene"},setExecutionContext:function(e){if(!this.isMasterContext()){var i=this.getScene(),n=this.loadingObjects;for(var r in n)i.removeLoadCount(n[r])}if(t.prototype.setExecutionContext.call(this,e),!this.isMasterContext()){var i=this.getScene(),n=this.loadingObjects;for(var r in n)i.addLoadCount(n[r])}},addInitLoadCount:function(e){this.initLoadCount_=this.initLoadCount_.getValue()+1},removeInitLoadCount:function(e){this.initLoadCount_=this.initLoadCount_.getValue()-1},addLoadCount:function(e){var t=e.getId();this.loadingObjects.hasOwnProperty(t)||(this.loadingObjects[t]=e,this.loadCount_=this.loadCount_.getValue()+1,this===this.getBrowser().getExecutionContext()&&this.getBrowser().addLoadCount(e),this.isMasterContext()||this.getScene().addLoadCount(e))},removeLoadCount:function(e){var t=e.getId();this.loadingObjects.hasOwnProperty(t)&&(delete this.loadingObjects[t],this.loadCount_=this.loadCount_.getValue()-1,this===this.getBrowser().getExecutionContext()&&this.getBrowser().removeLoadCount(e),this.isMasterContext()||this.getScene().removeLoadCount(e))},getLoadingObjects:function(){return this.loadingObjects}}),i}),define("x_ite/Parser/X3DParser",[],function(){"use strict";function e(e){this.scene=e,this.executionContexts=[e],this.units=!0}return e.prototype={constructor:e,getScene:function(){return this.scene},getBrowser:function(){return this.scene.getBrowser()},getExecutionContext:function(){return this.executionContexts[this.executionContexts.length-1]},pushExecutionContext:function(e){return this.executionContexts.push(e)},popExecutionContext:function(){this.executionContexts.pop()},isInsideProtoDefinition:function(){return this.executionContexts.length>1},addRootNode:function(e){this.getExecutionContext().rootNodes.push(e)},setUnits:function(e){if("boolean"==typeof arguments[0])return void(this.units=arguments[0]);var t=e.match(/Titania\s+V(\d+).*/);if(t){if(parseInt(t[1])<4)return void(this.units=!1)}this.units=!0},getUnits:function(){return this.units},fromUnit:function(e,t){return this.units?this.getExecutionContext().fromUnit(e,t):t}},e}),define("x_ite/Components/Networking/X3DUrlObject",["x_ite/Fields","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function i(i){this.addType(t.X3DUrlObject),this.addChildObjects("loadState",new e.SFInt32(t.NOT_STARTED_STATE))}return i.prototype={constructor:i,initialize:function(){},setLoadState:function(e,i){this.loadState_=e,this.getScene().removeLoadCount(this),i!==!1&&e===t.IN_PROGRESS_STATE&&this.getScene().addLoadCount(this)},checkLoadState:function(){return this.loadState_.getValue()},getLoadState:function(){return this.loadState_}},i}),define("x_ite/Components/Core/X3DPrototypeInstance",["x_ite/Basic/FieldDefinitionArray","x_ite/Fields","x_ite/Base/X3DChildObject","x_ite/Components/Core/X3DNode","x_ite/Execution/X3DExecutionContext","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(e,t,i,n,r,s,o){"use strict";function a(t,i){this.protoNode=i,this.fieldDefinitions=new e(i.getFieldDefinitions().getValue().slice()),n.call(this,t),r.call(this,t),this.addType(s.X3DPrototypeInstance),this.getRootNodes().setAccessType(s.initializeOnly),this.getScene().addInitLoadCount(this),i.isExternProto?i.requestAsyncLoad(this.construct.bind(this)):this.construct()}return a.prototype=Object.assign(Object.create(r.prototype),n.prototype,{constructor:a,create:function(e){return new a(e,this.protoNode)},getTypeName:function(){return this.protoNode.getName()},getComponentName:function(){return"Core"},getContainerField:function(){return"children"},construct:function(){this.getScene().removeInitLoadCount(this);var e=this.protoNode.getProtoDeclaration();if(e){if(this.metadata_.getSet()||(this.metadata_=e.metadata_),this.protoNode.isExternProto)for(var t=e.getFieldDefinitions(),n=0,r=t.length;n<r;++n)try{var o=t[n],a=this.getField(o.name),u=e.getField(o.name);if(a.getAccessType()!==u.getAccessType())continue;if(a.getType()!==u.getType())continue;if(!(a.getAccessType()&s.initializeOnly))continue;if(a.getSet())continue;if(a.hasReferences())continue;if(a.equals(u))continue;a.setValue(u)}catch(e){this.addField(o)}this.setURL(e.getURL()),this.importExternProtos(e.externprotos),this.importProtos(e.protos),this.copyRootNodes(e.rootNodes),this.isInitialized()&&(this.setInitialized(!1),this.setup(),this.setTainted(!1),i.prototype.addEvent.call(this))}},setup:function(){n.prototype.setup.call(this),r.prototype.setup.call(this)},initialize:function(){try{var e=this.protoNode.getProtoDeclaration();e&&(this.copyImportedNodes(e,e.importedNodes),this.copyRoutes(e,e.routes)),n.prototype.initialize.call(this),r.prototype.initialize.call(this)}catch(e){console.error(e.message)}},getSpecificationVersion:function(){return this.getExecutionContext().getSpecificationVersion()},getEncoding:function(){return this.getExecutionContext().getEncoding()},getInnerNode:function(){var e=this.getRootNodes().getValue();if(e.length){var t=e[0];if(t)return t.getValue().getInnerNode()}throw new Error("Root node not available.")},fromUnit:function(e,t){return this.protoNode.getProtoDeclaration().fromUnit(e,t)},toUnit:function(e,t){return this.protoNode.getProtoDeclaration().toUnit(e,t)},getExtendedEventHandling:function(){return!1},importExternProtos:function(e){for(var t=0,i=e.length;t<i;++t)this.externprotos.add(e[t].getName(),e[t])},importProtos:function(e){for(var t=0,i=e.length;t<i;++t)this.protos.add(e[t].getName(),e[t])},copyRootNodes:function(e){for(var t=this.getRootNodes(),i=0,n=e.length;i<n;++i)t.push(e[i].copy(this))},copyImportedNodes:function(e,t){for(var i in t)try{var n=t[i],r=this.getNamedNode(n.getInlineNode().getName()),s=n.getExportedName(),i=n.getImportedName();this.addImportedNode(r,s,i)}catch(e){console.error("Bad IMPORT specification in copy: ",e)}},copyRoutes:function(e,t){for(var i=0,n=t.length;i<n;++i)try{var r=t[i],s=this.getLocalNode(e.getLocalName(r.sourceNode)),o=this.getLocalNode(e.getLocalName(r.destinationNode));this.addRoute(s,r.sourceField,o,r.destinationField)}catch(e){console.log(e)}},toXMLStream:function(e){var t=o.Get(e);if(t.IsSharedNode(this))return e.string+=t.Indent(),void(e.string+="<!-- NULL -->");t.EnterScope();var i=t.Name(this);if(i.length&&t.ExistsNode(this)){e.string+=t.Indent(),e.string+="<ProtoInstance",e.string+=" ",e.string+="name='",e.string+=t.XMLEncode(this.getTypeName()),e.string+="'",e.string+=" ",e.string+="USE='",e.string+=t.XMLEncode(i),e.string+="'";var n=t.ContainerField();return n&&n.getName()!==this.getContainerField()&&(e.string+=" ",e.string+="containerField='",e.string+=t.XMLEncode(n.getName()),e.string+="'"),e.string+="/>",void t.LeaveScope()}e.string+=t.Indent(),e.string+="<ProtoInstance",e.string+=" ",e.string+="name='",e.string+=t.XMLEncode(this.getTypeName()),e.string+="'",i.length&&(t.AddNode(this),e.string+=" ",e.string+="DEF='",e.string+=t.XMLEncode(i),e.string+="'");var n=t.ContainerField();n&&n.getName()!==this.getContainerField()&&(e.string+=" ",e.string+="containerField='",e.string+=t.XMLEncode(n.getName()),e.string+="'");var r=this.getChangedFields();if(0===r.length)e.string+="/>";else{e.string+=">\n",t.IncIndent();for(var a=[],u=0,l=r.length;u<l;++u){var h=r[u],c=!1;if(t.ExecutionContext()&&h.getAccessType()===s.inputOutput&&0!==h.getReferences().size){var d=!1,p=h.getReferences();for(var f of p.values())d|=f.isInitializable();d||(c=!0)}if(0===h.getReferences().size||!t.ExecutionContext()||c)switch(c&&a.push(h),h.getType()){case s.MFNode:e.string+=t.Indent(),e.string+="<fieldValue",e.string+=" ",e.string+="name='",e.string+=t.XMLEncode(h.getName()),e.string+="'",0===h.length?e.string+="/>\n":(e.string+=">\n",t.IncIndent(),h.toXMLStream(e),e.string+="\n",t.DecIndent(),e.string+=t.Indent(),e.string+="</fieldValue>\n");break;case s.SFNode:if(null!==h.getValue()){e.string+=t.Indent(),e.string+="<fieldValue",e.string+=" ",e.string+="name='",e.string+=t.XMLEncode(h.getName()),e.string+="'",e.string+=">\n",t.IncIndent(),h.toXMLStream(e),e.string+="\n",t.DecIndent(),e.string+=t.Indent(),e.string+="</fieldValue>\n";break}default:e.string+=t.Indent(),e.string+="<fieldValue",e.string+=" ",e.string+="name='",e.string+=t.XMLEncode(h.getName()),e.string+="'",e.string+=" ",e.string+="value='",h.toXMLStream(e),e.string+="'",e.string+="/>\n"}else a.push(h)}if(a.length){e.string+=t.Indent(),e.string+="<IS>",e.string+="\n",t.IncIndent();for(var u=0,l=a.length;u<l;++u){var h=a[u],g=h.getReferences();for(var m of g.values())e.string+=t.Indent(),e.string+="<connect",e.string+=" ",e.string+="nodeField='",e.string+=t.XMLEncode(h.getName()),e.string+="'",e.string+=" ",e.string+="protoField='",e.string+=t.XMLEncode(m.getName()),e.string+="'",e.string+="/>\n"}t.DecIndent(),e.string+=t.Indent(),e.string+="</IS>\n"}t.DecIndent(),e.string+=t.Indent(),e.string+="</ProtoInstance>"}t.LeaveScope()}}),a}),define("x_ite/Prototype/X3DProtoDeclarationNode",["x_ite/Fields","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DPrototypeInstance","x_ite/Bits/X3DConstants"],function(e,t,i,n){"use strict";function r(e){t.call(this,e),this.addType(n.X3DProtoDeclarationNode)}return r.prototype=Object.assign(Object.create(t.prototype),{constructor:r,hasUserDefinedFields:function(){return!0},createInstance:function(t,n){var r=new i(t,this);return n===!1?r:(r.setup(),new e.SFNode(r))},newInstance:function(){return this.createInstance(this.getExecutionContext())}}),r}),define("x_ite/Prototype/X3DExternProtoDeclaration",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Networking/X3DUrlObject","x_ite/Prototype/X3DProtoDeclarationNode","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(e,t,i,n,r,s,o,a){"use strict";function u(){}function l(i){s.call(this,i),r.call(this,i),this.addType(o.X3DExternProtoDeclaration),this.addChildObjects("url",new t.MFString),this.deferred=e.Deferred()}return l.prototype=Object.assign(Object.create(s.prototype),r.prototype,{constructor:l,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new t.SFNode)]),getTypeName:function(){return"EXTERNPROTO"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"externprotos"},initialize:function(){s.prototype.initialize.call(this),r.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this)},set_live__:function(){this.checkLoadState()===o.COMPLETE_STATE&&this.scene.setLive(this.isLive().getValue())},hasUserDefinedFields:function(){return!0},setProtoDeclaration:function(e){if(this.proto=e,this.proto)for(var t=this.getFieldDefinitions(),i=e.getFieldDefinitions(),n=0,r=i.length;n<r;++n){var s=i[n],o=t.get(s.name);o&&o.value.setValue(s.value)}},getProtoDeclaration:function(){return this.proto},loadNow:function(e){this.requestAsyncLoad(e||u)},requestAsyncLoad:function(e){if(this.deferred.done(e),this.checkLoadState()!==o.COMPLETE_STATE&&this.checkLoadState()!==o.IN_PROGRESS_STATE){this.setLoadState(o.IN_PROGRESS_STATE);new(require("x_ite/InputOutput/FileLoader"))(this).createX3DFromURL(this.url_,null,this.setInternalSceneAsync.bind(this))}},setInternalSceneAsync:function(e){e?this.setInternalScene(e):this.setError()},setInternalScene:function(e){this.scene=e;var t=this.scene.getURL().fragment||0,i=this.scene.protos[t];if(!i)throw new Error("PROTO not found");this.scene.setLive(this.isLive().getValue()),this.scene.setPrivate(this.getScene().getPrivate()),this.scene.setup(),this.setLoadState(o.COMPLETE_STATE),this.setProtoDeclaration(i),this.deferred.resolve()},getInternalScene:function(){return this.scene},setError:function(t){console.error("Error loading extern prototype:",t),this.setLoadState(o.FAILED_STATE),this.scene=this.getBrowser().getPrivateScene(),this.setProtoDeclaration(null),this.deferred.resolve(),this.deferred=e.Deferred()},toXMLStream:function(e){var t=a.Get(e);e.string+=t.Indent(),e.string+="<ExternProtoDeclare",e.string+=" ",e.string+="name='",e.string+=t.XMLEncode(this.getName()),e.string+="'",e.string+=" ",e.string+="url='",this.url_.toXMLStream(e),e.string+="'",e.string+=">\n",t.IncIndent();var i=this.getUserDefinedFields();for(var n of i.values())e.string+=t.Indent(),e.string+="<field",e.string+=" ",e.string+="accessType='",e.string+=t.AccessType(n.getAccessType()),e.string+="'",e.string+=" ",e.string+="type='",e.string+=n.getTypeName(),e.string+="'",e.string+=" ",e.string+="name='",e.string+=t.XMLEncode(n.getName()),e.string+="'",e.string+="/>\n";t.DecIndent(),e.string+=t.Indent(),e.string+="</ExternProtoDeclare>"}}),Object.defineProperty(l.prototype,"name",{get:function(){return this.getName()},enumerable:!0,configurable:!1}),Object.defineProperty(l.prototype,"fields",{get:function(){return this.getFieldDefinitions()},enumerable:!0,configurable:!1}),Object.defineProperty(l.prototype,"isExternProto",{get:function(){return!0},enumerable:!0,configurable:!1}),Object.defineProperty(l.prototype,"urls",{get:function(){return this.url_.copy()},enumerable:!0,configurable:!1}),Object.defineProperty(l.prototype,"loadState",{get:function(){return this.checkLoadState()},enumerable:!0,configurable:!1}),l}),define("x_ite/Prototype/X3DProtoDeclaration",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Execution/X3DExecutionContext","x_ite/Prototype/X3DProtoDeclarationNode","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(e,t,i,n,r,s,o,a){"use strict";function u(e){s.call(this,e),r.call(this,e),this.addType(o.X3DProtoDeclaration),this.addChildObjects("loadState",new t.SFInt32(o.NOT_STARTED_STATE))}return u.prototype=Object.assign(Object.create(r.prototype),s.prototype,{constructor:u,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new t.SFNode)]),getTypeName:function(){return"PROTO"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"protos"},initialize:function(){s.prototype.initialize.call(this),this.loadState_=o.COMPLETE_STATE},getSpecificationVersion:function(){return this.getExecutionContext().getSpecificationVersion()},getEncoding:function(){return this.getExecutionContext().getEncoding()},getURL:function(){return this.getExecutionContext().getURL()},getProtoDeclaration:function(){return this},checkLoadState:function(){return this.loadState_.getValue()},fromUnit:function(e,t){return this.getExecutionContext().fromUnit(e,t)},toUnit:function(e,t){return this.getExecutionContext().toUnit(e,t)},hasUserDefinedFields:function(){return!0},toXMLStream:function(e){var t=a.Get(e);e.string+=t.Indent(),e.string+="<ProtoDeclare",e.string+=" ",e.string+="name='",e.string+=t.XMLEncode(this.getName()),e.string+="'",e.string+=">",e.string+="\n",t.EnterScope();var i=this.getUserDefinedFields();if(0!==i.size){t.IncIndent(),e.string+=t.Indent(),e.string+="<ProtoInterface>\n",t.IncIndent();for(var n of i.values())if(e.string+=t.Indent(),e.string+="<field",e.string+=" ",e.string+="accessType='",e.string+=t.AccessType(n.getAccessType()),e.string+="'",e.string+=" ",e.string+="type='",e.string+=n.getTypeName(),e.string+="'",e.string+=" ",e.string+="name='",e.string+=t.XMLEncode(n.getName()),e.string+="'",n.isDefaultValue())e.string+="/>\n";else switch(n.getType()){case o.SFNode:case o.MFNode:t.PushContainerField(null),e.string+=">\n",t.IncIndent(),n.toXMLStream(e),e.string+="\n",t.DecIndent(),e.string+=t.Indent(),e.string+="</field>\n",t.PopContainerField();break;default:e.string+=" ",e.string+="value='",n.toXMLStream(e),e.string+="'",e.string+="/>\n"}t.DecIndent(),e.string+=t.Indent(),e.string+="</ProtoInterface>\n",t.DecIndent()}t.LeaveScope(),t.IncIndent(),e.string+=t.Indent(),e.string+="<ProtoBody>\n",t.IncIndent(),r.prototype.toXMLStream.call(this,e),t.DecIndent(),e.string+=t.Indent(),e.string+="</ProtoBody>\n",t.DecIndent(),e.string+=t.Indent(),e.string+="</ProtoDeclare>"}}),Object.defineProperty(u.prototype,"name",{get:function(){return this.getName()},enumerable:!0,configurable:!1}),Object.defineProperty(u.prototype,"fields",{get:function(){return this.getFieldDefinitions()},enumerable:!0,configurable:!1}),Object.defineProperty(u.prototype,"isExternProto",{get:function(){return!1},enumerable:!0,configurable:!1}),u}),define("x_ite/Parser/Parser",["x_ite/Fields","x_ite/Parser/X3DParser","x_ite/Prototype/X3DExternProtoDeclaration","x_ite/Prototype/X3DProtoDeclaration","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){switch(e){case r.inializeOnly:return"initializeOnly";case r.inputOnly:return"inputOnly";case r.outputOnly:return"outputOnly";case r.inputOutput:return"inputOutput"}}function o(e){return this.lastIndex=e.lastIndex,e.result=this.exec(e.input),!!e.result&&(e.lastIndex=this.lastIndex,!0)}function a(e){t.call(this,e)}var u={Whitespaces:new RegExp("([\\x20\\n,\\t\\r]+)","gy"),Comment:new RegExp("#(.*?)(?=[\\n\\r])","gy"),Header:new RegExp("^#(VRML|X3D) V(.*?) (utf8)(?: (.*?))?[\\n\\r]","gy"),AS:new RegExp("AS","gy"),COMPONENT:new RegExp("COMPONENT","gy"),DEF:new RegExp("DEF","gy"),EXPORT:new RegExp("EXPORT","gy"),EXTERNPROTO:new RegExp("EXTERNPROTO","gy"),FALSE:new RegExp("FALSE|false","gy"),IMPORT:new RegExp("IMPORT","gy"),IS:new RegExp("IS","gy"),META:new RegExp("META","gy"),NULL:new RegExp("NULL","gy"),TRUE:new RegExp("TRUE|true","gy"),PROFILE:new RegExp("PROFILE","gy"),PROTO:new RegExp("PROTO","gy"),ROUTE:new RegExp("ROUTE","gy"),TO:new RegExp("TO","gy"),UNIT:new RegExp("UNIT","gy"),USE:new RegExp("USE","gy"),OpenBrace:new RegExp("\\{","gy"),CloseBrace:new RegExp("\\}","gy"),OpenBracket:new RegExp("\\[","gy"),CloseBracket:new RegExp("\\]","gy"),Period:new RegExp("\\.","gy"),Colon:new RegExp("\\:","gy"),Id:new RegExp("([^\\x30-\\x39\\x00-\\x20\\x22\\x23\\x27\\x2b\\x2c\\x2d\\x2e\\x5b\\x5c\\x5d\\x7b\\x7d\\x7f]{1}[^\\x00-\\x20\\x22\\x23\\x27\\x2c\\x2e\\x5b\\x5c\\x5d\\x7b\\x7d\\x7f]*)","gy"),ComponentNameId:new RegExp("([^\\x30-\\x39\\x00-\\x20\\x22\\x23\\x27\\x2b\\x2c\\x2d\\x2e\\x5b\\x5c\\x5d\\x7b\\x7d\\x7f\\x3a]{1}[^\\x00-\\x20\\x22\\x23\\x27\\x2c\\x2e\\x5b\\x5c\\x5d\\x7b\\x7d\\x7f\\x3a]*)","gy"),initializeOnly:new RegExp("initializeOnly","gy"),inputOnly:new RegExp("inputOnly","gy"),outputOnly:new RegExp("outputOnly","gy"),inputOutput:new RegExp("inputOutput","gy"),field:new RegExp("field","gy"),eventIn:new RegExp("eventIn","gy"),eventOut:new RegExp("eventOut","gy"),exposedField:new RegExp("exposedField","gy"),FieldType:new RegExp("(MFBool|MFColorRGBA|MFColor|MFDouble|MFFloat|MFImage|MFInt32|MFMatrix3d|MFMatrix3f|MFMatrix4d|MFMatrix4f|MFNode|MFRotation|MFString|MFTime|MFVec2d|MFVec2f|MFVec3d|MFVec3f|MFVec4d|MFVec4f|SFBool|SFColorRGBA|SFColor|SFDouble|SFFloat|SFImage|SFInt32|SFMatrix3d|SFMatrix3f|SFMatrix4d|SFMatrix4f|SFNode|SFRotation|SFString|SFTime|SFVec2d|SFVec2f|SFVec3d|SFVec3f|SFVec4d|SFVec4f)","gy"),int32:new RegExp("((?:0[xX][\\da-fA-F]+)|(?:[+-]?\\d+))","gy"),double:new RegExp("([+-]?(?:(?:(?:\\d*\\.\\d+)|(?:\\d+(?:\\.)?))(?:[eE][+-]?\\d+)?))","gy"),string:new RegExp('"((?:[^\\\\"]|\\\\\\\\|\\\\\\")*)"',"gy"),Inf:new RegExp("[+]?(?:inf|Infinity)","gy"),NegativeInf:new RegExp("-(?:inf|Infinity)","gy"),NaN:new RegExp("[+-]?(nan|NaN)","gy"),Break:new RegExp("\\r?\\n","g")};for(var l in u)u[l].parse=o;return Object.preventExtensions(u),Object.freeze(u),Object.seal(u),a.prototype=Object.assign(Object.create(t.prototype),{accessTypes:{field:r.initializeOnly,eventIn:r.inputOnly,eventOut:r.outputOnly,exposedField:r.inputOutput,initializeOnly:r.initializeOnly,inputOnly:r.inputOnly,outputOnly:r.outputOnly,inputOutput:r.inputOutput},SFBool:new e.SFBool,SFColor:new e.SFColor,SFColorRGBA:new e.SFColorRGBA,SFDouble:new e.SFDouble,SFFloat:new e.SFFloat,SFImage:new e.SFImage,SFInt32:new e.SFInt32,SFMatrix3f:new e.SFMatrix3f,SFMatrix3d:new e.SFMatrix3d,SFMatrix4f:new e.SFMatrix4f,SFMatrix4d:new e.SFMatrix4d,SFNode:new e.SFNode,SFRotation:new e.SFRotation,SFString:new e.SFString,SFTime:new e.SFTime,SFVec2d:new e.SFVec2d,SFVec2f:new e.SFVec2f,SFVec3d:new e.SFVec3d,SFVec3f:new e.SFVec3f,SFVec4d:new e.SFVec4d,SFVec4f:new e.SFVec4f,MFBool:new e.MFBool,MFColor:new e.MFColor,MFColorRGBA:new e.MFColorRGBA,MFDouble:new e.MFDouble,MFFloat:new e.MFFloat,MFImage:new e.MFImage,MFInt32:new e.MFInt32,MFMatrix3d:new e.MFMatrix3d,MFMatrix3f:new e.MFMatrix3f,MFMatrix4d:new e.MFMatrix4d,MFMatrix4f:new e.MFMatrix4f,MFNode:new e.MFNode,MFRotation:new e.MFRotation,MFString:new e.MFString,MFTime:new e.MFTime,MFVec2d:new e.MFVec2d,MFVec2f:new e.MFVec2f,MFVec3d:new e.MFVec3d,MFVec3f:new e.MFVec3f,MFVec4d:new e.MFVec4d,MFVec4f:new e.MFVec4f,setInput:function(e){this.input=e,this.lineNumber=1,this.lastIndex=0},getInput:function(){return this.input},exception:function(e){if(this.getBrowser().isStrict())throw new Error(e);this.getBrowser().println(e)},parseIntoScene:function(e){try{return this.getScene().setEncoding("VRML"),this.getScene().setProfile(this.getBrowser().getProfile("Full")),this.setInput(e),void this.x3dScene()}catch(e){throw new Error(this.getError(e))}},getError:function(e){var t=e.message,i=this.getLine(),n=this.getLastLine(),r=this.getLastLine(),s=n.length-i.length+1;return n.length>80&&(n=n.substr(s-40,80),r="",s=40),"\n********************************************************************************\nParser error at line "+this.lineNumber+":"+s+"\nin '"+this.getScene().getURL()+"'\n\n"+r+"\n"+n+"\n"+Array(s).join(" ")+"^\n"+t+"\n********************************************************************************\n"},getLine:function(){for(var e=this.input,t=this.lastIndex,i="";t<e.length&&"\n"!==e[t]&&"\r"!==e[t];)i+=e[t++];return this.lastIndex=t,i},getLastLine:function(){var e=this.input,t=this.lastIndex,i="";for(t<e.length&&("\n"!==e[t]||"\r"!==e[t])&&--t;t>=0&&"\n"!==e[t]&&"\r"!==e[t];)i=e[t--]+i;return this.lastIndex=t,i},comments:function(){for(;this.comment(););},comment:function(){return!!this.whitespaces()||u.Comment.parse(this)},whitespaces:function(){return!!u.Whitespaces.parse(this)&&(this.xml||this.lines(this.result[1]),!0)},lines:function(e){var t=e.match(u.Break);t&&(this.lineNumber+=t.length)},x3dScene:function(){this.pushExecutionContext(this.getScene()),this.headerStatement(),this.profileStatement(),this.componentStatements(),this.unitStatements(),this.metaStatements();try{this.setUnits(this.getScene().getMetaData("generator"))}catch(e){}if(this.statements(),this.popExecutionContext(this.getScene()),this.lastIndex<this.input.length)throw new Error("Unknown statement.")},headerStatement:function(){u.Header.lastIndex=0;var e=u.Header.exec(this.input);return!!e&&(this.getScene().specificationVersion=e[2],this.getScene().encoding="VRML",!0)},profileStatement:function(){if(this.comments(),u.PROFILE.parse(this)){if(this.profileNameId()){var e=this.getBrowser().getProfile(this.result[1]);return void this.getScene().setProfile(e)}throw new Error("Expected a profile name.")}},componentStatements:function(){for(var e=this.componentStatement();e;)this.getScene().addComponent(e),e=this.componentStatement()},componentStatement:function(){if(this.comments(),u.COMPONENT.parse(this)){if(this.componentNameId()){var e=this.result[1];if(this.comments(),u.Colon.parse(this)){if(this.componentSupportLevel()){var t=this.value;return this.getBrowser().getComponent(e,t)}throw new Error("Expected a component support level.")}throw new Error("Expected a ':' after component name.")}throw new Error("Expected a component name.")}return null},componentSupportLevel:function(){return this.int32()},unitStatements:function(){for(;this.unitStatement(););},unitStatement:function(){if(this.comments(),u.UNIT.parse(this)){if(this.categoryNameId()){var e=this.result[1];if(this.unitNameId()){var t=this.result[1];if(this.unitConversionFactor()){var i=this.value;try{return this.getScene().updateUnit(e,t,i),!0}catch(e){return console.log(e.message),!0}}throw new Error("Expected unit conversion factor.")}throw new Error("Expected unit name identificator.")}throw new Error("Expected category name identificator after UNIT statement.")}return!1},unitConversionFactor:function(){return this.double()},metaStatements:function(){for(;this.metaStatement(););},metaStatement:function(){if(this.comments(),u.META.parse(this)){if(this.metakey()){var e=this.value;if(this.metavalue()){var t=this.value;return this.getScene().setMetaData(e,t),!0}throw new Error("Expected metadata value.")}throw new Error("Expected metadata key.")}return!1},metakey:function(){return this.string()},metavalue:function(){return this.string()},exportStatement:function(){if(this.comments(),u.EXPORT.parse(this)){if(this.nodeNameId()){var e=this.result[1],t="";this.comments();var i=this.getScene().getLocalNode(e);if(u.AS.parse(this)){if(!this.exportedNodeNameId())throw new Error("No name given after AS.");t=this.result[1]}else t=e;return this.getScene().updateExportedNode(t,i),!0}throw new Error("No name given after EXPORT.")}return!1},importStatement:function(){if(this.comments(),u.IMPORT.parse(this)){if(this.nodeNameId()){var e=this.result[1],t=this.getExecutionContext().getNamedNode(e);if(this.comments(),u.Period.parse(this)){if(this.exportedNodeNameId()){var i=this.result[1],n=i;if(this.comments(),u.AS.parse(this)){if(!this.nodeNameId())throw new Error("No name given after AS.");n=this.result[1]}return this.getExecutionContext().updateImportedNode(t,i,n),!0}throw new Error("Expected exported node name.")}throw new Error("Expected a '.' after exported node name.")}throw new Error("No name given after IMPORT statement.")}return!1},statements:function(){for(;this.statement(););},statement:function(){if(this.protoStatement())return!0;if(this.routeStatement())return!0;if(this.importStatement())return!0;if(this.exportStatement())return!0;var e=this.nodeStatement();return e!==!1&&(this.addRootNode(e),!0)},nodeStatement:function(){if(this.comments(),u.DEF.parse(this)){if(this.nodeNameId())return this.node(this.result[1]);throw new Error("No name given after DEF.")}if(u.USE.parse(this)){if(this.nodeNameId())return this.getExecutionContext().getNamedNode(this.result[1]).getValue();throw new Error("No name given after USE.")}return u.NULL.parse(this)?null:this.node("")},protoStatement:function(){return!!this.proto()||!!this.externproto()},protoStatements:function(){for(;this.protoStatement(););},proto:function(){if(this.comments(),u.PROTO.parse(this)){if(this.nodeTypeId()){var e=this.result[1];if(this.comments(),u.OpenBracket.parse(this)){var t=this.interfaceDeclarations();if(this.comments(),u.CloseBracket.parse(this)){if(this.comments(),u.OpenBrace.parse(this)){for(var i=new n(this.getExecutionContext()),r=0,s=t.length;r<s;++r){var o=t[r];i.addUserDefinedField(o.getAccessType(),o.getName(),o)}if(this.pushExecutionContext(i),this.protoBody(),this.popExecutionContext(),this.comments(),u.CloseBrace.parse(this))return i.setName(e),i.setup(),this.getExecutionContext().protos.add(e,i),!0;throw new Error("Expected a '}' at the end of PROTO body.")}throw new Error("Expected a '{' at the beginning of PROTO body.")}throw new Error("Expected a ']' at the end of PROTO interface declaration.")}throw new Error("Expected a '[' at the beginning of PROTO interface declaration.")}throw new Error("Invalid PROTO definition name.")}return!1},protoBody:function(){this.protoStatements();var e=this.rootNodeStatement();e!==!1&&this.addRootNode(e),this.statements()},rootNodeStatement:function(){if(this.comments(),u.DEF.parse(this)){if(this.nodeNameId()){var e=this.result[0],t=this.node(e);if(t!==!1)return t;throw new Error("Expected node type name after DEF.")}throw new Error("No name given after DEF.")}var t=this.node("");return t!==!1&&t},interfaceDeclarations:function(){for(var e=[],t=this.interfaceDeclaration();t;)e.push(t),t=this.interfaceDeclaration();return e},restrictedInterfaceDeclaration:function(){if(this.comments(),u.inputOnly.parse(this)||u.eventIn.parse(this)){if(this.fieldType()){var e=this.result[1];if(this.inputOnlyId()){var t=this.result[1],i=new this[e].constructor;return i.setAccessType(r.inputOnly),i.setName(t),i}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(u.outputOnly.parse(this)||u.eventOut.parse(this)){if(this.fieldType()){var e=this.result[1];if(this.outputOnlyId()){var t=this.result[1],i=new this[e].constructor;return i.setAccessType(r.outputOnly),i.setName(t),i}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(u.initializeOnly.parse(this)||u.field.parse(this)){if(this.fieldType()){var e=this.result[1];if(this.initializeOnlyId()){var t=this.result[1],i=new this[e].constructor;if(this.fieldValue(i))return i.setAccessType(r.initializeOnly),i.setName(t),i;throw new Error("Couldn't read value for field '"+t+"'.")}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}return null},interfaceDeclaration:function(){var e=this.restrictedInterfaceDeclaration();if(e)return e;if(this.comments(),u.inputOutput.parse(this)||u.exposedField.parse(this)){if(this.fieldType()){var t=this.result[1];if(this.inputOutputId()){var i=this.result[1],e=new this[t].constructor;if(this.fieldValue(e))return e.setAccessType(r.inputOutput),e.setName(i),e;throw new Error("Couldn't read value for field '"+i+"'.")}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}return null},externproto:function(){if(this.comments(),u.EXTERNPROTO.parse(this)){if(this.nodeTypeId()){var e=this.result[1];if(this.comments(),u.OpenBracket.parse(this)){var t=this.externInterfaceDeclarations();if(this.comments(),u.CloseBracket.parse(this)){if(this.URLList(this.MFString)){for(var n=new i(this.getExecutionContext()),r=0,s=t.length;r<s;++r){var o=t[r];n.addUserDefinedField(o.getAccessType(),o.getName(),o)}return n.setName(e),n.url_=this.MFString,n.setup(),this.getExecutionContext().externprotos.add(e,n),!0}throw new Error("Expected a URL list after EXTERNPROTO interface declaration '"+e+"'.")}throw new Error("Expected a ']' at the end of EXTERNPROTO interface declaration.")}throw new Error("Expected a '[' at the beginning of EXTERNPROTO interface declaration.")}throw new Error("Invalid EXTERNPROTO definition name.")}return!1},externInterfaceDeclarations:function(){for(var e=[],t=this.externInterfaceDeclaration();t;)e.push(t),t=this.externInterfaceDeclaration();return e},externInterfaceDeclaration:function(){if(this.comments(),u.inputOnly.parse(this)||u.eventIn.parse(this)){if(this.fieldType()){var e=this.result[1];if(this.inputOnlyId()){var t=this.result[1],i=new this[e].constructor;return i.setAccessType(r.inputOnly),i.setName(t),i}
throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(u.outputOnly.parse(this)||u.eventOut.parse(this)){if(this.fieldType()){var e=this.result[1];if(this.outputOnlyId()){var t=this.result[1],i=new this[e].constructor;return i.setAccessType(r.outputOnly),i.setName(t),i}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(u.initializeOnly.parse(this)||u.field.parse(this)){if(this.fieldType()){var e=this.result[1];if(this.initializeOnlyId()){var t=this.result[1],i=new this[e].constructor;return i.setAccessType(r.initializeOnly),i.setName(t),i}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(u.inputOutput.parse(this)||u.exposedField.parse(this)){if(this.fieldType()){var e=this.result[1];if(this.inputOutputId()){var t=this.result[1],i=new this[e].constructor;return i.setAccessType(r.inputOutput),i.setName(t),i}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}return null},URLList:function(e){return this.mfstringValue(e)},routeStatement:function(){if(this.comments(),u.ROUTE.parse(this)){if(this.nodeNameId()){var e=this.result[1],t=this.getExecutionContext().getLocalNode(e);if(this.comments(),u.Period.parse(this)){if(this.outputOnlyId()){var i=this.result[1];if(this.comments(),u.TO.parse(this)){if(this.nodeNameId()){var n=this.result[1],r=this.getExecutionContext().getLocalNode(n);if(this.comments(),u.Period.parse(this)){if(this.inputOnlyId())try{var s=this.result[1];return this.getExecutionContext().addRoute(t,i,r,s),!0}catch(e){return this.exception(e.message),!0}throw new Error("Bad ROUTE specification: Expected a field name.")}throw new Error("Bad ROUTE specification: Expected a '.' after node name.")}throw new Error("Bad ROUTE specification: Expected a node name.")}throw new Error("Bad ROUTE specification: Expected a 'TO'.")}throw new Error("Bad ROUTE specification: Expected a field name.")}throw new Error("Bad ROUTE specification: Expected a '.' after node name.")}throw new Error("Bad ROUTE specification: Expected a node name.")}return!1},node:function(e){if(this.nodeTypeId()){var t=this.result[1];try{var i=this.getExecutionContext().createNode(t,!1)}catch(e){try{var i=this.getExecutionContext().createProto(t,!1)}catch(t){throw new Error(e.message+"\n"+t.message)}}if(e.length){try{var n=this.getExecutionContext().getNamedNode(e);this.getExecutionContext().updateNamedNode(this.getExecutionContext().getUniqueName(e),n)}catch(e){}this.getExecutionContext().updateNamedNode(e,i)}if(this.comments(),u.OpenBrace.parse(this)){if(i.hasUserDefinedFields()?this.scriptBody(i):this.nodeBody(i),this.comments(),u.CloseBrace.parse(this))return this.getExecutionContext().addUninitializedNode(i),i;throw new Error("Expected '}' at the end of node body.")}throw new Error("Expected '{' at the beginning of node body.")}return!1},scriptBody:function(e){for(;this.scriptBodyElement(e););},scriptBodyElement:function(e){var t=this.lastIndex,i=this.lineNumber;if(this.Id()){var n=this.accessTypes[this.result[1]];if(n&&this.fieldType()){var o=this.result[1];if(this.Id()){var a=this.result[1];if(this.comments(),u.IS.parse(this)){if(this.isInsideProtoDefinition()){if(this.Id()){var l=this.result[1];try{var h=this.getExecutionContext().getField(l)}catch(e){return this.exception("No such event or field '"+l+"' inside PROTO "+this.getExecutionContext().getName()+" interface declaration."),!0}var c=this[o];if(c.getType()===h.getType()){if(h.isReference(n)){try{var d=e.getField(a);if(h.getType()===d.getType())if(n===d.getAccessType());else{if(d.getAccessType()!==r.inputOutput)return this.exception("Field '"+a+"' must have access type "+s(d.getAccessType())+"."),!0;n!==d.getAccessType()&&(d=this.createUserDefinedField(e,n,a,c))}else d=this.createUserDefinedField(e,n,a,c)}catch(t){var d=this.createUserDefinedField(e,n,a,c)}return d.addReference(h),!0}throw new Error("Field '"+a+"' and '"+h.getName()+"' in PROTO '"+this.getExecutionContext().getName()+"' are incompatible as an IS mapping.")}throw new Error("Field '"+a+"' and '"+h.getName()+"' in PROTO '"+this.getExecutionContext().getName()+"' have different types.")}throw new Error("No name give after IS statement.")}throw new Error("IS statement outside PROTO definition.")}}}}this.lastIndex=t,this.lineNumber=i;var d=this.interfaceDeclaration();if(d){try{if(d.getAccessType()===r.inputOutput){var p=e.getField(d.getName());if(p.getAccessType()===r.inputOutput&&d.getType()===p.getType())return p.set(d.getValue()),p.setSet(!0),!0}}catch(e){}return e.addUserDefinedField(d.getAccessType(),d.getName(),d),!0}return this.nodeBodyElement(e)},createUserDefinedField:function(e,t,i,n){var r=new n.constructor;return e.addUserDefinedField(t,i,r),r},nodeBody:function(e){for(;this.nodeBodyElement(e););},nodeBodyElement:function(e){if(this.protoStatement())return!0;if(this.routeStatement())return!0;if(this.Id()){var t=this.result[1];try{var i=e.getField(t)}catch(i){throw new Error("Unknown field '"+t+"' in class '"+e.getTypeName()+"'.")}if(this.comments(),u.IS.parse(this)){if(this.isInsideProtoDefinition()){if(this.Id()){var n=this.result[1];try{var r=this.getExecutionContext().getField(n)}catch(e){return this.exception("No such event or field '"+n+"' inside PROTO "+this.getExecutionContext().getName()),!0}if(i.getType()===r.getType()){if(r.isReference(i.getAccessType()))return i.addReference(r),!0;throw new Error("Field '"+i.getName()+"' and '"+r.getName()+"' in PROTO "+this.getExecutionContext().getName()+" are incompatible as an IS mapping.")}throw new Error("Field '"+i.getName()+"' and '"+r.getName()+"' in PROTO "+this.getExecutionContext().getName()+" have different types.")}throw new Error("No name give after IS statement.")}throw new Error("IS statement outside PROTO definition.")}if(i.isInitializable()){if(this.fieldValue(i))return!0;throw new Error("Couldn't read value for field '"+t+"'.")}throw new Error("Couldn't assign value to "+s(i.getAccessType())+" field '"+t+"'.")}return!1},profileNameId:function(){return this.Id()},componentNameId:function(){return this.comments(),u.ComponentNameId.parse(this)},categoryNameId:function(){return this.Id()},unitNameId:function(){return this.Id()},exportedNodeNameId:function(){return this.Id()},nodeNameId:function(){return this.Id()},nodeTypeId:function(){return this.Id()},initializeOnlyId:function(){return this.Id()},inputOnlyId:function(){return this.Id()},outputOnlyId:function(){return this.Id()},inputOutputId:function(){return this.Id()},Id:function(){return this.comments(),u.Id.parse(this)},fieldType:function(){return this.comments(),u.FieldType.parse(this)},fieldValue:function(e){return e.setSet(!0),this.fieldTypes[e.getType()].call(this,e)},double:function(){return this.comments(),u.double.parse(this)?(this.value=parseFloat(this.result[1]),!0):u.Inf.parse(this)?(this.value=Number.POSITIVE_INFINITY,!0):u.NegativeInf.parse(this)?(this.value=Number.NEGATIVE_INFINITY,!0):!!u.NaN.parse(this)&&(this.value=Number.NaN,!0)},int32:function(){return this.comments(),!!u.int32.parse(this)&&(this.value=parseInt(this.result[1]),!0)},string:function(){return this.comments(),!!u.string.parse(this)&&(this.value=e.SFString.unescape(this.result[1]),this.lines(this.value),!0)},sfboolValue:function(e){return this.comments(),u.TRUE.parse(this)?(e.set(!0),!0):!!u.FALSE.parse(this)&&(e.set(!1),!0)},mfboolValue:function(e){if(e.length=0,this.sfboolValue(this.SFBool))return e.push(this.SFBool),!0;if(u.OpenBracket.parse(this)){if(this.sfboolValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfboolValues:function(e){for(e.length=0,e=e.getTarget();this.sfboolValue(this.SFBool);)e.push(this.SFBool)},sfcolorValue:function(e){if(this.double()){var t=this.value;if(this.double()){var i=this.value;if(this.double()){var n=this.value;return e.getValue().set(t,i,n),!0}}}return!1},mfcolorValue:function(e){if(e.length=0,this.sfcolorValue(this.SFColor))return e.push(this.SFColor),!0;if(u.OpenBracket.parse(this)){if(this.sfcolorValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfcolorValues:function(e){for(e.length=0,e=e.getTarget();this.sfcolorValue(this.SFColor);)e.push(this.SFColor)},sfcolorrgbaValue:function(e){if(this.double()){var t=this.value;if(this.double()){var i=this.value;if(this.double()){var n=this.value;if(this.double()){var r=this.value;return e.getValue().set(t,i,n,r),!0}}}}return!1},mfcolorrgbaValue:function(e){if(e.length=0,this.sfcolorrgbaValue(this.SFColorRGBA))return e.push(this.SFColorRGBA),!0;if(u.OpenBracket.parse(this)){if(this.sfcolorrgbaValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfcolorrgbaValues:function(e){for(e.length=0,e=e.getTarget();this.sfcolorrgbaValue(this.SFColorRGBA);)e.push(this.SFColorRGBA)},sfdoubleValue:function(e){return!!this.double()&&(e.set(this.fromUnit(e.getUnit(),this.value)),!0)},mfdoubleValue:function(e){if(e.length=0,this.SFDouble.setUnit(e.getUnit()),this.sfdoubleValue(this.SFDouble))return e.push(this.SFDouble),!0;if(u.OpenBracket.parse(this)){if(this.sfdoubleValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfdoubleValues:function(e){for(e.length=0,e=e.getTarget(),this.SFDouble.setUnit(e.getUnit());this.sfdoubleValue(this.SFDouble);)e.push(this.SFDouble)},sffloatValue:function(e){return this.sfdoubleValue(e)},mffloatValue:function(e){if(e.length=0,this.SFFloat.setUnit(e.getUnit()),this.sffloatValue(this.SFFloat))return e.push(this.SFFloat),!0;if(u.OpenBracket.parse(this)){if(this.sffloatValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sffloatValues:function(e){for(e.length=0,e=e.getTarget(),this.SFFloat.setUnit(e.getUnit());this.sffloatValue(this.SFFloat);)e.push(this.SFFloat)},sfimageValue:function(e){if(this.int32()){var t=this.value;if(this.int32()){var i=this.value;if(this.int32()){var n=this.value,r=t*i;e.width=t,e.height=i,e.comp=n;for(var s=e.array,o=0;o<r;++o){if(!this.int32())return!1;s[o]=this.value}return!0}}}return!1},mfimageValue:function(e){if(e.length=0,this.sfimageValue(this.SFImage))return e.push(this.SFImage),!0;if(u.OpenBracket.parse(this)){if(this.sfimageValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfimageValues:function(e){for(e.length=0,e=e.getTarget();this.sfimageValue(this.SFImage);)e.push(this.SFImage)},sfint32Value:function(e){return!!this.int32()&&(e.set(this.value),!0)},mfint32Value:function(e){if(e.length=0,this.sfint32Value(this.SFInt32))return e.push(this.SFInt32),!0;if(u.OpenBracket.parse(this)){if(this.sfint32Values(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfint32Values:function(e){for(e.length=0,e=e.getTarget();this.sfint32Value(this.SFInt32);)e.push(this.SFInt32)},sfmatrix3dValue:function(e){if(this.double()){var t=this.value;if(this.double()){var i=this.value;if(this.double()){var n=this.value;if(this.double()){var r=this.value;if(this.double()){var s=this.value;if(this.double()){var o=this.value;if(this.double()){var a=this.value;if(this.double()){var u=this.value;if(this.double()){var l=this.value;return e.getValue().set(t,i,n,r,s,o,a,u,l),!0}}}}}}}}}return!1},mfmatrix3dValue:function(e){if(e.length=0,this.sfmatrix3dValue(this.SFMatrix3d))return e.push(this.SFMatrix3d),!0;if(u.OpenBracket.parse(this)){if(this.sfmatrix3dValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfmatrix3dValues:function(e){for(e.length=0,e=e.getTarget();this.sfmatrix3dValue(this.SFMatrix3d);)e.push(this.SFMatrix3d)},sfmatrix3fValue:function(e){return this.sfmatrix3dValue(e)},mfmatrix3fValue:function(e){if(e.length=0,this.sfmatrix3fValue(this.SFMatrix3f))return e.push(this.SFMatrix3f),!0;if(u.OpenBracket.parse(this)){if(this.sfmatrix3fValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfmatrix3fValues:function(e){for(e.length=0,e=e.getTarget();this.sfmatrix3fValue(this.SFMatrix3f);)e.push(this.SFMatrix3f)},sfmatrix4dValue:function(e){if(this.double()){var t=this.value;if(this.double()){var i=this.value;if(this.double()){var n=this.value;if(this.double()){var r=this.value;if(this.double()){var s=this.value;if(this.double()){var o=this.value;if(this.double()){var a=this.value;if(this.double()){var u=this.value;if(this.double()){var l=this.value;if(this.double()){var h=this.value;if(this.double()){var c=this.value;if(this.double()){var d=this.value;if(this.double()){var p=this.value;if(this.double()){var f=this.value;if(this.double()){var g=this.value;if(this.double()){var m=this.value;return e.getValue().set(t,i,n,r,s,o,a,u,l,h,c,d,p,f,g,m),!0}}}}}}}}}}}}}}}}return!1},mfmatrix4dValue:function(e){if(e.length=0,this.sfmatrix4dValue(this.SFMatrix4d))return e.push(this.SFMatrix4d),!0;if(u.OpenBracket.parse(this)){if(this.sfmatrix4dValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfmatrix4dValues:function(e){for(e.length=0,e=e.getTarget();this.sfmatrix4dValue(this.SFMatrix4d);)e.push(this.SFMatrix4d)},sfmatrix4fValue:function(e){return this.sfmatrix4dValue(e)},mfmatrix4fValue:function(e){if(e.length=0,this.sfmatrix4fValue(this.SFMatrix4f))return e.push(this.SFMatrix4f),!0;if(u.OpenBracket.parse(this)){if(this.sfmatrix4fValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfmatrix4fValues:function(e){for(e.length=0,e=e.getTarget();this.sfmatrix4fValue(this.SFMatrix4f);)e.push(this.SFMatrix4f)},sfnodeValue:function(e){var t=this.nodeStatement();return t!==!1&&(e.setValue(t),!0)},mfnodeValue:function(e){e.length=0;var t=this.nodeStatement();if(t!==!1)return e.push(t),!0;if(u.OpenBracket.parse(this)){if(this.nodeStatements(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},nodeStatements:function(e){for(var t=this.nodeStatement();t!==!1;)e.push(t),t=this.nodeStatement()},sfrotationValue:function(e){if(this.double()){var t=this.value;if(this.double()){var i=this.value;if(this.double()){var n=this.value;if(this.double()){var r=this.value;return e.getValue().set(t,i,n,this.fromUnit("angle",r)),!0}}}}return!1},mfrotationValue:function(e){if(e.length=0,this.sfrotationValue(this.SFRotation))return e.push(this.SFRotation),!0;if(u.OpenBracket.parse(this)){if(this.sfrotationValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfrotationValues:function(e){for(e.length=0,e=e.getTarget();this.sfrotationValue(this.SFRotation);)e.push(this.SFRotation)},sfstringValue:function(e){return!!this.string()&&(e.set(this.value),!0)},mfstringValue:function(e){if(e.length=0,this.sfstringValue(this.SFString))return e.push(this.SFString),!0;if(u.OpenBracket.parse(this)){if(this.sfstringValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfstringValues:function(e){for(e.length=0,e=e.getTarget();this.sfstringValue(this.SFString);)e.push(this.SFString)},sftimeValue:function(e){return this.sfdoubleValue(e)},mftimeValue:function(e){if(e.length=0,this.sftimeValue(this.SFTime))return e.push(this.SFTime),!0;if(u.OpenBracket.parse(this)){if(this.sftimeValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sftimeValues:function(e){for(e.length=0,e=e.getTarget();this.sftimeValue(this.SFTime);)e.push(this.SFTime)},sfvec2dValue:function(e){if(this.double()){var t=this.value;if(this.double()){var i=this.value,n=e.getUnit();return e.getValue().set(this.fromUnit(n,t),this.fromUnit(n,i)),!0}}return!1},mfvec2dValue:function(e){if(e.length=0,this.SFVec2d.setUnit(e.getUnit()),this.sfvec2dValue(this.SFVec2d))return e.push(this.SFVec2d),!0;if(u.OpenBracket.parse(this)){if(this.sfvec2dValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec2dValues:function(e){for(e.length=0,e=e.getTarget(),this.SFVec2d.setUnit(e.getUnit());this.sfvec2dValue(this.SFVec2d);)e.push(this.SFVec2d)},sfvec2fValue:function(e){return this.sfvec2dValue(e)},mfvec2fValue:function(e){if(e.length=0,this.SFVec2f.setUnit(e.getUnit()),this.sfvec2fValue(this.SFVec2f))return e.push(this.SFVec2f),!0;if(u.OpenBracket.parse(this)){if(this.sfvec2fValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec2fValues:function(e){for(e.length=0,e=e.getTarget(),this.SFVec2f.setUnit(e.getUnit());this.sfvec2fValue(this.SFVec2f);)e.push(this.SFVec2f)},sfvec3dValue:function(e){if(this.double()){var t=this.value;if(this.double()){var i=this.value;if(this.double()){var n=this.value,r=e.getUnit();return e.getValue().set(this.fromUnit(r,t),this.fromUnit(r,i),this.fromUnit(r,n)),!0}}}return!1},mfvec3dValue:function(e){if(e.length=0,this.SFVec3d.setUnit(e.getUnit()),this.sfvec3dValue(this.SFVec3d))return e.push(this.SFVec3d),!0;if(u.OpenBracket.parse(this)){if(this.sfvec3dValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec3dValues:function(e){for(e.length=0,e=e.getTarget(),this.SFVec3d.setUnit(e.getUnit());this.sfvec3dValue(this.SFVec3d);)e.push(this.SFVec3d)},sfvec3fValue:function(e){return this.sfvec3dValue(e)},mfvec3fValue:function(e){if(e.length=0,this.SFVec3f.setUnit(e.getUnit()),this.sfvec3fValue(this.SFVec3f))return e.push(this.SFVec3f),!0;if(u.OpenBracket.parse(this)){if(this.sfvec3fValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec3fValues:function(e){for(e.length=0,e=e.getTarget(),this.SFVec3f.setUnit(e.getUnit());this.sfvec3fValue(this.SFVec3f);)e.push(this.SFVec3f)},sfvec4dValue:function(e){if(this.double()){var t=this.value;if(this.double()){var i=this.value;if(this.double()){var n=this.value;if(this.double()){var r=this.value,s=e.getUnit();return e.getValue().set(this.fromUnit(s,t),this.fromUnit(s,i),this.fromUnit(s,n),this.fromUnit(s,r)),!0}}}}return!1},mfvec4dValue:function(e){if(e.length=0,this.SFVec4d.setUnit(e.getUnit()),this.sfvec4dValue(this.SFVec4d))return e.push(this.SFVec4d),!0;if(u.OpenBracket.parse(this)){if(this.sfvec4dValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec4dValues:function(e){for(e.length=0,e=e.getTarget(),this.SFVec4d.setUnit(e.getUnit());this.sfvec4dValue(this.SFVec4d);)e.push(this.SFVec4d)},sfvec4fValue:function(e){return this.sfvec4dValue(e)},mfvec4fValue:function(e){if(e.length=0,this.SFVec4f.setUnit(e.getUnit()),this.sfvec4fValue(this.SFVec4f))return e.push(this.SFVec4f),!0;if(u.OpenBracket.parse(this)){if(this.sfvec4fValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec4fValues:function(e){for(e.length=0,e=e.getTarget(),this.SFVec4f.setUnit(e.getUnit());this.sfvec4fValue(this.SFVec4f);)e.push(this.SFVec4f)}}),a.prototype.fieldTypes=[],a.prototype.fieldTypes[r.SFBool]=a.prototype.sfboolValue,a.prototype.fieldTypes[r.SFColor]=a.prototype.sfcolorValue,a.prototype.fieldTypes[r.SFColorRGBA]=a.prototype.sfcolorrgbaValue,a.prototype.fieldTypes[r.SFDouble]=a.prototype.sfdoubleValue,a.prototype.fieldTypes[r.SFFloat]=a.prototype.sffloatValue,a.prototype.fieldTypes[r.SFImage]=a.prototype.sfimageValue,a.prototype.fieldTypes[r.SFInt32]=a.prototype.sfint32Value,a.prototype.fieldTypes[r.SFMatrix3f]=a.prototype.sfmatrix4dValue,a.prototype.fieldTypes[r.SFMatrix3d]=a.prototype.sfmatrix4fValue,a.prototype.fieldTypes[r.SFMatrix4f]=a.prototype.sfmatrix4dValue,a.prototype.fieldTypes[r.SFMatrix4d]=a.prototype.sfmatrix4fValue,a.prototype.fieldTypes[r.SFNode]=a.prototype.sfnodeValue,a.prototype.fieldTypes[r.SFRotation]=a.prototype.sfrotationValue,a.prototype.fieldTypes[r.SFString]=a.prototype.sfstringValue,a.prototype.fieldTypes[r.SFTime]=a.prototype.sftimeValue,a.prototype.fieldTypes[r.SFVec2d]=a.prototype.sfvec2dValue,a.prototype.fieldTypes[r.SFVec2f]=a.prototype.sfvec2fValue,a.prototype.fieldTypes[r.SFVec3d]=a.prototype.sfvec3dValue,a.prototype.fieldTypes[r.SFVec3f]=a.prototype.sfvec3fValue,a.prototype.fieldTypes[r.SFVec4d]=a.prototype.sfvec4dValue,a.prototype.fieldTypes[r.SFVec4f]=a.prototype.sfvec4fValue,a.prototype.fieldTypes[r.MFBool]=a.prototype.mfboolValue,a.prototype.fieldTypes[r.MFColor]=a.prototype.mfcolorValue,a.prototype.fieldTypes[r.MFColorRGBA]=a.prototype.mfcolorrgbaValue,a.prototype.fieldTypes[r.MFDouble]=a.prototype.mfdoubleValue,a.prototype.fieldTypes[r.MFFloat]=a.prototype.mffloatValue,a.prototype.fieldTypes[r.MFImage]=a.prototype.mfimageValue,a.prototype.fieldTypes[r.MFInt32]=a.prototype.mfint32Value,a.prototype.fieldTypes[r.MFMatrix3d]=a.prototype.mfmatrix3dValue,a.prototype.fieldTypes[r.MFMatrix3f]=a.prototype.mfmatrix3fValue,a.prototype.fieldTypes[r.MFMatrix4d]=a.prototype.mfmatrix4dValue,a.prototype.fieldTypes[r.MFMatrix4f]=a.prototype.mfmatrix4fValue,a.prototype.fieldTypes[r.MFNode]=a.prototype.mfnodeValue,a.prototype.fieldTypes[r.MFRotation]=a.prototype.mfrotationValue,a.prototype.fieldTypes[r.MFString]=a.prototype.mfstringValue,a.prototype.fieldTypes[r.MFTime]=a.prototype.mftimeValue,a.prototype.fieldTypes[r.MFVec2d]=a.prototype.mfvec2dValue,a.prototype.fieldTypes[r.MFVec2f]=a.prototype.mfvec2fValue,a.prototype.fieldTypes[r.MFVec3d]=a.prototype.mfvec3dValue,a.prototype.fieldTypes[r.MFVec3f]=a.prototype.mfvec3fValue,a.prototype.fieldTypes[r.MFVec4d]=a.prototype.mfvec4dValue,a.prototype.fieldTypes[r.MFVec4f]=a.prototype.mfvec4fValue,a}),define("standard/Utility/DataStorage",["jquery"],function(e){"use strict";function t(e,t){return this.target=this,i.set(this,e),n.set(this,t),new Proxy(this,r)}var i=new WeakMap,n=new WeakMap,r={get:function(t,i){var n=t[i];if(void 0!==n)return n;var n=t.getStorage()[t.getNameSpace()+i];if(void 0!==n&&"undefined"!==n)return e.parseJSON(n)},set:function(e,t,i){return void 0===i?e.getStorage().removeItem(e.getNameSpace()+t):e.getStorage()[e.getNameSpace()+t]=JSON.stringify(i),!0}};return t.prototype={constructor:t,getStorage:function(){return i.get(this.target)},getNameSpace:function(){return n.get(this.target)},clear:function(){var t=this.getStorage(),i=this.getNameSpace();e.each(t,function(e){e.substr(0,i.length)===i&&t.removeItem(e)})}},t}),define("x_ite/Browser/Core/X3DCoreContext",["jquery","x_ite/Fields","x_ite/Browser/Core/BrowserOptions","x_ite/Browser/Core/BrowserProperties","x_ite/Browser/Core/RenderingProperties","x_ite/Browser/Core/Notification","x_ite/Browser/Core/BrowserTimings","x_ite/Browser/Core/ContextMenu","x_ite/Execution/Scene","x_ite/Parser/Parser","standard/Utility/DataStorage"],function(e,t,i,n,r,s,o,a,u,l,h){"use strict";function c(e){var t=e.getContext("webgl")||e.getContext("experimental-webgl");if(!t)throw new Error("Couldn't create WebGL context.");var i=t.getParameter(t.ALIASED_LINE_WIDTH_RANGE);return 1===i[0]&&1===i[1]&&(t.lineWidth=Function.prototype),t}function d(t){this.number=++p,this.element=t;var l=e("<div></div>").addClass("x_ite-private-browser").prependTo(this.element),d=e("<div></div>").addClass("x_ite-private-splash-screen").appendTo(l),g=(e("<div></div>").addClass("x_ite-private-spinner").appendTo(d),e("<div></div>").addClass("x_ite-private-progress").appendTo(d)),m=e("<div></div>").addClass("x_ite-private-surface x_ite-private-surface-"+this.getId()).appendTo(l);e("<div></div>").addClass("x_ite-private-spinner-text").appendTo(g).text("Lade 0 Dateien"),e("<div></div>").addClass("x_ite-private-progressbar").appendTo(g).append(e("<div></div>")),this.splashScreen=d,this.surface=m,this.canvas=e("<canvas></canvas>").addClass("x_ite-private-canvas").prependTo(m),this.context=c(this.canvas[0]),this.extensions={};var _=this.getContext();f.forEach(function(e){this.extensions[e]=_.getExtension(e)},this),this.privateScene=new u(this),this.browserOptions=new i(this.getPrivateScene()),this.browserProperties=new n(this.getPrivateScene()),this.renderingProperties=new r(this.getPrivateScene()),this.notification=new s(this.getPrivateScene()),this.browserTimings=new o(this.getPrivateScene()),this.contextMenu=new a(this.getPrivateScene()),this.localStorage=new h(localStorage,"X_ITE.X3DBrowser("+this.number+")."),this.mobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),e(".x_ite-console").empty()}var p=0,f=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_frag_depth","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_compressed_texture_s3tc","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_depth_texture","WEBGL_draw_buffers","WEBGL_lose_context","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_sRGB","WEBGL_color_buffer_float","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc_srgb","EXT_float_blend","OES_fbo_render_mipmap","WEBGL_get_buffer_sub_data_async","WEBGL_multiview","WEBGL_security_sensitive_resources","WEBGL_shared_resources","EXT_clip_cull_distance","WEBGL_debug","WEBGL_dynamic_texture","WEBGL_subarray_uploads","WEBGL_texture_multisample","WEBGL_texture_source_iframe","WEBGL_video_texture","EXT_texture_storage","OES_depth24","WEBGL_debug_shader_precision","WEBGL_draw_elements_no_range_check","WEBGL_subscribe_uniform","WEBGL_texture_from_depth_video"];return d.prototype={initialize:function(){this.privateScene.setPrivate(!0),this.privateScene.setLive(!0),this.privateScene.setup(),this.browserOptions.setup(),this.browserProperties.setup(),this.renderingProperties.setup(),this.notification.setup(),this.browserTimings.setup(),this.contextMenu.setup(),this.observer=new MutationObserver(this.processMutations.bind(this)),this.observer.observe(this.element[0],{attributes:!0,childList:!1,characterData:!1,subtree:!1}),Object.defineProperty(this.getElement().get(0),"src",{get:function(){return this.getExecutionContext().getWorldURL()}.bind(this),set:function(e){this.loadURL(new t.MFString(e),new t.MFString)}.bind(this),enumerable:!0,configurable:!1}),Object.defineProperty(this.getElement().get(0),"url",{get:function(){var e=this.getExecutionContext().getWorldURL();return e?new t.MFString(e):new t.MFString}.bind(this),set:function(e){this.loadURL(e,new t.MFString)}.bind(this),enumerable:!0,configurable:!1}),this.setBrowserEventHandler("onload"),this.setBrowserEventHandler("onshutdown"),this.setBrowserEventHandler("onerror")},getDebug:function(){return this.getBrowserOptions().getDebug()},getNumber:function(){return this.number},isStrict:function(){return!1},getElement:function(){return this.element},getSurface:function(){return this.surface},getSplashScreen:function(){return this.splashScreen},getCanvas:function(){return this.canvas},getContext:function(){return this.context},getExtension:function(e){return this.extensions[e]},getBrowserOptions:function(){return this.browserOptions},getBrowserProperties:function(){return this.browserProperties},getRenderingProperties:function(){return this.renderingProperties},getNotification:function(){return this.notification},getBrowserTimings:function(){return this.browserTimings},getLocalStorage:function(){return this.localStorage},getMobile:function(){return this.mobile},getPrivateScene:function(){return this.privateScene},processMutations:function(e){e.forEach(function(e){this.processMutation(e)},this)},processMutation:function(e){var t=e.target;switch(e.type){case"attributes":this.processAttribute(e,t)}},processAttribute:function(e,t){switch(e.attributeName.toLowerCase()){case"onerror":this.setBrowserEventHandler("onerror");break;case"onload":this.setBrowserEventHandler("onload");break;case"onshutdown":this.setBrowserEventHandler("onshutdown");break;case"splashscreen":this.getBrowserOptions().setAttributeSplashScreen();break;case"src":var i=this.getElement().attr("src");this.load('"'+i+'"');break;case"url":this.load(this.getElement().attr("url"))}},load:function(e){if(e){var i=new l(this.getExecutionContext()),n=new t.MFString,r=new t.MFString;i.setInput(e),i.sfstringValues(n),n.length&&this.loadURL(n,r)}else this.getLoading()||this.getCanvas().fadeIn(0)},setBrowserEventHandler:function(e){var t=this.getElement().get(0),i=this.getElement().attr(e);t[e]=i?new Function(i):Function.prototype},callBrowserEventHandler:function(e){var t=this.getElement().get(0),i=t[e];i&&i.call(t),window.jQuery&&window.jQuery(t).trigger(e.substr(2))}},d}),define("x_ite/Routing/X3DRoutingContext",[],function(){"use strict";function e(){this.taintedFields=[],this.taintedFieldsTemp=[],this.taintedNodes=[],this.taintedNodesTemp=[]}return e.prototype={constructor:e,initialize:function(){},addTaintedField:function(e,t){this.taintedFields.push(e,t)},addTaintedNode:function(e){this.taintedNodes.push(e)},processEvents:function(){do{do{var e=this.taintedFields;this.taintedFields=this.taintedFieldsTemp,this.taintedFields.length=0;for(var t=0,i=e.length;t<i;t+=2)e[t].processEvent(e[t+1]);this.taintedFieldsTemp=e}while(this.taintedFields.length)do{var n=this.taintedNodes;this.taintedNodes=this.taintedNodesTemp,this.taintedNodes.length=0;for(var t=0,i=n.length;t<i;++t)n[t].processEvents();this.taintedNodesTemp=n}while(!this.taintedFields.length&&this.taintedNodes.length)}while(this.taintedFields.length)}},e}),define("x_ite/Browser/Scripting/X3DScriptingContext",[],function(){"use strict";function e(){this.scripts=[this]}return e.prototype={initialize:function(){},isExternal:function(){return 1===this.scripts.length},getScriptStack:function(){return this.scripts}},e}),define("x_ite/Components/Networking/X3DNetworkSensorNode",["x_ite/Components/Core/X3DSensorNode","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DNetworkSensorNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i}),i}),define("x_ite/Components/Networking/LoadSensor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Networking/X3DNetworkSensorNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(s.LoadSensor),this.urlObjects=[],this.aborted=!1,this.timeOutId=void 0}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"enabled",new e.SFBool(!0)),new t(s.inputOutput,"timeOut",new e.SFTime),new t(s.outputOnly,"isActive",new e.SFBool),new t(s.outputOnly,"isLoaded",new e.SFBool),new t(s.outputOnly,"progress",new e.SFFloat),new t(s.outputOnly,"loadTime",new e.SFTime),new t(s.inputOutput,"watchList",new e.MFNode)]),getTypeName:function(){return"LoadSensor"},getComponentName:function(){return"Networking"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.enabled_.addInterest("set_enabled__",this),this.timeOut_.addInterest("set_timeOut__",this),this.watchList_.addInterest("set_watchList__",this),this.watchList_.addEvent()},set_enabled__:function(){this.enabled_.getValue()?this.reset():(this.abort(),this.remove())},set_timeOut__:function(){this.isActive_.getValue()&&(this.clearTimeout(),this.aborted=!1,
this.timeOut_.getValue()>0&&(this.timeOutId=setTimeout(this.abort.bind(this),1e3*this.timeOut_.getValue())))},set_watchList__:function(){this.reset()},set_loadState__:function(e,t){switch(t.checkLoadState()){case s.NOT_STARTED_STATE:break;case s.IN_PROGRESS_STATE:case s.COMPLETE_STATE:case s.FAILED_STATE:this.count()}},count:function(){for(var e=0,t=0,i=this.urlObjects,n=0,r=i.length;n<r;++n){var o=i[n];e+=o.checkLoadState()==s.COMPLETE_STATE,t+=o.checkLoadState()==s.FAILED_STATE}var a=e==i.length,u=e/i.length;this.aborted||t||a?(this.clearTimeout(),this.isActive_=!1,this.isLoaded_=a,this.progress_=u,a&&(this.loadTime_=this.getBrowser().getCurrentTime())):this.isActive_.getValue()?this.progress_=u:(this.isActive_=!0,this.progress_=u,this.set_timeOut__())},abort:function(){this.clearTimeout(),this.aborted=!0,this.enabled_.getValue()&&this.count()},reset:function(){if(this.remove(),this.enabled_.getValue()){for(var e=this.watchList_.getValue(),t=this.urlObjects,i=0,n=e.length;i<n;++i){var o=r(s.X3DUrlObject,e[i]);o&&(t.push(o),o.loadState_.addInterest("set_loadState__",this,o))}this.count()}},remove:function(){this.clearTimeout();for(var e=this.urlObjects,t=0,i=e.length;t<i;++t)e[t].loadState_.removeInterest("set_loadState__",this);e.length=0},clearTimeout:function(){clearTimeout(this.timeOutId),this.timeOutId=void 0}}),o}),define("x_ite/Browser/Networking/urls",[],function(){"use strict";return{providerUrl:"http://create3000.de/x_ite",fallbackUrl:"http://cors.create3000.de/",fallbackExpression:new RegExp("^http://cors.create3000.de/")}}),function(){"use strict";function e(e){return i(n(e),arguments)}function t(t,i){return e.apply(null,[t].concat(i||[]))}function i(t,i){var n,s,o,a,u,l,h,c,d,p=1,f=t.length,g="";for(s=0;s<f;s++)if("string"==typeof t[s])g+=t[s];else if(Array.isArray(t[s])){if((a=t[s])[2])for(n=i[p],o=0;o<a[2].length;o++){if(!n.hasOwnProperty(a[2][o]))throw new Error(e('[sprintf] property "%s" does not exist',a[2][o]));n=n[a[2][o]]}else n=a[1]?i[a[1]]:i[p++];if(r.not_type.test(a[8])&&r.not_primitive.test(a[8])&&n instanceof Function&&(n=n()),r.numeric_arg.test(a[8])&&"number"!=typeof n&&isNaN(n))throw new TypeError(e("[sprintf] expecting number but found %T",n));switch(r.number.test(a[8])&&(c=n>=0),a[8]){case"b":n=parseInt(n,10).toString(2);break;case"c":n=String.fromCharCode(parseInt(n,10));break;case"d":case"i":n=parseInt(n,10);break;case"j":n=JSON.stringify(n,null,a[6]?parseInt(a[6]):0);break;case"e":n=a[7]?parseFloat(n).toExponential(a[7]):parseFloat(n).toExponential();break;case"f":n=a[7]?parseFloat(n).toFixed(a[7]):parseFloat(n);break;case"g":n=a[7]?String(Number(n.toPrecision(a[7]))):parseFloat(n);break;case"o":n=(parseInt(n,10)>>>0).toString(8);break;case"s":n=String(n),n=a[7]?n.substring(0,a[7]):n;break;case"t":n=String(!!n),n=a[7]?n.substring(0,a[7]):n;break;case"T":n=Object.prototype.toString.call(n).slice(8,-1).toLowerCase(),n=a[7]?n.substring(0,a[7]):n;break;case"u":n=parseInt(n,10)>>>0;break;case"v":n=n.valueOf(),n=a[7]?n.substring(0,a[7]):n;break;case"x":n=(parseInt(n,10)>>>0).toString(16);break;case"X":n=(parseInt(n,10)>>>0).toString(16).toUpperCase()}r.json.test(a[8])?g+=n:(!r.number.test(a[8])||c&&!a[3]?d="":(d=c?"+":"-",n=n.toString().replace(r.sign,"")),l=a[4]?"0"===a[4]?"0":a[4].charAt(1):" ",h=a[6]-(d+n).length,u=a[6]&&h>0?l.repeat(h):"",g+=a[5]?d+n+u:"0"===l?d+u+n:u+d+n)}return g}function n(e){if(s[e])return s[e];for(var t,i=e,n=[],o=0;i;){if(null!==(t=r.text.exec(i)))n.push(t[0]);else if(null!==(t=r.modulo.exec(i)))n.push("%");else{if(null===(t=r.placeholder.exec(i)))throw new SyntaxError("[sprintf] unexpected placeholder");if(t[2]){o|=1;var a=[],u=t[2],l=[];if(null===(l=r.key.exec(u)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(a.push(l[1]);""!==(u=u.substring(l[0].length));)if(null!==(l=r.key_access.exec(u)))a.push(l[1]);else{if(null===(l=r.index_access.exec(u)))throw new SyntaxError("[sprintf] failed to parse named argument key");a.push(l[1])}t[2]=a}else o|=2;if(3===o)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");n.push(t)}i=i.substring(t[0].length)}return s[e]=n}var r={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/},s=Object.create(null);"undefined"!=typeof exports&&(exports.sprintf=e,exports.vsprintf=t),"undefined"!=typeof window&&(window.sprintf=e,window.vsprintf=t,"function"==typeof define&&define.amd&&define("sprintf/dist/sprintf.min",[],function(){return{sprintf:e,vsprintf:t}}))}(),define("sprintf",["sprintf/dist/sprintf.min"],function(e){return e}),define("x_ite/Browser/Networking/X3DNetworkingContext",["x_ite/Fields","x_ite/Components/Networking/LoadSensor","x_ite/Browser/Networking/urls","standard/Networking/URI","sprintf","locale/gettext"],function(e,t,i,n,r,s){"use strict";function o(e){var t=e.baseURI;return t.startsWith("about:")&&(t=document.baseURI),new n(t)}function a(){this.addChildObjects("loadCount",new e.SFInt32),this.loadSensor=new t(this.getPrivateScene()),this.loadingTotal=0,this.loadingObjects={},this.loading=!1,this.location=o(this.getElement()[0]),this.defaultScene=this.createScene(),this.getCanvas().fadeOut(0),this.getBrowserOptions().getSplashScreen()&&this.getSplashScreen().fadeIn(0)}return a.prototype={initialize:function(){this.loadSensor.setup(),this.defaultScene.setPrivate(!0),this.defaultScene.setLive(!0),this.defaultScene.setup()},getProviderUrl:function(){return i.providerUrl},getLocation:function(){return this.location},getDefaultScene:function(){return this.defaultScene},getLoadSensor:function(){return this.loadSensor},setBrowserLoading:function(e){this.loading=e,e?(this.resetLoadCount(),this.getBrowserOptions().getSplashScreen()?(this.getCanvas().stop(!0,!0).animate({delay:1},1).fadeOut(0),this.getSplashScreen().stop(!0,!0).animate({delay:1},1).fadeIn(0)):this.getCanvas().fadeOut(0)):this.getBrowserOptions().getSplashScreen()?(this.getSplashScreen().stop(!0,!0).fadeIn(0).fadeOut(2e3),this.getCanvas().stop(!0,!0).fadeOut(0).fadeIn(2e3)):this.getCanvas().fadeIn(0)},getLoading:function(){return this.loading},addLoadCount:function(e){var t=e.getId();this.loadingObjects.hasOwnProperty(t)||(++this.loadingTotal,this.loadingObjects[t]=e,this.setLoadCount(this.loadCount_=this.loadCount_.getValue()+1),this.setCursor("DEFAULT"))},removeLoadCount:function(e){var t=e.getId();this.loadingObjects.hasOwnProperty(t)&&(delete this.loadingObjects[t],this.setLoadCount(this.loadCount_=this.loadCount_.getValue()-1))},setLoadCount:function(e){if(e)var t=r.sprintf(s(1==e?"Loading %d file":"Loading %d files"),e);else{var t=s("Loading done");this.setCursor("DEFAULT")}this.loading||(this.getNotification().string_=t),this.getSplashScreen().find(".x_ite-private-spinner-text").text(t),this.getSplashScreen().find(".x_ite-private-progressbar div").css("width",100*(this.loadingTotal-e)/this.loadingTotal+"%")},resetLoadCount:function(){this.loadCount_=0,this.loadingTotal=0,this.loadingObjects={}}},a}),define("x_ite/Browser/Shaders/X3DShadersContext",[],function(){"use strict";function e(){this.shaders={}}return e.prototype={initialize:function(){},getShadingLanguageVersion:function(){return this.getContext().getParameter(this.getContext().SHADING_LANGUAGE_VERSION)},getMaxVertexUniformVectors:function(){return this.getContext().getParameter(this.getContext().MAX_VERTEX_UNIFORM_VECTORS)},getMaxFragmentUniformVectors:function(){return this.getContext().getParameter(this.getContext().MAX_FRAGMENT_UNIFORM_VECTORS)},getMaxVertexAttribs:function(){return this.getContext().getParameter(this.getContext().MAX_VERTEX_ATTRIBS)},addShader:function(e){this.shaders[e.getId()]=e,e.setShading(this.getBrowserOptions().getShading())},removeShader:function(e){delete this.shaders[e.getId()]},getShaders:function(){return this.shaders}},e}),define("x_ite/Components/Shape/X3DAppearanceChildNode",["x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DAppearanceChildNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i}),i}),define("x_ite/Components/Shaders/X3DShaderNode",["x_ite/Browser/Core/Shading","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Bits/X3DConstants","x_ite/Bits/TraverseType"],function(e,t,i,n){"use strict";function r(e){t.call(this,e),this.addType(i.X3DShaderNode)}return r.prototype=Object.assign(Object.create(t.prototype),{constructor:r,custom:!0,setCustom:function(e){this.custom=e},getCustom:function(){return this.custom},setGeometryType:function(e){this.setShading(e,this.getBrowser().getBrowserOptions().getShading())},setShading:function(t,i){var n=this.getBrowser().getContext();switch(t){case 0:switch(i){case e.POINT:this.primitiveMode=n.POINTS,this.wireframe=!0;break;case e.WIREFRAME:this.primitiveMode=n.POINTS,this.wireframe=!0;break;default:this.primitiveMode=n.POINTS,this.wireframe=!0}break;case 1:switch(i){case e.POINT:this.primitiveMode=n.POINTS,this.wireframe=!0;break;case e.WIREFRAME:this.primitiveMode=n.LINES,this.wireframe=!0;break;default:this.primitiveMode=n.LINES,this.wireframe=!0}break;case 2:case 3:switch(i){case e.POINT:this.primitiveMode=n.POINTS,this.wireframe=!0;break;case e.WIREFRAME:this.primitiveMode=n.LINE_LOOP,this.wireframe=!0;break;default:this.primitiveMode=n.TRIANGLES,this.wireframe=!1}}},traverse:function(e,t){switch(e){case n.DISPLAY:t.getShaders().set(this.getId(),this)}}}),r}),define("x_ite/Components/Navigation/OrthoViewpoint",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Navigation/X3DViewpointNode","x_ite/Bits/X3DConstants","standard/Math/Geometry/Camera","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r,s,o,a,u){"use strict";function l(e){n.call(this,e),this.addType(r.OrthoViewpoint),this.position_.setUnit("length"),this.centerOfRotation_.setUnit("length"),this.fieldOfView_.setUnit("length"),this.projectionMatrix=new u}var h=new a(0,0,0),c=new o(0,0);return l.prototype=Object.assign(Object.create(n.prototype),{constructor:l,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_bind",new e.SFBool),new t(r.inputOutput,"description",new e.SFString),new t(r.inputOutput,"position",new e.SFVec3f(0,0,10)),new t(r.inputOutput,"orientation",new e.SFRotation),new t(r.inputOutput,"centerOfRotation",new e.SFVec3f),new t(r.inputOutput,"fieldOfView",new e.MFFloat(-1,-1,1,1)),new t(r.inputOutput,"jump",new e.SFBool(!0)),new t(r.inputOutput,"retainUserOffsets",new e.SFBool),new t(r.outputOnly,"isBound",new e.SFBool),new t(r.outputOnly,"bindTime",new e.SFTime)]),getTypeName:function(){return"OrthoViewpoint"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.fieldOfView_.addInterest("set_fieldOfView___",this),this.fieldOfViewScale_.addInterest("set_fieldOfView___",this),this.set_fieldOfView___()},set_fieldOfView___:function(){var e=this.fieldOfView_.length,t=this.fieldOfViewScale_.getValue();this.minimumX=(e>0?this.fieldOfView_[0]:-1)*t,this.minimumY=(e>1?this.fieldOfView_[1]:-1)*t,this.maximumX=(e>2?this.fieldOfView_[2]:1)*t,this.maximumY=(e>3?this.fieldOfView_[3]:1)*t,this.sizeX=this.maximumX-this.minimumX,this.sizeY=this.maximumY-this.minimumY},getMinimumX:function(){return this.minimumX},getMinimumY:function(){return this.minimumY},getMaximumX:function(){return this.maximumX},getMaximumY:function(){return this.maximumY},getSizeX:function(){return this.sizeX},getSizeY:function(){return this.sizeY},getMaxFarValue:function(){return 1e5},getScreenScale:function(e,t){var i=t[2],n=t[3],r=this.sizeX,s=this.sizeY;if(i/n>r/s){var o=s/n;return h.set(o,o,o)}var o=r/i;return h.set(o,o,o)},getViewportSize:function(e){var t=e[2],i=e[3],n=this.sizeX,r=this.sizeY,s=t/i;return s>n/r?c.set(r*s,r):c.set(n,n/s)},getLookAtDistance:function(e){return e.size.abs()/2+10},getProjectionMatrixWithLimits:function(e,t,i){var n=i[2],r=i[3],o=n/r,a=this.sizeX,u=this.sizeY;if(o>a/u){var l=(this.minimumX+this.maximumX)/2,h=u*o/2;return s.ortho(l-h,l+h,this.minimumY,this.maximumY,e,t,this.projectionMatrix)}var l=(this.minimumY+this.maximumY)/2,h=a/o/2;return s.ortho(this.minimumX,this.maximumX,l-h,l+h,e,t,this.projectionMatrix)}}),l}),define("x_ite/Components/Shaders/X3DProgrammableShaderObject",["x_ite/Fields","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants","x_ite/Components/Navigation/OrthoViewpoint","standard/Math/Numbers/Matrix3"],function(e,t,i,n,r){"use strict";function s(e){this.addType(i.X3DProgrammableShaderObject),this.x3d_ClipPlane=[],this.x3d_LightType=[],this.x3d_LightOn=[],this.x3d_LightColor=[],this.x3d_LightIntensity=[],this.x3d_LightAmbientIntensity=[],this.x3d_LightAttenuation=[],this.x3d_LightLocation=[],this.x3d_LightDirection=[],this.x3d_LightBeamWidth=[],this.x3d_LightCutOffAngle=[],this.x3d_LightRadius=[],this.x3d_ShadowIntensity=[],this.x3d_ShadowColor=[],this.x3d_ShadowBias=[],this.x3d_ShadowMatrix=[],this.x3d_ShadowMapSize=[],this.x3d_ShadowMap=[],this.numClipPlanes=0,this.numGlobalLights=0,this.numLights=0,this.textures=new Map}var o=new r;return s.prototype={constructor:s,normalMatrixArray:new Float32Array(9),initialize:function(){var e=this.getBrowser();this.x3d_MaxClipPlanes=e.getMaxClipPlanes(),this.x3d_MaxLights=e.getMaxLights(),this.x3d_MaxTextures=e.getMaxTextures();for(var t=[],i=0,n=this.x3d_MaxClipPlanes;i<n;++i)t.push(0,0,-1,0);this.defaultClipPlanesArray=new Float32Array(t),this.textureTypeArray=new Int32Array(this.x3d_MaxTextures)},hasUserDefinedFields:function(){return!0},bindAttributeLocations:function(e,t){e.bindAttribLocation(t,3,"x3d_Color"),e.bindAttribLocation(t,2,"x3d_TexCoord"),e.bindAttribLocation(t,1,"x3d_Normal"),e.bindAttribLocation(t,0,"x3d_Vertex")},getDefaultUniforms:function(){var e=this.getBrowser().getContext(),t=this.getProgram();this.x3d_LogarithmicFarFactor1_2=e.getUniformLocation(t,"x3d_LogarithmicFarFactor1_2"),this.x3d_GeometryType=e.getUniformLocation(t,"x3d_GeometryType"),this.x3d_NumClipPlanes=e.getUniformLocation(t,"x3d_NumClipPlanes"),this.x3d_ClipPlanes=e.getUniformLocation(t,"x3d_ClipPlane");for(var i=0;i<this.x3d_MaxClipPlanes;++i)this.x3d_ClipPlane[i]=e.getUniformLocation(t,"x3d_ClipPlane["+i+"]");this.x3d_FogType=this.getUniformLocation(e,t,"x3d_Fog.type","x3d_FogType"),this.x3d_FogColor=this.getUniformLocation(e,t,"x3d_Fog.color","x3d_FogColor"),this.x3d_FogCenter=this.getUniformLocation(e,t,"x3d_Fog.center","x3d_FogCenter"),this.x3d_FogVisibilityRange=this.getUniformLocation(e,t,"x3d_Fog.visibilityRange","x3d_FogVisibilityRange"),this.x3d_LinewidthScaleFactor=e.getUniformLocation(t,"x3d_LinewidthScaleFactor"),this.x3d_Lighting=e.getUniformLocation(t,"x3d_Lighting"),this.x3d_ColorMaterial=e.getUniformLocation(t,"x3d_ColorMaterial"),this.x3d_NumLights=e.getUniformLocation(t,"x3d_NumLights");for(var i=0;i<this.x3d_MaxLights;++i)this.x3d_LightType[i]=this.getUniformLocation(e,t,"x3d_LightSource["+i+"].type","x3d_LightType["+i+"]"),this.x3d_LightColor[i]=this.getUniformLocation(e,t,"x3d_LightSource["+i+"].color","x3d_LightColor["+i+"]"),this.x3d_LightAmbientIntensity[i]=this.getUniformLocation(e,t,"x3d_LightSource["+i+"].ambientIntensity","x3d_LightAmbientIntensity["+i+"]"),this.x3d_LightIntensity[i]=this.getUniformLocation(e,t,"x3d_LightSource["+i+"].intensity","x3d_LightIntensity["+i+"]"),this.x3d_LightAttenuation[i]=this.getUniformLocation(e,t,"x3d_LightSource["+i+"].attenuation","x3d_LightAttenuation["+i+"]"),this.x3d_LightLocation[i]=this.getUniformLocation(e,t,"x3d_LightSource["+i+"].location","x3d_LightLocation["+i+"]"),this.x3d_LightDirection[i]=this.getUniformLocation(e,t,"x3d_LightSource["+i+"].direction","x3d_LightDirection["+i+"]"),this.x3d_LightBeamWidth[i]=this.getUniformLocation(e,t,"x3d_LightSource["+i+"].beamWidth","x3d_LightBeamWidth["+i+"]"),this.x3d_LightCutOffAngle[i]=this.getUniformLocation(e,t,"x3d_LightSource["+i+"].cutOffAngle","x3d_LightCutOffAngle["+i+"]"),this.x3d_LightRadius[i]=this.getUniformLocation(e,t,"x3d_LightSource["+i+"].radius","x3d_LightRadius["+i+"]"),this.x3d_ShadowIntensity[i]=e.getUniformLocation(t,"x3d_LightSource["+i+"].shadowIntensity"),this.x3d_ShadowColor[i]=e.getUniformLocation(t,"x3d_LightSource["+i+"].shadowColor"),this.x3d_ShadowBias[i]=e.getUniformLocation(t,"x3d_LightSource["+i+"].shadowBias"),this.x3d_ShadowMatrix[i]=e.getUniformLocation(t,"x3d_LightSource["+i+"].shadowMatrix"),this.x3d_ShadowMapSize[i]=e.getUniformLocation(t,"x3d_LightSource["+i+"].shadowMapSize"),this.x3d_ShadowMap[i]=e.getUniformLocation(t,"x3d_ShadowMap["+i+"]");return this.x3d_SeparateBackColor=e.getUniformLocation(t,"x3d_SeparateBackColor"),this.x3d_AmbientIntensity=this.getUniformLocation(e,t,"x3d_FrontMaterial.ambientIntensity","x3d_AmbientIntensity"),this.x3d_DiffuseColor=this.getUniformLocation(e,t,"x3d_FrontMaterial.diffuseColor","x3d_DiffuseColor"),this.x3d_SpecularColor=this.getUniformLocation(e,t,"x3d_FrontMaterial.specularColor","x3d_SpecularColor"),this.x3d_EmissiveColor=this.getUniformLocation(e,t,"x3d_FrontMaterial.emissiveColor","x3d_EmissiveColor"),this.x3d_Shininess=this.getUniformLocation(e,t,"x3d_FrontMaterial.shininess","x3d_Shininess"),this.x3d_Transparency=this.getUniformLocation(e,t,"x3d_FrontMaterial.transparency","x3d_Transparency"),this.x3d_BackAmbientIntensity=this.getUniformLocation(e,t,"x3d_BackMaterial.ambientIntensity","x3d_BackAmbientIntensity"),this.x3d_BackDiffuseColor=this.getUniformLocation(e,t,"x3d_BackMaterial.diffuseColor","x3d_BackDiffuseColor"),this.x3d_BackSpecularColor=this.getUniformLocation(e,t,"x3d_BackMaterial.specularColor","x3d_BackSpecularColor"),this.x3d_BackEmissiveColor=this.getUniformLocation(e,t,"x3d_BackMaterial.emissiveColor","x3d_BackEmissiveColor"),this.x3d_BackShininess=this.getUniformLocation(e,t,"x3d_BackMaterial.shininess","x3d_BackShininess"),this.x3d_BackTransparency=this.getUniformLocation(e,t,"x3d_BackMaterial.transparency","x3d_BackTransparency"),this.x3d_NumTextures=e.getUniformLocation(t,"x3d_NumTextures"),this.x3d_TextureType=e.getUniformLocation(t,"x3d_TextureType"),this.x3d_Texture2D=this.getUniformLocation(e,t,"x3d_Texture2D","x3d_Texture"),this.x3d_CubeMapTexture=e.getUniformLocation(t,"x3d_CubeMapTexture"),this.x3d_Viewport=e.getUniformLocation(t,"x3d_Viewport"),this.x3d_ProjectionMatrix=e.getUniformLocation(t,"x3d_ProjectionMatrix"),this.x3d_ModelViewMatrix=e.getUniformLocation(t,"x3d_ModelViewMatrix"),this.x3d_NormalMatrix=e.getUniformLocation(t,"x3d_NormalMatrix"),this.x3d_TextureMatrix=e.getUniformLocation(t,"x3d_TextureMatrix"),this.x3d_CameraSpaceMatrix=e.getUniformLocation(t,"x3d_CameraSpaceMatrix"),this.x3d_Color=e.getAttribLocation(t,"x3d_Color"),this.x3d_TexCoord=e.getAttribLocation(t,"x3d_TexCoord"),this.x3d_Normal=e.getAttribLocation(t,"x3d_Normal"),this.x3d_Vertex=e.getAttribLocation(t,"x3d_Vertex"),this.x3d_ParticleId=e.getUniformLocation(t,"x3d_Particle.id"),this.x3d_ParticleLife=e.getUniformLocation(t,"x3d_Particle.life"),this.x3d_ParticleElapsedTime=e.getUniformLocation(t,"x3d_Particle.elapsedTime"),e.uniform1f(this.x3d_LinewidthScaleFactor,1),e.uniform1iv(this.x3d_TextureType,new Int32Array([0])),e.uniform1iv(this.x3d_Texture2D,new Int32Array([2])),e.uniform1iv(this.x3d_CubeMapTexture,new Int32Array([4])),e.uniform1iv(e.getUniformLocation(t,"x3d_ShadowMap"),new Int32Array(this.x3d_MaxLights).fill(5)),e.uniform1i(this.x3d_NumTextures,1),this.x3d_Color<0?(this.enableColorAttribute=Function.prototype,this.disableColorAttribute=Function.prototype):(delete this.enableColorAttribute,delete this.disableColorAttribute),this.x3d_TexCoord<0?(this.enableTexCoordAttribute=Function.prototype,this.disableTexCoordAttribute=Function.prototype):(delete this.enableTexCoordAttribute,delete this.disableTexCoordAttribute),this.x3d_Normal<0?(this.enableNormalAttribute=Function.prototype,this.disableNormalAttribute=Function.prototype):(delete this.enableNormalAttribute,delete this.disableNormalAttribute),!(this.x3d_Vertex<0)||(console.warn("Missing »attribute vec4 x3d_Vertex;«."),!1)},getUniformLocation:function(e,t,i,n){var r=e.getUniformLocation(t,i);return r?r:(r=e.getUniformLocation(t,n),r&&console.error(this.getTypeName(),this.getName(),"Using uniform location name »"+n+"« is depreciated. See http://create3000.de/x_ite/custom-shaders/."),r)},addShaderFields:function(){var e=this.getBrowser().getContext(),t=this.getProgram(),n=this.getUserDefinedFields();this.textures.clear();for(var r of n.values()){var s=e.getUniformLocation(t,r.getName());if(s){switch(r._uniformLocation=s,r.addInterest("set_field__",this),r.getType()){case i.SFImage:s.array=new Int32Array(3+r.array.length);break;case i.SFMatrix3d:case i.SFMatrix3f:case i.SFRotation:s.array=new Float32Array(9);break;case i.SFMatrix4d:case i.SFMatrix4f:s.array=new Float32Array(16);break;case i.SFNode:break;case i.MFBool:case i.MFInt32:s.array=new Int32Array(this.getLocationLength(e,t,r));break;case i.MFFloat:case i.MFDouble:case i.MFTime:s.array=new Float32Array(this.getLocationLength(e,t,r));break;case i.MFImage:s.array=new Int32Array(this.getImagesLength(r));break;case i.MFMatrix3d:case i.MFMatrix3f:case i.MFRotation:s.array=new Float32Array(9*this.getLocationLength(e,t,r));break;case i.MFMatrix4d:case i.MFMatrix4f:s.array=new Float32Array(16*this.getLocationLength(e,t,r));break;case i.MFNode:for(var o=s.locations=[],a=0;;++a){var u=e.getUniformLocation(t,r.getName()+"["+a+"]");if(!u)break;o.push(u)}break;case i.MFVec2d:case i.MFVec2f:s.array=new Float32Array(2*this.getLocationLength(e,t,r));break;case i.MFVec3d:case i.MFVec3f:case i.MFColor:s.array=new Float32Array(3*this.getLocationLength(e,t,r));break;case i.MFVec4d:case i.MFVec4f:case i.MFColorRGBA:s.array=new Float32Array(4*this.getLocationLength(e,t,r))}this.set_field__(r)}}},removeShaderFields:function(){var e=this.getUserDefinedFields();for(var t of e.values())t.removeInterest("set_field__",this)},set_field__:function(e){var n=this.getBrowser().getContext(),r=e._uniformLocation;if(r)switch(e.getType()){case i.SFBool:case i.SFInt32:return void n.uniform1i(r,e.getValue());case i.SFColor:var s=e.getValue();return void n.uniform3f(r,s.r,s.g,s.b);case i.SFColorRGBA:var s=e.getValue();return void n.uniform4f(r,s.r,s.g,s.b,s.a);case i.SFDouble:case i.SFFloat:case i.SFTime:return void n.uniform1f(r,e.getValue());case i.SFImage:var a=r.array,u=e.array,l=3+u.length;l!==a.length&&(a=r.array=new Int32Array(l)),a[0]=e.width,a[1]=e.height,a[2]=e.comp;for(var h=3,c=0,l=u.length;c<l;++c,++h)a[h]=u[c];return void n.uniform1iv(r,a);case i.SFMatrix3d:case i.SFMatrix3f:return r.array.set(e.getValue()),void n.uniformMatrix3fv(r,!1,r.array);case i.SFMatrix4d:case i.SFMatrix4f:return r.array.set(e.getValue()),void n.uniformMatrix4fv(r,!1,r.array);case i.SFNode:var d=t(i.X3DTextureNode,e);return d?void this.textures.set(r,{name:e.getName(),texture:d,textureUnit:void 0}):void this.textures.delete(r);case i.SFRotation:return e.getValue().getMatrix(r.array),void n.uniformMatrix3fv(r,!1,r.array);case i.SFString:return;case i.SFVec2d:case i.SFVec2f:var s=e.getValue();return void n.uniform2f(r,s.x,s.y);case i.SFVec3d:case i.SFVec3f:var s=e.getValue();return void n.uniform3f(r,s.x,s.y,s.z);case i.SFVec4d:case i.SFVec4f:var s=e.getValue();return void n.uniform4f(r,s.x,s.y,s.z,s.w);case i.MFBool:case i.MFInt32:for(var a=r.array,p=0,l=e.length;p<l;++p)a[p]=e[p];for(var l=a.length;p<l;++p)a[p]=0;return void n.uniform1iv(r,a);case i.MFColor:for(var a=r.array,p=0,f=0,l=e.length;p<l;++p){var g=e[p];a[f++]=g.r,a[f++]=g.g,a[f++]=g.b}for(var l=a.length;f<l;++f)a[f]=0;return void n.uniform3fv(r,a);case i.MFColorRGBA:for(var a=r.array,p=0,f=0,l=e.length;p<l;++p){var g=e[p];a[f++]=g.r,a[f++]=g.g,a[f++]=g.b,a[f++]=g.a}for(var l=a.length;f<l;++f)a[f]=0;return void n.uniform4fv(r,a);case i.MFDouble:case i.MFFloat:case i.MFTime:for(var a=r.array,p=0,l=e.length;p<l;++p)a[p]=e[p];for(var l=a.length;p<l;++p)a[p]=0;return void n.uniform1fv(r,a);case i.MFImage:var a=r.array,l=this.getImagesLength(e);l!==a.length&&(a=r.array=new Int32Array(l));for(var p=0,h=0,l=e.length;p<l;++p){var s=e[p],u=s.array;a[h++]=s.width,a[h++]=s.height,a[h++]=s.comp;for(var c=0,m=u.length;c<m;++c)a[h++]=u[c]}return void n.uniform1iv(r,a);case i.MFMatrix3d:case i.MFMatrix3f:for(var a=r.array,p=0,f=0,l=e.length;p<l;++p)for(var _=e[p],x=0;x<9;++x)a[f++]=_[x];for(var l=a.length;f<l;++f)a[f]=0;return void n.uniformMatrix3fv(r,!1,a);case i.MFMatrix4d:case i.MFMatrix4f:for(var a=r.array,p=0,f=0,l=e.length;p<l;++p)for(var _=e[p],x=0;x<16;++x)a[f++]=_[x];for(var l=a.length;f<l;++f)a[f]=0;return void n.uniformMatrix4fv(r,!1,a);case i.MFNode:for(var y=r.locations,p=0,l=e.length;p<l;++p){var d=t(i.X3DTextureNode,e[p]);d&&this.textures.set(y[p],{name:e[p].getName(),texture:d,textureUnit:void 0})}return;case i.MFRotation:for(var a=r.array,p=0,f=0,l=e.length;p<l;++p){var _=e[p].getValue().getMatrix(o);a[f++]=_[0],a[f++]=_[1],a[f++]=_[2],a[f++]=_[3],a[f++]=_[4],a[f++]=_[5],a[f++]=_[6],a[f++]=_[7],a[f++]=_[8]}for(var l=a.length;f<l;++f)a[f]=0;return void n.uniformMatrix3fv(r,!1,a);case i.MFString:return;case i.MFVec2d:case i.MFVec2f:for(var a=r.array,p=0,f=0,l=e.length;p<l;++p){var v=e[p];a[f++]=v.x,a[f++]=v.y}for(var l=a.length;f<l;++f)a[f]=0;return void n.uniform2fv(r,a);case i.MFVec3d:case i.MFVec3f:for(var a=r.array,p=0,f=0,l=e.length;p<l;++p){var v=e[p];a[f++]=v.x,a[f++]=v.y,a[f++]=v.z}for(var l=a.length;f<l;++f)a[f]=0;return void n.uniform3fv(r,a);case i.MFVec4d:case i.MFVec4f:for(var a=r.array,p=0,f=0,l=e.length;p<l;++p){var v=e[p];a[f++]=v.x,a[f++]=v.y,a[f++]=v.z,a[f++]=v.w}for(var l=a.length;f<l;++f)a[f]=0;return void n.uniform4fv(r,a)}},getImagesLength:function(e){for(var t=e.getValue(),i=3*t.length,n=0,r=t.length;n<r;++n)i+=t[n].array.length;return i},getLocationLength:function(e,t,i){for(var n=i.getName(),r=0;;++r){if(!e.getUniformLocation(t,n+"["+r+"]"))break}return r},setShaderObjects:function(e,t){this.numClipPlanes=0,this.numLights=0,e.uniform4fv(this.x3d_ClipPlanes,this.defaultClipPlanesArray);for(var i=0,n=t.length;i<n;++i)t[i].setShaderUniforms(e,this);e.uniform1i(this.x3d_NumClipPlanes,Math.min(this.numClipPlanes,this.x3d_MaxClipPlanes)),e.uniform1i(this.x3d_NumLights,Math.min(this.numLights,this.x3d_MaxLights)),this.numLights<this.x3d_MaxLights&&e.uniform1i(this.x3d_LightType[this.numLights],0)},setGlobalUniforms:function(e,t,i,r,s){var o=t.getGlobalLights();e.uniform4iv(this.x3d_Viewport,s),e.uniformMatrix4fv(this.x3d_ProjectionMatrix,!1,r),e.uniformMatrix4fv(this.x3d_CameraSpaceMatrix,!1,i),this.numGlobalLights=o.length,this.numLights=0;for(var a=0,u=o.length;a<u;++a)o[a].setShaderUniforms(e,this);var l=t.getViewpoint(),h=t.getNavigationInfo();l instanceof n?e.uniform1f(this.x3d_LogarithmicFarFactor1_2,-1):e.uniform1f(this.x3d_LogarithmicFarFactor1_2,1/Math.log2(h.getFarValue(l)+1))},setLocalUniforms:function(e,t){var i=t.linePropertiesNode,n=t.materialNode,s=t.textureNode,o=t.textureTransformNode,a=t.modelViewMatrix,u=t.shaderObjects;e.uniform1i(this.x3d_GeometryType,t.geometryType),this.numClipPlanes=0,this.numLights=this.numGlobalLights,e.uniform4fv(this.x3d_ClipPlanes,this.defaultClipPlanesArray);for(var l=0,h=u.length;l<h;++l)u[l].setShaderUniforms(e,this);if(e.uniform1i(this.x3d_NumClipPlanes,Math.min(this.numClipPlanes,this.x3d_MaxClipPlanes)),e.uniform1i(this.x3d_NumLights,Math.min(this.numLights,this.x3d_MaxLights)),this.numLights<this.x3d_MaxLights&&e.uniform1i(this.x3d_LightType[this.numLights],0),t.fogNode.setShaderUniforms(e,this),i&&i.applied_.getValue()){var c=i.getLinewidthScaleFactor();e.lineWidth(c),e.uniform1f(this.x3d_LinewidthScaleFactor,c)}else e.lineWidth(1),e.uniform1f(this.x3d_LinewidthScaleFactor,1);if(e.uniform1i(this.x3d_ColorMaterial,t.colorMaterial),n){e.uniform1i(this.x3d_Lighting,!0),n.setShaderUniforms(e,this);try{var d=this.normalMatrixArray;d[0]=a[0],d[1]=a[4],d[2]=a[8],d[3]=a[1],d[4]=a[5],d[5]=a[9],d[6]=a[2],d[7]=a[6],d[8]=a[10],r.prototype.inverse.call(d),e.uniformMatrix3fv(this.x3d_NormalMatrix,!1,d)}catch(t){e.uniformMatrix3fv(this.x3d_NormalMatrix,!1,new Float32Array(r.Identity))}}else if(e.uniform1i(this.x3d_Lighting,!1),this.getCustom())try{var d=this.normalMatrixArray;d[0]=a[0],d[1]=a[4],d[2]=a[8],d[3]=a[1],d[4]=a[5],d[5]=a[9],d[6]=a[2],d[7]=a[6],d[8]=a[10],r.prototype.inverse.call(d),e.uniformMatrix3fv(this.x3d_NormalMatrix,!1,d)}catch(t){e.uniformMatrix3fv(this.x3d_NormalMatrix,!1,new Float32Array(r.Identity))}s?(s.setShaderUniforms(e,this,0),o.setShaderUniforms(e,this)):(this.textureTypeArray[0]=0,e.uniform1iv(this.x3d_TextureType,this.textureTypeArray),this.getCustom()&&o.setShaderUniforms(e,this)),e.uniformMatrix4fv(this.x3d_ModelViewMatrix,!1,a)},enable:function(e){var t=this.getBrowser();for(let a of this.textures){var i=a[0],n=a[1],r=n.name,s=n.texture;if(t.getCombinedTextureUnits().length){var o=n.textureUnit=t.getCombinedTextureUnits().pop();e.uniform1i(i,o),e.activeTexture(e.TEXTURE0+o),e.bindTexture(s.getTarget(),s.getTexture())}else console.warn("Not enough combined texture units for uniform variable '"+r+"' available.")}e.activeTexture(e.TEXTURE0)},disable:function(e){var t=this.getBrowser();for(let e of this.textures){var i=e[1],n=i.textureUnit;void 0!==n&&t.getCombinedTextureUnits().push(n),i.textureUnit=void 0}},enableFloatAttrib:function(e,t,i,n){var r=e.getAttribLocation(this.getProgram(),t);r!==-1&&(e.enableVertexAttribArray(r),e.bindBuffer(e.ARRAY_BUFFER,i),e.vertexAttribPointer(r,n,e.FLOAT,!1,0,0))},disableFloatAttrib:function(e,t){var i=e.getAttribLocation(this.getProgram(),t);i!==-1&&e.disableVertexAttribArray(i)},enableMatrix3Attrib:function(e,t,i){var n=e.getAttribLocation(this.getProgram(),t);n!==-1&&(e.enableVertexAttribArray(n),e.enableVertexAttribArray(n+1),e.enableVertexAttribArray(n+2),e.bindBuffer(e.ARRAY_BUFFER,i),e.vertexAttribPointer(n,3,e.FLOAT,!1,36,0),e.vertexAttribPointer(n+1,3,e.FLOAT,!1,36,12),e.vertexAttribPointer(n+2,3,e.FLOAT,!1,36,24))},disableMatrix3Attrib:function(e,t){var i=e.getAttribLocation(this.getProgram(),t);i!==-1&&(e.disableVertexAttribArray(i),e.disableVertexAttribArray(i+1),e.disableVertexAttribArray(i+2))},enableMatrix4Attrib:function(e,t,i){var n=e.getAttribLocation(this.getProgram(),t);n!==-1&&(e.enableVertexAttribArray(n),e.enableVertexAttribArray(n+1),e.enableVertexAttribArray(n+2),e.enableVertexAttribArray(n+3),e.bindBuffer(e.ARRAY_BUFFER,i),e.vertexAttribPointer(n,4,e.FLOAT,!1,64,0),e.vertexAttribPointer(n+1,4,e.FLOAT,!1,64,16),e.vertexAttribPointer(n+2,4,e.FLOAT,!1,64,32),e.vertexAttribPointer(n+3,4,e.FLOAT,!1,64,48))},disableMatrix4Attrib:function(e,t){var i=e.getAttribLocation(this.getProgram(),t);i!==-1&&(e.disableVertexAttribArray(i),e.disableVertexAttribArray(i+1),e.disableVertexAttribArray(i+2),e.disableVertexAttribArray(i+3))},enableColorAttribute:function(e,t){e.enableVertexAttribArray(this.x3d_Color),e.bindBuffer(e.ARRAY_BUFFER,t),e.vertexAttribPointer(this.x3d_Color,4,e.FLOAT,!1,0,0)},disableColorAttribute:function(e){e.disableVertexAttribArray(this.x3d_Color)},enableTexCoordAttribute:function(e,t){e.enableVertexAttribArray(this.x3d_TexCoord),e.bindBuffer(e.ARRAY_BUFFER,t[0]),e.vertexAttribPointer(this.x3d_TexCoord,4,e.FLOAT,!1,0,0)},disableTexCoordAttribute:function(e){e.disableVertexAttribArray(this.x3d_TexCoord)},enableNormalAttribute:function(e,t){e.enableVertexAttribArray(this.x3d_Normal),e.bindBuffer(e.ARRAY_BUFFER,t),e.vertexAttribPointer(this.x3d_Normal,3,e.FLOAT,!1,0,0)},disableNormalAttribute:function(e){e.disableVertexAttribArray(this.x3d_Normal)},enableVertexAttribute:function(e,t){e.enableVertexAttribArray(this.x3d_Vertex),
e.bindBuffer(e.ARRAY_BUFFER,t),e.vertexAttribPointer(this.x3d_Vertex,4,e.FLOAT,!1,0,0)},disableVertexAttribute:function(e){e.disableVertexAttribArray(this.x3d_Vertex)},setParticle:function(e,t,i,n){e.uniformMatrix4fv(this.x3d_ModelViewMatrix,!1,n),e.uniform1i(this.x3d_ParticleId,t),e.uniform1i(this.x3d_ParticleLife,i.life),e.uniform1f(this.x3d_ParticleElapsedTime,i.elapsedTime/i.lifetime)},getProgramInfo:function(){function e(e,t){return e<t?-1:e>t?1:0}for(var t=this.getBrowser().getContext(),i=this.getProgram(),n={attributes:[],uniforms:[],attributeCount:0,uniformCount:0},r=t.getProgramParameter(i,t.ACTIVE_UNIFORMS),s=t.getProgramParameter(i,t.ACTIVE_ATTRIBUTES),o={35664:"vec2",35665:"vec3",35666:"vec4",35667:"ivec2",35668:"ivec3",35669:"ivec4",35670:"bool",35671:"bvec2",35672:"bvec3",35673:"bvec4",35674:"mat2",35675:"mat3",35676:"mat4",35678:"sampler2D",35680:"samplerCube",5120:"byte",5121:"ubyte",5122:"short",5123:"ushort",5124:"int",5125:"uint",5126:"float"},a=0;a<r;++a){var u=t.getActiveUniform(i,a);u.typeName=o[u.type],n.uniforms.push(Object.assign({},u)),n.uniformCount+=u.size}for(var a=0;a<s;++a){var l=t.getActiveAttrib(i,a);l.typeName=o[l.type],n.attributes.push(Object.assign({},l)),n.attributeCount+=l.size}return n.uniforms.sort(function(t,i){return e(t.name,i.name)}),n.attributes.sort(function(t,i){return e(t.name,i.name)}),n},printProgramInfo:function(){var e=this.getProgramInfo();console.log(this.getName()),console.table(e.attributes),console.log(this.getName(),"attributeCount",e.attributeCount),console.log(this.getName()),console.table(e.uniforms),console.log(this.getName(),"uniformCount",e.uniformCount)}},s}),define("x_ite/Components/Shaders/ComposedShader",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shaders/X3DShaderNode","x_ite/Components/Shaders/X3DProgrammableShaderObject","x_ite/Components/Networking/LoadSensor","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s,o,a){"use strict";function u(e){n.call(this,e),r.call(this,e),this.addType(a.ComposedShader),this.loadSensor=new s(e)}return u.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:u,fieldDefinitions:new i([new t(a.inputOutput,"metadata",new e.SFNode),new t(a.inputOnly,"activate",new e.SFBool),new t(a.outputOnly,"isSelected",new e.SFBool),new t(a.outputOnly,"isValid",new e.SFBool),new t(a.initializeOnly,"language",new e.SFString),new t(a.inputOutput,"parts",new e.MFNode)]),wireframe:!1,getTypeName:function(){return"ComposedShader"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"shaders"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this);var e=this.getBrowser().getContext();this.primitiveMode=e.TRIANGLES,this.isLive().addInterest("set_live__",this),this.activate_.addInterest("set_activate__",this),this.parts_.addFieldInterest(this.loadSensor.watchList_),this.loadSensor.isLoaded_.addInterest("set_loaded__",this),this.loadSensor.watchList_=this.parts_,this.loadSensor.setPrivate(!0),this.loadSensor.setup()},getProgram:function(){return this.program},set_live__:function(){var e=this.getBrowser().getContext();this.isLive().getValue()?this.isValid_.getValue()&&(this.enable(e),this.addShaderFields(),this.disable(e)):this.isValid_.getValue()&&(this.enable(e),this.removeShaderFields(),this.disable(e))},set_activate__:function(){this.activate_.getValue()&&this.set_loaded__()},set_loaded__:function(){if(this.loadSensor.isLoaded_.getValue()){var e=this.getBrowser().getContext(),t=e.createProgram(),i=this.parts_.getValue(),n=0;this.isValid_.getValue()&&this.removeShaderFields(),this.program=t;for(var r=0,s=i.length;r<s;++r){var u=o(a.ShaderPart,i[r]);u&&(n+=u.isValid(),e.attachShader(t,u.getShader()))}n&&(this.bindAttributeLocations(e,t),e.linkProgram(t),n=n&&e.getProgramParameter(t,e.LINK_STATUS)),n?(e.useProgram(this.program),this.getDefaultUniforms()?this.addShaderFields():n=!1):console.warn("Couldn't initialize "+this.getTypeName()+" '"+this.getName()+"': "+e.getProgramInfoLog(t)),this.isValid_=n}else this.isValid_=!1},set_field__:function(e){this.getBrowser().getContext().useProgram(this.program),r.prototype.set_field__.call(this,e)},setGlobalUniforms:function(e,t,i,n,s){e.useProgram(this.program),r.prototype.setGlobalUniforms.call(this,e,t,i,n,s)},enable:function(e){e.useProgram(this.program),r.prototype.enable.call(this,e)}}),u}),define("text!x_ite/Browser/Shaders/Inlcude/Shadow.h",[],function(){return'/* -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-*/\n\n#pragma X3D include "Pack.h"\n\n#ifdef X3D_SHADOWS\n\nuniform sampler2D x3d_ShadowMap [x3d_MaxLights];\n\nfloat\ngetShadowDepth (const in int index, const in vec2 shadowCoord)\n{\n\t#if x3d_MaxLights > 0\n\tif (index == 0)\n\t\treturn unpack (texture2D (x3d_ShadowMap [0], shadowCoord));\n\t#endif\n\n\t#if x3d_MaxLights > 1\n\tif (index == 1)\n\t\treturn unpack (texture2D (x3d_ShadowMap [1], shadowCoord));\n\t#endif\n\n\t#if x3d_MaxLights > 2\n\tif (index == 2)\n\t\treturn unpack (texture2D (x3d_ShadowMap [2], shadowCoord));\n\t#endif\n\n\t#if x3d_MaxLights > 3\n\tif (index == 3)\n\t\treturn unpack (texture2D (x3d_ShadowMap [3], shadowCoord));\n\t#endif\n\n\t#if x3d_MaxLights > 4\n\tif (index == 4)\n\t\treturn unpack (texture2D (x3d_ShadowMap [4], shadowCoord));\n\t#endif\n\n\t#if x3d_MaxLights > 5\n\tif (index == 5)\n\t\treturn unpack (texture2D (x3d_ShadowMap [5], shadowCoord));\n\t#endif\n\n\t#if x3d_MaxLights > 6\n\tif (index == 6)\n\t\treturn unpack (texture2D (x3d_ShadowMap [6], shadowCoord));\n\t#endif\n\n\t#if x3d_MaxLights > 7\n\tif (index == 7)\n\t\treturn unpack (texture2D (x3d_ShadowMap [7], shadowCoord));\n\t#endif\n\n\treturn 0.0;\n}\n\nfloat\ntexture2DCompare (const in int index, const in vec2 texCoord, const in float compare)\n{\n\treturn step (getShadowDepth (index, texCoord), compare);\n}\n\nfloat\ntexture2DShadowLerp (const in int index, const in vec2 texelSize, const in float shadowMapSize, const in vec2 texCoord, const in float compare)\n{\n\tconst vec2 offset = vec2 (0.0, 1.0);\n\n\tvec2 centroidTexCoord = floor (texCoord * shadowMapSize + 0.5) / shadowMapSize;\n\n\tfloat lb = texture2DCompare (index, centroidTexCoord + texelSize * offset .xx, compare);\n\tfloat lt = texture2DCompare (index, centroidTexCoord + texelSize * offset .xy, compare);\n\tfloat rb = texture2DCompare (index, centroidTexCoord + texelSize * offset .yx, compare);\n\tfloat rt = texture2DCompare (index, centroidTexCoord + texelSize * offset .yy, compare);\n\n\tvec2 f = fract (texCoord * shadowMapSize + 0.5);\n\n\tfloat a = mix (lb, lt, f.y);\n\tfloat b = mix (rb, rt, f.y);\n\tfloat c = mix (a, b, f.x);\n\n\treturn c;\n}\n\n//https://gist.github.com/tschw/da10c43c467ce8afd0c4\nvec2\ncubeToUVCompact (in vec3 v, const float texelSizeY)\n{\n\t// Compact layout:\n\t//\n\t// xzXZ\t\tChar: Axis\n\t// yyYY\t\tCase: Sign\n\n\t// Number of texels to avoid at the edge of each square\n\n\tvec3 absV = abs (v);\n\n\t// Intersect unit cube\n\n\tfloat scaleToCube = 1.0 / max (absV .x, max (absV .y, absV .z));\n\n\tabsV *= scaleToCube;\n\n\t// Apply scale to avoid seams\n\n\t// one texel less per square (half a texel on each side)\n\tv *= scaleToCube * (1.0 - 2.0 * texelSizeY);\n\n\t// Unwrap\n\n\t// space: -1 ... 1 range for each square\n\t//\n\t// #X##\t\tdim    := ( 4 , 2 )\n\t//  # #\t\tcenter := ( 1 , 1 )\n\n\tvec2 planar = v .xy;\n\n\tfloat almostATexel = 1.5 * texelSizeY;\n\tfloat almostOne    = 1.0 - almostATexel;\n\n\tif (absV .z >= almostOne)\n\t{\n\t\t// zZ\n\n\t\tif (v.z > 0.0)\n\t\t\tplanar .x = 4.0 - v.x;\n\t}\n\telse if (absV .x >= almostOne)\n\t{\n\t\t// xX\n\n\t\tfloat signX = sign (v.x);\n\n\t\tplanar .x = v.z * signX + 2.0 * signX;\n\t}\n\telse if (absV .y >= almostOne)\n\t{\n\t\t// yY\n\n\t\tfloat signY = sign (v.y);\n\n\t\tplanar .x = (v.x + 0.5 + signY) * 2.0;\n\t\tplanar .y = v.z * signY - 2.0;\n\t}\n\n\t// Transform to UV space\n\n\t// scale := 0.5 / dim\n\t// translate := ( center + 0.5 ) / dim\n\treturn vec2 (0.125, 0.25) * planar + vec2 (0.375, 0.75);\n}\n\nmat4\ngetPointLightRotation (const in vec3 vector)\n{\n\tmat4 rotations [6];\n\trotations [0] = mat4 ( 0, 0 , 1, 0,   0, 1,  0, 0,  -1,  0,  0, 0,   0, 0, 0, 1);  // left\n\trotations [1] = mat4 ( 0, 0, -1, 0,   0, 1,  0, 0,   1,  0,  0, 0,   0, 0, 0, 1);  // right\n\trotations [2] = mat4 (-1, 0,  0, 0,   0, 1,  0, 0,   0,  0, -1, 0,   0, 0, 0, 1);  // front\n\trotations [3] = mat4 ( 1, 0,  0, 0,   0, 1,  0, 0,   0,  0,  1, 0,   0, 0, 0, 1);  // back\n\trotations [4] = mat4 ( 1, 0,  0, 0,   0, 0,  1, 0,   0, -1,  0, 0,   0, 0, 0, 1);  // bottom\n\trotations [5] = mat4 ( 1, 0,  0, 0,   0, 0, -1, 0,   0,  1,  0, 0,   0, 0, 0, 1);  // top\n\n\tvec3 a = abs (vector .xyz);\n\n\tif (a .x > a .y)\n\t{\n\t\tif (a .x > a .z)\n\t\t\treturn vector .x > 0.0 ? rotations [1] : rotations [0];\n\t\telse\n\t\t\treturn vector .z > 0.0 ? rotations [2] : rotations [3];\n\t}\n\telse\n\t{\n\t\tif (a .y > a .z)\n\t\t\treturn vector .y > 0.0 ? rotations [5] : rotations [4];\n\t\telse\n\t\t\treturn vector .z > 0.0 ? rotations [2] : rotations [3];\n\t}\n\n\treturn rotations [3];\n}\n\n// DEBUG\n//vec4 tex;\n\nfloat\ngetShadowIntensity (const in int index, const in x3d_LightSourceParameters light)\n{\n\tif (light .type == x3d_PointLight)\n\t{\n\t\tconst mat4 biasMatrix = mat4 (0.5, 0.0, 0.0, 0.0,\n\t\t\t                           0.0, 0.5, 0.0, 0.0,\n\t\t\t                           0.0, 0.0, 0.5, 0.0,\n\t\t\t                           0.5, 0.5, 0.5, 1.0);\n\n\t\t// 90° fov, as used in PointLight shadow calculations.\n\t\tconst mat4 projectionMatrix = mat4 (1.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, -1.000025000312504, -1.0, 0, 0.0, -0.25000312503906297, 0.0);\n\n\t\tvec2 texelSize = vec2 (1.0) / (float (light .shadowMapSize) * vec2 (4.0, 2.0));\n\n\t\t// for point lights, the uniform @vShadowCoord is re-purposed to hold\n\t\t// the vector from the light to the world-space position of the fragment.\n\t\tvec4 shadowCoord     = light .shadowMatrix * vec4 (v, 1.0);\n\t\tvec3 lightToPosition = shadowCoord .xyz;\n\n\t\tshadowCoord       = biasMatrix * (projectionMatrix * (getPointLightRotation (lightToPosition) * shadowCoord));\n\t\tshadowCoord .z   -= light .shadowBias;\n\t\tshadowCoord .xyz /= shadowCoord .w;\n\n\t\t// DEBUG\n\t\t//tex = texture2D (x3d_ShadowMap [0], cubeToUVCompact (lightToPosition, texelSize .y));\n\n\t\t#if defined (X3D_PCF_FILTERING) || defined (X3D_PCF_SOFT_FILTERING)\n\t\n\t\t\tvec2 offset = vec2 (-1, 1) * (texelSize .y * 42.0);\n\t\n\t\t\tfloat value = (\n\t\t\t\ttexture2DCompare (index, cubeToUVCompact (lightToPosition + offset .xyy, texelSize .y), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, cubeToUVCompact (lightToPosition + offset .yyy, texelSize .y), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, cubeToUVCompact (lightToPosition + offset .xyx, texelSize .y), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, cubeToUVCompact (lightToPosition + offset .yyx, texelSize .y), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, cubeToUVCompact (lightToPosition, texelSize .y), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, cubeToUVCompact (lightToPosition + offset .xxy, texelSize .y), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, cubeToUVCompact (lightToPosition + offset .yxy, texelSize .y), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, cubeToUVCompact (lightToPosition + offset .xxx, texelSize .y), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, cubeToUVCompact (lightToPosition + offset .yxx, texelSize .y), shadowCoord .z)\n\t\t\t) * (1.0 / 9.0);\n\t\n\t\t\treturn light .shadowIntensity * value;\n\n\t\t#else // no percentage-closer filtering\n\n\t\t\tfloat value = texture2DCompare (index, cubeToUVCompact (lightToPosition, texelSize .y), shadowCoord .z);\n\n\t\t\treturn light .shadowIntensity * value;\n\t\n\t\t#endif\n\t}\n\telse\n\t{\n\t\t#if defined (X3D_PCF_FILTERING)\n\n\t\t\tvec2 texelSize   = vec2 (1.0) / vec2 (light .shadowMapSize);\n\t\t\tvec4 shadowCoord = light .shadowMatrix * vec4 (v, 1.0);\n\t\n\t\t\tshadowCoord .z   -= light .shadowBias;\n\t\t\tshadowCoord .xyz /= shadowCoord .w;\n\t\n\t\t\tfloat dx0 = - texelSize .x;\n\t\t\tfloat dy0 = - texelSize .y;\n\t\t\tfloat dx1 = + texelSize .x;\n\t\t\tfloat dy1 = + texelSize .y;\n\t\n\t\t\tfloat value = (\n\t\t\t\ttexture2DCompare (index, shadowCoord .xy + vec2 (dx0, dy0), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, shadowCoord .xy + vec2 (0.0, dy0), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, shadowCoord .xy + vec2 (dx1, dy0), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, shadowCoord .xy + vec2 (dx0, 0.0), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, shadowCoord .xy, shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, shadowCoord .xy + vec2 (dx1, 0.0), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, shadowCoord .xy + vec2 (dx0, dy1), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, shadowCoord .xy + vec2 (0.0, dy1), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, shadowCoord .xy + vec2 (dx1, dy1), shadowCoord .z)\n\t\t\t) * (1.0 / 9.0);\n\t\n\t\t\treturn light .shadowIntensity * value;\n\n\t\t#elif defined (X3D_PCF_SOFT_FILTERING)\n\n\t\t\tvec2 texelSize   = vec2 (1.0) / vec2 (light .shadowMapSize);\n\t\t\tvec4 shadowCoord = light .shadowMatrix * vec4 (v, 1.0);\n\t\n\t\t\tshadowCoord .z   -= light .shadowBias;\n\t\t\tshadowCoord .xyz /= shadowCoord .w;\n\t\n\t\t\tfloat dx0 = - texelSize.x;\n\t\t\tfloat dy0 = - texelSize.y;\n\t\t\tfloat dx1 = + texelSize.x;\n\t\t\tfloat dy1 = + texelSize.y;\n\t\t\t\n\t\t\tfloat value = (\n\t\t\t\ttexture2DShadowLerp (index, texelSize, float (shadowMapSize), shadowCoord .xy + vec2 (dx0, dy0), shadowCoord .z) +\n\t\t\t\ttexture2DShadowLerp (index, texelSize, float (shadowMapSize), shadowCoord .xy + vec2 (0.0, dy0), shadowCoord .z) +\n\t\t\t\ttexture2DShadowLerp (index, texelSize, float (shadowMapSize), shadowCoord .xy + vec2 (dx1, dy0), shadowCoord .z) +\n\t\t\t\ttexture2DShadowLerp (index, texelSize, float (shadowMapSize), shadowCoord .xy + vec2 (dx0, 0.0), shadowCoord .z) +\n\t\t\t\ttexture2DShadowLerp (index, texelSize, float (shadowMapSize), shadowCoord .xy, shadowCoord .z) +\n\t\t\t\ttexture2DShadowLerp (index, texelSize, float (shadowMapSize), shadowCoord .xy + vec2 (dx1, 0.0), shadowCoord .z) +\n\t\t\t\ttexture2DShadowLerp (index, texelSize, float (shadowMapSize), shadowCoord .xy + vec2 (dx0, dy1), shadowCoord .z) +\n\t\t\t\ttexture2DShadowLerp (index, texelSize, float (shadowMapSize), shadowCoord .xy + vec2 (0.0, dy1), shadowCoord .z) +\n\t\t\t\ttexture2DShadowLerp (index, texelSize, float (shadowMapSize), shadowCoord .xy + vec2 (dx1, dy1), shadowCoord .z)\n\t\t\t) * ( 1.0 / 9.0 );\n\t\n\t\t\treturn light .shadowIntensity * value;\n\n\t\t#else // no percentage-closer filtering\n\n\t\t\tvec4 shadowCoord = shadowMatrix * vec4 (v, 1.0);\n\t\n\t\t\tshadowCoord .z   -= shadowBias;\n\t\t\tshadowCoord .xyz /= shadowCoord .w;\n\t\n\t\t\tfloat value = texture2DCompare (index, shadowCoord .xy, shadowCoord .z);\n\t\n\t\t\treturn light .shadowIntensity * value;\n\n\t\t#endif\n\t}\n\n\treturn 0.0;\n}\n\n#endif'}),define("text!x_ite/Browser/Shaders/Inlcude/Pack.h",[],function(){return"/* -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-*/\n\n#ifdef TITANIA\n\nvec4\npack (const in float value)\n{\n\treturn vec4 (0.0, 0.0, 0.0, 0.0);\n}\n\nfloat\nunpack (const in vec4 color)\n{\n\treturn color .r;\n}\n\n#endif\n\n#ifdef X_ITE\n\nvec4\npack (const in float value)\n{\n\tconst vec3 bitShifts = vec3 (255.0,\n\t                             255.0 * 255.0,\n\t                             255.0 * 255.0 * 255.0);\n\n\treturn vec4 (value, fract (value * bitShifts));\n}\n\n#ifdef X3D_DEPTH_TEXTURE\n\nfloat\nunpack (const in vec4 color)\n{\n\treturn color .r;\n}\n\n#else\n\nfloat\nunpack (const vec4 color)\n{\n\tconst vec3 bitShifts = vec3 (1.0 / 255.0,\n\t                             1.0 / (255.0 * 255.0),\n\t                             1.0 / (255.0 * 255.0 * 255.0));\n\n\treturn color .x + dot (color .gba, bitShifts);\n}\n\n#endif\n#endif\n"}),define("text!x_ite/Browser/Shaders/Types.h",[],function(){return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nstruct x3d_FogParameters {\n\tmediump int   type;\n\tmediump vec3  color;\n\tmediump vec3  center;\n\tmediump float visibilityRange;\n};\n\n//uniform x3d_FogParameters x3d_Fog;\n\nstruct x3d_LightSourceParameters {\n\tmediump int   type;\n\tmediump vec3  color;\n\tmediump float intensity;\n\tmediump float ambientIntensity;\n\tmediump vec3  attenuation;\n\tmediump vec3  location;\n\tmediump vec3  direction;\n\tmediump float radius;\n\tmediump float beamWidth;\n\tmediump float cutOffAngle;\n\t#ifdef X3D_SHADOWS\n\tmediump vec3  shadowColor;\n\tmediump float shadowIntensity;\n\tmediump float shadowBias;\n\tmediump mat4  shadowMatrix;\n\tmediump int   shadowMapSize;\n\t#endif\n};\n\n//uniform x3d_LightSourceParameters x3d_LightSource [x3d_MaxLights];\n\nstruct x3d_MaterialParameters  \n{   \n\tmediump float ambientIntensity;\n\tmediump vec3  diffuseColor;\n\tmediump vec3  specularColor;\n\tmediump vec3  emissiveColor;\n\tmediump float shininess;\n\tmediump float transparency;\n};\n\n//uniform x3d_MaterialParameters x3d_FrontMaterial;  \n//uniform x3d_MaterialParameters x3d_BackMaterial;        \n\nstruct x3d_ParticleParameters  \n{   \n\tmediump int   id;\n\tmediump int   life;\n\tmediump float elapsedTime;\n};\n\n//uniform x3d_ParticleParameters x3d_Particle;  \n"}),define("x_ite/DEBUG",[],function(){"use strict";return!1}),define("x_ite/Browser/Shaders/Shader",["text!x_ite/Browser/Shaders/Inlcude/Shadow.h","text!x_ite/Browser/Shaders/Inlcude/Pack.h","text!x_ite/Browser/Shaders/Types.h","x_ite/DEBUG"],function(e,t,i,n){"use strict";function r(e,t,i){e.indexOf(t)!==-1&&console.warn("Use of '"+t+"' is depreciated, use '"+i+"' instead. See http://create3000.de/x_ite/custom-shaders/.")}var s={Shadow:e,Pack:t};return{getSource:function(e){var t=e.split("\n"),i=null;e="#line 1\n";for(var n=0,r=t.length;n<r;++n){var o=t[n];(i=o.match(/^#pragma\s+X3D\s+include\s+".*?([^\/]+).h"\s*$/))?(e+=this.getSource(s[i[1]]),e+="\n",e+="#line "+(n+1)+"\n"):(e+=o,e+="\n")}return e},getShaderSource:function(e,t){var t=this.getSource(t),n="\\s+|/\\*[\\s\\S]*?\\*/|//.*?\\n",s="#line\\s+.*?\\n|#if\\s+.*?\\n|#elif\\s+.*?\\n|#ifdef\\s+.*?\\n|#ifndef\\s+.*?\\n|#else.*?\\n|#endif.*?\\n|#define\\s+(?:[^\\n\\\\]|\\\\[^\\r\\n]|\\\\\\r?\\n)*\\n|#undef\\s+.*?\\n|#pragma\\s+.*?\\n",o=new RegExp("^((?:"+n+"|"+s+")*(?:#version\\s+.*?\\n)?(?:"+n+"|"+s+"|#extension\\s+.*?\\n)*)([\\s\\S]*)$"),a=t.match(o);if(!a)return t;var u="";u+="#define X_ITE\n",e.getRenderingProperty("LogarithmicDepthBuffer")&&(u+="#define X3D_LOGARITHMIC_DEPTH_BUFFER\n"),e.getExtension("WEBGL_depth_texture")&&(u+="#define X3D_DEPTH_TEXTURE\n");var l="";l+="#define x3d_GeometryPoints  0\n",l+="#define x3d_GeometryLines   1\n",l+="#define x3d_Geometry2D      2\n",l+="#define x3d_Geometry3D      3\n",l+="#define x3d_MaxClipPlanes  "+e.getMaxClipPlanes()+"\n",l+="#define x3d_LinearFog        1\n",l+="#define x3d_ExponentialFog   2\n",l+="#define x3d_Exponential2Fog  3\n",l+="#define x3d_MaxLights         "+e.getMaxLights()+"\n",l+="#define x3d_DirectionalLight  1\n",l+="#define x3d_PointLight        2\n",l+="#define x3d_SpotLight         3\n",l+="#define X3D_PCF_FILTERING\n",l+="#define x3d_MaxTextures                "+e.getMaxTextures()+"\n",l+="#define x3d_TextureType2D              2\n",l+="#define x3d_TextureType3D              3\n",l+="#define x3d_TextureTypeCubeMapTexture  4\n",l+="#define x3d_NoneClipPlane  vec4 (88.0, 51.0, 68.0, 33.0)\n",l+="#define x3d_NoneFog        0\n",l+="#define x3d_NoneLight      0\n",l+="#define x3d_NoneTexture    0\n",l+="#define x3d_None 0\n",r(t,"x3d_NoneClipPlane","x3d_NumClipPlanes"),r(t,"x3d_NoneFog","x3d_None"),r(t,"x3d_NoneLight","x3d_NumLights"),r(t,"x3d_NoneTexture","x3d_NumTextures");var h=i,c=t.match(/\s*precision\s+(lowp|mediump|highp)\s+float\s*;/),d=t.match(/\s*precision\s+(lowp|mediump|highp)\s+int\s*;/),p=c?c[1]:"mediump",f=d?d[1]:"mediump";return h=h.replace(/mediump\s+(float|vec2|vec3|mat3|mat4)/g,p+" $1"),h=h.replace(/mediump\s+(int)/g,f+" $1"),u+a[1]+l+h+a[2]}}}),define("x_ite/Parser/HTMLSupport",[],function(){"use strict";var e={attributeLowerCaseToCamelCase:{accesstype:"accessType",actionkeypress:"actionKeyPress",actionkeyrelease:"actionKeyRelease",activate:"activate",activelayer:"activeLayer",additionalinterface:"additionalInterface",address:"address",align:"align",alpha:"alpha",altkey:"altKey",ambientintensity:"ambientIntensity",anchorpoint:"anchorPoint",angle:"angle",anglerate:"angleRate",angulardampingfactor:"angularDampingFactor",angularvelocity:"angularVelocity",anisotropicdegree:"anisotropicDegree",antennalocation:"antennaLocation",antennapatternlength:"antennaPatternLength",antennapatterntype:"antennaPatternType",appinfo:"appinfo",applicationid:"applicationID",applied:"applied",appliedparameters:"appliedParameters",articulationparameterarray:"articulationParameterArray",articulationparameterchangeindicatorarray:"articulationParameterChangeIndicatorArray",articulationparametercount:"articulationParameterCount",articulationparameterdesignatorarray:"articulationParameterDesignatorArray",articulationparameteridpartattachedtoarray:"articulationParameterIdPartAttachedToArray",articulationparametertypearray:"articulationParameterTypeArray",articulationparametervalue0_changed:"articulationParameterValue0_changed",articulationparametervalue1_changed:"articulationParameterValue1_changed",articulationparametervalue2_changed:"articulationParameterValue2_changed",articulationparametervalue3_changed:"articulationParameterValue3_changed",articulationparametervalue4_changed:"articulationParameterValue4_changed",articulationparametervalue5_changed:"articulationParameterValue5_changed",articulationparametervalue6_changed:"articulationParameterValue6_changed",articulationparametervalue7_changed:"articulationParameterValue7_changed",as:"AS",attenuation:"attenuation",autocalc:"autoCalc",autodamp:"autoDamp",autodisable:"autoDisable",autooffset:"autoOffset",avatarsize:"avatarSize",axis:"axis",axis1:"axis1",axis1angle:"axis1Angle",axis1torque:"axis1Torque",axis2:"axis2",axis2angle:"axis2Angle",axis2torque:"axis2Torque",axis3angle:"axis3Angle",axis3torque:"axis3Torque",axisofrotation:"axisOfRotation",axisrotation:"axisRotation",backambientintensity:"backAmbientIntensity",backdiffusecolor:"backDiffuseColor",backemissivecolor:"backEmissiveColor",backshininess:"backShininess",backspecularcolor:"backSpecularColor",backtransparency:"backTransparency",backurl:"backUrl",bboxcenter:"bboxCenter",bboxsize:"bboxSize",beamwidth:"beamWidth",begincap:"beginCap",bindtime:"bindTime",body1anchorpoint:"body1AnchorPoint",body1axis:"body1Axis",body2anchorpoint:"body2AnchorPoint",body2axis:"body2Axis",bordercolor:"borderColor",borderwidth:"borderWidth",bottom:"bottom",bottomradius:"bottomRadius",bottomurl:"bottomUrl",bounce:"bounce",boundarymoder:"boundaryModeR",boundarymodes:"boundaryModeS",boundarymodet:"boundaryModeT",boundaryopacity:"boundaryOpacity",category:"category",ccw:"ccw",center:"center",centerofmass:"centerOfMass",centerofrotation:"centerOfRotation",centerofrotation_changed:"centerOfRotation_changed",child1url:"child1Url",child2url:"child2Url",child3url:"child3Url",child4url:"child4Url",class:"class",clipboundary:"clipBoundary",closed:"closed",closuretype:"closureType",collidetime:"collideTime",collisiontype:"collisionType",color:"color",colorindex:"colorIndex",colorkey:"colorKey",colorpervertex:"colorPerVertex",colorsteps:"colorSteps",constantforcemix:"constantForceMix",contactnormal:"contactNormal",contactsurfacethickness:"contactSurfaceThickness",containerfield:"containerField",content:"content",contourstepsize:"contourStepSize",controlkey:"controlKey",controlpoint:"controlPoint",conversionfactor:"conversionFactor",convex:"convex",coolcolor:"coolColor",coordindex:"coordIndex",country:"country",creaseangle:"creaseAngle",createparticles:"createParticles",crosssection:"crossSection",cryptokeyid:"cryptoKeyID",cryptosystem:"cryptoSystem",cutoffangle:"cutOffAngle",cycleinterval:"cycleInterval",cycletime:"cycleTime",data:"data",datalength:"dataLength",deadreckoning:"deadReckoning",def:"DEF",deletionallowed:"deletionAllowed",depth:"depth",description:"description",desiredangularvelocity1:"desiredAngularVelocity1",desiredangularvelocity2:"desiredAngularVelocity2",detonatetime:"detonateTime",detonationlocation:"detonationLocation",detonationrelativelocation:"detonationRelativeLocation",detonationresult:"detonationResult",diffusecolor:"diffuseColor",dimensions:"dimensions",dir:"dir",direction:"direction",directoutput:"directOutput",disableangularspeed:"disableAngularSpeed",disablelinearspeed:"disableLinearSpeed",disabletime:"disableTime",diskangle:"diskAngle",displacements:"displacements",displayed:"displayed",documentation:"documentation",domain:"domain",duration:"duration",duration_changed:"duration_changed",easeineaseout:"easeInEaseOut",edgecolor:"edgeColor",elapsedtime:"elapsedTime",emissivecolor:"emissiveColor",enabled:"enabled",enabledaxes:"enabledAxes",encodingscheme:"encodingScheme",endangle:"endAngle",endcap:"endCap",enteredtext:"enteredText",entertime:"enterTime",entitycategory:"entityCategory",entitycountry:"entityCountry",entitydomain:"entityDomain",entityextra:"entityExtra",entityid:"entityID",entitykind:"entityKind",entityspecific:"entitySpecific",entitysubcategory:"entitySubcategory",errorcorrection:"errorCorrection",eventapplicationid:"eventApplicationID",evententityid:"eventEntityID",eventnumber:"eventNumber",eventsiteid:"eventSiteID",exittime:"exitTime",extra:"extra",family:"family",fancount:"fanCount",fieldofview:"fieldOfView",filled:"filled",finaltext:"finalText",finiterotationaxis:"finiteRotationAxis",fired1:"fired1",fired2:"fired2",firedtime:"firedTime",firemissionindex:"fireMissionIndex",firingrange:"firingRange",firingrate:"firingRate",fixed:"fixed",fogtype:"fogType",force:"force",forceid:"forceID",forceoutput:"forceOutput",forces:"forces",forcetransitions:"forceTransitions",fraction_changed:"fraction_changed",frequency:"frequency",frictioncoefficients:"frictionCoefficients",frictiondirection:"frictionDirection",fromfield:"fromField",fromnode:"fromNode",fronturl:"frontUrl",function:"function",fuse:"fuse",generatemipmaps:"generateMipMaps",geocenter:"geoCenter",geocoord_changed:"geoCoord_changed",geocoords:"geoCoords",geogridorigin:"geoGridOrigin",geometrytype:"geometryType",geosystem:"geoSystem",geovalue_changed:"geovalue_changed",global:"global",gradientthreshold:"gradientThreshold",gravity:"gravity",groundangle:"groundAngle",groundcolor:"groundColor",gustiness:"gustiness",hatchcolor:"hatchColor",hatched:"hatched",hatchstyle:"hatchStyle",headlight:"headlight",height:"height",hinge1angle:"hinge1Angle",hinge1anglerate:"hinge1AngleRate",hinge2angle:"hinge2Angle",hinge2anglerate:"hinge2AngleRate",hitgeocoord_changed:"hitGeoCoord_changed",hitnormal_changed:"hitNormal_changed",hitpoint_changed:"hitPoint_changed",hittexcoord_changed:"hitTexCoord_changed",horizontal:"horizontal","http-equiv":"http-equiv",image:"image",importeddef:"importedDEF",index:"index",inertia:"inertia",info:"info",initialdestination:"initialDestination",initialvalue:"initialValue",inlinedef:"inlineDEF",innerradius:"innerRadius",inputfalse:"inputFalse",inputnegate:"inputNegate",inputsource:"inputSource",inputtrue:"inputTrue",integerkey:"integerKey",intensity:"intensity",intensitythreshold:"intensityThreshold",internal:"internal",intersectiontype:"intersectionType",isactive:"isActive",isbound:"isBound",iscollided:"isCollided",isdetonated:"isDetonated",isloaded:"isLoaded",isnetworkreader:"isNetworkReader",isnetworkwriter:"isNetworkWriter",isover:"isOver",ispaused:"isPaused",ispickable:"isPickable",isrtpheaderheard:"isRtpHeaderHeard",isselected:"isSelected",isstandalone:"isStandAlone",isvalid:"isValid",iterations:"iterations",jump:"jump",justify:"justify",key:"key",keypress:"keyPress",keyrelease:"keyRelease",keyvalue:"keyValue",keyvelocity:"keyVelocity",kind:"kind",knot:"knot",lang:"lang",language:"language",lefttoright:"leftToRight",lefturl:"leftUrl",length:"length",lengthofmodulationparameters:"lengthOfModulationParameters",level:"level",level_changed:"level_changed",lifetimevariation:"lifetimeVariation",lighting:"lighting",limitorientation:"limitOrientation",linearacceleration:"linearAcceleration",lineardampingfactor:"linearDampingFactor",linearvelocity:"linearVelocity",linebounds:"lineBounds",linesegments:"lineSegments",linetype:"linetype",linewidthscalefactor:"linewidthScaleFactor",llimit:"llimit",load:"load",loadtime:"loadTime",localdef:"localDEF",location:"location",loop:"loop",magnificationfilter:"magnificationFilter",marking:"marking",mass:"mass",matrix:"matrix",maxangle:"maxAngle",maxangle1:"maxAngle1",maxback:"maxBack",maxcorrectionspeed:"maxCorrectionSpeed",maxextent:"maxExtent",maxfront:"maxFront",maxparticles:"maxParticles",maxposition:"maxPosition",maxseparation:"maxSeparation",maxtorque1:"maxTorque1",maxtorque2:"maxTorque2",minangle:"minAngle",minangle1:"minAngle1",minback:"minBack",minbouncespeed:"minBounceSpeed",minfront:"minFront",minificationfilter:"minificationFilter",minposition:"minPosition",minseparation:"minSeparation",mode:"mode",modifiedfraction_changed:"modifiedFraction_changed",modulationtypedetail:"modulationTypeDetail",modulationtypemajor:"modulationTypeMajor",modulationtypespreadspectrum:"modulationTypeSpreadSpectrum",modulationtypesystem:"modulationTypeSystem",momentsofinertia:"momentsOfInertia",motor1angle:"motor1Angle",motor1anglerate:"motor1AngleRate",motor1axis:"motor1Axis",motor2angle:"motor2Angle",motor2anglerate:"motor2AngleRate",motor2axis:"motor2Axis",motor3angle:"motor3Angle",motor3anglerate:"motor3AngleRate",motor3axis:"motor3Axis",multicastrelayhost:"multicastRelayHost",multicastrelayport:"multicastRelayPort",munitionapplicationid:"munitionApplicationID",munitionendpoint:"munitionEndPoint",munitionentityid:"munitionEntityID",munitionquantity:"munitionQuantity",munitionsiteid:"munitionSiteID",munitionstartpoint:"munitionStartPoint",mustevaluate:"mustEvaluate",name:"name",networkmode:"networkMode",next:"next",nodefield:"nodeField",normal_changed:"normal_changed",normalindex:"normalIndex",normalizevelocity:"normalizeVelocity",normalpervertex:"normalPerVertex",numcomponents:"numComponents",objecttype:"objectType",offset:"offset",offsetunits:"offsetUnits",on:"on",opacityfactor:"opacityFactor",order:"order",orientation:"orientation",orientation_changed:"orientation_changed",origin:"origin",orthogonalcolor:"orthogonalColor",outerradius:"outerRadius",parallelcolor:"parallelColor",parameter:"parameter",particlelifetime:"particleLifetime",particlesize:"particleSize",pausetime:"pauseTime",phasefunction:"phaseFunction",pickable:"pickable",pickednormal:"pickedNormal",pickedpoint:"pickedPoint",pickedtexturecoordinate:"pickedTextureCoordinate",pitch:"pitch",plane:"plane",point:"point",pointsize:"pointSize",port:"port",position:"position",position_changed:"position_changed",power:"power",preferaccuracy:"preferAccuracy",previous:"previous",priority:"priority",profile:"profile",progress:"progress",protofield:"protoField",radioentitytypecategory:"radioEntityTypeCategory",radioentitytypecountry:"radioEntityTypeCountry",radioentitytypedomain:"radioEntityTypeDomain",radioentitytypekind:"radioEntityTypeKind",radioentitytypenomenclature:"radioEntityTypeNomenclature",radioentitytypenomenclatureversion:"radioEntityTypeNomenclatureVersion",radioid:"radioID",radius:"radius",range:"range",readinterval:"readInterval",receivedpower:"receivedPower",receiverstate:"receiverState",reference:"reference",relativeantennalocation:"relativeAntennaLocation",
repeatr:"repeatR",repeats:"repeatS",repeatt:"repeatT",resumetime:"resumeTime",retainedopacity:"retainedOpacity",retainuseroffsets:"retainUserOffsets",righturl:"rightUrl",rooturl:"rootUrl",rotateyup:"rotateYUp",rotation:"rotation",rotation_changed:"rotation_changed",rtpheaderexpected:"rtpHeaderExpected",samplerate:"sampleRate",samples:"samples",scale:"scale",scalemode:"scaleMode",scaleorientation:"scaleOrientation",scheme:"scheme",segmentenabled:"segmentEnabled",separatebackcolor:"separateBackColor",separation:"separation",separationrate:"separationRate",set_articulationparametervalue0:"set_articulationParameterValue0",set_articulationparametervalue1:"set_articulationParameterValue1",set_articulationparametervalue2:"set_articulationParameterValue2",set_articulationparametervalue3:"set_articulationParameterValue3",set_articulationparametervalue4:"set_articulationParameterValue4",set_articulationparametervalue5:"set_articulationParameterValue5",set_articulationparametervalue6:"set_articulationParameterValue6",set_articulationparametervalue7:"set_articulationParameterValue7",set_bind:"set_bind",set_boolean:"set_boolean",set_colorindex:"set_colorIndex",set_coordindex:"set_coordIndex",set_crosssection:"set_crossSection",set_destination:"set_destination",set_fraction:"set_fraction",set_height:"set_height",set_index:"set_index",set_normalindex:"set_normalIndex",set_orientation:"set_orientation",set_scale:"set_scale",set_spine:"set_spine",set_texcoordindex:"set_texCoordIndex",set_triggertime:"set_triggerTime",set_value:"set_value",shadows:"shadows",shiftkey:"shiftKey",shininess:"shininess",side:"side",silhouetteboundaryopacity:"silhouetteBoundaryOpacity",silhouetteretainedopacity:"silhouetteRetainedOpacity",silhouettesharpness:"silhouetteSharpness",siteid:"siteID",size:"size",sizeunits:"sizeUnits",skincoordindex:"skinCoordIndex",skincoordweight:"skinCoordWeight",skyangle:"skyAngle",skycolor:"skyColor",sliderforce:"sliderForce",slipcoefficients:"slipCoefficients",slipfactors:"slipFactors",softnessconstantforcemix:"softnessConstantForceMix",softnesserrorcorrection:"softnessErrorCorrection",solid:"solid",sortorder:"sortOrder",source:"source",spacing:"spacing",spatialize:"spatialize",specific:"specific",specularcolor:"specularColor",speed:"speed",speedfactor:"speedFactor",spine:"spine",startangle:"startAngle",starttime:"startTime",stiffness:"stiffness",stop1bounce:"stop1Bounce",stop1constantforcemix:"stop1ConstantForceMix",stop1errorcorrection:"stop1ErrorCorrection",stop2bounce:"stop2Bounce",stop2errorcorrection:"stop2ErrorCorrection",stop3bounce:"stop3Bounce",stop3errorcorrection:"stop3ErrorCorrection",stopbounce:"stopBounce",stoperrorcorrection:"stopErrorCorrection",stoptime:"stopTime",string:"string",stripcount:"stripCount",style:"style",subcategory:"subcategory",summary:"summary",surfacearea:"surfaceArea",surfacespeed:"surfaceSpeed",surfacetolerance:"surfaceTolerance",surfacevalues:"surfaceValues",suspensionerrorcorrection:"suspensionErrorCorrection",suspensionforce:"suspensionForce",tau:"tau",tdltype:"tdlType",tessellation:"tessellation",tessellationscale:"tessellationScale",texcoordindex:"texCoordIndex",texcoordkey:"texCoordKey",textbounds:"textBounds",texturecompression:"textureCompression",texturepriority:"texturePriority",time:"time",timeout:"timeOut",timestamp:"timestamp",title:"title",tofield:"toField",toggle:"toggle",tolerance:"tolerance",tonode:"toNode",top:"top",toptobottom:"topToBottom",topurl:"topUrl",torques:"torques",touchtime:"touchTime",trackpoint_changed:"trackPoint_changed",transitioncomplete:"transitionComplete",transitiontime:"transitionTime",transitiontype:"transitionType",translation:"translation",translation_changed:"translation_changed",transmitfrequencybandwidth:"transmitFrequencyBandwidth",transmitstate:"transmitState",transmitterapplicationid:"transmitterApplicationID",transmitterentityid:"transmitterEntityID",transmitterradioid:"transmitterRadioID",transmittersiteid:"transmitterSiteID",transparency:"transparency",triggertime:"triggerTime",triggertrue:"triggerTrue",triggervalue:"triggerValue",turbulence:"turbulence",type:"type",uclosed:"uClosed",udimension:"uDimension",uknot:"uKnot",ulimit:"ulimit",uorder:"uOrder",update:"update",url:"url",use:"USE",usefiniterotation:"useFiniteRotation",usegeometry:"useGeometry",useglobalgravity:"useGlobalGravity",utessellation:"uTessellation",value:"value",value_changed:"value_changed",variation:"variation",vclosed:"vClosed",vdimension:"vDimension",vector:"vector",version:"version",vertexcount:"vertexCount",vertices:"vertices",visibilitylimit:"visibilityLimit",visibilityrange:"visibilityRange",visible:"visible",vknot:"vKnot",vorder:"vOrder",vtessellation:"vTessellation",warhead:"warhead",warmcolor:"warmColor",weight:"weight",weightconstant1:"weightConstant1",weightconstant2:"weightConstant2",weightfunction1:"weightFunction1",weightfunction2:"weightFunction2",whichchoice:"whichChoice",whichgeometry:"whichGeometry",writeinterval:"writeInterval",xdimension:"xDimension",xspacing:"xSpacing",yscale:"yScale",zdimension:"zDimension",zspacing:"zSpacing"}};return Object.preventExtensions(e),Object.freeze(e),Object.seal(e),e}),define("x_ite/Parser/XMLParser",["jquery","x_ite/Basic/X3DField","x_ite/Basic/X3DBaseNode","x_ite/Components/Core/X3DPrototypeInstance","x_ite/Fields","x_ite/Parser/Parser","x_ite/Parser/X3DParser","x_ite/Parser/HTMLSupport","x_ite/Prototype/X3DExternProtoDeclaration","x_ite/Prototype/X3DProtoDeclaration","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s,o,a,u,l,h){"use strict";function c(e){o.call(this,e),this.protoDeclarations=[],this.parents=[],this.parser=new s(e),this.url=new r.MFString;try{this.setUnits(this.getScene().getMetaData("generator")),this.parser.setUnits(this.getUnits())}catch(e){}}function d(e){return e.replace(y,"").split(v)}function p(e){return e.replace(_,"Infinity").replace(x,"NaN").replace(y,"").split(v)}function f(e){return e.replace(y,"").split(v)}function g(e){for(var t=null,i=[];t=w.exec(e);)i.push(t[1]);return i.map(r.SFString.unescape)}var m={initializeOnly:h.initializeOnly,inputOnly:h.inputOnly,outputOnly:h.outputOnly,inputOutput:h.inputOutput};c.prototype=Object.assign(Object.create(o.prototype),{constructor:c,parseIntoScene:function(e){this.getScene().setEncoding("XML"),this.getScene().setProfile(this.getBrowser().getProfile("Full")),this.xmlElement(e)},parseIntoNode:function(e,t){this.pushExecutionContext(e.getExecutionContext()),this.pushParent(e),this.childElement(t),this.popParent(),this.popExecutionContext()},xmlElement:function(t){switch(t.nodeName){case"#document":var i=e(t).children("X3D");if(i.length)for(var n=0;n<i.length;++n)this.x3dElement(i[n]);else this.childrenElements(t);break;case"X3D":this.x3dElement(t);break;case"Scene":case"SCENE":this.sceneElement(t);break;default:this.childElement(t)}},x3dElement:function(e){try{var t=e.getAttribute("profile"),i=this.getBrowser().getProfile(t||"Full");this.getScene().setProfile(i)}catch(e){console.log(e)}var n=e.getAttribute("version");n&&(this.getScene().specificationVersion=n);for(var r=e.childNodes,s=0;s<r.length;++s)this.x3dElementChild(r[s])},x3dElementChild:function(e){switch(e.nodeName){case"head":case"HEAD":return void this.headElement(e);case"Scene":case"SCENE":return void this.sceneElement(e)}},headElement:function(e){for(var t=e.childNodes,i=0;i<t.length;++i)this.headElementChild(t[i]);try{this.setUnits(this.getScene().getMetaData("generator")),this.parser.setUnits(this.getUnits())}catch(e){}},headElementChild:function(e){switch(e.nodeName){case"component":case"COMPONENT":return void this.componentElement(e);case"unit":case"UNIT":return void this.unitElement(e);case"meta":case"META":return void this.metaElement(e)}},componentElement:function(e){try{var t=e.getAttribute("name"),i=parseInt(e.getAttribute("level"));if(null===t)return console.warn("XML Parser Error: Bad component statement: Expected name attribute.");if(null===i)return console.warn("XML Parser Error: Bad component statement: Expected level attribute.");var n=this.getBrowser().getComponent(t,i);this.getScene().addComponent(n)}catch(e){console.log(e.message)}},unitElement:function(e){var t=e.getAttribute("category"),i=e.getAttribute("name"),n=e.getAttribute("conversionFactor");return null===t?console.warn("XML Parser Error: Bad unit statement: Expected category attribute."):null===i?console.warn("XML Parser Error: Bad unit statement: Expected name attribute."):null===n?console.warn("XML Parser Error: Bad unit statement: Expected conversionFactor attribute."):void this.getScene().updateUnit(t,i,parseFloat(n))},metaElement:function(e){var t=e.getAttribute("name"),i=e.getAttribute("content");return null===t?console.warn("XML Parser Error: Bad meta statement: Expected name attribute."):null===i?console.warn("XML Parser Error: Bad meta statement: Expected content attribute."):void this.getScene().setMetaData(t,i)},sceneElement:function(e){this.childrenElements(e)},childrenElements:function(e){for(var t=e.childNodes,i=0;i<t.length;++i)this.childElement(t[i])},childElement:function(e){switch(e.nodeName){case"#comment":case"#text":return;case"#cdata-section":return void this.cdataNode(e);case"ExternProtoDeclare":case"EXTERNPROTODECLARE":return void this.externProtoDeclareElement(e);case"ProtoDeclare":case"PROTODECLARE":return void this.protoDeclareElement(e);case"IS":return void this.isElement(e);case"ProtoInstance":case"PROTOINSTANCE":return void this.protoInstanceElement(e);case"fieldValue":case"FIELDVALUE":return void this.fieldValueElement(e);case"field":case"FIELD":return void this.fieldElement(e);case"ROUTE":return void this.routeElement(e);case"IMPORT":return void this.importElement(e);case"EXPORT":return void this.exportElement(e);default:return void this.nodeElement(e)}},externProtoDeclareElement:function(e){var t=e.getAttribute("name");if(this.id(t)){var i=e.getAttribute("url");if(null===i)return console.warn("XML Parser Error: Bad ExternProtoDeclare statement: Expected url attribute.");this.parser.setInput(i),s.prototype.sfstringValues.call(this.parser,this.url);var n=new u(this.getExecutionContext());this.pushParent(n),this.protoInterfaceElement(e),this.popParent(),n.setName(t),n.url_=this.url,n.setup(),this.getExecutionContext().externprotos.add(t,n)}},protoDeclareElement:function(e){var t=e.getAttribute("name");if(this.id(t)){for(var i=new l(this.getExecutionContext()),n=e.childNodes,r=0;r<n.length;++r){var s=n[r];switch(s.nodeName){case"ProtoInterface":case"PROTOINTERFACE":this.pushParent(i),this.protoInterfaceElement(s),this.popParent();break;default:continue}break}for(var r=0;r<n.length;++r){var s=n[r];switch(s.nodeName){case"ProtoBody":case"PROTOBODY":this.pushExecutionContext(i),this.pushParent(i),this.protoBodyElement(s),this.popParent(),this.popExecutionContext();break;default:continue}break}i.setName(t),i.setup(),this.getExecutionContext().protos.add(t,i)}},protoInterfaceElement:function(e){for(var t=e.childNodes,i=0;i<t.length;++i)this.protoInterfaceElementChild(t[i])},protoInterfaceElementChild:function(e){switch(e.nodeName){case"field":case"FIELD":return void this.fieldElement(e)}},fieldElement:function(e){try{if(0===this.getParents().length)return;var t=this.getParent();if(!(t instanceof i))return;if(!t.hasUserDefinedFields())return;var n=m[e.getAttribute("accessType")];void 0===n&&(n=h.initializeOnly);var s=r[e.getAttribute("type")];if(void 0===s)return;var o=e.getAttribute("name");if(!this.id(o))return;var a=new s;n&h.initializeOnly&&(this.fieldValue(a,e.getAttribute("value")),this.pushParent(a),this.childrenElements(e),this.popParent()),t.addUserDefinedField(n,o,a)}catch(e){}},protoBodyElement:function(e){this.childrenElements(e)},isElement:function(e){if(this.getExecutionContext()instanceof l)for(var t=e.childNodes,i=0;i<t.length;++i)this.isElementChild(t[i])},isElementChild:function(e){switch(e.nodeName){case"connect":case"CONNECT":return void this.connectElement(e)}},connectElement:function(e){var t=e.getAttribute("nodeField"),n=e.getAttribute("protoField");if(null===t)return console.warn("XML Parser Error: Bad connect statement: Expected nodeField attribute.");if(null===n)return console.warn("XML Parser Error: Bad connect statement: Expected protoField attribute.");try{if(0===this.getParents().length)return;var r=this.getParent(),s=this.getExecutionContext();if(!(r instanceof i))return;var o=r.getField(t),a=s.getField(n);if(o.getType()!==a.getType())throw new Error("Field '"+o.getName()+"' and '"+a.getName()+"' in PROTO "+this.getExecutionContext().getName()+" have different types.");if(!a.isReference(o.getAccessType()))throw new Error("Field '"+o.getName()+"' and '"+a.getName()+"' in PROTO "+this.getExecutionContext().getName()+" are incompatible as an IS mapping.");o.addReference(a)}catch(e){console.warn("XML Parser Error: Couldn't create IS reference: "+e.message)}},protoInstanceElement:function(e){try{if(this.useAttribute(e))return;var t=e.getAttribute("name");if(this.id(t)){var i=this.getExecutionContext().createProto(t,!1);e.x3d=i,this.defAttribute(e,i),this.addNode(e,i),this.pushParent(i),this.childrenElements(e),this.getExecutionContext().addUninitializedNode(i),this.popParent()}}catch(e){console.warn("XML Parser Error: ",e.message)}},fieldValueElement:function(e){try{if(0===this.getParents().length)return;var t=this.getParent(),i=e.getAttribute("name");if(!(t instanceof n))return;if(!this.id(i))return;var r=t.getField(i);r.getAccessType()&h.initializeOnly&&(this.fieldValue(r,e.getAttribute("value")),this.pushParent(r),this.childrenElements(e),this.popParent())}catch(e){console.warn("XML Parser Error: Couldn't assign field value: "+e.message)}},nodeElement:function(e){try{if(this.useAttribute(e))return;var t=this.getExecutionContext().createNode(e.nodeName,!1);e.x3d=t,this.defAttribute(e,t),this.addNode(e,t),this.pushParent(t),this.nodeAttributes(e,t),this.childrenElements(e),this.getExecutionContext().addUninitializedNode(t),this.popParent()}catch(e){console.error("XML Parser Error: "+e.message)}},routeElement:function(e){try{var t=e.getAttribute("fromNode"),i=e.getAttribute("fromField"),n=e.getAttribute("toNode"),r=e.getAttribute("toField");if(null===t)throw new Error("Bad ROUTE statement: Expected fromNode attribute.");if(null===i)throw new Error("Bad ROUTE statement: Expected fromField attribute.");if(null===n)throw new Error("Bad ROUTE statement: Expected toNode attribute.");if(null===r)throw new Error("Bad ROUTE statement: Expected toField attribute.");var s=this.getExecutionContext(),o=s.getLocalNode(t),a=s.getLocalNode(n),u=s.addRoute(o,i,a,r);e.x3d=u}catch(e){console.warn("XML Parser Error: "+e.message)}},importElement:function(e){try{var t=e.getAttribute("inlineDEF"),i=e.getAttribute("importedDEF")||e.getAttribute("exportedDEF"),n=e.getAttribute("AS");if(null===t)throw new Error("Bad IMPORT statement: Expected inlineDEF attribute.");if(null===i)throw new Error("Bad IMPORT statement: Expected importedDEF attribute.");n||(n=i);var r=this.getExecutionContext().getNamedNode(t);this.getExecutionContext().updateImportedNode(r,i,n)}catch(e){console.warn("XML Parser Error: "+e.message)}},exportElement:function(e){try{if(this.getScene()!==this.getExecutionContext())return;var t=e.getAttribute("localDEF"),i=e.getAttribute("AS");if(null===t)throw new Error("Bad EXPORT statement: Expected localDEF attribute.");i||(i=t);var n=this.getExecutionContext().getLocalNode(t);this.getScene().updateExportedNode(i,n)}catch(e){console.warn("XML Parser Error: "+e.message)}},cdataNode:function(e){if(0!==this.getParents().length){var t=this.getParent();if(t instanceof i){var n=t.getSourceText();n&&(n.push(e.data),n.setSet(!0))}}},useAttribute:function(e){try{var t=e.getAttribute("USE");if(this.id(t)){var i=this.getExecutionContext().getNamedNode(t);return this.addNode(e,i.getValue()),!0}}catch(e){console.warn("Invalid USE name: "+e.message)}return!1},defAttribute:function(e,t){try{var i=e.getAttribute("DEF");if(i){try{var n=this.getExecutionContext().getNamedNode(i);this.getExecutionContext().updateNamedNode(this.getExecutionContext().getUniqueName(i),n)}catch(e){}this.getExecutionContext().updateNamedNode(i,t)}}catch(e){console.warn("Invalid DEF name: "+e.message)}},nodeAttributes:function(e,t){for(var i=e.attributes,n=0;n<i.length;++n)this.nodeAttribute(i[n],t)},nodeAttribute:function(e,t){try{var i=t.getField(this.attributeToCamelCase(e.name));i.getAccessType()&h.initializeOnly&&this.fieldValue(i,e.value)}catch(e){}},fieldValue:function(e,t){null!==t&&(e.setSet(!0),this.parser.pushExecutionContext(this.getExecutionContext()),this.parser.setInput(t),this.fieldTypes[e.getType()].call(this.parser,e),this.parser.popExecutionContext())},addNode:function(e,i){if(0===this.parents.length||this.getParent()instanceof l)return void this.getExecutionContext().rootNodes.push(i);var n=this.getParent();if(n instanceof t)switch(n.getType()){case h.SFNode:return n.setValue(i),void n.setSet(!0);case h.MFNode:return n.push(i),void n.setSet(!0)}else try{var r=e.getAttribute("containerField");r||(r=i.getContainerField());var s=n.getField(r);switch(s.getType()){case h.SFNode:return s.setValue(i),void s.setSet(!0);case h.MFNode:return s.push(i),void s.setSet(!0)}}catch(e){}},getParents:function(){return this.parents},getParent:function(){return this.parents[this.parents.length-1]},pushParent:function(e){return this.parents.push(e)},popParent:function(){this.parents.pop()},id:function(e){return null!==e&&0!==e.length},attributeToCamelCase:function(e){return e!==e.toLowerCase()?e:a.attributeLowerCaseToCamelCase[e]}}),c.prototype.fieldTypes=[],c.prototype.fieldTypes[h.SFBool]=s.prototype.sfboolValue,c.prototype.fieldTypes[h.SFColor]=s.prototype.sfcolorValue,c.prototype.fieldTypes[h.SFColorRGBA]=s.prototype.sfcolorrgbaValue,c.prototype.fieldTypes[h.SFDouble]=s.prototype.sfdoubleValue,c.prototype.fieldTypes[h.SFFloat]=s.prototype.sffloatValue,c.prototype.fieldTypes[h.SFImage]=s.prototype.sfimageValue,c.prototype.fieldTypes[h.SFInt32]=s.prototype.sfint32Value,c.prototype.fieldTypes[h.SFMatrix3f]=s.prototype.sfmatrix3dValue,c.prototype.fieldTypes[h.SFMatrix3d]=s.prototype.sfmatrix3fValue,c.prototype.fieldTypes[h.SFMatrix4f]=s.prototype.sfmatrix4dValue,c.prototype.fieldTypes[h.SFMatrix4d]=s.prototype.sfmatrix4fValue,c.prototype.fieldTypes[h.SFNode]=function(e){e.set(null)},c.prototype.fieldTypes[h.SFRotation]=s.prototype.sfrotationValue,c.prototype.fieldTypes[h.SFString]=function(e){e.set(this.input)},c.prototype.fieldTypes[h.SFTime]=s.prototype.sftimeValue,c.prototype.fieldTypes[h.SFVec2d]=s.prototype.sfvec2dValue,c.prototype.fieldTypes[h.SFVec2f]=s.prototype.sfvec2fValue,c.prototype.fieldTypes[h.SFVec3d]=s.prototype.sfvec3dValue,c.prototype.fieldTypes[h.SFVec3f]=s.prototype.sfvec3fValue,c.prototype.fieldTypes[h.SFVec4d]=s.prototype.sfvec4dValue,c.prototype.fieldTypes[h.SFVec4f]=s.prototype.sfvec4fValue,c.prototype.fieldTypes[h.MFBool]=s.prototype.sfboolValues,c.prototype.fieldTypes[h.MFColor]=s.prototype.sfcolorValues,c.prototype.fieldTypes[h.MFColorRGBA]=s.prototype.sfcolorrgbaValues,c.prototype.fieldTypes[h.MFDouble]=s.prototype.sfdoubleValues,c.prototype.fieldTypes[h.MFFloat]=s.prototype.sffloatValues,c.prototype.fieldTypes[h.MFImage]=s.prototype.sfimageValues,c.prototype.fieldTypes[h.MFInt32]=s.prototype.sfint32Values,c.prototype.fieldTypes[h.MFMatrix3d]=s.prototype.sfmatrix3dValues,c.prototype.fieldTypes[h.MFMatrix3f]=s.prototype.sfmatrix3fValues,c.prototype.fieldTypes[h.MFMatrix4d]=s.prototype.sfmatrix4dValues,c.prototype.fieldTypes[h.MFMatrix4f]=s.prototype.sfmatrix4fValues,c.prototype.fieldTypes[h.MFNode]=function(){},c.prototype.fieldTypes[h.MFRotation]=s.prototype.sfrotationValues,c.prototype.fieldTypes[h.MFString]=s.prototype.sfstringValues,c.prototype.fieldTypes[h.MFTime]=s.prototype.sftimeValues,c.prototype.fieldTypes[h.MFVec2d]=s.prototype.sfvec2dValues,c.prototype.fieldTypes[h.MFVec2f]=s.prototype.sfvec2fValues,c.prototype.fieldTypes[h.MFVec3d]=s.prototype.sfvec3dValues,c.prototype.fieldTypes[h.MFVec3f]=s.prototype.sfvec3fValues,c.prototype.fieldTypes[h.MFVec4d]=s.prototype.sfvec4dValues,c.prototype.fieldTypes[h.MFVec4f]=s.prototype.sfvec4fValues;var _=/\binf\b/g,x=/\bnan\b/g,y=/^[\x20\n,\t\r"]+|[\x20\n,\t\r"]+$/g,v=/[\x20\n,\t\r"]+/,w=new RegExp('"((?:[^\\\\"]|\\\\\\\\|\\\\\\")*)"',"g");return c.prototype.fieldTypes[h.MFColor]=c.prototype.fieldTypes[h.MFColorRGBA]=c.prototype.fieldTypes[h.MFMatrix3d]=c.prototype.fieldTypes[h.MFMatrix3f]=c.prototype.fieldTypes[h.MFMatrix4d]=c.prototype.fieldTypes[h.MFMatrix4f]=c.prototype.fieldTypes[h.MFVec4d]=c.prototype.fieldTypes[h.MFVec4f]=function(e){e.setValue(p(this.getInput()).map(function(e){return parseFloat(e)}))},c.prototype.fieldTypes[h.MFBool]=function(e){e.setValue(d(this.getInput()).map(function(e){return"true"===e||"TRUE"===e}))},c.prototype.fieldTypes[h.MFInt32]=function(e){e.setValue(f(this.getInput()).map(function(e){return parseInt(e)}))},c.prototype.fieldTypes[h.MFDouble]=c.prototype.fieldTypes[h.MFFloat]=c.prototype.fieldTypes[h.MFVec2d]=c.prototype.fieldTypes[h.MFVec2f]=c.prototype.fieldTypes[h.MFVec3d]=c.prototype.fieldTypes[h.MFVec3f]=function(e){var t=e.getUnit();e.setValue(p(this.getInput()).map(function(e){return this.fromUnit(t,parseFloat(e))},this))},c.prototype.fieldTypes[h.MFString]=function(e){e.setValue(g(this.getInput()))},c}),define("x_ite/Parser/JSONParser",["x_ite/Fields","x_ite/Parser/Parser","x_ite/Parser/XMLParser"],function(e,t,i){"use strict";function n(i){this.scene=i,this.executionContexts=[i],this.protoDeclarations=[],this.parents=[],this.parser=new t(this.scene),this.url=new e.MFString,this.x3djsonNS="http://www.web3d.org/specifications/x3d-namespace"}return n.prototype=Object.create(i.prototype),n.prototype.constructor=n,n.prototype.parseJavaScript=function(e){var t=this.CreateElement("X3D");return this.ConvertToX3DOM(e,"",t),this.parseIntoScene(t),t},n.prototype.elementSetAttribute=function(e,t,i){"SON schema"===t||"ncoding"===t||"function"==typeof e.setAttribute&&e.setAttribute(t,i)},n.prototype.ConvertChildren=function(e,t,i){var n;for(n in t)"object"==typeof t[n]&&(isNaN(parseInt(n))?this.ConvertObject(n,t,i,e.substr(1)):this.ConvertToX3DOM(t[n],n,i,e.substr(1)))},n.prototype.CreateElement=function(e,t){var i=null;return void 0===this.x3djsonNS?i=document.createElement(e):null!==(i=document.createElementNS(this.x3djsonNS,e))&&void 0!==i||(console.error("Trouble creating element for",e),i=document.createElement(e)),void 0!==t&&this.elementSetAttribute(i,"containerField",t),i},n.prototype.CDATACreateFunction=function(e,t,i){var n=i.trim().replace(/\\"/g,'\\"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&");do i=n,n=i.replace(/'([^'\r\n]*)\n([^']*)'/g,"'$1\\n$2'"),i!==n&&console.log("CDATA Replacing",i,"with",n);while(n!=i)var r=new DOMParser,s="<script> <![CDATA[ "+n+" ]]> </script>",o=r.parseFromString(s,"application/xml"),a=o.children[0].childNodes[1];t.appendChild(a)},n.prototype.ConvertObject=function(e,t,i,n){var r;if(null!==t&&"object"==typeof t[e])if("@"===e.substr(0,1))this.ConvertToX3DOM(t[e],e,i);else if("-"===e.substr(0,1))this.ConvertChildren(e,t[e],i);else if("#comment"===e)for(var s in t[e])r=document.createComment(this.CommentStringToXML(t[e][s])),i.appendChild(r);else if("#sourceText"===e)this.CDATACreateFunction(document,i,t[e].join("\r\n")+"\r\n");else if("connect"===e||"fieldValue"===e||"field"===e||"meta"===e||"component"===e)for(var o in t[e])"object"==typeof t[e][o]&&(r=this.CreateElement(e,n),this.ConvertToX3DOM(t[e][o],o,r),i.appendChild(r),i.appendChild(document.createTextNode("\n")));else r=this.CreateElement(e,n),this.ConvertToX3DOM(t[e],e,r),i.appendChild(r),i.appendChild(document.createTextNode("\n"))},n.prototype.CommentStringToXML=function(e){var t=e;return e=e.replace(/\\\\/g,"\\"),t!==e&&console.log("X3DJSONLD <!-> replacing",t,"with",e),e},n.prototype.SFStringToXML=function(e){var t=e;return e=e.replace(/\\/g,"\\\\"),e=e.replace(/"/g,'\\"'),t!==e&&console.log("X3DJSONLD [] replacing",t,"with",e),e},n.prototype.JSONStringToXML=function(e){var t=e;return e=e.replace(/\\/g,"\\\\"),e=e.replace(/\n/g,"\\n"),t!==e&&console.log("X3DJSONLD replacing",t,"with",e),e},n.prototype.ConvertToX3DOM=function(e,t,i,n){var r,s=[],o=!1,a=!1;for(r in e)if(o=!isNaN(parseInt(r)))"number"==typeof e[r]?s.push(e[r]):"string"==typeof e[r]?(s.push(e[r]),a=!0):"boolean"==typeof e[r]?s.push(e[r]):"object"==typeof e[r]?this.ConvertToX3DOM(e[r],r,i):void 0===e[r]||console.error("Unknown type found in array "+typeof e[r]);else if("object"==typeof e[r])"X3D"===r?this.ConvertToX3DOM(e[r],r,i):this.ConvertObject(r,e,i);else if("number"==typeof e[r])this.elementSetAttribute(i,r.substr(1),e[r]);else if("string"==typeof e[r])if("#comment"!==r)this.elementSetAttribute(i,r.substr(1),this.JSONStringToXML(e[r]));else{var u=document.createComment(this.CommentStringToXML(e[r]));i.appendChild(u)}else"boolean"==typeof e[r]?this.elementSetAttribute(i,r.substr(1),e[r]):void 0===e[r]||(console.error("Unknown type found in object "+typeof e[r]),console.error(e));if(o){if("@"===t.substr(0,1))if(a){a=!1;for(var l in s)s[l]=this.SFStringToXML(s[l]);this.elementSetAttribute(i,t.substr(1),'"'+s.join('" "')+'"')}else this.elementSetAttribute(i,t.substr(1),s.join(" "));o=!1}return i},n}),define("standard/Networking/BinaryTransport",[],function(){"use strict";return function(e){e.ajaxTransport("+binary",function(e,t,i){if(e.dataType&&"binary"==e.dataType)return{send:function(t,i){var n=e.xhr();if(n.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(var r in e.xhrFields)n[r]=e.xhrFields[r];e.mimeType&&n.overrideMimeType&&n.overrideMimeType(e.mimeType);for(var r in t)n.setRequestHeader(r,t[r]);n.onload=function(){n.onload=n.onerror=null;var t={};t[e.dataType]=n.response,i(n.status,n.statusText,t,n.getAllResponseHeaders())},n.onerror=function(){n.onload=n.onerror=null,i(n.status||404,n.statusText)},n.responseType=e.responseType||"blob",n.send(e.hasContent&&e.data||null)},abort:function(){var t=e.xhr();t.onload=t.onerror=null,t.abort()}}})}}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("pako_inflate/dist/pako_inflate",[],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.pako=e()}}(function(){return function e(t,i,n){function r(o,a){if(!i[o]){if(!t[o]){var u="function"==typeof require&&require;if(!a&&u)return u(o,!0);if(s)return s(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var h=i[o]={exports:{}};t[o][0].call(h.exports,function(e){var i=t[o][1][e];return r(i?i:e)},h,h.exports,e,t,i,n)}return i[o].exports}for(var s="function"==typeof require&&require,o=0;o<n.length;o++)r(n[o]);return r}({1:[function(e,t,i){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;i.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var i=t.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var r in i)n(i,r)&&(e[r]=i[r])}}return e},i.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var s={arraySet:function(e,t,i,n,r){if(t.subarray&&e.subarray)return void e.set(t.subarray(i,i+n),r);for(var s=0;s<n;s++)e[r+s]=t[i+s]},flattenChunks:function(e){var t,i,n,r,s,o;for(n=0,t=0,i=e.length;t<i;t++)n+=e[t].length;for(o=new Uint8Array(n),r=0,t=0,i=e.length;t<i;t++)s=e[t],o.set(s,r),r+=s.length;return o}},o={arraySet:function(e,t,i,n,r){for(var s=0;s<n;s++)e[r+s]=t[i+s]},flattenChunks:function(e){return[].concat.apply([],e)}};i.setTyped=function(e){e?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,s)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,o))},i.setTyped(r)},{}],2:[function(e,t,i){function n(e,t){if(t<65537&&(e.subarray&&o||!e.subarray&&s))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var i="",n=0;n<t;n++)i+=String.fromCharCode(e[n]);return i}var r=e("./common"),s=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(e){s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){o=!1}for(var a=new r.Buf8(256),u=0;u<256;u++)a[u]=u>=252?6:u>=248?5:u>=240?4:u>=224?3:u>=192?2:1;a[254]=a[254]=1,i.string2buf=function(e){var t,i,n,s,o,a=e.length,u=0;for(s=0;s<a;s++)i=e.charCodeAt(s),55296==(64512&i)&&s+1<a&&56320==(64512&(n=e.charCodeAt(s+1)))&&(i=65536+(i-55296<<10)+(n-56320),s++),u+=i<128?1:i<2048?2:i<65536?3:4;for(t=new r.Buf8(u),o=0,s=0;o<u;s++)i=e.charCodeAt(s),55296==(64512&i)&&s+1<a&&56320==(64512&(n=e.charCodeAt(s+1)))&&(i=65536+(i-55296<<10)+(n-56320),s++),i<128?t[o++]=i:i<2048?(t[o++]=192|i>>>6,t[o++]=128|63&i):i<65536?(t[o++]=224|i>>>12,t[o++]=128|i>>>6&63,t[o++]=128|63&i):(t[o++]=240|i>>>18,t[o++]=128|i>>>12&63,t[o++]=128|i>>>6&63,t[o++]=128|63&i);return t},i.buf2binstring=function(e){return n(e,e.length)},i.binstring2buf=function(e){for(var t=new r.Buf8(e.length),i=0,n=t.length;i<n;i++)t[i]=e.charCodeAt(i);return t},i.buf2string=function(e,t){var i,r,s,o,u=t||e.length,l=new Array(2*u);for(r=0,i=0;i<u;)if((s=e[i++])<128)l[r++]=s;else if((o=a[s])>4)l[r++]=65533,i+=o-1;else{for(s&=2===o?31:3===o?15:7;o>1&&i<u;)s=s<<6|63&e[i++],o--;o>1?l[r++]=65533:s<65536?l[r++]=s:(s-=65536,l[r++]=55296|s>>10&1023,l[r++]=56320|1023&s)}return n(l,r)},i.utf8border=function(e,t){var i;for(t=t||e.length,t>e.length&&(t=e.length),i=t-1;i>=0&&128==(192&e[i]);)i--;return i<0?t:0===i?t:i+a[e[i]]>t?i:t}},{"./common":1}],3:[function(e,t,i){"use strict";function n(e,t,i,n){for(var r=65535&e|0,s=e>>>16&65535|0,o=0;0!==i;){o=i>2e3?2e3:i,i-=o;do r=r+t[n++]|0,s=s+r|0;while(--o)r%=65521,s%=65521}return r|s<<16|0}t.exports=n},{}],4:[function(e,t,i){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],5:[function(e,t,i){"use strict";function n(e,t,i,n){var s=r,o=n+i;e^=-1;for(var a=n;a<o;a++)e=e>>>8^s[255&(e^t[a])];return e^-1}var r=function(){for(var e,t=[],i=0;i<256;i++){e=i;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t}();t.exports=n},{}],6:[function(e,t,i){"use strict";function n(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}t.exports=n},{}],7:[function(e,t,i){"use strict";t.exports=function(e,t){var i,n,r,s,o,a,u,l,h,c,d,p,f,g,m,_,x,y,v,w,b,S,C,T,F;i=e.state,n=e.next_in,T=e.input,r=n+(e.avail_in-5),s=e.next_out,F=e.output,o=s-(t-e.avail_out),a=s+(e.avail_out-257),u=i.dmax,l=i.wsize,h=i.whave,c=i.wnext,d=i.window,p=i.hold,f=i.bits,g=i.lencode,m=i.distcode,_=(1<<i.lenbits)-1,x=(1<<i.distbits)-1;e:do{f<15&&(p+=T[n++]<<f,f+=8,p+=T[n++]<<f,f+=8),y=g[p&_];t:for(;;){if(v=y>>>24,p>>>=v,f-=v,0===(v=y>>>16&255))F[s++]=65535&y;else{if(!(16&v)){if(0==(64&v)){y=g[(65535&y)+(p&(1<<v)-1)];continue t}if(32&v){i.mode=12;break e}e.msg="invalid literal/length code",i.mode=30;break e}w=65535&y,v&=15,v&&(f<v&&(p+=T[n++]<<f,f+=8),w+=p&(1<<v)-1,p>>>=v,f-=v),f<15&&(p+=T[n++]<<f,f+=8,p+=T[n++]<<f,f+=8),y=m[p&x];i:for(;;){if(v=y>>>24,p>>>=v,f-=v,!(16&(v=y>>>16&255))){if(0==(64&v)){y=m[(65535&y)+(p&(1<<v)-1)];continue i}e.msg="invalid distance code",i.mode=30;break e}if(b=65535&y,v&=15,f<v&&(p+=T[n++]<<f,(f+=8)<v&&(p+=T[n++]<<f,f+=8)),(b+=p&(1<<v)-1)>u){e.msg="invalid distance too far back",i.mode=30;break e}if(p>>>=v,f-=v,v=s-o,b>v){if((v=b-v)>h&&i.sane){e.msg="invalid distance too far back",i.mode=30;break e}if(S=0,C=d,0===c){if(S+=l-v,v<w){w-=v;do F[s++]=d[S++];while(--v)S=s-b,C=F}}else if(c<v){if(S+=l+c-v,
(v-=c)<w){w-=v;do F[s++]=d[S++];while(--v)if(S=0,c<w){v=c,w-=v;do F[s++]=d[S++];while(--v)S=s-b,C=F}}}else if(S+=c-v,v<w){w-=v;do F[s++]=d[S++];while(--v)S=s-b,C=F}for(;w>2;)F[s++]=C[S++],F[s++]=C[S++],F[s++]=C[S++],w-=3;w&&(F[s++]=C[S++],w>1&&(F[s++]=C[S++]))}else{S=s-b;do F[s++]=F[S++],F[s++]=F[S++],F[s++]=F[S++],w-=3;while(w>2)w&&(F[s++]=F[S++],w>1&&(F[s++]=F[S++]))}break}}break}}while(n<r&&s<a)w=f>>3,n-=w,f-=w<<3,p&=(1<<f)-1,e.next_in=n,e.next_out=s,e.avail_in=n<r?r-n+5:5-(n-r),e.avail_out=s<a?a-s+257:257-(s-a),i.hold=p,i.bits=f}},{}],8:[function(e,t,i){"use strict";function n(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function r(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new x.Buf16(320),this.work=new x.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function s(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=R,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new x.Buf32(ge),t.distcode=t.distdyn=new x.Buf32(me),t.sane=1,t.back=-1,M):V}function o(e){var t;return e&&e.state?(t=e.state,t.wsize=0,t.whave=0,t.wnext=0,s(e)):V}function a(e,t){var i,n;return e&&e.state?(n=e.state,t<0?(i=0,t=-t):(i=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?V:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=i,n.wbits=t,o(e))):V}function u(e,t){var i,n;return e?(n=new r,e.state=n,n.window=null,i=a(e,t),i!==M&&(e.state=null),i):V}function l(e){return u(e,_e)}function h(e){if(xe){var t;for(m=new x.Buf32(512),_=new x.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(b(C,e.lens,0,288,m,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;b(T,e.lens,0,32,_,0,e.work,{bits:5}),xe=!1}e.lencode=m,e.lenbits=9,e.distcode=_,e.distbits=5}function c(e,t,i,n){var r,s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new x.Buf8(s.wsize)),n>=s.wsize?(x.arraySet(s.window,t,i-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):(r=s.wsize-s.wnext,r>n&&(r=n),x.arraySet(s.window,t,i-n,r,s.wnext),n-=r,n?(x.arraySet(s.window,t,i-n,n,0),s.wnext=n,s.whave=s.wsize):(s.wnext+=r,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=r))),0}function d(e,t){var i,r,s,o,a,u,l,d,p,f,g,m,_,ge,me,_e,xe,ye,ve,we,be,Se,Ce,Te,Fe=0,Oe=new x.Buf8(4),Ne=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return V;i=e.state,i.mode===Y&&(i.mode=$),a=e.next_out,s=e.output,l=e.avail_out,o=e.next_in,r=e.input,u=e.avail_in,d=i.hold,p=i.bits,f=u,g=l,Se=M;e:for(;;)switch(i.mode){case R:if(0===i.wrap){i.mode=$;break}for(;p<16;){if(0===u)break e;u--,d+=r[o++]<<p,p+=8}if(2&i.wrap&&35615===d){i.check=0,Oe[0]=255&d,Oe[1]=d>>>8&255,i.check=v(i.check,Oe,2,0),d=0,p=0,i.mode=L;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&d)<<8)+(d>>8))%31){e.msg="incorrect header check",i.mode=de;break}if((15&d)!==P){e.msg="unknown compression method",i.mode=de;break}if(d>>>=4,p-=4,be=8+(15&d),0===i.wbits)i.wbits=be;else if(be>i.wbits){e.msg="invalid window size",i.mode=de;break}i.dmax=1<<be,e.adler=i.check=1,i.mode=512&d?H:Y,d=0,p=0;break;case L:for(;p<16;){if(0===u)break e;u--,d+=r[o++]<<p,p+=8}if(i.flags=d,(255&i.flags)!==P){e.msg="unknown compression method",i.mode=de;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=de;break}i.head&&(i.head.text=d>>8&1),512&i.flags&&(Oe[0]=255&d,Oe[1]=d>>>8&255,i.check=v(i.check,Oe,2,0)),d=0,p=0,i.mode=z;case z:for(;p<32;){if(0===u)break e;u--,d+=r[o++]<<p,p+=8}i.head&&(i.head.time=d),512&i.flags&&(Oe[0]=255&d,Oe[1]=d>>>8&255,Oe[2]=d>>>16&255,Oe[3]=d>>>24&255,i.check=v(i.check,Oe,4,0)),d=0,p=0,i.mode=k;case k:for(;p<16;){if(0===u)break e;u--,d+=r[o++]<<p,p+=8}i.head&&(i.head.xflags=255&d,i.head.os=d>>8),512&i.flags&&(Oe[0]=255&d,Oe[1]=d>>>8&255,i.check=v(i.check,Oe,2,0)),d=0,p=0,i.mode=X;case X:if(1024&i.flags){for(;p<16;){if(0===u)break e;u--,d+=r[o++]<<p,p+=8}i.length=d,i.head&&(i.head.extra_len=d),512&i.flags&&(Oe[0]=255&d,Oe[1]=d>>>8&255,i.check=v(i.check,Oe,2,0)),d=0,p=0}else i.head&&(i.head.extra=null);i.mode=U;case U:if(1024&i.flags&&(m=i.length,m>u&&(m=u),m&&(i.head&&(be=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),x.arraySet(i.head.extra,r,o,m,be)),512&i.flags&&(i.check=v(i.check,r,m,o)),u-=m,o+=m,i.length-=m),i.length))break e;i.length=0,i.mode=j;case j:if(2048&i.flags){if(0===u)break e;m=0;do be=r[o+m++],i.head&&be&&i.length<65536&&(i.head.name+=String.fromCharCode(be));while(be&&m<u)if(512&i.flags&&(i.check=v(i.check,r,m,o)),u-=m,o+=m,be)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=G;case G:if(4096&i.flags){if(0===u)break e;m=0;do be=r[o+m++],i.head&&be&&i.length<65536&&(i.head.comment+=String.fromCharCode(be));while(be&&m<u)if(512&i.flags&&(i.check=v(i.check,r,m,o)),u-=m,o+=m,be)break e}else i.head&&(i.head.comment=null);i.mode=q;case q:if(512&i.flags){for(;p<16;){if(0===u)break e;u--,d+=r[o++]<<p,p+=8}if(d!==(65535&i.check)){e.msg="header crc mismatch",i.mode=de;break}d=0,p=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=Y;break;case H:for(;p<32;){if(0===u)break e;u--,d+=r[o++]<<p,p+=8}e.adler=i.check=n(d),d=0,p=0,i.mode=W;case W:if(0===i.havedict)return e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=u,i.hold=d,i.bits=p,E;e.adler=i.check=1,i.mode=Y;case Y:if(t===O||t===N)break e;case $:if(i.last){d>>>=7&p,p-=7&p,i.mode=le;break}for(;p<3;){if(0===u)break e;u--,d+=r[o++]<<p,p+=8}switch(i.last=1&d,d>>>=1,p-=1,3&d){case 0:i.mode=K;break;case 1:if(h(i),i.mode=ie,t===N){d>>>=2,p-=2;break e}break;case 2:i.mode=J;break;case 3:e.msg="invalid block type",i.mode=de}d>>>=2,p-=2;break;case K:for(d>>>=7&p,p-=7&p;p<32;){if(0===u)break e;u--,d+=r[o++]<<p,p+=8}if((65535&d)!=(d>>>16^65535)){e.msg="invalid stored block lengths",i.mode=de;break}if(i.length=65535&d,d=0,p=0,i.mode=Q,t===N)break e;case Q:i.mode=Z;case Z:if(m=i.length){if(m>u&&(m=u),m>l&&(m=l),0===m)break e;x.arraySet(s,r,o,m,a),u-=m,o+=m,l-=m,a+=m,i.length-=m;break}i.mode=Y;break;case J:for(;p<14;){if(0===u)break e;u--,d+=r[o++]<<p,p+=8}if(i.nlen=257+(31&d),d>>>=5,p-=5,i.ndist=1+(31&d),d>>>=5,p-=5,i.ncode=4+(15&d),d>>>=4,p-=4,i.nlen>286||i.ndist>30){e.msg="too many length or distance symbols",i.mode=de;break}i.have=0,i.mode=ee;case ee:for(;i.have<i.ncode;){for(;p<3;){if(0===u)break e;u--,d+=r[o++]<<p,p+=8}i.lens[Ne[i.have++]]=7&d,d>>>=3,p-=3}for(;i.have<19;)i.lens[Ne[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,Ce={bits:i.lenbits},Se=b(S,i.lens,0,19,i.lencode,0,i.work,Ce),i.lenbits=Ce.bits,Se){e.msg="invalid code lengths set",i.mode=de;break}i.have=0,i.mode=te;case te:for(;i.have<i.nlen+i.ndist;){for(;Fe=i.lencode[d&(1<<i.lenbits)-1],me=Fe>>>24,_e=Fe>>>16&255,xe=65535&Fe,!(me<=p);){if(0===u)break e;u--,d+=r[o++]<<p,p+=8}if(xe<16)d>>>=me,p-=me,i.lens[i.have++]=xe;else{if(16===xe){for(Te=me+2;p<Te;){if(0===u)break e;u--,d+=r[o++]<<p,p+=8}if(d>>>=me,p-=me,0===i.have){e.msg="invalid bit length repeat",i.mode=de;break}be=i.lens[i.have-1],m=3+(3&d),d>>>=2,p-=2}else if(17===xe){for(Te=me+3;p<Te;){if(0===u)break e;u--,d+=r[o++]<<p,p+=8}d>>>=me,p-=me,be=0,m=3+(7&d),d>>>=3,p-=3}else{for(Te=me+7;p<Te;){if(0===u)break e;u--,d+=r[o++]<<p,p+=8}d>>>=me,p-=me,be=0,m=11+(127&d),d>>>=7,p-=7}if(i.have+m>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=de;break}for(;m--;)i.lens[i.have++]=be}}if(i.mode===de)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=de;break}if(i.lenbits=9,Ce={bits:i.lenbits},Se=b(C,i.lens,0,i.nlen,i.lencode,0,i.work,Ce),i.lenbits=Ce.bits,Se){e.msg="invalid literal/lengths set",i.mode=de;break}if(i.distbits=6,i.distcode=i.distdyn,Ce={bits:i.distbits},Se=b(T,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,Ce),i.distbits=Ce.bits,Se){e.msg="invalid distances set",i.mode=de;break}if(i.mode=ie,t===N)break e;case ie:i.mode=ne;case ne:if(u>=6&&l>=258){e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=u,i.hold=d,i.bits=p,w(e,g),a=e.next_out,s=e.output,l=e.avail_out,o=e.next_in,r=e.input,u=e.avail_in,d=i.hold,p=i.bits,i.mode===Y&&(i.back=-1);break}for(i.back=0;Fe=i.lencode[d&(1<<i.lenbits)-1],me=Fe>>>24,_e=Fe>>>16&255,xe=65535&Fe,!(me<=p);){if(0===u)break e;u--,d+=r[o++]<<p,p+=8}if(_e&&0==(240&_e)){for(ye=me,ve=_e,we=xe;Fe=i.lencode[we+((d&(1<<ye+ve)-1)>>ye)],me=Fe>>>24,_e=Fe>>>16&255,xe=65535&Fe,!(ye+me<=p);){if(0===u)break e;u--,d+=r[o++]<<p,p+=8}d>>>=ye,p-=ye,i.back+=ye}if(d>>>=me,p-=me,i.back+=me,i.length=xe,0===_e){i.mode=ue;break}if(32&_e){i.back=-1,i.mode=Y;break}if(64&_e){e.msg="invalid literal/length code",i.mode=de;break}i.extra=15&_e,i.mode=re;case re:if(i.extra){for(Te=i.extra;p<Te;){if(0===u)break e;u--,d+=r[o++]<<p,p+=8}i.length+=d&(1<<i.extra)-1,d>>>=i.extra,p-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=se;case se:for(;Fe=i.distcode[d&(1<<i.distbits)-1],me=Fe>>>24,_e=Fe>>>16&255,xe=65535&Fe,!(me<=p);){if(0===u)break e;u--,d+=r[o++]<<p,p+=8}if(0==(240&_e)){for(ye=me,ve=_e,we=xe;Fe=i.distcode[we+((d&(1<<ye+ve)-1)>>ye)],me=Fe>>>24,_e=Fe>>>16&255,xe=65535&Fe,!(ye+me<=p);){if(0===u)break e;u--,d+=r[o++]<<p,p+=8}d>>>=ye,p-=ye,i.back+=ye}if(d>>>=me,p-=me,i.back+=me,64&_e){e.msg="invalid distance code",i.mode=de;break}i.offset=xe,i.extra=15&_e,i.mode=oe;case oe:if(i.extra){for(Te=i.extra;p<Te;){if(0===u)break e;u--,d+=r[o++]<<p,p+=8}i.offset+=d&(1<<i.extra)-1,d>>>=i.extra,p-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=de;break}i.mode=ae;case ae:if(0===l)break e;if(m=g-l,i.offset>m){if((m=i.offset-m)>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=de;break}m>i.wnext?(m-=i.wnext,_=i.wsize-m):_=i.wnext-m,m>i.length&&(m=i.length),ge=i.window}else ge=s,_=a-i.offset,m=i.length;m>l&&(m=l),l-=m,i.length-=m;do s[a++]=ge[_++];while(--m)0===i.length&&(i.mode=ne);break;case ue:if(0===l)break e;s[a++]=i.length,l--,i.mode=ne;break;case le:if(i.wrap){for(;p<32;){if(0===u)break e;u--,d|=r[o++]<<p,p+=8}if(g-=l,e.total_out+=g,i.total+=g,g&&(e.adler=i.check=i.flags?v(i.check,s,g,a-g):y(i.check,s,g,a-g)),g=l,(i.flags?d:n(d))!==i.check){e.msg="incorrect data check",i.mode=de;break}d=0,p=0}i.mode=he;case he:if(i.wrap&&i.flags){for(;p<32;){if(0===u)break e;u--,d+=r[o++]<<p,p+=8}if(d!==(4294967295&i.total)){e.msg="incorrect length check",i.mode=de;break}d=0,p=0}i.mode=ce;case ce:Se=D;break e;case de:Se=B;break e;case pe:return I;case fe:default:return V}return e.next_out=a,e.avail_out=l,e.next_in=o,e.avail_in=u,i.hold=d,i.bits=p,(i.wsize||g!==e.avail_out&&i.mode<de&&(i.mode<le||t!==F))&&c(e,e.output,e.next_out,g-e.avail_out)?(i.mode=pe,I):(f-=e.avail_in,g-=e.avail_out,e.total_in+=f,e.total_out+=g,i.total+=g,i.wrap&&g&&(e.adler=i.check=i.flags?v(i.check,s,g,e.next_out-g):y(i.check,s,g,e.next_out-g)),e.data_type=i.bits+(i.last?64:0)+(i.mode===Y?128:0)+(i.mode===ie||i.mode===Q?256:0),(0===f&&0===g||t===F)&&Se===M&&(Se=A),Se)}function p(e){if(!e||!e.state)return V;var t=e.state;return t.window&&(t.window=null),e.state=null,M}function f(e,t){var i;return e&&e.state?(i=e.state,0==(2&i.wrap)?V:(i.head=t,t.done=!1,M)):V}function g(e,t){var i,n,r=t.length;return e&&e.state?(i=e.state,0!==i.wrap&&i.mode!==W?V:i.mode===W&&(n=1,(n=y(n,t,r,0))!==i.check)?B:c(e,t,r,r)?(i.mode=pe,I):(i.havedict=1,M)):V}var m,_,x=e("../utils/common"),y=e("./adler32"),v=e("./crc32"),w=e("./inffast"),b=e("./inftrees"),S=0,C=1,T=2,F=4,O=5,N=6,M=0,D=1,E=2,V=-2,B=-3,I=-4,A=-5,P=8,R=1,L=2,z=3,k=4,X=5,U=6,j=7,G=8,q=9,H=10,W=11,Y=12,$=13,K=14,Q=15,Z=16,J=17,ee=18,te=19,ie=20,ne=21,re=22,se=23,oe=24,ae=25,ue=26,le=27,he=28,ce=29,de=30,pe=31,fe=32,ge=852,me=592,_e=15,xe=!0;i.inflateReset=o,i.inflateReset2=a,i.inflateResetKeep=s,i.inflateInit=l,i.inflateInit2=u,i.inflate=d,i.inflateEnd=p,i.inflateGetHeader=f,i.inflateSetDictionary=g,i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":1,"./adler32":3,"./crc32":5,"./inffast":7,"./inftrees":9}],9:[function(e,t,i){"use strict";var n=e("../utils/common"),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,i,u,l,h,c,d){var p,f,g,m,_,x,y,v,w,b=d.bits,S=0,C=0,T=0,F=0,O=0,N=0,M=0,D=0,E=0,V=0,B=null,I=0,A=new n.Buf16(16),P=new n.Buf16(16),R=null,L=0;for(S=0;S<=15;S++)A[S]=0;for(C=0;C<u;C++)A[t[i+C]]++;for(O=b,F=15;F>=1&&0===A[F];F--);if(O>F&&(O=F),0===F)return l[h++]=20971520,l[h++]=20971520,d.bits=1,0;for(T=1;T<F&&0===A[T];T++);for(O<T&&(O=T),D=1,S=1;S<=15;S++)if(D<<=1,(D-=A[S])<0)return-1;if(D>0&&(0===e||1!==F))return-1;for(P[1]=0,S=1;S<15;S++)P[S+1]=P[S]+A[S];for(C=0;C<u;C++)0!==t[i+C]&&(c[P[t[i+C]]++]=C);if(0===e?(B=R=c,x=19):1===e?(B=r,I-=257,R=s,L-=257,x=256):(B=o,R=a,x=-1),V=0,C=0,S=T,_=h,N=O,M=0,g=-1,E=1<<O,m=E-1,1===e&&E>852||2===e&&E>592)return 1;for(;;){y=S-M,c[C]<x?(v=0,w=c[C]):c[C]>x?(v=R[L+c[C]],w=B[I+c[C]]):(v=96,w=0),p=1<<S-M,f=1<<N,T=f;do f-=p,l[_+(V>>M)+f]=y<<24|v<<16|w|0;while(0!==f)for(p=1<<S-1;V&p;)p>>=1;if(0!==p?(V&=p-1,V+=p):V=0,C++,0==--A[S]){if(S===F)break;S=t[i+c[C]]}if(S>O&&(V&m)!==g){for(0===M&&(M=O),_+=T,N=S-M,D=1<<N;N+M<F&&!((D-=A[N+M])<=0);)N++,D<<=1;if(E+=1<<N,1===e&&E>852||2===e&&E>592)return 1;g=V&m,l[g]=O<<24|N<<16|_-h|0}}return 0!==V&&(l[_+V]=S-M<<24|64<<16|0),d.bits=O,0}},{"../utils/common":1}],10:[function(e,t,i){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],11:[function(e,t,i){"use strict";function n(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}t.exports=n},{}],"/lib/inflate.js":[function(e,t,i){"use strict";function n(e){if(!(this instanceof n))return new n(e);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var i=o.inflateInit2(this.strm,t.windowBits);if(i!==l.Z_OK)throw new Error(h[i]);this.header=new d,o.inflateGetHeader(this.strm,this.header)}function r(e,t){var i=new n(t);if(i.push(e,!0),i.err)throw i.msg||h[i.err];return i.result}function s(e,t){return t=t||{},t.raw=!0,r(e,t)}var o=e("./zlib/inflate"),a=e("./utils/common"),u=e("./utils/strings"),l=e("./zlib/constants"),h=e("./zlib/messages"),c=e("./zlib/zstream"),d=e("./zlib/gzheader"),p=Object.prototype.toString;n.prototype.push=function(e,t){var i,n,r,s,h,c,d=this.strm,f=this.options.chunkSize,g=this.options.dictionary,m=!1;if(this.ended)return!1;n=t===~~t?t:t===!0?l.Z_FINISH:l.Z_NO_FLUSH,"string"==typeof e?d.input=u.binstring2buf(e):"[object ArrayBuffer]"===p.call(e)?d.input=new Uint8Array(e):d.input=e,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new a.Buf8(f),d.next_out=0,d.avail_out=f),i=o.inflate(d,l.Z_NO_FLUSH),i===l.Z_NEED_DICT&&g&&(c="string"==typeof g?u.string2buf(g):"[object ArrayBuffer]"===p.call(g)?new Uint8Array(g):g,i=o.inflateSetDictionary(this.strm,c)),i===l.Z_BUF_ERROR&&m===!0&&(i=l.Z_OK,m=!1),i!==l.Z_STREAM_END&&i!==l.Z_OK)return this.onEnd(i),this.ended=!0,!1;d.next_out&&(0!==d.avail_out&&i!==l.Z_STREAM_END&&(0!==d.avail_in||n!==l.Z_FINISH&&n!==l.Z_SYNC_FLUSH)||("string"===this.options.to?(r=u.utf8border(d.output,d.next_out),s=d.next_out-r,h=u.buf2string(d.output,r),d.next_out=s,d.avail_out=f-s,s&&a.arraySet(d.output,d.output,r,s,0),this.onData(h)):this.onData(a.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(m=!0)}while((d.avail_in>0||0===d.avail_out)&&i!==l.Z_STREAM_END)return i===l.Z_STREAM_END&&(n=l.Z_FINISH),n===l.Z_FINISH?(i=o.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===l.Z_OK):n!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),d.avail_out=0,!0)},n.prototype.onData=function(e){this.chunks.push(e)},n.prototype.onEnd=function(e){e===l.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},i.Inflate=n,i.inflate=r,i.inflateRaw=s,i.ungzip=r},{"./utils/common":1,"./utils/strings":2,"./zlib/constants":4,"./zlib/gzheader":6,"./zlib/inflate":8,"./zlib/messages":10,"./zlib/zstream":11}]},{},[])("/lib/inflate.js")}),define("pako_inflate",["pako_inflate/dist/pako_inflate"],function(e){return e}),define("x_ite/InputOutput/FileLoader",["jquery","x_ite/Base/X3DObject","x_ite/Fields","x_ite/Browser/Networking/urls","x_ite/Parser/Parser","x_ite/Parser/XMLParser","x_ite/Parser/JSONParser","standard/Networking/URI","standard/Networking/BinaryTransport","pako_inflate","x_ite/DEBUG"],function(e,t,i,n,r,s,o,a,u,l,h){"use strict";function c(e,i){t.call(this),this.node=e,this.browser=e.getBrowser(),this.external=void 0===i?this.browser.isExternal():i,this.executionContext=this.external?e.getExecutionContext():this.browser.currentScene,this.userAgent=this.browser.getName()+"/"+this.browser.getVersion()+" (X3D Browser; +"+this.browser.getProviderUrl()+")",this.url=[],this.URL=new a,this.fileReader=new FileReader}u(e);var d=/^\s*(?:vrmlscript|javascript|ecmascript)\:([^]*)$/,p=/^data\:([^]*?)(?:;([^]*?))?(;base64)?,([^]*)$/,f=/^(?:(.*?);(.*?)$)/,g=new RegExp(".(?:html|xhtml)$"),m={"text/html":!0,"application/xhtml+xml":!0},_=new i.MFString;return c.prototype=Object.assign(Object.create(t.prototype),{constructor:c,abort:function(){this.callback=Function.prototype,this.bindViewpoint=Function.prototype,this.foreign=Function.prototype},getWorldURL:function(){return this.URL},createX3DFromString:function(t,i,n,s){var o=this.browser.createScene();if(o.setURL(this.browser.getLocation().transform(t)),n){for(var a=[function(t,i,n,r){setTimeout(this.importDocument.bind(this,t,e.parseXML(i),n,r),17)},function(e,t,i,n){setTimeout(this.importJS.bind(this,e,JSON.parse(t),i,n),17)},function(e,t,i,n){new r(e).parseIntoScene(t),this.setScene(e,i,n)}],u=[],l=0,h=a.length;l<h;++l)try{return void a[l].call(this,o,i,n,s)}catch(e){u.push(e)}throw console.error(u),new Error("Couldn't parse X3D. No suitable file handler found for '"+t+"'.")}for(var a=[function(t,i){this.importDocument(t,e.parseXML(i))},function(e,t){this.importJS(e,JSON.parse(t))},function(e,t){new r(e).parseIntoScene(t)}],l=0,h=a.length;l<h;++l)try{return a[l].call(this,o,i),o}catch(e){console.log(e)}throw new Error("Couldn't parse x3d syntax.")},importJS:function(e,t,i,n){try{this.node.dom=new o(e).parseJavaScript(t),i&&this.setScene(e,i,n)}catch(e){if(!n)throw e;n(e)}},importDocument:function(e,t,i,n){try{new s(e).parseIntoScene(t),this.node.dom=t,i&&this.setScene(e,i,n)}catch(e){if(!n)throw e;n(e)}},setScene:function(e,t,i){e.initLoadCount_.addInterest("set_initLoadCount__",this,e,t,i),e.initLoadCount_.addEvent()},set_initLoadCount__:function(e,t,i,n){if(!e.getValue()){t.initLoadCount_.removeInterest("set_initLoadCount__",this);try{i(t)}catch(e){if(!n)throw e;n(e)}h&&this.URL.length&&"data"!==this.URL.scheme&&console.info("Done loading scene "+this.URL)}},createX3DFromURL:function(e,t,i,n,r){return this.bindViewpoint=n,this.foreign=r,i?this.loadDocument(e,t,this.createX3DFromURLAsync.bind(this,i)):this.createX3DFromURLSync(e)},createX3DFromURLAsync:function(e,t){null===t?e(null):this.createX3DFromString(this.URL,t,e,this.loadDocumentError.bind(this))},createX3DFromURLSync:function(t){if(0===t.length)throw new Error("No URL given.");for(var i=null,n=!1,r=0;r<t.length&&(this.URL=this.transform(t[r]),e.ajax({url:this.URL.escape(),dataType:"text",async:!1,cache:this.browser.getBrowserOptions().getCache(),global:!1,context:this,success:function(e){try{i=this.createX3DFromString(this.URL,e),n=!0}catch(e){this.error(e)}},error:function(e,t,i){}}),!n);++r);if(n)return i;throw new Error("Couldn't load any url of '"+t.getValue().join(", ")+"'.")},loadScript:function(e,t){this.script=!0,this.loadDocument(e,null,t)},loadDocument:function(e,t,i){if(this.url=e.copy(),this.callback=i,0===e.length)return this.loadDocumentError(new Error("No URL given."));this.target=this.getTarget(t||_),this.loadDocumentAsync(this.url.shift())},getTarget:function(e){for(var t=0,i=e.length;t<i;++t){var n=e[t].split("=");if(2===n.length&&"target"===n[0])return n[1]}return""},loadDocumentAsync:function(t){var i=new a(t);if(0==t.length)return void this.loadDocumentError(new Error("URL is empty."));try{if(this.bindViewpoint&&0===i.filename.toString().length&&0===i.query.length)return void this.bindViewpoint(i.fragment)}catch(e){return void this.loadDocumentError(e)}if(this.script)try{var r=d.exec(t);if(r)return void this.callback(r[1])}catch(e){return void this.loadDocumentError(e)}this.URL=this.transform(t);try{var r=p.exec(t);if(r){var s=r[4];return s=";base64"===r[3]?atob(s):unescape(s),this.target.length&&"_self"!==this.target&&this.foreign?this.foreign(this.URL.toString().replace(n.fallbackExpression,""),this.target):void this.callback(s)}}catch(e){return void this.loadDocumentError(e)}return this.target.length&&"_self"!==this.target&&this.foreign?this.foreign(this.URL.toString().replace(n.fallbackExpression,""),this.target):this.foreign&&this.URL.extension.match(g)?this.foreign(this.URL.toString().replace(n.fallbackExpression,""),this.target):void e.ajax({url:this.URL.escape(),dataType:"binary",async:!0,cache:this.browser.getBrowserOptions().getCache(),global:!1,context:this,success:function(e,t,i){if(this.foreign&&m[this.getContentType(i)])return this.foreign(this.URL.toString().replace(n.fallbackExpression,""),this.target);this.fileReader.onload=this.readAsText.bind(this,e),this.fileReader.readAsText(e)},error:function(e,t,i){this.loadDocumentError(new Error(i))}})},readAsText:function(e){try{this.callback(this.fileReader.result)}catch(t){this.fileReader.onload=this.readAsArrayBuffer.bind(this,t),this.fileReader.readAsArrayBuffer(e)}},readAsArrayBuffer:function(e){try{this.callback(l.ungzip(this.fileReader.result,{to:"string"}))}catch(t){this.loadDocumentError(e)}},loadDocumentError:function(e){this.error(e),this.url.length?this.loadDocumentAsync(this.url.shift()):this.callback(null)},error:function(e){"data"!==this.URL.scheme&&(console.warn("Couldn't load URL '"+this.URL+"':",e.message),h&&console.log(e))},transform:function(e){var t=this.getReferer().transform(new a(e));return t.isLocal()||"localhost"===t.host?t=this.browser.getLocation().getRelativePath(t):h&&(e.match(n.fallbackExpression)||this.url.unshift(n.fallbackUrl+t)),t},getReferer:function(){return"World"===this.node.getTypeName()&&this.external?this.browser.getLocation():this.executionContext.getURL()},getContentType:function(e){var t=e.getResponseHeader("Content-Type"),i=f.exec(t);return i?i[1]:""}}),c}),define("x_ite/Components/Shaders/ShaderPart",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Browser/Shaders/Shader","x_ite/Components/Core/X3DNode","x_ite/Components/Networking/X3DUrlObject","x_ite/InputOutput/FileLoader","x_ite/Bits/X3DConstants","x_ite/DEBUG"],function(e,t,i,n,r,s,o,a,u){"use strict";function l(t){r.call(this,t),s.call(this,t),this.addType(a.ShaderPart),this.addChildObjects("buffer",new e.SFTime),this.valid=!1}var h={VERTEX:"VERTEX_SHADER",TESS_CONTROL:"TESS_CONTROL_SHADER",TESS_EVALUATION:"TESS_EVALUATION_SHADER",GEOMETRY:"GEOMETRY_SHADER",FRAGMENT:"FRAGMENT_SHADER",COMPUTE:"COMPUTE_SHADER"};return l.prototype=Object.assign(Object.create(r.prototype),s.prototype,{constructor:l,fieldDefinitions:new i([new t(a.inputOutput,"metadata",new e.SFNode),new t(a.initializeOnly,"type",new e.SFString("VERTEX")),new t(a.inputOutput,"url",new e.MFString)]),getTypeName:function(){return"ShaderPart"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"parts"},initialize:function(){r.prototype.initialize.call(this),s.prototype.initialize.call(this);var e=this.getBrowser().getContext();this.shader=e.createShader(e[this.getShaderType()]),this.url_.addInterest("set_url__",this),this.buffer_.addInterest("set_buffer__",this),this.set_url__()},set_url__:function(){this.setLoadState(a.NOT_STARTED_STATE),this.requestAsyncLoad()},isValid:function(){return this.valid},getShader:function(){return this.shader},getShaderType:function(){var e=h[this.type_.getValue()];return e?e:"VERTEX_SHADER"},getSourceText:function(){return this.url_},requestAsyncLoad:function(){this.checkLoadState()!=a.COMPLETE_STATE&&this.checkLoadState()!=a.IN_PROGRESS_STATE&&(this.setLoadState(a.IN_PROGRESS_STATE),this.buffer_.addEvent())},set_buffer__:function(){this.valid=!1,new o(this).loadDocument(this.url_,null,function(e,t){if(null===e)this.setLoadState(a.FAILED_STATE);else{var i=this.getBrowser().getContext();if(i.shaderSource(this.shader,n.getShaderSource(this.getBrowser(),e)),i.compileShader(this.shader),this.valid=i.getShaderParameter(this.shader,i.COMPILE_STATUS),!this.valid)throw new Error(this.getTypeName()+" '"+this.getName()+"': "+i.getShaderInfoLog(this.shader));this.setLoadState(a.COMPLETE_STATE)}}.bind(this))}}),l}),define("text!x_ite/Browser/Shaders/PointSet.fs",[],function(){return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n#extension GL_EXT_frag_depth : enable\n#endif\n\nprecision mediump float;\nprecision mediump int;\n\nuniform int  x3d_NumClipPlanes;\nuniform vec4 x3d_ClipPlane [x3d_MaxClipPlanes];\n\nuniform float x3d_LinewidthScaleFactor;\nuniform x3d_FogParameters x3d_Fog;\n\nvarying vec4 C; // color\nvarying vec3 v; // point on geometry\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\nuniform float x3d_LogarithmicFarFactor1_2;\nvarying float depth;\n#endif\n\nvoid\nclip ()\n{\n\tfor (int i = 0; i < x3d_MaxClipPlanes; ++ i)\n\t{\n\t\tif (i == x3d_NumClipPlanes)\n\t\t\tbreak;\n\n\t\tif (dot (v, x3d_ClipPlane [i] .xyz) - x3d_ClipPlane [i] .w < 0.0)\n\t\t\tdiscard;\n\t}\n}\n\nfloat\ngetFogInterpolant ()\n{\n\t// Returns 0.0 for fog color and 1.0 for material color.\n\n\tif (x3d_Fog .type == x3d_None)\n\t\treturn 1.0;\n\n\tif (x3d_Fog .visibilityRange <= 0.0)\n\t\treturn 0.0;\n\n\tfloat dV = length (v - x3d_Fog .center);\n\n\tif (dV >= x3d_Fog .visibilityRange)\n\t\treturn 0.0;\n\n\tif (x3d_Fog .type == x3d_LinearFog)\n\t\treturn (x3d_Fog .visibilityRange - dV) / x3d_Fog .visibilityRange;\n\n\tif (x3d_Fog .type == x3d_ExponentialFog)\n\t\treturn exp (-dV / (x3d_Fog .visibilityRange - dV));\n\n\treturn 1.0;\n}\n\nvec3\ngetFogColor (const in vec3 color)\n{\n\treturn mix (x3d_Fog .color, color, getFogInterpolant ());\n}\n\nvoid\nmain ()\n{\n\tclip ();\n\n\tfloat lw = (x3d_LinewidthScaleFactor + 1.0) / 2.0;\n\tfloat t  = distance (vec2 (0.5, 0.5), gl_PointCoord) * 2.0 * lw - lw + 1.0;\n\n\tgl_FragColor .rgb = getFogColor (C .rgb);\n\tgl_FragColor .a   = mix (C .a, 0.0, clamp (t, 0.0, 1.0));\n\n\t#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n\t//http://outerra.blogspot.com/2013/07/logarithmic-depth-buffer-optimizations.html\n\tif (x3d_LogarithmicFarFactor1_2 > 0.0)\n\t\tgl_FragDepthEXT = log2 (depth) * x3d_LogarithmicFarFactor1_2;\n\telse\n\t\tgl_FragDepthEXT = gl_FragCoord .z;\n\t#endif\n}\n"}),define("text!x_ite/Browser/Shaders/Wireframe.vs",[],function(){return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nuniform int x3d_GeometryType;\n\nuniform float x3d_LinewidthScaleFactor;\nuniform bool  x3d_ColorMaterial;   // true if a X3DColorNode is attached, otherwise false\nuniform bool  x3d_Lighting;        // true if a X3DMaterialNode is attached, otherwise false\nuniform x3d_MaterialParameters x3d_FrontMaterial;  \n\nuniform mat4 x3d_ProjectionMatrix;\nuniform mat4 x3d_ModelViewMatrix;\n\nattribute vec4 x3d_Color;\nattribute vec4 x3d_Vertex;\n\nvarying vec4 C; // color\nvarying vec3 v; // point on geometry\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\nvarying float depth;\n#endif\n\nvoid\nmain ()\n{\n\t// If we are points, make the gl_PointSize one pixel larger.\n\tgl_PointSize = x3d_GeometryType == x3d_GeometryLines ? x3d_LinewidthScaleFactor : x3d_LinewidthScaleFactor + 1.0;\n\n\tvec4 p = x3d_ModelViewMatrix * x3d_Vertex;\n\n\tv           = vec3 (p);\n\tgl_Position = x3d_ProjectionMatrix * p;\n\n\t#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n\tdepth = 1.0 + gl_Position .w;\n\t#endif\n\n\tif (x3d_Lighting)\n\t{\n\t\tfloat alpha = 1.0 - x3d_FrontMaterial .transparency;\n\n\t\tif (x3d_ColorMaterial)\n\t\t{\n\t\t\tC .rgb = x3d_Color .rgb;\n\t\t\tC .a   = x3d_Color .a * alpha;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tC .rgb = x3d_FrontMaterial .emissiveColor;\n\t\t\tC .a   = alpha;\n\t\t}\n\t}\n\telse\n\t{\n\t\tif (x3d_ColorMaterial)\n\t\t\tC = x3d_Color;\n\t\telse\n\t\t\tC = vec4 (1.0, 1.0, 1.0, 1.0);\n\t}\n}\n"}),define("text!x_ite/Browser/Shaders/Wireframe.fs",[],function(){return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n#extension GL_EXT_frag_depth : enable\n#endif\n\nprecision mediump float;\nprecision mediump int;\n\nuniform int  x3d_NumClipPlanes;\nuniform vec4 x3d_ClipPlane [x3d_MaxClipPlanes];\n\nuniform x3d_FogParameters x3d_Fog;\n\nvarying vec4 C; // color\nvarying vec3 v; // point on geometry\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\nuniform float x3d_LogarithmicFarFactor1_2;\nvarying float depth;\n#endif\n\nvoid\nclip ()\n{\n\tfor (int i = 0; i < x3d_MaxClipPlanes; ++ i)\n\t{\n\t\tif (i == x3d_NumClipPlanes)\n\t\t\tbreak;\n\n\t\tif (dot (v, x3d_ClipPlane [i] .xyz) - x3d_ClipPlane [i] .w < 0.0)\n\t\t\tdiscard;\n\t}\n}\n\nfloat\ngetFogInterpolant ()\n{\n\t// Returns 0.0 for fog color and 1.0 for material color.\n\n\tif (x3d_Fog .type == x3d_None)\n\t\treturn 1.0;\n\n\tif (x3d_Fog .visibilityRange <= 0.0)\n\t\treturn 0.0;\n\n\tfloat dV = length (v - x3d_Fog .center);\n\n\tif (dV >= x3d_Fog .visibilityRange)\n\t\treturn 0.0;\n\n\tif (x3d_Fog .type == x3d_LinearFog)\n\t\treturn (x3d_Fog .visibilityRange - dV) / x3d_Fog .visibilityRange;\n\n\tif (x3d_Fog .type == x3d_ExponentialFog)\n\t\treturn exp (-dV / (x3d_Fog .visibilityRange - dV));\n\n\treturn 1.0;\n}\n\nvec3\ngetFogColor (const in vec3 color)\n{\n\treturn mix (x3d_Fog .color, color, getFogInterpolant ());\n}\n\nvoid\nmain ()\n{\n\tclip ();\n\n\tgl_FragColor .rgb = getFogColor (C .rgb);\n\tgl_FragColor .a   = C .a;\n\n\t#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n\t//http://outerra.blogspot.com/2013/07/logarithmic-depth-buffer-optimizations.html\n\tif (x3d_LogarithmicFarFactor1_2 > 0.0)\n\t\tgl_FragDepthEXT = log2 (depth) * x3d_LogarithmicFarFactor1_2;\n\telse\n\t\tgl_FragDepthEXT = gl_FragCoord .z;\n\t#endif\n}\n"}),define("text!x_ite/Browser/Shaders/Gouraud.vs",[],function(){
return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nuniform mat4 x3d_TextureMatrix [1];\nuniform mat3 x3d_NormalMatrix;\nuniform mat4 x3d_ProjectionMatrix;\nuniform mat4 x3d_ModelViewMatrix;\n\nuniform float x3d_LinewidthScaleFactor;\nuniform bool  x3d_Lighting;      // true if a X3DMaterialNode is attached, otherwise false\nuniform bool  x3d_ColorMaterial; // true if a X3DColorNode is attached, otherwise false\n\nuniform int x3d_NumLights;\nuniform x3d_LightSourceParameters x3d_LightSource [x3d_MaxLights];\nuniform bool x3d_SeparateBackColor;\nuniform x3d_MaterialParameters x3d_FrontMaterial;  \nuniform x3d_MaterialParameters x3d_BackMaterial;        \n\nattribute vec4 x3d_Color;\nattribute vec4 x3d_TexCoord;\nattribute vec3 x3d_Normal;\nattribute vec4 x3d_Vertex;\n\nvarying vec4 frontColor; // color\nvarying vec4 backColor;  // color\nvarying vec4 t;          // texCoord\nvarying vec3 v;          // point on geometry\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\nvarying float depth;\n#endif\n\nfloat\ngetSpotFactor (const in float cutOffAngle, const in float beamWidth, const in vec3 L, const in vec3 d)\n{\n\tfloat spotAngle = acos (clamp (dot (-L, d), -1.0, 1.0));\n\t\n\tif (spotAngle >= cutOffAngle)\n\t\treturn 0.0;\n\telse if (spotAngle <= beamWidth)\n\t\treturn 1.0;\n\n\treturn (spotAngle - cutOffAngle) / (beamWidth - cutOffAngle);\n}\n\nvec4\ngetMaterialColor (const in vec3 N,\n                  const in vec3 v,\n                  const in x3d_MaterialParameters material)\n{\n\tvec3 V = normalize (-v); // normalized vector from point on geometry to viewer's position\n\n\t// Calculate diffuseFactor & alpha\n\n\tvec3  diffuseFactor = vec3 (0.0, 0.0, 0.0);\n\tfloat alpha         = 1.0 - material .transparency;\n\n\tif (x3d_ColorMaterial)\n\t{\n\t\tdiffuseFactor  = x3d_Color .rgb;\n\t\talpha         *= x3d_Color .a;\n\t}\n\telse\n\t\tdiffuseFactor = material .diffuseColor;\n\n\tvec3 ambientTerm = diffuseFactor * material .ambientIntensity;\n\n\t// Apply light sources\n\n\tvec3 finalColor = vec3 (0.0, 0.0, 0.0);\n\n\tfor (int i = 0; i < x3d_MaxLights; ++ i)\n\t{\n\t\tif (i == x3d_NumLights)\n\t\t\tbreak;\n\n\t\tx3d_LightSourceParameters light = x3d_LightSource [i];\n\n\t\tvec3  vL = light .location - v;\n\t\tfloat dL = length (vL);\n\t\tbool  di = light .type == x3d_DirectionalLight;\n\n\t\tif (di || dL <= light .radius)\n\t\t{\n\t\t\tvec3 d = light .direction;\n\t\t\tvec3 c = light .attenuation;\n\t\t\tvec3 L = di ? -d : normalize (vL);      // Normalized vector from point on geometry to light source i position.\n\t\t\tvec3 H = normalize (L + V);             // Specular term\n\n\t\t\tfloat lightAngle     = dot (N, L);      // Angle between normal and light ray.\n\t\t\tvec3  diffuseTerm    = diffuseFactor * clamp (lightAngle, 0.0, 1.0);\n\t\t\tfloat specularFactor = material .shininess > 0.0 ? pow (max (dot (N, H), 0.0), material .shininess * 128.0) : 1.0;\n\t\t\tvec3  specularTerm   = material .specularColor * specularFactor;\n\n\t\t\tfloat attenuationFactor           = di ? 1.0 : 1.0 / max (c [0] + c [1] * dL + c [2] * (dL * dL), 1.0);\n\t\t\tfloat spotFactor                  = light .type == x3d_SpotLight ? getSpotFactor (light .cutOffAngle, light .beamWidth, L, d) : 1.0;\n\t\t\tfloat attenuationSpotFactor       = attenuationFactor * spotFactor;\n\t\t\tvec3  ambientColor                = light .ambientIntensity * ambientTerm;\n\t\t\tvec3  ambientDiffuseSpecularColor = ambientColor + light .intensity * (diffuseTerm + specularTerm);\n\n\t\t\tfinalColor += attenuationSpotFactor * (light .color * ambientDiffuseSpecularColor);\n\t\t}\n\t}\n\n\tfinalColor += material .emissiveColor;\n\n\treturn vec4 (clamp (finalColor, 0.0, 1.0), alpha);\n}\n\nvoid\nmain ()\n{\n\tgl_PointSize = x3d_LinewidthScaleFactor;\n\n\tvec4 p = x3d_ModelViewMatrix * x3d_Vertex;\n\n\tt = x3d_TextureMatrix [0] * x3d_TexCoord;\n\tv = p .xyz;\n\n\tgl_Position = x3d_ProjectionMatrix * p;\n\n\t#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n\tdepth = 1.0 + gl_Position .w;\n\t#endif\n\n\tif (x3d_Lighting)\n\t{\n\t\tvec3 N = normalize (x3d_NormalMatrix * x3d_Normal);\n\n\t\tfrontColor = getMaterialColor (N, v, x3d_FrontMaterial);\n\n\t\tx3d_MaterialParameters backMaterial = x3d_FrontMaterial;\n\n\t\tif (x3d_SeparateBackColor)\n\t\t\tbackMaterial = x3d_BackMaterial;\n\n\t\tbackColor = getMaterialColor (-N, v, backMaterial);\n\t}\n\telse\n\t{\n\t   frontColor = backColor = x3d_ColorMaterial ? x3d_Color : vec4 (1.0, 1.0, 1.0, 1.0);\n\t}\n}\n"}),define("text!x_ite/Browser/Shaders/Gouraud.fs",[],function(){return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n#extension GL_EXT_frag_depth : enable\n#endif\n\nprecision mediump float;\nprecision mediump int;\n\nuniform int x3d_GeometryType;\n\nuniform int  x3d_NumClipPlanes;\nuniform vec4 x3d_ClipPlane [x3d_MaxClipPlanes];\n\nuniform float x3d_LinewidthScaleFactor;\nuniform bool  x3d_Lighting;      // true if a X3DMaterialNode is attached, otherwise false\nuniform bool  x3d_ColorMaterial; // true if a X3DColorNode is attached, otherwise false\n\nuniform int         x3d_NumTextures;\nuniform int         x3d_TextureType [x3d_MaxTextures]; // x3d_None, x3d_TextureType2D or x3d_TextureTypeCubeMapTexture\nuniform sampler2D   x3d_Texture2D [x3d_MaxTextures];\nuniform samplerCube x3d_CubeMapTexture [x3d_MaxTextures];\n\nuniform x3d_FogParameters x3d_Fog;\n\nvarying vec4 frontColor; // color\nvarying vec4 backColor;  // color\nvarying vec4 t;          // texCoord\nvarying vec3 v;          // point on geometry\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\nuniform float x3d_LogarithmicFarFactor1_2;\nvarying float depth;\n#endif\n\nvoid\nclip ()\n{\n\tfor (int i = 0; i < x3d_MaxClipPlanes; ++ i)\n\t{\n\t\tif (i == x3d_NumClipPlanes)\n\t\t\tbreak;\n\n\t\tif (dot (v, x3d_ClipPlane [i] .xyz) - x3d_ClipPlane [i] .w < 0.0)\n\t\t\tdiscard;\n\t}\n}\n\nvec4\ngetTextureColor ()\n{\n\tif (x3d_TextureType [0] == x3d_TextureType2D)\n\t{\n\t\tif (x3d_GeometryType == x3d_Geometry3D || gl_FrontFacing)\n\t\t\treturn texture2D (x3d_Texture2D [0], vec2 (t));\n\n\t\t// If dimension is x3d_Geometry2D the texCoords must be flipped.\n\t\treturn texture2D (x3d_Texture2D [0], vec2 (1.0 - t .s, t .t));\n\t}\n\n \tif (x3d_TextureType [0] == x3d_TextureTypeCubeMapTexture)\n\t{\n\t\tif (x3d_GeometryType == x3d_Geometry3D || gl_FrontFacing)\n\t\t\treturn textureCube (x3d_CubeMapTexture [0], vec3 (t));\n\t\t\n\t\t// If dimension is x3d_Geometry2D the texCoords must be flipped.\n\t\treturn textureCube (x3d_CubeMapTexture [0], vec3 (1.0 - t .s, t .t, t .z));\n\t}\n \n\treturn vec4 (1.0, 1.0, 1.0, 1.0);\n}\n\nfloat\ngetFogInterpolant ()\n{\n\t// Returns 0.0 for fog color and 1.0 for material color.\n\n\tif (x3d_Fog .type == x3d_None)\n\t\treturn 1.0;\n\n\tif (x3d_Fog .visibilityRange <= 0.0)\n\t\treturn 0.0;\n\n\tfloat dV = length (v - x3d_Fog .center);\n\n\tif (dV >= x3d_Fog .visibilityRange)\n\t\treturn 0.0;\n\n\tif (x3d_Fog .type == x3d_LinearFog)\n\t\treturn (x3d_Fog .visibilityRange - dV) / x3d_Fog .visibilityRange;\n\n\tif (x3d_Fog .type == x3d_ExponentialFog)\n\t\treturn exp (-dV / (x3d_Fog .visibilityRange - dV));\n\n\treturn 1.0;\n}\n\nvec3\ngetFogColor (const in vec3 color)\n{\n\treturn mix (x3d_Fog .color, color, getFogInterpolant ());\n}\n\nvoid\nmain ()\n{\n \tclip ();\n\n\tvec4 finalColor = gl_FrontFacing ? frontColor : backColor;\n\n\tif (x3d_TextureType [0] != x3d_None)\n\t{\n\t\tif (x3d_Lighting)\n\t\t\tfinalColor *= getTextureColor ();\n\t\telse\n\t\t{\n\t\t\tif (x3d_ColorMaterial)\n\t\t\t\tfinalColor *= getTextureColor ();\n\t\t\telse\n\t\t\t\tfinalColor = getTextureColor ();\n\t\t}\n\t}\n\n\tgl_FragColor .rgb = getFogColor (finalColor .rgb);\n\tgl_FragColor .a   = finalColor .a;\n\n\t#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n\t//http://outerra.blogspot.com/2013/07/logarithmic-depth-buffer-optimizations.html\n\tif (x3d_LogarithmicFarFactor1_2 > 0.0)\n\t\tgl_FragDepthEXT = log2 (depth) * x3d_LogarithmicFarFactor1_2;\n\telse\n\t\tgl_FragDepthEXT = gl_FragCoord .z;\n\t#endif\n}\n"}),define("text!x_ite/Browser/Shaders/Phong.vs",[],function(){return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nuniform mat4 x3d_TextureMatrix [x3d_MaxTextures];\nuniform mat3 x3d_NormalMatrix;\nuniform mat4 x3d_ProjectionMatrix;\nuniform mat4 x3d_ModelViewMatrix;\n\nuniform float x3d_LinewidthScaleFactor;\nuniform bool  x3d_Lighting;  // true if a X3DMaterialNode is attached, otherwise false\n\nattribute vec4 x3d_Color;\nattribute vec4 x3d_TexCoord;\nattribute vec3 x3d_Normal;\nattribute vec4 x3d_Vertex;\n\nvarying vec4 C;  // color\nvarying vec4 t;  // texCoord\nvarying vec3 vN; // normalized normal vector at this point on geometry\nvarying vec3 v;  // point on geometry\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\nvarying float depth;\n#endif\n\nvoid\nmain ()\n{\n\tgl_PointSize = x3d_LinewidthScaleFactor;\n\n\tvec4 p = x3d_ModelViewMatrix * x3d_Vertex;\n\n\tif (x3d_Lighting)\n\t\tvN = x3d_NormalMatrix * x3d_Normal;\n\n\tt = x3d_TextureMatrix [0] * x3d_TexCoord;\n\tC = x3d_Color;\n\tv = p .xyz;\n\n\tgl_Position = x3d_ProjectionMatrix * p;\n\n\t#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n\tdepth = 1.0 + gl_Position .w;\n\t#endif\n}\n"}),define("text!x_ite/Browser/Shaders/Phong.fs",[],function(){return'// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n#extension GL_EXT_frag_depth : enable\n#endif\n\nprecision mediump float;\nprecision mediump int;\n\nuniform int x3d_GeometryType;\n\nuniform int  x3d_NumClipPlanes;\nuniform vec4 x3d_ClipPlane [x3d_MaxClipPlanes];\n\nuniform float x3d_LinewidthScaleFactor;\nuniform bool  x3d_Lighting;      // true if a X3DMaterialNode is attached, otherwise false\nuniform bool  x3d_ColorMaterial; // true if a X3DColorNode is attached, otherwise false\n\nuniform int x3d_NumLights;\nuniform x3d_LightSourceParameters x3d_LightSource [x3d_MaxLights];\nuniform bool x3d_SeparateBackColor;\nuniform x3d_MaterialParameters x3d_FrontMaterial;  \nuniform x3d_MaterialParameters x3d_BackMaterial;        \n\nuniform int         x3d_NumTextures;\nuniform int         x3d_TextureType [x3d_MaxTextures]; // x3d_None, x3d_TextureType2D or x3d_TextureTypeCubeMapTexture\nuniform sampler2D   x3d_Texture2D [x3d_MaxTextures];\nuniform samplerCube x3d_CubeMapTexture [x3d_MaxTextures];\n\nuniform x3d_FogParameters x3d_Fog;\n\nvarying vec4 C;  // color\nvarying vec4 t;  // texCoord\nvarying vec3 vN; // normalized normal vector at this point on geometry\nvarying vec3 v;  // point on geometry\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\nuniform float x3d_LogarithmicFarFactor1_2;\nvarying float depth;\n#endif\n\n#pragma X3D include "Inlcude/Shadow.h"\n\nvoid\nclip ()\n{\n\tfor (int i = 0; i < x3d_MaxClipPlanes; ++ i)\n\t{\n\t\tif (i == x3d_NumClipPlanes)\n\t\t\tbreak;\n\n\t\tif (dot (v, x3d_ClipPlane [i] .xyz) - x3d_ClipPlane [i] .w < 0.0)\n\t\t\tdiscard;\n\t}\n}\n\nfloat\ngetSpotFactor (const in float cutOffAngle, const in float beamWidth, const in vec3 L, const in vec3 d)\n{\n\tfloat spotAngle = acos (clamp (dot (-L, d), -1.0, 1.0));\n\t\n\tif (spotAngle >= cutOffAngle)\n\t\treturn 0.0;\n\telse if (spotAngle <= beamWidth)\n\t\treturn 1.0;\n\n\treturn (spotAngle - cutOffAngle) / (beamWidth - cutOffAngle);\n}\n\nvec4\ngetTextureColor ()\n{\n\tif (x3d_TextureType [0] == x3d_TextureType2D)\n\t{\n\t\tif (x3d_GeometryType == x3d_Geometry3D || gl_FrontFacing)\n\t\t\treturn texture2D (x3d_Texture2D [0], vec2 (t));\n\t\t\n\t\t// If dimension is x3d_Geometry2D the texCoords must be flipped.\n\t\treturn texture2D (x3d_Texture2D [0], vec2 (1.0 - t .s, t .t));\n\t}\n\n \tif (x3d_TextureType [0] == x3d_TextureTypeCubeMapTexture)\n\t{\n\t\tif (x3d_GeometryType == x3d_Geometry3D || gl_FrontFacing)\n\t\t\treturn textureCube (x3d_CubeMapTexture [0], vec3 (t));\n\t\t\n\t\t// If dimension is x3d_Geometry2D the texCoords must be flipped.\n\t\treturn textureCube (x3d_CubeMapTexture [0], vec3 (1.0 - t .s, t .t, t .z));\n\t}\n \n\treturn vec4 (1.0, 1.0, 1.0, 1.0);\n}\n\nvec4\ngetMaterialColor (const in x3d_MaterialParameters material)\n{\n\tif (x3d_Lighting)\n\t{\n\t\tvec3  N  = normalize (gl_FrontFacing ? vN : -vN);\n\t\tvec3  V  = normalize (-v); // normalized vector from point on geometry to viewer\'s position\n\t\tfloat dV = length (v);\n\n\t\t// Calculate diffuseFactor & alpha\n\n\t\tvec3  diffuseFactor = vec3 (1.0, 1.0, 1.0);\n\t\tfloat alpha         = 1.0 - material .transparency;\n\n\t\tif (x3d_ColorMaterial)\n\t\t{\n\t\t\tif (x3d_TextureType [0] != x3d_None)\n\t\t\t{\n\t\t\t\tvec4 T = getTextureColor ();\n\n\t\t\t\tdiffuseFactor  = T .rgb * C .rgb;\n\t\t\t\talpha         *= T .a;\n\t\t\t}\n\t\t\telse\n\t\t\t\tdiffuseFactor = C .rgb;\n\n\t\t\talpha *= C .a;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (x3d_TextureType [0] != x3d_None)\n\t\t\t{\n\t\t\t\tvec4 T = getTextureColor ();\n\n\t\t\t\tdiffuseFactor  = T .rgb * material .diffuseColor;\n\t\t\t\talpha         *= T .a;\n\t\t\t}\n\t\t\telse\n\t\t\t\tdiffuseFactor = material .diffuseColor;\n\t\t}\n\n\t\tvec3 ambientTerm = diffuseFactor * material .ambientIntensity;\n\n\t\t// Apply light sources\n\n\t\tvec3 finalColor = vec3 (0.0, 0.0, 0.0);\n\n\t\tfor (int i = 0; i < x3d_MaxLights; i ++)\n\t\t{\n\t\t\tif (i == x3d_NumLights)\n\t\t\t\tbreak;\n\n\t\t\tx3d_LightSourceParameters light = x3d_LightSource [i];\n\n\t\t\tvec3  vL = light .location - v; // Light to fragment\n\t\t\tfloat dL = length (vL);\n\t\t\tbool  di = light .type == x3d_DirectionalLight;\n\n\t\t\tif (di || dL <= light .radius)\n\t\t\t{\n\t\t\t\tvec3 d = light .direction;\n\t\t\t\tvec3 c = light .attenuation;\n\t\t\t\tvec3 L = di ? -d : normalize (vL);      // Normalized vector from point on geometry to light source i position.\n\t\t\t\tvec3 H = normalize (L + V);             // Specular term\n\n\t\t\t\tfloat lightAngle     = dot (N, L);      // Angle between normal and light ray.\n\t\t\t\tvec3  diffuseTerm    = diffuseFactor * clamp (lightAngle, 0.0, 1.0);\n\t\t\t\tfloat specularFactor = material .shininess > 0.0 ? pow (max (dot (N, H), 0.0), material .shininess * 128.0) : 1.0;\n\t\t\t\tvec3  specularTerm   = material .specularColor * specularFactor;\n\n\t\t\t\tfloat attenuationFactor     = di ? 1.0 : 1.0 / max (c [0] + c [1] * dL + c [2] * (dL * dL), 1.0);\n\t\t\t\tfloat spotFactor            = light .type == x3d_SpotLight ? getSpotFactor (light .cutOffAngle, light .beamWidth, L, d) : 1.0;\n\t\t\t\tfloat attenuationSpotFactor = attenuationFactor * spotFactor;\n\t\t\t\tvec3  ambientColor          = light .color * light .ambientIntensity * ambientTerm;\n\t\t\t\tvec3  diffuseSpecularColor  = light .color * light .intensity * (diffuseTerm + specularTerm);\n\n\t\t\t\t#ifdef X3D_SHADOWS\n\t\t\t\t\tif (lightAngle > 0.0)\n\t\t\t\t\t\tdiffuseSpecularColor = mix (diffuseSpecularColor, light .shadowColor, getShadowIntensity (i, light));\n\t\t\t\t#endif\n\n\t\t\t\tfinalColor += attenuationSpotFactor * (ambientColor + diffuseSpecularColor);\n\t\t\t}\n\t\t}\n\n\t\tfinalColor += material .emissiveColor;\n\n\t\treturn vec4 (finalColor, alpha);\n\t}\n\telse\n\t{\n\t\tvec4 finalColor = vec4 (1.0, 1.0, 1.0, 1.0);\n\t\n\t\tif (x3d_ColorMaterial)\n\t\t{\n\t\t\tif (x3d_TextureType [0] != x3d_None)\n\t\t\t{\n\t\t\t\tvec4 T = getTextureColor ();\n\n\t\t\t\tfinalColor = T * C;\n\t\t\t}\n\t\t\telse\n\t\t\t\tfinalColor = C;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (x3d_TextureType [0] != x3d_None)\n\t\t\t\tfinalColor = getTextureColor ();\n\t\t}\n\n\t\treturn finalColor;\n\t}\n}\n\nfloat\ngetFogInterpolant ()\n{\n\t// Returns 0.0 for fog color and 1.0 for material color.\n\n\tif (x3d_Fog .type == x3d_None)\n\t\treturn 1.0;\n\n\tif (x3d_Fog .visibilityRange <= 0.0)\n\t\treturn 0.0;\n\n\tfloat dV = length (v - x3d_Fog .center);\n\n\tif (dV >= x3d_Fog .visibilityRange)\n\t\treturn 0.0;\n\n\tif (x3d_Fog .type == x3d_LinearFog)\n\t\treturn (x3d_Fog .visibilityRange - dV) / x3d_Fog .visibilityRange;\n\n\tif (x3d_Fog .type == x3d_ExponentialFog)\n\t\treturn exp (-dV / (x3d_Fog .visibilityRange - dV));\n\n\treturn 1.0;\n}\n\nvec3\ngetFogColor (const in vec3 color)\n{\n\treturn mix (x3d_Fog .color, color, getFogInterpolant ());\n}\n\n// DEBUG\n//uniform ivec4 x3d_Viewport;\n\nvoid\nmain ()\n{\n\tclip ();\n\n\tbool frontColor = gl_FrontFacing || ! x3d_SeparateBackColor;\n\n\tgl_FragColor      = frontColor ? getMaterialColor (x3d_FrontMaterial) : getMaterialColor (x3d_BackMaterial);\n\tgl_FragColor .rgb = getFogColor (gl_FragColor .rgb);\n\n\t#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n\t//http://outerra.blogspot.com/2013/07/logarithmic-depth-buffer-optimizations.html\n\tif (x3d_LogarithmicFarFactor1_2 > 0.0)\n\t\tgl_FragDepthEXT = log2 (depth) * x3d_LogarithmicFarFactor1_2;\n\telse\n\t\tgl_FragDepthEXT = gl_FragCoord .z;\n\t#endif\n\n\t// DEBUG\n\t#ifdef X3D_SHADOWS\n\t//gl_FragColor .rgb = texture2D (x3d_ShadowMap [0], gl_FragCoord .xy / vec2 (x3d_Viewport .zw)) .rgb;\n\t//gl_FragColor .rgb = mix (tex .rgb, gl_FragColor .rgb, 0.5);\n\t#endif\n\n\t#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n\t//gl_FragColor .rgb = mix (vec3 (1.0, 0.0, 0.0), gl_FragColor .rgb, 0.5);\n\t#endif\n}\n'}),define("text!x_ite/Browser/Shaders/Depth.vs",[],function(){return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nuniform mat4 x3d_ProjectionMatrix;\nuniform mat4 x3d_ModelViewMatrix;\n\nattribute vec4 x3d_Vertex;\n\nvarying vec3 v; // point on geometry\n\nvoid\nmain ()\n{\n\tvec4 p = x3d_ModelViewMatrix * x3d_Vertex;\n\n\tv = p .xyz;\n\n\tgl_Position = x3d_ProjectionMatrix * p;\n}\n"}),define("text!x_ite/Browser/Shaders/Depth.fs",[],function(){return'// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nuniform int  x3d_NumClipPlanes;\nuniform vec4 x3d_ClipPlane [x3d_MaxClipPlanes];\n\nvarying vec3 v; // point on geometry\n\n#pragma X3D include "Include/Pack.h"\n\nvoid\nclip ()\n{\n\tfor (int i = 0; i < x3d_MaxClipPlanes; ++ i)\n\t{\n\t\tif (i == x3d_NumClipPlanes)\n\t\t\tbreak;\n\n\t\tif (dot (v, x3d_ClipPlane [i] .xyz) - x3d_ClipPlane [i] .w < 0.0)\n\t\t\tdiscard;\n\t}\n}\n\nvoid\nmain ()\n{\n\tclip ();\n\n\tgl_FragColor = pack (gl_FragCoord .z);\n}\n'}),define("standard/Math/Geometry/Line3",["standard/Math/Numbers/Vector3"],function(e){"use strict";function t(e,t){this.point=e.copy(),this.direction=t.copy()}return t.prototype={constructor:t,u:new e(0,0,0),pvec:new e(0,0,0),tvec:new e(0,0,0),copy:function(){var e=Object.create(t.prototype);return e.point=this.point.copy(),e.direction=this.direction.copy(),e},assign:function(e){return this.point.assign(e.point),this.direction.assign(e.direction),this},set:function(e,t){return this.point.assign(e),this.direction.assign(t),this},setPoints:function(e,t){return this.point.assign(e),this.direction.assign(t).subtract(e).normalize(),this},multMatrixLine:function(e){return e.multMatrixVec(this.point),e.multMatrixDir(this.direction).normalize(),this},multLineMatrix:function(e){return e.multVecMatrix(this.point),e.multDirMatrix(this.direction).normalize(),this},getClosestPointToPoint:function(e,t){var i=t.assign(e).subtract(this.point),n=i.dot(this.direction);return t.assign(this.direction).multiply(n).add(this.point)},getClosestPointToLine:function(t,i){var n=this.point,r=t.point,s=this.direction,o=t.direction,a=e.dot(s,o);if(Math.abs(a)>=1)return!1;var u=this.u.assign(r).subtract(n);return a=(e.dot(u,s)-a*e.dot(u,o))/(1-a*a),i.assign(s).multiply(a).add(n),!0},getPerpendicularVector:function(t){var i=e.subtract(this.point,t);return i.subtract(this.direction.copy().multiply(e.dot(i,this.direction)))},intersectsTriangle:function(e,t,i,n){var r=t.subtract(e),s=i.subtract(e),o=this.pvec.assign(this.direction).cross(s),a=r.dot(o);if(0===a)return!1;var u=1/a,l=this.tvec.assign(this.point).subtract(e),h=l.dot(o)*u;if(h<0||h>1)return!1;var c=l.cross(r),d=this.direction.dot(c)*u;if(d<0||h+d>1)return!1;var p=s.dot(c)*u;return n.u=h,n.v=d,n.t=p,!0},toString:function(){return this.point+", "+this.direction}},t.Points=function(i,n){var r=Object.create(t.prototype);return r.point=i.copy(),r.direction=e.subtract(n,i).normalize(),r},t}),define("standard/Math/Geometry/Plane3",["standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(e,t){"use strict";function i(e,t){this.normal=t.copy(),this.distanceFromOrigin=t.dot(e)}var n=new e(0,0,0),r=new e(0,0,0),s=new t;return i.prototype={constructor:i,copy:function(){var e=Object.create(i.prototype);return e.normal=this.normal.copy(),e.distanceFromOrigin=this.distanceFromOrigin,e},assign:function(e){return this.normal.assign(e.normal),this.distanceFromOrigin=e.distanceFromOrigin,this},set:function(e,t){return this.normal.assign(t),this.distanceFromOrigin=t.dot(e),this},multRight:function(e){return r.assign(this.normal).multiply(this.distanceFromOrigin),s.assign(e).inverse(),s.multMatrixDir(n.assign(this.normal)).normalize(),e.multVecMatrix(r),this.normal.assign(n),this.distanceFromOrigin=n.dot(r),this},multLeft:function(e){return r.assign(this.normal).multiply(this.distanceFromOrigin),s.assign(e).inverse(),s.multDirMatrix(n.assign(this.normal)).normalize(),e.multMatrixVec(r),this.normal.assign(n),this.distanceFromOrigin=n.dot(r),this},getDistanceToPoint:function(t){return e.dot(t,this.normal)-this.distanceFromOrigin},intersectsLine:function(e,t){var i=e.point,n=e.direction,r=n.dot(this.normal);if(0===r)return!1;var s=(this.distanceFromOrigin-this.normal.dot(i))/r;return t.x=i.x+n.x*s,t.y=i.y+n.y*s,t.z=i.z+n.z*s,!0},toString:function(){return this.normal.toString()+" "+this.distanceFromOrigin}},i});var libtess={};libtess.DEBUG=!1,libtess.assert=function(e,t){if(libtess.DEBUG&&!e)throw new Error("Assertion failed"+(t?": "+t:""))},libtess.GLU_TESS_MAX_COORD=1e150,libtess.TRUE_PROJECT=!1,libtess.GLU_TESS_DEFAULT_TOLERANCE=0,libtess.windingRule={GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},libtess.primitiveType={GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},libtess.errorType={GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},libtess.gluEnum={GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111,GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901},libtess.PQHandle,libtess.geom={},libtess.geom.vertEq=function(e,t){return e.s===t.s&&e.t===t.t},libtess.geom.vertLeq=function(e,t){return e.s<t.s||e.s===t.s&&e.t<=t.t},libtess.geom.edgeEval=function(e,t,i){var n=t.s-e.s,r=i.s-t.s;return n+r>0?n<r?t.t-e.t+(e.t-i.t)*(n/(n+r)):t.t-i.t+(i.t-e.t)*(r/(n+r)):0},libtess.geom.edgeSign=function(e,t,i){var n=t.s-e.s,r=i.s-t.s;return n+r>0?(t.t-i.t)*n+(t.t-e.t)*r:0},libtess.geom.transLeq=function(e,t){return e.t<t.t||e.t===t.t&&e.s<=t.s},libtess.geom.transEval=function(e,t,i){var n=t.t-e.t,r=i.t-t.t;return n+r>0?n<r?t.s-e.s+(e.s-i.s)*(n/(n+r)):t.s-i.s+(i.s-e.s)*(r/(n+r)):0},libtess.geom.transSign=function(e,t,i){var n=t.t-e.t,r=i.t-t.t;return n+r>0?(t.s-i.s)*n+(t.s-e.s)*r:0},libtess.geom.edgeGoesLeft=function(e){return libtess.geom.vertLeq(e.dst(),e.org)},libtess.geom.edgeGoesRight=function(e){return libtess.geom.vertLeq(e.org,e.dst())},libtess.geom.vertL1dist=function(e,t){return Math.abs(e.s-t.s)+Math.abs(e.t-t.t)},libtess.geom.vertCCW=function(e,t,i){return e.s*(t.t-i.t)+t.s*(i.t-e.t)+i.s*(e.t-t.t)>=0},libtess.geom.interpolate_=function(e,t,i,n){return e=e<0?0:e,i=i<0?0:i,e<=i?0===i?(t+n)/2:t+e/(e+i)*(n-t):n+i/(e+i)*(t-n)},libtess.geom.edgeIntersect=function(e,t,i,n,r){var s,o,a;libtess.geom.vertLeq(e,t)||(a=e,e=t,t=a),libtess.geom.vertLeq(i,n)||(a=i,i=n,n=a),libtess.geom.vertLeq(e,i)||(a=e,e=i,i=a,a=t,t=n,n=a),libtess.geom.vertLeq(i,t)?libtess.geom.vertLeq(t,n)?(s=libtess.geom.edgeEval(e,i,t),o=libtess.geom.edgeEval(i,t,n),s+o<0&&(s=-s,o=-o),r.s=libtess.geom.interpolate_(s,i.s,o,t.s)):(s=libtess.geom.edgeSign(e,i,t),o=-libtess.geom.edgeSign(e,n,t),s+o<0&&(s=-s,o=-o),r.s=libtess.geom.interpolate_(s,i.s,o,n.s)):r.s=(i.s+t.s)/2,libtess.geom.transLeq(e,t)||(a=e,e=t,t=a),libtess.geom.transLeq(i,n)||(a=i,i=n,n=a),libtess.geom.transLeq(e,i)||(a=e,e=i,i=a,a=t,t=n,n=a),libtess.geom.transLeq(i,t)?libtess.geom.transLeq(t,n)?(s=libtess.geom.transEval(e,i,t),o=libtess.geom.transEval(i,t,n),s+o<0&&(s=-s,o=-o),r.t=libtess.geom.interpolate_(s,i.t,o,t.t)):(s=libtess.geom.transSign(e,i,t),o=-libtess.geom.transSign(e,n,t),s+o<0&&(s=-s,o=-o),r.t=libtess.geom.interpolate_(s,i.t,o,n.t)):r.t=(i.t+t.t)/2},libtess.mesh={},libtess.mesh.makeEdge=function(e){var t=libtess.mesh.makeEdgePair_(e.eHead);return libtess.mesh.makeVertex_(t,e.vHead),libtess.mesh.makeVertex_(t.sym,e.vHead),libtess.mesh.makeFace_(t,e.fHead),t},libtess.mesh.meshSplice=function(e,t){var i=!1,n=!1;e!==t&&(t.org!==e.org&&(n=!0,libtess.mesh.killVertex_(t.org,e.org)),t.lFace!==e.lFace&&(i=!0,libtess.mesh.killFace_(t.lFace,e.lFace)),libtess.mesh.splice_(t,e),n||(libtess.mesh.makeVertex_(t,e.org),e.org.anEdge=e),i||(libtess.mesh.makeFace_(t,e.lFace),e.lFace.anEdge=e))},libtess.mesh.deleteEdge=function(e){var t=e.sym,i=!1;e.lFace!==e.rFace()&&(i=!0,libtess.mesh.killFace_(e.lFace,e.rFace())),e.oNext===e?libtess.mesh.killVertex_(e.org,null):(e.rFace().anEdge=e.oPrev(),e.org.anEdge=e.oNext,libtess.mesh.splice_(e,e.oPrev()),i||libtess.mesh.makeFace_(e,e.lFace)),t.oNext===t?(libtess.mesh.killVertex_(t.org,null),libtess.mesh.killFace_(t.lFace,null)):(e.lFace.anEdge=t.oPrev(),t.org.anEdge=t.oNext,libtess.mesh.splice_(t,t.oPrev())),libtess.mesh.killEdge_(e)},libtess.mesh.addEdgeVertex=function(e){var t=libtess.mesh.makeEdgePair_(e),i=t.sym;return libtess.mesh.splice_(t,e.lNext),t.org=e.dst(),libtess.mesh.makeVertex_(i,t.org),t.lFace=i.lFace=e.lFace,t},libtess.mesh.splitEdge=function(e){var t=libtess.mesh.addEdgeVertex(e),i=t.sym;return libtess.mesh.splice_(e.sym,e.sym.oPrev()),libtess.mesh.splice_(e.sym,i),e.sym.org=i.org,i.dst().anEdge=i.sym,i.sym.lFace=e.rFace(),i.winding=e.winding,i.sym.winding=e.sym.winding,i},libtess.mesh.connect=function(e,t){var i=!1,n=libtess.mesh.makeEdgePair_(e),r=n.sym;return t.lFace!==e.lFace&&(i=!0,libtess.mesh.killFace_(t.lFace,e.lFace)),libtess.mesh.splice_(n,e.lNext),libtess.mesh.splice_(r,t),n.org=e.dst(),r.org=t.org,n.lFace=r.lFace=e.lFace,e.lFace.anEdge=r,i||libtess.mesh.makeFace_(n,e.lFace),n},libtess.mesh.zapFace=function(e){var t,i=e.anEdge,n=i.lNext;do if(t=n,n=t.lNext,t.lFace=null,null===t.rFace()){t.oNext===t?libtess.mesh.killVertex_(t.org,null):(t.org.anEdge=t.oNext,libtess.mesh.splice_(t,t.oPrev()));var r=t.sym;r.oNext===r?libtess.mesh.killVertex_(r.org,null):(r.org.anEdge=r.oNext,libtess.mesh.splice_(r,r.oPrev())),libtess.mesh.killEdge_(t)}while(t!==i)var s=e.prev,o=e.next;o.prev=s,s.next=o},libtess.mesh.meshUnion=function(e,t){var i=e.fHead,n=e.vHead,r=e.eHead,s=t.fHead,o=t.vHead,a=t.eHead;return s.next!==s&&(i.prev.next=s.next,s.next.prev=i.prev,s.prev.next=i,i.prev=s.prev),o.next!==o&&(n.prev.next=o.next,o.next.prev=n.prev,o.prev.next=n,n.prev=o.prev),a.next!==a&&(r.sym.next.sym.next=a.next,a.next.sym.next=r.sym.next,a.sym.next.sym.next=r,r.sym.next=a.sym.next),e},libtess.mesh.deleteMesh=function(e){},libtess.mesh.makeEdgePair_=function(e){var t=new libtess.GluHalfEdge,i=new libtess.GluHalfEdge,n=e.sym.next;return i.next=n,n.sym.next=t,t.next=e,e.sym.next=i,t.sym=i,t.oNext=t,t.lNext=i,i.sym=t,i.oNext=i,i.lNext=t,t},libtess.mesh.splice_=function(e,t){var i=e.oNext,n=t.oNext;i.sym.lNext=t,n.sym.lNext=e,e.oNext=n,t.oNext=i},libtess.mesh.makeVertex_=function(e,t){var i=t.prev,n=new libtess.GluVertex(t,i);i.next=n,t.prev=n,n.anEdge=e;var r=e;do r.org=n,r=r.oNext;while(r!==e)},libtess.mesh.makeFace_=function(e,t){var i=t.prev,n=new libtess.GluFace(t,i);i.next=n,t.prev=n,n.anEdge=e,n.inside=t.inside;var r=e;do r.lFace=n,r=r.lNext;while(r!==e)},libtess.mesh.killEdge_=function(e){var t=e.next,i=e.sym.next;t.sym.next=i,i.sym.next=t},libtess.mesh.killVertex_=function(e,t){var i=e.anEdge,n=i;do n.org=t,n=n.oNext;while(n!==i)var r=e.prev,s=e.next;s.prev=r,r.next=s},libtess.mesh.killFace_=function(e,t){var i=e.anEdge,n=i;do n.lFace=t,n=n.lNext;while(n!==i)var r=e.prev,s=e.next;s.prev=r,r.next=s},libtess.normal={},libtess.normal.S_UNIT_X_=1,libtess.normal.S_UNIT_Y_=0,libtess.normal.projectPolygon=function(e,t,i,n){var r=!1,s=[t,i,n];0===t&&0===i&&0===n&&(libtess.normal.computeNormal_(e,s),r=!0);var o,a=libtess.normal.longAxis_(s),u=e.mesh.vHead;if(libtess.TRUE_PROJECT){libtess.normal.normalize_(s);var l=[0,0,0],h=[0,0,0];l[a]=0,l[(a+1)%3]=libtess.normal.S_UNIT_X_,l[(a+2)%3]=libtess.normal.S_UNIT_Y_;var c=libtess.normal.dot_(l,s);for(l[0]-=c*s[0],l[1]-=c*s[1],l[2]-=c*s[2],libtess.normal.normalize_(l),h[0]=s[1]*l[2]-s[2]*l[1],h[1]=s[2]*l[0]-s[0]*l[2],h[2]=s[0]*l[1]-s[1]*l[0],libtess.normal.normalize_(h),o=u.next;o!==u;o=o.next)o.s=libtess.normal.dot_(o.coords,l),o.t=libtess.normal.dot_(o.coords,h)}else{var d=(a+1)%3,p=(a+2)%3,f=s[a]>0?1:-1;for(o=u.next;o!==u;o=o.next)o.s=o.coords[d],o.t=f*o.coords[p]}r&&libtess.normal.checkOrientation_(e)},libtess.normal.dot_=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},libtess.normal.normalize_=function(e){var t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];t=Math.sqrt(t),e[0]/=t,e[1]/=t,e[2]/=t},libtess.normal.longAxis_=function(e){var t=0;return Math.abs(e[1])>Math.abs(e[0])&&(t=1),Math.abs(e[2])>Math.abs(e[t])&&(t=2),t},libtess.normal.computeNormal_=function(e,t){var i,n=[-2*libtess.GLU_TESS_MAX_COORD,-2*libtess.GLU_TESS_MAX_COORD,-2*libtess.GLU_TESS_MAX_COORD],r=[2*libtess.GLU_TESS_MAX_COORD,2*libtess.GLU_TESS_MAX_COORD,2*libtess.GLU_TESS_MAX_COORD],s=[],o=[],a=e.mesh.vHead;for(i=a.next;i!==a;i=i.next)for(var u=0;u<3;++u){var l=i.coords[u];l<r[u]&&(r[u]=l,o[u]=i),l>n[u]&&(n[u]=l,s[u]=i)}var h=0;if(n[1]-r[1]>n[0]-r[0]&&(h=1),n[2]-r[2]>n[h]-r[h]&&(h=2),r[h]>=n[h])return t[0]=0,t[1]=0,void(t[2]=1);var c=0,d=o[h],p=s[h],f=[0,0,0],g=[d.coords[0]-p.coords[0],d.coords[1]-p.coords[1],d.coords[2]-p.coords[2]],m=[0,0,0];for(i=a.next;i!==a;i=i.next){m[0]=i.coords[0]-p.coords[0],m[1]=i.coords[1]-p.coords[1],m[2]=i.coords[2]-p.coords[2],f[0]=g[1]*m[2]-g[2]*m[1],f[1]=g[2]*m[0]-g[0]*m[2],f[2]=g[0]*m[1]-g[1]*m[0];var _=f[0]*f[0]+f[1]*f[1]+f[2]*f[2];_>c&&(c=_,t[0]=f[0],t[1]=f[1],t[2]=f[2])}c<=0&&(t[0]=t[1]=t[2]=0,t[libtess.normal.longAxis_(g)]=1)},libtess.normal.checkOrientation_=function(e){for(var t=0,i=e.mesh.fHead,n=i.next;n!==i;n=n.next){var r=n.anEdge;if(!(r.winding<=0))do t+=(r.org.s-r.dst().s)*(r.org.t+r.dst().t),r=r.lNext;while(r!==n.anEdge)}if(t<0)for(var s=e.mesh.vHead,o=s.next;o!==s;o=o.next)o.t=-o.t},libtess.render={},libtess.render.renderMesh=function(e,t,i){for(var n=!1,r=-1,s=t.fHead.prev;s!==t.fHead;s=s.prev)if(s.inside){n||(e.callBeginCallback(libtess.primitiveType.GL_TRIANGLES),n=!0);var o=s.anEdge;do{if(i){var a=o.rFace().inside?0:1;r!==a&&(r=a,e.callEdgeFlagCallback(!!r))}e.callVertexCallback(o.org.data),o=o.lNext}while(o!==s.anEdge)}n&&e.callEndCallback()},libtess.render.renderBoundary=function(e,t){for(var i=t.fHead.next;i!==t.fHead;i=i.next)if(i.inside){e.callBeginCallback(libtess.primitiveType.GL_LINE_LOOP);var n=i.anEdge;do e.callVertexCallback(n.org.data),n=n.lNext;while(n!==i.anEdge)e.callEndCallback()}},libtess.sweep={},
libtess.sweep.SENTINEL_COORD_=4*libtess.GLU_TESS_MAX_COORD,libtess.sweep.TOLERANCE_NONZERO_=!1,libtess.sweep.computeInterior=function(e){e.fatalError=!1,libtess.sweep.removeDegenerateEdges_(e),libtess.sweep.initPriorityQ_(e),libtess.sweep.initEdgeDict_(e);for(var t;null!==(t=e.pq.extractMin());){for(;;){var i=e.pq.minimum();if(null===i||!libtess.geom.vertEq(i,t))break;i=e.pq.extractMin(),libtess.sweep.spliceMergeVertices_(e,t.anEdge,i.anEdge)}libtess.sweep.sweepEvent_(e,t)}var n=e.dict.getMin().getKey();e.event=n.eUp.org,libtess.sweep.doneEdgeDict_(e),libtess.sweep.donePriorityQ_(e),libtess.sweep.removeDegenerateFaces_(e.mesh),e.mesh.checkMesh()},libtess.sweep.addWinding_=function(e,t){e.winding+=t.winding,e.sym.winding+=t.sym.winding},libtess.sweep.edgeLeq_=function(e,t,i){var n=e.event,r=t.eUp,s=i.eUp;return r.dst()===n?s.dst()===n?libtess.geom.vertLeq(r.org,s.org)?libtess.geom.edgeSign(s.dst(),r.org,s.org)<=0:libtess.geom.edgeSign(r.dst(),s.org,r.org)>=0:libtess.geom.edgeSign(s.dst(),n,s.org)<=0:s.dst()===n?libtess.geom.edgeSign(r.dst(),n,r.org)>=0:libtess.geom.edgeEval(r.dst(),n,r.org)>=libtess.geom.edgeEval(s.dst(),n,s.org)},libtess.sweep.deleteRegion_=function(e,t){t.fixUpperEdge,t.eUp.activeRegion=null,e.dict.deleteNode(t.nodeUp),t.nodeUp=null},libtess.sweep.fixUpperEdge_=function(e,t){libtess.mesh.deleteEdge(e.eUp),e.fixUpperEdge=!1,e.eUp=t,t.activeRegion=e},libtess.sweep.topLeftRegion_=function(e){var t=e.eUp.org;do e=e.regionAbove();while(e.eUp.org===t)if(e.fixUpperEdge){var i=libtess.mesh.connect(e.regionBelow().eUp.sym,e.eUp.lNext);libtess.sweep.fixUpperEdge_(e,i),e=e.regionAbove()}return e},libtess.sweep.topRightRegion_=function(e){var t=e.eUp.dst();do e=e.regionAbove();while(e.eUp.dst()===t)return e},libtess.sweep.addRegionBelow_=function(e,t,i){var n=new libtess.ActiveRegion;return n.eUp=i,n.nodeUp=e.dict.insertBefore(t.nodeUp,n),i.activeRegion=n,n},libtess.sweep.isWindingInside_=function(e,t){switch(e.windingRule){case libtess.windingRule.GLU_TESS_WINDING_ODD:return 0!=(1&t);case libtess.windingRule.GLU_TESS_WINDING_NONZERO:return 0!==t;case libtess.windingRule.GLU_TESS_WINDING_POSITIVE:return t>0;case libtess.windingRule.GLU_TESS_WINDING_NEGATIVE:return t<0;case libtess.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return t>=2||t<=-2}return!1},libtess.sweep.computeWinding_=function(e,t){t.windingNumber=t.regionAbove().windingNumber+t.eUp.winding,t.inside=libtess.sweep.isWindingInside_(e,t.windingNumber)},libtess.sweep.finishRegion_=function(e,t){var i=t.eUp,n=i.lFace;n.inside=t.inside,n.anEdge=i,libtess.sweep.deleteRegion_(e,t)},libtess.sweep.finishLeftRegions_=function(e,t,i){for(var n=t,r=t.eUp;n!==i;){n.fixUpperEdge=!1;var s=n.regionBelow(),o=s.eUp;if(o.org!==r.org){if(!s.fixUpperEdge){libtess.sweep.finishRegion_(e,n);break}o=libtess.mesh.connect(r.lPrev(),o.sym),libtess.sweep.fixUpperEdge_(s,o)}r.oNext!==o&&(libtess.mesh.meshSplice(o.oPrev(),o),libtess.mesh.meshSplice(r,o)),libtess.sweep.finishRegion_(e,n),r=s.eUp,n=s}return r},libtess.sweep.addRightEdges_=function(e,t,i,n,r,s){var o=!0,a=i;do libtess.sweep.addRegionBelow_(e,t,a.sym),a=a.oNext;while(a!==n)null===r&&(r=t.regionBelow().eUp.rPrev());for(var u,l=t,h=r;u=l.regionBelow(),a=u.eUp.sym,a.org===h.org;)a.oNext!==h&&(libtess.mesh.meshSplice(a.oPrev(),a),libtess.mesh.meshSplice(h.oPrev(),a)),u.windingNumber=l.windingNumber-a.winding,u.inside=libtess.sweep.isWindingInside_(e,u.windingNumber),l.dirty=!0,!o&&libtess.sweep.checkForRightSplice_(e,l)&&(libtess.sweep.addWinding_(a,h),libtess.sweep.deleteRegion_(e,l),libtess.mesh.deleteEdge(h)),o=!1,l=u,h=a;l.dirty=!0,s&&libtess.sweep.walkDirtyRegions_(e,l)},libtess.sweep.callCombine_=function(e,t,i,n,r){var s=[t.coords[0],t.coords[1],t.coords[2]];t.data=null,t.data=e.callCombineCallback(s,i,n),null===t.data&&(r?e.fatalError||(e.callErrorCallback(libtess.errorType.GLU_TESS_NEED_COMBINE_CALLBACK),e.fatalError=!0):t.data=i[0])},libtess.sweep.spliceMergeVertices_=function(e,t,i){var n=[null,null,null,null],r=[.5,.5,0,0];n[0]=t.org.data,n[1]=i.org.data,libtess.sweep.callCombine_(e,t.org,n,r,!1),libtess.mesh.meshSplice(t,i)},libtess.sweep.vertexWeights_=function(e,t,i,n,r){var s=libtess.geom.vertL1dist(t,e),o=libtess.geom.vertL1dist(i,e),a=r,u=r+1;n[a]=.5*o/(s+o),n[u]=.5*s/(s+o),e.coords[0]+=n[a]*t.coords[0]+n[u]*i.coords[0],e.coords[1]+=n[a]*t.coords[1]+n[u]*i.coords[1],e.coords[2]+=n[a]*t.coords[2]+n[u]*i.coords[2]},libtess.sweep.getIntersectData_=function(e,t,i,n,r,s){var o=[0,0,0,0],a=[i.data,n.data,r.data,s.data];t.coords[0]=t.coords[1]=t.coords[2]=0,libtess.sweep.vertexWeights_(t,i,n,o,0),libtess.sweep.vertexWeights_(t,r,s,o,2),libtess.sweep.callCombine_(e,t,a,o,!0)},libtess.sweep.checkForRightSplice_=function(e,t){var i=t.regionBelow(),n=t.eUp,r=i.eUp;if(libtess.geom.vertLeq(n.org,r.org)){if(libtess.geom.edgeSign(r.dst(),n.org,r.org)>0)return!1;libtess.geom.vertEq(n.org,r.org)?n.org!==r.org&&(e.pq.remove(n.org.pqHandle),libtess.sweep.spliceMergeVertices_(e,r.oPrev(),n)):(libtess.mesh.splitEdge(r.sym),libtess.mesh.meshSplice(n,r.oPrev()),t.dirty=i.dirty=!0)}else{if(libtess.geom.edgeSign(n.dst(),r.org,n.org)<0)return!1;t.regionAbove().dirty=t.dirty=!0,libtess.mesh.splitEdge(n.sym),libtess.mesh.meshSplice(r.oPrev(),n)}return!0},libtess.sweep.checkForLeftSplice_=function(e,t){var i,n=t.regionBelow(),r=t.eUp,s=n.eUp;if(libtess.geom.vertLeq(r.dst(),s.dst())){if(libtess.geom.edgeSign(r.dst(),s.dst(),r.org)<0)return!1;t.regionAbove().dirty=t.dirty=!0,i=libtess.mesh.splitEdge(r),libtess.mesh.meshSplice(s.sym,i),i.lFace.inside=t.inside}else{if(libtess.geom.edgeSign(s.dst(),r.dst(),s.org)>0)return!1;t.dirty=n.dirty=!0,i=libtess.mesh.splitEdge(s),libtess.mesh.meshSplice(r.lNext,s.sym),i.rFace().inside=t.inside}return!0},libtess.sweep.checkForIntersect_=function(e,t){var i=t.regionBelow(),n=t.eUp,r=i.eUp,s=n.org,o=r.org,a=n.dst(),u=r.dst(),l=new libtess.GluVertex;if(s===o)return!1;if(Math.min(s.t,a.t)>Math.max(o.t,u.t))return!1;if(libtess.geom.vertLeq(s,o)){if(libtess.geom.edgeSign(u,s,o)>0)return!1}else if(libtess.geom.edgeSign(a,o,s)<0)return!1;libtess.geom.edgeIntersect(a,s,u,o,l),libtess.geom.vertLeq(l,e.event)&&(l.s=e.event.s,l.t=e.event.t);var h=libtess.geom.vertLeq(s,o)?s:o;if(libtess.geom.vertLeq(h,l)&&(l.s=h.s,l.t=h.t),libtess.geom.vertEq(l,s)||libtess.geom.vertEq(l,o))return libtess.sweep.checkForRightSplice_(e,t),!1;if(!libtess.geom.vertEq(a,e.event)&&libtess.geom.edgeSign(a,e.event,l)>=0||!libtess.geom.vertEq(u,e.event)&&libtess.geom.edgeSign(u,e.event,l)<=0){if(u===e.event)return libtess.mesh.splitEdge(n.sym),libtess.mesh.meshSplice(r.sym,n),t=libtess.sweep.topLeftRegion_(t),n=t.regionBelow().eUp,libtess.sweep.finishLeftRegions_(e,t.regionBelow(),i),libtess.sweep.addRightEdges_(e,t,n.oPrev(),n,n,!0),!0;if(a===e.event){libtess.mesh.splitEdge(r.sym),libtess.mesh.meshSplice(n.lNext,r.oPrev()),i=t,t=libtess.sweep.topRightRegion_(t);var c=t.regionBelow().eUp.rPrev();return i.eUp=r.oPrev(),r=libtess.sweep.finishLeftRegions_(e,i,null),libtess.sweep.addRightEdges_(e,t,r.oNext,n.rPrev(),c,!0),!0}return libtess.geom.edgeSign(a,e.event,l)>=0&&(t.regionAbove().dirty=t.dirty=!0,libtess.mesh.splitEdge(n.sym),n.org.s=e.event.s,n.org.t=e.event.t),libtess.geom.edgeSign(u,e.event,l)<=0&&(t.dirty=i.dirty=!0,libtess.mesh.splitEdge(r.sym),r.org.s=e.event.s,r.org.t=e.event.t),!1}return libtess.mesh.splitEdge(n.sym),libtess.mesh.splitEdge(r.sym),libtess.mesh.meshSplice(r.oPrev(),n),n.org.s=l.s,n.org.t=l.t,n.org.pqHandle=e.pq.insert(n.org),libtess.sweep.getIntersectData_(e,n.org,s,a,o,u),t.regionAbove().dirty=t.dirty=i.dirty=!0,!1},libtess.sweep.walkDirtyRegions_=function(e,t){for(var i=t.regionBelow();;){for(;i.dirty;)t=i,i=i.regionBelow();if(!t.dirty&&(i=t,null===(t=t.regionAbove())||!t.dirty))return;t.dirty=!1;var n=t.eUp,r=i.eUp;if(n.dst()!==r.dst()&&libtess.sweep.checkForLeftSplice_(e,t)&&(i.fixUpperEdge?(libtess.sweep.deleteRegion_(e,i),libtess.mesh.deleteEdge(r),i=t.regionBelow(),r=i.eUp):t.fixUpperEdge&&(libtess.sweep.deleteRegion_(e,t),libtess.mesh.deleteEdge(n),t=i.regionAbove(),n=t.eUp)),n.org!==r.org)if(n.dst()===r.dst()||t.fixUpperEdge||i.fixUpperEdge||n.dst()!==e.event&&r.dst()!==e.event)libtess.sweep.checkForRightSplice_(e,t);else if(libtess.sweep.checkForIntersect_(e,t))return;n.org===r.org&&n.dst()===r.dst()&&(libtess.sweep.addWinding_(r,n),libtess.sweep.deleteRegion_(e,t),libtess.mesh.deleteEdge(n),t=i.regionAbove())}},libtess.sweep.connectRightVertex_=function(e,t,i){var n=i.oNext,r=t.regionBelow(),s=t.eUp,o=r.eUp,a=!1;if(s.dst()!==o.dst()&&libtess.sweep.checkForIntersect_(e,t),libtess.geom.vertEq(s.org,e.event)&&(libtess.mesh.meshSplice(n.oPrev(),s),t=libtess.sweep.topLeftRegion_(t),n=t.regionBelow().eUp,libtess.sweep.finishLeftRegions_(e,t.regionBelow(),r),a=!0),libtess.geom.vertEq(o.org,e.event)&&(libtess.mesh.meshSplice(i,o.oPrev()),i=libtess.sweep.finishLeftRegions_(e,r,null),a=!0),a)return void libtess.sweep.addRightEdges_(e,t,i.oNext,n,n,!0);var u;u=libtess.geom.vertLeq(o.org,s.org)?o.oPrev():s,u=libtess.mesh.connect(i.lPrev(),u),libtess.sweep.addRightEdges_(e,t,u,u.oNext,u.oNext,!1),u.sym.activeRegion.fixUpperEdge=!0,libtess.sweep.walkDirtyRegions_(e,t)},libtess.sweep.connectLeftDegenerate_=function(e,t,i){var n=t.eUp;if(libtess.geom.vertEq(n.org,i))return void(libtess.sweep.TOLERANCE_NONZERO_&&libtess.sweep.spliceMergeVertices_(e,n,i.anEdge));if(!libtess.geom.vertEq(n.dst(),i))return libtess.mesh.splitEdge(n.sym),t.fixUpperEdge&&(libtess.mesh.deleteEdge(n.oNext),t.fixUpperEdge=!1),libtess.mesh.meshSplice(i.anEdge,n),void libtess.sweep.sweepEvent_(e,i);if(libtess.sweep.TOLERANCE_NONZERO_){t=libtess.sweep.topRightRegion_(t);var r=t.regionBelow(),s=r.eUp.sym,o=s.oNext,a=o;r.fixUpperEdge&&(libtess.sweep.deleteRegion_(e,r),libtess.mesh.deleteEdge(s),s=o.oPrev()),libtess.mesh.meshSplice(i.anEdge,s),libtess.geom.edgeGoesLeft(o)||(o=null),libtess.sweep.addRightEdges_(e,t,s.oNext,a,o,!0)}},libtess.sweep.connectLeftVertex_=function(e,t){var i=new libtess.ActiveRegion;i.eUp=t.anEdge.sym;var n=e.dict.search(i).getKey(),r=n.regionBelow(),s=n.eUp,o=r.eUp;if(0===libtess.geom.edgeSign(s.dst(),t,s.org))return void libtess.sweep.connectLeftDegenerate_(e,n,t);var a,u=libtess.geom.vertLeq(o.dst(),s.dst())?n:r;if(n.inside||u.fixUpperEdge){if(u===n)a=libtess.mesh.connect(t.anEdge.sym,s.lNext);else{a=libtess.mesh.connect(o.dNext(),t.anEdge).sym}u.fixUpperEdge?libtess.sweep.fixUpperEdge_(u,a):libtess.sweep.computeWinding_(e,libtess.sweep.addRegionBelow_(e,n,a)),libtess.sweep.sweepEvent_(e,t)}else libtess.sweep.addRightEdges_(e,n,t.anEdge,t.anEdge,null,!0)},libtess.sweep.sweepEvent_=function(e,t){e.event=t;for(var i=t.anEdge;null===i.activeRegion;)if((i=i.oNext)===t.anEdge)return void libtess.sweep.connectLeftVertex_(e,t);var n=libtess.sweep.topLeftRegion_(i.activeRegion),r=n.regionBelow(),s=r.eUp,o=libtess.sweep.finishLeftRegions_(e,r,null);o.oNext===s?libtess.sweep.connectRightVertex_(e,n,o):libtess.sweep.addRightEdges_(e,n,o.oNext,s,s,!0)},libtess.sweep.addSentinel_=function(e,t){var i=new libtess.ActiveRegion,n=libtess.mesh.makeEdge(e.mesh);n.org.s=libtess.sweep.SENTINEL_COORD_,n.org.t=t,n.dst().s=-libtess.sweep.SENTINEL_COORD_,n.dst().t=t,e.event=n.dst(),i.eUp=n,i.windingNumber=0,i.inside=!1,i.fixUpperEdge=!1,i.sentinel=!0,i.dirty=!1,i.nodeUp=e.dict.insert(i)},libtess.sweep.initEdgeDict_=function(e){e.dict=new libtess.Dict(e,libtess.sweep.edgeLeq_),libtess.sweep.addSentinel_(e,-libtess.sweep.SENTINEL_COORD_),libtess.sweep.addSentinel_(e,libtess.sweep.SENTINEL_COORD_)},libtess.sweep.doneEdgeDict_=function(e){for(var t;null!==(t=e.dict.getMin().getKey());)t.sentinel,libtess.sweep.deleteRegion_(e,t);e.dict=null},libtess.sweep.removeDegenerateEdges_=function(e){for(var t,i=e.mesh.eHead,n=i.next;n!==i;n=t){t=n.next;var r=n.lNext;libtess.geom.vertEq(n.org,n.dst())&&n.lNext.lNext!==n&&(libtess.sweep.spliceMergeVertices_(e,r,n),libtess.mesh.deleteEdge(n),n=r,r=n.lNext),r.lNext===n&&(r!==n&&(r!==t&&r!==t.sym||(t=t.next),libtess.mesh.deleteEdge(r)),n!==t&&n!==t.sym||(t=t.next),libtess.mesh.deleteEdge(n))}},libtess.sweep.initPriorityQ_=function(e){var t=new libtess.PriorityQ;e.pq=t;var i,n=e.mesh.vHead;for(i=n.next;i!==n;i=i.next)i.pqHandle=t.insert(i);t.init()},libtess.sweep.donePriorityQ_=function(e){e.pq.deleteQ(),e.pq=null},libtess.sweep.removeDegenerateFaces_=function(e){for(var t,i=e.fHead.next;i!==e.fHead;i=t){t=i.next;var n=i.anEdge;n.lNext.lNext===n&&(libtess.sweep.addWinding_(n.oNext,n),libtess.mesh.deleteEdge(n))}},libtess.tessmono={},libtess.tessmono.tessellateMonoRegion_=function(e){for(var t=e.anEdge;libtess.geom.vertLeq(t.dst(),t.org);t=t.lPrev());for(;libtess.geom.vertLeq(t.org,t.dst());t=t.lNext);for(var i,n=t.lPrev();t.lNext!==n;)if(libtess.geom.vertLeq(t.dst(),n.org)){for(;n.lNext!==t&&(libtess.geom.edgeGoesLeft(n.lNext)||libtess.geom.edgeSign(n.org,n.dst(),n.lNext.dst())<=0);)i=libtess.mesh.connect(n.lNext,n),n=i.sym;n=n.lPrev()}else{for(;n.lNext!==t&&(libtess.geom.edgeGoesRight(t.lPrev())||libtess.geom.edgeSign(t.dst(),t.org,t.lPrev().org)>=0);)i=libtess.mesh.connect(t,t.lPrev()),t=i.sym;t=t.lNext}for(;n.lNext.lNext!==t;)i=libtess.mesh.connect(n.lNext,n),n=i.sym},libtess.tessmono.tessellateInterior=function(e){for(var t,i=e.fHead.next;i!==e.fHead;i=t)t=i.next,i.inside&&libtess.tessmono.tessellateMonoRegion_(i)},libtess.tessmono.discardExterior=function(e){for(var t,i=e.fHead.next;i!==e.fHead;i=t)t=i.next,i.inside||libtess.mesh.zapFace(i)},libtess.tessmono.setWindingNumber=function(e,t,i){for(var n,r=e.eHead.next;r!==e.eHead;r=n)n=r.next,r.rFace().inside!==r.lFace.inside?r.winding=r.lFace.inside?t:-t:i?libtess.mesh.deleteEdge(r):r.winding=0},libtess.Dict=function(e,t){this.head_=new libtess.DictNode,this.frame_=e,this.leq_=t},libtess.Dict.prototype.deleteDict_=function(){},libtess.Dict.prototype.insertBefore=function(e,t){do e=e.prev;while(null!==e.key&&!this.leq_(this.frame_,e.key,t))var i=new libtess.DictNode(t,e.next,e);return e.next.prev=i,e.next=i,i},libtess.Dict.prototype.insert=function(e){return this.insertBefore(this.head_,e)},libtess.Dict.prototype.deleteNode=function(e){e.next.prev=e.prev,e.prev.next=e.next},libtess.Dict.prototype.search=function(e){var t=this.head_;do t=t.next;while(null!==t.key&&!this.leq_(this.frame_,e,t.key))return t},libtess.Dict.prototype.getMin=function(){return this.head_.next},libtess.Dict.prototype.getMax=function(){return this.head_.prev},libtess.DictNode=function(e,t,i){this.key=e||null,this.next=t||this,this.prev=i||this},libtess.DictNode.prototype.getKey=function(){return this.key},libtess.DictNode.prototype.getSuccessor=function(){return this.next},libtess.DictNode.prototype.getPredecessor=function(){return this.prev},libtess.GluTesselator=function(){this.state_=libtess.GluTesselator.tessState_.T_DORMANT,this.lastEdge_=null,this.mesh=null,this.errorCallback_=null,this.normal_=[0,0,0],this.windingRule=libtess.windingRule.GLU_TESS_WINDING_ODD,this.fatalError=!1,this.dict=null,this.pq=null,this.event=null,this.combineCallback_=null,this.boundaryOnly_=!1,this.beginCallback_=null,this.edgeFlagCallback_=null,this.vertexCallback_=null,this.endCallback_=null,this.meshCallback_=null,this.polygonData_=null},libtess.GluTesselator.tessState_={T_DORMANT:0,T_IN_POLYGON:1,T_IN_CONTOUR:2},libtess.GluTesselator.prototype.gluDeleteTess=function(){this.requireState_(libtess.GluTesselator.tessState_.T_DORMANT)},libtess.GluTesselator.prototype.gluTessProperty=function(e,t){switch(e){case libtess.gluEnum.GLU_TESS_TOLERANCE:return;case libtess.gluEnum.GLU_TESS_WINDING_RULE:var i=t;switch(i){case libtess.windingRule.GLU_TESS_WINDING_ODD:case libtess.windingRule.GLU_TESS_WINDING_NONZERO:case libtess.windingRule.GLU_TESS_WINDING_POSITIVE:case libtess.windingRule.GLU_TESS_WINDING_NEGATIVE:case libtess.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return void(this.windingRule=i)}break;case libtess.gluEnum.GLU_TESS_BOUNDARY_ONLY:return void(this.boundaryOnly_=!!t);default:return void this.callErrorCallback(libtess.gluEnum.GLU_INVALID_ENUM)}this.callErrorCallback(libtess.gluEnum.GLU_INVALID_VALUE)},libtess.GluTesselator.prototype.gluGetTessProperty=function(e){switch(e){case libtess.gluEnum.GLU_TESS_TOLERANCE:return 0;case libtess.gluEnum.GLU_TESS_WINDING_RULE:return this.windingRule;case libtess.gluEnum.GLU_TESS_BOUNDARY_ONLY:return this.boundaryOnly_;default:this.callErrorCallback(libtess.gluEnum.GLU_INVALID_ENUM)}return!1},libtess.GluTesselator.prototype.gluTessNormal=function(e,t,i){this.normal_[0]=e,this.normal_[1]=t,this.normal_[2]=i},libtess.GluTesselator.prototype.gluTessCallback=function(e,t){var i=t?t:null;switch(e){case libtess.gluEnum.GLU_TESS_BEGIN:case libtess.gluEnum.GLU_TESS_BEGIN_DATA:return void(this.beginCallback_=i);case libtess.gluEnum.GLU_TESS_EDGE_FLAG:case libtess.gluEnum.GLU_TESS_EDGE_FLAG_DATA:return void(this.edgeFlagCallback_=i);case libtess.gluEnum.GLU_TESS_VERTEX:case libtess.gluEnum.GLU_TESS_VERTEX_DATA:return void(this.vertexCallback_=i);case libtess.gluEnum.GLU_TESS_END:case libtess.gluEnum.GLU_TESS_END_DATA:return void(this.endCallback_=i);case libtess.gluEnum.GLU_TESS_ERROR:case libtess.gluEnum.GLU_TESS_ERROR_DATA:return void(this.errorCallback_=i);case libtess.gluEnum.GLU_TESS_COMBINE:case libtess.gluEnum.GLU_TESS_COMBINE_DATA:return void(this.combineCallback_=i);case libtess.gluEnum.GLU_TESS_MESH:return void(this.meshCallback_=i);default:return void this.callErrorCallback(libtess.gluEnum.GLU_INVALID_ENUM)}},libtess.GluTesselator.prototype.gluTessVertex=function(e,t){var i=!1,n=[0,0,0];this.requireState_(libtess.GluTesselator.tessState_.T_IN_CONTOUR);for(var r=0;r<3;++r){var s=e[r];s<-libtess.GLU_TESS_MAX_COORD&&(s=-libtess.GLU_TESS_MAX_COORD,i=!0),s>libtess.GLU_TESS_MAX_COORD&&(s=libtess.GLU_TESS_MAX_COORD,i=!0),n[r]=s}i&&this.callErrorCallback(libtess.errorType.GLU_TESS_COORD_TOO_LARGE),this.addVertex_(n,t)},libtess.GluTesselator.prototype.gluTessBeginPolygon=function(e){this.requireState_(libtess.GluTesselator.tessState_.T_DORMANT),this.state_=libtess.GluTesselator.tessState_.T_IN_POLYGON,this.mesh=new libtess.GluMesh,this.polygonData_=e},libtess.GluTesselator.prototype.gluTessBeginContour=function(){this.requireState_(libtess.GluTesselator.tessState_.T_IN_POLYGON),this.state_=libtess.GluTesselator.tessState_.T_IN_CONTOUR,this.lastEdge_=null},libtess.GluTesselator.prototype.gluTessEndContour=function(){this.requireState_(libtess.GluTesselator.tessState_.T_IN_CONTOUR),this.state_=libtess.GluTesselator.tessState_.T_IN_POLYGON},libtess.GluTesselator.prototype.gluTessEndPolygon=function(){if(this.requireState_(libtess.GluTesselator.tessState_.T_IN_POLYGON),this.state_=libtess.GluTesselator.tessState_.T_DORMANT,libtess.normal.projectPolygon(this,this.normal_[0],this.normal_[1],this.normal_[2]),libtess.sweep.computeInterior(this),!this.fatalError){var e=this.mesh;if(this.boundaryOnly_?libtess.tessmono.setWindingNumber(e,1,!0):libtess.tessmono.tessellateInterior(e),this.mesh.checkMesh(),this.beginCallback_||this.endCallback_||this.vertexCallback_||this.edgeFlagCallback_)if(this.boundaryOnly_)libtess.render.renderBoundary(this,this.mesh);else{var t=!!this.edgeFlagCallback_;libtess.render.renderMesh(this,this.mesh,t)}if(this.meshCallback_)return libtess.tessmono.discardExterior(this.mesh),this.meshCallback_(this.mesh),this.mesh=null,void(this.polygonData_=null)}libtess.mesh.deleteMesh(this.mesh),this.polygonData_=null,this.mesh=null},libtess.GluTesselator.prototype.requireState_=function(e){this.state_!==e&&this.gotoState_(e)},libtess.GluTesselator.prototype.gotoState_=function(e){for(;this.state_!==e;)if(this.state_<e)switch(this.state_){case libtess.GluTesselator.tessState_.T_DORMANT:this.callErrorCallback(libtess.errorType.GLU_TESS_MISSING_BEGIN_POLYGON),this.gluTessBeginPolygon(null);break;case libtess.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(libtess.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR),this.gluTessBeginContour()}else switch(this.state_){case libtess.GluTesselator.tessState_.T_IN_CONTOUR:this.callErrorCallback(libtess.errorType.GLU_TESS_MISSING_END_CONTOUR),this.gluTessEndContour();break;case libtess.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(libtess.errorType.GLU_TESS_MISSING_END_POLYGON),this.gluTessEndPolygon()}},libtess.GluTesselator.prototype.addVertex_=function(e,t){var i=this.lastEdge_;null===i?(i=libtess.mesh.makeEdge(this.mesh),libtess.mesh.meshSplice(i,i.sym)):(libtess.mesh.splitEdge(i),i=i.lNext),i.org.data=t,i.org.coords[0]=e[0],i.org.coords[1]=e[1],i.org.coords[2]=e[2],i.winding=1,i.sym.winding=-1,this.lastEdge_=i},libtess.GluTesselator.prototype.callBeginCallback=function(e){this.beginCallback_&&this.beginCallback_(e,this.polygonData_)},libtess.GluTesselator.prototype.callVertexCallback=function(e){this.vertexCallback_&&this.vertexCallback_(e,this.polygonData_)},libtess.GluTesselator.prototype.callEdgeFlagCallback=function(e){this.edgeFlagCallback_&&this.edgeFlagCallback_(e,this.polygonData_)},libtess.GluTesselator.prototype.callEndCallback=function(){this.endCallback_&&this.endCallback_(this.polygonData_)},libtess.GluTesselator.prototype.callCombineCallback=function(e,t,i){return this.combineCallback_?this.combineCallback_(e,t,i,this.polygonData_)||null:null},libtess.GluTesselator.prototype.callErrorCallback=function(e){this.errorCallback_&&this.errorCallback_(e,this.polygonData_)},libtess.GluFace=function(e,t){this.next=e||this,this.prev=t||this,this.anEdge=null,this.data=null,this.inside=!1},libtess.GluHalfEdge=function(e){this.next=e||this,this.sym=null,this.oNext=null,this.lNext=null,this.org=null,this.lFace=null,this.activeRegion=null,this.winding=0},libtess.GluHalfEdge.prototype.rFace=function(){return this.sym.lFace},libtess.GluHalfEdge.prototype.dst=function(){return this.sym.org},libtess.GluHalfEdge.prototype.oPrev=function(){return this.sym.lNext},libtess.GluHalfEdge.prototype.lPrev=function(){return this.oNext.sym},libtess.GluHalfEdge.prototype.dPrev=function(){return this.lNext.sym},libtess.GluHalfEdge.prototype.rPrev=function(){return this.sym.oNext},libtess.GluHalfEdge.prototype.dNext=function(){return this.rPrev().sym},libtess.GluHalfEdge.prototype.rNext=function(){return this.oPrev().sym},libtess.GluMesh=function(){this.vHead=new libtess.GluVertex,this.fHead=new libtess.GluFace,this.eHead=new libtess.GluHalfEdge,this.eHeadSym=new libtess.GluHalfEdge,this.eHead.sym=this.eHeadSym,this.eHeadSym.sym=this.eHead},libtess.GluMesh.prototype.checkMesh=function(){if(libtess.DEBUG){var e,t,i=this.fHead,n=this.vHead,r=this.eHead,s=i;for(s=i;(t=s.next)!==i;s=t){e=t.anEdge;do e=e.lNext;while(e!==t.anEdge)}var o,a=n;for(a=n;(o=a.next)!==n;a=o){e=o.anEdge;do e=e.oNext;while(e!==o.anEdge)}var u=r;for(u=r;(e=u.next)!==r;u=e);}},libtess.GluVertex=function(e,t){this.next=e||this,this.prev=t||this,this.anEdge=null,this.data=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0},libtess.PriorityQ=function(){this.verts_=[],this.order_=null,this.size_=0,this.initialized_=!1,this.heap_=new libtess.PriorityQHeap},libtess.PriorityQ.prototype.deleteQ=function(){this.heap_=null,this.order_=null,this.verts_=null},libtess.PriorityQ.prototype.init=function(){this.order_=[];for(var e=0;e<this.size_;e++)this.order_[e]=e;var t=function(e){return function(t,i){return libtess.geom.vertLeq(e[t],e[i])?1:-1}}(this.verts_);if(this.order_.sort(t),this.initialized_=!0,this.heap_.init(),libtess.DEBUG){var i=0+this.size_-1;for(e=0;e<i;++e);}},libtess.PriorityQ.prototype.insert=function(e){if(this.initialized_)return this.heap_.insert(e);var t=this.size_++;return this.verts_[t]=e,-(t+1)},libtess.PriorityQ.prototype.extractMin=function(){if(0===this.size_)return this.heap_.extractMin();var e=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var t=this.heap_.minimum();if(libtess.geom.vertLeq(t,e))return this.heap_.extractMin()}do--this.size_;while(this.size_>0&&null===this.verts_[this.order_[this.size_-1]])return e},libtess.PriorityQ.prototype.minimum=function(){if(0===this.size_)return this.heap_.minimum();var e=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var t=this.heap_.minimum();if(libtess.geom.vertLeq(t,e))return t}return e},libtess.PriorityQ.prototype.remove=function(e){if(e>=0)return void this.heap_.remove(e);for(e=-(e+1),this.verts_[e]=null;this.size_>0&&null===this.verts_[this.order_[this.size_-1]];)--this.size_},libtess.PriorityQHeap=function(){this.heap_=libtess.PriorityQHeap.reallocNumeric_([0],libtess.PriorityQHeap.INIT_SIZE_+1),this.verts_=[null,null],this.handles_=[0,0],this.size_=0,this.max_=libtess.PriorityQHeap.INIT_SIZE_,this.freeList_=0,this.initialized_=!1,this.heap_[1]=1},libtess.PriorityQHeap.INIT_SIZE_=32,libtess.PriorityQHeap.reallocNumeric_=function(e,t){for(var i=new Array(t),n=0;n<e.length;n++)i[n]=e[n];for(;n<t;n++)i[n]=0;return i},libtess.PriorityQHeap.prototype.init=function(){for(var e=this.size_;e>=1;--e)this.floatDown_(e);this.initialized_=!0},libtess.PriorityQHeap.prototype.insert=function(e){var t=++this.size_;2*t>this.max_&&(this.max_*=2,this.handles_=libtess.PriorityQHeap.reallocNumeric_(this.handles_,this.max_+1));var i;return 0===this.freeList_?i=t:(i=this.freeList_,this.freeList_=this.handles_[this.freeList_]),this.verts_[i]=e,this.handles_[i]=t,this.heap_[t]=i,this.initialized_&&this.floatUp_(t),i},libtess.PriorityQHeap.prototype.isEmpty=function(){return 0===this.size_},libtess.PriorityQHeap.prototype.minimum=function(){return this.verts_[this.heap_[1]]},libtess.PriorityQHeap.prototype.extractMin=function(){var e=this.heap_,t=this.verts_,i=this.handles_,n=e[1],r=t[n];return this.size_>0&&(e[1]=e[this.size_],i[e[1]]=1,t[n]=null,i[n]=this.freeList_,this.freeList_=n,--this.size_>0&&this.floatDown_(1)),r},libtess.PriorityQHeap.prototype.remove=function(e){var t=this.heap_,i=this.verts_,n=this.handles_,r=n[e];if(t[r]=t[this.size_],n[t[r]]=r,r<=--this.size_)if(r<=1)this.floatDown_(r);else{var s=i[t[r]],o=i[t[r>>1]];libtess.geom.vertLeq(o,s)?this.floatDown_(r):this.floatUp_(r)}i[e]=null,n[e]=this.freeList_,this.freeList_=e},libtess.PriorityQHeap.prototype.floatDown_=function(e){for(var t=this.heap_,i=this.verts_,n=this.handles_,r=e,s=t[r];;){var o=r<<1;o<this.size_&&libtess.geom.vertLeq(i[t[o+1]],i[t[o]])&&(o+=1);var a=t[o];if(o>this.size_||libtess.geom.vertLeq(i[s],i[a]))return t[r]=s,void(n[s]=r);t[r]=a,n[a]=r,r=o}},libtess.PriorityQHeap.prototype.floatUp_=function(e){for(var t=this.heap_,i=this.verts_,n=this.handles_,r=e,s=t[r];;){var o=r>>1,a=t[o];if(0===o||libtess.geom.vertLeq(i[a],i[s]))return t[r]=s,void(n[s]=r);t[r]=a,n[a]=r,r=o}},libtess.ActiveRegion=function(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1},libtess.ActiveRegion.prototype.regionBelow=function(){return this.nodeUp.getPredecessor().getKey()},libtess.ActiveRegion.prototype.regionAbove=function(){return this.nodeUp.getSuccessor().getKey()},"undefined"!=typeof module&&(module.exports=libtess),define("libtess",["libtess/libtess.cat"],function(e){return e}),define("libtess/libtess.cat",function(){}),define("standard/Math/Geometry/Triangle3",["standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","libtess"],function(e,t){"use strict";return{area:function(){var t=new e(0,0,0),i=new e(0,0,0);return function(e,n,r){return t.assign(n).subtract(e).cross(i.assign(r).subtract(e)).abs()/2}}(),normal:function(e,t,i,n){var r=i.x-t.x,s=i.y-t.y,o=i.z-t.z,a=e.x-t.x,u=e.y-t.y,l=e.z-t.z;return n.set(s*l-o*u,o*a-r*l,r*u-s*a),n.normalize()},quadNormal:function(e,t,i,n,r){var s=i.x-e.x,o=i.y-e.y,a=i.z-e.z,u=n.x-t.x,l=n.y-t.y,h=n.z-t.z;return r.set(o*h-a*l,a*u-s*h,s*l-o*u),r.normalize()},triangulatePolygon:function(){var e=function(){function e(e,t){t[t.length]=e}function t(e){e!==libtess.primitiveType.GL_TRIANGLES&&console.log("expected TRIANGLES but got type: "+e)}function i(e){console.log("error callback"),console.log("error number: "+e)}function n(e,t,i){return t[0]}function r(e){}var s=new libtess.GluTesselator;return s.gluTessCallback(libtess.gluEnum.GLU_TESS_VERTEX_DATA,e),s.gluTessCallback(libtess.gluEnum.GLU_TESS_BEGIN,t),s.gluTessCallback(libtess.gluEnum.GLU_TESS_ERROR,i),s.gluTessCallback(libtess.gluEnum.GLU_TESS_COMBINE,n),s.gluTessCallback(libtess.gluEnum.GLU_TESS_EDGE_FLAG,r),s.gluTessProperty(libtess.gluEnum.GLU_TESS_TOLERANCE,0),s.gluTessProperty(libtess.gluEnum.GLU_TESS_WINDING_RULE,libtess.windingRule.GLU_TESS_WINDING_ODD),s}();return function(){var t=arguments[arguments.length-1];e.gluTessBeginPolygon(t);for(var i=0,n=arguments.length-1;i<n;++i){e.gluTessBeginContour();for(var r=arguments[i],s=0;s<r.length;++s)e.gluTessVertex(r[s],r[s]);e.gluTessEndContour()}return e.gluTessEndPolygon(),t}}(),triangulateConvexPolygon:function(e,t){for(var i=1,n=e.length-1;i<n;++i)t.push(e[0],e[i],e[i+1])},getPolygonNormal:function(e,t){t.set(0,0,0);for(var i=e[0],n=0,r=e.length;n<r;++n){var s=i,i=e[(n+1)%r];t.x+=(s.y-i.y)*(s.z+i.z),t.y+=(s.z-i.z)*(s.x+i.x),t.z+=(s.x-i.x)*(s.y+i.y)}return t.normalize()}}}),define("standard/Math/Geometry/ViewVolume",["standard/Math/Geometry/Line3","standard/Math/Geometry/Plane3","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r,s){"use strict";function o(){this.viewport=new r(0,0,0,0),this.scissor=new r(0,0,0,0),this.planes=[new t(n.Zero,n.Zero),new t(n.Zero,n.Zero),new t(n.Zero,n.Zero),new t(n.Zero,n.Zero),new t(n.Zero,n.Zero),new t(n.Zero,n.Zero)]}var a=new n(0,0,0),u=new n(0,0,0),l=new n(0,0,0),h=new n(0,0,0),c=new n(0,0,0),d=new n(0,0,0),p=new n(0,0,0),f=new n(0,0,0),g=new s,m=new n(0,0,0),_=new r(0,0,0,0);return o.prototype={constructor:o,set:function(e,t,n){try{this.viewport.assign(t),this.scissor.assign(n);var r=n[0],s=n[0]+n[2],p=n[1],f=n[1]+n[3];g.assign(e).inverse(),o.unProjectPointMatrix(r,f,1,g,t,a),o.unProjectPointMatrix(r,p,1,g,t,u),o.unProjectPointMatrix(r,p,0,g,t,l),o.unProjectPointMatrix(s,p,0,g,t,h),o.unProjectPointMatrix(s,f,0,g,t,c),o.unProjectPointMatrix(s,f,1,g,t,d),this.planes[0].set(h,i.normal(l,h,c,m)),this.planes[1].set(u,i.normal(a,u,l,m)),this.planes[2].set(c,i.normal(d,c,h,m)),this.planes[3].set(d,i.normal(c,d,a,m)),this.planes[4].set(l,i.normal(h,l,u,m)),this.planes[5].set(a,i.normal(u,a,d,m)),this.valid=!0}catch(e){this.valid=!1,console.log(e)}return this},getViewport:function(){return this.viewport},getScissor:function(){return this.scissor},intersectsSphere:function(e,t){var i=this.planes;return!(i[0].getDistanceToPoint(t)>e)&&(!(i[1].getDistanceToPoint(t)>e)&&(!(i[2].getDistanceToPoint(t)>e)&&(!(i[3].getDistanceToPoint(t)>e)&&(!(i[4].getDistanceToPoint(t)>e)&&!(i[5].getDistanceToPoint(t)>e)))))}},Object.assign(o,{unProjectPoint:function(e,t,i,n,r,s,o){return g.assign(n).multRight(r).inverse(),this.unProjectPointMatrix(e,t,i,g,s,o)},unProjectPointMatrix:function(e,t,i,n,r,s){if(_.set((e-r[0])/r[2]*2-1,(t-r[1])/r[3]*2-1,2*i-1,1),n.multVecMatrix(_),0===_.w)throw new Error("Couldn't unproject point: divisor is 0.");var o=1/_.w;return s.set(_.x*o,_.y*o,_.z*o)},unProjectRay:function(e,t,i,n,r,s){return g.assign(i).multRight(n).inverse(),o.unProjectPointMatrix(e,t,0,g,r,p),o.unProjectPointMatrix(e,t,.9,g,r,f),s.setPoints(p,f)},projectPoint:function(e,t,i,n,r){if(_.set(e.x,e.y,e.z,1),i.multVecMatrix(t.multVecMatrix(_)),0===_.w)throw new Error("Couldn't project point: divisor is 0.");var s=1/(2*_.w);return r.set((_.x*s+.5)*n[2]+n[0],(_.y*s+.5)*n[3]+n[1],_.z*s+.5)},projectLine:function(e,t,i,r,s){return o.projectPoint(e.point,t,i,r,p),o.projectPoint(n.multiply(e.direction,1e9).add(e.point),t,i,r,f),p.z=0,f.z=0,s.setPoints(p,f)}}),o}),define("x_ite/Rendering/TextureBuffer",["standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(e,t,i){"use strict";function n(e,t,i){var n=e.getContext();this.browser=e,this.width=t,this.height=i,this.array=new Uint8Array(t*i*4),this.lastBuffer=n.getParameter(n.FRAMEBUFFER_BINDING),this.buffer=n.createFramebuffer(),n.bindFramebuffer(n.FRAMEBUFFER,this.buffer),
this.colorTexture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.colorTexture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t,i,0,n.RGBA,n.UNSIGNED_BYTE,null),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.colorTexture,0),e.getExtension("WEBGL_depth_texture")?(this.depthTexture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.depthTexture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texImage2D(n.TEXTURE_2D,0,n.DEPTH_COMPONENT,t,i,0,n.DEPTH_COMPONENT,n.UNSIGNED_INT,null),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,this.depthTexture,0)):(this.depthBuffer=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,this.depthBuffer),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,t,i),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,this.depthBuffer));var r=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;if(n.bindFramebuffer(n.FRAMEBUFFER,this.lastBuffer),!r)throw new Error("Couldn't create frame buffer.")}return n.prototype={constructor:n,getWidth:function(){return this.width},getHeight:function(){return this.height},getColorTexture:function(){return this.colorTexture},getDepthTexture:function(){return this.depthTexture},readPixels:function(){var e=this.browser.getContext(),t=this.array,i=this.width,n=this.height;return e.readPixels(0,0,i,n,e.RGBA,e.UNSIGNED_BYTE,t),t},getDepth:function(){var n=new i,r=new t(0,0,0);return function(t,i){try{var s=this.browser.getContext(),o=this.array,a=this.width,u=this.height,l=0,h=0,c=Number.POSITIVE_INFINITY;n.assign(t).inverse(),s.readPixels(0,0,a,u,s.RGBA,s.UNSIGNED_BYTE,o);for(var d=0,p=0;d<u;++d)for(var f=0;f<a;++f,p+=4){var g=o[p]/255+o[p+1]/65025+o[p+2]/16581375+o[p+3]/4228250625;g<c&&(l=f,h=d,c=g)}return e.unProjectPointMatrix(l,h,c,n,i,r),r.z}catch(e){return 0}}}(),bind:function(){var e=this.browser.getContext();this.lastBuffer=e.getParameter(e.FRAMEBUFFER_BINDING),e.bindFramebuffer(e.FRAMEBUFFER,this.buffer)},unbind:function(){var e=this.browser.getContext();e.bindFramebuffer(e.FRAMEBUFFER,this.lastBuffer)}},n}),define("x_ite/Browser/Shaders/ShaderTest",["x_ite/Rendering/TextureBuffer","standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Camera"],function(e,t,i,n,r){"use strict";function s(t,s){var u=t.getContext(),l=new e(t,16,16),h=u.createBuffer(),c=u.createBuffer();l.bind(),s.enable(u),u.viewport(0,0,16,16),u.bindBuffer(u.ARRAY_BUFFER,c),u.bufferData(u.ARRAY_BUFFER,new Float32Array(a),u.STATIC_DRAW),u.bindBuffer(u.ARRAY_BUFFER,h),u.bufferData(u.ARRAY_BUFFER,new Float32Array(o),u.STATIC_DRAW),s.setShaderObjects(u,[]),u.uniform1i(s.x3d_FogType,0),u.uniform1i(s.x3d_ColorMaterial,!1),u.uniform1i(s.x3d_Lighting,!0),u.uniform1i(s.x3d_SeparateBackColor,!1),u.uniform1f(s.x3d_AmbientIntensity,0),u.uniform3f(s.x3d_DiffuseColor,1,0,0),u.uniform3f(s.x3d_SpecularColor,1,0,0),u.uniform3f(s.x3d_EmissiveColor,1,0,0),u.uniform1f(s.x3d_Shininess,0),u.uniform1f(s.x3d_Transparency,0),s.textureTypeArray[0]=0,u.uniform1iv(s.x3d_TextureType,s.textureTypeArray),u.uniformMatrix4fv(s.x3d_ProjectionMatrix,!1,new Float32Array(r.ortho(-1,1,-1,1,-1,1,new n))),u.uniformMatrix4fv(s.x3d_ModelViewMatrix,!1,new Float32Array(new n)),u.uniformMatrix3fv(s.x3d_NormalMatrix,!1,new Float32Array(new i)),u.disable(u.BLEND),u.frontFace(u.CCW),u.enable(u.CULL_FACE),u.cullFace(u.BACK),s.enableNormalAttribute(u,h),s.enableVertexAttribute(u,c),u.drawArrays(u.TRIANGLES,0,6);var d=l.readPixels();return l.unbind(),s.disableNormalAttribute(u,h),s.disable(u),255==d[0]&&0==d[1]&&0==d[2]&&255==d[3]}var o=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1],a=[2,2,0,1,-2,2,0,1,-2,-2,0,1,2,2,0,1,-2,-2,0,1,2,-2,0,1];return s}),function(e,t){"function"==typeof define&&define.amd?define("ResizeSensor/src/ResizeSensor",t):"object"==typeof exports?module.exports=t():e.ResizeSensor=t()}("undefined"!=typeof window?window:this,function(){function e(e,t){var i=Object.prototype.toString.call(e),n="[object Array]"===i||"[object NodeList]"===i||"[object HTMLCollection]"===i||"[object Object]"===i||"undefined"!=typeof jQuery&&e instanceof jQuery||"undefined"!=typeof Elements&&e instanceof Elements,r=0,s=e.length;if(n)for(;r<s;r++)t(e[r]);else t(e)}function t(e){if(!e.getBoundingClientRect)return{width:e.offsetWidth,height:e.offsetHeight};var t=e.getBoundingClientRect();return{width:Math.round(t.width),height:Math.round(t.height)}}if("undefined"==typeof window)return null;var i=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){return window.setTimeout(e,20)},n=function(r,s){function o(){var e=[];this.add=function(t){e.push(t)};var t,i;this.call=function(){for(t=0,i=e.length;t<i;t++)e[t].call()},this.remove=function(n){var r=[];for(t=0,i=e.length;t<i;t++)e[t]!==n&&r.push(e[t]);e=r},this.length=function(){return e.length}}function a(e,n){if(e){if(e.resizedAttached)return void e.resizedAttached.add(n);e.resizedAttached=new o,e.resizedAttached.add(n),e.resizeSensor=document.createElement("div"),e.resizeSensor.dir="ltr",e.resizeSensor.className="resize-sensor";var r="position: absolute; left: -10px; top: -10px; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;",s="position: absolute; left: 0; top: 0; transition: 0s;";e.resizeSensor.style.cssText=r,e.resizeSensor.innerHTML='<div class="resize-sensor-expand" style="'+r+'"><div style="'+s+'"></div></div><div class="resize-sensor-shrink" style="'+r+'"><div style="'+s+' width: 200%; height: 200%"></div></div>',e.appendChild(e.resizeSensor);var a=window.getComputedStyle(e).getPropertyValue("position");"absolute"!==a&&"relative"!==a&&"fixed"!==a&&(e.style.position="relative");var u,l,h=e.resizeSensor.childNodes[0],c=h.childNodes[0],d=e.resizeSensor.childNodes[1],p=t(e),f=p.width,g=p.height,m=function(){var t=0===e.offsetWidth&&0===e.offsetHeight;if(t){var i=e.style.display;e.style.display="block"}c.style.width="100000px",c.style.height="100000px",h.scrollLeft=1e5,h.scrollTop=1e5,d.scrollLeft=1e5,d.scrollTop=1e5,t&&(e.style.display=i)};e.resizeSensor.resetSensor=m;var _=function(){l=0,u&&(f=void 0,g=void 0,e.resizedAttached&&e.resizedAttached.call())},x=function(){var n=t(e),r=n.width,s=n.height;u=r!=f||s!=g,u&&!l&&(l=i(_)),m()},y=function(e,t,i){e.attachEvent?e.attachEvent("on"+t,i):e.addEventListener(t,i)};y(h,"scroll",x),y(d,"scroll",x),i(m)}}e(r,function(e){a(e,s)}),this.detach=function(e){n.detach(r,e)},this.reset=function(){r.resizeSensor.resetSensor()}};return n.reset=function(t,i){e(t,function(e){e.resizeSensor.resetSensor()})},n.detach=function(t,i){e(t,function(e){e&&(e.resizedAttached&&"function"==typeof i&&(e.resizedAttached.remove(i),e.resizedAttached.length())||e.resizeSensor&&(e.contains(e.resizeSensor)&&e.removeChild(e.resizeSensor),delete e.resizeSensor,delete e.resizedAttached))})},n}),define("ResizeSensor",["ResizeSensor/src/ResizeSensor"],function(e){return e}),define("x_ite/Browser/Rendering/X3DRenderingContext",["jquery","x_ite/Fields","x_ite/Browser/Core/Shading","x_ite/Components/Shaders/ComposedShader","x_ite/Components/Shaders/ShaderPart","text!x_ite/Browser/Shaders/PointSet.fs","text!x_ite/Browser/Shaders/Wireframe.vs","text!x_ite/Browser/Shaders/Wireframe.fs","text!x_ite/Browser/Shaders/Gouraud.vs","text!x_ite/Browser/Shaders/Gouraud.fs","text!x_ite/Browser/Shaders/Phong.vs","text!x_ite/Browser/Shaders/Phong.fs","text!x_ite/Browser/Shaders/Depth.vs","text!x_ite/Browser/Shaders/Depth.fs","x_ite/Browser/Shaders/ShaderTest","standard/Math/Numbers/Vector4","ResizeSensor"],function(e,t,i,n,r,s,o,a,u,l,h,c,d,p,f,g,m){"use strict";function _(){this.addChildObjects("viewport",new t.MFInt32(0,0,300,150)),this.clipPlanes=[]}return _.prototype={initialize:function(){var t=this.getContext();t.enable(t.SCISSOR_TEST),t.cullFace(t.BACK),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.clearDepth(1),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.enable(t.BLEND),e(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",this.onfullscreen.bind(this)),this.resizer=new m(this.getSurface(),this.reshape.bind(this)),this.reshape(),this.depthShader=this.createShader(this,"DepthShader",d,p,!1),this.pointShader=this.createShader(this,"PointShader",o,s,!1),this.lineShader=this.createShader(this,"WireframeShader",o,a,!1),this.gouraudShader=this.createShader(this,"GouraudShader",u,l,!1),this.phongShader=this.createShader(this,"PhongShader",h,c,!1),this.shadowShader=this.createShader(this,"ShadowShader",h,c,!0),this.pointShader.setGeometryType(0),this.lineShader.setGeometryType(1),this.pointShader.shadowShader=this.pointShader,this.lineShader.shadowShader=this.lineShader,this.gouraudShader.shadowShader=this.shadowShader,this.phongShader.shadowShader=this.shadowShader,this.setShading(i.GOURAUD),this.phongShader.isValid_.addInterest("set_phong_shader_valid__",this),this.shadowShader.isValid_.addInterest("set_shadow_shader_valid__",this)},set_phong_shader_valid__:function(e){e.getValue()&&f(this,this.phongShader)||(console.warn("X_ITE: Phong shading is not available, using Gouraud shading."),this.phongShader=this.gouraudShader)},set_shadow_shader_valid__:function(e){e.getValue()&&f(this,this.shadowShader)||(console.warn("X_ITE: Shadow shading is not available, using Gouraud shading."),this.shadowShader=this.gouraudShader)},getVendor:function(){return this.getContext().getParameter(this.getContext().VENDOR)},getWebGLVersion:function(){return this.getContext().getParameter(this.getContext().VERSION)},getAntialiased:function(){return this.getContext().getParameter(this.getContext().SAMPLES)>0},getMaxClipPlanes:function(){return 6},getDepthSize:function(){var e=this.context;return e.getParameter(e.DEPTH_BITS)},getColorDepth:function(){var e=this.context,t=0;return t+=e.getParameter(e.RED_BITS),t+=e.getParameter(e.BLUE_BITS),t+=e.getParameter(e.GREEN_BITS),t+=e.getParameter(e.ALPHA_BITS)},getViewport:function(){return this.viewport_},createShader:function(e,t,i,s,o){o&&(i="\n#define X3D_SHADOWS\n"+i,s="\n#define X3D_SHADOWS\n"+s);var a=new r(e.getPrivateScene());a.setName(t+"Vertex"),a.url_.push("data:text/plain;charset=utf-8,"+i),a.setup();var u=new r(e.getPrivateScene());u.setName(t+"Fragment"),u.type_="FRAGMENT",u.url_.push("data:text/plain;charset=utf-8,"+s),u.setup();var l=new n(e.getPrivateScene());return l.setName(t),l.language_="GLSL",l.parts_.push(a),l.parts_.push(u),l.setCustom(!1),l.setup(),this.getLoadSensor().watchList_.push(a),this.getLoadSensor().watchList_.push(u),l},setShading:function(e){switch(e){case i.PHONG:this.defaultShader=this.phongShader;break;default:this.defaultShader=this.gouraudShader}this.pointShader.setGeometryType(0),this.lineShader.setGeometryType(1),this.defaultShader.setGeometryType(3),this.shadowShader.setGeometryType(3);var t=this.getShaders();for(var n in t)t[n].setShading(e)},getDefaultShader:function(){return this.defaultShader},getPointShader:function(){return this.pointShader},getLineShader:function(){return this.lineShader},getGouraudShader:function(){return this.gouraudShader},getPhongShader:function(){return this.phongShader},getShadowShader:function(){return this.defaultShader.shadowShader},getDepthShader:function(){return this.depthShader},getClipPlanes:function(){return this.clipPlanes},reshape:function(){var e=this.getCanvas(),t=e.width(),i=e.height();e=e[0],e.width=t,e.height=i,this.viewport_[2]=t,this.viewport_[3]=i,this.context.viewport(0,0,t,i),this.context.scissor(0,0,t,i),this.addBrowserEvent()},onfullscreen:function(){this.getElement().fullScreen()?this.getElement().addClass("x_ite-fullscreen"):this.getElement().removeClass("x_ite-fullscreen")}},_}),define("x_ite/Components/Shape/X3DAppearanceNode",["x_ite/Fields","x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants"],function(e,t,i){"use strict";function n(n){t.call(this,n),this.addType(i.X3DAppearanceNode),this.addChildObjects("transparent",new e.SFBool),this.transparent_.setAccessType(i.outputOnly)}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,initialize:function(){t.prototype.initialize.call(this)}}),n}),define("x_ite/Components/Shape/Appearance",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shape/X3DAppearanceNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(s.Appearance),this.linePropertiesNode=null,this.materialNode=null,this.textureNode=null,this.textureTransformNode=null,this.shaderNodes=[],this.shaderNode=null,this.blendModeNode=null}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"fillProperties",new e.SFNode),new t(s.inputOutput,"lineProperties",new e.SFNode),new t(s.inputOutput,"material",new e.SFNode),new t(s.inputOutput,"texture",new e.SFNode),new t(s.inputOutput,"textureTransform",new e.SFNode),new t(s.inputOutput,"shaders",new e.MFNode),new t(s.inputOutput,"blendMode",new e.SFNode)]),getTypeName:function(){return"Appearance"},getComponentName:function(){return"Shape"},getContainerField:function(){return"appearance"},initialize:function(){n.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this),this.lineProperties_.addInterest("set_lineProperties__",this),this.material_.addInterest("set_material__",this),this.texture_.addInterest("set_texture__",this),this.textureTransform_.addInterest("set_textureTransform__",this),this.shaders_.addInterest("set_shaders__",this),this.blendMode_.addInterest("set_blendMode__",this),this.set_live__(),this.set_lineProperties__(),this.set_material__(),this.set_texture__(),this.set_textureTransform__(),this.set_shaders__(),this.set_blendMode__()},getLineProperties:function(){return this.linePropertiesNode},getMaterial:function(){return this.materialNode},getTexture:function(){return this.textureNode},getTextureTransform:function(){return this.textureTransformNode},set_live__:function(){this.isLive().getValue()?(this.getBrowser().getBrowserOptions().Shading_.addInterest("set_shading__",this),this.shaderNode&&this.getBrowser().addShader(this.shaderNode)):(this.getBrowser().getBrowserOptions().Shading_.removeInterest("set_shading__",this),this.shaderNode&&this.getBrowser().removeShader(this.shaderNode))},set_lineProperties__:function(){this.linePropertiesNode=r(s.LineProperties,this.lineProperties_)},set_material__:function(){this.materialNode&&this.materialNode.transparent_.removeInterest("set_transparent__",this),this.materialNode=r(s.X3DMaterialNode,this.material_),this.materialNode&&this.materialNode.transparent_.addInterest("set_transparent__",this),this.set_transparent__()},set_texture__:function(){this.textureNode&&this.textureNode.transparent_.removeInterest("set_transparent__",this),this.textureNode=r(s.X3DTextureNode,this.texture_),this.textureNode&&this.textureNode.transparent_.addInterest("set_transparent__",this),this.generatedCubeMapTexture=r(s.GeneratedCubeMapTexture,this.texture_),this.set_transparent__()},set_textureTransform__:function(){this.textureTransformNode=r(s.X3DTextureTransformNode,this.textureTransform_),this.textureTransformNode||(this.textureTransformNode=this.getBrowser().getDefaultTextureTransform())},set_shaders__:function(){for(var e=this.shaders_.getValue(),t=this.shaderNodes,i=0,n=t.length;i<n;++i)t[i].isValid_.removeInterest("set_shader__",this);t.length=0;for(var i=0,n=e.length;i<n;++i){var o=r(s.X3DShaderNode,e[i]);o&&(t.push(o),o.isValid_.addInterest("set_shader__",this))}this.set_shader__()},set_shader__:function(){var e=this.shaderNodes;this.shaderNode&&this.getBrowser().removeShader(this.shaderNode),this.shaderNode=null;for(var t=0,i=e.length;t<i;++t)if(e[t].isValid_.getValue()){this.shaderNode=e[t];break}this.shaderNode||(this.shaderNode=this.getBrowser().getDefaultShader()),this.isLive().getValue()&&this.shaderNode&&this.getBrowser().addShader(this.shaderNode),this.set_transparent__()},set_shading__:function(){this.set_shader__()},set_blendMode__:function(){this.blendModeNode=r(s.BlendMode,this.blendMode_),this.set_transparent__()},set_transparent__:function(){this.transparent_=this.materialNode&&this.materialNode.transparent_.getValue()||this.textureNode&&this.textureNode.transparent_.getValue()||this.blendModeNode},traverse:function(e,t){this.generatedCubeMapTexture&&this.generatedCubeMapTexture.traverse(e,t),this.shaderNode.traverse(e,t)},enable:function(e,t){var i=t.renderer.getBrowser();t.linePropertiesNode=this.linePropertiesNode,t.materialNode=this.materialNode,t.textureNode=this.textureNode,t.textureTransformNode=this.textureTransformNode,t.shadow?t.shaderNode=i.getShadowShader():t.shaderNode=this.shaderNode,this.blendModeNode&&this.blendModeNode.enable(e)},disable:function(e,t){this.blendModeNode&&this.blendModeNode.disable(e)}}),o}),define("x_ite/Browser/Shape/X3DShapeContext",["x_ite/Components/Shape/Appearance"],function(e){"use strict";function t(){this.defaultAppearance=new e(this.getPrivateScene())}return t.prototype={initialize:function(){this.defaultAppearance.setup()},getDefaultAppearance:function(){return this.defaultAppearance}},t}),define("x_ite/Browser/Geometry2D/Arc2DOptions",["x_ite/Basic/X3DBaseNode","x_ite/Fields"],function(e,t){"use strict";function i(i){e.call(this,i),this.addChildObjects("dimension",new t.SFInt32(32))}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,getTypeName:function(){return"ArcClose2DOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"arcClose2DOptions"}}),i}),define("x_ite/Browser/Geometry2D/ArcClose2DOptions",["x_ite/Basic/X3DBaseNode","x_ite/Fields"],function(e,t){"use strict";function i(i){e.call(this,i),this.addChildObjects("dimension",new t.SFInt32(32))}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,getTypeName:function(){return"Arc2DOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"arc2DOptions"}}),i}),define("standard/Math/Algorithms/SAT",[],function(){"use strict";function e(){}function t(e,t,i){i.min=Number.POSITIVE_INFINITY,i.max=Number.NEGATIVE_INFINITY;for(var n=0,r=e.length;n<r;++n){var s=e[n],o=s.dot(t);o<i.min&&(i.min=o),o>i.max&&(i.max=o)}}function i(e,t,i,r){return n(i,e,t)||n(e,i,r)}function n(e,t,i){return t<=e&&e<=i}var r={min:0,max:0},s={min:0,max:0};return e.isSeparated=function(e,n,o){for(var a=0,u=e.length;a<u;++a){var l=e[a];if(t(n,l,r),t(o,l,s),!i(r.min,r.max,s.min,s.max))return!0}return!1},e}),define("standard/Math/Geometry/Box3",["standard/Math/Geometry/Triangle3","standard/Math/Numbers/Matrix4","standard/Math/Numbers/Vector3","standard/Math/Algorithms/SAT"],function(e,t,i,n){"use strict";function r(e,i){switch(arguments.length){case 0:return void(this.matrix=new t(.5,0,0,0,0,.5,0,0,0,0,.5,0,0,0,0,0));case 2:return void(this.matrix=new t(e.x/2,0,0,0,0,e.y/2,0,0,0,0,e.z/2,0,i.x,i.y,i.z,1));case 3:var n=arguments[0],r=arguments[1],s=(r.x-n.x)/2,o=(r.y-n.y)/2,a=(r.z-n.z)/2,u=(r.x+n.x)/2,l=(r.y+n.y)/2,h=(r.z+n.z)/2;return void(this.matrix=new t(s,0,0,0,0,o,0,0,0,0,a,0,u,l,h,1))}}var s=new i(0,0,0),o=new i(0,0,0),a=new i(0,0,0),u=new i(0,0,0),l=new i(0,0,0),h=new i(0,0,0),c=new i(0,0,0),d=new i(0,0,0),p=new i(0,0,0),f=new i(0,0,0),g=new i(0,0,0),m=new i(0,0,0),_=[new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0)],x=[new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0)],y=[new i(0,0,0),new i(0,0,0),new i(0,0,0)],v=[new i(0,0,0),new i(0,0,0),new i(0,0,0)],w=[new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0)],b=[new i(0,0,0),new i(0,0,0),new i(0,0,0)],S=[],C=[new i(0,0,0)],T=[new i(0,0,0),new i(0,0,0),new i(0,0,0)];return r.prototype={constructor:r,copy:function(){var e=Object.create(r.prototype);return e.matrix=this.matrix.copy(),e},assign:function(e){return this.matrix.assign(e.matrix),this},equals:function(e){return this.matrix.equals(e.matrix)},getMatrix:function(){return this.matrix},set:function(e,t){_.box===this&&(_.box=null),y.box===this&&(y.box=null);var i=this.matrix;switch(arguments.length){case 0:return i[0]=.5,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=.5,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=.5,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=0,this;case 2:return i[0]=e.x/2,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=e.y/2,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=e.z/2,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}},setExtents:function(e,t){_.box===this&&(_.box=null),y.box===this&&(y.box=null);var i=this.matrix,n=(t.x-e.x)/2,r=(t.y-e.y)/2,s=(t.z-e.z)/2,o=(t.x+e.x)/2,a=(t.y+e.y)/2,u=(t.z+e.z)/2;return i[0]=n,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=r,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=s,i[11]=0,i[12]=o,i[13]=a,i[14]=u,i[15]=1,this},getExtents:function(e,t){this.getAbsoluteExtents(e,t),e.add(this.center),t.add(this.center)},getAbsoluteExtents:function(e,t){var i=this.matrix;a.assign(i.xAxis),u.assign(i.yAxis),l.assign(i.zAxis),h.assign(u).add(l);var n=l.subtract(u);c.assign(a).add(h),d.assign(a).add(n);var r=h.subtract(a),s=n.subtract(a);e.assign(c),t.assign(c),e.min(r,s,d),t.max(r,s,d),c.negate(),r.negate(),s.negate(),d.negate(),e.min(c,r,s,d),t.max(c,r,s,d)},getPoints:function(e){var t=this.matrix;a.assign(t.xAxis),u.assign(t.yAxis),l.assign(t.zAxis),h.assign(u).add(l);var i=l.subtract(u);e[0].assign(a).add(h),e[1].assign(h).subtract(a),e[2].assign(i).subtract(a),e[3].assign(a).add(i),e[4].assign(e[2]).negate(),e[5].assign(e[3]).negate(),e[6].assign(e[0]).negate(),e[7].assign(e[1]).negate();var n=this.center;return e[0].add(n),e[1].add(n),e[2].add(n),e[3].add(n),e[4].add(n),e[5].add(n),e[6].add(n),e[7].add(n),e},getAxes:function(e){var t=this.matrix;return e[0].assign(t.xAxis),e[1].assign(t.yAxis),e[2].assign(t.zAxis),e},getNormals:function(){var e=new i(0,0,0),t=new i(0,0,0),n=new i(0,0,0),r=[i.xAxis,i.yAxis,i.zAxis];return function(s){var o=this.matrix;if(e.assign(o.xAxis),t.assign(o.yAxis),n.assign(o.zAxis),0==e.norm()&&0==t.norm()&&0==n.norm())e.assign(i.xAxis),t.assign(i.yAxis),n.assign(i.zAxis);else{if(0==e.norm()){if(e.assign(t).cross(n),0==e.norm())for(var a=0;a<3&&(e.assign(r[a]).cross(t),0==e.norm());++a);if(0==e.norm())for(var a=0;a<3&&(e.assign(r[a]).cross(n),0==e.norm());++a);0==e.norm()?e.assign(i.xAxis):e.normalize()}if(0==t.norm()){if(t.assign(n).cross(e),0==t.norm())for(var a=0;a<3&&(t.assign(r[a]).cross(n),0==t.norm());++a);if(0==t.norm())for(var a=0;a<3&&(t.assign(r[a]).cross(e),0==t.norm());++a);0==t.norm()?t.assign(i.yAxis):t.normalize()}if(0==n.norm()){if(n.assign(e).cross(t),0==n.norm())for(var a=0;a<3&&(n.assign(r[a]).cross(e),0==n.norm());++a);if(0==n.norm())for(var a=0;a<3&&(n.assign(r[a]).cross(t),0==n.norm());++a);0==n.norm()?n.assign(i.zAxis):n.normalize()}}return s[0].assign(t).cross(n).normalize(),s[1].assign(n).cross(e).normalize(),s[2].assign(e).cross(t).normalize(),s}}(),isEmpty:function(){return 0===this.matrix[15]},add:function(e){return this.isEmpty()?this.assign(e):e.isEmpty()?this:(this.getExtents(p,f),e.getExtents(g,m),this.assign(new r(p.min(g),f.max(m),!0)))},multLeft:function(e){return this.matrix.multLeft(e),this},multRight:function(e){return this.matrix.multRight(e),this},intersectsPoint:function(e){return this.getExtents(s,o),s.x<=e.x&&o.x>=e.x&&s.y<=e.y&&o.y>=e.y&&s.z<=e.z&&o.z>=e.z},intersectsBox:function(e){if(this.isEmpty())return!1;if(e.isEmpty())return!1;if(this.getPoints(_),e.getPoints(x),n.isSeparated(this.getNormals(b),_,x))return!1;if(n.isSeparated(e.getNormals(b),_,x))return!1;this.getAxes(y),e.getAxes(v);for(var t=0;t<3;++t)for(var i=0;i<3;++i)w[3*t+i].assign(y[t]).cross(v[i]);return!n.isSeparated(w,_,x)},intersectsTriangle:function(t,i,r){if(this.isEmpty())return!1;if(_.box!==this&&(_.box=this,this.getPoints(_)),S[0]=t,S[1]=i,S[2]=r,n.isSeparated(this.getNormals(b),_,S))return!1;if(e.normal(t,i,r,C[0]),n.isSeparated(C,_,S))return!1;y.box!==this&&(y.box=this,this.getAxes(y)),T[0].assign(t).subtract(i),T[1].assign(i).subtract(r),T[2].assign(r).subtract(t);for(var s=0;s<3;++s)for(var o=0;o<3;++o)w[3*s+o].assign(y[s]).cross(T[o]);return!n.isSeparated(w,_,x)},toString:function(){return this.size+", "+this.center}},Object.defineProperty(r.prototype,"size",{get:function(){var e=new i(0,0,0);return this.getAbsoluteExtents(s,e),e.subtract(s)},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"center",{get:function(){return this.matrix.origin},enumerable:!0,configurable:!1}),r}),define("x_ite/Components/Rendering/X3DGeometryNode",["x_ite/Fields","x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants","x_ite/Browser/Core/Shading","standard/Math/Numbers/Color3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Box3","standard/Math/Geometry/Plane3","standard/Math/Geometry/Triangle3","standard/Math/Algorithm"],function(e,t,i,n,r,s,o,a,u,l,h,c,d){"use strict";function p(n){t.call(this,n),this.addType(i.X3DGeometryNode),this.addChildObjects("transparent",new e.SFBool,"bbox_changed",new e.SFTime),this.transparent_.setAccessType(i.outputOnly),this.bbox_changed_.setAccessType(i.outputOnly),this.min=new o(0,0,0),this.max=new o(0,0,0),this.bbox=new l(this.min,this.max,!0),this.solid=!0,this.geometryType=3,this.flatShading=void 0,this.colorMaterial=!1,this.attribNodes=[],this.attribs=[],this.currentTexCoordNode=this.getBrowser().getDefaultTextureCoordinate(),this.texCoordParams={min:new o(0,0,0)},this.multiTexCoords=[],this.texCoords=p.createArray(),this.colors=p.createArray(),this.normals=p.createArray(),this.flatNormals=p.createArray(),this.vertices=p.createArray(),this.vertexCount=0,this.depth=Function.prototype,this.display=Function.prototype,this.displayParticles=Function.prototype}const f=new o(0,0,0),g=new o(0,0,0),m=new u,_=new u,x=[new o(0,0,1),new o(0,0,-1),new o(0,1,0),new o(0,-1,0),new o(1,0,0)];return p.createArray=function(){var e=[];return e.typedArray=new Float32Array,e.assign=function(e){this.length=0,Array.prototype.push.apply(this,e)},e.getValue=function(){return this.typedArray},e.shrinkToFit=function(){this.length!==this.typedArray.length?this.typedArray=new Float32Array(this):this.typedArray.set(this)},e},p.prototype=Object.assign(Object.create(t.prototype),{constructor:p,intersection:new o(0,0,0),uvt:{u:0,v:0,t:0},v0:new o(0,0,0),v1:new o(0,0,0),v2:new o(0,0,0),normal:new o(0,0,0),setup:function(){this.setTainted(!0),t.prototype.setup.call(this),this.addInterest("eventsProcessed",this),this.eventsProcessed(),this.setTainted(!1)},initialize:function(){t.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this);var e=this.getBrowser().getContext();if(this.primitiveMode=e.TRIANGLES,this.frontFace=e.CCW,this.attribBuffers=[],this.texCoordBuffers=[],this.colorBuffer=e.createBuffer(),this.normalBuffer=e.createBuffer(),this.vertexBuffer=e.createBuffer(),this.planes=[],this.geometryType>1)for(var i=0;i<5;++i)this.planes[i]=new h(o.Zero,x[0]);this.set_live__()},setGeometryType:function(e){this.geometryType=e},getGeometryType:function(){return this.geometryType},getBBox:function(){return this.bbox},setBBox:function(e){if(!e.equals(this.bbox)){e.getExtents(this.min,this.max),this.bbox.assign(e);for(var t=0;t<5;++t)this.planes[t].set(t%2?this.min:this.max,x[t]);this.bbox_changed_.addEvent()}},getMin:function(){return this.min},getMax:function(){return this.max},getMatrix:function(){return u.Identity},setPrimitiveMode:function(e){this.primitiveMode=e},getPrimitiveMode:function(){return this.primitiveMode},setSolid:function(e){this.solid=e},setCCW:function(e){this.frontFace=e?this.getBrowser().getContext().CCW:this.getBrowser().getContext().CW},getAttrib:function(){return this.attribNodes},getAttribs:function(){return this.attribs},setColors:function(e){this.colors.assign(e)},getColors:function(){return this.colors},setMultiTexCoords:function(e){var t=this.multiTexCoords;t.length=0,Array.prototype.push.apply(t,e)},getMultiTexCoords:function(){return this.multiTexCoords},getTexCoords:function(){return this.texCoords},setCurrentTexCoord:function(e){this.currentTexCoordNode=e||this.getBrowser().getDefaultTextureCoordinate()},setNormals:function(e){this.normals.assign(e)},getNormals:function(){return this.normals},setVertices:function(e){this.vertices.assign(e)},getVertices:function(){return this.vertices},buildTexCoords:function(){for(var e=this.getTexCoordParams(),t=e.min,i=e.Sindex,n=e.Tindex,r=e.Ssize,s=t[i],o=t[n],a=this.texCoords,u=this.vertices.getValue(),l=0,h=u.length;l<h;l+=4)a.push((u[l+i]-s)/r,(u[l+n]-o)/r,0,1);this.multiTexCoords.push(a)},getTexCoordParams:function(){var e=this.texCoordParams,t=this.getBBox(),i=t.size,n=i.x,r=i.y,s=i.z;return e.min.assign(t.center).subtract(i.divide(2)),n>=r&&n>=s?(e.Ssize=n,e.Sindex=0,e.Tindex=r>=s?1:2):r>=n&&r>=s?(e.Ssize=r,e.Sindex=1,e.Tindex=n>=s?0:2):(e.Ssize=s,e.Sindex=2,e.Tindex=n>=r?0:1),e},refineNormals:function(e,t,i){if(0===i)return t;var n=Math.cos(d.clamp(i,0,Math.PI)),r=[];for(var s in e)for(var a=e[s],u=0,l=a.length;u<l;++u){for(var h=a[u],c=t[h],p=new o(0,0,0),f=0;f<l;++f){var g=t[a[f]];g.dot(c)>=n&&p.add(g)}r[h]=p.normalize()}return r},isClipped:function(e,t){return t.some(function(t){return t.isClipped(e)})},transformLine:function(e){},transformMatrix:function(e){},intersectsLine:function(e,t,i,n){try{var r=!1;if(this.intersectsBBox(e)){this.transformLine(e),this.transformMatrix(m.assign(i));for(var a=this.multiTexCoords[0].getValue(),u=this.normals.getValue(),l=this.vertices.getValue(),h=this.uvt,c=this.v0,d=this.v1,p=this.v2,f=0,_=this.vertexCount;f<_;f+=3){var x=4*f;if(c.x=l[x],c.y=l[x+1],c.z=l[x+2],d.x=l[x+4],d.y=l[x+5],d.z=l[x+6],p.x=l[x+8],p.y=l[x+9],p.z=l[x+10],e.intersectsTriangle(c,d,p,h)){var y=h.u,v=h.v,w=1-y-v,b=new o(w*l[x]+y*l[x+4]+v*l[x+8],w*l[x+1]+y*l[x+5]+v*l[x+9],w*l[x+2]+y*l[x+6]+v*l[x+10]);if(this.isClipped(m.multVecMatrix(g.assign(b)),t))continue;var S=new s(w*a[x]+y*a[x+4]+v*a[x+8],w*a[x+1]+y*a[x+5]+v*a[x+9]),C=3*f,T=new o(w*u[C]+y*u[C+3]+v*u[C+6],w*u[C+1]+y*u[C+4]+v*u[C+7],w*u[C+2]+y*u[C+5]+v*u[C+8]);n.push({texCoord:S,normal:T,point:this.getMatrix().multVecMatrix(b)}),r=!0}}}return r}catch(e){return console.log(e),!1}},intersectsBBox:function(e){var t=this.planes,i=this.min,n=this.max,r=i.x,s=n.x,o=i.y,a=n.y,u=i.z,l=n.z,h=this.intersection;return!!(t[0].intersectsLine(e,h)&&h.x>=r&&h.x<=s&&h.y>=o&&h.y<=a)||(!!(t[1].intersectsLine(e,h)&&h.x>=r&&h.x<=s&&h.y>=o&&h.y<=a)||(!!(t[2].intersectsLine(e,h)&&h.x>=r&&h.x<=s&&h.z>=u&&h.z<=l)||(!!(t[3].intersectsLine(e,h)&&h.x>=r&&h.x<=s&&h.z>=u&&h.z<=l)||!!(t[4].intersectsLine(e,h)&&h.y>=o&&h.y<=a&&h.z>=u&&h.z<=l))))},intersectsBox:function(e,t,i){try{if(e.intersectsBox(this.bbox)){e.multRight(_.assign(this.getMatrix()).inverse()),this.transformMatrix(i);for(var n=this.vertices.getValue(),r=this.v0,s=this.v1,o=this.v2,a=0,u=this.vertexCount;a<u;a+=3){var l=4*a;if(r.x=n[l],r.y=n[l+1],r.z=n[l+2],s.x=n[l+4],s.y=n[l+5],s.z=n[l+6],o.x=n[l+8],o.y=n[l+9],o.z=n[l+10],e.intersectsTriangle(r,s,o)){if(t.length){if(this.isClipped(i.multVecMatrix(g.assign(r)),t))continue;if(this.isClipped(i.multVecMatrix(g.assign(s)),t))continue;if(this.isClipped(i.multVecMatrix(g.assign(o)),t))continue}return!0}}}return!1}catch(e){return console.log(e),!1}},set_live__:function(){
this.isLive().getValue()?this.getBrowser().getBrowserOptions().Shading_.addInterest("set_shading__",this):this.getBrowser().getBrowserOptions().Shading_.removeInterest("set_shading__",this)},set_shading__:function(e){if(!(this.geometryType<2)){var t=this.getBrowser().getBrowserOptions().getShading()===n.FLAT;if(t!==this.flatShading){this.flatShading=t;var i=this.getBrowser().getContext();if(t&&!this.flatNormals.length){for(var r=this.frontFace===i.CW,s=this.flatNormals,o=this.vertices.getValue(),a=this.v0,u=this.v1,l=this.v2,h=this.normal,d=0,p=o.length;d<p;d+=12)c.normal(a.set(o[d],o[d+1],o[d+2]),u.set(o[d+4],o[d+5],o[d+6]),l.set(o[d+8],o[d+9],o[d+10]),h),r&&h.negate(),s.push(h.x,h.y,h.z,h.x,h.y,h.z,h.x,h.y,h.z);s.shrinkToFit()}i.bindBuffer(i.ARRAY_BUFFER,this.normalBuffer),i.bufferData(i.ARRAY_BUFFER,t?this.flatNormals.getValue():this.normals.getValue(),i.STATIC_DRAW)}}},eventsProcessed:function(){t.prototype.eventsProcessed.call(this),this.clear(),this.build();for(var e=0,i=this.attribs.length;e<i;++e)this.attribs[e].shrinkToFit();for(var e=0,i=this.multiTexCoords.length;e<i;++e)this.multiTexCoords[e].shrinkToFit();this.colors.shrinkToFit(),this.normals.shrinkToFit(),this.vertices.shrinkToFit();var n=this.min,r=this.max,s=this.vertices.getValue();if(s.length){if(n.x===Number.POSITIVE_INFINITY)for(var e=0,i=s.length;e<i;e+=4)f.set(s[e],s[e+1],s[e+2]),n.min(f),r.max(f);this.bbox.setExtents(n,r)}else this.bbox.setExtents(n.set(0,0,0),r.set(0,0,0));if(this.bbox_changed_.addEvent(),this.geometryType>1){for(var e=0;e<5;++e)this.planes[e].set(e%2?n:r,x[e]);0===this.multiTexCoords.length&&(this.buildTexCoords(),this.texCoords.shrinkToFit())}this.set_shading__(this.getBrowser().getBrowserOptions().Shading_),this.transfer()},clear:function(){this.min.set(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),this.max.set(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(var e=this.attribs,t=0,i=e.length;t<i;++t)e[t].length=0;for(var t=e.length,i=this.attribNodes.length;t<i;++t)e[t]=p.createArray();e.length=i,this.flatShading=void 0,this.colors.length=0,this.multiTexCoords.length=0,this.texCoords.length=0,this.normals.length=0,this.flatNormals.length=0,this.vertices.length=0},transfer:function(){for(var e=this.getBrowser().getContext(),t=this.vertices.length/4,i=this.attribBuffers.length,n=this.attribs.length;i<n;++i)this.attribBuffers.push(e.createBuffer());for(var i=0,n=this.attribs.length;i<n;++i)e.bindBuffer(e.ARRAY_BUFFER,this.attribBuffers[i]),e.bufferData(e.ARRAY_BUFFER,this.attribs[i].getValue(),e.STATIC_DRAW);for(var i=this.texCoordBuffers.length,n=this.multiTexCoords.length;i<n;++i)this.texCoordBuffers.push(e.createBuffer());for(var i=0,n=this.multiTexCoords.length;i<n;++i)e.bindBuffer(e.ARRAY_BUFFER,this.texCoordBuffers[i]),e.bufferData(e.ARRAY_BUFFER,this.multiTexCoords[i].getValue(),e.STATIC_DRAW);e.bindBuffer(e.ARRAY_BUFFER,this.colorBuffer),e.bufferData(e.ARRAY_BUFFER,this.colors.getValue(),e.STATIC_DRAW),this.colorMaterial=Boolean(this.colors.length),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices.getValue(),e.STATIC_DRAW),this.vertexCount=t,this.vertexCount?(delete this.depth,delete this.display,delete this.displayParticles):(this.depth=Function.prototype,this.display=Function.prototype,this.displayParticles=Function.prototype)},traverse:function(e,t){},depth:function(e,t,i){i.enableVertexAttribute(e,this.vertexBuffer),e.drawArrays(this.primitiveMode,0,this.vertexCount)},display:function(e,t){try{var i=t.shaderNode,n=this.attribNodes,r=this.attribBuffers;t.geometryType=this.geometryType,t.colorMaterial=this.colorMaterial,i.enable(e),i.setLocalUniforms(e,t);for(var s=0,o=n.length;s<o;++s)n[s].enable(e,i,r[s]);if(this.colorMaterial&&i.enableColorAttribute(e,this.colorBuffer),i.enableTexCoordAttribute(e,this.texCoordBuffers),i.enableNormalAttribute(e,this.normalBuffer),i.enableVertexAttribute(e,this.vertexBuffer),i.wireframe)for(var s=0,o=this.vertexCount;s<o;s+=3)e.drawArrays(i.primitiveMode,s,3);else{var a=u.prototype.determinant3.call(t.modelViewMatrix)>0;e.frontFace(a?this.frontFace:this.frontFace===e.CCW?e.CW:e.CCW),t.transparent&&!this.solid?(e.enable(e.CULL_FACE),e.cullFace(e.FRONT),e.drawArrays(i.primitiveMode,0,this.vertexCount),e.cullFace(e.BACK),e.drawArrays(i.primitiveMode,0,this.vertexCount)):(this.solid?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),e.drawArrays(i.primitiveMode,0,this.vertexCount))}for(var s=0,o=n.length;s<o;++s)n[s].disable(e,i);i.disableColorAttribute(e),i.disableTexCoordAttribute(e),i.disableNormalAttribute(e),i.disable(e)}catch(e){console.log(e)}},displayParticlesDepth:function(e,t,i,n,r){var e=t.renderer.getBrowser().getContext();i.enableVertexAttribute(e,this.vertexBuffer);for(var s=t.modelViewMatrix,o=s[12],a=s[13],l=s[14],h=0;h<r;++h){var c=n[h];s[12]=o,s[13]=a,s[14]=l,u.prototype.translate.call(s,c.position),i.setParticle(e,h,c,s),e.drawArrays(i.primitiveMode,0,this.vertexCount)}},displayParticles:function(e,t,i,n){try{var r=t.shaderNode,s=this.attribNodes,o=this.attribBuffers;t.geometryType=this.geometryType,t.colorMaterial=this.colorMaterial,r.enable(e),r.setLocalUniforms(e,t);for(var l=0,h=s.length;l<h;++l)s[l].enable(e,r,o[l]);this.colorMaterial&&r.enableColorAttribute(e,this.colorBuffer),r.enableTexCoordAttribute(e,this.texCoordBuffers),r.enableNormalAttribute(e,this.normalBuffer),r.enableVertexAttribute(e,this.vertexBuffer);var c=t.materialNode,d=c||r.getCustom(),p=r.normalMatrixArray,f=t.modelViewMatrix,g=f[12],m=f[13],_=f[14];if(r.wireframe)for(var x=0;x<n;++x){var y=i[x];f[12]=g,f[13]=m,f[14]=_,u.prototype.translate.call(f,y.position),d&&(p[0]=f[0],p[1]=f[4],p[2]=f[8],p[3]=f[1],p[4]=f[5],p[5]=f[9],p[6]=f[2],p[7]=f[6],p[8]=f[10],a.prototype.inverse.call(p),e.uniformMatrix3fv(r.x3d_NormalMatrix,!1,p)),r.setParticle(e,x,y,f);for(var l=0,h=this.vertexCount;l<h;l+=3)e.drawArrays(r.primitiveMode,l,3)}else{var v=u.prototype.determinant3.call(t.modelViewMatrix)>0;if(e.frontFace(v?this.frontFace:this.frontFace===e.CCW?e.CW:e.CCW),t.transparent&&!this.solid)for(var x=0;x<n;++x){var y=i[x];f[12]=g,f[13]=m,f[14]=_,u.prototype.translate.call(f,y.position),d&&(p[0]=f[0],p[1]=f[4],p[2]=f[8],p[3]=f[1],p[4]=f[5],p[5]=f[9],p[6]=f[2],p[7]=f[6],p[8]=f[10],a.prototype.inverse.call(p),e.uniformMatrix3fv(r.x3d_NormalMatrix,!1,p)),r.setParticle(e,x,y,f),e.enable(e.CULL_FACE),e.cullFace(e.FRONT),e.drawArrays(r.primitiveMode,0,this.vertexCount),e.cullFace(e.BACK),e.drawArrays(r.primitiveMode,0,this.vertexCount)}else{this.solid?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE);for(var x=0;x<n;++x){var y=i[x];f[12]=g,f[13]=m,f[14]=_,u.prototype.translate.call(f,y.position),d&&(p[0]=f[0],p[1]=f[4],p[2]=f[8],p[3]=f[1],p[4]=f[5],p[5]=f[9],p[6]=f[2],p[7]=f[6],p[8]=f[10],a.prototype.inverse.call(p),e.uniformMatrix3fv(r.x3d_NormalMatrix,!1,p)),r.setParticle(e,x,y,f),e.drawArrays(r.primitiveMode,0,this.vertexCount)}}}for(var l=0,h=s.length;l<h;++l)s[l].disable(e,r);r.disableColorAttribute(e),r.disableTexCoordAttribute(e),r.disableNormalAttribute(e),r.disable(e)}catch(e){console.log(e)}}}),p}),define("standard/Math/Numbers/Complex",[],function(){"use strict";function e(e,t){this.real=e,this.imag=t}return e.prototype={constructor:e,copy:function(){var t=Object.create(e.prototype);return t.real=this.real,t.imag=this.imag,t},assign:function(e){return this.real=e.real,this.imag=e.imag,this},equals:function(e){return this.real===e.real&&this.imag===e.imag},setRadius:function(e){return this.setPolar(e,this.getAngle())},getRadius:function(){return this.real?this.imag?Math.sqrt(this.real*this.real+this.imag*this.imag):Math.abs(this.real):Math.abs(this.imag)},setAngle:function(e){return this.setPolar(this.getRadius(),e)},getAngle:function(){return Math.atan2(this.imag,this.real)},setPolar:function(e,t){this.real=e*Math.cos(t),this.imag=e*Math.sin(t)},conjugate:function(){return this.imag=-this.imag,this},negate:function(){return this.real=-this.real,this.imag=-this.imag,this},inverse:function(){var e=this.real*this.real+this.imag*this.imag;return this.real/=e,this.imag/=-e,this},add:function(e){return this.real+=e.real,this.imag+=e.imag,this},subtract:function(e){return this.real-=e.real,this.imag-=e.imag,this},multiply:function(e){return this.real*=e,this.imag*=e,this},multComp:function(){var e=this.real,t=this.imag;return this.real=e*value.real-t*value.imag,this.imag=e*value.imag+t*value.real,this},divComp:function(e){var t=this.real,i=this.imag,n=e.real,r=e.imag,s=n*n+r*r;return this.real=(t*n+i*r)/s,this.imag=(i*n-t*r)/s,this},toString:function(){return this.imag?this.real+" "+this.imag+"i":String(this.real)}},Object.assign(e,{Polar:function(t,i){var n=Object.create(e.prototype);return n.real=t*Math.cos(i),n.imag=t*Math.sin(i),n},multiply:function(e,t){var i=Object.create(this.prototype);return i.real=e.real*t,i.imag=e.imag*t,i},multComp:function(e,t){var i=Object.create(this.prototype);return i.real=e.real*t.real-lsh.imag*t.imag,i.imag=e.real*t.imag+lsh.imag*t.real,i}}),e}),define("x_ite/Browser/Geometry2D/Circle2DOptions",["x_ite/Basic/X3DBaseNode","x_ite/Fields","x_ite/Components/Rendering/X3DGeometryNode","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector3"],function(e,t,i,n,r){"use strict";function s(n){e.call(this,n),this.addChildObjects("dimension",new t.SFInt32(40)),this.vertices=i.createArray()}return s.prototype=Object.assign(Object.create(e.prototype),{constructor:s,getTypeName:function(){return"Circle2DOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"circle2DOptions"},initialize:function(){this.addInterest("build",this),this.build()},getVertices:function(){return this.vertices},build:function(){var e=this.dimension_.getValue(),t=2*Math.PI/e,i=this.vertices;i.length=0;for(var r=0;r<e;++r){var s=n.Polar(1,t*r);i.push(s.real,s.imag,0,1)}i.shrinkToFit()}}),s}),define("x_ite/Browser/Geometry2D/Disk2DOptions",["x_ite/Basic/X3DBaseNode","x_ite/Fields","x_ite/Components/Rendering/X3DGeometryNode","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector3"],function(e,t,i,n,r){"use strict";function s(n){e.call(this,n),this.addChildObjects("dimension",new t.SFInt32(40)),this.circleVertices=i.createArray(),this.diskTexCoords=i.createArray(),this.diskNormals=i.createArray(),this.diskVertices=i.createArray()}var o=new n(.5,.5);return s.prototype=Object.assign(Object.create(e.prototype),{constructor:s,getTypeName:function(){return"Disk2DOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"circle2DOptions"},initialize:function(){this.addInterest("build",this),this.build()},getCircleVertices:function(){return this.circleVertices},getDiskTexCoords:function(){return this.diskTexCoords},getDiskNormals:function(){return this.diskNormals},getDiskVertices:function(){return this.diskVertices},build:function(){var e=this.dimension_.getValue(),t=2*Math.PI/e,i=this.circleVertices,r=this.diskTexCoords,s=this.diskNormals,a=this.diskVertices;i.length=0,r.length=0,s.length=0,a.length=0;for(var u=0;u<e;++u){var l=t*u,h=t*(u+1),c=n.Polar(.5,l).add(o),d=n.Polar(.5,h).add(o),p=n.Polar(1,l),f=n.Polar(1,h);i.push(p.real,p.imag,0,1),r.push(.5,.5,0,1,c.real,c.imag,0,1,d.real,d.imag,0,1),s.push(0,0,1,0,0,1,0,0,1),a.push(0,0,0,1,p.real,p.imag,0,1,f.real,f.imag,0,1)}i.shrinkToFit(),r.shrinkToFit(),s.shrinkToFit(),a.shrinkToFit()}}),s}),define("x_ite/Components/Rendering/X3DComposedGeometryNode",["x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n){"use strict";function r(t){e.call(this,t),this.addType(i.X3DComposedGeometryNode),this.colorNode=null,this.texCoordNode=null,this.normalNode=null,this.coordNode=null}var s=new n(0,0,0),o=new n(0,0,0);return r.prototype=Object.assign(Object.create(e.prototype),{constructor:r,initialize:function(){e.prototype.initialize.call(this),this.attrib_.addInterest("set_attrib__",this),this.color_.addInterest("set_color__",this),this.texCoord_.addInterest("set_texCoord__",this),this.normal_.addInterest("set_normal__",this),this.coord_.addInterest("set_coord__",this),this.set_attrib__(),this.set_color__(),this.set_texCoord__(),this.set_normal__(),this.set_coord__()},getColor:function(){return this.colorNode},getTexCoord:function(){return this.texCoordNode},getNormal:function(){return this.normalNode},getCoord:function(){return this.coordNode},set_attrib__:function(){for(var e=this.getAttrib(),n=0,r=e.length;n<r;++n)e[n].removeInterest("addNodeEvent",this);e.length=0;for(var n=0,r=this.attrib_.length;n<r;++n){var s=t(i.X3DVertexAttributeNode,this.attrib_[n]);s&&e.push(s)}for(var n=0;n<this.attribNodes.length;++n)e[n].addInterest("addNodeEvent",this)},set_color__:function(){this.colorNode&&(this.colorNode.removeInterest("addNodeEvent",this),this.colorNode.removeInterest("set_transparent__",this)),this.colorNode=t(i.X3DColorNode,this.color_),this.colorNode?(this.colorNode.addInterest("addNodeEvent",this),this.colorNode.addInterest("set_transparent__",this),this.set_transparent__()):this.transparent_=!1},set_transparent__:function(){this.transparent_=this.colorNode.isTransparent()},set_texCoord__:function(){this.texCoordNode&&this.texCoordNode.removeInterest("addNodeEvent",this),this.texCoordNode=t(i.X3DTextureCoordinateNode,this.texCoord_),this.texCoordNode&&this.texCoordNode.addInterest("addNodeEvent",this),this.setCurrentTexCoord(this.texCoordNode)},set_normal__:function(){this.normalNode&&this.normalNode.removeInterest("addNodeEvent",this),this.normalNode=t(i.X3DNormalNode,this.normal_),this.normalNode&&this.normalNode.addInterest("addNodeEvent",this)},set_coord__:function(){this.coordNode&&this.coordNode.removeInterest("addNodeEvent",this),this.coordNode=t(i.X3DCoordinateNode,this.coord_),this.coordNode&&this.coordNode.addInterest("addNodeEvent",this)},getPolygonIndex:function(e){return e},getTriangleIndex:function(e){return e},build:function(e,t,i,n){if(this.coordNode&&!this.coordNode.isEmpty()){t-=t%e,n-=n%i;var r=this.colorPerVertex_.getValue(),s=this.normalPerVertex_.getValue(),o=this.getAttrib(),a=o.length,u=this.getAttribs(),l=this.getColor(),h=this.getTexCoord(),c=this.getNormal(),d=this.getCoord(),p=this.getColors(),f=this.getMultiTexCoords(),g=this.getNormals(),m=this.getVertices(),_=0;h&&h.init(f);for(var x=0;x<n;++x){_=Math.floor(x/i);for(var y=this.getPolygonIndex(this.getTriangleIndex(x)),v=0;v<a;++v)o[v].addValue(y,u[v]);l&&(r?l.addColor(y,p):l.addColor(_,p)),h&&h.addTexCoord(y,f),c&&(s?c.addVector(y,g):c.addVector(_,g)),d.addPoint(y,m)}this.getNormal()||this.buildNormals(e,t,n),this.setSolid(this.solid_.getValue()),this.setCCW(this.ccw_.getValue())}},buildNormals:function(e,t,i){for(var n=this.createNormals(e,t),r=this.getNormals(),s=0;s<i;++s){var o=n[this.getTriangleIndex(s)];r.push(o.x,o.y,o.z)}},createNormals:function(e,t){var i=this.createFaceNormals(e,t);if(this.normalPerVertex_.getValue()){for(var n=[],r=0;r<t;++r){var s=this.getPolygonIndex(r);n[s]||(n[s]=[]),n[s].push(r)}return this.refineNormals(n,i,Math.PI)}return i},createFaceNormals:function(e,t){for(var i=!this.ccw_.getValue(),n=this.coordNode,r=[],s=0;s<t;s+=e){var o=this.getPolygonNormal(s,e,n);i&&o.negate();for(var a=0;a<e;++a)r.push(o)}return r},getPolygonNormal:function(e,t,i){var r=new n(0,0,0);i.get1Point(this.getPolygonIndex(e),o);for(var a=0;a<t;++a){var u=s;s=o,o=u,i.get1Point(this.getPolygonIndex(e+(a+1)%t),o),r.x+=(s.y-o.y)*(s.z+o.z),r.y+=(s.z-o.z)*(s.x+o.x),r.z+=(s.x-o.x)*(s.y+o.y)}return r.normalize()}}),r}),define("x_ite/Components/Geometry3D/IndexedFaceSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Triangle3"],function(e,t,i,n,r,s,o,a){"use strict";function u(e){n.call(this,e),this.addType(r.IndexedFaceSet),this.creaseAngle_.setUnit("angle")}var l=[0,1,2],h=[],c=[],d=[],p=new s(0,0,0),f=new s(0,0,0);return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"solid",new e.SFBool(!0)),new t(r.initializeOnly,"ccw",new e.SFBool(!0)),new t(r.initializeOnly,"convex",new e.SFBool(!0)),new t(r.initializeOnly,"creaseAngle",new e.SFFloat),new t(r.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new t(r.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new t(r.inputOutput,"colorIndex",new e.MFInt32),new t(r.inputOutput,"texCoordIndex",new e.MFInt32),new t(r.inputOutput,"normalIndex",new e.MFInt32),new t(r.inputOutput,"coordIndex",new e.MFInt32),new t(r.inputOutput,"attrib",new e.MFNode),new t(r.inputOutput,"fogCoord",new e.SFNode),new t(r.inputOutput,"color",new e.SFNode),new t(r.inputOutput,"texCoord",new e.SFNode),new t(r.inputOutput,"normal",new e.SFNode),new t(r.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"IndexedFaceSet"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},getTexCoordPerVertexIndex:function(e){return e<this.texCoordIndex_.length?this.texCoordIndex_[e]:this.coordIndex_[e]},getColorPerVertexIndex:function(e){return e<this.colorIndex_.length?this.colorIndex_[e]:this.coordIndex_[e]},getColorIndex:function(e){return e<this.colorIndex_.length?this.colorIndex_[e]:e},getNormalPerVertexIndex:function(e){return e<this.normalIndex_.length?this.normalIndex_[e]:this.coordIndex_[e]},getNormalIndex:function(e){return e<this.normalIndex_.length?this.normalIndex_[e]:e},build:function(){var e=this.triangulate();if(0!==e.length){var t=this.colorPerVertex_.getValue(),i=this.normalPerVertex_.getValue(),n=this.coordIndex_,r=this.getAttrib(),s=r.length,o=this.getAttribs(),a=this.getColor(),u=this.getTexCoord(),l=this.getNormal(),h=this.getCoord(),c=this.getColors(),d=this.getMultiTexCoords(),p=this.getNormals(),f=this.getVertices();u&&u.init(d);for(var g=0,m=e.length;g<m;++g){for(var _=e[g],x=_.vertices,y=_.triangles,v=_.face,w=0,b=y.length;w<b;++w){for(var S=x[y[w]],C=n[S],T=0;T<s;++T)r[T].addValue(C,o[T]);a&&(t?a.addColor(this.getColorPerVertexIndex(S),c):a.addColor(this.getColorIndex(v),c)),u&&u.addTexCoord(this.getTexCoordPerVertexIndex(S),d),l&&(i?l.addVector(this.getNormalPerVertexIndex(S),p):l.addVector(this.getNormalIndex(v),p)),h.addPoint(C,f)}++v}this.getNormal()||this.buildNormals(e),this.setSolid(this.solid_.getValue()),this.setCCW(this.ccw_.getValue())}},triangulate:function(){var e=this.convex_.getValue(),t=this.coordIndex_,i=t.length,n=[];if(!this.getCoord())return n;if(i){t[i-1]>-1&&(t.push(-1),++i);for(var r=[],s=0,o=0;o<i;++o){if(t[o]>-1)r.push(o);else{if(r.length)switch(r[0]===r[r.length-1]&&r.pop(),r.length){case 0:case 1:case 2:r.length=0;break;case 3:n.push({vertices:r,triangles:l,face:s}),r=[];break;default:var a=[],u={vertices:r,triangles:a,face:s};e?this.triangulateConvexPolygon(u):this.triangulatePolygon(u),a.length<3?r.length=0:(n.push(u),r=[])}++s}}}return n},triangulatePolygon:function(e){for(var t=e.vertices,i=e.triangles,n=this.coordIndex_,r=this.getCoord(),o=0,u=t.length;o<u;++o){var l=r.get1Point(n[t[o]],new s(0,0,0));l.index=o,h[o]=l}h.length=u,a.triangulatePolygon(h,i);for(var o=0,u=i.length;o<u;++o)i[o]=i[o].index},triangulateConvexPolygon:function(e){for(var t=e.vertices,i=e.triangles,n=1,r=t.length-1;n<r;++n)i.push(0,n,n+1)},buildNormals:function(e){for(var t=0,i=this.createNormals(e),n=this.getNormals(),r=0,s=e.length;r<s;++r){for(var o=e[r],a=o.vertices,u=o.triangles,l=0,h=u.length;l<h;++l){var c=i[t+u[l]];n.push(c.x,c.y,c.z)}t+=a.length}},createNormals:function(e){var t=!this.ccw_.getValue(),i=this.coordIndex_,n=this.getCoord(),r=null;c.length=0,d.length=0;for(var s=0,o=e.length;s<o;++s){var a=e[s],u=a.vertices,l=u.length;switch(l){case 3:r=n.getNormal(i[u[0]],i[u[1]],i[u[2]]);break;case 4:r=n.getQuadNormal(i[u[0]],i[u[1]],i[u[2]],i[u[3]]);break;default:r=this.getPolygonNormal(u,i,n)}for(var h=0;h<l;++h){var p=i[u[h]];d[p]||(d[p]=[]),d[p].push(c.length+h)}t&&r.negate();for(var h=0,f=l;h<f;++h)c.push(r)}return this.refineNormals(d,c,this.creaseAngle_.getValue())},getPolygonNormal:function(e,t,i){var n=new s(0,0,0);i.get1Point(t[e[0]],f);for(var r=0,o=e.length;r<o;++r){var a=p;p=f,f=a,i.get1Point(t[e[(r+1)%o]],f),n.x+=(p.y-f.y)*(p.z+f.z),n.y+=(p.z-f.z)*(p.x+f.x),n.z+=(p.x-f.x)*(p.y+f.y)}return n.normalize()}}),u}),define("x_ite/Components/Rendering/X3DGeometricPropertyNode",["x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DGeometricPropertyNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i}),i}),define("x_ite/Components/Rendering/X3DCoordinateNode",["x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Bits/X3DConstants","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector3"],function(e,t,i,n){"use strict";function r(i){e.call(this,i),this.addType(t.X3DCoordinateNode)}return r.prototype=Object.assign(Object.create(e.prototype),{constructor:r,initialize:function(){e.prototype.initialize.call(this),this.point_.addInterest("set_point__",this),this.set_point__()},set_point__:function(){this.point=this.point_.getValue(),this.length=this.point_.length},isEmpty:function(){return 0===this.length},getSize:function(){return this.length},get1Point:function(e,t){if(e<this.length){const i=this.point;return e*=3,t.set(i[e],i[e+1],i[e+2])}return t.set(0,0,0)},addPoint:function(e,t){if(e<this.length){const i=this.point;e*=3,t.push(i[e],i[e+1],i[e+2],1)}else t.push(0,0,0,1)},addPoints:function(e,t){const i=this.point;for(var n=0,r=3*this.length;n<r;n+=3)e.push(i[n],i[n+1],i[n+2],1);for(var n=r,r=3*t;n<r;n+=3)e.push(0,0,0,1)},getNormal:function(){var e=new n(0,0,0),t=new n(0,0,0),r=new n(0,0,0);return function(s,o,a){var u=this.length;return s<u&&o<u&&a<u?i.normal(this.get1Point(s,e),this.get1Point(o,t),this.get1Point(a,r),new n(0,0,0)):new n(0,0,0)}}(),getQuadNormal:function(){var e=new n(0,0,0),t=new n(0,0,0),r=new n(0,0,0),s=new n(0,0,0);return function(o,a,u,l){var h=this.length;return o<h&&a<h&&u<h&&l<h?i.quadNormal(this.get1Point(o,e),this.get1Point(a,t),this.get1Point(u,r),this.get1Point(l,s),new n(0,0,0)):new n(0,0,0)}}()}),r}),define("x_ite/Components/Rendering/Coordinate",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DCoordinateNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.Coordinate),this.point_.setUnit("length")}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"point",new e.MFVec3f)]),getTypeName:function(){return"Coordinate"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"coord"}}),s}),define("x_ite/Components/Texturing/X3DTextureCoordinateNode",["x_ite/Fields","x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DConstants"],function(e,t,i,n){"use strict";function r(e){t.call(this,e),this.addType(n.X3DTextureCoordinateNode),this.texCoordArray=i.createArray()}return r.prototype=Object.assign(Object.create(t.prototype),{constructor:r,init:function(e){this.texCoordArray.length=0,e.push(this.texCoordArray)},addTexCoord:function(e,t){this.addTexCoordToChannel(e,t[0])}}),r}),define("x_ite/Components/Texturing/TextureCoordinate",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Texturing/X3DTextureCoordinateNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector4"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.TextureCoordinate)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"point",new e.MFVec2f)]),getTypeName:function(){return"TextureCoordinate"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texCoord"},initialize:function(){n.prototype.initialize.call(this),this.point_.addInterest("set_point__",this),this.set_point__()},set_point__:function(){this.point=this.point_.getValue(),this.length=this.point_.length},addTexCoordToChannel:function(e,t){if(e>=0&&e<this.length){var i=this.point;e*=2,t.push(i[e],i[e+1],0,1)}else t.push(0,0,0,1)},getTexCoord:function(e){for(var t=this.point_,i=0,n=t.length;i<n;++i){var r=t[i];e[i]=new s(r.x,r.y,0,1)}return e.length=n,e}}),o}),define("x_ite/Browser/Geometry2D/Rectangle2DOptions",["x_ite/Fields","x_ite/Basic/X3DBaseNode","x_ite/Components/Geometry3D/IndexedFaceSet","x_ite/Components/Rendering/Coordinate","x_ite/Components/Texturing/TextureCoordinate"],function(e,t,i,n,r){"use strict";function s(e){t.call(this,e)}return s.prototype=Object.assign(Object.create(t.prototype),{constructor:s,getTypeName:function(){return"Rectangle2DOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"rectangle2DOptions"},initialize:function(){t.prototype.initialize.call(this)},getGeometry:function(){if(this.geometry)return this.geometry;this.geometry=new i(this.getExecutionContext()),this.geometry.texCoord_=new r(this.getExecutionContext()),this.geometry.coord_=new n(this.getExecutionContext());var t=this.geometry,s=this.geometry.texCoord_.getValue(),o=this.geometry.coord_.getValue();return t.texCoordIndex_=new e.MFInt32(0,1,2,3,-1),t.coordIndex_=new e.MFInt32(0,1,2,3,-1),s.point_=new e.MFVec2f(new e.SFVec2f(1,1),new e.SFVec2f(0,1),new e.SFVec2f(0,0),new e.SFVec2f(1,0)),o.point_=new e.MFVec3f(new e.SFVec3f(1,1,0),new e.SFVec3f(-1,1,0),new e.SFVec3f(-1,-1,0),new e.SFVec3f(1,-1,0)),s.setup(),o.setup(),t.setup(),this.geometry}}),s}),define("x_ite/Browser/Geometry2D/X3DGeometry2DContext",["x_ite/Browser/Geometry2D/Arc2DOptions","x_ite/Browser/Geometry2D/ArcClose2DOptions","x_ite/Browser/Geometry2D/Circle2DOptions","x_ite/Browser/Geometry2D/Disk2DOptions","x_ite/Browser/Geometry2D/Rectangle2DOptions"],function(e,t,i,n,r){"use strict";function s(e,t){return this[e]?this[e]:(this[e]=new t(this.getPrivateScene()),this[e].setup(),this[e])}function o(){}return o.prototype={initialize:function(){},getArc2DOptions:function(){return s.call(this,"arc2DOptions",e)},getArcClose2DOptions:function(){return s.call(this,"arcClose2DOptions",t)},getCircle2DOptions:function(){return s.call(this,"circle2DOptions",i)},getDisk2DOptions:function(){return s.call(this,"disk2DOptions",n)},getRectangle2DOptions:function(){return s.call(this,"rectangle2DOptions",r)}},o}),define("x_ite/Browser/Geometry3D/BoxOptions",["x_ite/Fields","x_ite/Basic/X3DBaseNode","x_ite/Components/Geometry3D/IndexedFaceSet","x_ite/Components/Rendering/Coordinate","x_ite/Components/Texturing/TextureCoordinate"],function(e,t,i,n,r){"use strict";function s(e){t.call(this,e)}return s.prototype=Object.assign(Object.create(t.prototype),{constructor:s,getTypeName:function(){return"BoxOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"boxOptions"},initialize:function(){t.prototype.initialize.call(this)},getGeometry:function(){if(this.geometry)return this.geometry;this.geometry=new i(this.getExecutionContext()),this.geometry.texCoord_=new r(this.getExecutionContext()),this.geometry.coord_=new n(this.getExecutionContext());var t=this.geometry,s=this.geometry.texCoord_.getValue(),o=this.geometry.coord_.getValue();return t.texCoordIndex_=new e.MFInt32(0,1,2,3,-1,0,1,2,3,-1,0,1,2,3,-1,0,1,2,3,-1,0,1,2,3,-1,0,1,2,3,-1),t.coordIndex_=new e.MFInt32(0,1,2,3,-1,5,4,7,6,-1,1,5,6,2,-1,4,0,3,7,-1,4,5,1,0,-1,3,2,6,7,-1),s.point_=new e.MFVec2f(new e.SFVec2f(1,1),new e.SFVec2f(0,1),new e.SFVec2f(0,0),new e.SFVec2f(1,0)),o.point_=new e.MFVec3f(new e.SFVec3f(1,1,1),new e.SFVec3f(-1,1,1),new e.SFVec3f(-1,-1,1),new e.SFVec3f(1,-1,1),new e.SFVec3f(1,1,-1),new e.SFVec3f(-1,1,-1),new e.SFVec3f(-1,-1,-1),new e.SFVec3f(1,-1,-1)),s.setup(),o.setup(),t.setup(),this.geometry}}),s}),define("x_ite/Browser/Geometry3D/ConeOptions",["x_ite/Fields","x_ite/Basic/X3DBaseNode"],function(e,t){"use strict";function i(i){t.call(this,i),this.addChildObjects("xDimension",new e.SFInt32(20),"yDimension",new e.SFInt32(1))}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,getTypeName:function(){return"ConeOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"coneOptions"}}),i}),define("x_ite/Browser/Geometry3D/CylinderOptions",["x_ite/Fields","x_ite/Basic/X3DBaseNode"],function(e,t){"use strict";function i(i){t.call(this,i),this.addChildObjects("xDimension",new e.SFInt32(20),"yDimension",new e.SFInt32(1))}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,getTypeName:function(){return"CylinderOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"cylinderOptions"}}),i}),define("x_ite/Browser/Geometry3D/QuadSphereOptions",["x_ite/Fields","x_ite/Basic/X3DBaseNode","x_ite/Components/Geometry3D/IndexedFaceSet","x_ite/Components/Rendering/Coordinate","x_ite/Components/Texturing/TextureCoordinate","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,s,o,a){"use strict";function u(i){t.call(this,i),this.addChildObjects("xDimension",new e.SFInt32(32),"yDimension",new e.SFInt32(15))}return u.prototype=Object.assign(Object.create(t.prototype),{constructor:u,getTypeName:function(){return"QuadSphereOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"quadSphereOptions"},initialize:function(){t.prototype.initialize.call(this),this.addInterest("eventsProcessed",this)},getGeometry:function(){return this.geometry||this.eventsProcessed(),this.geometry},createTexCoordIndex:function(){for(var e=this.xDimension_.getValue()+1,t=this.yDimension_.getValue(),i=this.geometry.texCoordIndex_,n=0,r=e-1;n<r;++n)i.push(n),i.push(n+e-1),i.push(n+e),i.push(-1);for(var s=e-1,o=0,a=t-3;o<a;++o,++s)for(var n=0,r=e-1;n<r;++n,++s)i.push(s),i.push(s+e),i.push(s+e+1),i.push(s+1),i.push(-1);for(var s=(t-2)*e-1,n=0,r=e-1;n<r;++n,++s)i.push(s+e),i.push(s+1),i.push(s),i.push(-1)},createTexCoord:function(){for(var e=this.xDimension_.getValue()+1,t=this.yDimension_.getValue(),i=this.geometry.texCoord_.getValue().point_,n=-.5/(e-1),r=1;r<e;++r){var s=r/(e-1)+n;i.push(new o(s,1))}for(var a=1,u=t-1;a<u;++a)for(var l=1-a/(t-1),r=0;r<e;++r){var s=r/(e-1);i.push(new o(s,l))}for(var r=1;r<e;++r){var s=r/(e-1)+n;i.push(new o(s,0))}},createCoordIndex:function(){for(var e=this.xDimension_.getValue()+1,t=this.yDimension_.getValue(),i=this.geometry.coordIndex_,n=1,r=e-1;n<r;++n)i.push(0),i.push(n),i.push(n+1),i.push(-1);i.push(0),i.push(n),i.push(1),i.push(-1);for(var s=1,o=0,a=t-3;o<a;++o,++s){for(var n=0,r=e-2;n<r;++n,++s)i.push(s),i.push(s+e-1),i.push(s+e),i.push(s+1),i.push(-1);i.push(s),i.push(s+e-1),i.push(s+1),i.push(s-e+2),i.push(-1)}for(var u=s+e-1,n=0,r=e-2;n<r;++n,++s)i.push(u),i.push(s+1),i.push(s),i.push(-1);i.push(u),i.push(u-e+1),i.push(s),i.push(-1)},createPoints:function(){var e=this.xDimension_.getValue()+1,t=this.yDimension_.getValue(),i=this.geometry.coord_.getValue().point_;i.push(new a(0,1,0));for(var n=1,r=t-1;n<r;++n)for(var o=s.Polar(1,-Math.PI*n/r),u=0,l=e-1;u<l;++u){var h=s.Polar(o.imag,2*Math.PI*u/l);i.push(new a(h.imag,o.real,h.real))}i.push(new a(0,-1,0))},eventsProcessed:function(){this.geometry=new i(this.getExecutionContext()),this.geometry.texCoord_=new r(this.getExecutionContext()),this.geometry.coord_=new n(this.getExecutionContext()),this.createTexCoordIndex(),this.createTexCoord(),this.createCoordIndex(),this.createPoints();var e=this.geometry,t=this.geometry.texCoord_.getValue(),s=this.geometry.coord_.getValue();e.creaseAngle_=Math.PI,
t.setup(),s.setup(),e.setup()}}),u}),define("x_ite/Browser/Geometry3D/X3DGeometry3DContext",["x_ite/Browser/Geometry3D/BoxOptions","x_ite/Browser/Geometry3D/ConeOptions","x_ite/Browser/Geometry3D/CylinderOptions","x_ite/Browser/Geometry3D/QuadSphereOptions"],function(e,t,i,n){"use strict";function r(e,t){return this[e]?this[e]:(this[e]=new t(this.getPrivateScene()),this[e].setup(),this[e])}function s(){}return s.prototype={initialize:function(){},getBoxOptions:function(){return r.call(this,"boxOptions",e)},getConeOptions:function(){return r.call(this,"coneOptions",t)},getCylinderOptions:function(){return r.call(this,"cylinderOptions",i)},getSphereOptions:function(){return r.call(this,"sphereOptions",n)}},s}),define("x_ite/Browser/PointingDeviceSensor/PointingDevice",["jquery","x_ite/Basic/X3DBaseNode"],function(e,t){"use strict";function i(e){t.call(this,e),this.cursor="DEFAULT",this.isOver=!1,this.motionTime=0}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,initialize:function(){var e=this.getBrowser().getElement();e.bind("mousedown.PointingDevice"+this.getId(),this.mousedown.bind(this)),e.bind("mouseup.PointingDevice"+this.getId(),this.mouseup.bind(this)),e.bind("dblclick.PointingDevice"+this.getId(),this.dblclick.bind(this)),e.bind("mousemove.PointingDevice"+this.getId(),this.mousemove.bind(this)),e.bind("mouseout.PointingDevice"+this.getId(),this.onmouseout.bind(this)),e.bind("touchstart.PointingDevice"+this.getId(),this.touchstart.bind(this)),e.bind("touchend.PointingDevice"+this.getId(),this.touchend.bind(this))},mousewheel:function(e){},mousedown:function(t){var i=this.getBrowser();if(i.getElement().focus(),!(i.getShiftKey()&&i.getControlKey()||0!==t.button)){var n=i.getElement(),r=n.offset(),s=t.pageX-r.left,o=n.height()-(t.pageY-r.top);n.unbind("mousemove.PointingDevice"+this.getId()),e(document).bind("mouseup.PointingDevice"+this.getId(),this.mouseup.bind(this)),e(document).bind("mousemove.PointingDevice"+this.getId(),this.mousemove.bind(this)),e(document).bind("touchend.PointingDevice"+this.getId(),this.touchend.bind(this)),e(document).bind("touchmove.PointingDevice"+this.getId(),this.touchmove.bind(this)),i.buttonPressEvent(s,o)&&(t.preventDefault(),t.stopImmediatePropagation(),i.setCursor("HAND"),i.finished().addInterest("onverifymotion",this,s,o))}},mouseup:function(t){if(t.preventDefault(),0===t.button){var i=this.getBrowser(),n=i.getElement(),r=n.offset(),s=t.pageX-r.left,o=n.height()-(t.pageY-r.top);e(document).unbind(".PointingDevice"+this.getId()),n.bind("mousemove.PointingDevice"+this.getId(),this.mousemove.bind(this)),i.buttonReleaseEvent(),i.setCursor(this.isOver?"HAND":"DEFAULT"),i.finished().addInterest("onverifymotion",this,s,o),i.addBrowserEvent(),this.cursor="DEFAULT"}},dblclick:function(e){this.isOver&&e.stopImmediatePropagation()},mousemove:function(e){e.preventDefault();var t=this.getBrowser();if(this.motionTime!==t.getCurrentTime()){this.motionTime=t.getCurrentTime();var i=t.getElement(),n=i.offset(),r=e.pageX-n.left,s=i.height()-(e.pageY-n.top);this.onmotion(r,s)}},touchstart:function(e){var t=e.originalEvent.touches;switch(t.length){case 1:e.button=0,e.pageX=t[0].pageX,e.pageY=t[0].pageY,this.mousedown(e);break;case 2:this.touchend(e)}},touchend:function(e){this.getBrowser();e.button=0,this.mouseup(e)},touchmove:function(e){var t=e.originalEvent.touches;switch(t.length){case 1:e.button=0,e.pageX=t[0].pageX,e.pageY=t[0].pageY,this.mousemove(e)}},onmotion:function(e,t){var i=this.getBrowser();i.motionNotifyEvent(e,t)?this.isOver||(this.isOver=!0,this.cursor=i.getCursor(),i.setCursor("HAND")):this.isOver&&(this.isOver=!1,i.setCursor(this.cursor))},onmouseout:function(e){this.getBrowser().leaveNotifyEvent()},onverifymotion:function(e,t,i){this.getBrowser().finished().removeInterest("onverifymotion",this),this.onmotion(t,i)}}),i}),define("standard/Math/Algorithms/MergeSort",[],function(){"use strict";function e(e,t){this.array=e,this.auxiliary=[],t&&(this.compare=t)}return e.prototype={compare:function(e,t){return e<t},sort:function(e,t){this.mergeSort(e,t-1)},mergeSort:function(e,t){if(e<t){var i=e+t>>>1;this.mergeSort(e,i),this.mergeSort(i+1,t),this.merge(e,i,t)}},merge:function(e,t,i){var n,r,s;for(n=0,r=e;r<=t;)this.auxiliary[n++]=this.array[r++];for(n=0,s=e;s<r&&r<=i;)this.compare(this.array[r],this.auxiliary[n])?this.array[s++]=this.array[r++]:this.array[s++]=this.auxiliary[n++];for(;s<r;)this.array[s++]=this.auxiliary[n++]}},e}),define("x_ite/Browser/PointingDeviceSensor/X3DPointingDeviceSensorContext",["jquery","x_ite/Browser/PointingDeviceSensor/PointingDevice","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Geometry/Line3","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Algorithms/MergeSort","standard/Math/Algorithm"],function(e,t,i,n,r,s,o,a,u,l,h){"use strict";function c(){this.pointingDevice=new t(this),this.pointer=new o(0,0),this.hitRay=new r(a.Zero,a.Zero),this.hits=[],this.enabledSensors=[{}],this.selectedLayer=null,this.overSensors={},this.activeSensors={},this.hitPointSorter=new l(this.hits,function(e,t){return e.intersection.point.z<t.intersection.point.z}),this.layerSorter=new l(this.hits,function(e,t){return e.layerNumber<t.layerNumber}),this.pickingTime=0}var d=new r(a.Zero,a.Zero);return c.prototype={initialize:function(){this.getElement().attr("tabindex",this.getElement().attr("tabindex")||0),this.setCursor("DEFAULT"),this.pointingDevice.setup()},setCursor:function(e){this.cursorType=e;var t=this.getElement().find(".x_ite-private-surface");switch(e){case"HAND":t.css("cursor","pointer");break;case"MOVE":t.css("cursor","move");break;case"CROSSHAIR":t.css("cursor","crosshair");break;default:this.loadCount_.getValue()?t.css("cursor","wait"):this.pointingDevice&&this.pointingDevice.isOver?t.css("cursor","pointer"):t.css("cursor","default")}},getCursor:function(){return this.cursorType},isPointerInRectangle:function(e){return this.pointer.x>e.x&&this.pointer.x<e.x+e.z&&this.pointer.y>e.y&&this.pointer.y<e.y+e.w},setLayerNumber:function(e){this.layerNumber=e},getSelectedLayer:function(){return this.selectedLayer},setHitRay:function(e,t){try{s.unProjectRay(this.pointer.x,this.pointer.y,u.Identity,e,t,this.hitRay)}catch(e){this.hitRay.set(a.Zero,a.Zero)}},getHitRay:function(){return this.hitRay},getSensors:function(){return this.enabledSensors},addHit:function(e,t,i,n){this.hits.push({pointer:this.pointer,hitRay:this.hitRay.copy(),intersection:e,sensors:this.enabledSensors[this.enabledSensors.length-1],layer:t,layerNumber:this.layerNumber,shape:i,modelViewMatrix:n.copy()})},getHits:function(){return this.hits},getNearestHit:function(){return this.hits[this.hits.length-1]},buttonPressEvent:function(t,i){if(this.touch(t,i),0===this.hits.length)return!1;var n=this.getNearestHit();this.selectedLayer=n.layer,this.activeSensors=n.sensors;for(var r in this.activeSensors)this.activeSensors[r].set_active__(!0,n);return!e.isEmptyObject(n.sensors)},buttonReleaseEvent:function(){this.selectedLayer=null;for(var e in this.activeSensors)this.activeSensors[e].set_active__(!1,null);return this.activeSensors={},!0},motionNotifyEvent:function(t,i){return this.touch(t,i),this.motion(),this.hits.length&&!e.isEmptyObject(this.hits[this.hits.length-1].sensors)},leaveNotifyEvent:function(){},touch:function(e,t){var n=performance.now();this.pointer.set(e,t),this.hits.length=0,this.getWorld().traverse(i.POINTER,null),this.hitPointSorter.sort(0,this.hits.length),this.layerSorter.sort(0,this.hits.length),this.addBrowserEvent(),this.pickingTime=performance.now()-n},motion:function(){if(this.hits.length)var e=this.hits[this.hits.length-1];else var t=this.selectedLayer?this.hitRay:d,e={pointer:this.pointer,modelViewMatrix:new u,hitRay:t,intersection:null,sensors:{},shape:null,layer:null,layerNumber:0};if(this.hits.length)var i=h.set_difference(this.overSensors,e.sensors,{},function(e,t){return e.getNode()<t.getNode()});else var i=Object.assign({},this.overSensors);for(var n in i)i[n].set_over__(!1,e);if(this.hits.length){this.overSensors=e.sensors;for(var n in this.overSensors)this.overSensors[n].set_over__(!0,e)}else this.overSensors={};for(var n in this.activeSensors)this.activeSensors[n].set_motion__(e)}},c}),define("x_ite/Browser/KeyDeviceSensor/X3DKeyDeviceSensorContext",["x_ite/Fields"],function(e){"use strict";function t(){this.addChildObjects("controlKey",new e.SFBool,"shiftKey",new e.SFBool,"altKey",new e.SFBool,"altGrKey",new e.SFBool),this.keyDeviceSensorNodes=new Set}return t.prototype={initialize:function(){this.getElement().bind("keydown.X3DKeyDeviceSensorContext",this.keydown.bind(this)),this.getElement().bind("keyup.X3DKeyDeviceSensorContext",this.keyup.bind(this))},addKeyDeviceSensorNode:function(e){this.keyDeviceSensorNodes.add(e)},removeKeyDeviceSensorNode:function(e){this.keyDeviceSensorNodes.delete(e)},getShiftKey:function(){return this.shiftKey_.getValue()},getControlKey:function(){return this.controlKey_.getValue()},getAltKey:function(){return this.altKey_.getValue()},getAltGrKey:function(){return this.altGrKey_.getValue()},keydown:function(e){switch(this.keyDeviceSensorNodes.forEach(function(t){t.keydown(e)}),e.keyCode){case 16:this.shiftKey_=!0;break;case 17:this.controlKey_=!0;break;case 18:this.altKey_=!0;break;case 49:this.getDebug()&&this.getControlKey()&&(e.preventDefault(),this.setBrowserOption("Shading","POINT"),this.getNotification().string_="Shading: Pointset");break;case 50:this.getDebug()&&this.getControlKey()&&(e.preventDefault(),this.setBrowserOption("Shading","WIREFRAME"),this.getNotification().string_="Shading: Wireframe");break;case 51:this.getDebug()&&this.getControlKey()&&(e.preventDefault(),this.setBrowserOption("Shading","FLAT"),this.getNotification().string_="Shading: Flat");break;case 52:this.getDebug()&&this.getControlKey()&&(e.preventDefault(),this.setBrowserOption("Shading","GOURAUD"),this.getNotification().string_="Shading: Gouraud");break;case 53:this.getDebug()&&this.getControlKey()&&(e.preventDefault(),this.setBrowserOption("Shading","PHONG"),this.getNotification().string_="Shading: Phong");break;case 83:this.getDebug()&&this.getControlKey()&&(e.preventDefault(),this.isLive().getValue()?this.endUpdate():this.beginUpdate(),this.getNotification().string_=this.isLive().getValue()?"Begin Update":"End Update");break;case 225:this.altGrKey_=!0;break;case 171:case 187:this.getControlKey()&&(e.preventDefault(),this.getBrowserTimings().setEnabled(!this.getBrowserTimings().getEnabled()));break;case 36:e.preventDefault(),this.firstViewpoint();break;case 35:e.preventDefault(),this.lastViewpoint();break;case 33:e.preventDefault(),this.previousViewpoint();break;case 34:e.preventDefault(),this.nextViewpoint()}},keyup:function(e){switch(e.preventDefault(),e.stopImmediatePropagation(),this.keyDeviceSensorNodes.forEach(function(t){t.keyup(e)}),e.which){case 16:this.shiftKey_=!1;break;case 17:this.controlKey_=!1;break;case 18:this.altKey_=!1;break;case 225:this.altGrKey_=!1}}},t}),define("x_ite/Browser/Navigation/X3DViewer",["x_ite/Basic/X3DBaseNode","x_ite/Components/Navigation/OrthoViewpoint","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Box3","standard/Math/Geometry/ViewVolume"],function(e,t,i,n,r,s){"use strict";function o(t){e.call(this,t)}function a(e,t,i){var n=Math.sqrt(t*t+i*i);if(n<e*Math.sqrt(.5))return Math.sqrt(e*e-n*n);var r=e/Math.sqrt(2);return r*r/n}var u=new i(0,0,0),l=new i(0,0,0),h=new i(0,0,0);return o.prototype=Object.assign(Object.create(e.prototype),{constructor:o,initialize:function(){},getActiveLayer:function(){return this.getBrowser().getActiveLayer()},getViewport:function(){return this.getBrowser().getActiveLayer().getViewport()},getNavigationInfo:function(){return this.getBrowser().getActiveLayer().getNavigationInfo()},getActiveViewpoint:function(){return this.getBrowser().getActiveLayer().getViewpoint()},getPointOnCenterPlane:function(e,i,r){try{var o=this.getNavigationInfo(),a=this.getActiveViewpoint(),c=this.getViewport().getRectangle(this.getBrowser()),d=a.getProjectionMatrixWithLimits(o.getNearValue(),o.getFarValue(a),c);if(s.unProjectPoint(e,this.getBrowser().getViewport()[3]-i,.9,n.Identity,d,c,h),a instanceof t)return r.set(h.x,h.y,-this.getDistanceToCenter(l).abs());var p=h.normalize();return r.assign(p).multiply(this.getDistanceToCenter(l).abs()/p.dot(u.set(0,0,-1)))}catch(e){return console.log(e),r.set(0,0,0)}},getDistanceToCenter:function(e,t){var i=this.getActiveViewpoint();return e.assign(i.getPosition()).add(t||i.positionOffset_.getValue()).subtract(i.getUserCenterOfRotation())},trackballProjectToSphere:function(e,t,i){return e=e/this.getBrowser().getViewport()[2]-.5,t=-t/this.getBrowser().getViewport()[3]+.5,i.set(e,t,a(.5,e,t))},lookAtPoint:function(){new r;return function(e,t,i){if(this.touch(e,t)){var n=this.getBrowser().getNearestHit();this.getActiveViewpoint().lookAtPoint(n.intersection.point,.381966,i)}}}(),lookAtBBox:function(){var e=new r;return function(t,i,n){if(this.touch(t,i)){var r=this.getBrowser().getNearestHit();r.shape.getBBox(e).multRight(r.modelViewMatrix),this.getActiveViewpoint().lookAtBBox(e,.381966,n)}}}(),touch:function(e,t){return this.getBrowser().touch(e,t),this.getBrowser().getHits().length},dispose:function(){}}),o});define("x_ite/Components/Followers/X3DFollowerNode",["x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DFollowerNode),this.buffer=[],this.a=this.getVector(),this.vector=this.getVector()}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,initialize:function(){e.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this)},duplicate:function(e){return e.copy()},getBuffer:function(){return this.buffer},getValue:function(){return this.set_value_.getValue()},getDestination:function(){return this.set_destination_.getValue()},getInitialValue:function(){return this.initialValue_.getValue()},getInitialDestination:function(){return this.initialDestination_.getValue()},setValue:function(e){this.value_changed_=e},setDestination:function(e){this.destination.assign(e)},assign:function(e,t,i){e[t].assign(i)},equals:function(e,t,i){return this.a.assign(e).subtract(t).abs()<i},interpolate:function(e,t,i){return this.vector.assign(e).lerp(t,i)},set_live__:function(){(this.isLive().getValue()||this.getPrivate())&&this.isActive_.getValue()?(this.getBrowser().prepareEvents().addInterest("prepareEvents",this),this.getBrowser().addBrowserEvent()):this.getBrowser().prepareEvents().removeInterest("prepareEvents",this)},set_active:function(e){e!==this.isActive_.getValue()&&(this.isActive_=e,this.set_live__())}}),i}),define("x_ite/Components/Followers/X3DChaserNode",["x_ite/Components/Followers/X3DFollowerNode","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DChaserNode),this.destination=null,this.previousValue=null,this.bufferEndTime=0,this.stepTime=0,this.deltaOut=this.getArray()}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,initialize:function(){e.prototype.initialize.call(this),this.set_value_.addInterest("set_value__",this),this.set_destination_.addInterest("set_destination__",this),this.duration_.addInterest("set_duration__",this),this.set_duration__();var t=this.getBuffer(),i=this.getInitialValue(),n=this.getInitialDestination(),r=this.getNumBuffers();this.bufferEndTime=this.getBrowser().getCurrentTime(),this.previousValue=this.duplicate(i),t[0]=this.duplicate(n);for(var s=1;s<r;++s)t[s]=this.duplicate(i);this.destination=this.duplicate(n),this.equals(n,i,this.getTolerance())?this.setValue(n):this.set_active(!0)},getNumBuffers:function(){return 60},getTolerance:function(){return 1e-8},getArray:function(){return this.getVector()},setPreviousValue:function(e){this.previousValue.assign(e)},step:function(e,t,i){this.output.add(this.deltaOut.assign(e).subtract(t).multiply(i))},stepResponse:function(e){if(e<=0)return 0;var t=this.duration_.getValue();return e>=t?1:.5-.5*Math.cos(e/t*Math.PI)},set_value__:function(){this.isActive_.getValue()||(this.bufferEndTime=this.getBrowser().getCurrentTime());for(var e=this.getBuffer(),t=this.getValue(),i=0,n=e.length;i<n;++i)this.assign(e,i,t);this.setPreviousValue(t),this.setValue(t),this.set_active(!0)},set_destination__:function(){this.setDestination(this.getDestination()),this.isActive_.getValue()||(this.bufferEndTime=this.getBrowser().getCurrentTime()),this.set_active(!0)},set_duration__:function(){this.stepTime=this.duration_.getValue()/this.getNumBuffers()},prepareEvents:function(){try{var e=this.getBuffer(),t=e.length,i=this.updateBuffer();this.output=this.interpolate(this.previousValue,e[t-1],this.stepResponse((t-1+i)*this.stepTime));for(var n=t-2;n>=0;--n)this.step(e[n],e[n+1],this.stepResponse((n+i)*this.stepTime));this.setValue(this.output),this.equals(this.output,this.destination,this.getTolerance())&&this.set_active(!1)}catch(e){}},updateBuffer:function(){var e=this.getBuffer(),t=e.length,i=(this.getBrowser().getCurrentTime()-this.bufferEndTime)/this.stepTime;if(i>=1){var n=Math.floor(i);if(i-=n,n<t){this.setPreviousValue(e[t-n]);for(var r=t-1;r>=n;--r)this.assign(e,r,e[r-n]);for(var r=0;r<n;++r)try{var s=r/n;this.assign(e,r,this.interpolate(this.destination,e[n],s))}catch(e){}}else{this.setPreviousValue(n==t?e[0]:this.destination);for(var r=0;r<t;++r)this.assign(e,r,this.destination)}this.bufferEndTime+=n*this.stepTime}return i}}),i}),define("x_ite/Components/Followers/PositionChaser",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.PositionChaser)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_value",new e.SFVec3f),new t(r.inputOnly,"set_destination",new e.SFVec3f),new t(r.initializeOnly,"initialValue",new e.SFVec3f),new t(r.initializeOnly,"initialDestination",new e.SFVec3f),new t(r.initializeOnly,"duration",new e.SFTime(1)),new t(r.outputOnly,"isActive",new e.SFBool),new t(r.outputOnly,"value_changed",new e.SFVec3f)]),getTypeName:function(){return"PositionChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0,0)}}),o}),define("x_ite/Components/Followers/OrientationChaser",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Rotation4"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.OrientationChaser)}var a=new s(0,0,1,0),u=new s(0,0,1,0);return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_value",new e.SFRotation),new t(r.inputOnly,"set_destination",new e.SFRotation),new t(r.initializeOnly,"initialValue",new e.SFRotation),new t(r.initializeOnly,"initialDestination",new e.SFRotation),new t(r.initializeOnly,"duration",new e.SFTime(1)),new t(r.outputOnly,"isActive",new e.SFBool),new t(r.outputOnly,"value_changed",new e.SFRotation)]),getTypeName:function(){return"OrientationChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0,1,0)},equals:function(e,t,i){return a.assign(e).inverse().multRight(t),Math.abs(a.angle)<i},interpolate:function(e,t,i){return u.assign(e).slerp(t,i)},step:function(e,t,i){this.deltaOut.assign(t).inverse().multRight(e).multLeft(this.output),this.output.slerp(this.deltaOut,i)}}),o}),function(e){"function"==typeof define&&define.amd?define("jquery-mousewheel/jquery.mousewheel",["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(e){function t(t){var o=t||window.event,a=u.call(arguments,1),l=0,c=0,d=0,p=0,f=0,g=0;if(t=e.event.fix(o),t.type="mousewheel","detail"in o&&(d=o.detail*-1),"wheelDelta"in o&&(d=o.wheelDelta),"wheelDeltaY"in o&&(d=o.wheelDeltaY),"wheelDeltaX"in o&&(c=o.wheelDeltaX*-1),"axis"in o&&o.axis===o.HORIZONTAL_AXIS&&(c=d*-1,d=0),l=0===d?c:d,"deltaY"in o&&(d=o.deltaY*-1,l=d),"deltaX"in o&&(c=o.deltaX,0===d&&(l=c*-1)),0!==d||0!==c){if(1===o.deltaMode){var m=e.data(this,"mousewheel-line-height");l*=m,d*=m,c*=m}else if(2===o.deltaMode){var _=e.data(this,"mousewheel-page-height");l*=_,d*=_,c*=_}if(p=Math.max(Math.abs(d),Math.abs(c)),(!s||p<s)&&(s=p,n(o,p)&&(s/=40)),n(o,p)&&(l/=40,c/=40,d/=40),l=Math[l>=1?"floor":"ceil"](l/s),c=Math[c>=1?"floor":"ceil"](c/s),d=Math[d>=1?"floor":"ceil"](d/s),h.settings.normalizeOffset&&this.getBoundingClientRect){var x=this.getBoundingClientRect();f=t.clientX-x.left,g=t.clientY-x.top}return t.deltaX=c,t.deltaY=d,t.deltaFactor=s,t.offsetX=f,t.offsetY=g,t.deltaMode=0,a.unshift(t,l,c,d),r&&clearTimeout(r),r=setTimeout(i,200),(e.event.dispatch||e.event.handle).apply(this,a)}}function i(){s=null}function n(e,t){return h.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120==0}var r,s,o=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],a="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],u=Array.prototype.slice;if(e.event.fixHooks)for(var l=o.length;l;)e.event.fixHooks[o[--l]]=e.event.mouseHooks;var h=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var i=a.length;i;)this.addEventListener(a[--i],t,!1);else this.onmousewheel=t;e.data(this,"mousewheel-line-height",h.getLineHeight(this)),e.data(this,"mousewheel-page-height",h.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var i=a.length;i;)this.removeEventListener(a[--i],t,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var i=e(t),n=i["offsetParent"in e.fn?"offsetParent":"parent"]();return n.length||(n=e("body")),parseInt(n.css("fontSize"),10)||parseInt(i.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),define("jquery-mousewheel",["jquery-mousewheel/jquery.mousewheel"],function(e){return e}),define("x_ite/Browser/Navigation/ExamineViewer",["jquery","x_ite/Browser/Navigation/X3DViewer","x_ite/Components/Followers/PositionChaser","x_ite/Components/Followers/OrientationChaser","x_ite/Components/Geospatial/GeoViewpoint","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","jquery-mousewheel"],function(e,t,i,n,r,s,o,a){"use strict";function u(e){t.call(this,e),this.button=-1,this.orientationOffset=new a(0,0,1,0),this.fromVector=new o(0,0,0),this.toVector=new o(0,0,0),this.fromPoint=new o(0,0,0),this.toPoint=new o(0,0,0),this.rotation=new a(0,0,1,0),this.pressTime=0,this.motionTime=0,this.touch1=new s(0,0),this.touch2=new s(0,0),this.tapStart=0,this.dblTapInterval=.4,this.initialPositionOffset=new o(0,0,0),this.initialOrientationOffset=new a(0,0,1,0),this.positionChaser=new i(e),this.centerOfRotationChaser=new i(e),this.rotationChaser=new n(e)}return u.prototype=Object.assign(Object.create(t.prototype),{constructor:u,initialize:function(){t.prototype.initialize.call(this);var e=this.getBrowser(),i=e.getElement();this.getNavigationInfo().transitionStart_.addInterest("disconnect",this),e.activeViewpoint_.addInterest("set_activeViewpoint__",this),i.bind("mousedown.ExamineViewer",this.mousedown.bind(this)),i.bind("mouseup.ExamineViewer",this.mouseup.bind(this)),i.bind("dblclick.ExamineViewer",this.dblclick.bind(this)),i.bind("mousewheel.ExamineViewer",this.mousewheel.bind(this)),i.bind("touchstart.ExamineViewer",this.touchstart.bind(this)),i.bind("touchend.ExamineViewer",this.touchend.bind(this)),this.positionChaser.duration_=.2,this.positionChaser.setPrivate(!0),this.positionChaser.setup(),this.centerOfRotationChaser.duration_=.2,this.centerOfRotationChaser.setPrivate(!0),this.centerOfRotationChaser.setup(),this.rotationChaser.duration_=.2,this.rotationChaser.setPrivate(!0),this.rotationChaser.setup(),this.set_activeViewpoint__()},set_activeViewpoint__:function(){if(this.getBrowser().getBrowserOption("StraightenHorizon")){var e=this.getActiveViewpoint();e&&(e.orientationOffset_=this.getOrientationOffset(a.Identity,e.orientationOffset_.getValue(),!1))}this.disconnect()},mousedown:function(t){if(!(this.button>=0)){this.pressTime=performance.now();var i=this.getBrowser().getElement().offset(),n=t.pageX-i.left,r=t.pageY-i.top;switch(t.button){case 0:t.preventDefault(),t.stopImmediatePropagation(),this.button=t.button,e(document).bind("mouseup.ExamineViewer"+this.getId(),this.mouseup.bind(this)),e(document).bind("mousemove.ExamineViewer"+this.getId(),this.mousemove.bind(this)),e(document).bind("touchend.ExamineViewer"+this.getId(),this.touchend.bind(this)),e(document).bind("touchmove.ExamineViewer"+this.getId(),this.touchmove.bind(this)),this.disconnect(),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.trackballProjectToSphere(n,r,this.fromVector),this.rotation.assign(a.Identity),this.motionTime=0;break;case 1:t.preventDefault(),t.stopImmediatePropagation(),this.button=t.button,e(document).bind("mouseup.ExamineViewer"+this.getId(),this.mouseup.bind(this)),e(document).bind("mousemove.ExamineViewer"+this.getId(),this.mousemove.bind(this)),e(document).bind("touchend.ExamineViewer"+this.getId(),this.touchend.bind(this)),e(document).bind("touchmove.ExamineViewer"+this.getId(),this.touchmove.bind(this)),this.disconnect(),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.getPointOnCenterPlane(n,r,this.fromPoint)}}},mouseup:function(t){if(t.button===this.button)switch(this.button=-1,e(document).unbind(".ExamineViewer"+this.getId()),t.button){case 0:t.preventDefault(),t.stopImmediatePropagation();var i=this.getActiveViewpoint();this.getBrowser().setCursor("DEFAULT"),Math.abs(this.rotation.angle)>.003&&performance.now()-this.motionTime<40&&(!this.getBrowser().getBrowserOption("StraightenHorizon")||i instanceof r||(this.rotation=this.getHorizonRotation(this.rotation)),this.addSpinning(this.rotation));break;case 1:t.preventDefault(),t.stopImmediatePropagation(),this.getBrowser().setCursor("DEFAULT")}},dblclick:function(e){e.preventDefault(),e.stopImmediatePropagation();var t=this.getBrowser().getElement().offset(),i=e.pageX-t.left,n=this.getBrowser().getElement().height()-(e.pageY-t.top);this.disconnect(),this.lookAtBBox(i,n,this.getBrowser().getBrowserOption("StraightenHorizon"))},mousemove:function(){var e=new o(0,0,0);return function(t){var i=this.getBrowser().getElement().offset(),n=t.pageX-i.left,r=t.pageY-i.top;switch(this.button){case 0:t.preventDefault(),t.stopImmediatePropagation();var s=this.trackballProjectToSphere(n,r,this.toVector);if(this.rotation.setFromToVec(s,this.fromVector),Math.abs(this.rotation.angle)<.003&&performance.now()-this.pressTime<50)return;this.addRotate(this.rotation),this.fromVector.assign(s),this.motionTime=performance.now();break;case 1:t.preventDefault(),t.stopImmediatePropagation();var o=this.getActiveViewpoint(),a=this.getPointOnCenterPlane(n,r,this.toPoint),u=o.getUserOrientation().multVecRot(e.assign(this.fromPoint).subtract(a));this.addMove(u,u),this.fromPoint.assign(a)}}}(),mousewheel:function(){var e=new o(0,0,0),t=new o(0,0,0);return function(i){i.preventDefault(),i.stopImmediatePropagation();var n=this.getBrowser(),r=this.getActiveViewpoint();n.prepareEvents().removeInterest("spin",this),r.transitionStop(),e=this.getDistanceToCenter(e).multiply(i.zoomFactor||.05),t=r.getUserOrientation().multVecRot(t.set(0,0,e.abs())),i.deltaY>0?this.addMove(t.negate(),o.Zero):i.deltaY<0&&this.addMove(t,o.Zero)}}(),touchstart:function(e){var t=e.originalEvent.touches;switch(t.length){case 1:e.button=0,e.pageX=t[0].pageX,e.pageY=t[0].pageY,this.mousedown(e),this.touch1.set(t[0].pageX,t[0].pageY);break;case 2:this.touchend(e),e.button=1,e.pageX=(t[0].pageX+t[1].pageX)/2,e.pageY=(t[0].pageY+t[1].pageY)/2,this.mousedown(e),this.touch1.set(t[0].pageX,t[0].pageY),this.touch2.set(t[1].pageX,t[1].pageY);break;case 3:this.touchend(e)}},touchend:function(e){switch(this.button){case 0:e.button=0,this.mouseup(e),this.getBrowser().getCurrentTime()-this.tapStart<this.dblTapInterval&&(e.button=0,e.pageX=this.touch1.x,e.pageY=this.touch1.y,this.dblclick(e)),this.tapStart=this.getBrowser().getCurrentTime();break;case 1:e.button=1,this.mouseup(e)}},touchmove:function(){var t=new s(0,0),i=new s(0,0);return function(n){var r=n.originalEvent.touches;switch(r.length){case 1:n.pageX=r[0].pageX,n.pageY=r[0].pageY,this.mousemove(n);break;case 2:t.set(r[0].pageX,r[0].pageY).subtract(this.touch1).normalize(),i.set(r[1].pageX,r[1].pageY).subtract(this.touch2).normalize();var s=t.dot(i)>.7,o=t.dot(i)<-.7;if(s)n.pageX=(r[0].pageX+r[1].pageX)/2,n.pageY=(r[0].pageY+r[1].pageY)/2,this.mousemove(n);else if(o){var a=this.touch1.distance(this.touch2);this.touch1.set(r[0].pageX,r[0].pageY),this.touch2.set(r[1].pageX,r[1].pageY);var u=this.touch1.distance(this.touch2),l=u-a;n.deltaY=l,n.zoomFactor=Math.abs(l)/e(window).width(),this.mousewheel(n)}this.touch1.set(r[0].pageX,r[0].pageY),this.touch2.set(r[1].pageX,r[1].pageY)}}}(),spin:function(){var e=this.getActiveViewpoint();this.orientationOffset.assign(e.orientationOffset_.getValue()),e.orientationOffset_=this.getOrientationOffset(this.rotation,this.orientationOffset),e.positionOffset_=this.getPositionOffset(e.positionOffset_.getValue(),this.orientationOffset,e.orientationOffset_.getValue())},set_positionOffset__:function(e){this.getActiveViewpoint().positionOffset_=e},set_centerOfRotationOffset__:function(e){this.getActiveViewpoint().centerOfRotationOffset_=e},set_rotation__:function(e){var t=this.getActiveViewpoint();t.orientationOffset_=this.getOrientationOffset(e.getValue(),this.initialOrientationOffset,!1),t.positionOffset_=this.getPositionOffset(this.initialPositionOffset,this.initialOrientationOffset,t.orientationOffset_.getValue())},addRotate:function(){var e=new a;return function(t){var i=this.getActiveViewpoint();if(this.rotationChaser.isActive_.getValue()&&this.rotationChaser.value_changed_.hasInterest("set_rotation__",this))try{e.assign(this.rotationChaser.set_destination_.getValue()).multLeft(t),this.getOrientationOffset(e,this.initialOrientationOffset,!0),this.rotationChaser.set_destination_=e}catch(i){t=this.getHorizonRotation(t),e.assign(this.rotationChaser.set_destination_.getValue()).multLeft(t),this.rotationChaser.set_destination_=e}else try{this.initialOrientationOffset.assign(i.orientationOffset_.getValue()),this.initialPositionOffset.assign(i.positionOffset_.getValue()),this.getOrientationOffset(t,this.initialOrientationOffset,!0),this.rotationChaser.set_value_=a.Identity,this.rotationChaser.set_destination_=t}catch(e){this.rotationChaser.set_value_=a.Identity,this.rotationChaser.set_destination_=this.getHorizonRotation(t)}this.disconnect(),this.rotationChaser.value_changed_.addInterest("set_rotation__",this)}}(),addSpinning:function(){var e=new a(0,0,1,0);return function(t){try{this.disconnect(),this.getBrowser().prepareEvents().addInterest("spin",this),this.rotation.assign(e.assign(a.Identity).slerp(t,.6))}catch(e){console.log(e)}}}(),addMove:function(){var e=new o(0,0,0),t=new o(0,0,0);return function(i,n){var r=this.getActiveViewpoint()
;this.positionChaser.isActive_.getValue()&&this.positionChaser.value_changed_.hasInterest("set_positionOffset__",this)?(e.assign(this.positionChaser.set_destination_.getValue()).add(i),this.positionChaser.set_destination_=e):(e.assign(r.positionOffset_.getValue()).add(i),this.positionChaser.set_value_=r.positionOffset_,this.positionChaser.set_destination_=e),this.centerOfRotationChaser.isActive_.getValue()&&this.centerOfRotationChaser.value_changed_.hasInterest("set_centerOfRotationOffset__",this)?(t.assign(this.centerOfRotationChaser.set_destination_.getValue()).add(n),this.centerOfRotationChaser.set_destination_=t):(t.assign(r.centerOfRotationOffset_.getValue()).add(n),this.centerOfRotationChaser.set_value_=r.centerOfRotationOffset_,this.centerOfRotationChaser.set_destination_=t),this.disconnect(),this.positionChaser.value_changed_.addInterest("set_positionOffset__",this),this.centerOfRotationChaser.value_changed_.addInterest("set_centerOfRotationOffset__",this)}}(),getPositionOffset:function(){var e=new o(0,0,0),t=new o(0,0,0),i=new a(0,0,1,0);return function(n,r,s){return this.getDistanceToCenter(e,n),i.assign(r).inverse().multRight(s).multVecRot(t.assign(e)).subtract(e).add(n)}}(),getOrientationOffset:function(){var e=new a(0,0,1,0),t=new a(0,0,1,0),i=new o(0,0,0);return function(n,s,a){var u=this.getActiveViewpoint(),l=this.getBrowser().getBrowserOption("StraightenHorizon");e.assign(n).multRight(u.getOrientation()).multRight(s),!l||u instanceof r||u.straightenHorizon(e);var h=t.assign(u.getOrientation()).inverse().multRight(e);if(!l||u instanceof r)return h;if(!a)return h;var c=e.multVecRot(i.assign(o.zAxis));if(Math.abs(u.getUpVector().dot(c))<.97)return h;throw new Error("Critical angle")}}(),getHorizonRotation:function(){var e=new o(0,0,0);return function(t){var i=this.getActiveViewpoint(),n=t.multVecRot(e.assign(o.zAxis)).normalize(),r=o.cross(i.getUpVector(),n).normalize(),s=o.cross(r,i.getUpVector()).normalize();return new a(o.zAxis,s)}}(),disconnect:function(){var e=this.getBrowser();this.positionChaser.value_changed_.removeInterest("set_positionOffset__",this),this.centerOfRotationChaser.value_changed_.removeInterest("set_centerOfRotationOffset__",this),this.rotationChaser.value_changed_.removeInterest("set_rotation__",this),e.prepareEvents().removeInterest("spin",this)},dispose:function(){var t=this.getBrowser();this.disconnect(),t.activeViewpoint_.removeInterest("set_activeViewpoint__",this),t.getElement().unbind(".ExamineViewer"),e(document).unbind(".ExamineViewer"+this.getId())}}),u}),define("x_ite/Browser/Navigation/X3DFlyViewer",["jquery","x_ite/Browser/Navigation/X3DViewer","x_ite/Components/Followers/OrientationChaser","x_ite/Components/Geospatial/GeoViewpoint","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Camera","jquery-mousewheel"],function(e,t,i,n,r,s,o,a){"use strict";function u(e){t.call(this,e);var n=this.getBrowser().getContext();this.button=-1,this.fromVector=new r(0,0,0),this.toVector=new r(0,0,0),this.direction=new r(0,0,0),this.startTime=0,this.lineBuffer=n.createBuffer(),this.lineCount=2,this.lineVertices=new Array(4*this.lineCount),this.lineArray=new Float32Array(this.lineVertices),this.event=null,this.lookAround=!1,this.orientationChaser=new i(e)}var l=Math.PI/32;return u.prototype=Object.assign(Object.create(t.prototype),{constructor:u,initialize:function(){t.prototype.initialize.call(this);var e=this.getBrowser(),i=e.getElement();i.bind("mousedown.X3DFlyViewer",this.mousedown.bind(this)),i.bind("mouseup.X3DFlyViewer",this.mouseup.bind(this)),i.bind("mousewheel.X3DFlyViewer",this.mousewheel.bind(this)),i.bind("touchstart.X3DFlyViewer",this.touchstart.bind(this)),i.bind("touchend.X3DFlyViewer",this.touchend.bind(this)),e.controlKey_.addInterest("set_controlKey_",this),this.orientationChaser.duration_=.3,this.orientationChaser.setPrivate(!0),this.orientationChaser.setup()},addCollision:function(){},removeCollision:function(){},set_controlKey_:function(){this.event&&0===this.event.button&&(this.button=-1,this.mousedown(this.event))},mousedown:function(t){if(!(this.button>=0)){this.event=t;var i=this.getBrowser().getElement().offset(),n=t.pageX-i.left,r=t.pageY-i.top;switch(t.button){case 0:t.preventDefault(),t.stopImmediatePropagation(),this.button=t.button,e(document).bind("mouseup.X3DFlyViewer"+this.getId(),this.mouseup.bind(this)),e(document).bind("mousemove.X3DFlyViewer"+this.getId(),this.mousemove.bind(this)),e(document).bind("touchend.X3DFlyViewer"+this.getId(),this.touchend.bind(this)),e(document).bind("touchmove.X3DFlyViewer"+this.getId(),this.touchmove.bind(this)),this.disconnect(),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.addCollision(),this.getBrowser().getControlKey()||this.lookAround?this.trackballProjectToSphere(n,r,this.fromVector):(this.fromVector.set(n,0,r),this.toVector.assign(this.fromVector),this.getFlyDirection(this.fromVector,this.toVector,this.direction),this.addFly(),this.getBrowser().getBrowserOption("Rubberband")&&this.getBrowser().finished().addInterest("display",this,0));break;case 1:t.preventDefault(),t.stopImmediatePropagation(),this.button=t.button,e(document).bind("mouseup.X3DFlyViewer"+this.getId(),this.mouseup.bind(this)),e(document).bind("mousemove.X3DFlyViewer"+this.getId(),this.mousemove.bind(this)),this.disconnect(),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.addCollision(),this.fromVector.set(n,-r,0),this.toVector.assign(this.fromVector),this.direction.set(0,0,0),this.addPan(),this.getBrowser().getBrowserOption("Rubberband")&&this.getBrowser().finished().addInterest("display",this,1)}}},mouseup:function(t){t.preventDefault(),t.button===this.button&&(this.event=null,this.button=-1,e(document).unbind(".X3DFlyViewer"+this.getId()),this.disconnect(),this.getBrowser().setCursor("DEFAULT"),this.removeCollision())},mousemove:function(e){this.getBrowser().addBrowserEvent(),this.event=e;var t=this.getBrowser().getElement().offset(),i=e.pageX-t.left,n=e.pageY-t.top;switch(this.button){case 0:if(this.getBrowser().getControlKey()||this.lookAround){e.preventDefault(),e.stopImmediatePropagation();var r=this.trackballProjectToSphere(i,n,this.toVector);this.addRotation(this.fromVector,r),this.fromVector.assign(r);break}this.toVector.set(i,0,n),this.getFlyDirection(this.fromVector,this.toVector,this.direction);break;case 1:e.preventDefault(),e.stopImmediatePropagation(),this.toVector.set(i,-n,0),this.direction.assign(this.toVector).subtract(this.fromVector)}},mousewheel:function(e){e.preventDefault(),e.stopImmediatePropagation(),this.getActiveViewpoint().transitionStop(),e.deltaY>0?this.addRoll(-l):e.deltaY<0&&this.addRoll(l)},touchstart:function(e){var t=e.originalEvent.touches;switch(t.length){case 1:e.button=0,e.pageX=t[0].pageX,e.pageY=t[0].pageY,this.mousedown(e);break;case 2:this.touchend(e),this.lookAround=!0,e.button=0,e.pageX=(t[0].pageX+t[1].pageX)/2,e.pageY=(t[0].pageY+t[1].pageY)/2,this.mousedown(e);break;case 3:this.touchend(e)}},touchend:function(e){switch(this.button){case 0:this.lookAround=!1,e.button=0,this.mouseup(e)}},touchmove:function(e){var t=e.originalEvent.touches;switch(t.length){case 1:e.button=0,e.pageX=t[0].pageX,e.pageY=t[0].pageY,this.mousemove(e);break;case 2:e.button=0,e.pageX=(t[0].pageX+t[1].pageX)/2,e.pageY=(t[0].pageY+t[1].pageY)/2,this.mousemove(e)}},fly:function(){var e=new r(0,0,0),t=new r(0,0,0),i=new r(0,0,0),o=new s(0,0,1,0),a=new s(0,0,1,0),u=new s(0,0,1,0),l=new s(0,0,1,0),h=new s(0,0,1,0);return function(){var c=this.getNavigationInfo(),d=this.getActiveViewpoint(),p=performance.now(),f=(p-this.startTime)/1e3;e.assign(d.getUpVector()),l.setFromToVec(r.yAxis,e),this.direction.z>0?u.setFromToVec(l.multVecRot(t.assign(this.direction)),l.multVecRot(i.set(0,0,1))):u.setFromToVec(l.multVecRot(i.set(0,0,-1)),l.multVecRot(t.assign(this.direction)));var g=this.direction.abs(),m=1-u.angle/(Math.PI/2);m*=c.speed_.getValue(),m*=d.getSpeedFactor(),m*=this.getBrowser().getShiftKey()?.028:.007,m*=f;var _=this.getTranslationOffset(t.assign(this.direction).multiply(m));this.getActiveLayer().constrainTranslation(_,!0),d.positionOffset_=_.add(d.positionOffset_.getValue());var x=1.4*f*Math.pow(g/(g+40),2);o.assign(s.Identity).slerp(u,x).multRight(d.getUserOrientation()),d instanceof n||d.straightenHorizon(o),a.assign(d.getOrientation()).inverse().multRight(o),d.orientationOffset_=a,h.setFromToVec(e,d.getUpVector()),d.orientationOffset_=h.multLeft(d.orientationOffset_.getValue()),this.startTime=p}}(),pan:function(){var e=new r(0,0,0),t=new r(0,0,0);return function(){var i=this.getNavigationInfo(),n=this.getActiveViewpoint(),o=performance.now(),a=(o-this.startTime)/1e3,u=n.getUpVector();this.constrainPanDirection(e.assign(this.direction));var l=1;l*=i.speed_.getValue(),l*=n.getSpeedFactor(),l*=this.getBrowser().getShiftKey()?.0098:.007,l*=a;var h=n.getUserOrientation().multRight(new s(n.getUserOrientation().multVecRot(t.assign(r.yAxis)),u)),c=h.multVecRot(e.multiply(l));this.getActiveLayer().constrainTranslation(c,!0),n.positionOffset_=c.add(n.positionOffset_.getValue()),this.startTime=o}}(),set_orientationOffset__:function(e){this.getActiveViewpoint().orientationOffset_=e},addFly:function(){this.startTime||(this.getBrowser().prepareEvents().addInterest("fly",this),this.getBrowser().addBrowserEvent(),this.startTime=performance.now())},addPan:function(){this.startTime||(this.disconnect(),this.getBrowser().prepareEvents().addInterest("pan",this),this.getBrowser().addBrowserEvent(),this.startTime=performance.now())},addRoll:function(){var e=new s(0,0,1,0),t=new s(0,0,1,0);return function(i){var n=this.getActiveViewpoint();this.orientationChaser.isActive_.getValue()&&this.orientationChaser.value_changed_.hasInterest("set_orientationOffset__",this)?(e.assign(n.getOrientation()).inverse().multRight(t.set(1,0,0,i)).multRight(n.getOrientation()).multRight(this.orientationChaser.set_destination_.getValue()),this.orientationChaser.set_destination_=e):(e.assign(n.getOrientation()).inverse().multRight(t.set(1,0,0,i)).multRight(n.getUserOrientation()),this.orientationChaser.set_value_=n.orientationOffset_,this.orientationChaser.set_destination_=e),this.disconnect(),this.orientationChaser.value_changed_.addInterest("set_orientationOffset__",this)}}(),addRotation:function(){var e=new s(0,0,1,0),t=new s(0,0,1,0);return function(i,r){var s=this.getActiveViewpoint();this.orientationChaser.isActive_.getValue()&&this.orientationChaser.value_changed_.hasInterest("set_orientationOffset__",this)?(e.setFromToVec(r,i).multRight(s.getOrientation()).multRight(this.orientationChaser.set_destination_.getValue()),s instanceof n||s.straightenHorizon(e),t.assign(s.getOrientation()).inverse().multRight(e),this.orientationChaser.set_destination_=t):(e.setFromToVec(r,i).multRight(s.getUserOrientation()),s instanceof n||s.straightenHorizon(e),t.assign(s.getOrientation()).inverse().multRight(e),this.orientationChaser.set_value_=s.orientationOffset_,this.orientationChaser.set_destination_=t),this.disconnect(),this.orientationChaser.value_changed_.addInterest("set_orientationOffset__",this)}}(),display:function(){var e=new r(0,0,0),t=new r(0,0,0),i=new o,n=new Float32Array(o.Identity),s=new Float32Array(o.Identity);return function(r,o){var u=this.getBrowser(),l=u.getViewport(),h=l[2],c=l[3];a.ortho(0,h,0,c,-1,1,i),n.set(i),0===o?(e.set(this.fromVector.x,c-this.fromVector.z,0),t.set(this.toVector.x,c-this.toVector.z,0)):(e.set(this.fromVector.x,c+this.fromVector.y,0),t.set(this.toVector.x,c+this.toVector.y,0)),this.transfer(e,t);var d=u.getContext(),p=u.getLineShader(),f=d.getParameter(d.LINE_WIDTH);p.enable(d),p.enableVertexAttribute(d,this.lineBuffer),d.uniform1i(p.x3d_NumClipPlanes,0),d.uniform1i(p.x3d_FogType,0),d.uniform1i(p.x3d_ColorMaterial,!1),d.uniform1i(p.x3d_Lighting,!0),d.uniformMatrix4fv(p.x3d_ProjectionMatrix,!1,n),d.uniformMatrix4fv(p.x3d_ModelViewMatrix,!1,s),d.disable(d.DEPTH_TEST),d.lineWidth(2),d.uniform3f(p.x3d_EmissiveColor,0,0,0),d.uniform1f(p.x3d_Transparency,0),d.drawArrays(d.LINES,0,this.lineCount),d.lineWidth(1),d.uniform3f(p.x3d_EmissiveColor,1,1,1),d.drawArrays(d.LINES,0,this.lineCount),d.enable(d.DEPTH_TEST),d.lineWidth(f),p.disable(d)}}(),transfer:function(e,t){var i=this.getBrowser().getContext(),n=this.lineVertices;n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=1,n[4]=t.x,n[5]=t.y,n[6]=t.z,n[7]=1,this.lineArray.set(n),i.bindBuffer(i.ARRAY_BUFFER,this.lineBuffer),i.bufferData(i.ARRAY_BUFFER,this.lineArray,i.STATIC_DRAW)},disconnect:function(){var e=this.getBrowser();e.addBrowserEvent(),e.prepareEvents().removeInterest("fly",this),e.prepareEvents().removeInterest("pan",this),e.finished().removeInterest("display",this),this.orientationChaser.value_changed_.removeInterest("set_orientationOffset__",this),this.startTime=0},dispose:function(){this.disconnect(),this.getBrowser().controlKey_.removeInterest("set_controlKey_",this),this.getBrowser().getElement().unbind(".X3DFlyViewer"),e(document).unbind(".X3DFlyViewer"+this.getId())}}),u}),define("x_ite/Browser/Navigation/WalkViewer",["x_ite/Browser/Navigation/X3DFlyViewer","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4"],function(e,t,i){"use strict";function n(t){e.call(this,t)}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,initialize:function(){e.prototype.initialize.call(this),this.getBrowser().addCollision(this)},getFlyDirection:function(e,t,i){return i.assign(t).subtract(e)},getTranslationOffset:function(){var e=new t(0,0,0),n=new i(0,0,1,0),r=new i(0,0,1,0);return function(i){var s=this.getActiveViewpoint(),o=s.getUpVector();return n.assign(s.getUserOrientation()),n.multVecRot(e.assign(t.yAxis)),r.setFromToVec(e,o),n.multRight(r).multVecRot(i)}}(),constrainPanDirection:function(e){return e.y<0&&(e.y=0),e},dispose:function(){this.getBrowser().removeCollision(this),e.prototype.dispose.call(this)}}),n}),define("x_ite/Browser/Navigation/FlyViewer",["x_ite/Browser/Navigation/X3DFlyViewer","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4"],function(e,t,i){"use strict";function n(t){e.call(this,t)}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,addCollision:function(){this.getBrowser().addCollision(this)},removeCollision:function(){this.getBrowser().removeCollision(this)},getFlyDirection:function(e,t,i){return i.assign(t).subtract(e),i.x=i.x/20,i.y=-i.z/20,i.z=-50,i},getTranslationOffset:function(e){return this.getActiveViewpoint().getUserOrientation().multVecRot(e)},constrainPanDirection:function(e){return e}}),n}),define("x_ite/Components/Navigation/Viewpoint",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Navigation/X3DViewpointNode","x_ite/Components/Interpolation/ScalarInterpolator","x_ite/Bits/X3DConstants","standard/Math/Geometry/Camera","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r,s,o,a,u){"use strict";function l(e){n.call(this,e),this.addType(s.Viewpoint),this.position_.setUnit("length"),this.centerOfRotation_.setUnit("length"),this.fieldOfView_.setUnit("angle"),this.projectionMatrix=new u,this.fieldOfViewInterpolator=new r(this.getBrowser().getPrivateScene())}var h=new a(0,0,1),c=new a(0,0,0),d=new a(0,0,0);return l.prototype=Object.assign(Object.create(n.prototype),{constructor:l,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOnly,"set_bind",new e.SFBool),new t(s.inputOutput,"description",new e.SFString),new t(s.inputOutput,"position",new e.SFVec3f(0,0,10)),new t(s.inputOutput,"orientation",new e.SFRotation),new t(s.inputOutput,"centerOfRotation",new e.SFVec3f),new t(s.inputOutput,"fieldOfView",new e.SFFloat(.7854)),new t(s.inputOutput,"jump",new e.SFBool(!0)),new t(s.inputOutput,"retainUserOffsets",new e.SFBool),new t(s.outputOnly,"isBound",new e.SFBool),new t(s.outputOnly,"bindTime",new e.SFTime)]),getTypeName:function(){return"Viewpoint"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.fieldOfViewInterpolator.key_=new e.MFFloat(0,1),this.fieldOfViewInterpolator.setup(),this.getEaseInEaseOut().modifiedFraction_changed_.addFieldInterest(this.fieldOfViewInterpolator.set_fraction_),this.fieldOfViewInterpolator.value_changed_.addFieldInterest(this.fieldOfViewScale_)},setInterpolators:function(t){if(t.getType().indexOf(s.Viewpoint)<0)this.fieldOfViewInterpolator.keyValue_=new e.MFFloat(this.fieldOfViewScale_.getValue(),this.fieldOfViewScale_.getValue());else{var i=t.getFieldOfView()/this.fieldOfView_.getValue();this.fieldOfViewInterpolator.keyValue_=new e.MFFloat(i,this.fieldOfViewScale_.getValue()),this.fieldOfViewScale_=i}},getFieldOfView:function(){var e=this.fieldOfView_.getValue()*this.fieldOfViewScale_.getValue();return e>0&&e<Math.PI?e:Math.PI/4},getScreenScale:function(e,t){var i=t[2],n=t[3],r=2*Math.tan(this.getFieldOfView()/2)*e.abs();return r*=Math.abs(d.assign(e).normalize().dot(h)),r/=i>n?n:i,c.set(r,r,r)},getLookAtDistance:function(e){return e.size.abs()/2/Math.tan(this.getFieldOfView()/2)},getProjectionMatrixWithLimits:function(e,t,i){return o.perspective(this.getFieldOfView(),e,t,i[2],i[3],this.projectionMatrix)}}),l}),define("x_ite/Browser/Navigation/PlaneViewer",["jquery","x_ite/Browser/Navigation/X3DViewer","x_ite/Components/Navigation/Viewpoint","x_ite/Components/Geospatial/GeoViewpoint","standard/Math/Numbers/Vector3","jquery-mousewheel"],function(e,t,i,n,r){"use strict";function s(e){t.call(this,e),this.button=-1,this.fromPoint=new r(0,0,0),this.toPoint=new r(0,0,0)}var o=new r(0,0,0),a=new r(0,0,0),u=new r(0,0,0);return s.prototype=Object.assign(Object.create(t.prototype),{constructor:s,initialize:function(){t.prototype.initialize.call(this);var e=this.getBrowser(),i=e.getElement();i.bind("mousedown.PlaneViewer",this.mousedown.bind(this)),i.bind("mouseup.PlaneViewer",this.mouseup.bind(this)),i.bind("mousemove.PlaneViewer",this.mousemove.bind(this)),i.bind("mousewheel.PlaneViewer",this.mousewheel.bind(this))},mousedown:function(t){if(!(this.button>=0)){this.pressTime=performance.now();var i=this.getBrowser().getElement().offset(),n=t.pageX-i.left,r=t.pageY-i.top;switch(t.button){case 1:t.preventDefault(),t.stopImmediatePropagation(),this.button=t.button,this.getBrowser().getElement().unbind("mousemove.PlaneViewer"),e(document).bind("mouseup.PlaneViewer"+this.getId(),this.mouseup.bind(this)),e(document).bind("mousemove.PlaneViewer"+this.getId(),this.mousemove.bind(this)),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.getPointOnCenterPlane(n,r,this.fromPoint)}}},mouseup:function(t){t.preventDefault(),t.stopImmediatePropagation(),t.button===this.button&&(this.button=-1,e(document).unbind(".PlaneViewer"+this.getId()),this.getBrowser().getElement().bind("mousemove.PlaneViewer",this.mousemove.bind(this)),this.getBrowser().setCursor("DEFAULT"))},mousemove:function(e){var t=this.getBrowser().getElement().offset(),i=e.pageX-t.left,n=e.pageY-t.top;switch(this.button){case 1:e.preventDefault(),e.stopImmediatePropagation();var r=this.getActiveViewpoint(),s=this.getPointOnCenterPlane(i,n,this.toPoint),o=r.getUserOrientation().multVecRot(this.fromPoint.subtract(s));r.positionOffset_=a.assign(r.positionOffset_.getValue()).add(o),r.centerOfRotationOffset_=u.assign(r.centerOfRotationOffset_.getValue()).add(o),this.fromPoint.assign(s)}},mousewheel:function(e){e.preventDefault(),e.stopImmediatePropagation();var t=this.getBrowser().getElement().offset(),i=e.pageX-t.left,n=e.pageY-t.top,r=this.getActiveViewpoint(),s=this.getPointOnCenterPlane(i,n,this.fromPoint);r.transitionStop(),e.deltaY>0?r.fieldOfViewScale_=Math.max(1e-5,.95*r.fieldOfViewScale_.getValue()):e.deltaY<0&&(r.fieldOfViewScale_=1.05*r.fieldOfViewScale_.getValue(),this.constrainFieldOfViewScale()),r.set_fieldOfView___&&r.set_fieldOfView___();var l=this.getPointOnCenterPlane(i,n,this.toPoint),h=r.getUserOrientation().multVecRot(o.assign(s).subtract(l));r.positionOffset_=a.assign(r.positionOffset_.getValue()).add(h),r.centerOfRotationOffset_=u.assign(r.centerOfRotationOffset_.getValue()).add(h)},constrainFieldOfViewScale:function(){var e=this.getActiveViewpoint();(e instanceof i||e instanceof n)&&e.fieldOfView_.getValue()*e.fieldOfViewScale_.getValue()>=Math.PI&&(e.fieldOfViewScale_=(Math.PI-.001)/e.fieldOfView_.getValue())},dispose:function(){this.getBrowser().getElement().unbind(".PlaneViewer"),e(document).unbind(".PlaneViewer"+this.getId())}}),s}),define("x_ite/Browser/Navigation/NoneViewer",["x_ite/Browser/Navigation/X3DViewer"],function(e){"use strict";function t(t){e.call(this,t)}return t.prototype=Object.assign(Object.create(e.prototype),{constructor:t}),t}),define("x_ite/Browser/Navigation/LookAtViewer",["jquery","x_ite/Browser/Navigation/X3DViewer","x_ite/Components/Followers/PositionChaser","x_ite/Components/Followers/OrientationChaser","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4"],function(e,t,i,n,r,s,o){"use strict";function a(e){t.call(this,e),this.button=-1,this.fromVector=new s(0,0,0),this.toVector=new s(0,0,0),this.touch1=new r(0,0),this.touch2=new r(0,0),this.tapStart=0,this.dblTapInterval=.4,this.positionChaser=new i(e),this.centerOfRotationChaser=new i(e),this.orientationChaser=new n(e)}return a.prototype=Object.assign(Object.create(t.prototype),{constructor:a,initialize:function(){t.prototype.initialize.call(this);var e=this.getBrowser(),i=e.getElement();i.bind("mousedown.LookAtViewer",this.mousedown.bind(this)),i.bind("mouseup.LookAtViewer",this.mouseup.bind(this)),i.bind("dblclick.LookAtViewer",this.dblclick.bind(this)),i.bind("mousewheel.LookAtViewer",this.mousewheel.bind(this)),i.bind("touchstart.LookAtViewer",this.touchstart.bind(this)),i.bind("touchend.LookAtViewer",this.touchend.bind(this)),this.positionChaser.duration_=.3,this.positionChaser.setPrivate(!0),this.positionChaser.setup(),this.centerOfRotationChaser.duration_=.3,this.centerOfRotationChaser.setPrivate(!0),this.centerOfRotationChaser.setup(),this.orientationChaser.duration_=.3,this.orientationChaser.setPrivate(!0),this.orientationChaser.setup()},mousedown:function(t){if(!(this.button>=0)){this.pressTime=performance.now();var i=this.getBrowser().getElement().offset(),n=t.pageX-i.left,r=t.pageY-i.top;switch(t.button){case 0:t.preventDefault(),t.stopImmediatePropagation(),this.button=t.button,e(document).bind("mouseup.LookAtViewer"+this.getId(),this.mouseup.bind(this)),e(document).bind("mousemove.LookAtViewer"+this.getId(),this.mousemove.bind(this)),e(document).bind("touchend.LookAtViewer"+this.getId(),this.mouseup.bind(this)),e(document).bind("touchmove.LookAtViewer"+this.getId(),this.touchmove.bind(this)),this.getActiveViewpoint().transitionStop(),this.trackballProjectToSphere(n,r,this.fromVector)}}},mouseup:function(t){if(t.button===this.button)switch(this.button=-1,e(document).unbind(".LookAtViewer"+this.getId()),t.button){case 0:t.preventDefault(),t.stopImmediatePropagation()}},dblclick:function(e){e.preventDefault(),e.stopImmediatePropagation();var t=this.getBrowser().getElement().offset(),i=e.pageX-t.left,n=this.getBrowser().getElement().height()-(e.pageY-t.top);this.disconnect(),this.lookAtPoint(i,n,this.getBrowser().getBrowserOption("StraightenHorizon"))},mousemove:function(e){this.getBrowser().addBrowserEvent(),this.event=e;var t=this.getBrowser().getElement().offset(),i=e.pageX-t.left,n=e.pageY-t.top;switch(this.button){case 0:e.preventDefault(),e.stopImmediatePropagation();var r=this.trackballProjectToSphere(i,n,this.toVector);this.addRotation(this.fromVector,r),this.fromVector.assign(r)}},mousewheel:function(){var e=new s(0,0,0),t=new s(0,0,0);return function(i){i.preventDefault(),i.stopImmediatePropagation();var n=this.getActiveViewpoint();n.transitionStop(),e=this.getDistanceToCenter(e).multiply(i.zoomFactor||.05),t=n.getUserOrientation().multVecRot(t.set(0,0,e.abs())),i.deltaY>0?this.addMove(t.negate(),s.Zero):i.deltaY<0&&this.addMove(t,s.Zero)}}(),touchstart:function(e){var t=e.originalEvent.touches;switch(t.length){case 1:this.touch1.set(t[0].pageX,t[0].pageY);break;case 2:this.touchend(e),e.button=0,e.pageX=(t[0].pageX+t[1].pageX)/2,e.pageY=(t[0].pageY+t[1].pageY)/2,this.mousedown(e),this.touch1.set(t[0].pageX,t[0].pageY),this.touch2.set(t[1].pageX,t[1].pageY);break;case 3:this.touchend(e)}},touchend:function(e){switch(this.button){case 0:this.mouseup(e)}this.getBrowser().getCurrentTime()-this.tapStart<this.dblTapInterval&&(e.button=1,e.pageX=this.touch1.x,e.pageY=this.touch1.y,this.dblclick(e)),this.tapStart=this.getBrowser().getCurrentTime()},touchmove:function(){var t=new r(0,0),i=new r(0,0);return function(n){var r=n.originalEvent.touches;switch(r.length){case 1:break;case 2:t.set(r[0].pageX,r[0].pageY).subtract(this.touch1).normalize(),i.set(r[1].pageX,r[1].pageY).subtract(this.touch2).normalize();var s=t.dot(i)>.7,o=t.dot(i)<-.7;if(s)n.button=0,n.pageX=(r[0].pageX+r[1].pageX)/2,n.pageY=(r[0].pageY+r[1].pageY)/2,this.mousemove(n);else if(o){var a=this.touch1.distance(this.touch2);this.touch1.set(r[0].pageX,r[0].pageY),this.touch2.set(r[1].pageX,r[1].pageY);var u=this.touch1.distance(this.touch2),l=u-a;n.deltaY=l,n.zoomFactor=Math.abs(l)/e(window).width(),this.mousewheel(n)}this.touch1.set(r[0].pageX,r[0].pageY),this.touch2.set(r[1].pageX,r[1].pageY)}}}(),set_positionOffset__:function(e){this.getActiveViewpoint().positionOffset_=e},set_centerOfRotationOffset__:function(e){this.getActiveViewpoint().centerOfRotationOffset_=e},set_orientationOffset__:function(e){this.getActiveViewpoint().orientationOffset_=e},addMove:function(){var e=new s(0,0,0),t=new s(0,0,0);return function(i,n){var r=this.getActiveViewpoint();this.positionChaser.isActive_.getValue()&&this.positionChaser.value_changed_.hasInterest("set_positionOffset__",this)?(e.assign(this.positionChaser.set_destination_.getValue()).add(i),this.positionChaser.set_destination_=e):(e.assign(r.positionOffset_.getValue()).add(i),this.positionChaser.set_value_=r.positionOffset_,this.positionChaser.set_destination_=e),this.centerOfRotationChaser.isActive_.getValue()&&this.centerOfRotationChaser.value_changed_.hasInterest("set_centerOfRotationOffset__",this)?(t.assign(this.centerOfRotationChaser.set_destination_.getValue()).add(n),this.centerOfRotationChaser.set_destination_=t):(t.assign(r.centerOfRotationOffset_.getValue()).add(n),this.centerOfRotationChaser.set_value_=r.centerOfRotationOffset_,this.centerOfRotationChaser.set_destination_=t),this.disconnect(),this.positionChaser.value_changed_.addInterest("set_positionOffset__",this),this.centerOfRotationChaser.value_changed_.addInterest("set_centerOfRotationOffset__",this)}}(),addRotation:function(){var e=new o(0,0,1,0),t=new o(0,0,1,0);return function(i,n){var r=this.getActiveViewpoint();this.orientationChaser.isActive_.getValue()&&this.orientationChaser.value_changed_.hasInterest("set_orientationOffset__",this)?(e.setFromToVec(n,i).multRight(r.getOrientation()).multRight(this.orientationChaser.set_destination_.getValue()),r.straightenHorizon(e),t.assign(r.getOrientation()).inverse().multRight(e),this.orientationChaser.set_destination_=t):(e.setFromToVec(n,i).multRight(r.getUserOrientation()),r.straightenHorizon(e),t.assign(r.getOrientation()).inverse().multRight(e),this.orientationChaser.set_value_=r.orientationOffset_,this.orientationChaser.set_destination_=t),this.disconnect(),this.orientationChaser.value_changed_.addInterest("set_orientationOffset__",this)}}(),disconnect:function(){this.orientationChaser.value_changed_.removeInterest("set_orientationOffset__",this),this.positionChaser.value_changed_.removeInterest("set_positionOffset__",this),this.centerOfRotationChaser.value_changed_.removeInterest("set_centerOfRotationOffset__",this)},dispose:function(){this.getBrowser().getElement().unbind(".LookAtViewer"),e(document).unbind(".LookAtViewer"+this.getId())}}),a}),define("x_ite/Components/Lighting/X3DLightNode",["x_ite/Components/Core/X3DChildNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4","standard/Math/Algorithm"],function(e,t,i,n,r){"use strict";function s(t){e.call(this,t),this.addType(i.X3DLightNode)}var o=new n(.5,0,0,0,0,.5,0,0,0,0,.5,0,.5,.5,.5,1);return s.prototype=Object.assign(Object.create(e.prototype),{constructor:s,getGlobal:function(){return this.global_.getValue()},getColor:function(){return this.color_.getValue()},getIntensity:function(){return r.clamp(this.intensity_.getValue(),0,1)},getAmbientIntensity:function(){return r.clamp(this.ambientIntensity_.getValue(),0,1)},getDirection:function(){return this.direction_.getValue()},getShadowColor:function(){return this.shadowColor_.getValue()},getShadowIntensity:function(){return r.clamp(this.shadowIntensity_.getValue(),0,1)},getShadowBias:function(){return r.clamp(this.shadowBias_.getValue(),0,1)},getShadowMapSize:function(){return Math.min(this.shadowMapSize_.getValue(),this.getBrowser().getMaxTextureSize())},getBiasMatrix:function(){return o},push:function(e,t){if(this.on_.getValue()){if(e.isIndependent()){var i=this.getLights().pop();this.global_.getValue()?(i.set(e.getBrowser(),this,e.getLayer().getGroup(),e.getModelViewMatrix().get()),e.getGlobalLights().push(i),e.getLights().push(i)):(i.set(e.getBrowser(),this,t,e.getModelViewMatrix().get()),e.getShaderObjects().push(i),e.getLights().push(i))}else{var i=e.getLightContainer();this.global_.getValue()?(i.getModelViewMatrix().pushMatrix(e.getModelViewMatrix().get()),e.getGlobalLights().push(i),e.getLights().push(i)):(i.getModelViewMatrix().pushMatrix(e.getModelViewMatrix().get()),e.getShaderObjects().push(i),e.getLights().push(i))}e.pushShadow(this.shadowIntensity_.getValue()>0)}},pop:function(e){if(this.on_.getValue()){if(this.global_.getValue())return;e.isIndependent()?e.getBrowser().getLocalLights().push(e.getShaderObjects().pop()):e.getShaderObjects().pop(),e.popShadow()}}}),s}),define("x_ite/Components/Grouping/X3DBoundedObject",["x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Geometry/Box3"],function(e,t,i,n){"use strict";function r(e){this.addType(t.X3DBoundedObject),this.bboxSize_.setUnit("length"),this.bboxCenter_.setUnit("length"),this.childBBox=new n}return r.prototype={constructor:r,defaultBBoxSize:new i(-1,-1,-1),initialize:function(){},getBBox:function(i,n){n.set();for(var r=0,s=i.length;r<s;++r){var o=e(t.X3DBoundedObject,i[r]);o&&n.add(o.getBBox(this.childBBox))}return n}},r}),define("x_ite/Components/Grouping/X3DGroupingNode",["x_ite/Fields","x_ite/Components/Core/X3DChildNode","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r,s){"use strict";function o(e){return e?e.getValue().getId():-1}function a(e,t,i,n,r,s){function a(e){return u[o(e)]}for(var u={},l=r;l<s;++l)u[o(n[l])]=!0;return e.remove(t,i,a)}function u(e){t.call(this,e),i.call(this,e),this.addType(r.X3DGroupingNode),this.hidden=!1,this.pointingDeviceSensors=[],this.maybeCameraObjects=[],this.cameraObjects=[],this.clipPlanes=[],this.localFogs=[],this.lights=[],this.displayNodes=[],this.childNodes=[]}var l=new e.MFBool;return u.prototype=Object.assign(Object.create(t.prototype),i.prototype,{constructor:u,initialize:function(){t.prototype.initialize.call(this),i.prototype.initialize.call(this),this.addChildren_.addInterest("set_addChildren__",this),this.removeChildren_.addInterest("set_removeChildren__",this),this.children_.addInterest("set_children__",this),this.set_children__()},getBBox:function(e){return this.bboxSize_.getValue().equals(this.defaultBBoxSize)?i.prototype.getBBox.call(this,this.children_.getValue(),e):e.set(this.bboxSize_.getValue(),this.bboxCenter_.getValue())},getMatrix:function(){return s.Identity},setHidden:function(e){
e!==this.hidden&&(this.hidden=e,this.set_children__())},getVisible:function(){return l},getChild:function(e){try{if(e>=0&&e<this.children_.length){var t=this.children_[e];if(t)return t.getValue().getInnerNode()}}catch(e){}return null},set_addChildren__:function(){if(0!==this.addChildren_.length){this.addChildren_.setTainted(!0),this.addChildren_.erase(a(this.addChildren_,0,this.addChildren_.length,this.children_,0,this.children_.length),this.addChildren_.length),this.children_.getTainted()||(this.children_.removeInterest("set_children__",this),this.children_.addInterest("connectChildren",this));var e=this.children_.length;this.children_.insert(this.children_.length,this.addChildren_,0,this.addChildren_.length),this.add(e,this.addChildren_),this.addChildren_.set([]),this.addChildren_.setTainted(!1)}},set_removeChildren__:function(){0!==this.removeChildren_.length&&0!==this.children_.length&&(this.children_.getTainted()||(this.children_.removeInterest("set_children__",this),this.children_.addInterest("connectChildren",this)),this.children_.erase(a(this.children_,0,this.children_.length,this.removeChildren_,0,this.removeChildren_.length),this.children_.length),this.remove(this.removeChildren_),this.removeChildren_.set([]))},set_children__:function(){this.clear(),this.add(0,this.children_)},connectChildren:function(){this.children_.removeInterest("connectChildren",this),this.children_.addInterest("set_children__",this)},add:function(e,t){if(!this.hidden){for(var i=this.getVisible(),n=i.length,s=0,o=e,a=t.length;s<a;++s,++o){var u=t[s];if(u&&(o>=n||i[o]))try{for(var l=u.getValue().getInnerNode(),h=l.getType(),c=h.length-1;c>=0;--c){switch(h[c]){case r.X3DPointingDeviceSensorNode:this.pointingDeviceSensors.push(l);break;case r.ClipPlane:this.clipPlanes.push(l);break;case r.LocalFog:this.localFogs.push(l);break;case r.X3DLightNode:this.lights.push(l);break;case r.X3DBindableNode:this.maybeCameraObjects.push(l);break;case r.X3DBackgroundNode:case r.X3DChildNode:l.isCameraObject_.addInterest("set_cameraObjects__",this),this.maybeCameraObjects.push(l),this.childNodes.push(l);break;case r.BooleanFilter:case r.BooleanToggle:case r.NurbsOrientationInterpolator:case r.NurbsPositionInterpolator:case r.NurbsSurfaceInterpolator:case r.TimeSensor:case r.X3DFollowerNode:case r.X3DInfoNode:case r.X3DInterpolatorNode:case r.X3DLayoutNode:case r.X3DScriptNode:case r.X3DSequencerNode:case r.X3DTriggerNode:break;default:continue}break}}catch(e){}}this.set_cameraObjects__(),this.set_display_nodes()}},remove:function(e){for(var t=0,i=e.length;t<i;++t){var n=e[t];if(n)try{for(var s=n.getValue().getInnerNode(),o=s.getType(),a=o.length-1;a>=0;--a){switch(o[a]){case r.X3DPointingDeviceSensorNode:var u=this.pointingDeviceSensors.indexOf(s);u>=0&&this.pointingDeviceSensors.splice(u,1);break;case r.ClipPlane:var u=this.clipPlanes.indexOf(s);u>=0&&this.clipPlanes.splice(u,1);break;case r.LocalFog:var u=this.localFogs.indexOf(s);u>=0&&this.localFogs.splice(u,1);break;case r.X3DLightNode:var u=this.lights.indexOf(s);u>=0&&this.lights.splice(u,1);break;case r.X3DBindableNode:var u=this.maybeCameraObjects.indexOf(s);u>=0&&this.maybeCameraObjects.splice(u,1);break;case r.X3DBackgroundNode:case r.X3DChildNode:s.isCameraObject_.removeInterest("set_cameraObjects__",this);var u=this.maybeCameraObjects.indexOf(s);u>=0&&this.maybeCameraObjects.splice(u,1);var u=this.childNodes.indexOf(s);u>=0&&this.childNodes.splice(u,1);break;case r.BooleanFilter:case r.BooleanToggle:case r.NurbsOrientationInterpolator:case r.NurbsPositionInterpolator:case r.NurbsSurfaceInterpolator:case r.TimeSensor:case r.X3DFollowerNode:case r.X3DInfoNode:case r.X3DInterpolatorNode:case r.X3DLayoutNode:case r.X3DScriptNode:case r.X3DSequencerNode:case r.X3DTriggerNode:break;default:continue}break}}catch(e){}}this.set_cameraObjects__(),this.set_display_nodes()},clear:function(){for(var e=0,t=this.childNodes.length;e<t;++e)this.childNodes[e].isCameraObject_.removeInterest("set_cameraObjects__",this);this.pointingDeviceSensors.length=0,this.maybeCameraObjects.length=0,this.cameraObjects.length=0,this.clipPlanes.length=0,this.localFogs.length=0,this.lights.length=0,this.childNodes.length=0},set_cameraObjects__:function(){this.cameraObjects.length=0;for(var e=0,t=this.maybeCameraObjects.length;e<t;++e){var i=this.maybeCameraObjects[e];i.getCameraObject()&&this.cameraObjects.push(i)}this.setCameraObject(this.cameraObjects.length)},set_display_nodes:function(){var e=this.clipPlanes,t=this.localFogs,i=this.lights,n=this.displayNodes;n.length=0;for(var r=0,s=e.length;r<s;++r)n.push(e[r]);for(var r=0,s=t.length;r<s;++r)n.push(t[r]);for(var r=0,s=i.length;r<s;++r)n.push(i[r])},traverse:function(e,t){switch(e){case n.POINTER:var i=this.pointingDeviceSensors,r=this.clipPlanes,s=this.childNodes;if(i.length){var o={};t.getBrowser().getSensors().push(o);for(var a=0,u=i.length;a<u;++a)i[a].push(t,o)}for(var a=0,u=r.length;a<u;++a)r[a].push(t);for(var a=0,u=s.length;a<u;++a)s[a].traverse(e,t);for(var a=r.length-1;a>=0;--a)r[a].pop(t);return void(i.length&&t.getBrowser().getSensors().pop());case n.CAMERA:for(var l=this.cameraObjects,a=0,u=l.length;a<u;++a)l[a].traverse(e,t);return;case n.COLLISION:case n.DEPTH:for(var r=this.clipPlanes,s=this.childNodes,a=0,u=r.length;a<u;++a)r[a].push(t);for(var a=0,u=s.length;a<u;++a)s[a].traverse(e,t);for(var a=r.length-1;a>=0;--a)r[a].pop(t);return;case n.DISPLAY:for(var h=this.displayNodes,s=this.childNodes,a=0,u=h.length;a<u;++a)h[a].push(t,this);for(var a=0,u=s.length;a<u;++a)s[a].traverse(e,t);for(var a=h.length-1;a>=0;--a)h[a].pop(t);return}}}),u}),define("standard/Math/Utility/MatrixStack",[],function(){"use strict";function e(e){return Object.assign([new e],{top:0,set:function(e){this[this.top].assign(e)},get:function(e){return this[this.top]},push:function(){var e=++this.top;e<this.length?this[e].assign(this[e-1]):this[e]=this[e-1].copy()},pushMatrix:function(e){var t=++this.top;t<this.length?this[t].assign(e):this[t]=e.copy()},pop:function(){--this.top},clear:function(){this.top=0},size:function(){return this.top+1},identity:function(){this[this.top].identity()},multLeft:function(e){this[this.top].multLeft(e)},translate:function(e){this[this.top].translate(e)},rotate:function(e){this[this.top].rotate(e)},scale:function(e){this[this.top].scale(e)}})}return e}),define("standard/Utility/ObjectCache",[],function(){"use strict";return function(e){return{stack:[],last:-1,pop:function(){if(this.last>-1){var t=this.stack[this.last];return this.last--,t}return new e},push:function(e){return this.last++,this.stack[this.last]=e},clear:function(){this.stack.length=0,this.last=-1}}}}),define("x_ite/Components/Lighting/DirectionalLight",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Lighting/X3DLightNode","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Geometry/Box3","standard/Math/Geometry/Camera","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Utility/MatrixStack","standard/Utility/ObjectCache"],function(e,t,i,n,r,s,o,a,u,l,h,c,d,p,f,g){"use strict";function m(){this.direction=new h(0,0,0),this.shadowBuffer=null,this.bbox=new a,this.viewVolume=new l,this.viewport=new c(0,0,0,0),this.projectionMatrix=new p,this.modelViewMatrix=new f(p),this.modelMatrix=new p,this.invLightSpaceMatrix=new p,this.invLightSpaceProjectionMatrix=new p,this.shadowMatrix=new p,this.shadowMatrixArray=new Float32Array(16),this.invGroupMatrix=new p,this.rotation=new d,this.textureUnit=0}function _(e){n.call(this,e),this.addType(o.DirectionalLight),this.global_=!1}var x=g(m);return m.prototype={constructor:m,getModelViewMatrix:function(){return this.modelViewMatrix},set:function(e,t,i,n){var r=e.getContext(),s=t.getShadowMapSize();this.browser=e,this.lightNode=t,this.groupNode=i,this.modelViewMatrix.pushMatrix(n),t.getShadowIntensity()>0&&s>0&&(this.shadowBuffer=e.popShadowBuffer(s),this.shadowBuffer?e.getCombinedTextureUnits().length?(this.textureUnit=e.getCombinedTextureUnits().pop(),r.activeTexture(r.TEXTURE0+this.textureUnit),e.getExtension("WEBGL_depth_texture")?r.bindTexture(r.TEXTURE_2D,this.shadowBuffer.getDepthTexture()):r.bindTexture(r.TEXTURE_2D,this.shadowBuffer.getColorTexture()),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.activeTexture(r.TEXTURE0)):console.warn("Not enough combined texture units for shadow map available."):console.warn("Couldn't create shadow buffer."))},renderShadowMap:function(e){try{if(!this.shadowBuffer)return;var t=this.lightNode,i=e.getCameraSpaceMatrix().get(),n=this.modelMatrix.assign(this.modelViewMatrix.get()).multRight(i),o=this.invLightSpaceMatrix.assign(t.getGlobal()?n:p.Identity);o.rotate(this.rotation.setFromToVec(h.zAxis,this.direction.assign(t.getDirection()).negate())),o.inverse();var a=r.prototype.getBBox.call(this.groupNode,this.bbox),l=a.multRight(o),c=t.getShadowMapSize(),d=this.viewport.set(0,0,c,c),f=u.orthoBox(l,this.projectionMatrix),g=this.invGroupMatrix.assign(this.groupNode.getMatrix()).inverse();this.shadowBuffer.bind(),e.getViewVolumes().push(this.viewVolume.set(f,d,d)),e.getProjectionMatrix().pushMatrix(f),e.getModelViewMatrix().pushMatrix(o),e.getModelViewMatrix().multLeft(g),e.render(s.DEPTH,this.groupNode),e.getModelViewMatrix().pop(),e.getProjectionMatrix().pop(),e.getViewVolumes().pop(),this.shadowBuffer.unbind(),t.getGlobal()||o.multLeft(n.inverse()),this.invLightSpaceProjectionMatrix.assign(o).multRight(f).multRight(t.getBiasMatrix())}catch(e){console.log(e)}},setGlobalVariables:function(e){this.modelViewMatrix.get().multDirMatrix(this.direction.assign(this.lightNode.getDirection())).normalize(),this.shadowMatrix.assign(e.getCameraSpaceMatrix().get()).multRight(this.invLightSpaceProjectionMatrix),this.shadowMatrixArray.set(this.shadowMatrix)},setShaderUniforms:function(e,t){var i=this.lightNode,n=i.getColor(),r=this.direction,s=i.getShadowColor(),o=t.numLights++;e.uniform1i(t.x3d_LightType[o],1),e.uniform3f(t.x3d_LightColor[o],n.r,n.g,n.b),e.uniform1f(t.x3d_LightIntensity[o],i.getIntensity()),e.uniform1f(t.x3d_LightAmbientIntensity[o],i.getAmbientIntensity()),e.uniform3f(t.x3d_LightDirection[o],r.x,r.y,r.z),this.textureUnit&&(e.uniform3f(t.x3d_ShadowColor[o],s.r,s.g,s.b),e.uniform1f(t.x3d_ShadowIntensity[o],i.getShadowIntensity()),e.uniform1f(t.x3d_ShadowBias[o],i.getShadowBias()),e.uniformMatrix4fv(t.x3d_ShadowMatrix[o],!1,this.shadowMatrixArray),e.uniform1i(t.x3d_ShadowMapSize[o],i.getShadowMapSize()),e.uniform1i(t.x3d_ShadowMap[o],this.textureUnit))},dispose:function(){this.textureUnit&&this.browser.getCombinedTextureUnits().push(this.textureUnit),this.browser.pushShadowBuffer(this.shadowBuffer),this.modelViewMatrix.clear(),this.browser=null,this.lightNode=null,this.groupNode=null,this.shadowBuffer=null,this.textureUnit=0,x.push(this)}},_.prototype=Object.assign(Object.create(n.prototype),{constructor:_,fieldDefinitions:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"global",new e.SFBool(!0)),new t(o.inputOutput,"on",new e.SFBool(!0)),new t(o.inputOutput,"color",new e.SFColor(1,1,1)),new t(o.inputOutput,"intensity",new e.SFFloat(1)),new t(o.inputOutput,"ambientIntensity",new e.SFFloat),new t(o.inputOutput,"direction",new e.SFVec3f(0,0,-1)),new t(o.inputOutput,"shadowColor",new e.SFColor),new t(o.inputOutput,"shadowIntensity",new e.SFFloat),new t(o.inputOutput,"shadowBias",new e.SFFloat(.005)),new t(o.initializeOnly,"shadowMapSize",new e.SFInt32(1024))]),getTypeName:function(){return"DirectionalLight"},getComponentName:function(){return"Lighting"},getContainerField:function(){return"children"},getLights:function(){return x}}),_}),define("x_ite/Browser/Navigation/X3DNavigationContext",["x_ite/Fields","x_ite/Browser/Navigation/ExamineViewer","x_ite/Browser/Navigation/WalkViewer","x_ite/Browser/Navigation/FlyViewer","x_ite/Browser/Navigation/PlaneViewer","x_ite/Browser/Navigation/NoneViewer","x_ite/Browser/Navigation/LookAtViewer","x_ite/Components/Lighting/DirectionalLight","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r,s,o,a,u){"use strict";function l(e){var t=new a(e.getPrivateScene());t.setup();var i=t.getLights().pop();return i.set(e,t,null,u.Identity),i.dispose=function(){},i}function h(){this.addChildObjects("activeLayer",new e.SFNode,"activeNavigationInfo",new e.SFNode,"activeViewpoint",new e.SFNode,"availableViewers",new e.MFString,"viewer",new e.SFString("EXAMINE")),this.activeCollisions=new Set,this.viewerNode=null}return h.prototype={initialize:function(){this.viewer_.addInterest("set_viewer__",this),this.initialized().addInterest("set_world__",this),this.shutdown().addInterest("remove_world__",this),this.headlightContainer=l(this)},getHeadlight:function(){return this.headlightContainer},getActiveLayer:function(){return this.activeLayer_.getValue()},getActiveNavigationInfo:function(){return this.activeNavigationInfo_.getValue()},getActiveViewpoint:function(){return this.activeViewpoint_.getValue()},getCurrentViewer:function(){return this.viewer_.getValue()},addCollision:function(e){this.activeCollisions.add(e)},removeCollision:function(e){this.activeCollisions.delete(e)},getCollisionCount:function(){return this.activeCollisions.size},remove_world__:function(){this.getWorld().activeLayer_.removeInterest("set_activeLayer__",this)},set_world__:function(){this.getWorld().activeLayer_.addInterest("set_activeLayer__",this),this.set_activeLayer__()},set_activeLayer__:function(){this.activeLayer_.getValue()&&(this.activeLayer_.getValue().getNavigationInfoStack().removeInterest("set_activeNavigationInfo__",this),this.activeLayer_.getValue().getViewpointStack().removeInterest("set_activeViewpoint__",this)),this.activeLayer_=this.getWorld().getActiveLayer(),this.activeLayer_.getValue()&&(this.activeLayer_.getValue().getNavigationInfoStack().addInterest("set_activeNavigationInfo__",this),this.activeLayer_.getValue().getViewpointStack().addInterest("set_activeViewpoint__",this)),this.set_activeNavigationInfo__(),this.set_activeViewpoint__()},set_activeNavigationInfo__:function(){this.activeNavigationInfo_.getValue()&&this.activeNavigationInfo_.getValue().viewer_.removeFieldInterest(this.viewer_),this.activeLayer_.getValue()?(this.activeNavigationInfo_=this.activeLayer_.getValue().getNavigationInfo(),this.activeNavigationInfo_.getValue().viewer_.addFieldInterest(this.viewer_),this.viewer_=this.activeNavigationInfo_.getValue().viewer_):(this.activeNavigationInfo_=null,this.viewer_="NONE")},set_activeViewpoint__:function(){this.activeLayer_.getValue()?this.activeViewpoint_=this.activeLayer_.getValue().getViewpoint():this.activeViewpoint_=null},set_viewer__:function(e){switch(this.activeNavigationInfo_.getValue()?this.availableViewers_=this.activeNavigationInfo_.getValue().availableViewers_:this.availableViewers_.length=0,this.viewerNode&&this.viewerNode.dispose(),e.getValue()){case"EXAMINE":this.viewerNode=new t(this);break;case"WALK":this.viewerNode=new i(this);break;case"FLY":this.viewerNode=new n(this);break;case"PLANE":case"PLANE_create3000.de":this.viewerNode=new r(this);break;case"NONE":this.viewerNode=new s(this);break;case"LOOKAT":this.viewerNode=new o(this);break;default:this.viewerNode=new t(this)}this.viewerNode.setup()}},h}),define("x_ite/Components/Layering/X3DViewportNode",["x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DViewportNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i}),i}),define("x_ite/Components/Layering/Viewport",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Layering/X3DViewportNode","x_ite/Bits/X3DConstants","x_ite/Bits/TraverseType","standard/Utility/ObjectCache","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector4"],function(e,t,i,n,r,s,o,a,u){"use strict";function l(e){n.call(this,e),this.addType(r.Viewport),this.rectangle=new u(0,0,0,0)}var h=o(a);return l.prototype=Object.assign(Object.create(n.prototype),{constructor:l,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"clipBoundary",new e.MFFloat(0,1,0,1)),new t(r.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(r.initializeOnly,"bboxCenter",new e.SFVec3f),new t(r.inputOnly,"addChildren",new e.MFNode),new t(r.inputOnly,"removeChildren",new e.MFNode),new t(r.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"Viewport"},getComponentName:function(){return"Layering"},getContainerField:function(){return"viewport"},getRectangle:function(e){var t=e.getViewport(),i=Math.floor(t[2]*this.getLeft()),n=Math.floor(t[2]*this.getRight()),r=Math.floor(t[3]*this.getBottom()),s=Math.floor(t[3]*this.getTop());return this.rectangle.set(i,r,Math.max(0,n-i),Math.max(0,s-r)),this.rectangle},getLeft:function(){return this.clipBoundary_.length>0?this.clipBoundary_[0]:0},getRight:function(){return this.clipBoundary_.length>1?this.clipBoundary_[1]:1},getBottom:function(){return this.clipBoundary_.length>2?this.clipBoundary_[2]:0},getTop:function(){return this.clipBoundary_.length>3?this.clipBoundary_[3]:1},traverse:function(e,t){switch(this.push(t),e){case s.POINTER:t.getBrowser().isPointerInRectangle(this.rectangle)&&n.prototype.traverse.call(this,e,t);break;default:n.prototype.traverse.call(this,e,t)}this.pop(t)},push:function(e){var t=e.getViewVolumes(),i=this.getRectangle(e.getBrowser()),n=t.length?t[t.length-1].getViewport():i,r=h.pop();r.set(e.getProjectionMatrix().get(),n,i),t.push(r)},pop:function(e){h.push(e.getViewVolumes().pop())}}),l}),define("x_ite/Browser/Layering/X3DLayeringContext",["x_ite/Components/Layering/Viewport"],function(e){"use strict";function t(){this.defaultViewport=new e(this.getPrivateScene())}return t.prototype={initialize:function(){this.defaultViewport.setup()},getDefaultViewport:function(){return this.defaultViewport}},t}),define("x_ite/Components/Texturing/TextureProperties",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.TextureProperties)}var o={CLAMP:"CLAMP_TO_EDGE",CLAMP_TO_EDGE:"CLAMP_TO_EDGE",CLAMP_TO_BOUNDARY:"CLAMP_TO_EDGE",MIRRORED_REPEAT:"MIRRORED_REPEAT",REPEAT:"REPEAT"},a={AVG_PIXEL_AVG_MIPMAP:"LINEAR_MIPMAP_LINEAR",AVG_PIXEL:"LINEAR",AVG_PIXEL_NEAREST_MIPMAP:"LINEAR_MIPMAP_NEAREST",NEAREST_PIXEL_AVG_MIPMAP:"NEAREST_MIPMAP_LINEAR",NEAREST_PIXEL_NEAREST_MIPMAP:"NEAREST_MIPMAP_NEAREST",NEAREST_PIXEL:"NEAREST",NICEST:"LINEAR_MIPMAP_LINEAR",FASTEST:"NEAREST"},u={AVG_PIXEL:"LINEAR",NEAREST_PIXEL:"NEAREST",NICEST:"LINEAR",FASTEST:"NEAREST"};return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"borderColor",new e.SFColorRGBA),new t(r.inputOutput,"borderWidth",new e.SFInt32),new t(r.inputOutput,"anisotropicDegree",new e.SFFloat(1)),new t(r.initializeOnly,"generateMipMaps",new e.SFBool),new t(r.inputOutput,"minificationFilter",new e.SFString("FASTEST")),new t(r.inputOutput,"magnificationFilter",new e.SFString("FASTEST")),new t(r.inputOutput,"boundaryModeS",new e.SFString("REPEAT")),new t(r.inputOutput,"boundaryModeT",new e.SFString("REPEAT")),new t(r.inputOutput,"boundaryModeR",new e.SFString("REPEAT")),new t(r.inputOutput,"textureCompression",new e.SFString("FASTEST")),new t(r.inputOutput,"texturePriority",new e.SFFloat)]),getTypeName:function(){return"TextureProperties"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"textureProperties"},getBoundaryMode:function(e){var t=o[e];return void 0!==t?t:"REPEAT"},getBoundaryModeS:function(){return this.getBoundaryMode(this.boundaryModeS_.getValue())},getBoundaryModeT:function(){return this.getBoundaryMode(this.boundaryModeT_.getValue())},getBoundaryModeR:function(){return this.getBoundaryMode(this.boundaryModeR_.getValue())},getMinificationFilter:function(){if(this.generateMipMaps_.getValue()){var e=a[this.minificationFilter_.getValue()];return void 0!==e?e:this.getBrowser().getDefaultTextureProperties().getMinificationFilter()}return"LINEAR"},getMagnificationFilter:function(){var e=u[this.magnificationFilter_.getValue()];return void 0!==e?e:this.getBrowser().getDefaultTextureProperties().getMagnificationFilter()}}),s}),define("x_ite/Browser/Layout/X3DLayoutContext",["jquery","x_ite/Components/Texturing/TextureProperties"],function(e,t){"use strict";function i(){this.screenTextureProperties=new t(this.getPrivateScene())}return i.prototype={initialize:function(){this.screenTextureProperties.boundaryModeS_="CLAMP",this.screenTextureProperties.boundaryModeT_="CLAMP",this.screenTextureProperties.boundaryModeR_="CLAMP",this.screenTextureProperties.minificationFilter_="NEAREST",this.screenTextureProperties.magnificationFilter_="NEAREST",this.screenTextureProperties.generateMipMaps_=!1,this.screenTextureProperties.setup();var t=e("<div></div>");this.pointSize=t.appendTo(e("body")).css("height","1in").css("display","none").height()/72,t.remove()},getScreenTextureProperties:function(){return this.screenTextureProperties},getPointSize:function(){return this.pointSize}},i}),define("text!x_ite/Browser/Shaders/Background.vs",[],function(){return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nuniform mat4 x3d_ProjectionMatrix;\nuniform mat4 x3d_ModelViewMatrix;\n\nattribute vec4 x3d_Color;\nattribute vec4 x3d_Vertex;\n\nvarying vec4 C; // color\nvarying vec3 v; // point on geometry\n\nvoid\nmain ()\n{\n\tvec4 p = x3d_ModelViewMatrix * x3d_Vertex;\n\n\tv           = p .xyz;\n\tgl_Position = x3d_ProjectionMatrix * p;\n\tC           = x3d_Color;\n}\n"}),define("text!x_ite/Browser/Shaders/Background.fs",[],function(){return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nuniform int  x3d_NumClipPlanes;\nuniform vec4 x3d_ClipPlane [x3d_MaxClipPlanes];\n\nvarying vec4 C; // color\nvarying vec3 v; // point on geometry\n\nvoid\nclip ()\n{\n\tfor (int i = 0; i < x3d_MaxClipPlanes; ++ i)\n\t{\n\t\tif (i == x3d_NumClipPlanes)\n\t\t\tbreak;\n\n\t\tif (dot (v, x3d_ClipPlane [i] .xyz) - x3d_ClipPlane [i] .w < 0.0)\n\t\t\tdiscard;\n\t}\n}\n\nvoid\nmain ()\n{\n\tclip ();\n\n\tgl_FragColor = C;\n}\n"}),define("x_ite/Browser/EnvironmentalEffects/X3DEnvironmentalEffectsContext",["x_ite/Components/Shaders/ComposedShader","x_ite/Components/Shaders/ShaderPart","x_ite/Components/Texturing/TextureProperties","text!x_ite/Browser/Shaders/Background.vs","text!x_ite/Browser/Shaders/Background.fs"],function(e,t,i,n,r){"use strict";function s(){this.backgroundTextureProperties=new i(this.getPrivateScene()),this.localFogs=[]}return s.prototype={initialize:function(){this.backgroundSphereShader=this.createShader(this,"BackgroundSphereShader",n,r),this.backgroundTextureProperties.boundaryModeS_="CLAMP_TO_EDGE",this.backgroundTextureProperties.boundaryModeT_="CLAMP_TO_EDGE",this.backgroundTextureProperties.boundaryModeR_="CLAMP_TO_EDGE",this.backgroundTextureProperties.minificationFilter_="NICEST",this.backgroundTextureProperties.magnificationFilter_="NICEST",this.backgroundTextureProperties.setup()},getBackgroundSphereShader:function(){return this.backgroundSphereShader},getBackgroundTextureProperties:function(){return this.backgroundTextureProperties},getLocalFogs:function(){return this.localFogs}},s}),define("x_ite/Browser/Lighting/X3DLightingContext",["x_ite/Rendering/TextureBuffer"],function(e){"use strict";function t(){this.localLights=[],this.shadowBuffers=[]}return t.prototype={initialize:function(){},getMaxLights:function(){return 8},getLocalLights:function(){return this.localLights},popShadowBuffer:function(t){try{var i=this.shadowBuffers[t];if(i){if(i.length)return i.pop()}else this.shadowBuffers[t]=[];return new e(this,t,t)}catch(e){return console.log(e),null}},pushShadowBuffer:function(e){e&&this.shadowBuffers[e.getWidth()].push(e)}},t}),define("x_ite/Browser/Sound/X3DSoundContext",["x_ite/Fields"],function(e){"use strict";function t(){this.addChildObjects("volume",new e.SFFloat(1),"mute",new e.SFBool)}return t.prototype={initialize:function(){this.volume_.addInterest("set_volume__",this),this.mute_.addInterest("set_mute__",this);var e=this.getLocalStorage()["X3DSoundContext.volume"],t=this.getLocalStorage()["X3DSoundContext.mute"];void 0!==e&&(this.volume_=e),void 0!==t&&(this.mute_=t)},set_volume__:function(e){this.getLocalStorage()["X3DSoundContext.volume"]=e.getValue()},set_mute__:function(e){this.getLocalStorage()["X3DSoundContext.mute"]=e.getValue()}},t}),define("x_ite/Browser/Text/TextAlignment",[],function(){"use strict";var e=0,t={BEGIN:++e,FIRST:++e,MIDDLE:++e,END:++e};return Object.preventExtensions(t),Object.freeze(t),Object.seal(t),t}),define("standard/Utility/Shuffle",[],function(){"use strict";return function(e){for(var t=e.length;t>1;){var i=--t,n=Math.floor(Math.random()*i),r=e[i];e[i]=e[n],e[n]=r}return e}}),define("x_ite/Components/Text/X3DFontStyleNode",["x_ite/Fields","x_ite/Components/Core/X3DNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Browser/Text/TextAlignment","x_ite/InputOutput/FileLoader","x_ite/Bits/X3DConstants","x_ite/Browser/Networking/urls","standard/Utility/Shuffle","standard/Networking/URI","x_ite/Browser/VERSION","x_ite/DEBUG"],function(e,t,i,n,r,s,o,a,u,l,h){"use strict";function c(i){t.call(this,i),this.addType(s.X3DFontStyleNode),this.addChildObjects("loadState",new e.SFInt32(s.NOT_STARTED_STATE)),this.familyStack=[],this.alignments=[],this.loader=new r(this)}var d=h||l.match(/a$/)?"latest":l,p=["https://code.create3000.de/fonts/","https://cdn.rawgit.com/create3000/x_ite/"+d+"/fonts/","https://cdn.jsdelivr.net/gh/create3000/x_ite@"+d+"/fonts/"];a(p);var f={SERIF:{PLAIN:"DroidSerif-Regular.ttf",ITALIC:"DroidSerif-Italic.ttf",BOLD:"DroidSerif-Bold.ttf",BOLDITALIC:"DroidSerif-BoldItalic.ttf"},SANS:{PLAIN:"Ubuntu-R.ttf",ITALIC:"Ubuntu-RI.ttf",BOLD:"Ubuntu-B.ttf",BOLDITALIC:"Ubuntu-BI.ttf"},TYPEWRITER:{PLAIN:"UbuntuMono-R.ttf",ITALIC:"UbuntuMono-RI.ttf",BOLD:"UbuntuMono-B.ttf",BOLDITALIC:"UbuntuMono-BI.ttf"}};return c.prototype=Object.assign(Object.create(t.prototype),{constructor:c,initialize:function(){t.prototype.initialize.call(this),this.style_.addInterest("set_style__",this),this.justify_.addInterest("set_justify__",this),this.font=null,this.familyIndex=0,this.set_justify__(),this.set_style__(),this.requestAsyncLoad()},setLoadState:i.prototype.setLoadState,checkLoadState:i.prototype.checkLoadState,getMajorAlignment:function(){return this.alignments[0]},getMinorAlignment:function(){return this.alignments[1]},set_style__:function(){this.setLoadState(s.NOT_STARTED_STATE),this.requestAsyncLoad()},set_justify__:function(){var e=this.horizontal_.getValue()?this.leftToRight_.getValue():this.topToBottom_.getValue();this.alignments[0]=this.justify_.length>0?this.getAlignment(0,e):e?n.BEGIN:n.END;var t=this.horizontal_.getValue()?this.topToBottom_.getValue():this.leftToRight_.getValue();this.alignments[1]=this.justify_.length>1?this.getAlignment(1,t):t?n.FIRST:n.END},getAlignment:function(e,t){if(t)switch(this.justify_[e]){case"FIRST":return n.FIRST;case"BEGIN":return n.BEGIN;case"MIDDLE":return n.MIDDLE;case"END":return n.END}else switch(this.justify_[e]){case"FIRST":return n.END;case"BEGIN":return n.END;case"MIDDLE":return n.MIDDLE;case"END":return n.BEGIN}return e?n.FIRST:n.BEGIN},requestAsyncLoad:function(){if(this.checkLoadState()!==s.COMPLETE_STATE&&this.checkLoadState()!==s.IN_PROGRESS_STATE){this.setLoadState(s.IN_PROGRESS_STATE);var e=this.family_.copy();e.push("SERIF"),this.familyStack.length=0;for(var t=0,i=e.length;t<i;++t){var n=e[t],r=this.getDefaultFont(n);if(r)for(var o=0;o<p.length;++o)this.familyStack.push(p[o]+r);else this.familyStack.push(n)}this.loadNext()}},getDefaultFont:function(e){var t=f[e];if(t){var i=t[this.style_.getValue()];return i?i:t.PLAIN}},loadNext:function(){try{if(0===this.familyStack.length)return this.setLoadState(s.FAILED_STATE),void(this.font=null);this.family=this.familyStack.shift(),this.URL=this.loader.transform(this.family),this.getBrowser().getFont(this.URL,this.setFont.bind(this),this.setError.bind(this))}catch(e){this.setError(e.message)}},setError:function(e){"data"!==this.URL.scheme&&console.warn("Error loading font '"+this.URL.toString()+"':",e),this.loadNext()},setFont:function(e){this.font=e,this.setLoadState(s.COMPLETE_STATE),this.addNodeEvent()},getFont:function(){return this.font}}),c}),define("standard/Math/Geometry/Box2",["standard/Math/Numbers/Matrix3","standard/Math/Numbers/Vector2"],function(e,t){"use strict";function i(t,i){switch(arguments.length){case 0:return void(this.matrix=new e(.5,0,0,0,.5,0,0,0,0));case 2:return void(this.matrix=new e(t.x/2,0,0,0,t.y/2,0,i.x,i.y,1));case 3:var n=arguments[0],r=arguments[1],s=(r.x-n.x)/2,o=(r.y-n.y)/2,a=(r.x+n.x)/2,u=(r.y+n.y)/2;return void(this.matrix=new e(s,0,0,0,o,0,a,u,1))}}var n=new t(0,0),r=new t(0,0),s=new t(0,0),o=new t(0,0),a=new t(0,0),u=new t(0,0),l=new t(0,0),h=new t(0,0),c=new t(0,0);return i.prototype={constructor:i,copy:function(){var e=Object.create(i.prototype);return e.matrix=this.matrix.copy(),e},assign:function(e){return this.matrix.assign(e.matrix),this},equals:function(e){return this.matrix.equals(e.matrix)},set:function(e,t){var i=this.matrix;switch(arguments.length){case 0:return i[0]=.5,i[1]=0,i[2]=0,i[3]=0,i[4]=.5,i[5]=0,i[6]=0,i[7]=0,i[8]=0,this;case 2:return i[0]=e.x/2,i[1]=0,i[2]=0,i[3]=0,i[4]=e.y/2,i[5]=0,i[6]=t.x,i[7]=t.y,i[8]=1,this}},setExtents:function(e,t){var i=this.matrix,n=(t.x-e.x)/2,r=(t.y-e.y)/2,s=(t.x+e.x)/2,o=(t.y+e.y)/2;return i[0]=n,i[1]=0,i[2]=0,i[3]=0,i[4]=r,i[5]=0,i[6]=s,i[7]=o,i[8]=1,this},isEmpty:function(){return 0===this.matrix[8]},add:function(e){return this.isEmpty()?this.assign(e):e.isEmpty()?this:(this.getExtents(u,l),e.getExtents(h,c),this.assign(new i(u.min(h),l.max(c),!0)))},multLeft:function(e){return this.matrix.multLeft(e),this},multRight:function(e){return this.matrix.multRight(e),this},getExtents:function(e,t){this.getAbsoluteExtents(e,t),e.add(this.center),t.add(this.center)},getAbsoluteExtents:function(e,t){var i=this.matrix;n.assign(i.xAxis),r.assign(i.yAxis),a.assign(n).add(r);var s=r.subtract(n);e.assign(a).min(s),t.assign(a).max(s),a.negate(),s.negate(),e.min(a,s),t.max(a,s)},intersectsPoint:function(e){return this.getExtents(s,o),s.x<=e.x&&o.x>=e.x&&s.y<=e.y&&o.y>=e.y},toString:function(){return this.size+", "+this.center}},Object.defineProperty(i.prototype,"size",{get:function(){var e=new t(0,0);return this.getAbsoluteExtents(s,e),e.subtract(s)},enumerable:!0,configurable:!1}),Object.defineProperty(i.prototype,"center",{get:function(){return this.matrix.origin},enumerable:!0,configurable:!1}),i}),define("x_ite/Browser/Text/X3DTextGeometry",["x_ite/Browser/Text/TextAlignment","standard/Math/Geometry/Box2","standard/Math/Geometry/Box3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(e,t,i,n,r){"use strict";function s(e,t){this.text=e,this.fontStyle=t,this.glyphs=[],this.minorAlignment=new n(0,0),this.translations=[],this.charSpacings=[],this.bearing=new n(0,0),this.yPad=[],this.bbox=new i}var o={},a=new t,u=new t,l=new n(0,0),h=new n(0,0),c=new n(0,0),d=new n(0,0),p=new r(0,0,0),f=new r(0,0,0),g=new n(0,0),m=new n(0,0),_=new n(0,0),x=new n(0,0),y=new n(0,0),v=new r(0,0,0),w=new n(0,0),b=new t,S=new n(0,0),C=new r(0,0,0);return s.prototype={constructor:s,getBrowser:function(){return this.text.getBrowser()},getText:function(){
return this.text},getFontStyle:function(){return this.fontStyle},getGlyphs:function(){return this.glyphs},getMinorAlignment:function(){return this.minorAlignment},getTranslations:function(){return this.translations},getCharSpacings:function(){return this.charSpacings},getBearing:function(){return this.bearing},getBBox:function(){return this.bbox},update:function(){var e=this.text,t=this.fontStyle,i=e.string_.length;if(e.lineBounds_.length=i,this.glyphs.length=0,0===i||!t.getFont())return e.origin_.setValue(C),e.textBounds_.setValue(S),void this.bbox.set();if(t.horizontal_.getValue())this.resizeArray(this.translations,i),this.resizeArray(this.charSpacings,i),this.horizontal(e,t);else{for(var n=e.string_,r=0,s=0,o=n.length;s<o;++s)r+=n[s].length;this.resizeArray(this.translations,r),this.resizeArray(this.charSpacings,r),this.vertical(e,t)}},resizeArray:function(e,t){for(var i=e.length;i<t;++i)e.push(new n(0,0));e.length=t},horizontal:function(t,i){var n=i.getFont(),r=t.string_,s=r.length,o=Math.max(0,t.maxExtent_.getValue()),u=i.topToBottom_.getValue(),c=i.getScale(),d=i.spacing_.getValue();a.set();for(var x=u?0:s-1,w=u?s:-1,S=u?1:-1,C=x,T=0;C!==w;C+=S,++T){var F=r[C],O=this.getHorizontalLineExtents(i,F,l,h,T);g.assign(h).subtract(l);var N=u?C:s-C-1,M=0,D=t.getLength(C);switch(y.set(g.x,0==N?h.y-n.descender/n.unitsPerEm:d).multiply(c),o&&(D=D?Math.min(o,D):Math.min(o,g.x*c)),D&&(M=(D-y.x)/(O.length-1),y.x=D,g.x=D/c),this.charSpacings[T]=M,t.lineBounds_[C]=y,i.getMajorAlignment()){case e.BEGIN:case e.FIRST:this.translations[T].set(0,-T*d);break;case e.MIDDLE:this.translations[T].set(-l.x-g.x/2,-T*d);break;case e.END:this.translations[T].set(-l.x-g.x,-T*d)}this.translations[T].multiply(c),m.assign(l).add(_.assign(g).divide(2)),a.add(b.set(g.multiply(c),m.multiply(c).add(this.translations[T])))}switch(a.getExtents(l,h),g.assign(h).subtract(l),t.textBounds_=g,this.bearing.set(0,-h.y),i.getMinorAlignment()){case e.BEGIN:this.minorAlignment.assign(this.bearing);break;case e.FIRST:this.minorAlignment.set(0,0);break;case e.MIDDLE:this.minorAlignment.set(0,g.y/2-h.y);break;case e.END:this.minorAlignment.set(0,(s-1)*d*c)}l.add(this.minorAlignment),h.add(this.minorAlignment),t.origin_.setValue(v.set(l.x,h.y,0)),this.bbox.setExtents(p.set(l.x,l.y,0),f.set(h.x,h.y,0))},vertical:function(t,i){var r=i.getFont(),s=t.string_,o=s.length,d=Math.max(0,t.maxExtent_.getValue()),S=i.leftToRight_.getValue(),C=i.topToBottom_.getValue(),T=i.getScale(),F=i.spacing_.getValue(),O=this.yPad,N=this.getBrowser().getBrowserOptions().getPrimitiveQuality();a.set();for(var M=S?0:o-1,D=S?o:-1,E=S?1:-1,V=0,B=M;B!==D;B+=E){var I=this.stringToGlyphs(r,s[B],!0,B),A=V,P=I.length;u.set();for(var R=C?0:P-1,L=C?P:-1,z=C?1:-1,k=R;k!==L;k+=z,++V){var X=I[k];this.getGlyphExtents(X,N,l,h),g.assign(h).subtract(l);var U=C?k:P-k-1;this.translations[V].set((F-g.x-l.x)/2,-U),m.assign(l).add(_.assign(g).divide(2)).add(this.translations[V]),u.add(b.set(g,m))}u.getExtents(l,h),g.assign(h).subtract(l);var j=S?B:o-B-1,G=(F-g.x)/2,q=0,H=t.getLength(B);switch(y.set(0===B?F-G:F,P?g.y:0).multiply(T),d&&(H=H?Math.min(d,H):Math.min(d,g.y*T)),H&&(q=(H-y.y)/(I.length-1)/T,y.y=H,g.y=H/T,l.y=h.y-g.y),t.lineBounds_[B]=y,i.getMajorAlignment()){case e.BEGIN:case e.FIRST:x.set(j*F,-1);break;case e.MIDDLE:x.set(j*F,g.y/2-h.y);break;case e.END:P&&this.getGlyphExtents(I[C?P-1:0],N,c.assign(n.Zero),w),x.set(j*F,g.y-h.y+c.y)}for(var W=0,Y=A;Y<V;++Y)this.translations[Y].add(x),this.translations[Y].y-=W,this.translations[Y].multiply(T),W+=q;switch(i.getMajorAlignment()){case e.BEGIN:case e.FIRST:O[B]=h.y+x.y;break;case e.MIDDLE:O[B]=0;break;case e.END:O[B]=l.y+x.y}m.assign(l).add(_.assign(g).divide(2)),a.add(b.set(g.multiply(T),m.add(x).multiply(T)))}switch(a.getExtents(l,h),g.assign(h).subtract(l),i.getMajorAlignment()){case e.BEGIN:case e.FIRST:for(var $=t.lineBounds_,K=0,H=$.length;K<H;++K)$[K].y+=h.y-O[K]*T;break;case e.MIDDLE:break;case e.END:for(var $=t.lineBounds_,K=0,H=$.length;K<H;++K)$[K].y+=O[K]*T-l.y}switch(t.textBounds_=g,i.getMajorAlignment()){case e.BEGIN:case e.FIRST:this.bearing.set(-l.x,h.y);break;case e.MIDDLE:this.bearing.set(-l.x,0);break;case e.END:this.bearing.set(-l.x,l.y)}switch(i.getMinorAlignment()){case e.BEGIN:case e.FIRST:this.minorAlignment.set(-l.x,0);break;case e.MIDDLE:this.minorAlignment.set(-l.x-g.x/2,0);break;case e.END:this.minorAlignment.set(-l.x-g.x,0)}l.add(this.minorAlignment),h.add(this.minorAlignment),t.origin_.setValue(v.set(l.x,h.y,0)),this.bbox.set(p.set(l.x,l.y,0),f.set(h.x,h.y,0),!0)},stringToGlyphs:function(e,t,i,n){var r=o[e.fontName],s=this.glyphs[n];r||(r=o[e.fontName]=[]),s||(s=this.glyphs[n]=[]),s.length=t.length;for(var a=i?0:t.length-1,u=i?t.length:-1,l=i?1:-1,h=a,c=0;h!==u;h+=l,++c){var d=t.charCodeAt(h),p=null;(p=r[d])||(p=e.stringToGlyphs(t[h])[0],r[d]=p,p.extents={}),s[c]=p}return s},getHorizontalLineExtents:function(t,i,n,r,s){for(var o=t.getFont(),a=t.horizontal_.getValue()?t.leftToRight_.getValue():t.topToBottom_.getValue(),u=this.stringToGlyphs(o,i,a,s),l=this.getBrowser().getBrowserOptions().getPrimitiveQuality(),h=0,p=0,f=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,m=0,_=u.length;m<_;++m){var x=u[m],y=m+1<_?o.getKerningValue(x,u[m+1]):0;this.getGlyphExtents(x,l,c,d),p+=x.advanceWidth+y,f=Math.min(f,c.y),g=Math.max(g,d.y)}switch(u.length?(this.getGlyphExtents(u[0],l,c,d),h=c.x):(f=0,g=0),n.set(h,f),r.set(p/o.unitsPerEm,g),t.getMajorAlignment()){case e.BEGIN:case e.FIRST:n.x=0}return u},traverse:function(e,t){}},s});var Bezier=function(e){function t(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){"use strict";e.exports=i(1)},function(e,t,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(){function t(e,t,i,n,r){void 0===r&&(r=.5);var s=p.projectionratio(r,e),o=1-s,a={x:s*t.x+o*n.x,y:s*t.y+o*n.y},u=p.abcratio(r,e);return{A:{x:i.x+(i.x-a.x)/u,y:i.y+(i.y-a.y)/u},B:i,C:a}}var r=Math.abs,s=Math.min,o=Math.max,a=Math.cos,u=Math.sin,l=Math.acos,h=Math.sqrt,c=Math.PI,d={x:0,y:0,z:0},p=i(2),f=i(3),g=function(e){var t=e&&e.forEach?e:[].slice.call(arguments),i=!1;if("object"===n(t[0])){i=t.length;var s=[];t.forEach(function(e){["x","y","z"].forEach(function(t){void 0!==e[t]&&s.push(e[t])})}),t=s}var o=!1,a=t.length;if(i){if(i>4){if(1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");o=!0}}else if(6!==a&&8!==a&&9!==a&&12!==a&&1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");var u=!o&&(9===a||12===a)||e&&e[0]&&void 0!==e[0].z;this._3d=u;for(var l=[],h=0,c=u?3:2;a>h;h+=c){var d={x:t[h],y:t[h+1]};u&&(d.z=t[h+2]),l.push(d)}this.order=l.length-1,this.points=l;var f=["x","y"];u&&f.push("z"),this.dims=f,this.dimlen=f.length,function(e){for(var t=e.order,i=e.points,n=p.align(i,{p1:i[0],p2:i[t]}),s=0;s<n.length;s++)if(r(n[s].y)>1e-4)return void(e._linear=!1);e._linear=!0}(this),this._t1=0,this._t2=1,this.update()},m=i(4);g.SVGtoBeziers=function(e){return m(g,e)},g.quadraticFromPoints=function(e,i,n,r){return void 0===r&&(r=.5),0===r?new g(i,i,n):1===r?new g(e,i,i):new g(e,t(2,e,i,n,r).A,n)},g.cubicFromPoints=function(e,i,n,r,s){void 0===r&&(r=.5);var o=t(3,e,i,n,r);void 0===s&&(s=p.dist(i,o.C));var a=s*(1-r)/r,u=p.dist(e,n),l=(n.x-e.x)/u,h=(n.y-e.y)/u,c=s*l,d=s*h,f=a*l,m=a*h,_={x:i.x-c,y:i.y-d},x={x:i.x+f,y:i.y+m},y=o.A,v={x:y.x+(_.x-y.x)/(1-r),y:y.y+(_.y-y.y)/(1-r)},w={x:y.x+(x.x-y.x)/r,y:y.y+(x.y-y.y)/r};return new g(e,{x:e.x+(v.x-e.x)/r,y:e.y+(v.y-e.y)/r},{x:n.x+(w.x-n.x)/(1-r),y:n.y+(w.y-n.y)/(1-r)},n)};var _=function(){return p};g.getUtils=_,g.PolyBezier=f,g.prototype={getUtils:_,valueOf:function(){return this.toString()},toString:function(){return p.pointsToString(this.points)},toSVG:function(e){if(this._3d)return!1;for(var t=this.points,i=t[0].x,n=t[0].y,r=["M",i,n,2===this.order?"Q":"C"],s=1,o=t.length;o>s;s++)r.push(t[s].x),r.push(t[s].y);return r.join(" ")},update:function(){this.dpoints=[];for(var e=this.points,t=e.length,i=t-1;t>1;t--,i--){for(var n,r=[],s=0;i>s;s++)n={x:i*(e[s+1].x-e[s].x),y:i*(e[s+1].y-e[s].y)},this._3d&&(n.z=i*(e[s+1].z-e[s].z)),r.push(n);this.dpoints.push(r),e=r}this.computedirection()},computedirection:function(){var e=this.points,t=p.angle(e[0],e[this.order],e[1]);this.clockwise=t>0},length:function(){return p.length(this.derivative.bind(this))},_lut:[],getLUT:function(e){if(e=e||100,this._lut.length===e)return this._lut;this._lut=[],e--;for(var t=0;e>=t;t++)this._lut.push(this.compute(t/e));return this._lut},on:function(e,t){t=t||5;for(var i,n=this.getLUT(),r=[],s=0,o=0;o<n.length;o++)i=n[o],p.dist(i,e)<t&&(r.push(i),s+=o/n.length);return!!r.length&&(s/=r.length)},project:function(e){var t=this.getLUT(),i=t.length-1,n=p.closest(t,e),r=n.mdist,s=n.mpos;if(0===s||s===i){var o=s/i,a=this.compute(o);return a.t=o,a.d=r,a}var u,o,l,h,c=(s-1)/i,d=(s+1)/i,f=.1/i;for(r+=1,o=c,u=o;d+f>o;o+=f)l=this.compute(o),h=p.dist(e,l),r>h&&(r=h,u=o);return l=this.compute(u),l.t=u,l.d=r,l},get:function(e){return this.compute(e)},point:function(e){return this.points[e]},compute:function(e){if(0===e)return this.points[0];if(1===e)return this.points[this.order];var t=this.points,i=1-e;if(1===this.order)return l={x:i*t[0].x+e*t[1].x,y:i*t[0].y+e*t[1].y},this._3d&&(l.z=i*t[0].z+e*t[1].z),l;if(this.order<4){var n,r,s,o=i*i,a=e*e,u=0;2===this.order?(t=[t[0],t[1],t[2],d],n=o,r=i*e*2,s=a):3===this.order&&(n=o*i,r=o*e*3,s=i*a*3,u=e*a);var l={x:n*t[0].x+r*t[1].x+s*t[2].x+u*t[3].x,y:n*t[0].y+r*t[1].y+s*t[2].y+u*t[3].y};return this._3d&&(l.z=n*t[0].z+r*t[1].z+s*t[2].z+u*t[3].z),l}for(var h=JSON.parse(JSON.stringify(this.points));h.length>1;){for(var c=0;c<h.length-1;c++)h[c]={x:h[c].x+(h[c+1].x-h[c].x)*e,y:h[c].y+(h[c+1].y-h[c].y)*e},void 0!==h[c].z&&(h[c]=h[c].z+(h[c+1].z-h[c].z)*e);h.splice(h.length-1,1)}return h[0]},raise:function(){for(var e,t,i,n=this.points,r=[n[0]],s=n.length,e=1;s>e;e++)t=n[e],i=n[e-1],r[e]={x:(s-e)/s*t.x+e/s*i.x,y:(s-e)/s*t.y+e/s*i.y};return r[s]=n[s-1],new g(r)},derivative:function(e){var t,i,n=1-e,r=0,s=this.dpoints[0];2===this.order&&(s=[s[0],s[1],d],t=n,i=e),3===this.order&&(t=n*n,i=n*e*2,r=e*e);var o={x:t*s[0].x+i*s[1].x+r*s[2].x,y:t*s[0].y+i*s[1].y+r*s[2].y};return this._3d&&(o.z=t*s[0].z+i*s[1].z+r*s[2].z),o},inflections:function(){return p.inflections(this.points)},normal:function(e){return this._3d?this.__normal3(e):this.__normal2(e)},__normal2:function(e){var t=this.derivative(e),i=h(t.x*t.x+t.y*t.y);return{x:-t.y/i,y:t.x/i}},__normal3:function(e){var t=this.derivative(e),i=this.derivative(e+.01),n=h(t.x*t.x+t.y*t.y+t.z*t.z),r=h(i.x*i.x+i.y*i.y+i.z*i.z);t.x/=n,t.y/=n,t.z/=n,i.x/=r,i.y/=r,i.z/=r;var s={x:i.y*t.z-i.z*t.y,y:i.z*t.x-i.x*t.z,z:i.x*t.y-i.y*t.x},o=h(s.x*s.x+s.y*s.y+s.z*s.z);s.x/=o,s.y/=o,s.z/=o;var a=[s.x*s.x,s.x*s.y-s.z,s.x*s.z+s.y,s.x*s.y+s.z,s.y*s.y,s.y*s.z-s.x,s.x*s.z-s.y,s.y*s.z+s.x,s.z*s.z];return{x:a[0]*t.x+a[1]*t.y+a[2]*t.z,y:a[3]*t.x+a[4]*t.y+a[5]*t.z,z:a[6]*t.x+a[7]*t.y+a[8]*t.z}},hull:function(e){var t,i=this.points,n=[],r=[],s=0,o=0,a=0;for(r[s++]=i[0],r[s++]=i[1],r[s++]=i[2],3===this.order&&(r[s++]=i[3]);i.length>1;){for(n=[],o=0,a=i.length-1;a>o;o++)t=p.lerp(e,i[o],i[o+1]),r[s++]=t,n.push(t);i=n}return r},split:function(e,t){if(0===e&&t)return this.split(t).left;if(1===t)return this.split(e).right;var i=this.hull(e),n={left:new g(2===this.order?[i[0],i[3],i[5]]:[i[0],i[4],i[7],i[9]]),right:new g(2===this.order?[i[5],i[4],i[2]]:[i[9],i[8],i[6],i[3]]),span:i};return n.left._t1=p.map(0,0,1,this._t1,this._t2),n.left._t2=p.map(e,0,1,this._t1,this._t2),n.right._t1=p.map(e,0,1,this._t1,this._t2),n.right._t2=p.map(1,0,1,this._t1,this._t2),t?(t=p.map(t,e,1,0,1),n.right.split(t).left):n},extrema:function(){var e,t,i=this.dims,n={},r=[];return i.forEach(function(i){t=function(e){return e[i]},e=this.dpoints[0].map(t),n[i]=p.droots(e),3===this.order&&(e=this.dpoints[1].map(t),n[i]=n[i].concat(p.droots(e))),n[i]=n[i].filter(function(e){return e>=0&&1>=e}),r=r.concat(n[i].sort(p.numberSort))}.bind(this)),r=r.sort(p.numberSort).filter(function(e,t){return r.indexOf(e)===t}),n.values=r,n},bbox:function(){var e=this.extrema(),t={};return this.dims.forEach(function(i){t[i]=p.getminmax(this,i,e[i])}.bind(this)),t},overlaps:function(e){var t=this.bbox(),i=e.bbox();return p.bboxoverlap(t,i)},offset:function(e,t){if(void 0!==t){var i=this.get(e),n=this.normal(e),r={c:i,n:n,x:i.x+n.x*t,y:i.y+n.y*t};return this._3d&&(r.z=i.z+n.z*t),r}if(this._linear){var s=this.normal(0);return[new g(this.points.map(function(t){var i={x:t.x+e*s.x,y:t.y+e*s.y};return t.z&&n.z&&(i.z=t.z+e*s.z),i}))]}return this.reduce().map(function(t){return t.scale(e)})},simple:function(){if(3===this.order){var e=p.angle(this.points[0],this.points[3],this.points[1]),t=p.angle(this.points[0],this.points[3],this.points[2]);if(e>0&&0>t||0>e&&t>0)return!1}var i=this.normal(0),n=this.normal(1),s=i.x*n.x+i.y*n.y;return this._3d&&(s+=i.z*n.z),c/3>r(l(s))},reduce:function(){var e,t,i=0,n=0,s=.01,o=[],a=[],u=this.extrema().values;for(-1===u.indexOf(0)&&(u=[0].concat(u)),-1===u.indexOf(1)&&u.push(1),i=u[0],e=1;e<u.length;e++)n=u[e],t=this.split(i,n),t._t1=i,t._t2=n,o.push(t),i=n;return o.forEach(function(e){for(i=0,n=0;1>=n;)for(n=i+s;1+s>=n;n+=s)if(t=e.split(i,n),!t.simple()){if(n-=s,r(i-n)<s)return[];t=e.split(i,n),t._t1=p.map(i,0,1,e._t1,e._t2),t._t2=p.map(n,0,1,e._t1,e._t2),a.push(t),i=n;break}1>i&&(t=e.split(i,1),t._t1=p.map(i,0,1,e._t1,e._t2),t._t2=e._t2,a.push(t))}),a},scale:function(e){var t=this.order,i=!1;if("function"==typeof e&&(i=e),i&&2===t)return this.raise().scale(i);var n=this.clockwise,r=i?i(0):e,s=i?i(1):e,o=[this.offset(0,10),this.offset(1,10)],a=p.lli4(o[0],o[0].c,o[1],o[1].c);if(!a)throw new Error("cannot scale this curve. Try reducing it first.");var u=this.points,l=[];return[0,1].forEach(function(e){var i=l[e*t]=p.copy(u[e*t]);i.x+=(e?s:r)*o[e].n.x,i.y+=(e?s:r)*o[e].n.y}.bind(this)),i?([0,1].forEach(function(r){if(2!==this.order||!r){var s=u[r+1],o={x:s.x-a.x,y:s.y-a.y},c=i?i((r+1)/t):e;i&&!n&&(c=-c);var d=h(o.x*o.x+o.y*o.y);o.x/=d,o.y/=d,l[r+1]={x:s.x+c*o.x,y:s.y+c*o.y}}}.bind(this)),new g(l)):([0,1].forEach(function(e){if(2!==this.order||!e){var i=l[e*t],n=this.derivative(e),r={x:i.x+n.x,y:i.y+n.y};l[e+1]=p.lli4(i,r,a,u[e+1])}}.bind(this)),new g(l))},outline:function(e,t,i,n){function r(e,t,i,n,r){return function(s){var o=n/i,a=(n+r)/i,u=t-e;return p.map(s,0,1,e+o*u,e+a*u)}}t=void 0===t?e:t;var s,o=this.reduce(),a=o.length,u=[],l=[],h=0,c=this.length(),d=void 0!==i&&void 0!==n;o.forEach(function(s){b=s.length(),d?(u.push(s.scale(r(e,i,c,h,b))),l.push(s.scale(r(-t,-n,c,h,b)))):(u.push(s.scale(e)),l.push(s.scale(-t))),h+=b}),l=l.map(function(e){return s=e.points,s[3]?e.points=[s[3],s[2],s[1],s[0]]:e.points=[s[2],s[1],s[0]],e}).reverse();var g=u[0].points[0],m=u[a-1].points[u[a-1].points.length-1],_=l[a-1].points[l[a-1].points.length-1],x=l[0].points[0],y=p.makeline(_,g),v=p.makeline(m,x),w=[y].concat(u).concat([v]).concat(l),b=w.length;return new f(w)},outlineshapes:function(e,t,i){t=t||e;for(var n=this.outline(e,t).curves,r=[],s=1,o=n.length;o/2>s;s++){var a=p.makeshape(n[s],n[o-s],i);a.startcap.virtual=s>1,a.endcap.virtual=o/2-1>s,r.push(a)}return r},intersects:function(e,t){return e?e.p1&&e.p2?this.lineIntersects(e):(e instanceof g&&(e=e.reduce()),this.curveintersects(this.reduce(),e,t)):this.selfintersects(t)},lineIntersects:function(e){var t=s(e.p1.x,e.p2.x),i=s(e.p1.y,e.p2.y),n=o(e.p1.x,e.p2.x),r=o(e.p1.y,e.p2.y),a=this;return p.roots(this.points,e).filter(function(e){var s=a.get(e);return p.between(s.x,t,n)&&p.between(s.y,i,r)})},selfintersects:function(e){var t,i,n,r,s=this.reduce(),o=s.length-2,a=[];for(t=0;o>t;t++)n=s.slice(t,t+1),r=s.slice(t+2),i=this.curveintersects(n,r,e),a=a.concat(i);return a},curveintersects:function(e,t,i){var n=[];e.forEach(function(e){t.forEach(function(t){e.overlaps(t)&&n.push({left:e,right:t})})});var r=[];return n.forEach(function(e){var t=p.pairiteration(e.left,e.right,i);t.length>0&&(r=r.concat(t))}),r},arcs:function(e){e=e||.5;var t=[];return this._iterate(e,t)},_error:function(e,t,i,n){var s=(n-i)/4,o=this.get(i+s),a=this.get(n-s),u=p.dist(e,t),l=p.dist(e,o),h=p.dist(e,a);return r(l-u)+r(h-u)},_iterate:function(e,t){var i,n=0,r=1;do{i=0,r=1;var s,o,l,h,c,d=this.get(n),f=!1,g=!1,m=r,_=1,x=0;do{g=f,h=l,m=(n+r)/2,x++,s=this.get(m),o=this.get(r),l=p.getccenter(d,s,o),l.interval={start:n,end:r};if(f=e>=this._error(l,d,n,r),c=g&&!f,c||(_=r),f){if(r>=1){if(l.interval.end=_=1,h=l,r>1){var y={x:l.x+l.r*a(l.e),y:l.y+l.r*u(l.e)};l.e+=p.angle({x:l.x,y:l.y},y,this.get(1))}break}r+=(r-n)/2}else r=m}while(!c&&i++<100)if(i>=100)break;h=h?h:l,t.push(h),n=_}while(1>r)return t}},e.exports=g}()},function(e,t,i){"use strict";!function(){var t=Math.abs,n=Math.cos,r=Math.sin,s=Math.acos,o=Math.atan2,a=Math.sqrt,u=Math.pow,l=function(e){return 0>e?-u(-e,1/3):u(e,1/3)},h=Math.PI,c=2*h,d=h/2,p=Number.MAX_SAFE_INTEGER||9007199254740991,f=Number.MIN_SAFE_INTEGER||-9007199254740991,g={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(e,t){var i=t(e),n=i.x*i.x+i.y*i.y;return void 0!==i.z&&(n+=i.z*i.z),a(n)},between:function(e,t,i){return e>=t&&i>=e||g.approximately(e,t)||g.approximately(e,i)},approximately:function(e,i,n){return t(e-i)<=(n||1e-6)},length:function(e){var t,i,n=0,r=g.Tvalues.length;for(t=0;r>t;t++)i=.5*g.Tvalues[t]+.5,n+=g.Cvalues[t]*g.arcfn(i,e);return.5*n},map:function(e,t,i,n,r){return n+(e-t)/(i-t)*(r-n)},lerp:function(e,t,i){var n={x:t.x+e*(i.x-t.x),y:t.y+e*(i.y-t.y)};return t.z&&i.z&&(n.z=t.z+e*(i.z-t.z)),n},pointToString:function(e){var t=e.x+"/"+e.y;return void 0!==e.z&&(t+="/"+e.z),t},pointsToString:function(e){return"["+e.map(g.pointToString).join(", ")+"]"},copy:function(e){return JSON.parse(JSON.stringify(e))},angle:function(e,t,i){var n=t.x-e.x,r=t.y-e.y,s=i.x-e.x,a=i.y-e.y;return o(n*a-r*s,n*s+r*a)},round:function(e,t){var i=""+e,n=i.indexOf(".");return parseFloat(i.substring(0,n+1+t))},dist:function(e,t){var i=e.x-t.x,n=e.y-t.y;return a(i*i+n*n)},closest:function(e,t){var i,n,r=u(2,63);return e.forEach(function(e,s){n=g.dist(t,e),r>n&&(r=n,i=s)}),{mdist:r,mpos:i}},abcratio:function(e,i){if(2!==i&&3!==i)return!1;if(void 0===e)e=.5;else if(0===e||1===e)return e;var n=u(e,i)+u(1-e,i);return t((n-1)/n)},projectionratio:function(e,t){if(2!==t&&3!==t)return!1;if(void 0===e)e=.5;else if(0===e||1===e)return e;var i=u(1-e,t);return i/(u(e,t)+i)},lli8:function(e,t,i,n,r,s,o,a){var u=(e*n-t*i)*(r-o)-(e-i)*(r*a-s*o),l=(e*n-t*i)*(s-a)-(t-n)*(r*a-s*o),h=(e-i)*(s-a)-(t-n)*(r-o);return 0!=h&&{x:u/h,y:l/h}},lli4:function(e,t,i,n){var r=e.x,s=e.y,o=t.x,a=t.y,u=i.x,l=i.y,h=n.x,c=n.y;return g.lli8(r,s,o,a,u,l,h,c)},lli:function(e,t){return g.lli4(e,e.c,t,t.c)},makeline:function(e,t){var n=i(1),r=e.x,s=e.y,o=t.x,a=t.y,u=(o-r)/3,l=(a-s)/3;return new n(r,s,r+u,s+l,r+2*u,s+2*l,o,a)},findbbox:function(e){var t=p,i=p,n=f,r=f;return e.forEach(function(e){var s=e.bbox();t>s.x.min&&(t=s.x.min),i>s.y.min&&(i=s.y.min),n<s.x.max&&(n=s.x.max),r<s.y.max&&(r=s.y.max)}),{x:{min:t,mid:(t+n)/2,max:n,size:n-t},y:{min:i,mid:(i+r)/2,max:r,size:r-i}}},shapeintersections:function(e,t,i,n,r){if(!g.bboxoverlap(t,n))return[];var s=[],o=[e.startcap,e.forward,e.back,e.endcap],a=[i.startcap,i.forward,i.back,i.endcap];return o.forEach(function(t){t.virtual||a.forEach(function(n){if(!n.virtual){var o=t.intersects(n,r);o.length>0&&(o.c1=t,o.c2=n,o.s1=e,o.s2=i,s.push(o))}})}),s},makeshape:function(e,t,i){var n=t.points.length,r=e.points.length,s=g.makeline(t.points[n-1],e.points[0]),o=g.makeline(e.points[r-1],t.points[0]),a={startcap:s,forward:e,back:t,endcap:o,bbox:g.findbbox([s,e,t,o])},u=g;return a.intersections=function(e){return u.shapeintersections(a,a.bbox,e,e.bbox,i)},a},getminmax:function(e,t,i){if(!i)return{min:0,max:0};var n,r,s=p,o=f;-1===i.indexOf(0)&&(i=[0].concat(i)),-1===i.indexOf(1)&&i.push(1);for(var a=0,u=i.length;u>a;a++)n=i[a],r=e.get(n),r[t]<s&&(s=r[t]),r[t]>o&&(o=r[t]);return{min:s,mid:(s+o)/2,max:o,size:o-s}},align:function(e,t){var i=t.p1.x,s=t.p1.y,a=-o(t.p2.y-s,t.p2.x-i),u=function(e){return{x:(e.x-i)*n(a)-(e.y-s)*r(a),y:(e.x-i)*r(a)+(e.y-s)*n(a)}};return e.map(u)},roots:function(e,t){t=t||{p1:{x:0,y:0},p2:{x:1,y:0}};var i=e.length-1,r=g.align(e,t),o=function(e){return e>=0&&1>=e};if(2===i){var u=r[0].y,h=r[1].y,d=r[2].y,p=u-2*h+d;if(0!==p){var f=-a(h*h-u*d),m=-u+h,_=-(f+m)/p;return[_,-(-f+m)/p].filter(o)}return h!==d&&0===p?[(2*h-d)/2*(h-d)].filter(o):[]}var x=r[0].y,y=r[1].y,v=r[2].y,w=r[3].y,p=3*y-x-3*v+w,u=3*x-6*y+3*v,h=-3*x+3*y,d=x;if(g.approximately(p,0)){if(g.approximately(u,0))return g.approximately(h,0)?[]:[-d/h].filter(o);var b=a(h*h-4*u*d),S=2*u;return[(b-h)/S,(-h-b)/S].filter(o)}u/=p,h/=p,d/=p;var C,_,T,F,O,r=(3*h-u*u)/3,N=r/3,b=(2*u*u*u-9*u*h+27*d)/27,M=b/2,D=M*M+N*N*N;if(0>D){var E=-r/3,V=E*E*E,B=a(V),I=-b/(2*B),A=-1>I?-1:I>1?1:I,P=s(A),R=l(B),L=2*R;return T=L*n(P/3)-u/3,F=L*n((P+c)/3)-u/3,O=L*n((P+2*c)/3)-u/3,[T,F,O].filter(o)}if(0===D)return C=0>M?l(-M):-l(M),T=2*C-u/3,F=-C-u/3,[T,F].filter(o);var z=a(D);return C=l(-M+z),_=l(M+z),[C-_-u/3].filter(o)},droots:function(e){if(3===e.length){var t=e[0],i=e[1],n=e[2],r=t-2*i+n;if(0!==r){var s=-a(i*i-t*n),o=-t+i;return[-(s+o)/r,-(-s+o)/r]}return i!==n&&0===r?[(2*i-n)/(2*(i-n))]:[]}if(2===e.length){var t=e[0],i=e[1];return t!==i?[t/(t-i)]:[]}},inflections:function(e){if(e.length<4)return[];var t=g.align(e,{p1:e[0],p2:e.slice(-1)[0]}),i=t[2].x*t[1].y,n=t[3].x*t[1].y,r=t[1].x*t[2].y,s=t[3].x*t[2].y,o=18*(-3*i+2*n+3*r-s),a=18*(3*i-n-3*r),u=18*(r-i);if(g.approximately(o,0)){if(!g.approximately(a,0)){var l=-u/a;if(l>=0&&1>=l)return[l]}return[]}var h=a*a-4*o*u,c=Math.sqrt(h),s=2*o;return g.approximately(s,0)?[]:[(c-a)/s,-(a+c)/s].filter(function(e){return e>=0&&1>=e})},bboxoverlap:function(e,i){var n,r,s,o,a,u=["x","y"],l=u.length;for(n=0;l>n;n++)if(r=u[n],s=e[r].mid,o=i[r].mid,a=(e[r].size+i[r].size)/2,t(s-o)>=a)return!1;return!0},expandbox:function(e,t){t.x.min<e.x.min&&(e.x.min=t.x.min),t.y.min<e.y.min&&(e.y.min=t.y.min),t.z&&t.z.min<e.z.min&&(e.z.min=t.z.min),t.x.max>e.x.max&&(e.x.max=t.x.max),t.y.max>e.y.max&&(e.y.max=t.y.max),t.z&&t.z.max>e.z.max&&(e.z.max=t.z.max),e.x.mid=(e.x.min+e.x.max)/2,e.y.mid=(e.y.min+e.y.max)/2,e.z&&(e.z.mid=(e.z.min+e.z.max)/2),e.x.size=e.x.max-e.x.min,e.y.size=e.y.max-e.y.min,e.z&&(e.z.size=e.z.max-e.z.min)},pairiteration:function(e,t,i){var n=e.bbox(),r=t.bbox(),s=1e5,o=i||.5;if(n.x.size+n.y.size<o&&r.x.size+r.y.size<o)return[(s*(e._t1+e._t2)/2|0)/s+"/"+(s*(t._t1+t._t2)/2|0)/s];var a=e.split(.5),u=t.split(.5),l=[{left:a.left,right:u.left},{left:a.left,right:u.right},{left:a.right,right:u.right},{left:a.right,right:u.left}];l=l.filter(function(e){return g.bboxoverlap(e.left.bbox(),e.right.bbox())});var h=[];return 0===l.length?h:(l.forEach(function(e){h=h.concat(g.pairiteration(e.left,e.right,o))}),h=h.filter(function(e,t){return h.indexOf(e)===t}))},getccenter:function(e,t,i){var s,a=t.x-e.x,u=t.y-e.y,l=i.x-t.x,h=i.y-t.y,p=a*n(d)-u*r(d),f=a*r(d)+u*n(d),m=l*n(d)-h*r(d),_=l*r(d)+h*n(d),x=(e.x+t.x)/2,y=(e.y+t.y)/2,v=(t.x+i.x)/2,w=(t.y+i.y)/2,b=x+p,S=y+f,C=v+m,T=w+_,F=g.lli8(x,y,b,S,v,w,C,T),O=g.dist(F,e),N=o(e.y-F.y,e.x-F.x),M=o(t.y-F.y,t.x-F.x),D=o(i.y-F.y,i.x-F.x);return D>N?((N>M||M>D)&&(N+=c),N>D&&(s=D,D=N,N=s)):M>D&&N>M?(s=D,D=N,N=s):D+=c,F.s=N,F.e=D,F.r=O,F},numberSort:function(e,t){return e-t}};e.exports=g}()},function(e,t,i){"use strict";!function(){var t=i(2),n=function(e){this.curves=[],this._3d=!1,e&&(this.curves=e,this._3d=this.curves[0]._3d)};n.prototype={valueOf:function(){return this.toString()},toString:function(){return"["+this.curves.map(function(e){return t.pointsToString(e.points)}).join(", ")+"]"},addCurve:function(e){this.curves.push(e),this._3d=this._3d||e._3d},length:function(){return this.curves.map(function(e){return e.length()}).reduce(function(e,t){return e+t})},curve:function(e){return this.curves[e]},bbox:function e(){for(var i=this.curves,e=i[0].bbox(),n=1;n<i.length;n++)t.expandbox(e,i[n].bbox());return e},offset:function e(t){var e=[];return this.curves.forEach(function(i){e=e.concat(i.offset(t))}),new n(e)}},e.exports=n}()},function(e,t,i){"use strict";function n(e,t,i){if("Z"!==t){if("M"===t)return void(o={x:i[0],y:i[1]});var n=[!1,o.x,o.y].concat(i),r=e.bind.apply(e,n),s=new r,a=i.slice(-2);return o={x:a[0],y:a[1]},s}}function r(e,t){for(var i,r,o,a=s(t).split(" "),u=new RegExp("[MLCQZ]",""),l=[],h={C:6,Q:4,L:2,M:2};a.length;)i=a.splice(0,1)[0],u.test(i)&&(o=a.splice(0,h[i]).map(parseFloat),(r=n(e,i,o))&&l.push(r));return new e.PolyBezier(l)}var s=i(5),o={x:!1,y:!1};e.exports=r},function(e,t){"use strict";function i(e){e=e.replace(/,/g," ").replace(/-/g," - ").replace(/-\s+/g,"-").replace(/([a-zA-Z])/g," $1 ");var t,i,n,r,s,o,a=e.replace(/([a-zA-Z])\s?/g,"|$1").split("|"),u=a.length,l=[],h=0,c=0,d=0,p=0,f=0,g=0,m=0,_=0,x="";for(t=1;u>t;t++)if(i=a[t],n=i.substring(0,1),r=n.toLowerCase(),l=i.replace(n,"").trim().split(" "),l=l.filter(function(e){return""!==e}).map(parseFloat),s=l.length,"m"===r){if(x+="M ","m"===n?(d+=l[0],p+=l[1]):(d=l[0],p=l[1]),h=d,c=p,x+=d+" "+p+" ",s>2)for(o=0;s>o;o+=2)"m"===n?(d+=l[o],p+=l[o+1]):(d=l[o],p=l[o+1]),x+=["L",d,p,""].join(" ")}else if("l"===r)for(o=0;s>o;o+=2)"l"===n?(d+=l[o],p+=l[o+1]):(d=l[o],p=l[o+1]),x+=["L",d,p,""].join(" ");else if("h"===r)for(o=0;s>o;o++)"h"===n?d+=l[o]:d=l[o],x+=["L",d,p,""].join(" ");else if("v"===r)for(o=0;s>o;o++)"v"===n?p+=l[o]:p=l[o],x+=["L",d,p,""].join(" ");else if("q"===r)for(o=0;s>o;o+=4)"q"===n?(f=d+l[o],g=p+l[o+1],d+=l[o+2],p+=l[o+3]):(f=l[o],g=l[o+1],d=l[o+2],p=l[o+3]),x+=["Q",f,g,d,p,""].join(" ");else if("t"===r)for(o=0;s>o;o+=2)f=d+(d-f),g=p+(p-g),"t"===n?(d+=l[o],p+=l[o+1]):(d=l[o],p=l[o+1]),x+=["Q",f,g,d,p,""].join(" ");else if("c"===r)for(o=0;s>o;o+=6)"c"===n?(f=d+l[o],g=p+l[o+1],m=d+l[o+2],_=p+l[o+3],d+=l[o+4],p+=l[o+5]):(f=l[o],g=l[o+1],m=l[o+2],_=l[o+3],d=l[o+4],p=l[o+5]),x+=["C",f,g,m,_,d,p,""].join(" ");else if("s"===r)for(o=0;s>o;o+=4)f=d+(d-m),g=p+(p-_),"s"===n?(m=d+l[o],_=p+l[o+1],d+=l[o+2],p+=l[o+3]):(m=l[o],_=l[o+1],d=l[o+2],p=l[o+3]),x+=["C",f,g,m,_,d,p,""].join(" ");else"z"===r&&(x+="Z ",d=h,p=c);return x.trim()}e.exports=i}]);define("bezier",["bezier/bezier"],function(e){return e}),define("bezier/bezier",function(){}),define("x_ite/Browser/Text/PolygonText",["x_ite/Fields","x_ite/Browser/Core/PrimitiveQuality","x_ite/Browser/Text/X3DTextGeometry","x_ite/Components/Rendering/X3DGeometryNode","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Triangle3","bezier"],function(e,t,i,n,r,s,o,a){"use strict";function u(e,t){i.call(this,e,t),e.transparent_=!1,this.texCoordArray=n.createArray()}var l=new r(0,0,0),h=new r(0,0,0),c=[],d=[],p=[];return u.prototype=Object.assign(Object.create(i.prototype),{constructor:u,getMatrix:function(){return s.Identity},build:function(){var e=this.getFontStyle(),t=e.getFont();if(t){var i=this.getText(),n=this.getGlyphs(),r=this.getMinorAlignment(),s=this.getTranslations(),o=this.getCharSpacings(),a=e.getScale(),u=e.spacing_.getValue(),c=i.origin_.getValue(),d=a/t.unitsPerEm,p=this.getBrowser().getBrowserOptions().getPrimitiveQuality(),f=this.texCoordArray,g=i.getNormals(),m=i.getVertices();if(f.length=0,i.getMultiTexCoords().push(f),this.getBBox().getExtents(l,h),i.getMin().assign(l),i.getMax().assign(h),e.horizontal_.getValue())for(var _=0,x=n.length;_<x;++_)for(var y=n[_],v=o[_],w=s[_],b=0,S=0,C=y.length;S<C;++S){for(var T=y[S],F=this.getGlyphGeometry(T,p),O=0,N=F.length;O<N;++O){var M=F[O].x*a+r.x+w.x+b+S*v,D=F[O].y*a+r.y+w.y;f.push((M-c.x)/u,(D-c.y)/u,0,1),g.push(0,0,1),m.push(M,D,0,1)}var E=0;S+1<y.length&&(E=t.getKerningValue(T,y[S+1])),b+=(T.advanceWidth+E)*d}else for(var V=e.leftToRight_.getValue(),B=e.topToBottom_.getValue(),I=V?0:i.string_.length-1,A=V?i.string_.length:-1,P=V?1:-1,_=I,R=0;_!==A;_+=P)for(var y=n[_],L=y.length,z=B?0:L-1,k=B?L:-1,X=B?1:-1,S=z;S!==k;S+=X,++R)for(var w=s[R],F=this.getGlyphGeometry(y[S],p),O=0,N=F.length;O<N;++O){var M=F[O].x*a+r.x+w.x,D=F[O].y*a+r.y+w.y;f.push((M-c.x)/u,(D-c.y)/u,0,1),g.push(0,0,1),m.push(M,D,0,1)}}},getGlyphExtents:function(e,t,i,n){var r=e.extents[t];if(r)return i.assign(r.min),void n.assign(r.max);var s=this.getGlyphGeometry(e,t);if(s.length){var o=s[0];i.assign(o),n.assign(o);for(var a=1,u=s.length;a<u;++a){var o=s[a];i.min(o),n.max(o)}}else i.set(0,0,0),n.set(0,0,0);var r=e.extents[t]={};r.min=i.copy(),r.max=n.copy()},getGlyphGeometry:function(e,t){var i=this.getFontStyle(),n=i.getFont(),r=this.getBrowser().getFontGeometryCache(),s=r[n.fontName];s||(r[n.fontName]=s=[[],[],[]]);var o=s[t][e.index];return o?o:(o=s[t][e.index]=[],this.createGlyphGeometry(e,o,t),o)},createGlyphGeometry:function(e,t,i){var n=this.getFontStyle(),s=n.getFont(),a=e.components,u=this.getBezierDimension(i);if(c.length=0,d.length=0,p.length=0,e.isComposite)for(var l=0,h=a.length;l<h;++l){var f=a[l];c.push(s.glyphs.get(f.glyphIndex).getPath(f.dx/s.unitsPerEm,f.dy/-s.unitsPerEm,1))}else c.push(e.getPath(0,0,1));for(var g=0,m=0,_=0,x=c.length;_<x;++_)for(var y=c[_].commands,v=0,h=y.length;v<h;++v){var w=y[v];switch(w.type){case"M":case"Z":d.length>2&&(d[0].x===d[d.length-1].x&&d[0].y===d[d.length-1].y&&d.pop(),p.push(d)),d=[],"M"===w.type&&d.push(new r(w.x,-w.y,0));break;case"L":d.push(new r(w.x,-w.y,0));break;case"C":for(var b=new Bezier(g,-m,w.x1,-w.y1,w.x2,-w.y2,w.x,-w.y),S=b.getLUT(u),C=1,T=S.length;C<T;++C)d.push(new r(S[C].x,S[C].y,0));break;case"Q":for(var b=new Bezier(g,-m,w.x1,-w.y1,w.x,-w.y),S=b.getLUT(u),C=1,T=S.length;C<T;++C)d.push(new r(S[C].x,S[C].y,0));break;default:continue}g=w.x,m=w.y}p=p.map(function(e){return o.getPolygonNormal(e,new r(0,0,0)).dot(r.zAxis)>0?e:e.reverse()}),p.push(t),o.triangulatePolygon.apply(o,p)},getBezierDimension:function(e){switch(e){case t.LOW:return 3;case t.HIGH:return 7;default:return 5}},display:function(e,t){},transformLine:function(e){},transformMatrix:function(e){}}),u}),define("x_ite/Components/Text/FontStyle",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Text/X3DFontStyleNode","x_ite/Browser/Text/PolygonText","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(s.FontStyle),this.size_.setUnit("length")}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"language",new e.SFString),new t(s.inputOutput,"family",new e.MFString("SERIF")),new t(s.inputOutput,"style",new e.SFString("PLAIN")),new t(s.inputOutput,"size",new e.SFFloat(1)),new t(s.inputOutput,"spacing",new e.SFFloat(1)),new t(s.inputOutput,"horizontal",new e.SFBool(!0)),new t(s.inputOutput,"leftToRight",new e.SFBool(!0)),new t(s.inputOutput,"topToBottom",new e.SFBool(!0)),new t(s.inputOutput,"justify",new e.MFString("BEGIN"))]),getTypeName:function(){return"FontStyle"},
getComponentName:function(){return"Text"},getContainerField:function(){return"fontStyle"},getTextGeometry:function(e){return new r(e,this)},getScale:function(){return this.size_.getValue()}}),o}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("lib/opentype.js/dist/opentype",[],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.opentype=e()}}(function(){return function e(t,i,n){function r(o,a){if(!i[o]){if(!t[o]){var u="function"==typeof require&&require;if(!a&&u)return u(o,!0);if(s)return s(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var h=i[o]={exports:{}};t[o][0].call(h.exports,function(e){var i=t[o][1][e];return r(i?i:e)},h,h.exports,e,t,i,n)}return i[o].exports}for(var s="function"==typeof require&&require,o=0;o<n.length;o++)r(n[o]);return r}({1:[function(e,t,i){i.argument=function(e,t){if(!e)throw new Error(t)},i.assert=i.argument},{}],2:[function(e,t,i){function n(e,t,i,n,r){e.beginPath(),e.moveTo(t,i),e.lineTo(n,r),e.stroke()}i.line=n},{}],3:[function(e,t,i){function n(e){this.font=e}function r(e){this.cmap=e}function s(e,t){this.encoding=e,this.charset=t}function o(e){var t;switch(e.version){case 1:this.names=i.standardNames.slice();break;case 2:for(this.names=new Array(e.numberOfGlyphs),t=0;t<e.numberOfGlyphs;t++)e.glyphNameIndex[t]<i.standardNames.length?this.names[t]=i.standardNames[e.glyphNameIndex[t]]:this.names[t]=e.names[e.glyphNameIndex[t]-i.standardNames.length];break;case 2.5:for(this.names=new Array(e.numberOfGlyphs),t=0;t<e.numberOfGlyphs;t++)this.names[t]=i.standardNames[t+e.glyphNameIndex[t]];break;case 3:this.names=[]}}function a(e){for(var t,i=e.tables.cmap.glyphIndexMap,n=Object.keys(i),r=0;r<n.length;r+=1){var s=n[r],o=i[s];t=e.glyphs.get(o),t.addUnicode(parseInt(s))}for(r=0;r<e.glyphs.length;r+=1)t=e.glyphs.get(r),e.cffEncoding?t.name=e.cffEncoding.charset[r]:t.name=e.glyphNames.glyphIndexToName(r)}var u=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],l=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],h=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],c=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];n.prototype.charToGlyphIndex=function(e){var t=e.charCodeAt(0),i=this.font.glyphs;if(!i)return null;for(var n=0;n<i.length;n+=1)for(var r=i.get(n),s=0;s<r.unicodes.length;s+=1)if(r.unicodes[s]===t)return n},r.prototype.charToGlyphIndex=function(e){return this.cmap.glyphIndexMap[e.charCodeAt(0)]||0},s.prototype.charToGlyphIndex=function(e){var t=e.charCodeAt(0),i=this.encoding[t];return this.charset.indexOf(i)},o.prototype.nameToGlyphIndex=function(e){return this.names.indexOf(e)},o.prototype.glyphIndexToName=function(e){return this.names[e]},i.cffStandardStrings=u,i.cffStandardEncoding=l,i.cffExpertEncoding=h,i.standardNames=c,i.DefaultEncoding=n,i.CmapEncoding=r,i.CffEncoding=s,i.GlyphNames=o,i.addGlyphNames=a},{}],4:[function(e,t,i){function n(e){e=e||{},this.familyName=e.familyName||" ",this.styleName=e.styleName||" ",this.designer=e.designer||" ",this.designerURL=e.designerURL||" ",this.manufacturer=e.manufacturer||" ",this.manufacturerURL=e.manufacturerURL||" ",this.license=e.license||" ",this.licenseURL=e.licenseURL||" ",this.version=e.version||"Version 0.1",this.description=e.description||" ",this.copyright=e.copyright||" ",this.trademark=e.trademark||" ",this.unitsPerEm=e.unitsPerEm||1e3,this.ascender=e.ascender,this.descender=e.descender,this.supported=!0,this.glyphs=new a.GlyphSet(this,e.glyphs||[]),this.encoding=new o.DefaultEncoding(this),this.tables={}}var r=e("./path"),s=e("./tables/sfnt"),o=e("./encoding"),a=e("./glyphset");n.prototype.hasChar=function(e){return null!==this.encoding.charToGlyphIndex(e)},n.prototype.charToGlyphIndex=function(e){return this.encoding.charToGlyphIndex(e)},n.prototype.charToGlyph=function(e){var t=this.charToGlyphIndex(e),i=this.glyphs.get(t);return i||(i=this.glyphs.get(0)),i},n.prototype.stringToGlyphs=function(e){for(var t=[],i=0;i<e.length;i+=1){var n=e[i];t.push(this.charToGlyph(n))}return t},n.prototype.nameToGlyphIndex=function(e){return this.glyphNames.nameToGlyphIndex(e)},n.prototype.nameToGlyph=function(e){var t=this.nametoGlyphIndex(e),i=this.glyphs.get(t);return i||(i=this.glyphs.get(0)),i},n.prototype.glyphIndexToName=function(e){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(e):""},n.prototype.getKerningValue=function(e,t){e=e.index||e,t=t.index||t;var i=this.getGposKerningValue;return i?i(e,t):this.kerningPairs[e+","+t]||0},n.prototype.forEachGlyph=function(e,t,i,n,r,s){t=void 0!==t?t:0,i=void 0!==i?i:0,n=void 0!==n?n:72,r=r||{};for(var o=void 0===r.kerning||r.kerning,a=1/this.unitsPerEm*n,u=this.stringToGlyphs(e),l=0;l<u.length;l+=1){var h=u[l];if(s(h,t,i,n,r),h.advanceWidth&&(t+=h.advanceWidth*a),o&&l<u.length-1){t+=this.getKerningValue(h,u[l+1])*a}}},n.prototype.getPath=function(e,t,i,n,s){var o=new r.Path;return this.forEachGlyph(e,t,i,n,s,function(e,t,i,n){var r=e.getPath(t,i,n);o.extend(r)}),o},n.prototype.draw=function(e,t,i,n,r,s){this.getPath(t,i,n,r,s).draw(e)},n.prototype.drawPoints=function(e,t,i,n,r,s){this.forEachGlyph(t,i,n,r,s,function(t,i,n,r){t.drawPoints(e,i,n,r)})},n.prototype.drawMetrics=function(e,t,i,n,r,s){this.forEachGlyph(t,i,n,r,s,function(t,i,n,r){t.drawMetrics(e,i,n,r)})},n.prototype.validate=function(){function e(e,t){e||i.push(t)}function t(t){e(n[t]&&n[t].trim().length>0,"No "+t+" specified.")}var i=[],n=this;t("familyName"),t("weightName"),t("manufacturer"),t("copyright"),t("version"),e(this.unitsPerEm>0,"No unitsPerEm specified.")},n.prototype.toTables=function(){return s.fontToTable(this)},n.prototype.toBuffer=function(){for(var e=this.toTables(),t=e.encode(),i=new ArrayBuffer(t.length),n=new Uint8Array(i),r=0;r<t.length;r++)n[r]=t[r];return i},n.prototype.download=function(){var e=this.familyName.replace(/\s/g,"")+"-"+this.styleName+".otf",t=this.toBuffer();window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,window.requestFileSystem(window.TEMPORARY,t.byteLength,function(i){i.root.getFile(e,{create:!0},function(e){e.createWriter(function(i){var n=new DataView(t),r=new Blob([n],{type:"font/opentype"});i.write(r),i.addEventListener("writeend",function(){location.href=e.toURL()},!1)})})},function(e){throw e})},i.Font=n},{"./encoding":3,"./glyphset":6,"./path":9,"./tables/sfnt":24}],5:[function(e,t,i){function n(e,t){var i=t||{commands:[]};return{configurable:!0,get:function(){return"function"==typeof i&&(i=i()),i},set:function(e){i=e}}}function r(e){this.bindConstructorValues(e)}var s=e("./check"),o=e("./draw"),a=e("./path");r.prototype.bindConstructorValues=function(e){this.index=e.index||0,this.name=e.name||null,this.unicode=e.unicode||void 0,this.unicodes=e.unicodes||void 0!==e.unicode?[e.unicode]:[],e.xMin&&(this.xMin=e.xMin),e.yMin&&(this.yMin=e.yMin),e.xMax&&(this.xMax=e.xMax),e.yMax&&(this.yMax=e.yMax),e.advanceWidth&&(this.advanceWidth=e.advanceWidth),Object.defineProperty(this,"path",n(this,e.path))},r.prototype.addUnicode=function(e){0===this.unicodes.length&&(this.unicode=e),this.unicodes.push(e)},r.prototype.getPath=function(e,t,i){e=void 0!==e?e:0,t=void 0!==t?t:0,i=void 0!==i?i:72;for(var n=1/this.path.unitsPerEm*i,r=new a.Path,s=this.path.commands,o=0;o<s.length;o+=1){var u=s[o];"M"===u.type?r.moveTo(e+u.x*n,t+-u.y*n):"L"===u.type?r.lineTo(e+u.x*n,t+-u.y*n):"Q"===u.type?r.quadraticCurveTo(e+u.x1*n,t+-u.y1*n,e+u.x*n,t+-u.y*n):"C"===u.type?r.curveTo(e+u.x1*n,t+-u.y1*n,e+u.x2*n,t+-u.y2*n,e+u.x*n,t+-u.y*n):"Z"===u.type&&r.closePath()}return r},r.prototype.getContours=function(){if(void 0===this.points)return[];for(var e=[],t=[],i=0;i<this.points.length;i+=1){var n=this.points[i];t.push(n),n.lastPointOfContour&&(e.push(t),t=[])}return s.argument(0===t.length,"There are still points left in the current contour."),e},r.prototype.getMetrics=function(){for(var e=this.path.commands,t=[],i=[],n=0;n<e.length;n+=1){var r=e[n];"Z"!==r.type&&(t.push(r.x),i.push(r.y)),"Q"!==r.type&&"C"!==r.type||(t.push(r.x1),i.push(r.y1)),"C"===r.type&&(t.push(r.x2),i.push(r.y2))}var s={xMin:Math.min.apply(null,t),yMin:Math.min.apply(null,i),xMax:Math.max.apply(null,t),yMax:Math.max.apply(null,i),leftSideBearing:0};return s.rightSideBearing=this.advanceWidth-s.leftSideBearing-(s.xMax-s.xMin),s},r.prototype.draw=function(e,t,i,n){this.getPath(t,i,n).draw(e)},r.prototype.drawPoints=function(e,t,i,n){function r(t,i,n,r){var s=2*Math.PI;e.beginPath();for(var o=0;o<t.length;o+=1)e.moveTo(i+t[o].x*r,n+t[o].y*r),e.arc(i+t[o].x*r,n+t[o].y*r,2,0,s,!1);e.closePath(),e.fill()}t=void 0!==t?t:0,i=void 0!==i?i:0,n=void 0!==n?n:24;for(var s=1/this.path.unitsPerEm*n,o=[],a=[],u=this.path,l=0;l<u.commands.length;l+=1){var h=u.commands[l];void 0!==h.x&&o.push({x:h.x,y:-h.y}),void 0!==h.x1&&a.push({x:h.x1,y:-h.y1}),void 0!==h.x2&&a.push({x:h.x2,y:-h.y2})}e.fillStyle="blue",r(o,t,i,s),e.fillStyle="red",r(a,t,i,s)},r.prototype.drawMetrics=function(e,t,i,n){var r;t=void 0!==t?t:0,i=void 0!==i?i:0,n=void 0!==n?n:24,r=1/this.path.unitsPerEm*n,e.lineWidth=1,e.strokeStyle="black",o.line(e,t,-1e4,t,1e4),o.line(e,-1e4,i,1e4,i);var s=this.xMin||0,a=this.yMin||0,u=this.xMax||0,l=this.yMax||0,h=this.advanceWidth||0;e.strokeStyle="blue",o.line(e,t+s*r,-1e4,t+s*r,1e4),o.line(e,t+u*r,-1e4,t+u*r,1e4),o.line(e,-1e4,i+-a*r,1e4,i+-a*r),o.line(e,-1e4,i+-l*r,1e4,i+-l*r),e.strokeStyle="green",o.line(e,t+h*r,-1e4,t+h*r,1e4)},i.Glyph=r},{"./check":1,"./draw":2,"./path":9}],6:[function(e,t,i){function n(e,t){if(this.font=e,this.glyphs={},Array.isArray(t))for(var i=0;i<t.length;i++)this.glyphs[i]=t[i];this.length=t&&t.length||0}function r(e,t){return new a.Glyph({index:t,font:e})}function s(e,t,i,n,r,s){return function(){var o=new a.Glyph({index:t,font:e});return o.path=function(){i(o,n,r);var t=s(e.glyphs,o);return t.unitsPerEm=e.unitsPerEm,t},o}}function o(e,t,i,n){return function(){var r=new a.Glyph({index:t,font:e});return r.path=function(){var t=i(e,r,n);return t.unitsPerEm=e.unitsPerEm,t},r}}var a=e("./glyph");n.prototype.get=function(e){return"function"==typeof this.glyphs[e]&&(this.glyphs[e]=this.glyphs[e]()),this.glyphs[e]},n.prototype.push=function(e,t){this.glyphs[e]=t,this.length++},i.GlyphSet=n,i.glyphLoader=r,i.ttfGlyphLoader=s,i.cffGlyphLoader=o},{"./glyph":5}],7:[function(e,t,i){function n(e){for(var t=new ArrayBuffer(e.length),i=new Uint8Array(t),n=0;n<e.length;n+=1)i[n]=e[n];return t}function r(t,i){e("fs").readFile(t,function(e,t){if(e)return i(e.message);i(null,n(t))})}function s(e,t){var i=new XMLHttpRequest;i.open("get",e,!0),i.responseType="arraybuffer",i.onload=function(){return 200!==i.status?t("Font could not be loaded: "+i.statusText):t(null,i.response)},i.onerror=function(){return t("Font could not be loaded: error")},i.send()}function o(e){var t,i,n,r,s,o,a,u=new h.Font,c=new DataView(e,0),p=d.getFixed(c,0);if(1===p)u.outlinesFormat="truetype";else{if("OTTO"!==(p=d.getTag(c,0)))throw new Error("Unsupported OpenType version "+p);u.outlinesFormat="cff"}for(var O=d.getUShort(c,4),N=12,M=0;M<O;M+=1){var D=d.getTag(c,N),E=d.getULong(c,N+8);switch(D){case"cmap":u.tables.cmap=f.parse(c,E),u.encoding=new l.CmapEncoding(u.tables.cmap);break;case"head":u.tables.head=x.parse(c,E),u.unitsPerEm=u.tables.head.unitsPerEm,t=u.tables.head.indexToLocFormat;break;case"hhea":u.tables.hhea=y.parse(c,E),u.ascender=u.tables.hhea.ascender,u.descender=u.tables.hhea.descender,u.numberOfHMetrics=u.tables.hhea.numberOfHMetrics;break;case"hmtx":i=E;break;case"maxp":u.tables.maxp=S.parse(c,E),u.numGlyphs=u.tables.maxp.numGlyphs;break;case"name":u.tables.name=C.parse(c,E),u.familyName=u.tables.name.fontFamily,u.styleName=u.tables.name.fontSubfamily;break;case"OS/2":u.tables.os2=T.parse(c,E);break;case"post":u.tables.post=F.parse(c,E),u.glyphNames=new l.GlyphNames(u.tables.post);break;case"glyf":n=E;break;case"loca":r=E;break;case"CFF ":s=E;break;case"kern":o=E;break;case"GPOS":a=E}N+=16}if(n&&r){var V=0===t,B=b.parse(c,r,u.numGlyphs,V);u.glyphs=m.parse(c,n,B,u),v.parse(c,i,u.numberOfHMetrics,u.numGlyphs,u.glyphs),l.addGlyphNames(u)}else{if(!s)throw new Error("Font doesn't contain TrueType or CFF outlines.");g.parse(c,s,u),l.addGlyphNames(u)}return u.kerningPairs=o?w.parse(c,o):{},a&&_.parse(c,a,u),u}function a(e,t){("undefined"==typeof window?r:s)(e,function(e,i){return e?t(e):t(null,o(i))})}function u(t){return o(n(e("fs").readFileSync(t)))}var l=e("./encoding"),h=e("./font"),c=e("./glyph"),d=e("./parse"),p=e("./path"),f=e("./tables/cmap"),g=e("./tables/cff"),m=e("./tables/glyf"),_=e("./tables/gpos"),x=e("./tables/head"),y=e("./tables/hhea"),v=e("./tables/hmtx"),w=e("./tables/kern"),b=e("./tables/loca"),S=e("./tables/maxp"),C=e("./tables/name"),T=e("./tables/os2"),F=e("./tables/post");i._parse=d,i.Font=h.Font,i.Glyph=c.Glyph,i.Path=p.Path,i.parse=o,i.load=a,i.loadSync=u},{"./encoding":3,"./font":4,"./glyph":5,"./parse":8,"./path":9,"./tables/cff":11,"./tables/cmap":12,"./tables/glyf":13,"./tables/gpos":14,"./tables/head":15,"./tables/hhea":16,"./tables/hmtx":17,"./tables/kern":18,"./tables/loca":19,"./tables/maxp":20,"./tables/name":21,"./tables/os2":22,"./tables/post":23,fs:void 0}],8:[function(e,t,i){function n(e,t){this.data=e,this.offset=t,this.relativeOffset=0}i.getByte=function(e,t){return e.getUint8(t)},i.getCard8=i.getByte,i.getUShort=function(e,t){return e.getUint16(t,!1)},i.getCard16=i.getUShort,i.getShort=function(e,t){return e.getInt16(t,!1)},i.getULong=function(e,t){return e.getUint32(t,!1)},i.getFixed=function(e,t){return e.getInt16(t,!1)+e.getUint16(t+2,!1)/65535},i.getTag=function(e,t){for(var i="",n=t;n<t+4;n+=1)i+=String.fromCharCode(e.getInt8(n));return i},i.getOffset=function(e,t,i){for(var n=0,r=0;r<i;r+=1)n<<=8,n+=e.getUint8(t+r);return n},i.getBytes=function(e,t,i){for(var n=[],r=t;r<i;r+=1)n.push(e.getUint8(r));return n},i.bytesToString=function(e){for(var t="",i=0;i<e.length;i+=1)t+=String.fromCharCode(e[i]);return t};var r={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};n.prototype.parseByte=function(){var e=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},n.prototype.parseChar=function(){var e=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},n.prototype.parseCard8=n.prototype.parseByte,n.prototype.parseUShort=function(){var e=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},n.prototype.parseCard16=n.prototype.parseUShort,n.prototype.parseSID=n.prototype.parseUShort,n.prototype.parseOffset16=n.prototype.parseUShort,n.prototype.parseShort=function(){var e=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},n.prototype.parseF2Dot14=function(){var e=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,e},n.prototype.parseULong=function(){var e=i.getULong(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},n.prototype.parseFixed=function(){var e=i.getFixed(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},n.prototype.parseOffset16List=n.prototype.parseUShortList=function(e){for(var t=new Array(e),n=this.data,r=this.offset+this.relativeOffset,s=0;s<e;s++)t[s]=i.getUShort(n,r),r+=2;return this.relativeOffset+=2*e,t},n.prototype.parseString=function(e){var t=this.data,i=this.offset+this.relativeOffset,n="";this.relativeOffset+=e;for(var r=0;r<e;r++)n+=String.fromCharCode(t.getUint8(i+r));return n},n.prototype.parseTag=function(){return this.parseString(4)},n.prototype.parseLongDateTime=function(){var e=i.getULong(this.data,this.offset+this.relativeOffset+4);return this.relativeOffset+=8,e},n.prototype.parseFixed=function(){var e=i.getULong(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e/65536},n.prototype.parseVersion=function(){var e=i.getUShort(this.data,this.offset+this.relativeOffset),t=i.getUShort(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,e+t/4096/10},n.prototype.skip=function(e,t){void 0===t&&(t=1),this.relativeOffset+=r[e]*t},i.Parser=n},{}],9:[function(e,t,i){function n(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}n.prototype.moveTo=function(e,t){this.commands.push({type:"M",x:e,y:t})},n.prototype.lineTo=function(e,t){this.commands.push({type:"L",x:e,y:t})},n.prototype.curveTo=n.prototype.bezierCurveTo=function(e,t,i,n,r,s){this.commands.push({type:"C",x1:e,y1:t,x2:i,y2:n,x:r,y:s})},n.prototype.quadTo=n.prototype.quadraticCurveTo=function(e,t,i,n){this.commands.push({type:"Q",x1:e,y1:t,x:i,y:n})},n.prototype.close=n.prototype.closePath=function(){this.commands.push({type:"Z"})},n.prototype.extend=function(e){e.commands&&(e=e.commands),Array.prototype.push.apply(this.commands,e)},n.prototype.draw=function(e){e.beginPath();for(var t=0;t<this.commands.length;t+=1){var i=this.commands[t];"M"===i.type?e.moveTo(i.x,i.y):"L"===i.type?e.lineTo(i.x,i.y):"C"===i.type?e.bezierCurveTo(i.x1,i.y1,i.x2,i.y2,i.x,i.y):"Q"===i.type?e.quadraticCurveTo(i.x1,i.y1,i.x,i.y):"Z"===i.type&&e.closePath()}this.fill&&(e.fillStyle=this.fill,e.fill()),this.stroke&&(e.strokeStyle=this.stroke,e.lineWidth=this.strokeWidth,e.stroke())},n.prototype.toPathData=function(e){function t(t){return Math.round(t)===t?""+Math.round(t):t.toFixed(e)}function i(){for(var e="",i=0;i<arguments.length;i+=1){var n=arguments[i];n>=0&&i>0&&(e+=" "),e+=t(n)}return e}e=void 0!==e?e:2;for(var n="",r=0;r<this.commands.length;r+=1){var s=this.commands[r];"M"===s.type?n+="M"+i(s.x,s.y):"L"===s.type?n+="L"+i(s.x,s.y):"C"===s.type?n+="C"+i(s.x1,s.y1,s.x2,s.y2,s.x,s.y):"Q"===s.type?n+="Q"+i(s.x1,s.y1,s.x,s.y):"Z"===s.type&&(n+="Z")}return n},n.prototype.toSVG=function(e){var t='<path d="';return t+=this.toPathData(e),t+='"',this.fill&"black"!==this.fill&&(t+=null===this.fill?' fill="none"':' fill="'+this.fill+'"'),this.stroke&&(t+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),t+="/>"},i.Path=n},{}],10:[function(e,t,i){function n(e,t,i){var n;for(n=0;n<t.length;n+=1){var r=t[n];this[r.name]=r.value}if(this.tableName=e,this.fields=t,i){var s=Object.keys(i);for(n=0;n<s.length;n+=1){var o=s[n],a=i[o];void 0!==this[o]&&(this[o]=a)}}}var r=e("./check"),s=e("./types").encode,o=e("./types").sizeOf;n.prototype.sizeOf=function(){for(var e=0,t=0;t<this.fields.length;t+=1){var i=this.fields[t],n=this[i.name];if(void 0===n&&(n=i.value),"function"==typeof n.sizeOf)e+=n.sizeOf();else{var s=o[i.type];r.assert("function"==typeof s,"Could not find sizeOf function for field"+i.name),e+=s(n)}}return e},n.prototype.encode=function(){return s.TABLE(this)},i.Table=n},{"./check":1,"./types":25}],11:[function(e,t,i){function n(e,t){if(e===t)return!0;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(var i=0;i<e.length;i+=1)if(!n(e[i],t[i]))return!1;return!0}return!1}function r(e,t,i){var n,r,s,o=[],a=[],u=A.getCard16(e,t);if(0!==u){var l=A.getByte(e,t+2);r=t+(u+1)*l+2;var h=t+3;for(n=0;n<u+1;n+=1)o.push(A.getOffset(e,h,l)),h+=l;s=r+o[u]}else s=t+2;for(n=0;n<o.length-1;n+=1){var c=A.getBytes(e,r+o[n],r+o[n+1]);i&&(c=i(c)),a.push(c)}return{objects:a,startOffset:t,endOffset:s}}function s(e){for(var t="",i=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var n=e.parseByte(),r=n>>4,s=15&n;if(15===r)break;if(t+=i[r],15===s)break;t+=i[s]}return parseFloat(t)}function o(e,t){var i,n,r,o;if(28===t)return i=e.parseByte(),n=e.parseByte(),i<<8|n;if(29===t)return i=e.parseByte(),n=e.parseByte(),r=e.parseByte(),o=e.parseByte(),i<<24|n<<16|r<<8|o;if(30===t)return s(e);if(t>=32&&t<=246)return t-139;if(t>=247&&t<=250)return i=e.parseByte(),256*(t-247)+i+108;if(t>=251&&t<=254)return i=e.parseByte(),256*-(t-251)-i-108;throw new Error("Invalid b0 "+t)}function a(e){for(var t={},i=0;i<e.length;i+=1){var n,r=e[i][0],s=e[i][1];if(n=1===s.length?s[0]:s,t.hasOwnProperty(r))throw new Error("Object "+t+" already has key "+r);t[r]=n}return t}function u(e,t,i){t=void 0!==t?t:0;var n=new A.Parser(e,t),r=[],s=[];for(i=void 0!==i?i:e.length;n.relativeOffset<i;){var u=n.parseByte();u<=21?(12===u&&(u=1200+n.parseByte()),r.push([u,s]),s=[]):s.push(o(n,u))}return a(r)}function l(e,t){return t=t<=390?B.cffStandardStrings[t]:e[t-391]}function h(e,t,i){for(var n={},r=0;r<t.length;r+=1){var s=t[r],o=e[s.op];void 0===o&&(o=void 0!==s.value?s.value:null),"SID"===s.type&&(o=l(i,o)),n[s.name]=o}return n}function c(e,t){var i={};return i.formatMajor=A.getCard8(e,t),i.formatMinor=A.getCard8(e,t+1),i.size=A.getCard8(e,t+2),i.offsetSize=A.getCard8(e,t+3),i.startOffset=t,i.endOffset=t+4,i}function d(e,t){return h(u(e,0,e.byteLength),L,t)}function p(e,t,i,n){return h(u(e,t,i),z,n)}function f(e,t,i,n){var r,s,o,a=new A.Parser(e,t);i-=1;var u=[".notdef"],h=a.parseCard8();if(0===h)for(r=0;r<i;r+=1)s=a.parseSID(),u.push(l(n,s));else if(1===h)for(;u.length<=i;)for(s=a.parseSID(),o=a.parseCard8(),r=0;r<=o;r+=1)u.push(l(n,s)),s+=1;else{if(2!==h)throw new Error("Unknown charset format "+h);for(;u.length<=i;)for(s=a.parseSID(),o=a.parseCard16(),r=0;r<=o;r+=1)u.push(l(n,s)),s+=1}return u}function g(e,t,i){var n,r,s={},o=new A.Parser(e,t),a=o.parseCard8();if(0===a){var u=o.parseCard8();for(n=0;n<u;n+=1)r=o.parseCard8(),s[r]=n}else{if(1!==a)throw new Error("Unknown encoding format "+a);var l=o.parseCard8();for(r=1,n=0;n<l;n+=1)for(var h=o.parseCard8(),c=o.parseCard8(),d=h;d<=h+c;d+=1)s[d]=r,r+=1}return new B.CffEncoding(s,i)}function m(e,t,i){function n(e,t){g&&h.closePath(),h.moveTo(e,t),g=!0}function r(){
var t;t=c.length%2!=0,t&&!p&&(f=c.shift()+e.nominalWidthX),d+=c.length>>1,c.length=0,p=!0}function s(i){for(var x,y,v,w,b,S,C,T,F,O,N,M,D=0;D<i.length;){var E=i[D];switch(D+=1,E){case 1:r();break;case 3:r();break;case 4:c.length>1&&!p&&(f=c.shift()+e.nominalWidthX,p=!0),_+=c.pop(),n(m,_);break;case 5:for(;c.length>0;)m+=c.shift(),_+=c.shift(),h.lineTo(m,_);break;case 6:for(;c.length>0&&(m+=c.shift(),h.lineTo(m,_),0!==c.length);)_+=c.shift(),h.lineTo(m,_);break;case 7:for(;c.length>0&&(_+=c.shift(),h.lineTo(m,_),0!==c.length);)m+=c.shift(),h.lineTo(m,_);break;case 8:for(;c.length>0;)o=m+c.shift(),a=_+c.shift(),u=o+c.shift(),l=a+c.shift(),m=u+c.shift(),_=l+c.shift(),h.curveTo(o,a,u,l,m,_);break;case 10:b=c.pop()+e.subrsBias,S=e.subrs[b],S&&s(S);break;case 11:return;case 12:switch(E=i[D],D+=1,E){case 35:o=m+c.shift(),a=_+c.shift(),u=o+c.shift(),l=a+c.shift(),C=u+c.shift(),T=l+c.shift(),F=C+c.shift(),O=T+c.shift(),N=F+c.shift(),M=O+c.shift(),m=N+c.shift(),_=M+c.shift(),c.shift(),h.curveTo(o,a,u,l,C,T),h.curveTo(F,O,N,M,m,_);break;case 34:o=m+c.shift(),a=_,u=o+c.shift(),l=a+c.shift(),C=u+c.shift(),T=l,F=C+c.shift(),O=l,N=F+c.shift(),M=_,m=N+c.shift(),h.curveTo(o,a,u,l,C,T),h.curveTo(F,O,N,M,m,_);break;case 36:o=m+c.shift(),a=_+c.shift(),u=o+c.shift(),l=a+c.shift(),C=u+c.shift(),T=l,F=C+c.shift(),O=l,N=F+c.shift(),M=O+c.shift(),m=N+c.shift(),h.curveTo(o,a,u,l,C,T),h.curveTo(F,O,N,M,m,_);break;case 37:o=m+c.shift(),a=_+c.shift(),u=o+c.shift(),l=a+c.shift(),C=u+c.shift(),T=l+c.shift(),F=C+c.shift(),O=T+c.shift(),N=F+c.shift(),M=O+c.shift(),Math.abs(N-m)>Math.abs(M-_)?m=N+c.shift():_=M+c.shift(),h.curveTo(o,a,u,l,C,T),h.curveTo(F,O,N,M,m,_);break;default:console.log("Glyph "+t.index+": unknown operator 1200"+E),c.length=0}break;case 14:c.length>0&&!p&&(f=c.shift()+e.nominalWidthX,p=!0),g&&(h.closePath(),g=!1);break;case 18:r();break;case 19:case 20:r(),D+=d+7>>3;break;case 21:c.length>2&&!p&&(f=c.shift()+e.nominalWidthX,p=!0),_+=c.pop(),m+=c.pop(),n(m,_);break;case 22:c.length>1&&!p&&(f=c.shift()+e.nominalWidthX,p=!0),m+=c.pop(),n(m,_);break;case 23:r();break;case 24:for(;c.length>2;)o=m+c.shift(),a=_+c.shift(),u=o+c.shift(),l=a+c.shift(),m=u+c.shift(),_=l+c.shift(),h.curveTo(o,a,u,l,m,_);m+=c.shift(),_+=c.shift(),h.lineTo(m,_);break;case 25:for(;c.length>6;)m+=c.shift(),_+=c.shift(),h.lineTo(m,_);o=m+c.shift(),a=_+c.shift(),u=o+c.shift(),l=a+c.shift(),m=u+c.shift(),_=l+c.shift(),h.curveTo(o,a,u,l,m,_);break;case 26:for(c.length%2&&(m+=c.shift());c.length>0;)o=m,a=_+c.shift(),u=o+c.shift(),l=a+c.shift(),m=u,_=l+c.shift(),h.curveTo(o,a,u,l,m,_);break;case 27:for(c.length%2&&(_+=c.shift());c.length>0;)o=m+c.shift(),a=_,u=o+c.shift(),l=a+c.shift(),m=u+c.shift(),_=l,h.curveTo(o,a,u,l,m,_);break;case 28:x=i[D],y=i[D+1],c.push((x<<24|y<<16)>>16),D+=2;break;case 29:b=c.pop()+e.gsubrsBias,S=e.gsubrs[b],S&&s(S);break;case 30:for(;c.length>0&&(o=m,a=_+c.shift(),u=o+c.shift(),l=a+c.shift(),m=u+c.shift(),_=l+(1===c.length?c.shift():0),h.curveTo(o,a,u,l,m,_),0!==c.length);)o=m+c.shift(),a=_,u=o+c.shift(),l=a+c.shift(),_=l+c.shift(),m=u+(1===c.length?c.shift():0),h.curveTo(o,a,u,l,m,_);break;case 31:for(;c.length>0&&(o=m+c.shift(),a=_,u=o+c.shift(),l=a+c.shift(),_=l+c.shift(),m=u+(1===c.length?c.shift():0),h.curveTo(o,a,u,l,m,_),0!==c.length);)o=m,a=_+c.shift(),u=o+c.shift(),l=a+c.shift(),m=u+c.shift(),_=l+(1===c.length?c.shift():0),h.curveTo(o,a,u,l,m,_);break;default:E<32?console.log("Glyph "+t.index+": unknown operator "+E):E<247?c.push(E-139):E<251?(x=i[D],D+=1,c.push(256*(E-247)+x+108)):E<255?(x=i[D],D+=1,c.push(256*-(E-251)-x-108)):(x=i[D],y=i[D+1],v=i[D+2],w=i[D+3],D+=4,c.push((x<<24|y<<16|v<<8|w)/65536))}}}var o,a,u,l,h=new P.Path,c=[],d=0,p=!1,f=e.defaultWidthX,g=!1,m=0,_=0;return s(i),t.advanceWidth=f,h}function _(e){return e.length<1240?107:e.length<33900?1131:32768}function x(e,t,i){i.tables.cff={};var n=c(e,t),s=r(e,n.endOffset,A.bytesToString),o=r(e,s.endOffset),a=r(e,o.endOffset,A.bytesToString),u=r(e,a.endOffset);i.gsubrs=u.objects,i.gsubrsBias=_(i.gsubrs);var l=new DataView(new Uint8Array(o.objects[0]).buffer),h=d(l,a.objects);i.tables.cff.topDict=h;var x=t+h.private[1],y=p(e,x,h.private[0],a.objects);if(i.defaultWidthX=y.defaultWidthX,i.nominalWidthX=y.nominalWidthX,0!==y.subrs){var v=x+y.subrs,w=r(e,v);i.subrs=w.objects,i.subrsBias=_(i.subrs)}else i.subrs=[],i.subrsBias=0;var b=r(e,t+h.charStrings);i.nGlyphs=b.objects.length;var S=f(e,t+h.charset,i.nGlyphs,a.objects);0===h.encoding?i.cffEncoding=new B.CffEncoding(B.cffStandardEncoding,S):1===h.encoding?i.cffEncoding=new B.CffEncoding(B.cffExpertEncoding,S):i.cffEncoding=g(e,t+h.encoding,S),i.encoding=i.encoding||i.cffEncoding,i.glyphs=new I.GlyphSet(i);for(var C=0;C<i.nGlyphs;C+=1){var T=b.objects[C];i.glyphs.push(C,I.cffGlyphLoader(i,C,m,T))}}function y(e,t){var i,n=B.cffStandardStrings.indexOf(e);return n>=0&&(i=n),n=t.indexOf(e),n>=0?i=n+B.cffStandardStrings.length:(i=B.cffStandardStrings.length+t.length,t.push(e)),i}function v(){return new R.Table("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}])}function w(e){var t=new R.Table("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);t.names=[];for(var i=0;i<e.length;i+=1)t.names.push({name:"name_"+i,type:"NAME",value:e[i]});return t}function b(e,t,i){for(var r={},s=0;s<e.length;s+=1){var o=e[s],a=t[o.name];void 0===a||n(a,o.value)||("SID"===o.type&&(a=y(a,i)),r[o.op]={name:o.name,type:o.type,value:a})}return r}function S(e,t){var i=new R.Table("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return i.dict=b(L,e,t),i}function C(e){var t=new R.Table("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return t.topDicts=[{name:"topDict_0",type:"TABLE",value:e}],t}function T(e){var t=new R.Table("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);t.strings=[];for(var i=0;i<e.length;i+=1)t.strings.push({name:"string_"+i,type:"STRING",value:e[i]});return t}function F(){return new R.Table("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}])}function O(e,t){for(var i=new R.Table("Charsets",[{name:"format",type:"Card8",value:0}]),n=0;n<e.length;n+=1){var r=e[n],s=y(r,t);i.fields.push({name:"glyph_"+n,type:"SID",value:s})}return i}function N(e){var t=[],i=e.path;t.push({name:"width",type:"NUMBER",value:e.advanceWidth});for(var n=0,r=0,s=0;s<i.commands.length;s+=1){var o,a,u=i.commands[s];if("Q"===u.type){u={type:"C",x:u.x,y:u.y,x1:1/3*n+2/3*u.x1,y1:1/3*r+2/3*u.y1,x2:1/3*u.x+2/3*u.x1,y2:1/3*u.y+2/3*u.y1}}if("M"===u.type)o=Math.round(u.x-n),a=Math.round(u.y-r),t.push({name:"dx",type:"NUMBER",value:o}),t.push({name:"dy",type:"NUMBER",value:a}),t.push({name:"rmoveto",type:"OP",value:21}),n=Math.round(u.x),r=Math.round(u.y);else if("L"===u.type)o=Math.round(u.x-n),a=Math.round(u.y-r),t.push({name:"dx",type:"NUMBER",value:o}),t.push({name:"dy",type:"NUMBER",value:a}),t.push({name:"rlineto",type:"OP",value:5}),n=Math.round(u.x),r=Math.round(u.y);else if("C"===u.type){var l=Math.round(u.x1-n),h=Math.round(u.y1-r),c=Math.round(u.x2-u.x1),d=Math.round(u.y2-u.y1);o=Math.round(u.x-u.x2),a=Math.round(u.y-u.y2),t.push({name:"dx1",type:"NUMBER",value:l}),t.push({name:"dy1",type:"NUMBER",value:h}),t.push({name:"dx2",type:"NUMBER",value:c}),t.push({name:"dy2",type:"NUMBER",value:d}),t.push({name:"dx",type:"NUMBER",value:o}),t.push({name:"dy",type:"NUMBER",value:a}),t.push({name:"rrcurveto",type:"OP",value:8}),n=Math.round(u.x),r=Math.round(u.y)}}return t.push({name:"endchar",type:"OP",value:14}),t}function M(e){for(var t=new R.Table("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),i=0;i<e.length;i+=1){var n=e.get(i),r=N(n);t.charStrings.push({name:n.name,type:"CHARSTRING",value:r})}return t}function D(e,t){var i=new R.Table("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return i.dict=b(z,e,t),i}function E(e){var t=new R.Table("Private DICT INDEX",[{name:"privateDicts",type:"INDEX",value:[]}]);return t.privateDicts=[{name:"privateDict_0",type:"TABLE",value:e}],t}function V(e,t){for(var i,n=new R.Table("CFF ",[{name:"header",type:"TABLE"},{name:"nameIndex",type:"TABLE"},{name:"topDictIndex",type:"TABLE"},{name:"stringIndex",type:"TABLE"},{name:"globalSubrIndex",type:"TABLE"},{name:"charsets",type:"TABLE"},{name:"charStringsIndex",type:"TABLE"},{name:"privateDictIndex",type:"TABLE"}]),r=1/t.unitsPerEm,s={version:t.version,fullName:t.fullName,familyName:t.familyName,weight:t.weightName,fontMatrix:[r,0,0,r,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},o={},a=[],u=1;u<e.length;u+=1)i=e.get(u),a.push(i.name);var l=[];n.header=v(),n.nameIndex=w([t.postScriptName]);var h=S(s,l);n.topDictIndex=C(h),n.globalSubrIndex=F(),n.charsets=O(a,l),n.charStringsIndex=M(e);var c=D(o,l);n.privateDictIndex=E(c),n.stringIndex=T(l);var d=n.header.sizeOf()+n.nameIndex.sizeOf()+n.topDictIndex.sizeOf()+n.stringIndex.sizeOf()+n.globalSubrIndex.sizeOf();return s.charset=d,s.encoding=0,s.charStrings=s.charset+n.charsets.sizeOf(),s.private[1]=s.charStrings+n.charStringsIndex.sizeOf(),h=S(s,l),n.topDictIndex=C(h),n}var B=e("../encoding"),I=e("../glyphset"),A=e("../parse"),P=e("../path"),R=e("../table"),L=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]}],z=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];i.parse=x,i.make=V},{"../encoding":3,"../glyphset":6,"../parse":8,"../path":9,"../table":10}],12:[function(e,t,i){function n(e,t){var i,n={};n.version=u.getUShort(e,t),a.argument(0===n.version,"cmap table version should be 0."),n.numTables=u.getUShort(e,t+2);var r=-1;for(i=0;i<n.numTables;i+=1){var s=u.getUShort(e,t+4+8*i),o=u.getUShort(e,t+4+8*i+2);if(3===s&&(1===o||0===o)){r=u.getULong(e,t+4+8*i+4);break}}if(r===-1)return null;var l=new u.Parser(e,t+r);n.format=l.parseUShort(),a.argument(4===n.format,"Only format 4 cmap tables are supported."),n.length=l.parseUShort(),n.language=l.parseUShort();var h;n.segCount=h=l.parseUShort()>>1,l.skip("uShort",3),n.glyphIndexMap={};var c=new u.Parser(e,t+r+14),d=new u.Parser(e,t+r+16+2*h),p=new u.Parser(e,t+r+16+4*h),f=new u.Parser(e,t+r+16+6*h),g=t+r+16+8*h;for(i=0;i<h-1;i+=1)for(var m,_=c.parseUShort(),x=d.parseUShort(),y=p.parseShort(),v=f.parseUShort(),w=x;w<=_;w+=1)0!==v?(g=f.offset+f.relativeOffset-2,g+=v,g+=2*(w-x),0!==(m=u.getUShort(e,g))&&(m=m+y&65535)):m=w+y&65535,n.glyphIndexMap[w]=m;return n}function r(e,t,i){e.segments.push({end:t,start:t,delta:-(t-i),offset:0})}function s(e){e.segments.push({end:65535,start:65535,delta:1,offset:0})}function o(e){var t,i=new l.Table("cmap",[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:1},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:12},{name:"format",type:"USHORT",value:4},{name:"length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);for(i.segments=[],t=0;t<e.length;t+=1){for(var n=e.get(t),o=0;o<n.unicodes.length;o+=1)r(i,n.unicodes[o],t);i.segments=i.segments.sort(function(e,t){return e.start-t.start})}s(i);var a;a=i.segments.length,i.segCountX2=2*a,i.searchRange=2*Math.pow(2,Math.floor(Math.log(a)/Math.log(2))),i.entrySelector=Math.log(i.searchRange/2)/Math.log(2),i.rangeShift=i.segCountX2-i.searchRange;var u=[],h=[],c=[],d=[],p=[];for(t=0;t<a;t+=1){var f=i.segments[t];u=u.concat({name:"end_"+t,type:"USHORT",value:f.end}),h=h.concat({name:"start_"+t,type:"USHORT",value:f.start}),c=c.concat({name:"idDelta_"+t,type:"SHORT",value:f.delta}),d=d.concat({name:"idRangeOffset_"+t,type:"USHORT",value:f.offset}),void 0!==f.glyphId&&(p=p.concat({name:"glyph_"+t,type:"USHORT",value:f.glyphId}))}return i.fields=i.fields.concat(u),i.fields.push({name:"reservedPad",type:"USHORT",value:0}),i.fields=i.fields.concat(h),i.fields=i.fields.concat(c),i.fields=i.fields.concat(d),i.fields=i.fields.concat(p),i.length=14+2*u.length+2+2*h.length+2*c.length+2*d.length+2*p.length,i}var a=e("../check"),u=e("../parse"),l=e("../table");i.parse=n,i.make=o},{"../check":1,"../parse":8,"../table":10}],13:[function(e,t,i){function n(e,t,i,n,r){var s;return(t&n)>0?(s=e.parseByte(),0==(t&r)&&(s=-s),s=i+s):s=(t&r)>0?i:i+e.parseShort(),s}function r(e,t,i){var r=new d.Parser(t,i);e.numberOfContours=r.parseShort(),e.xMin=r.parseShort(),e.yMin=r.parseShort(),e.xMax=r.parseShort(),e.yMax=r.parseShort();var s,o;if(e.numberOfContours>0){var a,u=e.endPointIndices=[];for(a=0;a<e.numberOfContours;a+=1)u.push(r.parseUShort());for(e.instructionLength=r.parseUShort(),e.instructions=[],a=0;a<e.instructionLength;a+=1)e.instructions.push(r.parseByte());var l=u[u.length-1]+1;for(s=[],a=0;a<l;a+=1)if(o=r.parseByte(),s.push(o),(8&o)>0)for(var c=r.parseByte(),p=0;p<c;p+=1)s.push(o),a+=1;if(h.argument(s.length===l,"Bad flags."),u.length>0){var f,g=[];if(l>0){for(a=0;a<l;a+=1)o=s[a],f={},f.onCurve=!!(1&o),f.lastPointOfContour=u.indexOf(a)>=0,g.push(f);var m=0;for(a=0;a<l;a+=1)o=s[a],f=g[a],f.x=n(r,o,m,2,16),m=f.x;var _=0;for(a=0;a<l;a+=1)o=s[a],f=g[a],f.y=n(r,o,_,4,32),_=f.y}e.points=g}else e.points=[]}else if(0===e.numberOfContours)e.points=[];else{e.isComposite=!0,e.points=[],e.components=[];for(var x=!0;x;){s=r.parseUShort();var y={glyphIndex:r.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(1&s)>0?(y.dx=r.parseShort(),y.dy=r.parseShort()):(y.dx=r.parseChar(),y.dy=r.parseChar()),(8&s)>0?y.xScale=y.yScale=r.parseF2Dot14():(64&s)>0?(y.xScale=r.parseF2Dot14(),y.yScale=r.parseF2Dot14()):(128&s)>0&&(y.xScale=r.parseF2Dot14(),y.scale01=r.parseF2Dot14(),y.scale10=r.parseF2Dot14(),y.yScale=r.parseF2Dot14()),e.components.push(y),x=!!(32&s)}}}function s(e,t){for(var i=[],n=0;n<e.length;n+=1){var r=e[n],s={x:t.xScale*r.x+t.scale01*r.y+t.dx,y:t.scale10*r.x+t.yScale*r.y+t.dy,onCurve:r.onCurve,lastPointOfContour:r.lastPointOfContour};i.push(s)}return i}function o(e){for(var t=[],i=[],n=0;n<e.length;n+=1){var r=e[n];i.push(r),r.lastPointOfContour&&(t.push(i),i=[])}return h.argument(0===i.length,"There are still points left in the current contour."),t}function a(e){var t=new p.Path;if(!e)return t;for(var i=o(e),n=0;n<i.length;n+=1){var r,s,a=i[n],u=a[0],l=a[a.length-1];u.onCurve?(r=null,s=!0):(u=l.onCurve?l:{x:(u.x+l.x)/2,y:(u.y+l.y)/2},r=u,s=!1),t.moveTo(u.x,u.y);for(var h=s?1:0;h<a.length;h+=1){var c=a[h],d=0===h?u:a[h-1];if(d.onCurve&&c.onCurve)t.lineTo(c.x,c.y);else if(d.onCurve&&!c.onCurve)r=c;else if(d.onCurve||c.onCurve){if(d.onCurve||!c.onCurve)throw new Error("Invalid state.");t.quadraticCurveTo(r.x,r.y,c.x,c.y),r=null}else{var f={x:(d.x+c.x)/2,y:(d.y+c.y)/2};t.quadraticCurveTo(d.x,d.y,f.x,f.y),r=c}}u!==l&&(r?t.quadraticCurveTo(r.x,r.y,u.x,u.y):t.lineTo(u.x,u.y))}return t.closePath(),t}function u(e,t){if(t.isComposite)for(var i=0;i<t.components.length;i+=1){var n=t.components[i],r=e.get(n.glyphIndex);if(r.points){var o=s(r.points,n);t.points=t.points.concat(o)}}return a(t.points)}function l(e,t,i,n){var s,o=new c.GlyphSet(n);for(s=0;s<i.length-1;s+=1){var a=i[s];a!==i[s+1]?o.push(s,c.ttfGlyphLoader(n,s,r,e,t+a,u)):o.push(s,c.glyphLoader(n,s))}return o}var h=e("../check"),c=e("../glyphset"),d=e("../parse"),p=e("../path");i.parse=l},{"../check":1,"../glyphset":6,"../parse":8,"../path":9}],14:[function(e,t,i){function n(e,t){for(var i=new h.Parser(e,t),n=i.parseUShort(),r=[],s=0;s<n;s++)r[i.parseTag()]={offset:i.parseUShort()};return r}function r(e,t){var i=new h.Parser(e,t),n=i.parseUShort(),r=i.parseUShort();if(1===n)return i.parseUShortList(r);if(2===n){for(var s=[];r--;)for(var o=i.parseUShort(),a=i.parseUShort(),u=i.parseUShort(),l=o;l<=a;l++)s[u++]=l;return s}}function s(e,t){var i=new h.Parser(e,t),n=i.parseUShort();if(1===n){var r=i.parseUShort(),s=i.parseUShort(),o=i.parseUShortList(s);return function(e){return o[e-r]||0}}if(2===n){for(var a=i.parseUShort(),u=[],l=[],c=[],d=0;d<a;d++)u[d]=i.parseUShort(),l[d]=i.parseUShort(),c[d]=i.parseUShort();return function(e){for(var t=0,i=u.length-1;t<i;){var n=t+i+1>>1;e<u[n]?i=n-1:t=n}return u[t]<=e&&e<=l[t]?c[t]||0:0}}}function o(e,t){var i,n=new h.Parser(e,t),o=n.parseUShort(),a=n.parseUShort(),u=r(e,t+a),l=n.parseUShort(),c=n.parseUShort();if(4===l&&0===c){var d={};if(1===o){for(var p=n.parseUShort(),f=[],g=n.parseOffset16List(p),m=0;m<p;m++){var _=g[m],x=d[_];if(!x){x={},n.relativeOffset=_;for(var y=n.parseUShort();y--;){var v=n.parseUShort();l&&(i=n.parseShort()),c&&n.parseShort(),x[v]=i}}f[u[m]]=x}return function(e,t){var i=f[e];if(i)return i[t]}}if(2===o){for(var w=n.parseUShort(),b=n.parseUShort(),S=n.parseUShort(),C=n.parseUShort(),T=s(e,t+w),F=s(e,t+b),O=[],N=0;N<S;N++)for(var M=O[N]=[],D=0;D<C;D++)l&&(i=n.parseShort()),c&&n.parseShort(),M[D]=i;var E={};for(N=0;N<u.length;N++)E[u[N]]=1;return function(e,t){if(E[e]){var i=T(e),n=F(t),r=O[i];return r?r[n]:void 0}}}}}function a(e,t){var i=new h.Parser(e,t),n=i.parseUShort(),r=i.parseUShort(),s=16&r,a=i.parseUShort(),u=i.parseOffset16List(a),l={lookupType:n,lookupFlag:r,markFilteringSet:s?i.parseUShort():-1};if(2===n){for(var c=[],d=0;d<a;d++)c.push(o(e,t+u[d]));l.getKerningValue=function(e,t){for(var i=c.length;i--;){var n=c[i](e,t);if(void 0!==n)return n}return 0}}return l}function u(e,t,i){var r=new h.Parser(e,t),s=r.parseFixed();l.argument(1===s,"Unsupported GPOS table version."),n(e,t+r.parseUShort()),n(e,t+r.parseUShort());var o=r.parseUShort();r.relativeOffset=o;for(var u=r.parseUShort(),c=r.parseOffset16List(u),d=t+o,p=0;p<u;p++){var f=a(e,d+c[p]);2!==f.lookupType||i.getGposKerningValue||(i.getGposKerningValue=f.getKerningValue)}}var l=e("../check"),h=e("../parse");i.parse=u},{"../check":1,"../parse":8}],15:[function(e,t,i){function n(e,t){var i={},n=new o.Parser(e,t);return i.version=n.parseVersion(),i.fontRevision=Math.round(1e3*n.parseFixed())/1e3,i.checkSumAdjustment=n.parseULong(),i.magicNumber=n.parseULong(),s.argument(1594834165===i.magicNumber,"Font header has wrong magic number."),i.flags=n.parseUShort(),i.unitsPerEm=n.parseUShort(),i.created=n.parseLongDateTime(),i.modified=n.parseLongDateTime(),i.xMin=n.parseShort(),i.yMin=n.parseShort(),i.xMax=n.parseShort(),i.yMax=n.parseShort(),i.macStyle=n.parseUShort(),i.lowestRecPPEM=n.parseUShort(),i.fontDirectionHint=n.parseShort(),i.indexToLocFormat=n.parseShort(),i.glyphDataFormat=n.parseShort(),i}function r(e){return new a.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:0},{name:"modified",type:"LONGDATETIME",value:0},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],e)}var s=e("../check"),o=e("../parse"),a=e("../table");i.parse=n,i.make=r},{"../check":1,"../parse":8,"../table":10}],16:[function(e,t,i){function n(e,t){var i={},n=new s.Parser(e,t);return i.version=n.parseVersion(),i.ascender=n.parseShort(),i.descender=n.parseShort(),i.lineGap=n.parseShort(),i.advanceWidthMax=n.parseUShort(),i.minLeftSideBearing=n.parseShort(),i.minRightSideBearing=n.parseShort(),i.xMaxExtent=n.parseShort(),i.caretSlopeRise=n.parseShort(),i.caretSlopeRun=n.parseShort(),i.caretOffset=n.parseShort(),n.relativeOffset+=8,i.metricDataFormat=n.parseShort(),i.numberOfHMetrics=n.parseUShort(),i}function r(e){return new o.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],e)}var s=e("../parse"),o=e("../table");i.parse=n,i.make=r},{"../parse":8,"../table":10}],17:[function(e,t,i){function n(e,t,i,n,r){for(var o,a,u=new s.Parser(e,t),l=0;l<n;l+=1){l<i&&(o=u.parseUShort(),a=u.parseShort());var h=r.get(l);h.advanceWidth=o,h.leftSideBearing=a}}function r(e){for(var t=new o.Table("hmtx",[]),i=0;i<e.length;i+=1){var n=e.get(i),r=n.advanceWidth||0,s=n.leftSideBearing||0;t.fields.push({name:"advanceWidth_"+i,type:"USHORT",value:r}),t.fields.push({name:"leftSideBearing_"+i,type:"SHORT",value:s})}return t}var s=e("../parse"),o=e("../table");i.parse=n,i.make=r},{"../parse":8,"../table":10}],18:[function(e,t,i){function n(e,t){var i={},n=new s.Parser(e,t),o=n.parseUShort();r.argument(0===o,"Unsupported kern table version."),n.skip("uShort",1);var a=n.parseUShort();r.argument(0===a,"Unsupported kern sub-table version."),n.skip("uShort",2);var u=n.parseUShort();n.skip("uShort",3);for(var l=0;l<u;l+=1){var h=n.parseUShort(),c=n.parseUShort(),d=n.parseShort();i[h+","+c]=d}return i}var r=e("../check"),s=e("../parse");i.parse=n},{"../check":1,"../parse":8}],19:[function(e,t,i){function n(e,t,i,n){for(var s=new r.Parser(e,t),o=n?s.parseUShort:s.parseULong,a=[],u=0;u<i+1;u+=1){var l=o.call(s);n&&(l*=2),a.push(l)}return a}var r=e("../parse");i.parse=n},{"../parse":8}],20:[function(e,t,i){function n(e,t){var i={},n=new s.Parser(e,t);return i.version=n.parseVersion(),i.numGlyphs=n.parseUShort(),1===i.version&&(i.maxPoints=n.parseUShort(),i.maxContours=n.parseUShort(),i.maxCompositePoints=n.parseUShort(),i.maxCompositeContours=n.parseUShort(),i.maxZones=n.parseUShort(),i.maxTwilightPoints=n.parseUShort(),i.maxStorage=n.parseUShort(),i.maxFunctionDefs=n.parseUShort(),i.maxInstructionDefs=n.parseUShort(),i.maxStackElements=n.parseUShort(),i.maxSizeOfInstructions=n.parseUShort(),i.maxComponentElements=n.parseUShort(),i.maxComponentDepth=n.parseUShort()),i}function r(e){return new o.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:e}])}var s=e("../parse"),o=e("../table");i.parse=n,i.make=r},{"../parse":8,"../table":10}],21:[function(e,t,i){function n(e,t){var i={},n=new l.Parser(e,t);i.format=n.parseUShort();for(var r=n.parseUShort(),s=n.offset+n.parseUShort(),o=0,a=0;a<r;a++){var u=n.parseUShort(),h=n.parseUShort(),d=n.parseUShort(),p=n.parseUShort(),f=c[p],g=n.parseUShort(),m=n.parseUShort();if(3===u&&1===h&&1033===d){for(var _=[],x=g/2,y=0;y<x;y++,m+=2)_[y]=l.getShort(e,s+m);var v=String.fromCharCode.apply(null,_);f?i[f]=v:(o++,i["unknown"+o]=v)}}return 1===i.format&&(i.langTagCount=n.parseUShort()),i}function r(e,t,i,n,r,s){return new h.Table("NameRecord",[{name:"platformID",type:"USHORT",value:e},{name:"encodingID",type:"USHORT",value:t},{name:"languageID",type:"USHORT",value:i},{name:"nameID",type:"USHORT",value:n},{name:"length",type:"USHORT",value:r},{name:"offset",type:"USHORT",value:s}])}function s(e,t,i,n){var s=u.STRING(i);return e.records.push(r(1,0,0,t,s.length,n)),e.strings.push(s),n+=s.length}function o(e,t,i,n){var s=u.UTF16(i);return e.records.push(r(3,1,1033,t,s.length,n)),e.strings.push(s),n+=s.length}function a(e){var t=new h.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:0},{name:"stringOffset",type:"USHORT",value:0}]);t.records=[],t.strings=[];var i,n,r=0;for(i=0;i<c.length;i+=1)void 0!==e[c[i]]&&(n=e[c[i]],r=s(t,i,n,r));for(i=0;i<c.length;i+=1)void 0!==e[c[i]]&&(n=e[c[i]],r=o(t,i,n,r));for(t.count=t.records.length,t.stringOffset=6+12*t.count,i=0;i<t.records.length;i+=1)t.fields.push({name:"record_"+i,type:"TABLE",value:t.records[i]});for(i=0;i<t.strings.length;i+=1)t.fields.push({name:"string_"+i,type:"LITERAL",value:t.strings[i]});return t}var u=e("../types").encode,l=e("../parse"),h=e("../table"),c=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","licence","licenceURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"];i.parse=n,i.make=a},{"../parse":8,"../table":10,"../types":25}],22:[function(e,t,i){function n(e){for(var t=0;t<u.length;t+=1){var i=u[t];if(e>=i.begin&&e<i.end)return t}return-1}function r(e,t){var i={},n=new o.Parser(e,t);i.version=n.parseUShort(),i.xAvgCharWidth=n.parseShort(),i.usWeightClass=n.parseUShort(),i.usWidthClass=n.parseUShort(),i.fsType=n.parseUShort(),i.ySubscriptXSize=n.parseShort(),i.ySubscriptYSize=n.parseShort(),i.ySubscriptXOffset=n.parseShort(),i.ySubscriptYOffset=n.parseShort(),i.ySuperscriptXSize=n.parseShort(),i.ySuperscriptYSize=n.parseShort(),i.ySuperscriptXOffset=n.parseShort(),i.ySuperscriptYOffset=n.parseShort(),i.yStrikeoutSize=n.parseShort(),i.yStrikeoutPosition=n.parseShort(),i.sFamilyClass=n.parseShort(),i.panose=[];for(var r=0;r<10;r++)i.panose[r]=n.parseByte();return i.ulUnicodeRange1=n.parseULong(),i.ulUnicodeRange2=n.parseULong(),i.ulUnicodeRange3=n.parseULong(),i.ulUnicodeRange4=n.parseULong(),i.achVendID=String.fromCharCode(n.parseByte(),n.parseByte(),n.parseByte(),n.parseByte()),i.fsSelection=n.parseUShort(),i.usFirstCharIndex=n.parseUShort(),i.usLastCharIndex=n.parseUShort(),i.sTypoAscender=n.parseShort(),i.sTypoDescender=n.parseShort(),i.sTypoLineGap=n.parseShort(),i.usWinAscent=n.parseUShort(),i.usWinDescent=n.parseUShort(),i.version>=1&&(i.ulCodePageRange1=n.parseULong(),i.ulCodePageRange2=n.parseULong()),i.version>=2&&(i.sxHeight=n.parseShort(),i.sCapHeight=n.parseShort(),i.usDefaultChar=n.parseUShort(),i.usBreakChar=n.parseUShort(),i.usMaxContent=n.parseUShort()),i}function s(e){return new a.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],e)}var o=e("../parse"),a=e("../table"),u=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{
begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];i.unicodeRanges=u,i.getUnicodeRange=n,i.parse=r,i.make=s},{"../parse":8,"../table":10}],23:[function(e,t,i){function n(e,t){var i,n={},r=new o.Parser(e,t);switch(n.version=r.parseVersion(),n.italicAngle=r.parseFixed(),n.underlinePosition=r.parseShort(),n.underlineThickness=r.parseShort(),n.isFixedPitch=r.parseULong(),n.minMemType42=r.parseULong(),n.maxMemType42=r.parseULong(),n.minMemType1=r.parseULong(),n.maxMemType1=r.parseULong(),n.version){case 1:n.names=s.standardNames.slice();break;case 2:for(n.numberOfGlyphs=r.parseUShort(),n.glyphNameIndex=new Array(n.numberOfGlyphs),i=0;i<n.numberOfGlyphs;i++)n.glyphNameIndex[i]=r.parseUShort();for(n.names=[],i=0;i<n.numberOfGlyphs;i++)if(n.glyphNameIndex[i]>=s.standardNames.length){var a=r.parseChar();n.names.push(r.parseString(a))}break;case 2.5:for(n.numberOfGlyphs=r.parseUShort(),n.offset=new Array(n.numberOfGlyphs),i=0;i<n.numberOfGlyphs;i++)n.offset[i]=r.parseChar()}return n}function r(){return new a.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}var s=e("../encoding"),o=e("../parse"),a=e("../table");i.parse=n,i.make=r},{"../encoding":3,"../parse":8,"../table":10}],24:[function(e,t,i){function n(e){return Math.log(e)/Math.log(2)|0}function r(e){for(;e.length%4!=0;)e.push(0);for(var t=0,i=0;i<e.length;i+=4)t+=(e[i]<<24)+(e[i+1]<<16)+(e[i+2]<<8)+e[i+3];return t%=Math.pow(2,32)}function s(e,t,i,n){return new c.Table("Table Record",[{name:"tag",type:"TAG",value:void 0!==e?e:""},{name:"checkSum",type:"ULONG",value:void 0!==t?t:0},{name:"offset",type:"ULONG",value:void 0!==i?i:0},{name:"length",type:"ULONG",value:void 0!==n?n:0}])}function o(e){var t=new c.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);t.tables=e,t.numTables=e.length;var i=Math.pow(2,n(t.numTables));t.searchRange=16*i,t.entrySelector=n(i),t.rangeShift=16*t.numTables-t.searchRange;for(var o=[],a=[],u=t.sizeOf()+s().sizeOf()*t.numTables;u%4!=0;)u+=1,a.push({name:"padding",type:"BYTE",value:0});for(var l=0;l<e.length;l+=1){var d=e[l];h.argument(4===d.tableName.length,"Table name"+d.tableName+" is invalid.");var p=d.sizeOf(),f=s(d.tableName,r(d.encode()),u,p);for(o.push({name:f.tag+" Table Record",type:"TABLE",value:f}),a.push({name:d.tableName+" table",type:"TABLE",value:d}),u+=p,h.argument(!isNaN(u),"Something went wrong calculating the offset.");u%4!=0;)u+=1,a.push({name:"padding",type:"BYTE",value:0})}return o.sort(function(e,t){return e.value.tag>t.value.tag?1:-1}),t.fields=t.fields.concat(o),t.fields=t.fields.concat(a),t}function a(e,t,i){for(var n=0;n<t.length;n+=1){var r=e.charToGlyphIndex(t[n]);if(r>0){return e.glyphs.get(r).getMetrics()}}return i}function u(e){for(var t=0,i=0;i<e.length;i+=1)t+=e[i];return t/e.length}function l(e){for(var t,i=[],n=[],s=[],l=[],h=[],c=[],w=[],b=0,S=0,C=0,T=0,F=0,O=0;O<e.glyphs.length;O+=1){var N=e.glyphs.get(O),M=0|N.unicode;(t>M||null===t)&&(t=M),b<M&&(b=M);var D=y.getUnicodeRange(M);if(D<32)S|=1<<D;else if(D<64)C|=1<<D-32;else if(D<96)T|=1<<D-64;else{if(!(D<123))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");F|=1<<D-96}if(".notdef"!==N.name){var E=N.getMetrics();i.push(E.xMin),n.push(E.yMin),s.push(E.xMax),l.push(E.yMax),c.push(E.leftSideBearing),w.push(E.rightSideBearing),h.push(N.advanceWidth)}}var V={xMin:Math.min.apply(null,i),yMin:Math.min.apply(null,n),xMax:Math.max.apply(null,s),yMax:Math.max.apply(null,l),advanceWidthMax:Math.max.apply(null,h),advanceWidthAvg:u(h),minLeftSideBearing:Math.min.apply(null,c),maxLeftSideBearing:Math.max.apply(null,c),minRightSideBearing:Math.min.apply(null,w)};V.ascender=void 0!==e.ascender?e.ascender:V.yMax,V.descender=void 0!==e.descender?e.descender:V.yMin;var B=f.make({unitsPerEm:e.unitsPerEm,xMin:V.xMin,yMin:V.yMin,xMax:V.xMax,yMax:V.yMax}),I=g.make({ascender:V.ascender,descender:V.descender,advanceWidthMax:V.advanceWidthMax,minLeftSideBearing:V.minLeftSideBearing,minRightSideBearing:V.minRightSideBearing,xMaxExtent:V.maxLeftSideBearing+(V.xMax-V.xMin),numberOfHMetrics:e.glyphs.length}),A=_.make(e.glyphs.length),P=y.make({xAvgCharWidth:Math.round(V.advanceWidthAvg),usWeightClass:500,usWidthClass:5,usFirstCharIndex:t,usLastCharIndex:b,ulUnicodeRange1:S,ulUnicodeRange2:C,ulUnicodeRange3:T,ulUnicodeRange4:F,sTypoAscender:V.ascender,sTypoDescender:V.descender,sTypoLineGap:0,usWinAscent:V.ascender,usWinDescent:-V.descender,sxHeight:a(e,"xyvw",{yMax:0}).yMax,sCapHeight:a(e,"HIKLEFJMNTZBDPRAGOQSUVWXY",V).yMax,usBreakChar:e.hasChar(" ")?32:0}),R=m.make(e.glyphs),L=d.make(e.glyphs),z=e.familyName+" "+e.styleName,k=e.familyName.replace(/\s/g,"")+"-"+e.styleName,X=x.make({copyright:e.copyright,fontFamily:e.familyName,fontSubfamily:e.styleName,uniqueID:e.manufacturer+":"+z,fullName:z,version:e.version,postScriptName:k,trademark:e.trademark,manufacturer:e.manufacturer,designer:e.designer,description:e.description,manufacturerURL:e.manufacturerURL,designerURL:e.designerURL,license:e.license,licenseURL:e.licenseURL,preferredFamily:e.familyName,preferredSubfamily:e.styleName}),U=v.make(),j=p.make(e.glyphs,{version:e.version,fullName:z,familyName:e.familyName,weightName:e.styleName,postScriptName:k,unitsPerEm:e.unitsPerEm}),G=[B,I,A,P,X,L,U,j,R],q=o(G),H=q.encode(),W=r(H),Y=q.fields,$=!1;for(O=0;O<Y.length;O+=1)if("head table"===Y[O].name){Y[O].value.checkSumAdjustment=2981146554-W,$=!0;break}if(!$)throw new Error("Could not find head table with checkSum to adjust.");return q}var h=e("../check"),c=e("../table"),d=e("./cmap"),p=e("./cff"),f=e("./head"),g=e("./hhea"),m=e("./hmtx"),_=e("./maxp"),x=e("./name"),y=e("./os2"),v=e("./post");i.computeCheckSum=r,i.make=o,i.fontToTable=l},{"../check":1,"../table":10,"./cff":11,"./cmap":12,"./head":15,"./hhea":16,"./hmtx":17,"./maxp":20,"./name":21,"./os2":22,"./post":23}],25:[function(e,t,i){function n(e){return function(){return e}}var r=e("./check"),s={},o={},a={};o.BYTE=function(e){return r.argument(e>=0&&e<=255,"Byte value should be between 0 and 255."),[e]},a.BYTE=n(1),o.CHAR=function(e){return[e.charCodeAt(0)]},a.CHAR=n(1),o.CHARARRAY=function(e){for(var t=[],i=0;i<e.length;i+=1)t.push(e.charCodeAt(i));return t},a.CHARARRAY=function(e){return e.length},o.USHORT=function(e){return[e>>8&255,255&e]},a.USHORT=n(2),o.SHORT=function(e){return e>=32768&&(e=-(65536-e)),[e>>8&255,255&e]},a.SHORT=n(2),o.UINT24=function(e){return[e>>16&255,e>>8&255,255&e]},a.UINT24=n(3),o.ULONG=function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]},a.ULONG=n(4),o.LONG=function(e){return e>=2147483648&&(e=-(4294967296-e)),[e>>24&255,e>>16&255,e>>8&255,255&e]},a.LONG=n(4),o.FIXED=o.ULONG,a.FIXED=a.ULONG,o.FWORD=o.SHORT,a.FWORD=a.SHORT,o.UFWORD=o.USHORT,a.UFWORD=a.USHORT,o.LONGDATETIME=function(){return[0,0,0,0,0,0,0,0]},a.LONGDATETIME=n(8),o.TAG=function(e){return r.argument(4===e.length,"Tag should be exactly 4 ASCII characters."),[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]},a.TAG=n(4),o.Card8=o.BYTE,a.Card8=a.BYTE,o.Card16=o.USHORT,a.Card16=a.USHORT,o.OffSize=o.BYTE,a.OffSize=a.BYTE,o.SID=o.USHORT,a.SID=a.USHORT,o.NUMBER=function(e){return e>=-107&&e<=107?[e+139]:e>=108&&e<=1131?(e-=108,[247+(e>>8),255&e]):e>=-1131&&e<=-108?(e=-e-108,[251+(e>>8),255&e]):e>=-32768&&e<=32767?o.NUMBER16(e):o.NUMBER32(e)},a.NUMBER=function(e){return o.NUMBER(e).length},o.NUMBER16=function(e){return[28,e>>8&255,255&e]},a.NUMBER16=n(3),o.NUMBER32=function(e){return[29,e>>24&255,e>>16&255,e>>8&255,255&e]},a.NUMBER32=n(5),o.REAL=function(e){var t=e.toString(),i=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(t);if(i){var n=parseFloat("1e"+((i[2]?+i[2]:0)+i[1].length));t=(Math.round(e*n)/n).toString()}var r,s,o="";for(r=0,s=t.length;r<s;r+=1){var a=t[r];o+="e"===a?"-"===t[++r]?"c":"b":"."===a?"a":"-"===a?"e":a}o+=1&o.length?"f":"ff";var u=[30];for(r=0,s=o.length;r<s;r+=2)u.push(parseInt(o.substr(r,2),16));return u},a.REAL=function(e){return o.REAL(e).length},o.NAME=o.CHARARRAY,a.NAME=a.CHARARRAY,o.STRING=o.CHARARRAY,a.STRING=a.CHARARRAY,o.UTF16=function(e){for(var t=[],i=0;i<e.length;i+=1){var n=e.charCodeAt(i);t.push(n>>8&255),t.push(255&n)}return t},a.UTF16=function(e){return 2*e.length},o.INDEX=function(e){var t,i=1,n=[i],r=[],s=0;for(t=0;t<e.length;t+=1){var a=o.OBJECT(e[t]);Array.prototype.push.apply(r,a),s+=a.length,i+=a.length,n.push(i)}if(0===r.length)return[0,0];var u=[],l=1+Math.floor(Math.log(s)/Math.log(2))/8|0,h=[void 0,o.BYTE,o.USHORT,o.UINT24,o.ULONG][l];for(t=0;t<n.length;t+=1){var c=h(n[t]);Array.prototype.push.apply(u,c)}return Array.prototype.concat(o.Card16(e.length),o.OffSize(l),u,r)},a.INDEX=function(e){return o.INDEX(e).length},o.DICT=function(e){for(var t=[],i=Object.keys(e),n=i.length,r=0;r<n;r+=1){var s=parseInt(i[r],0),a=e[s];t=t.concat(o.OPERAND(a.value,a.type)),t=t.concat(o.OPERATOR(s))}return t},a.DICT=function(e){return o.DICT(e).length},o.OPERATOR=function(e){return e<1200?[e]:[12,e-1200]},o.OPERAND=function(e,t){var i=[];if(Array.isArray(t))for(var n=0;n<t.length;n+=1)r.argument(e.length===t.length,"Not enough arguments given for type"+t),i=i.concat(o.OPERAND(e[n],t[n]));else if("SID"===t)i=i.concat(o.NUMBER(e));else if("offset"===t)i=i.concat(o.NUMBER32(e));else if("number"===t)i=i.concat(o.NUMBER(e));else{if("real"!==t)throw new Error("Unknown operand type "+t);i=i.concat(o.REAL(e))}return i},o.OP=o.BYTE,a.OP=a.BYTE;var u="function"==typeof WeakMap&&new WeakMap;o.CHARSTRING=function(e){if(u&&u.has(e))return u.get(e);for(var t=[],i=e.length,n=0;n<i;n+=1){var r=e[n];t=t.concat(o[r.type](r.value))}return u&&u.set(e,t),t},a.CHARSTRING=function(e){return o.CHARSTRING(e).length},o.OBJECT=function(e){var t=o[e.type];return r.argument(void 0!==t,"No encoding function for type "+e.type),t(e.value)},a.OBJECT=function(e){var t=a[e.type];return r.argument(void 0!==t,"No sizeOf function for type "+e.type),t(e.value)},o.TABLE=function(e){for(var t=[],i=e.fields.length,n=0;n<i;n+=1){var s=e.fields[n],a=o[s.type];r.argument(void 0!==a,"No encoding function for field type "+s.type);var u=e[s.name];void 0===u&&(u=s.value);var l=a(u);t=t.concat(l)}return t},a.TABLE=function(e){for(var t=0,i=e.fields.length,n=0;n<i;n+=1){var s=e.fields[n],o=a[s.type];r.argument(void 0!==o,"No sizeOf function for field type "+s.type);var u=e[s.name];void 0===u&&(u=s.value),t+=o(u)}return t},o.LITERAL=function(e){return e},a.LITERAL=function(e){return e.length},i.decode=s,i.encode=o,i.sizeOf=a},{"./check":1}]},{},[7])(7)}),define("x_ite/Browser/Text/X3DTextContext",["jquery","x_ite/Components/Text/FontStyle","lib/opentype.js/dist/opentype"],function(e,t,i){"use strict";function n(){this.fontCache={},this.fontGeometryCache={}}return n.prototype={initialize:function(){},getDefaultFontStyle:function(){return this.defaultFontStyle||(this.defaultFontStyle=new t(this.getPrivateScene()),this.defaultFontStyle.setup()),this.defaultFontStyle},getFont:function(t,n,r){0!==t.query.length&&r("Font url with query not supported");var s=this.fontCache[t.filename];s||(s=this.fontCache[t.filename]=e.Deferred(),i.load(t.toString(),this.setFont.bind(this,t))),s.done(n),s.fail(r)},setFont:function(e,t,i){var n=this.fontCache[e.filename];if(t)n.reject(t);else{i.fontName=i.familyName+i.styleName;for(var r=0,s=i.numGlyphs;r<s;++r)i.glyphs.get(r).getPath(0,0,1);n.resolve(i)}},getFontGeometryCache:function(){return this.fontGeometryCache}},n}),define("x_ite/Components/Texturing/X3DTextureTransformNode",["x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4"],function(e,t,i){"use strict";function n(n){e.call(this,n),this.addType(t.X3DTextureTransformNode),this.matrix=new i,this.matrixArray=new Float32Array(this.matrix)}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,setMatrix:function(e){this.matrixArray.set(e)},getMatrix:function(){return this.matrix},setShaderUniforms:function(e,t){e.uniformMatrix4fv(t.x3d_TextureMatrix,!1,this.matrixArray)}}),n}),define("x_ite/Components/Texturing/TextureTransform",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Texturing/X3DTextureTransformNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2","standard/Math/Numbers/Matrix3"],function(e,t,i,n,r,s,o){"use strict";function a(e){n.call(this,e),this.addType(r.TextureTransform),this.rotation_.setUnit("angle"),this.matrix3=new o}var u=new s(0,0);return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"translation",new e.SFVec2f),new t(r.inputOutput,"rotation",new e.SFFloat),new t(r.inputOutput,"scale",new e.SFVec2f(1,1)),new t(r.inputOutput,"center",new e.SFVec2f)]),getTypeName:function(){return"TextureTransform"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"textureTransform"},initialize:function(){n.prototype.initialize.call(this),this.addInterest("eventsProcessed",this),this.eventsProcessed()},eventsProcessed:function(){n.prototype.eventsProcessed.call(this);var e=this.translation_.getValue(),t=this.rotation_.getValue(),i=this.scale_.getValue(),r=this.center_.getValue(),o=this.matrix3;o.identity(),r.equals(s.Zero)||o.translate(u.assign(r).negate()),i.equals(s.One)||o.scale(i),0!==t&&o.rotate(t),r.equals(s.Zero)||o.translate(r),e.equals(s.Zero)||o.translate(e);var a=this.getMatrix();a[0]=o[0],a[1]=o[1],a[4]=o[3],a[5]=o[4],a[12]=o[6],a[13]=o[7],this.setMatrix(a)}}),a}),define("x_ite/Browser/Texturing/X3DTexturingContext",["x_ite/Components/Texturing/TextureProperties","x_ite/Components/Texturing/TextureTransform","x_ite/Components/Texturing/TextureCoordinate"],function(e,t,i){"use strict";function n(){this.textureUnits=[],this.combinedTextureUnits=[],this.textureStages=1,this.defaultTextureProperties=new e(this.getPrivateScene()),this.defaultTextureTransform=new t(this.getPrivateScene()),this.defaultTextureCoordinate=new i(this.getPrivateScene())}return n.prototype={initialize:function(){var e=this.getBrowser().getContext();this.defaultTextureProperties.magnificationFilter_.setValue("NICEST"),this.defaultTextureProperties.minificationFilter_.setValue("AVG_PIXEL_AVG_MIPMAP"),this.defaultTextureProperties.textureCompression_.setValue("NICEST"),this.defaultTextureProperties.generateMipMaps_.setValue(!0),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this.maxTextureUnits=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),this.maxCombinedTextureUnits=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this.textureMemory=NaN;for(var t=this.textureUnits,i=this.combinedTextureUnits,n=this.maxTextureUnits-1;n>=0;--n)t.push(n);for(var n=this.maxTextureUnits,r=this.maxCombinedTextureUnits;n<r;++n)i.push(n);this.defaultTextureProperties.setup(),this.defaultTextureTransform.setup(),this.defaultTextureCoordinate.setup();var s=new Uint8Array([255,255,255,255]);this.defaultTexture2D=e.createTexture(),this.defaultComposedCubeMapTexture=e.createTexture(),this.defaultShadowMapTexture=e.createTexture(),e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,this.defaultTexture2D),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,s),e.activeTexture(e.TEXTURE4),e.bindTexture(e.TEXTURE_CUBE_MAP,this.defaultComposedCubeMapTexture),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_Z,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,s),e.texImage2D(e.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,s),e.texImage2D(e.TEXTURE_CUBE_MAP_NEGATIVE_X,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,s),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,s),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_Y,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,s),e.texImage2D(e.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,s),e.activeTexture(e.TEXTURE5),e.bindTexture(e.TEXTURE_2D,this.defaultShadowMapTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,s),e.activeTexture(e.TEXTURE0)},getMaxTextures:function(){return 1},getMinTextureSize:function(){return 16},getMaxTextureSize:function(){return this.maxTextureSize},getMaxTextureUnits:function(){return this.maxTextureUnits},getMaxCombinedTextureUnits:function(){return this.maxCombinedTextureUnits},getTextureUnits:function(){return this.textureUnits},getCombinedTextureUnits:function(){return this.combinedTextureUnits},getTextureMemory:function(){return this.textureMemory},getDefaultTextureProperties:function(){return this.defaultTextureProperties},getDefaultTextureTransform:function(){return this.defaultTextureTransform},getDefaultTextureCoordinate:function(){return this.defaultTextureCoordinate}},n}),define("x_ite/Browser/Time/X3DTimeContext",["standard/Math/Numbers/Vector3"],function(e){"use strict";function t(){this.currentPosition=new e(0,0,0)}var i=new e(0,0,0);return t.prototype={initialize:function(){this.advanceTime(performance.now())},getCurrentTime:function(){return this.currentTime},advanceTime:function(e){e=(e+performance.timing.navigationStart)/1e3;var t=e-this.currentTime;if(this.currentTime=e,this.currentFrameRate=t?1/t:60,this.getWorld()&&this.getActiveLayer()){var n=this.getActiveLayer().getViewpoint().getCameraSpaceMatrix();i.assign(this.currentPosition),this.currentPosition.set(n[12],n[13],n[14]),this.currentSpeed=i.subtract(this.currentPosition).abs()*this.currentFrameRate}else this.currentSpeed=0}},t}),define("standard/Math/Algorithms/QuickSort",[],function(){"use strict";function e(e,t){this.array=e,t&&(this.compare=t)}return e.prototype={compare:function(e,t){return e<t},sort:function(e,t){t-e>1&&this.quicksort(e,t-1)},quicksort:function(e,t){for(var i=e,n=t,r=this.array,s=this.compare,o=r[e+t>>>1];;){for(;s(r[i],o);)++i;for(;s(o,r[n]);)--n;if(!(i<n)){i===n&&(++i,--n);break}var a=r[i];r[i]=r[n],r[n]=a,i++,n--}e<n&&this.quicksort(e,n),i<t&&this.quicksort(i,t)}},e}),define("x_ite/Components/ParticleSystems/X3DParticleEmitterNode",["x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Geometry/Line3","standard/Math/Geometry/Plane3","standard/Math/Algorithm","standard/Math/Algorithms/QuickSort"],function(e,t,i,n,r,s,o,a){"use strict";function u(e,t){return f.getDistanceToPoint(e)<f.getDistanceToPoint(t)}function l(e,t){return e<f.getDistanceToPoint(t)}function h(i){e.call(this,i),this.addType(t.X3DParticleEmitterNode),this.speed_.setUnit("speed"),this.mass_.setUnit("mass"),this.surfaceArea_.setUnit("area"),this.rotations=[],this.intersections=[],this.intersectionNormals=[],this.sorter=new a(this.intersections,u)}var c=new i(0,0,0),d=new i(0,0,0),p=new r(i.Zero,i.zAxis),f=new s(i.Zero,i.zAxis);return h.prototype=Object.assign(Object.create(e.prototype),{constructor:h,initialize:function(){e.prototype.initialize.call(this),this.speed_.addInterest("set_speed__",this),this.variation_.addInterest("set_variation__",this),this.mass_.addInterest("set_mass__",this),this.set_speed__(),this.set_variation__(),this.set_mass__()},set_speed__:function(){this.speed=this.speed_.getValue()},set_variation__:function(){this.variation=this.variation_.getValue()},set_mass__:function(){this.mass=this.mass_.getValue()},isExplosive:function(){return!1},getMass:function(){return this.mass},getRandomLifetime:function(e,t){var i=e*t,n=Math.max(0,e-i),r=e+i;return Math.random()*(r-n)+n},getRandomSpeed:function(){var e=this.speed,t=e*this.variation,i=Math.max(0,e-t),n=e+t;return Math.random()*(n-i)+i},getSphericalRandomVelocity:function(e){return this.getRandomNormal(e).multiply(this.getRandomSpeed())},getRandomValue:function(e,t){return Math.random()*(t-e)+e},getRandomNormal:function(e){var t=this.getRandomValue(-1,1)*Math.PI,i=this.getRandomValue(-1,1),n=Math.acos(i),r=Math.sin(n);return e.set(Math.sin(t)*r,Math.cos(t)*r,i)},getRandomNormalWithAngle:function(e,t){var i=(2*Math.random()-1)*Math.PI,n=this.getRandomValue(Math.cos(e),1),r=Math.acos(n),s=Math.sin(r);return t.set(Math.sin(i)*s,Math.cos(i)*s,n)},getRandomNormalWithDirectionAndAngle:function(e,t,n){return rotation.setFromToVec(i.zAxis,e),rotation.multVecRot(this.getRandomNormalWithAngle(t,n))},getRandomSurfaceNormal:function(e){var t=this.getRandomValue(-1,1)*Math.PI,i=Math.pow(Math.random(),1/3),n=Math.acos(i),r=Math.sin(n);return e.set(Math.sin(t)*r,Math.cos(t)*r,i)},animate:function(e,t){for(var r=e.particles,s=e.numParticles,o=e.createParticles,a=e.particleLifetime,u=e.lifetimeVariation,l=e.speeds,h=e.velocities,p=e.turbulences,f=this.rotations,g=e.numForces,m=e.boundedVertices.length,_=e.boundedVolume,x=f.length;x<g;++x)f[x]=new n(0,0,1,0);for(var x=0;x<g;++x)f[x].setFromToVec(i.zAxis,h[x]);for(var x=0;x<s;++x){var y=r[x],v=y.elapsedTime+t;if(v>y.lifetime)y.lifetime=this.getRandomLifetime(a,u),y.elapsedTime=0,o?(++y.life,this.getRandomPosition(y.position),this.getRandomVelocity(y.velocity)):y.position.set(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);else{for(var w=y.position,b=y.velocity,S=0;S<g;++S)b.add(f[S].multVecRot(this.getRandomNormalWithAngle(p[S],c)).multiply(l[S]));m?(d.x=w.x,d.y=w.y,d.z=w.z,w.x+=b.x*t,w.y+=b.y*t,w.z+=b.z*t,this.bounce(_,d,w,b)):(w.x+=b.x*t,w.y+=b.y*t,w.z+=b.z*t),y.elapsedTime=v}}e.colorMaterial&&this.getColors(r,e.colorKeys,e.colorRamp,s)},bounce:function(e,t,i,n){c.assign(n).normalize(),p.set(t,c);var r=this.intersections,s=this.intersectionNormals,a=e.intersectsLine(p,r,s);if(a){for(var u=0;u<a;++u)r[u].index=u;f.set(t,c),this.sorter.sort(0,a);var h=o.upperBound(r,0,a,0,l);if(h<a){var d=r[h],g=s[d.index];if(f.set(d,g),f.getDistanceToPoint(t)*f.getDistanceToPoint(i)<0){var m=2*g.dot(n);n.x-=g.x*m,n.y-=g.y*m,n.z-=g.z*m,c.assign(n).normalize();var _=d.distance(t);i.x=d.x+c.x*_,i.y=d.y+c.y*_,i.z=d.z+c.z*_}}}},getColors:function(e,t,i,n){for(var r=t.length,s=0,a=0,u=0,l=0;l<n;++l){var h=e[l],c=h.elapsedTime/h.lifetime,d=h.color;if(1==r||c<=t[0])s=0,a=0,u=0;else if(c>=t[r-1])s=r-2,a=r-1,u=1;else{var p=o.upperBound(t,0,r,c,o.less);if(p<r){a=p,s=p-1;var f=t[s],g=t[a];u=o.clamp((c-f)/(g-f),0,1)}else s=0,a=0,u=0}var m=i[s],_=i[a];d.x=m.x+u*(_.x-m.x),d.y=m.y+u*(_.y-m.y),d.z=m.z+u*(_.z-m.z),d.w=m.w+u*(_.w-m.w)}}}),h}),define("x_ite/Components/ParticleSystems/PointEmitter",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/ParticleSystems/X3DParticleEmitterNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.PointEmitter),this.position_.setUnit("length"),this.speed_.setUnit("speed"),this.mass_.setUnit("mass"),this.surfaceArea_.setUnit("area"),this.direction=new s(0,0,0)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"position",new e.SFVec3f),new t(r.inputOutput,"direction",new e.SFVec3f(0,1,0)),new t(r.inputOutput,"speed",new e.SFFloat),new t(r.inputOutput,"variation",new e.SFFloat(.25)),new t(r.initializeOnly,"mass",new e.SFFloat),new t(r.initializeOnly,"surfaceArea",new e.SFFloat)]),getTypeName:function(){return"PointEmitter"},getComponentName:function(){return"ParticleSystems"},getContainerField:function(){return"emitter"},initialize:function(){n.prototype.initialize.call(this),this.position_.addInterest("set_position__",this),this.direction_.addInterest("set_direction__",this),this.set_position__(),this.set_direction__()},set_position__:function(){this.position=this.position_.getValue()},set_direction__:function(){this.direction.assign(this.direction_.getValue()).normalize(),this.direction.equals(s.Zero)?this.getRandomVelocity=this.getSphericalRandomVelocity:delete this.getRandomVelocity},getRandomPosition:function(e){return e.assign(this.position)},getRandomVelocity:function(e){var t=this.direction,i=this.getRandomSpeed();return e.x=t.x*i,e.y=t.y*i,e.z=t.z*i,e}}),o}),define("x_ite/Browser/ParticleSystems/X3DParticleSystemsContext",["x_ite/Components/ParticleSystems/PointEmitter"],function(e){"use strict";function t(){this.defaultEmitter=new e(this.getPrivateScene())}return t.prototype={initialize:function(){this.defaultEmitter.setup()},getDefaultEmitter:function(){return this.defaultEmitter}},t}),define("x_ite/Rendering/X3DRenderObject",["jquery","x_ite/Rendering/TextureBuffer","x_ite/Bits/TraverseType","standard/Math/Algorithm","standard/Math/Algorithms/MergeSort","standard/Math/Geometry/Camera","standard/Math/Geometry/Box3","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Utility/MatrixStack"],function(e,t,i,n,r,s,o,a,u,l,h,c,d){"use strict";function p(e,t){return e.distance<t.distance}function f(e){this.cameraSpaceMatrix=new d(c),this.inverseCameraSpaceMatrix=new d(c),this.projectionMatrix=new d(c),this.modelViewMatrix=new d(c),this.viewVolumes=[],this.shaderObjects=[],this.globalLights=[],this.lights=[],this.shadow=[!1],this.localFogs=[],this.layouts=[],this.generatedCubeMapTextures=[],this.shaders=new Map,this.collisions=[],this.numOpaqueShapes=0,this.numTransparentShapes=0,this.numCollisionShapes=0,this.numDepthShapes=0,this.opaqueShapes=[],this.transparentShapes=[],this.transparencySorter=new r(this.transparentShapes,p),this.collisionShapes=[],this.activeCollisions={},this.depthShapes=[],this.speed=0;try{this.depthBuffer=new t(e.getBrowser(),g,m)}catch(e){console.error(e),this.getDepth=function(){return 0}}}var g=16,m=g;return f.prototype={constructor:f,bboxSize:new u(0,0,0),bboxCenter:new u(0,0,0),translation:new u(0,0,0),initialize:function(){},isIndependent:function(){return!0},getCameraSpaceMatrix:function(){return this.cameraSpaceMatrix},getInverseCameraSpaceMatrix:function(){return this.inverseCameraSpaceMatrix},getProjectionMatrix:function(){return this.projectionMatrix},getModelViewMatrix:function(){return this.modelViewMatrix},getViewVolumes:function(){return this.viewVolumes},getViewVolume:function(){return this.viewVolumes[this.viewVolumes.length-1]},getShaderObjects:function(){return this.shaderObjects},getGlobalLights:function(){return this.globalLights},getLights:function(){return this.lights},pushShadow:function(e){this.shadow.unshift(e||this.shadow[0])},popShadow:function(e){this.shadow.pop()},setGlobalFog:function(e){var t=this.localFogs[0]||e.getFogs().pop();t.set(e,c.Identity),this.localFog=this.localFogs[0]=t},pushLocalFog:function(e){this.localFogs.push(e),this.localFog=e},popLocalFog:function(){var e=this.localFogs.pop();return this.localFog=this.localFogs[this.localFogs.length-1],e},getLayouts:function(){return this.layouts},getParentLayout:function(){return this.layouts.length?this.layouts[this.layouts.length-1]:null},getGeneratedCubeMapTextures:function(){return this.generatedCubeMapTextures},getShaders:function(){return this.shaders},getCollisions:function(){return this.collisions},setNumCollisionShapes:function(e){this.numCollisionShapes=e},getNumCollisionShapes:function(){return this.numCollisionShapes},getCollisionShapes:function(){return this.collisionShapes},setNumDepthShapes:function(e){this.numDepthShapes=e},getNumDepthShapes:function(){return this.numDepthShapes},getDepthShapes:function(){return this.depthShapes},setNumOpaqueShapes:function(e){this.numOpaqueShapes=e},getNumOpaqueShapes:function(){return this.numOpaqueShapes},getOpaqueShapes:function(){return this.opaqueShapes},setNumTransparentShapes:function(e){this.numTransparentShapes=e},getNumTransparentShapes:function(){return this.numTransparentShapes},getTransparentShapes:function(){return this.transparentShapes},constrainTranslation:function(e,t){var i=this.getDistance(e);if((i-=this.getNavigationInfo().getCollisionRadius())>0){return e.abs()>i?e.normalize().multiply(i):e}return t?this.constrainTranslation(e.normalize().multiply(i),!1):e.assign(u.Zero)},getDistance:function(){var e=new c,t=new c,i=new h(0,0,1,0),n=new u(0,0,0),r=new h(0,0,1,0);return function(o){try{var a=performance.now(),l=this.getViewpoint(),h=this.getNavigationInfo(),c=h.getCollisionRadius(),d=h.getStepHeight()-h.getAvatarHeight(),p=h.getNearValue(),f=h.getAvatarHeight();s.ortho(-c,c,Math.min(d,-c),c,p,Math.max(2*c,2*f),e),i.assign(l.orientation_.getValue()).inverse().multRight(l.getOrientation()),r.setFromToVec(u.zAxis,n.assign(o).negate()).multRight(i),l.straightenHorizon(r),t.assign(l.getModelMatrix()),t.translate(l.getUserPosition()),t.rotate(r),t.inverse(),t.multRight(e),t.multLeft(l.getCameraSpaceMatrix()),this.getProjectionMatrix().pushMatrix(t);var g=this.getDepth(e);return this.getProjectionMatrix().pop(),this.collisionTime+=performance.now()-a,-g}catch(e){console.log(e)}}}(),getDepth:function(){var e=new l(0,0,g,m),t=new a;return t.set(c.Identity,e,e),function(i){this.depthBuffer.bind(),this.viewVolumes.push(t),this.depth(this.collisionShapes,this.numCollisionShapes),this.viewVolumes.pop();var n=this.depthBuffer.getDepth(i,e);return this.depthBuffer.unbind(),n}}(),render:function(e,t){switch(e){case i.COLLISION:this.numCollisionShapes=0,t.traverse(e,this),this.collide(),this.gravite();break;case i.DEPTH:this.numDepthShapes=0,t.traverse(e,this),this.depth(this.depthShapes,this.numDepthShapes);break;case i.DISPLAY:this.lightIndex=0,this.numOpaqueShapes=0,this.numTransparentShapes=0,this.setGlobalFog(this.getFog()),t.traverse(e,this),this.draw(t)}},addCollisionShape:function(e){var t=this.getModelViewMatrix().get(),i=t.multDirMatrix(this.bboxSize.assign(e.getBBoxSize())),n=t.multVecMatrix(this.bboxCenter.assign(e.getBBoxCenter())),r=i.abs()/2,s=this.viewVolumes[this.viewVolumes.length-1];if(s.intersectsSphere(r,n)){this.numCollisionShapes===this.collisionShapes.length&&this.collisionShapes.push({renderer:this,modelViewMatrix:new Float32Array(16),collisions:[],clipPlanes:[]});var o=this.collisionShapes[this.numCollisionShapes];++this.numCollisionShapes,o.modelViewMatrix.set(t),o.shapeNode=e,o.scissor=s.getScissor();var a=o.collisions;a.length=0,Array.prototype.push.apply(a,this.collisions);var u=o.clipPlanes;return u.length=0,Array.prototype.push.apply(u,this.shaderObjects),!0}return!1},addDepthShape:function(e){var t=this.getModelViewMatrix().get(),i=t.multDirMatrix(this.bboxSize.assign(e.getBBoxSize())),n=t.multVecMatrix(this.bboxCenter.assign(e.getBBoxCenter())),r=i.abs()/2,s=this.viewVolumes[this.viewVolumes.length-1];if(s.intersectsSphere(r,n)){this.numDepthShapes===this.depthShapes.length&&this.depthShapes.push({renderer:this,modelViewMatrix:new Float32Array(16),clipPlanes:[]});var o=this.depthShapes[this.numDepthShapes];++this.numDepthShapes,o.modelViewMatrix.set(t),o.shapeNode=e,o.scissor=s.getScissor();var a=o.clipPlanes;return a.length=0,Array.prototype.push.apply(a,this.shaderObjects),!0}return!1},addDisplayShape:function(e){var t=this.getModelViewMatrix().get(),i=t.multDirMatrix(this.bboxSize.assign(e.getBBoxSize())),n=t.multVecMatrix(this.bboxCenter.assign(e.getBBoxCenter())),r=i.abs()/2,s=this.viewVolumes[this.viewVolumes.length-1];if(s.intersectsSphere(r,n)){if(e.isTransparent()){var o=this.numTransparentShapes;o===this.transparentShapes.length&&this.transparentShapes.push(this.createShapeContext(!0));var a=this.transparentShapes[o];++this.numTransparentShapes}else{var o=this.numOpaqueShapes;o===this.opaqueShapes.length&&this.opaqueShapes.push(this.createShapeContext(!1))
;var a=this.opaqueShapes[o];++this.numOpaqueShapes}a.modelViewMatrix.set(t),a.scissor.assign(s.getScissor()),a.shapeNode=e,a.distance=n.z-r,a.fogNode=this.localFog,a.shadow=this.shadow[0];var u=a.shaderObjects;return u.length=0,Array.prototype.push.apply(u,this.shaderObjects),!0}return!1},createShapeContext:function(e){return{renderer:this,transparent:e,geometryType:3,colorMaterial:!1,modelViewMatrix:new Float32Array(16),scissor:new l(0,0,0,0),shaderObjects:[],linePropertiesNode:null,materialNode:null,textureNode:null,textureTransformNode:null,shaderNode:null,shadow:!1}},collide:function(){var t=new c,i=new c,r=new o(u.Zero,u.Zero),s=new u(0,0,0);return function(){var o={},a=2.2*this.getNavigationInfo().getCollisionRadius();s.set(a,a,a);for(var l=0,h=this.numCollisionShapes;l<h;++l)try{var c=this.collisionShapes[l],d=c.collisions;if(d.length&&(r.set(s,u.Zero),r.multRight(t.assign(c.modelViewMatrix).inverse()),c.shapeNode.intersectsBox(r,c.clipPlanes,i.assign(c.modelViewMatrix))))for(var p=0;p<d.length;++p)o[d[p].getId()]=d[p]}catch(e){console.log(e)}if(!e.isEmptyObject(this.activeCollisions)){var f=e.isEmptyObject(o)?this.activeCollisions:n.set_difference(this.activeCollisions,o,{});for(var g in f)f[g].set_active(!1)}this.activeCollisions=o;for(var g in o)o[g].set_active(!0)}}(),gravite:function(){var e=new c,t=new c,i=new u(0,0,0),n=new h(0,0,1,0);return function(){try{if(this.getBrowser().getActiveLayer()===this){if("WALK"!==this.getBrowser().getCurrentViewer())return}else if("WALK"!==this.getNavigationInfo().getViewer())return;var r=this.getNavigationInfo(),o=this.getViewpoint(),a=r.getCollisionRadius(),l=r.getNearValue(),h=r.getAvatarHeight(),c=r.getStepHeight();s.ortho(-a,a,-a,a,l,Math.max(2*a,2*h),e);var d=o.getUpVector(),p=n.setFromToVec(u.zAxis,d);t.assign(o.getModelMatrix()),t.translate(o.getUserPosition()),t.rotate(p),t.inverse(),t.multRight(e),t.multLeft(o.getCameraSpaceMatrix()),this.getProjectionMatrix().pushMatrix(t);var f=-this.getDepth(e);this.getProjectionMatrix().pop(),f-=h;var g=n.setFromToVec(u.yAxis,d);if(f>0){var m=this.speed?this.getBrowser().getCurrentFrameRate():1e6;this.speed-=this.getBrowser().getBrowserOptions().Gravity_.getValue()/m;var _=this.speed/m;_<-f&&(_=-f,this.speed=0),o.positionOffset_=o.positionOffset_.getValue().add(g.multVecRot(i.set(0,_,0)))}else if(this.speed=0,(f=-f)>.01&&f<c){var _=this.constrainTranslation(g.multVecRot(this.translation.set(0,f,0)),!1);o.positionOffset_=_.add(o.positionOffset_.getValue())}}catch(e){console.log(e)}}}(),depth:function(){var e=new Float32Array(16);return function(t,i){var n=this.getBrowser(),r=n.getContext(),s=this.getViewVolume().getViewport(),o=n.getDepthShader();o.enable(r),e.set(this.getProjectionMatrix().get()),r.uniformMatrix4fv(o.x3d_ProjectionMatrix,!1,e),r.viewport(s[0],s[1],s[2],s[3]),r.scissor(s[0],s[1],s[2],s[3]),r.clearColor(1,0,0,0),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),r.enable(r.DEPTH_TEST),r.depthMask(!0),r.disable(r.BLEND),r.disable(r.CULL_FACE);for(var a=0;a<i;++a){var u=t[a],l=u.scissor;r.scissor(l.x,l.y,l.z,l.w),o.setShaderObjects(r,u.clipPlanes),r.uniformMatrix4fv(o.x3d_ModelViewMatrix,!1,u.modelViewMatrix),u.shapeNode.depth(r,u,o)}o.disable(r)}}(),draw:function(){var e=new Int32Array(4),t=new Float32Array(16),i=new Float32Array(16);return function(n){var r=this.getBrowser(),s=r.getContext(),o=this.getViewVolume().getViewport(),a=this.shaders,u=this.lights,l=this.generatedCubeMapTextures;if(this.isIndependent()){for(var h=0,c=u.length;h<c;++h)u[h].renderShadowMap(this);for(var h=0,c=l.length;h<c;++h)l[h].renderTexture(this,n)}r.getHeadlight().setGlobalVariables(this);for(var h=0,c=u.length;h<c;++h)u[h].setGlobalVariables(this);s.viewport(o[0],o[1],o[2],o[3]),s.scissor(o[0],o[1],o[2],o[3]),s.clear(s.DEPTH_BUFFER_BIT),this.getBackground().display(s,this,o),e.set(o),i.set(this.getCameraSpaceMatrix().get()),t.set(this.getProjectionMatrix().get()),r.getPointShader().setGlobalUniforms(s,this,i,t,e),r.getLineShader().setGlobalUniforms(s,this,i,t,e),r.getShadowShader().setGlobalUniforms(s,this,i,t,e);for(var d of a.values())d.setGlobalUniforms(s,this,i,t,e);s.enable(s.DEPTH_TEST),s.depthMask(!0),s.disable(s.BLEND);for(var h=0;h<this.numOpaqueShapes;++h){var p=this.opaqueShapes[h],f=p.scissor;s.scissor(f.x,f.y,f.z,f.w),p.shapeNode.display(s,p)}s.depthMask(!1),s.enable(s.BLEND),this.transparencySorter.sort(0,this.numTransparentShapes);for(var h=0;h<this.numTransparentShapes;++h){var p=this.transparentShapes[h],f=p.scissor;s.scissor(f.x,f.y,f.z,f.w),p.shapeNode.display(s,p)}if(s.depthMask(!0),s.disable(s.BLEND),s.activeTexture(s.TEXTURE0),l.length=0,a.clear(),this.isIndependent()){for(var g=this.getBrowser().getClipPlanes(),h=0,c=g.length;h<c;++h)g[h].dispose();g.length=0;for(var u=this.globalLights,h=0,c=u.length;h<c;++h)u[h].dispose();for(var u=this.getBrowser().getLocalLights(),h=0,c=u.length;h<c;++h)u[h].dispose();u.length=0;for(var m=this.getBrowser().getLocalFogs(),h=0,c=m.length;h<c;++h)m[h].dispose();m.length=0}this.globalLights.length=0,this.lights.length=0}}()},f}),define("x_ite/Execution/BindableStack",["x_ite/Basic/X3DBaseNode"],function(e){"use strict";function t(t,i,n){e.call(this,t),this.layer=i,this.array=[n]}return t.prototype=Object.assign(Object.create(e.prototype),{constructor:t,getTypeName:function(){return"BindableStack"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"bindableStack"},get:function(){return this.array},top:function(){return this.array[this.array.length-1]},forcePush:function(e){e.isBound_=!0,e.bindTime_=this.getBrowser().getCurrentTime(),this.push(e)},push:function(e){if(0!==this.array.length&&e!==this.array[0]){var t=this.top();e!==t&&(this.pushOnTop(e),t.isBound_.getValue()&&(t.set_bind_=!1,t.isBound_=!1),e.isBound_.getValue()||(e.isBound_=!0,e.bindTime_=this.getBrowser().getCurrentTime(),e.transitionStart(t)),this.pushOnTop(e),this.addNodeEvent())}},pushOnTop:function(e){var t=this.array.indexOf(e);t>-1&&this.array.splice(t,1),this.array.push(e)},remove:function(e){if(e!==this.array[0]){if(e===this.top())return this.pop(e);var t=this.array.indexOf(e);t>-1&&this.array.splice(t,1)}},pop:function(e){if(e!==this.array[0]){var t=this.top();if(e===t){if(e.isBound_.getValue()&&(e.isBound_=!1),0===this.array.length)return;this.array.pop(),t=this.top(),t.isBound_.getValue()||(t.set_bind_=!0,t.isBound_=!0,t.bindTime_=this.getBrowser().getCurrentTime(),t.transitionStart(e)),this.addNodeEvent()}}}}),t}),define("x_ite/Execution/BindableList",["x_ite/Basic/X3DBaseNode"],function(e){"use strict";function t(e,t){if(e.length!==t.length)return!1;for(var i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}function i(t,i,n){e.call(this,t),this.layer=i,this.collected=[n],this.array=[n]}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,getTypeName:function(){return"BindableList"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"bindableList"},get:function(){return this.array},getBound:function(e){if(this.array.length>1){var t=this.getMasterScene();if(e&&e.length)for(var i=1,n=this.array.length;i<n;++i){var r=this.array[i];if(r.getScene()===t&&r.getName()==e)return r}for(var i=1,n=this.array.length;i<n;++i){var r=this.array[i];if(r.getScene()===t&&r.isBound_.getValue())return r}for(var i=1,n=this.array.length;i<n;++i){var r=this.array[i];if(r.getScene()===t)return r}}return this.array[0]},push:function(e){return this.collected.push(e)},update:function(){if(!t(this.collected,this.array)){for(var e=0,i=this.array.length;e<i;++e){var n=this.array[e];this.collected.indexOf(n)<0&&n.isBound_.getValue()&&(n.set_bind_=!1)}var r=this.array;this.array=this.collected,this.collected=r}this.collected.length=1}}),i}),define("x_ite/Components/EnvironmentalEffects/X3DFogObject",["x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Utility/ObjectCache"],function(e,t,i){"use strict";function n(){this.center=new t(0,0,0)}function r(t){this.addType(e.X3DFogObject),this.visibilityRange_.setUnit("length"),this.hidden=!1}var s=i(n);return n.prototype={constructor:n,set:function(e,t){this.fogNode=e,this.center.assign(t.origin)},setShaderUniforms:function(e,t){var i=this.fogNode,n=Math.max(0,i.visibilityRange_.getValue());if(i.getHidden()||0===n)e.uniform1i(t.x3d_FogType,0);else{var r=i.color_.getValue(),s=this.center;e.uniform1i(t.x3d_FogType,i.fogType),e.uniform3f(t.x3d_FogColor,r.r,r.g,r.b),e.uniform3f(t.x3d_FogCenter,s.x,s.y,s.z),e.uniform1f(t.x3d_FogVisibilityRange,n)}},dispose:function(){s.push(this)}},r.prototype={constructor:r,initialize:function(){this.fogType_.addInterest("set_fogType__",this),this.set_fogType__()},set_fogType__:function(){switch(this.fogType_.getValue()){case"EXPONENTIAL":this.fogType=2;break;default:this.fogType=1}},setHidden:function(e){this.hidden=e,this.getBrowser().addBrowserEvent()},getHidden:function(){return this.hidden},getFogs:function(){return s}},r}),define("x_ite/Components/EnvironmentalEffects/Fog",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DBindableNode","x_ite/Components/EnvironmentalEffects/X3DFogObject","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s,o){"use strict";function a(e){n.call(this,e),r.call(this,e),this.addType(o.Fog)}return a.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:a,fieldDefinitions:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOnly,"set_bind",new e.SFBool),new t(o.inputOutput,"fogType",new e.SFString("LINEAR")),new t(o.inputOutput,"color",new e.SFColor(1,1,1)),new t(o.inputOutput,"visibilityRange",new e.SFFloat),new t(o.outputOnly,"isBound",new e.SFBool),new t(o.outputOnly,"bindTime",new e.SFTime)]),getTypeName:function(){return"Fog"},getComponentName:function(){return"EnvironmentalEffects"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this)},bindToLayer:function(e){e.getFogStack().push(this)},unbindFromLayer:function(e){e.getFogStack().pop(this)},removeFromLayer:function(e){e.getFogStack().remove(this)},traverse:function(e,t){t.getLayer().getFogs().push(this)}}),a}),define("x_ite/Components/EnvironmentalEffects/X3DBackgroundNode",["x_ite/Components/Core/X3DBindableNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Algorithm"],function(e,t,i,n,r,s,o,a,u){"use strict";function l(t){e.call(this,t),this.addType(i.X3DBackgroundNode),this.skyAngle_.setUnit("angle"),this.groundAngle_.setUnit("angle"),this.hidden=!1,this.projectionMatrixArray=new Float32Array(16),this.modelMatrix=new a,this.modelViewMatrixArray=new Float32Array(16),this.shaderObjects=[],this.colors=[],this.sphere=[],this.textures=0}var h=Math.sqrt(.5),c=h,d=[1,1,0,1,0,1,0,1,0,0,0,1,1,1,0,1,0,0,0,1,1,0,0,1],p=[c,c,-c,1,-c,c,-c,1,-c,-c,-c,1,c,c,-c,1,-c,-c,-c,1,c,-c,-c,1],f=[-c,c,c,1,c,c,c,1,c,-c,c,1,-c,c,c,1,c,-c,c,1,-c,-c,c,1],g=[-c,c,-c,1,-c,c,c,1,-c,-c,c,1,-c,c,-c,1,-c,-c,c,1,-c,-c,-c,1],m=[c,c,c,1,c,c,-c,1,c,-c,-c,1,c,c,c,1,c,-c,-c,1,c,-c,c,1],_=[c,c,c,1,-c,c,c,1,-c,c,-c,1,c,c,c,1,-c,c,-c,1,c,c,-c,1],x=[c,-c,-c,1,-c,-c,-c,1,-c,-c,c,1,c,-c,-c,1,-c,-c,c,1,c,-c,c,1],y=new r(0,0),v=new r(0,0),w=new r(0,0),b=new r(0,0),S=new r(0,0),C=new r(0,0);return l.prototype=Object.assign(Object.create(e.prototype),{constructor:l,initialize:function(){e.prototype.initialize.call(this);var t=this.getBrowser().getContext();this.colorBuffer=t.createBuffer(),this.sphereBuffer=t.createBuffer(),this.texCoordBuffer=t.createBuffer(),this.cubeBuffer=t.createBuffer(),this.texCoordBuffers=[t.createBuffer()],this.frontBuffer=t.createBuffer(),this.backBuffer=t.createBuffer(),this.leftBuffer=t.createBuffer(),this.rightBuffer=t.createBuffer(),this.topBuffer=t.createBuffer(),this.bottomBuffer=t.createBuffer(),this.groundAngle_.addInterest("build",this),this.groundColor_.addInterest("build",this),this.skyAngle_.addInterest("build",this),this.skyColor_.addInterest("build",this),this.transparency_.addInterest("build",this),this.build(),this.transferRectangle()},set_frontTexture__:function(e){this.setTexture("frontTexture",e,0)},set_backTexture__:function(e){this.setTexture("backTexture",e,1)},set_leftTexture__:function(e){this.setTexture("leftTexture",e,2)},set_rightTexture__:function(e){this.setTexture("rightTexture",e,3)},set_topTexture__:function(e){this.setTexture("topTexture",e,4)},set_bottomTexture__:function(e){this.setTexture("bottomTexture",e,5)},setTexture:function(e,t,i){this[e]&&this[e].loadState_.removeInterest("setTextureBit",this),this[e]=t,t?(t.loadState_.addInterest("setTextureBit",this,i),this.setTextureBit(t.loadState_,i)):this.textures&=~(1<<i)},setTextureBit:function(e,t){e.getValue()===i.COMPLETE_STATE?this.textures|=1<<t:this.textures&=~(1<<t)},bindToLayer:function(e){e.getBackgroundStack().push(this)},unbindFromLayer:function(e){e.getBackgroundStack().pop(this)},removeFromLayer:function(e){e.getBackgroundStack().remove(this)},setHidden:function(e){this.hidden=e,this.getBrowser().addBrowserEvent()},getHidden:function(){return this.hidden},isTransparent:function(){return!!this.hidden||0!==this.transparency_.getValue()&&(!(this.frontTexture&&!this.frontTexture.transparent_.getValue())||(!(this.backTexture&&!this.backTexture.transparent_.getValue())||(!(this.leftTexture&&!this.leftTexture.transparent_.getValue())||(!(this.rightTexture&&!this.rightTexture.transparent_.getValue())||(!(this.topTexture&&!this.topTexture.transparent_.getValue())||!(this.bottomTexture&&!this.bottomTexture.transparent_.getValue()))))))},getColor:function(e,t,i){return t[u.upperBound(i,0,i.length,e,u.less)]},build:function(){if(this.colors.length=0,this.sphere.length=0,!(this.transparency_.getValue()>=1)){var e=1-u.clamp(this.transparency_.getValue(),0,1);if(0===this.groundColor_.length&&1==this.skyColor_.length){var t=h;this.sphere.vertices=36,this.sphere.push(t,t,-t,1,-t,t,-t,1,-t,-t,-t,1,t,t,-t,1,-t,-t,-t,1,t,-t,-t,1,-t,t,t,1,t,t,t,1,-t,-t,t,1,-t,-t,t,1,t,t,t,1,t,-t,t,1,-t,t,-t,1,-t,t,t,1,-t,-t,t,1,-t,t,-t,1,-t,-t,t,1,-t,-t,-t,1,t,t,t,1,t,t,-t,1,t,-t,t,1,t,-t,t,1,t,t,-t,1,t,-t,-t,1,t,t,t,1,-t,t,t,1,-t,t,-t,1,t,t,t,1,-t,t,-t,1,t,t,-t,1,-t,-t,t,1,t,-t,t,1,-t,-t,-t,1,-t,-t,-t,1,t,-t,t,1,t,-t,-t,1);for(var i=this.skyColor_[0],n=0,r=this.sphere.vertices;n<r;++n)this.colors.push(i.r,i.g,i.b,e)}else{if(this.skyColor_.length>this.skyAngle_.length){for(var s=[],n=0,o=this.skyAngle_.length;n<o;++n)s.push(this.skyAngle_[n]);(0===s.length||s[0]>0)&&s.unshift(0);var a=this.groundColor_.length>this.groundAngle_.length?Math.PI/2:Math.PI;s[s.length-1]<a&&s.push(a),this.buildSphere(1,s,this.skyAngle_,this.skyColor_,e,!1)}if(this.groundColor_.length>this.groundAngle_.length){for(var s=[],n=0,o=this.groundAngle_.length;n<o;++n)s.push(this.groundAngle_[n]);s.reverse(),(0===s.length||s[0]<Math.PI/2)&&s.unshift(Math.PI/2),s[s.length-1]>0&&s.push(0),this.buildSphere(1,s,this.groundAngle_,this.groundColor_,e,!0)}}this.transferSphere()}},buildSphere:function(e,t,i,n,r,s){for(var o=0,a=s?Math.PI/2:Math.PI,l=t.length-1,h=0;h<l;++h){var c=u.clamp(t[h],0,a),d=u.clamp(t[h+1],0,a);s&&(c=Math.PI-c,d=Math.PI-d),y.setPolar(e,c),v.setPolar(e,d);for(var p=this.getColor(t[h],n,i),f=this.getColor(t[h+1],n,i),g=0;g<20;++g){var m=g<19?g+1:0;o=2*Math.PI*(g/20),w.setPolar(-y.imag,o),b.setPolar(-v.imag,o),o=2*Math.PI*(m/20),S.setPolar(-v.imag,o),C.setPolar(-y.imag,o),this.colors.push(p.r,p.g,p.b,r,f.r,f.g,f.b,r,f.r,f.g,f.b,r,p.r,p.g,p.b,r,p.r,p.g,p.b,r,f.r,f.g,f.b,r),this.sphere.push(w.imag,y.real,w.real,1,S.imag,v.real,S.real,1,b.imag,v.real,b.real,1,w.imag,y.real,w.real,1,C.imag,y.real,C.real,1,S.imag,v.real,S.real,1)}}},transferSphere:function(){var e=this.getBrowser().getContext();e.bindBuffer(e.ARRAY_BUFFER,this.colorBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.colors),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.sphereBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.sphere),e.STATIC_DRAW),this.sphereCount=this.sphere.length/4},transferRectangle:function(){var e=this.getBrowser().getContext();e.bindBuffer(e.ARRAY_BUFFER,this.texCoordBuffers[0]),e.bufferData(e.ARRAY_BUFFER,new Float32Array(d),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.frontBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(p),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.backBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(f),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.leftBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(g),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.rightBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(m),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.topBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(_),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.bottomBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(x),e.STATIC_DRAW)},traverse:function(e,i){switch(e){case t.CAMERA:i.getLayer().getBackgrounds().push(this),this.modelMatrix.assign(i.getModelViewMatrix().get());break;case t.DISPLAY:for(var n=i.getShaderObjects(),r=this.shaderObjects,s=0,o=n.length;s<o;++s)r[s]=n[s];r.length=n.length}},display:function(){var e=new a,t=new a,i=new o,r=new s(0,0,0),u=new s(0,0,0);return function(s,o,a){try{if(this.hidden)return;s.disable(s.DEPTH_TEST),s.depthMask(!1),s.enable(s.CULL_FACE),s.frontFace(s.CCW);var l=(o.getViewpoint(),o.getNavigationInfo(),.8*-n.unProjectPointMatrix(0,0,1,e.assign(o.getProjectionMatrix().get()).inverse(),a,u).z);this.projectionMatrixArray.set(o.getProjectionMatrix().get()),t.assign(this.modelMatrix),t.multRight(o.getInverseCameraSpaceMatrix().get()),t.get(null,i),t.identity(),t.rotate(i),t.scale(r.set(l,l,l)),this.modelViewMatrixArray.set(t),this.drawSphere(o),this.textures&&this.drawCube(o)}catch(e){}}}(),drawSphere:function(e){var t=this.transparency_.getValue();if(!(t>=1)){var i=e.getBrowser(),n=i.getContext(),r=i.getBackgroundSphereShader();r.enable(n),r.setShaderObjects(n,this.shaderObjects),r.enableColorAttribute(n,this.colorBuffer),r.enableVertexAttribute(n,this.sphereBuffer),n.uniformMatrix4fv(r.x3d_ProjectionMatrix,!1,this.projectionMatrixArray),n.uniformMatrix4fv(r.x3d_ModelViewMatrix,!1,this.modelViewMatrixArray),t?n.enable(n.BLEND):n.disable(n.BLEND),n.drawArrays(n.TRIANGLES,0,this.sphereCount),r.disableColorAttribute(n),r.disable(n)}},drawCube:function(){var e=new Float32Array(new a);return function(t){var i=t.getBrowser(),n=i.getContext(),r=i.getGouraudShader();r.enable(n),r.setShaderObjects(n,this.shaderObjects),r.enableTexCoordAttribute(n,this.texCoordBuffers),n.uniform1i(r.x3d_FogType,0),n.uniform1i(r.x3d_ColorMaterial,!1),n.uniform1i(r.x3d_Lighting,!1),n.uniformMatrix4fv(r.x3d_TextureMatrix,!1,e),n.uniformMatrix4fv(r.x3d_ProjectionMatrix,!1,this.projectionMatrixArray),n.uniformMatrix4fv(r.x3d_ModelViewMatrix,!1,this.modelViewMatrixArray),this.drawRectangle(n,r,this.frontTexture,this.frontBuffer),this.drawRectangle(n,r,this.backTexture,this.backBuffer),this.drawRectangle(n,r,this.leftTexture,this.leftBuffer),this.drawRectangle(n,r,this.rightTexture,this.rightBuffer),this.drawRectangle(n,r,this.topTexture,this.topBuffer),this.drawRectangle(n,r,this.bottomTexture,this.bottomBuffer),r.disableTexCoordAttribute(n),r.disable(n)}}(),drawRectangle:function(e,t,n,r){n&&n.checkLoadState()===i.COMPLETE_STATE&&(n.setShaderUniforms(e,t,0),n.transparent_.getValue()?e.enable(e.BLEND):e.disable(e.BLEND),t.enableVertexAttribute(e,r),e.drawArrays(e.TRIANGLES,0,6))}}),l}),define("x_ite/Components/Texturing/X3DTextureNode",["x_ite/Fields","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Bits/X3DConstants"],function(e,t,i){"use strict";function n(n){t.call(this,n),this.addType(i.X3DTextureNode),this.addChildObjects("transparent",new e.SFBool),this.transparent_.setAccessType(i.outputOnly)}var r=["EXT_texture_filter_anisotropic","MOZ_EXT_texture_filter_anisotropic","WEBKIT_EXT_texture_filter_anisotropic"];return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,initialize:function(){t.prototype.initialize.call(this);var e=this.getBrowser().getContext();this.texture=e.createTexture()},getTexture:function(){return this.texture},updateTextureProperties:function(e,t,i,n,s,o,a,u){var l=this.getBrowser().getContext();l.bindTexture(e,this.getTexture()),Math.max(n,s)<this.getBrowser().getMinTextureSize()&&!t?(l.texParameteri(e,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(e,l.TEXTURE_MAG_FILTER,l.NEAREST)):(i.generateMipMaps_.getValue()&&l.generateMipmap(e),l.texParameteri(e,l.TEXTURE_MIN_FILTER,l[i.getMinificationFilter()]),l.texParameteri(e,l.TEXTURE_MAG_FILTER,l[i.getMagnificationFilter()])),t?(l.texParameteri(e,l.TEXTURE_WRAP_S,l[i.getBoundaryModeS()]),l.texParameteri(e,l.TEXTURE_WRAP_T,l[i.getBoundaryModeT()])):(l.texParameteri(e,l.TEXTURE_WRAP_S,o?l.REPEAT:l.CLAMP_TO_EDGE),l.texParameteri(e,l.TEXTURE_WRAP_T,a?l.REPEAT:l.CLAMP_TO_EDGE));for(var h=0;h<r.length;++h){var c=l.getExtension(r[h]);if(c){l.texParameterf(e,c.TEXTURE_MAX_ANISOTROPY_EXT,i.anisotropicDegree_.getValue());break}}}}),n}),define("x_ite/Components/Texturing/X3DTexture2DNode",["x_ite/Fields","x_ite/Components/Texturing/X3DTextureNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(e,t,i,n){"use strict";function r(e){t.call(this,e),this.addType(n.X3DTexture2DNode),this.width=0,this.height=0,this.flipY=!1,this.data=null}var s=new Uint8Array([255,255,255,255]);return r.prototype=Object.assign(Object.create(t.prototype),{constructor:r,initialize:function(){t.prototype.initialize.call(this);var e=this.getBrowser().getContext();this.target=e.TEXTURE_2D,this.repeatS_.addInterest("updateTextureProperties",this),this.repeatT_.addInterest("updateTextureProperties",this),this.textureProperties_.addInterest("set_textureProperties__",this),e.bindTexture(e.TEXTURE_2D,this.getTexture()),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,s),this.set_textureProperties__()},set_textureProperties__:function(){this.texturePropertiesNode&&this.texturePropertiesNode.removeInterest("updateTextureProperties",this),this.texturePropertiesNode=i(n.TextureProperties,this.textureProperties_),this.texturePropertiesNode||(this.texturePropertiesNode=this.getBrowser().getDefaultTextureProperties()),this.texturePropertiesNode.addInterest("updateTextureProperties",this),this.updateTextureProperties()},getTarget:function(){return this.target},getWidth:function(){return this.width},getHeight:function(){return this.height},getFlipY:function(){return this.flipY},getData:function(){return this.data},setTexture:function(e,t,i,n,r){try{this.transparent_=i,this.width=e,this.height=t,this.flipY=r,this.data=n;var s=this.getBrowser().getContext();s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,r),s.pixelStorei(s.UNPACK_ALIGNMENT,1),s.bindTexture(s.TEXTURE_2D,this.getTexture()),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,e,t,0,s.RGBA,s.UNSIGNED_BYTE,n),this.updateTextureProperties(),this.addNodeEvent()}catch(e){}},clearTexture:function(){this.setTexture(1,1,!1,s,!1)},updateTexture:function(e,t){try{this.data=e;var i=this.getBrowser().getContext();i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,t),i.bindTexture(i.TEXTURE_2D,this.getTexture()),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,e),this.texturePropertiesNode.generateMipMaps_.getValue()&&i.generateMipmap(i.TEXTURE_2D),this.addNodeEvent()}catch(e){}},updateTextureProperties:function(){var e=this.getBrowser().getContext();t.prototype.updateTextureProperties.call(this,e.TEXTURE_2D,this.textureProperties_.getValue(),this.texturePropertiesNode,this.width,this.height,this.repeatS_.getValue(),this.repeatT_.getValue(),!1)},resize:function(e,t,i,n,r){for(var s=new Uint8Array(n*r*4),o=n/t,a=r/i,u=0;u<r;++u)for(var l=Math.floor(u/a)*t,h=u*n,c=0;c<n;++c){var d=4*(l+Math.floor(c/o)),p=4*(h+c);s[p]=e[d],s[p+1]=e[d+1],s[p+2]=e[d+2],s[p+3]=e[d+3]}return s},setShaderUniforms:function(e,t,i){t.textureTypeArray[i]=2,e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,this.getTexture()),e.uniform1iv(t.x3d_TextureType,t.textureTypeArray)}}),r}),define("x_ite/Components/Texturing/ImageTexture",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Texturing/X3DTexture2DNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Bits/X3DConstants","x_ite/Browser/Networking/urls","standard/Networking/URI","standard/Math/Algorithm","x_ite/DEBUG"],function(e,t,i,n,r,s,o,a,u,l,h){"use strict";function c(e){r.call(this,e),s.call(this,e),this.addType(o.ImageTexture),this.addChildObjects("buffer",new t.SFTime),this.urlStack=new t.MFString}return c.prototype=Object.assign(Object.create(r.prototype),s.prototype,{constructor:c,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new t.SFNode),new i(o.inputOutput,"url",new t.MFString),new i(o.initializeOnly,"repeatS",new t.SFBool(!0)),new i(o.initializeOnly,"repeatT",new t.SFBool(!0)),new i(o.initializeOnly,"textureProperties",new t.SFNode)]),getTypeName:function(){return"ImageTexture"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texture"},initialize:function(){r.prototype.initialize.call(this),s.prototype.initialize.call(this),this.url_.addInterest("set_url__",this),this.buffer_.addInterest("set_buffer__",this),this.canvas=e("<canvas></canvas>"),this.image=e("<img></img>"),this.image.on("load",this.setImage.bind(this)),this.image.on("error",this.setError.bind(this)),this.image.bind("abort",this.setError.bind(this)),this.image[0].crossOrigin="Anonymous",this.set_url__()},set_url__:function(){this.setLoadState(o.NOT_STARTED_STATE),this.requestAsyncLoad()},requestAsyncLoad:function(){this.checkLoadState()!==o.COMPLETE_STATE&&this.checkLoadState()!==o.IN_PROGRESS_STATE&&(this.setLoadState(o.IN_PROGRESS_STATE),this.buffer_.addEvent())},set_buffer__:function(){this.urlStack.setValue(this.url_),this.loadNext()},loadNext:function(){if(0===this.urlStack.length)return this.clearTexture(),void this.setLoadState(o.FAILED_STATE);this.URL=new u(this.urlStack.shift()),this.URL=this.getExecutionContext().getURL().transform(this.URL),this.image.attr("src",this.URL)},setError:function(){var e=this.URL.toString();h&&(this.URL.isLocal()||"localhost"===this.URL.host||e.match(a.fallbackExpression)||this.urlStack.unshift(a.fallbackUrl+e)),"data"!==this.URL.scheme&&console.warn("Error loading image:",this.URL.toString()),this.loadNext()},setImage:function(){h&&"data"!==this.URL.scheme&&console.info("Done loading image:",this.URL.toString());try{var e=this.image[0],t=e.width,i=e.height,n=this.canvas[0],r=n.getContext("2d");l.isPowerOfTwo(t)&&l.isPowerOfTwo(i)?(n.width=t,n.height=i,r.clearRect(0,0,t,i),r.save(),r.translate(0,i),r.scale(1,-1),r.drawImage(e,0,0),r.restore()):(t=l.nextPowerOfTwo(t),i=l.nextPowerOfTwo(i),n.width=t,n.height=i,r.clearRect(0,0,t,i),r.save(),r.translate(0,i),r.scale(1,-1),r.drawImage(e,0,0,e.width,e.height,0,0,t,i),r.restore());var s=r.getImageData(0,0,t,i).data,a=!0;n.width=1,n.height=1;for(var u=3;u<s.length;u+=4)if(255!==s[u]){a=!1;break}setTimeout(function(){this.setTexture(t,i,!a,new Uint8Array(s),!1),this.setLoadState(o.COMPLETE_STATE)}.bind(this),16)}catch(e){console.log(e.message),this.setError()}}}),c}),define("x_ite/Components/EnvironmentalEffects/Background",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/EnvironmentalEffects/X3DBackgroundNode","x_ite/Components/Texturing/ImageTexture","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(s.Background)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOnly,"set_bind",new e.SFBool),new t(s.inputOutput,"frontUrl",new e.MFString),new t(s.inputOutput,"backUrl",new e.MFString),new t(s.inputOutput,"leftUrl",new e.MFString),new t(s.inputOutput,"rightUrl",new e.MFString),new t(s.inputOutput,"topUrl",new e.MFString),new t(s.inputOutput,"bottomUrl",new e.MFString),new t(s.inputOutput,"skyAngle",new e.MFFloat),new t(s.inputOutput,"skyColor",new e.MFColor(new e.SFColor)),new t(s.inputOutput,"groundAngle",new e.MFFloat),new t(s.inputOutput,"groundColor",new e.MFColor),new t(s.inputOutput,"transparency",new e.SFFloat),new t(s.outputOnly,"isBound",new e.SFBool),new t(s.outputOnly,"bindTime",new e.SFTime)]),getTypeName:function(){return"Background"},getComponentName:function(){return"EnvironmentalEffects"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this);var e=new r(this.getExecutionContext()),t=new r(this.getExecutionContext()),i=new r(this.getExecutionContext()),s=new r(this.getExecutionContext()),o=new r(this.getExecutionContext()),a=new r(this.getExecutionContext()),u=this.getBrowser().getBackgroundTextureProperties();this.frontUrl_.addFieldInterest(e.url_),this.backUrl_.addFieldInterest(t.url_),this.leftUrl_.addFieldInterest(i.url_),this.rightUrl_.addFieldInterest(s.url_),this.topUrl_.addFieldInterest(o.url_),this.bottomUrl_.addFieldInterest(a.url_),e.url_=this.frontUrl_,t.url_=this.backUrl_,i.url_=this.leftUrl_,s.url_=this.rightUrl_,o.url_=this.topUrl_,a.url_=this.bottomUrl_,e.textureProperties_=u,t.textureProperties_=u,i.textureProperties_=u,s.textureProperties_=u,o.textureProperties_=u,a.textureProperties_=u,e.setup(),t.setup(),i.setup(),s.setup(),o.setup(),a.setup(),this.set_frontTexture__(e),this.set_backTexture__(t),this.set_leftTexture__(i),this.set_rightTexture__(s),this.set_topTexture__(o),this.set_bottomTexture__(a)}}),o}),define("x_ite/Components/Layering/X3DLayerNode",["x_ite/Components/Core/X3DNode","x_ite/Rendering/X3DRenderObject","x_ite/Components/Layering/X3DViewportNode","x_ite/Execution/BindableStack","x_ite/Execution/BindableList","x_ite/Components/Navigation/NavigationInfo","x_ite/Components/EnvironmentalEffects/Fog","x_ite/Components/EnvironmentalEffects/Background","x_ite/Bits/X3DCast","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Geometry/Camera","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r,s,o,a,u,l,h,c,d,p){"use strict";function f(i,u,l){e.call(this,i),t.call(this,i),this.addType(h.X3DLayerNode),this.groupNode=l,this.currentViewport=null,this.defaultBackground=new a(i),this.defaultFog=new o(i),this.defaultNavigationInfo=new s(i),this.defaultViewpoint=u,this.backgroundStack=new n(i,this,this.defaultBackground),this.fogStack=new n(i,this,this.defaultFog),this.navigationInfoStack=new n(i,this,this.defaultNavigationInfo),this.viewpointStack=new n(i,this,this.defaultViewpoint),this.backgrounds=new r(i,this,this.defaultBackground),this.fogs=new r(i,this,this.defaultFog),this.navigationInfos=new r(i,this,this.defaultNavigationInfo),this.viewpoints=new r(i,this,this.defaultViewpoint),this.defaultBackground.setHidden(!0),this.defaultFog.setHidden(!0),this.collisionTime=0}var g=new p;return f.prototype=Object.assign(Object.create(e.prototype),t.prototype,{constructor:f,layer0:!1,initialize:function(){e.prototype.initialize.call(this),t.prototype.initialize.call(this),this.groupNode.children_=this.children_,this.groupNode.setPrivate(!0),this.groupNode.setup(),this.defaultNavigationInfo.setup(),this.defaultBackground.setup(),this.defaultFog.setup(),this.defaultViewpoint.setup(),this.backgroundStack.setup(),this.fogStack.setup(),this.navigationInfoStack.setup(),this.viewpointStack.setup(),this.backgrounds.setup(),this.fogs.setup(),this.navigationInfos.setup(),this.viewpoints.setup(),this.viewport_.addInterest("set_viewport__",this),this.addChildren_.addFieldInterest(this.groupNode.addChildren_),this.removeChildren_.addFieldInterest(this.groupNode.removeChildren_),this.children_.addFieldInterest(this.groupNode.children_),this.set_viewport__()},isLayer0:function(e){this.layer0=e,
this.defaultBackground.setHidden(!e)},getLayer:function(){return this},getGroup:function(){return this.groupNode},getViewport:function(){return this.currentViewport},getBackground:function(){return this.backgroundStack.top()},getFog:function(){return this.fogStack.top()},getNavigationInfo:function(){return this.navigationInfoStack.top()},getViewpoint:function(){return this.viewpointStack.top()},getBackgrounds:function(){return this.backgrounds},getFogs:function(){return this.fogs},getNavigationInfos:function(){return this.navigationInfos},getViewpoints:function(){return this.viewpoints},getUserViewpoints:function(){for(var e=[],t=0;t<this.viewpoints.get().length;++t){var i=this.viewpoints.get()[t];i.description_.length&&e.push(i)}return e},getBackgroundStack:function(){return this.backgroundStack},getFogStack:function(){return this.fogStack},getNavigationInfoStack:function(){return this.navigationInfoStack},getViewpointStack:function(){return this.viewpointStack},getBBox:function(e){return this.groupNode.getBBox(e)},set_viewport__:function(){this.currentViewport=u(h.X3DViewportNode,this.viewport_),this.currentViewport||(this.currentViewport=this.getBrowser().getDefaultViewport())},bind:function(e){this.traverse(l.CAMERA,this);var t=this.navigationInfos.getBound(),i=this.backgrounds.getBound(),n=this.fogs.getBound(),r=this.viewpoints.getBound(e);this.navigationInfoStack.forcePush(t),this.backgroundStack.forcePush(i),this.fogStack.forcePush(n),this.viewpointStack.forcePush(r),t.addLayer(this),i.addLayer(this),n.addLayer(this),r.addLayer(this),r.resetUserOffsets()},traverse:function(e,t){t=t||this;var i=this.getViewpoint();switch(this.getCameraSpaceMatrix().pushMatrix(i.getCameraSpaceMatrix()),this.getInverseCameraSpaceMatrix().pushMatrix(i.getInverseCameraSpaceMatrix()),this.getProjectionMatrix().pushMatrix(i.getProjectionMatrix(this)),e){case l.POINTER:this.pointer(e,t);break;case l.CAMERA:this.camera(e,t);break;case l.COLLISION:this.collision(e,t);break;case l.DEPTH:case l.DISPLAY:this.display(e,t)}this.getProjectionMatrix().pop(),this.getInverseCameraSpaceMatrix().pop(),this.getCameraSpaceMatrix().pop()},pointer:function(e,t){if(this.isPickable_.getValue()){var i=this.getBrowser(),n=this.currentViewport.getRectangle(i);if(i.getSelectedLayer()){if(i.getSelectedLayer()!==this)return}else if(!i.isPointerInRectangle(n))return;i.setHitRay(this.getProjectionMatrix().get(),n),this.getModelViewMatrix().pushMatrix(this.getInverseCameraSpaceMatrix().get()),this.currentViewport.push(this),this.groupNode.traverse(e,t),this.currentViewport.pop(this),this.getModelViewMatrix().pop()}},camera:function(e,t){this.getModelViewMatrix().pushMatrix(p.Identity),this.currentViewport.push(this),this.groupNode.traverse(e,t),this.currentViewport.pop(this),this.navigationInfos.update(),this.backgrounds.update(),this.fogs.update(),this.viewpoints.update(),this.getViewpoint().update(),this.getModelViewMatrix().pop()},collision:function(e,t){var i=this.getNavigationInfo();if(!i.transitionActive_.getValue()){var n=i.getCollisionRadius(),r=i.getAvatarHeight(),s=Math.max(2*n,2*r);this.collisionTime=0,c.ortho(-s,s,-s,s,-s,s,g),this.getProjectionMatrix().pushMatrix(g),this.getModelViewMatrix().pushMatrix(this.getInverseCameraSpaceMatrix().get()),this.currentViewport.push(this),t.render(e,this.groupNode),this.currentViewport.pop(this),this.getModelViewMatrix().pop(),this.getProjectionMatrix().pop()}},display:function(e,t){this.getNavigationInfo().enable(e,t),this.getModelViewMatrix().pushMatrix(this.getInverseCameraSpaceMatrix().get()),this.currentViewport.push(this),t.render(e,this.groupNode),this.currentViewport.pop(this),this.getModelViewMatrix().pop()}}),f}),define("x_ite/Components/Grouping/Group",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.Group)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(r.initializeOnly,"bboxCenter",new e.SFVec3f),new t(r.inputOnly,"addChildren",new e.MFNode),new t(r.inputOnly,"removeChildren",new e.MFNode),new t(r.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"Group"},getComponentName:function(){return"Grouping"},getContainerField:function(){return"children"}}),s}),define("x_ite/Components/Layering/Layer",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Layering/X3DLayerNode","x_ite/Components/Navigation/Viewpoint","x_ite/Components/Grouping/Group","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s,o){"use strict";function a(e){n.call(this,e,new r(e),new s(e)),this.addType(o.Layer)}return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,fieldDefinitions:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"isPickable",new e.SFBool(!0)),new t(o.inputOutput,"viewport",new e.SFNode),new t(o.inputOnly,"addChildren",new e.MFNode),new t(o.inputOnly,"removeChildren",new e.MFNode),new t(o.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"Layer"},getComponentName:function(){return"Layering"},getContainerField:function(){return"layers"}}),a}),define("x_ite/Components/Layering/LayerSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Layering/Layer","x_ite/Bits/X3DCast","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s,o,a){"use strict";function u(e){n.call(this,e),this.addType(a.LayerSet),this.layerNodes=[new r(e)],this.layerNode0=this.layerNodes[0],this.activeLayerNode=null}return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,fieldDefinitions:new i([new t(a.inputOutput,"metadata",new e.SFNode),new t(a.inputOutput,"activeLayer",new e.SFInt32),new t(a.inputOutput,"order",new e.MFInt32(0)),new t(a.inputOutput,"layers",new e.MFNode)]),getTypeName:function(){return"LayerSet"},getComponentName:function(){return"Layering"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.layerNode0.setPrivate(!0),this.layerNode0.setup(),this.layerNode0.isLayer0(!0),this.activeLayer_.addInterest("set_activeLayer",this),this.order_.addInterest("set_layers",this),this.layers_.addInterest("set_layers",this),this.set_layers()},getActiveLayer:function(){return this.activeLayerNode},setLayer0:function(e){this.layerNode0=e,this.set_layers()},getLayer0:function(){return this.layerNode0},getLayers:function(){return this.layerNodes},set_activeLayer:function(){if(0===this.activeLayer_.getValue())this.activeLayerNode!==this.layerNode0&&(this.activeLayerNode=this.layerNode0);else{var e=this.activeLayer_-1;e>=0&&e<this.layers_.length?this.activeLayerNode!==this.layers_[e].getValue()&&(this.activeLayerNode=s(a.X3DLayerNode,this.layers_[e])):null!==this.activeLayerNode&&(this.activeLayerNode=null)}},set_layers:function(){var e=this.layers_.getValue();this.layerNodes.length=0;for(var t=0;t<this.order_.length;++t){var i=this.order_[t];if(0===i)this.layerNodes.push(this.layerNode0);else if(--i>=0&&i<e.length){var n=s(a.X3DLayerNode,e[i]);n&&this.layerNodes.push(n)}}this.set_activeLayer()},bind:function(e){var t=this.layers_.getValue();this.layerNode0.bind(e);for(var i=0,n=t.length;i<n;++i){var r=s(a.X3DLayerNode,t[i]);r&&r.bind(e)}},traverse:function(e,t){var i=this.layerNodes;if(e===o.POINTER)for(var n=0,r=i.length;n<r;++n)this.getBrowser().setLayerNumber(n),i[n].traverse(e,t);else for(var n=0,r=i.length;n<r;++n)i[n].traverse(e,t)}}),u}),define("x_ite/Execution/World",["x_ite/Fields/SFNode","x_ite/Basic/X3DBaseNode","x_ite/Components/Layering/LayerSet","x_ite/Components/Layering/Layer","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(r){t.call(this,r),this.addChildObjects("activeLayer",new e(this.layer0)),this.layerSet=new i(r),this.defaultLayerSet=this.layerSet,this.layer0=new n(r)}return o.prototype=Object.assign(Object.create(t.prototype),{constructor:o,getTypeName:function(){return"World"},initialize:function(){t.prototype.initialize.call(this),this.layerSet.setPrivate(!0),this.layerSet.setup(),this.layerSet.setLayer0(this.layer0),this.layerSet.activeLayer_.addInterest("set_rootNodes__",this),this.getExecutionContext().getRootNodes().addInterest("set_rootNodes__",this),this.getExecutionContext().setup(),this.set_rootNodes__(),this.layer0.setPrivate(!0),this.layer0.isLayer0(!0),this.layer0.setup(),this.set_activeLayer__(),this.bind()},getLayerSet:function(){return this.layerSet},getActiveLayer:function(){return this.activeLayer_.getValue()},set_rootNodes__:function(){var e=this.layerSet;this.layerSet=this.defaultLayerSet;var t=this.getExecutionContext().getRootNodes();this.layer0.children_=t;for(var i=0;i<t.length;++i){var n=r(s.LayerSet,t[i]);n&&(n.setLayer0(this.layer0),this.layerSet=n)}this.layerSet!==e&&(e.activeLayer_.removeInterest("set_activeLayer__",this),this.layerSet.activeLayer_.addInterest("set_activeLayer__",this),this.set_activeLayer__())},set_activeLayer__:function(){this.activeLayer_=this.layerSet.getActiveLayer()},bind:function(){this.layerSet.bind(this.getExecutionContext().getURL().fragment)},traverse:function(e,t){this.layerSet.traverse(e,t)}}),o}),define("x_ite/Browser/X3DBrowserContext",["x_ite/Fields/SFTime","x_ite/Basic/X3DBaseNode","x_ite/Browser/Core/X3DCoreContext","x_ite/Routing/X3DRoutingContext","x_ite/Browser/Scripting/X3DScriptingContext","x_ite/Browser/Networking/X3DNetworkingContext","x_ite/Browser/Shaders/X3DShadersContext","x_ite/Browser/Rendering/X3DRenderingContext","x_ite/Browser/Shape/X3DShapeContext","x_ite/Browser/Geometry2D/X3DGeometry2DContext","x_ite/Browser/Geometry3D/X3DGeometry3DContext","x_ite/Browser/PointingDeviceSensor/X3DPointingDeviceSensorContext","x_ite/Browser/KeyDeviceSensor/X3DKeyDeviceSensorContext","x_ite/Browser/Navigation/X3DNavigationContext","x_ite/Browser/Layering/X3DLayeringContext","x_ite/Browser/Layout/X3DLayoutContext","x_ite/Browser/EnvironmentalEffects/X3DEnvironmentalEffectsContext","x_ite/Browser/Lighting/X3DLightingContext","x_ite/Browser/Sound/X3DSoundContext","x_ite/Browser/Text/X3DTextContext","x_ite/Browser/Texturing/X3DTexturingContext","x_ite/Browser/Time/X3DTimeContext","x_ite/Browser/ParticleSystems/X3DParticleSystemsContext","x_ite/Execution/World","x_ite/Bits/TraverseType"],function(e,t,i,n,r,s,o,a,u,l,h,c,d,p,f,g,m,_,x,y,v,w,b,S,C){"use strict";function T(S){t.call(this,this),n.call(this),i.call(this,S),r.call(this),s.call(this),o.call(this),a.call(this),u.call(this),l.call(this),h.call(this),c.call(this),d.call(this),p.call(this),f.call(this),g.call(this),m.call(this),_.call(this),x.call(this),y.call(this),v.call(this),w.call(this),b.call(this),this.addChildObjects("initialized",new e,"shutdown",new e,"prepareEvents",new e,"timeEvents",new e,"sensorEvents",new e,"finished",new e),this.changedTime=0,this.renderCallback=this.traverse.bind(this),this.systemTime=0,this.systemStartTime=0,this.browserTime=0,this.pickingTime=0,this.cameraTime=0,this.collisionTime=0,this.displayTime=0}return T.prototype=Object.assign(Object.create(t.prototype),n.prototype,i.prototype,r.prototype,s.prototype,o.prototype,a.prototype,u.prototype,l.prototype,h.prototype,c.prototype,d.prototype,p.prototype,f.prototype,g.prototype,m.prototype,_.prototype,x.prototype,y.prototype,v.prototype,w.prototype,b.prototype,{constructor:T,initialize:function(){t.prototype.initialize.call(this),n.prototype.initialize.call(this),i.prototype.initialize.call(this),r.prototype.initialize.call(this),s.prototype.initialize.call(this),o.prototype.initialize.call(this),a.prototype.initialize.call(this),u.prototype.initialize.call(this),l.prototype.initialize.call(this),h.prototype.initialize.call(this),c.prototype.initialize.call(this),d.prototype.initialize.call(this),p.prototype.initialize.call(this),f.prototype.initialize.call(this),g.prototype.initialize.call(this),m.prototype.initialize.call(this),_.prototype.initialize.call(this),x.prototype.initialize.call(this),y.prototype.initialize.call(this),v.prototype.initialize.call(this),w.prototype.initialize.call(this),b.prototype.initialize.call(this)},initialized:function(){return this.initialized_},shutdown:function(){return this.shutdown_},prepareEvents:function(){return this.prepareEvents_},timeEvents:function(){return this.timeEvents_},sensorEvents:function(){return this.sensorEvents_},finished:function(){return this.finished_},getURL:function(){return this.getExecutionContext().getURL()},getBrowser:function(){return this},getWorld:function(){return this.world},setExecutionContext:function(e){this.world=new S(e),this.world.setup()},getExecutionContext:function(){return this.world.getExecutionContext()},addBrowserEvent:function(){this.changedTime!==this.getCurrentTime()&&(this.changedTime=this.getCurrentTime(),requestAnimationFrame(this.renderCallback))},traverse:function(e){var t=this.getContext(),i=performance.now();this.systemTime=i-this.systemStartTime,this.advanceTime(e),this.prepareEvents_.processInterests(),this.processEvents(),this.timeEvents_.processInterests(),this.processEvents();var n=performance.now();this.world.traverse(C.CAMERA,null),this.cameraTime=performance.now()-n;var r=performance.now();this.getCollisionCount()&&this.world.traverse(C.COLLISION,null),this.collisionTime=performance.now()-r,this.sensorEvents_.processInterests(),this.processEvents();var s=performance.now();t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),this.world.traverse(C.DISPLAY,null),this.displayTime=performance.now()-s,this.browserTime=performance.now()-i,this.systemStartTime=performance.now(),this.finished_.processInterests()}}),T}),define("x_ite/Configuration/ProfileInfo",[],function(){"use strict";function e(e,t,i,n){this.name=e,this.title=t,this.providerUrl=i,this.components=n,Object.preventExtensions(this),Object.freeze(this),Object.seal(this)}return Object.assign(e.prototype,{constructor:e,toXMLStream:function(e){}}),e}),define("x_ite/Configuration/ProfileInfoArray",["x_ite/Configuration/X3DInfoArray"],function(e){"use strict";function t(){return e.call(this)}return t.prototype=Object.assign(Object.create(e.prototype),{constructor:t}),t}),define("x_ite/Configuration/SupportedProfiles",["x_ite/Configuration/ProfileInfo","x_ite/Configuration/ProfileInfoArray","x_ite/Configuration/ComponentInfoArray","x_ite/Browser/Networking/urls"],function(e,t,i,n){"use strict";return function(r){function s(t,s,o){a.add(s,new e(s,t,n.povider,new i(r,o)))}var o=r.supportedComponents,a=new t;return s("Computer-Aided Design (CAD) interchange","CADInterchange",[o.Core,o.Networking,o.Grouping,o.Rendering,o.Shape,o.Lighting,o.Texturing,o.Navigation,o.Shaders,o.CADGeometry]),s("Core","Core",[o.Core]),s("Full","Full",[o.Core,o.Time,o.Networking,o.Grouping,o.Rendering,o.Shape,o.Geometry3D,o.Geometry2D,o.Text,o.Sound,o.Lighting,o.Texturing,o.Interpolation,o.PointingDeviceSensor,o.KeyDeviceSensor,o.EnvironmentalSensor,o.Navigation,o.EnvironmentalEffects,o.Geospatial,o["H-Anim"],o.NURBS,o.DIS,o.Scripting,o.EventUtilities,o.Shaders,o.CADGeometry,o.Texturing3D,o.CubeMapTexturing,o.Layering,o.Layout,o.RigidBodyPhysics,o.Picking,o.Followers,o.ParticleSystems]),s("Immersive","Immersive",[o.Core,o.Time,o.Networking,o.Grouping,o.Rendering,o.Shape,o.Geometry3D,o.Geometry2D,o.Text,o.Sound,o.Lighting,o.Texturing,o.Interpolation,o.PointingDeviceSensor,o.KeyDeviceSensor,o.EnvironmentalSensor,o.Navigation,o.EnvironmentalEffects,o.Scripting,o.EventUtilities]),s("Interactive","Interactive",[o.Core,o.Time,o.Networking,o.Grouping,o.Rendering,o.Shape,o.Geometry3D,o.Lighting,o.Texturing,o.Interpolation,o.PointingDeviceSensor,o.KeyDeviceSensor,o.EnvironmentalSensor,o.Navigation,o.EnvironmentalEffects,o.EventUtilities]),s("Interchange","Interchange",[o.Core,o.Time,o.Networking,o.Grouping,o.Rendering,o.Shape,o.Geometry3D,o.Lighting,o.Texturing,o.Interpolation,o.Navigation,o.EnvironmentalEffects]),s("MPEG-4 interactive","MPEG-4",[o.Core,o.Time,o.Networking,o.Grouping,o.Rendering,o.Shape,o.Geometry3D,o.Lighting,o.Texturing,o.Interpolation,o.PointingDeviceSensor,o.EnvironmentalSensor,o.Navigation,o.EnvironmentalEffects]),Object.preventExtensions(a),Object.freeze(a),Object.seal(a),a}}),define("x_ite/Configuration/SupportedComponents",["x_ite/Configuration/ComponentInfoArray","x_ite/Browser/Networking/urls"],function(e,t){"use strict";return function(i){var n=new e(i);return n.addComponentInfo({title:"Computer-Aided Design (CAD) model geometry",name:"CADGeometry",level:2,providerUrl:t.provider}),n.addComponentInfo({title:"Core",name:"Core",level:2,providerUrl:t.provider}),n.addComponentInfo({title:"Cube map environmental texturing",name:"CubeMapTexturing",level:3,providerUrl:t.provider}),n.addComponentInfo({title:"Distributed interactive simulation (DIS)",name:"DIS",level:2,providerUrl:t.provider}),n.addComponentInfo({title:"Environmental effects",name:"EnvironmentalEffects",level:4,providerUrl:t.provider}),n.addComponentInfo({title:"Environmental sensor",name:"EnvironmentalSensor",level:4,providerUrl:t.provider}),n.addComponentInfo({title:"Event utilities",name:"EventUtilities",level:4,providerUrl:t.provider}),n.addComponentInfo({title:"Followers",name:"Followers",level:4,providerUrl:t.provider}),n.addComponentInfo({title:"Geometry2D",name:"Geometry2D",level:2,providerUrl:t.provider}),n.addComponentInfo({title:"Geometry3D",name:"Geometry3D",level:4,providerUrl:t.provider}),n.addComponentInfo({title:"Geospatial",name:"Geospatial",level:2,providerUrl:t.provider}),n.addComponentInfo({title:"Grouping",name:"Grouping",level:3,providerUrl:t.provider}),n.addComponentInfo({title:"Humanoid animation (H-Anim)",name:"H-Anim",level:3,providerUrl:t.provider}),n.addComponentInfo({title:"Interpolation",name:"Interpolation",level:5,providerUrl:t.provider}),n.addComponentInfo({title:"Key device sensor",name:"KeyDeviceSensor",level:2,providerUrl:t.provider}),n.addComponentInfo({title:"Layering",name:"Layering",level:1,providerUrl:t.provider}),n.addComponentInfo({title:"Layout",name:"Layout",level:1,providerUrl:t.provider}),n.addComponentInfo({title:"Lighting",name:"Lighting",level:3,providerUrl:t.provider}),n.addComponentInfo({title:"Navigation",name:"Navigation",level:3,providerUrl:t.provider}),n.addComponentInfo({title:"Networking",name:"Networking",level:4,providerUrl:t.provider}),n.addComponentInfo({title:"Non-uniform Rational B-Spline (NURBS)",name:"NURBS",level:4,providerUrl:t.provider}),n.addComponentInfo({title:"Particle systems",name:"ParticleSystems",level:3,providerUrl:t.provider}),n.addComponentInfo({title:"Picking sensor",name:"Picking",level:3,providerUrl:t.provider}),n.addComponentInfo({title:"Pointing device sensor",name:"PointingDeviceSensor",level:1,providerUrl:t.provider}),n.addComponentInfo({title:"Programmable shaders",name:"Shaders",level:1,providerUrl:t.provider}),n.addComponentInfo({title:"Rendering",name:"Rendering",level:5,providerUrl:t.provider}),n.addComponentInfo({title:"Rigid body physics",name:"RigidBodyPhysics",level:5,providerUrl:t.provider}),n.addComponentInfo({title:"Scripting",name:"Scripting",level:1,providerUrl:t.provider}),n.addComponentInfo({title:"Shape",name:"Shape",level:4,providerUrl:t.provider}),n.addComponentInfo({title:"Sound",name:"Sound",level:1,providerUrl:t.provider}),n.addComponentInfo({title:"Text",name:"Text",level:1,providerUrl:t.provider}),n.addComponentInfo({title:"Texturing",name:"Texturing",level:3,providerUrl:t.provider}),n.addComponentInfo({title:"Texturing3D",name:"Texturing3D",level:3,providerUrl:t.provider}),n.addComponentInfo({title:"Time",name:"Time",level:2,providerUrl:t.provider}),n.addComponentInfo({title:"Volume rendering",name:"VolumeRendering",level:2,providerUrl:t.provider}),n.addComponentInfo({title:"X_ITE",name:"X_ITE",level:1,providerUrl:t.provider}),Object.preventExtensions(n),Object.freeze(n),Object.seal(n),n}}),define("x_ite/Browser/PointingDeviceSensor/PointingDeviceSensorContainer",["standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4"],function(e,t){"use strict";function i(i,n,r,s){this.node=null,this.modelViewMatrix=new t,this.projectionMatrix=new t,this.viewport=new e(0,0,0,0),this.set(i,n,r,s)}return i.prototype={set:function(e,t,i,n){this.node=e,this.modelViewMatrix.assign(t),this.projectionMatrix.assign(i),this.viewport.assign(n)},set_over__:function(e,t){this.node.set_over__(e,t,this.modelViewMatrix,this.projectionMatrix,this.viewport)},set_active__:function(e,t){this.node.set_active__(e,t,this.modelViewMatrix,this.projectionMatrix,this.viewport)},set_motion__:function(e){this.node.set_motion__(e,this.modelViewMatrix,this.projectionMatrix,this.viewport)}},i}),define("x_ite/Components/PointingDeviceSensor/X3DPointingDeviceSensorNode",["x_ite/Components/Core/X3DSensorNode","x_ite/Browser/PointingDeviceSensor/PointingDeviceSensorContainer","x_ite/Bits/X3DConstants"],function(e,t,i){"use strict";function n(t){e.call(this,t),this.addType(i.X3DPointingDeviceSensorNode)}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,initialize:function(){e.prototype.initialize.call(this),this.enabled_.addInterest("set_enabled__",this)},getMatrices:function(){return this.matrices},set_enabled__:function(){this.enabled_.getValue()||(this.isActive_.getValue()&&(this.isActive_=!1),this.isOver_.getValue()&&(this.isOver_=!1))},set_over__:function(e,t){e!==this.isOver_.getValue()&&(this.isOver_=e,e&&(this.getBrowser().getNotification().string_=this.description_))},set_active__:function(e,t){e!==this.isActive_.getValue()&&(this.isActive_=e)},set_motion__:function(e){},push:function(e,i){this.enabled_.getValue()&&(i[this.getId()]=new t(this,e.getModelViewMatrix().get(),e.getProjectionMatrix().get(),e.getViewVolume().getViewport()))}}),n}),define("x_ite/Components/PointingDeviceSensor/X3DTouchSensorNode",["x_ite/Components/PointingDeviceSensor/X3DPointingDeviceSensorNode","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DTouchSensorNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,set_active__:function(t,i){e.prototype.set_active__.call(this,t,i),this.enabled_.getValue()&&this.isOver_.getValue()&&!t&&(this.touchTime_=this.getBrowser().getCurrentTime())}}),i}),define("x_ite/Components/PointingDeviceSensor/TouchSensor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/PointingDeviceSensor/X3DTouchSensorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.TouchSensor),this.hitPoint_changed_.setUnit("length")}var a=new s;return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"enabled",new e.SFBool(!0)),new t(r.inputOutput,"description",new e.SFString),new t(r.outputOnly,"hitTexCoord_changed",new e.SFVec2f),new t(r.outputOnly,"hitNormal_changed",new e.SFVec3f),new t(r.outputOnly,"hitPoint_changed",new e.SFVec3f),new t(r.outputOnly,"isOver",new e.SFBool),new t(r.outputOnly,"isActive",new e.SFBool),new t(r.outputOnly,"touchTime",new e.SFTime)]),getTypeName:function(){return"TouchSensor"},getComponentName:function(){return"PointingDeviceSensor"},getContainerField:function(){return"children"},set_over__:function(e,t,i,r,s){try{if(n.prototype.set_over__.call(this,e,t,i,r,s),this.isOver_.getValue()){var o=t.intersection;a.assign(i).inverse(),this.hitTexCoord_changed_=o.texCoord,this.hitNormal_changed_=i.multMatrixDir(o.normal.copy()).normalize(),this.hitPoint_changed_=a.multVecMatrix(o.point.copy())}}catch(e){console.log(e)}}}),o}),define("x_ite/Components/Networking/Anchor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Components/PointingDeviceSensor/TouchSensor","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","x_ite/InputOutput/FileLoader"],function(e,t,i,n,r,s,o,a,u){"use strict";function l(e){n.call(this,e),r.call(this,e),this.addType(a.Anchor),this.touchSensorNode=new s(e)}return l.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:l,fieldDefinitions:new i([new t(a.inputOutput,"metadata",new e.SFNode),new t(a.inputOutput,"description",new e.SFString),new t(a.inputOutput,"url",new e.MFString),new t(a.inputOutput,"parameter",new e.MFString),new t(a.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(a.initializeOnly,"bboxCenter",new e.SFVec3f),new t(a.inputOnly,"addChildren",new e.MFNode),new t(a.inputOnly,"removeChildren",new e.MFNode),new t(a.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"Anchor"},getComponentName:function(){return"Networking"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this),this.description_.addFieldInterest(this.touchSensorNode.description_),this.touchSensorNode.description_=this.description_,this.touchSensorNode.setup();var e=this,t=this.touchSensorNode.set_active__;this.touchSensorNode.set_active__=function(i,n){t.call(this,i,n),this.isOver_.getValue()&&!i&&e.requestAsyncLoad()}},requestAsyncLoad:function(){this.setLoadState(a.IN_PROGRESS_STATE,!1),new u(this).createX3DFromURL(this.url_,this.parameter_,function(e){e?(this.getBrowser().replaceWorld(e),this.setLoadState(a.COMPLETE_STATE,!1)):this.setLoadState(a.FAILED_STATE,!1)}.bind(this),function(e){try{this.getExecutionContext().changeViewpoint(e)}catch(e){}this.setLoadState(a.COMPLETE_STATE,!1)}.bind(this),function(e,t){t?window.open(e,t):location=e,this.setLoadState(a.COMPLETE_STATE,!1)}.bind(this))},traverse:function(e,t){if(e===o.POINTER){var i={};t.getBrowser().getSensors().push(i),this.touchSensorNode.push(t,i),n.prototype.traverse.call(this,e,t),t.getBrowser().getSensors().pop()}else n.prototype.traverse.call(this,e,t)}}),l}),define("x_ite/Components/Rendering/X3DLineGeometryNode",["x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4"],function(e,t,i){"use strict";function n(t){e.call(this,t)}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,getShader:function(e){return e.getLineShader()},intersectsLine:function(e,t,i,n){return!1},intersectsBox:function(e,t,i){return!1},display:function(e,t){try{var i=t.renderer.getBrowser(),n=t.shaderNode,r=this.attribNodes,s=this.attribBuffers;n===i.getDefaultShader()&&(n=this.getShader(i)),t.geometryType=this.getGeometryType(),t.colorMaterial=this.getColors().length,n.enable(e),n.setLocalUniforms(e,t);for(var o=0,a=r.length;o<a;++o)r[o].enable(e,n,s[o]);this.colors.length&&n.enableColorAttribute(e,this.colorBuffer),n.enableVertexAttribute(e,this.vertexBuffer),e.drawArrays(n.primitiveMode===e.POINTS?e.POINTS:this.primitiveMode,0,this.vertexCount);for(var o=0,a=r.length;o<a;++o)r[o].disable(e,n);n.disableColorAttribute(e),n.disable(e)}catch(e){console.log(e)}},displayParticles:function(e,t,n,r){try{var s=t.renderer.getBrowser(),o=t.shaderNode,a=this.attribNodes,u=this.attribBuffers;o!==s.getDefaultShader()&&o!==s.getShadowShader()||(o=this.getShader(s)),t.geometryType=this.getGeometryType(),t.colorMaterial=this.colors.length,o.enable(e),o.setLocalUniforms(e,t);for(var l=0,h=a.length;l<h;++l)a[l].enable(e,o,u[l]);this.colors.length&&o.enableColorAttribute(e,this.colorBuffer),o.enableVertexAttribute(e,this.vertexBuffer);for(var c=t.modelViewMatrix,d=c[12],p=c[13],f=c[14],g=o.primitiveMode===e.POINTS?e.POINTS:this.primitiveMode,m=0;m<r;++m)c[12]=d,c[13]=p,c[14]=f,i.prototype.translate.call(c,n[m].position),e.uniformMatrix4fv(o.x3d_ModelViewMatrix,!1,c),e.drawArrays(g,0,this.vertexCount);for(var l=0,h=a.length;l<h;++l)a[l].disable(e,o);o.disableColorAttribute(e),o.disable(e)}catch(e){console.log(e)}}}),n}),define("x_ite/Components/Geometry2D/Arc2D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DLineGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(e,t,i,n,r,s,o,a){"use strict";function u(e){n.call(this,e),this.addType(r.Arc2D),this.setGeometryType(1),this.startAngle_.setUnit("angle"),this.endAngle_.setUnit("angle"),this.radius_.setUnit("length")}return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"startAngle",new e.SFFloat),new t(r.inputOutput,"endAngle",new e.SFFloat(1.5708)),new t(r.initializeOnly,"radius",new e.SFFloat(1))]),getTypeName:function(){return"Arc2D"},getComponentName:function(){return"Geometry2D"},getContainerField:function(){return"geometry"},set_live__:function(){n.prototype.set_live__.call(this),this.isLive().getValue()?this.getBrowser().getArc2DOptions().addInterest("eventsProcessed",this):this.getBrowser().getArc2DOptions().removeInterest("eventsProcessed",this)},getSweepAngle:function(){var e=a.interval(this.startAngle_.getValue(),0,2*Math.PI),t=a.interval(this.endAngle_.getValue(),0,2*Math.PI);if(e===t)return 2*Math.PI;var i=Math.abs(t-e);return e>t?2*Math.PI-i:isNaN(i)?0:i},build:function(){var e=this.getBrowser().getContext(),t=this.getBrowser().getArc2DOptions(),i=t.dimension_.getValue(),n=this.startAngle_.getValue(),r=Math.abs(this.radius_.getValue()),o=this.getSweepAngle(),a=o==2*Math.PI,u=Math.floor(o*i/(2*Math.PI)),l=this.getVertices();u=Math.max(3,u),a?this.setPrimitiveMode(e.LINE_LOOP):(++u,this.setPrimitiveMode(e.LINE_STRIP));for(var h=a?u:u-1,c=0;c<u;++c){var d=c/h,p=n+o*d,f=s.Polar(r,p);l.push(f.real,f.imag,0,1)}this.getMin().set(-r,-r,0),this.getMax().set(r,r,0),this.setSolid(!1)}}),u}),define("x_ite/Components/Geometry2D/ArcClose2D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(e,t,i,n,r,s,o,a){"use strict";function u(e){n.call(this,e),this.addType(r.ArcClose2D),this.setGeometryType(2),this.startAngle_.setUnit("angle"),this.endAngle_.setUnit("angle"),this.radius_.setUnit("length")}var l=new s(.5,.5);return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"closureType",new e.SFString("PIE")),new t(r.inputOutput,"startAngle",new e.SFFloat),new t(r.inputOutput,"endAngle",new e.SFFloat(1.5708)),new t(r.initializeOnly,"radius",new e.SFFloat(1)),new t(r.initializeOnly,"solid",new e.SFBool)]),getTypeName:function(){return"ArcClose2D"},getComponentName:function(){return"Geometry2D"},getContainerField:function(){return"geometry"},set_live__:function(){n.prototype.set_live__.call(this),this.isLive().getValue()?this.getBrowser().getArcClose2DOptions().addInterest("eventsProcessed",this):this.getBrowser().getArcClose2DOptions().removeInterest("eventsProcessed",this)},getSweepAngle:function(){var e=a.interval(this.startAngle_.getValue(),0,2*Math.PI),t=a.interval(this.endAngle_.getValue(),0,2*Math.PI);if(e===t)return 2*Math.PI;var i=Math.abs(t-e);return e>t?2*Math.PI-i:isNaN(i)?0:i},build:function(){var e=this.getBrowser().getArcClose2DOptions(),t="CHORD"===this.closureType_.getValue(),i=e.dimension_.getValue(),n=this.startAngle_.getValue(),r=Math.abs(this.radius_.getValue()),o=this.getSweepAngle(),a=Math.max(4,Math.floor(o*i/(2*Math.PI))),u=this.getTexCoords(),h=this.getNormals(),c=this.getVertices(),d=[],p=[];this.getMultiTexCoords().push(u)
;for(var f=a-1,g=0;g<a;++g){var m=g/f,_=n+o*m;d.push(s.Polar(.5,_).add(l)),p.push(s.Polar(r,_))}if(t)for(var x=d[0],y=p[0],v=1;v<f;++v){var w=d[v],b=d[v+1],S=p[v],C=p[v+1];u.push(x.real,x.imag,0,1,w.real,w.imag,0,1,b.real,b.imag,0,1),h.push(0,0,1,0,0,1,0,0,1),c.push(y.real,y.imag,0,1,S.real,S.imag,0,1,C.real,C.imag,0,1)}else for(var v=0;v<f;++v){var w=d[v],b=d[v+1],S=p[v],C=p[v+1];u.push(.5,.5,0,1,w.real,w.imag,0,1,b.real,b.imag,0,1),h.push(0,0,1,0,0,1,0,0,1),c.push(0,0,0,1,S.real,S.imag,0,1,C.real,C.imag,0,1)}this.getMin().set(-r,-r,0),this.getMax().set(r,r,0),this.setSolid(this.solid_.getValue())}}),u}),define("x_ite/Components/Sound/X3DSoundSourceNode",["x_ite/Components/Core/X3DChildNode","x_ite/Components/Time/X3DTimeDependentNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(e,t,i,n){"use strict";function r(n){e.call(this,n),t.call(this,n),this.addType(i.X3DSoundSourceNode),this.volume=0,this.media=null}return r.prototype=Object.assign(Object.create(e.prototype),t.prototype,{constructor:r,initialize:function(){e.prototype.initialize.call(this),t.prototype.initialize.call(this)},set_browser_live__:function(){t.prototype.set_browser_live__.call(this),this.getDisabled()?(this.getBrowser().volume_.removeInterest("set_volume__",this),this.getBrowser().mute_.removeInterest("set_volume__",this)):(this.getBrowser().volume_.addInterest("set_volume__",this),this.getBrowser().mute_.addInterest("set_volume__",this),this.set_volume__())},setMedia:function(e){if(this.media&&(this.media[0].volume=0,this.media[0].pause(),this.media.unbind("ended")),this.media=e,e){var t=e[0];this.setVolume(0),this.duration_changed_=t.duration,this.isActive_.getValue()?this.isPaused_.getValue()?this.loop_.getValue()?(this.do_stop(),this.do_pause()):this.do_stop():this.loop_.getValue()?(this.do_stop(),this.do_start()):this.do_stop():this.set_stop()}},getMedia:function(){return this.media},setVolume:function(e){this.volume=n.clamp(e,0,1),this.set_volume__()},set_volume__:function(){if(this.media){var e=this.getBrowser().mute_.getValue(),t=n.clamp(this.getBrowser().volume_.getValue(),0,1),i=!e*t*this.volume;this.media[0].volume=i}},set_speed:function(){},set_pitch:function(){},set_start:function(){this.media&&this.speed_.getValue()&&(this.media[0].currentTime=0,this.media[0].play())},set_pause:function(){this.media&&(this.media.unbind("ended"),this.media[0].pause())},set_resume:function(){this.media&&this.speed_.getValue()&&this.media[0].play()},set_stop:function(){this.media&&(this.media.unbind("ended"),this.media[0].pause())},set_ended:function(){if(this.media){var e=this.media[0];if(e.currentTime<e.duration)return;this.loop_.getValue()?(this.speed_.getValue()&&e.play(),this.elapsedTime_=this.getElapsedTime(),this.cycleTime_=this.getBrowser().getCurrentTime()):this.stop()}},set_time:function(){this.set_ended(),this.elapsedTime_=this.getElapsedTime()}}),r}),define("x_ite/Components/Sound/AudioClip",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Sound/X3DSoundSourceNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Bits/X3DConstants","x_ite/Browser/Networking/urls","standard/Networking/URI","x_ite/DEBUG"],function(e,t,i,n,r,s,o,a,u,l){"use strict";function h(e){r.call(this,e),s.call(this,e),this.addType(o.AudioClip),this.addChildObjects("buffer",new t.SFTime),this.urlStack=new t.MFString}return h.prototype=Object.assign(Object.create(r.prototype),s.prototype,{constructor:h,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new t.SFNode),new i(o.inputOutput,"enabled",new t.SFBool(!0)),new i(o.inputOutput,"description",new t.SFString),new i(o.inputOutput,"url",new t.MFString),new i(o.inputOutput,"speed",new t.SFFloat(1)),new i(o.inputOutput,"pitch",new t.SFFloat(1)),new i(o.inputOutput,"loop",new t.SFBool),new i(o.inputOutput,"startTime",new t.SFTime),new i(o.inputOutput,"resumeTime",new t.SFTime),new i(o.inputOutput,"pauseTime",new t.SFTime),new i(o.inputOutput,"stopTime",new t.SFTime),new i(o.outputOnly,"isPaused",new t.SFBool),new i(o.outputOnly,"isActive",new t.SFBool),new i(o.outputOnly,"cycleTime",new t.SFTime),new i(o.outputOnly,"elapsedTime",new t.SFTime),new i(o.outputOnly,"duration_changed",new t.SFTime(-1))]),getTypeName:function(){return"AudioClip"},getComponentName:function(){return"Sound"},getContainerField:function(){return"source"},initialize:function(){r.prototype.initialize.call(this),s.prototype.initialize.call(this),this.url_.addInterest("set_url__",this),this.buffer_.addInterest("set_buffer__",this),this.audio=e("<audio></audio>"),this.audio.on("error",this.setError.bind(this)),this.audio.bind("abort",this.setError.bind(this)),this.audio[0].preload="auto",this.audio[0].volume=0,this.audio[0].crossOrigin="Anonymous",this.set_url__()},set_url__:function(){this.setLoadState(o.NOT_STARTED_STATE),this.requestAsyncLoad()},requestAsyncLoad:function(){this.checkLoadState()!==o.COMPLETE_STATE&&this.checkLoadState()!==o.IN_PROGRESS_STATE&&(this.setLoadState(o.IN_PROGRESS_STATE),this.buffer_.addEvent())},set_buffer__:function(){this.setMedia(null),this.urlStack.setValue(this.url_),this.audio.bind("canplaythrough",this.setAudio.bind(this)),this.loadNext()},loadNext:function(){if(0===this.urlStack.length)return this.duration_changed_=-1,void this.setLoadState(o.FAILED_STATE);this.URL=new u(this.urlStack.shift()),this.URL=this.getExecutionContext().getURL().transform(this.URL),this.audio.attr("src",this.URL)},setError:function(){var e=this.URL.toString();l&&(this.URL.isLocal()||"localhost"===this.URL.host||e.match(a.fallbackExpression)||this.urlStack.unshift(a.fallbackUrl+e)),"data"!==this.URL.scheme&&console.warn("Error loading audio:",this.URL.toString()),this.loadNext()},setAudio:function(){l&&"data"!==this.URL.scheme&&console.info("Done loading audio:",this.URL.toString()),this.audio.unbind("canplaythrough"),this.setMedia(this.audio),this.setLoadState(o.COMPLETE_STATE)}}),h}),define("x_ite/Components/Navigation/Billboard",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/X3DConstants","x_ite/Bits/TraverseType","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r,s,o,a,u){"use strict";function l(e){n.call(this,e),this.addType(r.Billboard),this.matrix=new u}var h=new u,c=new o(0,1,0),d=new o(0,0,1),p=new o(0,0,0),f=new o(0,0,0),g=new o(0,0,0),m=new o(0,0,0),_=new o(0,0,0),x=new a(0,0,1,0);return l.prototype=Object.assign(Object.create(n.prototype),{constructor:l,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"axisOfRotation",new e.SFVec3f(0,1,0)),new t(r.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(r.initializeOnly,"bboxCenter",new e.SFVec3f),new t(r.inputOnly,"addChildren",new e.MFNode),new t(r.inputOnly,"removeChildren",new e.MFNode),new t(r.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"Billboard"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},getBBox:function(e){return n.prototype.getBBox.call(this,e).multRight(this.matrix)},getMatrix:function(){return this.matrix},rotate:function(e){h.assign(e).inverse();var t=h.origin.normalize();if(this.axisOfRotation_.getValue().equals(o.Zero)){h.multDirMatrix(p.assign(c)).normalize(),f.assign(p).cross(t),g.assign(t).cross(f);var i=t;f.normalize(),g.normalize(),this.matrix.set(f[0],f[1],f[2],0,g[0],g[1],g[2],0,i[0],i[1],i[2],0,0,0,0,1)}else m.assign(this.axisOfRotation_.getValue()).cross(t),_.assign(this.axisOfRotation_.getValue()).cross(d),this.matrix.setRotation(x.setFromToVec(_,m));return this.matrix},traverse:function(e,t){var i=t.getModelViewMatrix();i.push();try{switch(e){case s.CAMERA:case s.DEPTH:i.multLeft(this.matrix);break;default:i.multLeft(this.rotate(i.get()))}n.prototype.traverse.call(this,e,t)}catch(e){console.log(e)}i.pop()}}),l}),define("x_ite/Components/EventUtilities/BooleanFilter",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.BooleanFilter)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_boolean",new e.SFBool),new t(r.outputOnly,"inputTrue",new e.SFBool),new t(r.outputOnly,"inputFalse",new e.SFBool),new t(r.outputOnly,"inputNegate",new e.SFBool)]),getTypeName:function(){return"BooleanFilter"},getComponentName:function(){return"EventUtilities"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.set_boolean_.addInterest("set_boolean__",this)},set_boolean__:function(){var e=this.set_boolean_.getValue();e?this.inputTrue_=!0:this.inputFalse_=!1,this.inputNegate_=!e}}),s}),define("x_ite/Components/EventUtilities/X3DSequencerNode",["x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(e,t,i){"use strict";function n(i){e.call(this,i),this.addType(t.X3DSequencerNode),this.index=-1}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,initialize:function(){e.prototype.initialize.call(this),this.set_fraction_.addInterest("set_fraction__",this),this.previous_.addInterest("set_previous__",this),this.next_.addInterest("set_next__",this),this.key_.addInterest("set_index__",this)},set_fraction__:function(){var e=this.set_fraction_.getValue(),t=this.key_,n=t.length;if(0!==n){var r=0;if(1===n||e<=t[0])r=0;else if(e>=t[n-1])r=this.getSize()-1;else{var s=i.upperBound(t,0,n,e,i.less);r=s-1}r!==this.index&&r<this.getSize()&&this.sequence(this.index=r)}},set_previous__:function(){this.previous_.getValue()&&(this.index<=0?this.index=this.getSize()-1:--this.index,this.index<this.getSize()&&this.sequence(this.index))},set_next__:function(){this.next_.getValue()&&(this.index>=this.getSize()-1?this.index=0:++this.index,this.index<this.getSize()&&this.sequence(this.index))},set_index__:function(){this.index=-1}}),n}),define("x_ite/Components/EventUtilities/BooleanSequencer",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/EventUtilities/X3DSequencerNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.BooleanSequencer)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_fraction",new e.SFFloat),new t(r.inputOnly,"previous",new e.SFBool),new t(r.inputOnly,"next",new e.SFBool),new t(r.inputOutput,"key",new e.MFFloat),new t(r.inputOutput,"keyValue",new e.MFBool),new t(r.outputOnly,"value_changed",new e.SFBool)]),getTypeName:function(){return"BooleanSequencer"},getComponentName:function(){return"EventUtilities"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.keyValue_.addInterest("set_index__",this)},getSize:function(){return this.keyValue_.length},sequence:function(e){this.value_changed_=this.keyValue_[e]}}),s}),define("x_ite/Components/EventUtilities/BooleanToggle",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.BooleanToggle)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_boolean",new e.SFBool),new t(r.inputOutput,"toggle",new e.SFBool)]),getTypeName:function(){return"BooleanToggle"},getComponentName:function(){return"EventUtilities"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.set_boolean_.addInterest("set_boolean__",this)},set_boolean__:function(){this.set_boolean_.getValue()&&(this.toggle_=!this.toggle_.getValue())}}),s}),define("x_ite/Components/EventUtilities/X3DTriggerNode",["x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DTriggerNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i}),i}),define("x_ite/Components/EventUtilities/BooleanTrigger",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/EventUtilities/X3DTriggerNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.BooleanTrigger)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_triggerTime",new e.SFTime),new t(r.outputOnly,"triggerTrue",new e.SFBool)]),getTypeName:function(){return"BooleanTrigger"},getComponentName:function(){return"EventUtilities"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.set_triggerTime_.addInterest("set_triggerTime__",this)},set_triggerTime__:function(){this.triggerTrue_=!0}}),s}),define("x_ite/Components/ParticleSystems/X3DParticlePhysicsModelNode",["x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DParticlePhysicsModelNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,addForce:function(){}}),i}),define("x_ite/Components/ParticleSystems/BoundedPhysicsModel",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/ParticleSystems/X3DParticlePhysicsModelNode","x_ite/Bits/X3DConstants","x_ite/Bits/X3DCast"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.BoundedPhysicsModel)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"enabled",new e.SFBool(!0)),new t(r.inputOutput,"geometry",new e.SFNode)]),getTypeName:function(){return"BoundedPhysicsModel"},getComponentName:function(){return"ParticleSystems"},getContainerField:function(){return"physics"},initialize:function(){n.prototype.initialize.call(this),this.geometry_.addInterest("set_geometry__",this),this.set_geometry__()},set_geometry__:function(){this.geometryNode&&this.geometryNode.removeInterest("addNodeEvent",this),this.geometryNode=s(r.X3DGeometryNode,this.geometry_),this.geometryNode&&this.geometryNode.addInterest("addNodeEvent",this)},addGeometry:function(e,t){if(this.geometryNode){for(var i=this.geometryNode.getNormals().getValue(),n=this.geometryNode.getVertices().getValue(),r=0,s=i.length;r<s;++r)e.push(i[r]);for(var r=0,s=n.length;r<s;++r)t.push(n[r])}}}),o}),define("x_ite/Components/Geometry3D/Box",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.Box),this.size_.setUnit("length")}var a=new s(2,2,2);return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"size",new e.SFVec3f(2,2,2)),new t(r.initializeOnly,"solid",new e.SFBool(!0))]),getTypeName:function(){return"Box"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},build:function(){var e=this.getBrowser().getBoxOptions(),t=e.getGeometry(),i=this.size_.getValue();if(this.setMultiTexCoords(t.getMultiTexCoords()),this.setNormals(t.getNormals()),i.equals(a))this.setVertices(t.getVertices()),this.getMin().assign(t.getMin()),this.getMax().assign(t.getMax());else{for(var n=s.divide(i,2),r=n.x,o=n.y,u=n.z,l=t.getVertices().getValue(),h=this.getVertices(),c=0;c<l.length;c+=4)h.push(r*l[c],o*l[c+1],u*l[c+2],1);r=Math.abs(r),o=Math.abs(o),u=Math.abs(u),this.getMin().set(-r,-o,-u),this.getMax().set(r,o,u)}this.setSolid(this.solid_.getValue())}}),o}),define("x_ite/Components/CADGeometry/X3DProductStructureChildNode",["x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DProductStructureChildNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i}),i}),define("x_ite/Components/CADGeometry/CADAssembly",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Components/CADGeometry/X3DProductStructureChildNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),r.call(this,e),this.addType(s.CADAssembly)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"name",new e.SFString),new t(s.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(s.initializeOnly,"bboxCenter",new e.SFVec3f),new t(s.inputOnly,"addChildren",new e.MFNode),new t(s.inputOnly,"removeChildren",new e.MFNode),new t(s.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"CADAssembly"},getComponentName:function(){return"CADGeometry"},getContainerField:function(){return"children"}}),o}),define("x_ite/Components/CADGeometry/CADFace",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/CADGeometry/X3DProductStructureChildNode","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,s,o){"use strict";function a(e){n.call(this,e),r.call(this,e),this.addType(o.CADFace),this.shapeNode=null}return a.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:a,fieldDefinitions:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"name",new e.SFString),new t(o.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(o.initializeOnly,"bboxCenter",new e.SFVec3f),new t(o.inputOutput,"shape",new e.SFNode)]),getTypeName:function(){return"CADFace"},getComponentName:function(){return"CADGeometry"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this),this.shape_.addInterest("set_shape__",this),this.set_shape__()},getBBox:function(e){if(this.bboxSize_.getValue().equals(this.defaultBBoxSize)){var t=s(o.X3DBoundedObject,this.shape_);return t?t.getBBox(e):e.set()}return e.set(this.bboxSize_.getValue(),this.bboxCenter_.getValue())},set_shape__:function(){this.shapeNode&&this.shapeNode.isCameraObject_.removeFieldInterest(this.isCameraObject_),this.shapeNode=null;try{for(var e=this.shape_.getValue().getInnerNode(),t=e.getType(),i=t.length-1;i>=0;--i)switch(t[i]){case o.LOD:case o.Transform:case o.X3DShapeNode:e.isCameraObject_.addFieldInterest(this.isCameraObject_),this.setCameraObject(e.getCameraObject()),this.shapeNode=e;break;default:continue}}catch(e){}this.shapeNode?delete this.traverse:this.traverse=Function.prototype},traverse:function(e,t){this.shapeNode.traverse(e,t)}}),a}),define("x_ite/Components/CADGeometry/CADLayer",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.CADLayer)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"name",new e.SFString),new t(r.inputOutput,"visible",new e.MFBool),new t(r.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(r.initializeOnly,"bboxCenter",new e.SFVec3f),new t(r.inputOnly,"addChildren",new e.MFNode),new t(r.inputOnly,"removeChildren",new e.MFNode),new t(r.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"CADLayer"},getComponentName:function(){return"CADGeometry"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.visible_.addInterest("set_children__",this)},getVisible:function(){return this.visible_},remove:function(){this.set_children__()}}),s}),define("x_ite/Components/Grouping/X3DTransformMatrix3DNode",["x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r){"use strict";function s(i){e.call(this,i),this.addType(t.X3DTransformMatrix3DNode),this.matrix=new r}return s.prototype=Object.assign(Object.create(e.prototype),{constructor:s,getBBox:function(t){var t=e.prototype.getBBox.call(this,t);return this.traverse===s.prototype.traverse?t.multRight(this.matrix):t},setMatrix:function(t){t.equals(r.Identity)?(this.matrix.identity(),this.traverse=e.prototype.traverse):(this.matrix.assign(t),delete this.traverse)},getMatrix:function(){return this.matrix},setTransform:function(t,r,s,o,a){t.equals(i.Zero)&&r.equals(n.Identity)&&s.equals(i.One)?(this.matrix.identity(),this.traverse=e.prototype.traverse):(this.matrix.set(t,r,s,o,a),delete this.traverse)},traverse:function(t,i){var n=i.getModelViewMatrix();n.push(),n.multLeft(this.matrix),e.prototype.traverse.call(this,t,i),n.pop()}}),s}),define("x_ite/Components/Grouping/X3DTransformNode",["x_ite/Components/Grouping/X3DTransformMatrix3DNode","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DTransformNode),this.translation_.setUnit("length"),this.center_.setUnit("length")}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,initialize:function(){e.prototype.initialize.call(this),this.addInterest("eventsProcessed",this),this.eventsProcessed()},eventsProcessed:function(){e.prototype.eventsProcessed.call(this),this.setHidden(0===this.scale_.x||0===this.scale_.y||0===this.scale_.z),this.setTransform(this.translation_.getValue(),this.rotation_.getValue(),this.scale_.getValue(),this.scaleOrientation_.getValue(),this.center_.getValue())}}),i}),define("x_ite/Components/CADGeometry/CADPart",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DTransformNode","x_ite/Components/CADGeometry/X3DProductStructureChildNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),r.call(this,e),this.addType(s.CADPart)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"name",new e.SFString),new t(s.inputOutput,"translation",new e.SFVec3f),new t(s.inputOutput,"rotation",new e.SFRotation),new t(s.inputOutput,"scale",new e.SFVec3f(1,1,1)),new t(s.inputOutput,"scaleOrientation",new e.SFRotation),new t(s.inputOutput,"center",new e.SFVec3f),new t(s.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(s.initializeOnly,"bboxCenter",new e.SFVec3f),new t(s.inputOnly,"addChildren",new e.MFNode),new t(s.inputOnly,"removeChildren",new e.MFNode),new t(s.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"CADPart"},getComponentName:function(){return"CADGeometry"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this)}}),o}),define("x_ite/Components/Geometry2D/Circle2D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DLineGeometryNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.Circle2D),this.setGeometryType(1),this.radius_.setUnit("length")}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"radius",new e.SFFloat(1))]),getTypeName:function(){return"Circle2D"},getComponentName:function(){return"Geometry2D"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this.setPrimitiveMode(this.getBrowser().getContext().LINE_LOOP)},set_live__:function(){n.prototype.set_live__.call(this),this.isLive().getValue()?this.getBrowser().getCircle2DOptions().addInterest("eventsProcessed",this):this.getBrowser().getCircle2DOptions().removeInterest("eventsProcessed",this)},build:function(){var e=this.getBrowser().getCircle2DOptions(),t=this.getVertices(),i=this.radius_.getValue();if(1===i)this.setVertices(e.getVertices());else for(var n=e.getVertices().getValue(),r=0,s=n.length;r<s;r+=4)t.push(n[r]*i,n[r+1]*i,0,1);this.getMin().set(-i,-i,0),this.getMax().set(i,i,0)}}),s}),define("x_ite/Components/Rendering/ClipPlane",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Geometry/Plane3","standard/Utility/ObjectCache"],function(e,t,i,n,r,s,o,a,u){"use strict";function l(){this.plane=new a(s.Zero,s.Zero)}function h(e){n.call(this,e),this.addType(r.ClipPlane),this.enabled=!1,this.plane=new o(0,0,0,0)}var c=u(l);return l.prototype={constructor:l,isClipped:function(e){return this.plane.getDistanceToPoint(e)<0},set:function(e,t){var i=this.plane,n=e.plane;try{i.normal.assign(n),i.distanceFromOrigin=-n.w,i.multRight(t)}catch(e){i.normal.set(0,0,0),i.distanceFromOrigin=0}},setShaderUniforms:function(e,t){var i=this.plane,n=i.normal;e.uniform4f(t.x3d_ClipPlane[t.numClipPlanes++],n.x,n.y,n.z,i.distanceFromOrigin)},dispose:function(){c.push(this)}},h.prototype=Object.assign(Object.create(n.prototype),{constructor:h,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"enabled",new e.SFBool(!0)),new t(r.inputOutput,"plane",new e.SFVec4f(0,1,0,0))]),getTypeName:function(){return"ClipPlane"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.enabled_.addInterest("set_enabled__",this),this.plane_.addInterest("set_enabled__",this),this.set_enabled__()},set_enabled__:function(){this.plane.assign(this.plane_.getValue()),this.enabled=this.enabled_.getValue()&&!this.plane.equals(o.Zero)},push:function(e){if(this.enabled){var t=c.pop();t.set(this,e.getModelViewMatrix().get()),e.getShaderObjects().push(t)}},pop:function(e){this.enabled&&e.getBrowser().getClipPlanes().push(e.getShaderObjects().pop())}}),h}),define("x_ite/Components/Navigation/Collision",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Components/Core/X3DSensorNode","x_ite/Bits/X3DCast","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s,o,a){"use strict";function u(e){n.call(this,e),r.call(this,e),this.addType(a.Collision),"2.0"==e.getSpecificationVersion()&&this.addAlias("collide",this.enabled_)}return u.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:u,fieldDefinitions:new i([new t(a.inputOutput,"metadata",new e.SFNode),new t(a.inputOutput,"enabled",new e.SFBool(!0)),new t(a.outputOnly,"isActive",new e.SFBool),new t(a.outputOnly,"collideTime",new e.SFTime),new t(a.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(a.initializeOnly,"bboxCenter",new e.SFVec3f),new t(a.initializeOnly,"proxy",new e.SFNode),new t(a.inputOnly,"addChildren",new e.MFNode),new t(a.inputOnly,"removeChildren",new e.MFNode),new t(a.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"Collision"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this),this.enabled_.addInterest("set_live__",this),this.proxy_.addInterest("set_proxy__",this),this.set_live__(),this.set_proxy__()},set_live__:function(){this.isLive().getValue()&&this.enabled_.getValue()?this.getBrowser().addCollision(this):this.getBrowser().removeCollision(this)},set_active:function(e){this.isActive_.getValue()!==e&&(this.isActive_=e,e&&(this.collideTime_=this.getBrowser().getCurrentTime()))},set_proxy__:function(){this.proxyNode=s(a.X3DChildNode,this.proxy_)},traverse:function(e,t){switch(e){case o.COLLISION:if(this.enabled_.getValue()){var i=t.getCollisions();i.push(this),this.proxyNode?this.proxyNode.traverse(e,t):n.prototype.traverse.call(this,e,t),i.pop()}break;default:n.prototype.traverse.call(this,e,t)}}}),u}),define("x_ite/Components/Rendering/X3DColorNode",["x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DColorNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i}),i}),define("x_ite/Components/Rendering/Color",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DColorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector4"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.Color)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"color",new e.MFColor)]),getTypeName:function(){return"Color"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"color"},initialize:function(){n.prototype.initialize.call(this),this.color_.addInterest("set_color__",this),this.set_color__()},set_color__:function(){this.color=this.color_.getValue(),this.length=this.color_.length},isTransparent:function(){return!1},addColor:function(e,t){if(e>=0&&e<this.length){const i=this.color;e*=3,t.push(i[e],i[e+1],i[e+2],1)}else if(this.length){const i=this.color;e=3*(this.length-1),t.push(i[e],i[e+1],i[e+2],1)}else t.push(1,1,1,1)},addColors:function(e,t){const i=this.color;for(var n=0,r=3*this.length;n<r;n+=3)e.push(i[n],i[n+1],i[n+2],1);for(var n=r,r=3*t;n<r;n+=3)e.push(1,1,1,1)},getVectors:function(e){for(var t=this.color_,i=0,n=t.length;i<n;++i){var r=t[i];e[i]=new s(r.r,r.g,r.b,1)}return e.length=n,e}}),o}),define("x_ite/Components/Followers/ColorChaser",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Color3","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,s,o){"use strict";function a(e){n.call(this,e),this.addType(r.ColorChaser)}var u=new o(0,0,0),l=new o(0,0,0),h=new o(0,0,0),c=new o(0,0,0);return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_value",new e.SFColor),new t(r.inputOnly,"set_destination",new e.SFColor),new t(r.initializeOnly,"initialValue",new e.SFColor(.8,.8,.8)),new t(r.initializeOnly,"initialDestination",new e.SFColor(.8,.8,.8)),new t(r.initializeOnly,"duration",new e.SFTime(1)),new t(r.outputOnly,"isActive",new e.SFBool),new t(r.outputOnly,"value_changed",new e.SFColor)]),getTypeName:function(){return"ColorChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new o(0,0,0)},getValue:function(){return this.set_value_.getValue().getHSV(c)},getDestination:function(){return this.set_destination_.getValue().getHSV(c)},getInitialValue:function(){return this.initialValue_.getValue().getHSV(u)},getInitialDestination:function(){
return this.initialDestination_.getValue().getHSV(l)},setValue:function(e){this.value_changed_.setHSV(e.x,e.y,e.z)},interpolate:function(e,t,i){return s.lerp(e,t,i,c)},step:function(e,t,i){h.assign(this.output).add(e).subtract(t),s.lerp(this.output,h,i,this.output)}}),a}),define("x_ite/Components/Followers/X3DDamperNode",["x_ite/Components/Followers/X3DFollowerNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(e,t,i){"use strict";function n(i){e.call(this,i),this.addType(t.X3DDamperNode)}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,initialize:function(){e.prototype.initialize.call(this),this.order_.addInterest("set_order__",this),this.set_value_.addInterest("set_value__",this),this.set_destination_.addInterest("set_destination__",this);var t=this.getBuffer(),i=this.getInitialValue(),n=this.getInitialDestination();t[0]=this.duplicate(n);for(var r=1,s=this.getOrder()+1;r<s;++r)t[r]=this.duplicate(i);this.equals(n,i,this.getTolerance())?this.setValue(n):this.set_active(!0)},getOrder:function(){return i.clamp(this.order_.getValue(),0,5)},getTolerance:function(){return this.tolerance_.getValue()<0?1e-4:this.tolerance_.getValue()},prepareEvents:function(){var e=this.getBuffer(),t=e.length-1;if(this.tau_.getValue()){for(var i=1/this.getBrowser().currentFrameRate,n=Math.exp(-i/this.tau_.getValue()),r=0;r<t;++r)try{this.assign(e,r+1,this.interpolate(e[r],e[r+1],n))}catch(e){}if(this.setValue(e[t]),!this.equals(e[t],e[0],this.getTolerance()))return}else this.setValue(e[0]),t=0;for(var r=1,s=e.length;r<s;++r)this.assign(e,r,e[t]);this.set_active(!1)},set_value__:function(){for(var e=this.getBuffer(),t=this.getValue(),i=1,n=e.length;i<n;++i)this.assign(e,i,t);this.setValue(t),this.set_active(!0)},set_destination__:function(){this.assign(this.getBuffer(),0,this.getDestination()),this.set_active(!0)},set_order__:function(){for(var e=this.getBuffer(),t=e[e.length-1],i=e.length,n=this.getOrder()+1;i<n;++i)e[i]=this.duplicate(t);e.length=n}}),n}),define("x_ite/Components/Followers/ColorDamper",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Color3","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,s,o){"use strict";function a(e){n.call(this,e),this.addType(r.ColorDamper)}var u=new o(0,0,0),l=new o(0,0,0),h=new o(0,0,0),c=new o(0,0,0);return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_value",new e.SFColor),new t(r.inputOnly,"set_destination",new e.SFColor),new t(r.initializeOnly,"initialValue",new e.SFColor(.8,.8,.8)),new t(r.initializeOnly,"initialDestination",new e.SFColor(.8,.8,.8)),new t(r.initializeOnly,"order",new e.SFInt32(3)),new t(r.inputOutput,"tau",new e.SFTime(.3)),new t(r.inputOutput,"tolerance",new e.SFFloat(-1)),new t(r.outputOnly,"isActive",new e.SFBool),new t(r.outputOnly,"value_changed",new e.SFColor)]),getTypeName:function(){return"ColorDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new o(0,0,0)},getValue:function(){return this.set_value_.getValue().getHSV(c)},getDestination:function(){return this.set_destination_.getValue().getHSV(c)},getInitialValue:function(){return this.initialValue_.getValue().getHSV(l)},getInitialDestination:function(){return this.initialDestination_.getValue().getHSV(h)},setValue:function(e){this.value_changed_.setHSV(e.x,e.y,e.z)},equals:function(e,t,i){return u.assign(e).subtract(t).abs()<i},interpolate:function(e,t,i){return s.lerp(e,t,i,c)}}),a}),define("x_ite/Components/Interpolation/ColorInterpolator",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Color3"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.ColorInterpolator),this.hsv=[]}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_fraction",new e.SFFloat),new t(r.inputOutput,"key",new e.MFFloat),new t(r.inputOutput,"keyValue",new e.MFColor),new t(r.outputOnly,"value_changed",new e.SFColor)]),getTypeName:function(){return"ColorInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){var t=this.keyValue_;t.length<this.key_.length&&this.keyValue_.resize(this.key_.length,t.length?t[this.keyValue_.length-1]:new e.SFColor),this.hsv.length=0;for(var i=0,n=t.length;i<n;++i)this.hsv.push(t[i].getHSV([]))},interpolate:function(){var e=[];return function(t,i,n){s.lerp(this.hsv[t],this.hsv[i],n,e),this.value_changed_.setHSV(e[0],e[1],e[2])}}()}),o}),define("x_ite/Components/Rendering/ColorRGBA",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DColorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector4"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.ColorRGBA)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"color",new e.MFColorRGBA)]),getTypeName:function(){return"ColorRGBA"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"color"},initialize:function(){n.prototype.initialize.call(this),this.color_.addInterest("set_color__",this),this.set_color__()},set_color__:function(){this.color=this.color_.getValue(),this.length=this.color_.length},isTransparent:function(){return!0},addColor:function(e,t){if(e>=0&&e<this.length){const i=this.color;e*=4,t.push(i[e],i[e+1],i[e+2],i[e+3])}else if(this.color_.length){const i=this.color;e=4*(this.color_.length-1),t.push(i[e],i[e+1],i[e+2],i[e+3])}else t.push(1,1,1,1)},addColors:function(e,t){const i=this.color;for(var n=0,r=4*this.length;n<r;n+=4)e.push(i[n],i[n+1],i[n+2],i[n+3]);for(var n=r,r=4*t;n<r;n+=4)e.push(1,1,1,1)},getVectors:function(e){for(var t=this.color_,i=0,n=t.length;i<n;++i){var r=t[i];e[i]=new s(r.r,r.g,r.b,r.a)}return e.length=n,e}}),o}),define("x_ite/Components/CubeMapTexturing/X3DEnvironmentTextureNode",["x_ite/Components/Texturing/X3DTextureNode","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DEnvironmentTextureNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,initialize:function(){e.prototype.initialize.call(this);var t=this.getBrowser().getContext();this.target=t.TEXTURE_CUBE_MAP,this.targets=[t.TEXTURE_CUBE_MAP_POSITIVE_Z,t.TEXTURE_CUBE_MAP_NEGATIVE_Z,t.TEXTURE_CUBE_MAP_NEGATIVE_X,t.TEXTURE_CUBE_MAP_POSITIVE_X,t.TEXTURE_CUBE_MAP_POSITIVE_Y,t.TEXTURE_CUBE_MAP_NEGATIVE_Y]},set_live__:function(){this.isLive().getValue()?(this.getBrowser().getBrowserOptions().TextureQuality_.addInterest("set_textureQuality__",this),this.set_textureQuality__()):this.getBrowser().getBrowserOptions().TextureQuality_.removeInterest("set_textureQuality__",this)},set_textureQuality__:function(){var e=this.getBrowser().getDefaultTextureProperties();this.updateTextureProperties(this.target,!1,e,128,128,!1,!1,!1)},getTarget:function(){return this.target},getTargets:function(){return this.targets},setShaderUniforms:function(e,t,i){t.textureTypeArray[i]=4,e.activeTexture(e.TEXTURE4),e.bindTexture(e.TEXTURE_CUBE_MAP,this.getTexture()),e.uniform1iv(t.x3d_TextureType,t.textureTypeArray)},clearTexture:function(){var e=new Uint8Array([255,255,255,255]);return function(){var t=this.getBrowser().getContext(),i=this.getTargets();t.bindTexture(t.TEXTURE_2D,this.getTexture());for(var n=0,r=i.length;n<r;++n)t.texImage2D(i[n],0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,e)}}()}),i}),define("x_ite/Components/CubeMapTexturing/ComposedCubeMapTexture",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/CubeMapTexturing/X3DEnvironmentTextureNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(s.ComposedCubeMapTexture),this.textures=[null,null,null,null,null,null],this.loadStates=0}var a=new Uint8Array([255,255,255,255]);return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"front",new e.SFNode),new t(s.inputOutput,"back",new e.SFNode),new t(s.inputOutput,"left",new e.SFNode),new t(s.inputOutput,"right",new e.SFNode),new t(s.inputOutput,"bottom",new e.SFNode),new t(s.inputOutput,"top",new e.SFNode)]),getTypeName:function(){return"ComposedCubeMapTexture"},getComponentName:function(){return"CubeMapTexturing"},getContainerField:function(){return"texture"},initialize:function(){n.prototype.initialize.call(this);var e=this.getBrowser().getContext();e.bindTexture(this.getTarget(),this.getTexture());for(var t=0;t<6;++t)e.texImage2D(this.getTargets()[t],0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,a);this.isLive().addInterest("set_live__",this),this.front_.addInterest("set_texture__",this,0),this.back_.addInterest("set_texture__",this,1),this.left_.addInterest("set_texture__",this,2),this.right_.addInterest("set_texture__",this,3),this.top_.addInterest("set_texture__",this,5),this.bottom_.addInterest("set_texture__",this,4),this.set_texture__(this.front_,0),this.set_texture__(this.back_,1),this.set_texture__(this.left_,2),this.set_texture__(this.right_,3),this.set_texture__(this.top_,4),this.set_texture__(this.bottom_,5),this.set_live__()},set_texture__:function(e,t){var i=this.textures[t];if(i){var n="set_loadState__"+i.getId()+"_"+t;i.removeInterest("set_loadState__",this),i.loadState_.removeFieldCallback(n)}var i=this.textures[t]=r(s.X3DTexture2DNode,e);if(i){var n="set_loadState__"+i.getId()+"_"+t;i.addInterest("set_loadState__",this,i,t),i.loadState_.addFieldCallback(n,this.set_loadState__.bind(this,null,i,t))}this.set_loadState__(null,i,t)},set_loadState__:function(e,t,i){t?this.setLoadStateBit(t.checkLoadState(),i):this.setLoadStateBit(s.NOT_STARTED,i),this.setTextures()},setLoadStateBit:function(e,t){e===s.COMPLETE_STATE?this.loadStates|=1<<t:this.loadStates&=~(1<<t)},isComplete:function(){if(63!==this.loadStates)return!1;for(var e=this.textures,t=e[0].getWidth(),i=0;i<6;++i){var n=e[i];if(n.getWidth()!==t)return!1;if(n.getHeight()!==t)return!1}return!0},setTextures:function(){var e=this.getBrowser().getContext();if(e.bindTexture(this.getTarget(),this.getTexture()),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1),this.isComplete()){for(var t=this.textures,i=0;i<6;++i){var e=this.getBrowser().getContext(),n=t[i],r=n.getWidth(),s=n.getHeight(),o=n.getData();e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!n.getFlipY()),e.pixelStorei(e.UNPACK_ALIGNMENT,1),o instanceof Uint8Array?e.texImage2D(this.getTargets()[i],0,e.RGBA,r,s,!1,e.RGBA,e.UNSIGNED_BYTE,o):e.texImage2D(this.getTargets()[i],0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,o)}this.set_textureQuality__()}else for(var i=0;i<6;++i)e.texImage2D(this.getTargets()[i],0,e.RGBA,1,1,!1,e.RGBA,e.UNSIGNED_BYTE,a);this.set_transparent__()},set_transparent__:function(){var e=this.textures,t=!1;if(this.isComplete())for(var i=0;i<6;++i)if(e[i].transparent_.getValue()){t=!0;break}t!==this.transparent_.getValue()&&(this.transparent_=t)}}),o}),define("x_ite/Components/Geometry3D/Cone",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,s,o,a){"use strict";function u(e){n.call(this,e),this.addType(r.Cone),this.height_.setUnit("length"),this.bottomRadius_.setUnit("length")}return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"side",new e.SFBool(!0)),new t(r.initializeOnly,"bottom",new e.SFBool(!0)),new t(r.initializeOnly,"height",new e.SFFloat(2)),new t(r.initializeOnly,"bottomRadius",new e.SFFloat(1)),new t(r.initializeOnly,"solid",new e.SFBool(!0))]),getTypeName:function(){return"Cone"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},set_live__:function(){n.prototype.set_live__.call(this),this.isLive().getValue()?this.getBrowser().getConeOptions().addInterest("eventsProcessed",this):this.getBrowser().getConeOptions().removeInterest("eventsProcessed",this)},build:function(){var e=this.getBrowser().getConeOptions(),t=e.xDimension_.getValue(),i=this.height_.getValue(),n=this.bottomRadius_.getValue(),r=this.getTexCoords(),u=this.getNormals(),l=this.getVertices();this.getMultiTexCoords().push(r);var h=i/2,c=-h,d=s.Polar(1,-Math.PI/2+Math.atan(n/i));if(this.side_.getValue())for(var p=0;p<t;++p){var f=(p+.5)/t,g=2*Math.PI*f,m=s.Polar(d.imag,g),_=p/t,x=2*Math.PI*_,y=s.Polar(-n,x),v=s.Polar(d.imag,x),w=(p+1)/t,b=2*Math.PI*w,S=s.Polar(-n,b),C=s.Polar(d.imag,b);r.push(f,1,0,1),u.push(m.imag,d.real,m.real),l.push(0,h,0,1),r.push(_,0,0,1),u.push(v.imag,d.real,v.real),l.push(y.imag,c,y.real,1),r.push(w,0,0,1),u.push(C.imag,d.real,C.real),l.push(S.imag,c,S.real,1)}if(this.bottom_.getValue()){for(var T=[],F=[],p=t-1;p>-1;--p){var O=p/t,N=2*Math.PI*O,M=s.Polar(-1,N),D=s.multiply(M,n);T.push(new o((M.imag+1)/2,(M.real+1)/2)),F.push(new a(D.imag,c,D.real))}for(var E=T[0],V=F[0],p=1,B=F.length-1;p<B;++p){var I=T[p],A=T[p+1],P=F[p],y=F[p+1];r.push(E.x,E.y,0,1),u.push(0,-1,0),l.push(V.x,V.y,V.z,1),r.push(I.x,I.y,0,1),u.push(0,-1,0),l.push(P.x,P.y,P.z,1),r.push(A.x,A.y,0,1),u.push(0,-1,0),l.push(y.x,y.y,y.z,1)}}this.setSolid(this.solid_.getValue()),this.setExtents()},setExtents:function(){var e=this.bottomRadius_.getValue(),t=this.height_.getValue()/2,i=-t;this.side_.getValue()||this.bottom_.getValue()?this.side_.getValue()?(this.getMin().set(-e,i,-e),this.getMax().set(e,t,e)):(this.getMin().set(-e,i,-e),this.getMax().set(e,i,e)):(this.getMin().set(0,0,0),this.getMax().set(0,0,0))}}),u}),define("x_ite/Components/ParticleSystems/ConeEmitter",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/ParticleSystems/X3DParticleEmitterNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4"],function(e,t,i,n,r,s,o){"use strict";function a(e){n.call(this,e),this.addType(r.ConeEmitter),this.position_.setUnit("length"),this.angle_.setUnit("angle"),this.speed_.setUnit("speed"),this.mass_.setUnit("mass"),this.surfaceArea_.setUnit("area"),this.rotation=new o(0,0,1,0)}return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"position",new e.SFVec3f),new t(r.inputOutput,"direction",new e.SFVec3f(0,1,0)),new t(r.inputOutput,"angle",new e.SFFloat(.7854)),new t(r.inputOutput,"speed",new e.SFFloat),new t(r.inputOutput,"variation",new e.SFFloat(.25)),new t(r.initializeOnly,"mass",new e.SFFloat),new t(r.initializeOnly,"surfaceArea",new e.SFFloat)]),getTypeName:function(){return"ConeEmitter"},getComponentName:function(){return"ParticleSystems"},getContainerField:function(){return"emitter"},initialize:function(){n.prototype.initialize.call(this),this.position_.addInterest("set_position__",this),this.direction_.addInterest("set_direction__",this),this.angle_.addInterest("set_angle__",this),this.set_position__(),this.set_direction__(),this.set_angle__()},set_position__:function(){this.position=this.position_.getValue()},set_direction__:function(){var e=this.direction_.getValue();this.rotation.setFromToVec(s.zAxis,e),e.equals(s.Zero)?this.getRandomVelocity=this.getSphericalRandomVelocity:delete this.getRandomVelocity},set_angle__:function(){this.angle=this.angle_.getValue()},getRandomPosition:function(e){return e.assign(this.position)},getRandomVelocity:function(e){return this.rotation.multVecRot(this.getRandomNormalWithAngle(this.angle,e).multiply(this.getRandomSpeed()))}}),a}),define("x_ite/Browser/Followers/X3DArrayFollowerTemplate",[],function(){"use strict";return function(e){function t(){this.array=this.getArray()}return t.prototype={getValue:function(){return this.set_value_},getDestination:function(){return this.set_destination_},getInitialValue:function(){return this.initialValue_},getInitialDestination:function(){return this.initialDestination_},assign:function(e,t,i){e[t].setValue(i)},equals:function(e,t,i){for(var n=this.a,r=0,s=0,o=e.length;s<o;++s)r=Math.max(n.assign(e[s].getValue()).subtract(t[s].getValue()).abs());return r<i},interpolate:function(e,t,i){var n=this.array;n.length=e.length;for(var r=0,s=e.length;r<s;++r)n[r]=e[r].getValue().lerp(t[r].getValue(),i);return n},set_value__:function(){this.getBuffer()[0].length=this.set_value_.length,e.prototype.set_value__.call(this)},set_destination__:function(){for(var t=this.getBuffer(),i=this.set_destination_.length,n=0,r=t.length;n<r;++n)t[n].length=i;e.prototype.set_destination__.call(this)}},t}}),define("x_ite/Browser/Followers/X3DArrayChaserTemplate",["x_ite/Browser/Followers/X3DArrayFollowerTemplate"],function(e){"use strict";return function(t){function i(){this.array=this.getArray()}var n=e(t);return Object.assign(i.prototype,n.prototype,{setPreviousValue:function(e){this.previousValue.setValue(e)},step:function(e,t,i){var n=this.output,r=this.deltaOut;r.length=n.length;for(var s=0,o=n.length;s<o;++s){var a=r[s]=e[s];n[s]=n[s].getValue().add(a.getValue().subtract(t[s].getValue()).multiply(i))}}}),i}}),define("x_ite/Components/Followers/CoordinateChaser",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Browser/Followers/X3DArrayChaserTemplate","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,s,o){"use strict";function a(e){n.call(this,e),u.call(this,e),this.addType(s.CoordinateChaser)}var u=r(n);return a.prototype=Object.assign(Object.create(n.prototype),u.prototype,{constructor:a,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOnly,"set_value",new e.MFVec3f),new t(s.inputOnly,"set_destination",new e.MFVec3f),new t(s.initializeOnly,"initialValue",new e.MFVec3f(new o(0,0,0))),new t(s.initializeOnly,"initialDestination",new e.MFVec3f(new o(0,0,0))),new t(s.initializeOnly,"duration",new e.SFTime(1)),new t(s.outputOnly,"isActive",new e.SFBool),new t(s.outputOnly,"value_changed",new e.MFVec3f)]),getTypeName:function(){return"CoordinateChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new o(0,0,0)},getArray:function(){return new e.MFVec3f}}),a}),define("x_ite/Components/Followers/CoordinateDamper",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Browser/Followers/X3DArrayFollowerTemplate","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,s,o){"use strict";function a(e){n.call(this,e),u.call(this,e),this.addType(s.CoordinateDamper)}var u=r(n);return a.prototype=Object.assign(Object.create(n.prototype),u.prototype,{constructor:a,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOnly,"set_value",new e.MFVec3f),new t(s.inputOnly,"set_destination",new e.MFVec3f),new t(s.initializeOnly,"initialValue",new e.MFVec3f(new o(0,0,0))),new t(s.initializeOnly,"initialDestination",new e.MFVec3f(new o(0,0,0))),new t(s.initializeOnly,"order",new e.SFInt32(3)),new t(s.inputOutput,"tau",new e.SFTime(.3)),new t(s.inputOutput,"tolerance",new e.SFFloat(-1)),new t(s.outputOnly,"isActive",new e.SFBool),new t(s.outputOnly,"value_changed",new e.MFVec3f)]),getTypeName:function(){return"CoordinateDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new o(0,0,0)},getArray:function(){return new e.MFVec3f}}),a}),define("x_ite/Components/NURBS/CoordinateDouble",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DCoordinateNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.CoordinateDouble)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"point",new e.MFVec3d)]),getTypeName:function(){return"CoordinateDouble"},getComponentName:function(){return"NURBS"},getContainerField:function(){return"coord"}}),s}),define("x_ite/Components/Interpolation/CoordinateInterpolator",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.CoordinateInterpolator)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_fraction",new e.SFFloat),new t(r.inputOutput,"key",new e.MFFloat),new t(r.inputOutput,"keyValue",new e.MFVec3f),new t(r.outputOnly,"value_changed",new e.MFVec3f)]),getTypeName:function(){return"CoordinateInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},set_keyValue__:function(){},interpolate:function(e,t,i){var n=this.keyValue_.getValue(),r=this.key_.length?Math.floor(this.keyValue_.length/this.key_.length):0;this.value_changed_.length=r;var o=this.value_changed_.getValue();e*=r,t=e+(this.key_.length>1?r:0),e*=3,t*=3,r*=3;for(var a=0;a<r;a+=3){var u=a+1,l=a+2;o[a]=s.lerp(n[e+a],n[t+a],i),o[u]=s.lerp(n[e+u],n[t+u],i),o[l]=s.lerp(n[e+l],n[t+l],i)}this.value_changed_.addEvent()}}),o}),define("x_ite/Components/Interpolation/CoordinateInterpolator2D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.CoordinateInterpolator2D)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_fraction",new e.SFFloat),new t(r.inputOutput,"key",new e.MFFloat),new t(r.inputOutput,"keyValue",new e.MFVec2f),new t(r.outputOnly,"value_changed",new e.MFVec2f)]),getTypeName:function(){return"CoordinateInterpolator2D"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},set_keyValue__:function(){},interpolate:function(e,t,i){var n=this.keyValue_.getValue(),r=this.key_.length?Math.floor(this.keyValue_.length/this.key_.length):0;this.value_changed_.length=r;var o=this.value_changed_.getValue();e*=r,t=e+(this.key_.length>1?r:0),e*=2,t*=2,r*=2;for(var a=0;a<r;a+=2){var u=a+1;o[a]=s.lerp(n[e+a],n[t+a],i),o[u]=s.lerp(n[e+u],n[t+u],i)}this.value_changed_.addEvent()}}),o}),define("x_ite/Components/Geometry3D/Cylinder",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,s,o,a){"use strict";function u(e){n.call(this,e),this.addType(r.Cylinder),this.height_.setUnit("length"),this.radius_.setUnit("length")}return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"top",new e.SFBool(!0)),new t(r.initializeOnly,"side",new e.SFBool(!0)),new t(r.initializeOnly,"bottom",new e.SFBool(!0)),new t(r.initializeOnly,"height",new e.SFFloat(2)),new t(r.initializeOnly,"radius",new e.SFFloat(1)),new t(r.initializeOnly,"solid",new e.SFBool(!0))]),getTypeName:function(){return"Cylinder"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},set_live__:function(){n.prototype.set_live__.call(this),this.isLive().getValue()?this.getBrowser().getCylinderOptions().addInterest("eventsProcessed",this):this.getBrowser().getCylinderOptions().removeInterest("eventsProcessed",this)},build:function(){var e=this.getBrowser().getCylinderOptions(),t=e.xDimension_.getValue(),i=this.getTexCoords(),n=this.getNormals(),r=this.getVertices();this.getMultiTexCoords().push(i);var u=this.radius_.getValue(),l=this.height_.getValue()/2,h=-l;if(this.side_.getValue())for(var c=0;c<t;++c){var d=c/t,p=2*Math.PI*d,f=s.Polar(-1,p),g=s.multiply(f,u),m=(c+1)/t,_=2*Math.PI*m,x=s.Polar(-1,_),y=s.multiply(x,u);i.push(d,1,0,1),n.push(f.imag,0,f.real),r.push(g.imag,l,g.real,1),i.push(d,0,0,1),n.push(f.imag,0,f.real),r.push(g.imag,h,g.real,1),i.push(m,0,0,1),n.push(x.imag,0,x.real),r.push(y.imag,h,y.real,1),i.push(d,1,0,1),n.push(f.imag,0,f.real),r.push(g.imag,l,g.real,1),i.push(m,0,0,1),n.push(x.imag,0,x.real),r.push(y.imag,h,y.real,1),i.push(m,1,0,1),n.push(x.imag,0,x.real),r.push(y.imag,l,y.real,1)}if(this.top_.getValue()){for(var v=[],w=[],c=0;c<t;++c){var b=c/t,S=2*Math.PI*b,C=s.Polar(-1,S);v.push(new o((C.imag+1)/2,-(C.real-1)/2)),w.push(new a(C.imag*u,l,C.real*u))}for(var T=v[0],F=w[0],c=1,O=w.length-1;c<O;++c){var N=v[c],M=v[c+1],g=w[c],y=w[c+1];i.push(T.x,T.y,0,1),n.push(0,1,0),r.push(F.x,F.y,F.z,1),i.push(N.x,N.y,0,1),n.push(0,1,0),r.push(g.x,g.y,g.z,1),i.push(M.x,M.y,0,1),n.push(0,1,0),r.push(y.x,y.y,y.z,1)}}if(this.bottom_.getValue()){for(var v=[],w=[],c=t-1;c>-1;--c){var b=c/t,S=2*Math.PI*b,C=s.Polar(-1,S);v.push(new o((C.imag+1)/2,(C.real+1)/2)),w.push(new a(C.imag*u,h,C.real*u))}for(var T=v[0],F=w[0],c=1,O=w.length-1;c<O;++c){var N=v[c],M=v[c+1],g=w[c],y=w[c+1];i.push(T.x,T.y,0,1),n.push(0,-1,0),r.push(F.x,F.y,F.z,1),i.push(N.x,N.y,0,1),n.push(0,-1,0),r.push(g.x,g.y,g.z,1),i.push(M.x,M.y,0,1),n.push(0,-1,0),r.push(y.x,y.y,y.z,1)}}this.setSolid(this.solid_.getValue()),this.setExtents()},setExtents:function(){var e=this.radius_.getValue(),t=this.height_.getValue()/2,i=-t;this.top_.getValue()||this.side_.getValue()||this.bottom_.getValue()?this.top_.getValue()||this.side_.getValue()?this.bottom_.getValue()||this.side_.getValue()?(this.getMin().set(-e,i,-e),this.getMax().set(e,t,e)):(this.getMin().set(-e,t,-e),this.getMax().set(e,t,e)):(this.getMin().set(-e,i,-e),this.getMax().set(e,i,e)):(this.getMin().set(0,0,0),this.getMax().set(0,0,0))}}),u}),define("x_ite/Components/PointingDeviceSensor/X3DDragSensorNode",["x_ite/Components/PointingDeviceSensor/X3DPointingDeviceSensorNode","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DDragSensorNode),this.trackPoint_changed_.setUnit("length")}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i}),i}),define("standard/Math/Geometry/Cylinder3",["standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Line3"],function(e,t,i,n){"use strict";function r(e,t){this.axis=e.copy(),this.radius=t}return r.prototype={constructor:r,intersectsLine:function(r,s,o){var a=new t(this.axis.direction,new e(0,1,0)),u=i.Rotation(a),l=1/this.radius,h=new i;h.scale(new e(l,l,l)),h.multLeft(u);var c=e.subtract(r.point,this.axis.point),d=new n(c,r.direction),p=d.multLineMatrix(h),f=this.unitCylinderIntersectsLine(p,s,o);if(f){var g=h.inverse();g.multVecMatrix(s),s.add(this.axis.point),g.multVecMatrix(o),o.add(this.axis.point)}return f},unitCylinderIntersectsLine:function(e,t,i){var n,r,s=e.point,o=e.direction,a=o[0]*o[0]+o[2]*o[2],u=2*(s[0]*o[0]+s[2]*o[2]),l=s[0]*s[0]+s[2]*s[2]-1,h=u*u-4*a*l;if(h<0)return!1;var c=Math.sqrt(h);return u>0?(n=-(2*l)/(c+u),r=-(c+u)/(2*a)):(n=2*l/(c-u),r=(c-u)/(2*a)),t.assign(o).multiply(n).add(s),i.assign(o).multiply(r).add(s),!0},toString:function(){return this.axis.toString()+" "+this.radius}},r}),define("x_ite/Components/PointingDeviceSensor/CylinderSensor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/PointingDeviceSensor/X3DDragSensorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Line3","standard/Math/Geometry/Plane3","standard/Math/Geometry/Cylinder3","standard/Math/Algorithm"],function(e,t,i,n,r,s,o,a,u,l,h,c){"use strict";function d(e){n.call(this,e),this.addType(r.CylinderSensor),this.diskAngle_.setUnit("angle"),this.minAngle_.setUnit("angle"),this.maxAngle_.setUnit("angle"),this.offset_.setUnit("angle")}return d.prototype=Object.assign(Object.create(n.prototype),{constructor:d,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"enabled",new e.SFBool(!0)),new t(r.inputOutput,"description",new e.SFString),new t(r.inputOutput,"axisRotation",new e.SFRotation),new t(r.inputOutput,"diskAngle",new e.SFFloat(.261792)),new t(r.inputOutput,"minAngle",new e.SFFloat),new t(r.inputOutput,"maxAngle",new e.SFFloat(-1)),new t(r.inputOutput,"offset",new e.SFFloat),new t(r.inputOutput,"autoOffset",new e.SFBool(!0)),new t(r.outputOnly,"trackPoint_changed",new e.SFVec3f),new t(r.outputOnly,"rotation_changed",new e.SFRotation),new t(r.outputOnly,"isOver",new e.SFBool),new t(r.outputOnly,"isActive",new e.SFBool)]),getTypeName:function(){return"CylinderSensor"},getComponentName:function(){return"PointingDeviceSensor"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.modelViewMatrix=new a,this.invModelViewMatrix=new a,this.cylinder=new h(new u(new s(0,0,0),new s(0,0,0)),0),this.disk=!1,this.yPlane=null,this.zPlane=null,this.sxPlane=null,this.szNormal=null,this.behind=!1,this.fromVector=new s(0,0,0),this.startOffset=new o(0,0,1,0)},isBehind:function(e,t){var i=new s(0,0,0),n=new s(0,0,0);return this.cylinder.intersectsLine(e,i,n),s.subtract(t,i).abs()>s.subtract(t,n).abs()},getTrackPoint:function(e,t){var i=new s(0,0,0);this.zPlane.intersectsLine(e,i);var n=s.add(i,this.cylinder.axis.getPerpendicularVector(i)),r=this.sxPlane.getDistanceToPoint(i)/this.cylinder.radius,a=Math.floor((r+1)/2),u=c.interval(r,-1,1),l=0===a?Math.asin(u):u*Math.PI/2,h=l+a*Math.PI;new o(this.cylinder.axis.direction,h).multVecRot(t.assign(this.szNormal).multiply(this.cylinder.radius)),t.add(n)},getAngle:function(e){return s.dot(e.getAxis(),this.cylinder.axis.direction)>0?e.angle:-e.angle},set_active__:function(e,t,i,r,a){n.prototype.set_active__.call(this,e,t,i,r,a);try{if(this.isActive_.getValue()){this.modelViewMatrix.assign(i),this.invModelViewMatrix.assign(i).inverse();var c=t.hitRay.copy().multLineMatrix(this.invModelViewMatrix),d=this.invModelViewMatrix.multVecMatrix(t.intersection.point.copy()),p=this.axisRotation_.getValue().multVecRot(new s(0,1,0)),f=this.invModelViewMatrix.multDirMatrix(new s(0,0,1)).normalize(),g=new u(new s(0,0,0),p),m=g.getPerpendicularVector(d).abs();this.cylinder=new h(g,m),this.disk=Math.abs(s.dot(f,p))>Math.cos(this.diskAngle_.getValue()),this.behind=this.isBehind(c,d),this.yPlane=new l(d,p),this.zPlane=new l(d,f);var _=this.invModelViewMatrix.origin,x=s.cross(p,_).normalize();this.sxPlane=new l(new s(0,0,0),x),this.szNormal=s.cross(x,p).normalize();var y=new s(0,0,0);this.disk?this.yPlane.intersectsLine(c,y):this.getTrackPoint(c,y),this.fromVector=this.cylinder.axis.getPerpendicularVector(y).negate(),
this.startOffset=new o(p,this.offset_.getValue()),this.trackPoint_changed_=y,this.rotation_changed_=this.startOffset}else this.autoOffset_.getValue()&&(this.offset_=this.getAngle(this.rotation_changed_.getValue()))}catch(e){}},set_motion__:function(e){try{var t=e.hitRay.copy().multLineMatrix(this.invModelViewMatrix),i=new s(0,0,0);this.disk?this.yPlane.intersectsLine(t,i):this.getTrackPoint(t,i),this.trackPoint_changed_=i;var n=this.cylinder.axis.getPerpendicularVector(i).negate(),r=new o(this.fromVector,n);if(this.disk){this.modelViewMatrix.multVecMatrix(i.copy()).z>0&&r.multRight(new o(this.yPlane.normal,Math.PI))}else this.behind&&r.inverse();if(r.multLeft(this.startOffset),this.minAngle_.getValue()>this.maxAngle_.getValue())this.rotation_changed_=r;else{var a=c.interval(this.getAngle(r),-Math.PI,Math.PI),u=c.interval(this.minAngle_.getValue(),-Math.PI,Math.PI),l=c.interval(this.maxAngle_.getValue(),-Math.PI,Math.PI);a<u?r.setAxisAngle(this.cylinder.axis.direction,u):a>l&&r.setAxisAngle(this.cylinder.axis.direction,l),this.rotation_changed_.getValue().equals(r)||(this.rotation_changed_=r)}}catch(e){this.trackPoint_changed_.addEvent(),this.rotation_changed_.addEvent()}}}),d}),define("x_ite/Components/Geometry2D/Disk2D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Components/Rendering/X3DLineGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,s,o){"use strict";function a(e){r.call(this,e),this.addType(s.Disk2D),this.innerRadius_.setUnit("length"),this.outerRadius_.setUnit("length")}return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"innerRadius",new e.SFFloat),new t(s.inputOutput,"outerRadius",new e.SFFloat(1)),new t(s.initializeOnly,"solid",new e.SFBool)]),getTypeName:function(){return"Disk2D"},getComponentName:function(){return"Geometry2D"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this.setPrimitiveMode(this.getBrowser().getContext().LINE_LOOP)},getShader:function(e){return e.getLineShader()},set_live__:function(){n.prototype.set_live__.call(this),this.isLive().getValue()?this.getBrowser().getDisk2DOptions().addInterest("eventsProcessed",this):this.getBrowser().getDisk2DOptions().removeInterest("eventsProcessed",this)},build:function(){var e=this.getBrowser().getDisk2DOptions(),t=this.innerRadius_.getValue(),i=this.outerRadius_.getValue();if(t===i){var n=Math.abs(i),r=this.getVertices();if(1===n)this.setVertices(e.getCircleVertices());else for(var s=e.getCircleVertices().getValue(),o=0,a=s.length;o<a;o+=4)r.push(s[o]*n,s[o+1]*n,0,1);return this.getMin().set(-n,-n,0),this.getMax().set(n,n,0),void this.setGeometryType(1)}if(0===t||0===i){var n=Math.abs(Math.max(t,i));if(this.getMultiTexCoords().push(e.getDiskTexCoords()),this.setNormals(e.getDiskNormals()),1===n)this.setVertices(e.getDiskVertices());else for(var s=e.getDiskVertices().getValue(),r=this.getVertices(),o=0,a=s.length;o<a;o+=4)r.push(s[o]*n,s[o+1]*n,0,1);return this.getMin().set(-n,-n,0),this.getMax().set(n,n,0),this.setGeometryType(2),void this.setSolid(this.solid_.getValue())}var u=Math.abs(Math.max(t,i)),l=Math.abs(Math.min(t,i)),h=l/u,c=(1-h)/2,d=e.getDiskTexCoords().getValue(),s=e.getDiskVertices().getValue(),p=this.getTexCoords(),f=this.getNormals(),r=this.getVertices();this.getMultiTexCoords().push(p);for(var o=0,a=s.length;o<a;o+=12)p.push(d[o+4]*h+c,d[o+5]*h+c,0,1,d[o+4],d[o+5],0,1,d[o+8],d[o+9],0,1,d[o+4]*h+c,d[o+5]*h+c,0,1,d[o+8],d[o+9],0,1,d[o+8]*h+c,d[o+9]*h+c,0,1),f.push(0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1),r.push(s[o+4]*l,s[o+5]*l,0,1,s[o+4]*u,s[o+5]*u,0,1,s[o+8]*u,s[o+9]*u,0,1,s[o+4]*l,s[o+5]*l,0,1,s[o+8]*u,s[o+9]*u,0,1,s[o+8]*l,s[o+9]*l,0,1);this.getMin().set(-u,-u,0),this.getMax().set(u,u,0),this.setGeometryType(2),this.setSolid(this.solid_.getValue())},intersectsLine:function(e,t,i,s){return this.getGeometryType()<2?r.prototype.intersectsLine.call(this,e,t,i,s):n.prototype.intersectsLine.call(this,e,t,i,s)},intersectsBox:function(e,t,i){return this.getGeometryType()<2?r.prototype.intersectsBox.call(this,e,t,i):n.prototype.intersectsBox.call(this,e,t,i)},display:function(e,t){return this.getGeometryType()<2?r.prototype.display.call(this,e,t):n.prototype.display.call(this,e,t)},displayParticles:function(e,t,i,s){return this.getGeometryType()<2?r.prototype.displayParticles.call(this,e,t,i,s):n.prototype.displayParticles.call(this,e,t,i,s)}}),a}),define("x_ite/Components/Geometry3D/ElevationGrid",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,s,o,a,u){"use strict";function l(e){n.call(this,e),this.addType(s.ElevationGrid),this.xSpacing_.setUnit("length"),this.zSpacing_.setUnit("length"),this.creaseAngle_.setUnit("angle"),this.height_.setUnit("length"),this.colorNode=null,this.texCoordNode=null,this.normalNode=null,this.coordNode=null}return l.prototype=Object.assign(Object.create(n.prototype),{constructor:l,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.initializeOnly,"xDimension",new e.SFInt32),new t(s.initializeOnly,"zDimension",new e.SFInt32),new t(s.initializeOnly,"xSpacing",new e.SFFloat(1)),new t(s.initializeOnly,"zSpacing",new e.SFFloat(1)),new t(s.initializeOnly,"solid",new e.SFBool(!0)),new t(s.initializeOnly,"ccw",new e.SFBool(!0)),new t(s.initializeOnly,"creaseAngle",new e.SFFloat),new t(s.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new t(s.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new t(s.inputOutput,"attrib",new e.MFNode),new t(s.inputOutput,"fogCoord",new e.SFNode),new t(s.inputOutput,"color",new e.SFNode),new t(s.inputOutput,"texCoord",new e.SFNode),new t(s.inputOutput,"normal",new e.SFNode),new t(s.inputOutput,"height",new e.MFFloat)]),getTypeName:function(){return"ElevationGrid"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this.attrib_.addInterest("set_attrib__",this),this.color_.addInterest("set_color__",this),this.texCoord_.addInterest("set_texCoord__",this),this.normal_.addInterest("set_normal__",this),this.set_attrib__(),this.set_color__(),this.set_texCoord__(),this.set_normal__()},set_attrib__:function(){for(var e=this.getAttrib(),t=0,i=e.length;t<i;++t)e[t].removeInterest("addNodeEvent",this);e.length=0;for(var t=0,i=this.attrib_.length;t<i;++t){var n=r(s.X3DVertexAttributeNode,this.attrib_[t]);n&&e.push(n)}for(var t=0;t<this.attribNodes.length;++t)e[t].addInterest("addNodeEvent",this)},set_color__:function(){this.colorNode&&(this.colorNode.removeInterest("addNodeEvent",this),this.colorNode.removeInterest("set_transparent__",this)),this.colorNode=r(s.X3DColorNode,this.color_),this.colorNode?(this.colorNode.addInterest("addNodeEvent",this),this.colorNode.addInterest("set_transparent__",this),this.set_transparent__()):this.transparent_=!1},set_transparent__:function(){this.transparent_=this.colorNode.isTransparent()},set_texCoord__:function(){this.texCoordNode&&this.texCoordNode.removeInterest("addNodeEvent",this),this.texCoordNode=r(s.X3DTextureCoordinateNode,this.texCoord_),this.texCoordNode&&this.texCoordNode.addInterest("addNodeEvent",this),this.setCurrentTexCoord(this.texCoordNode)},set_normal__:function(){this.normalNode&&this.normalNode.removeInterest("addNodeEvent",this),this.normalNode=r(s.X3DNormalNode,this.normal_),this.normalNode&&this.normalNode.addInterest("addNodeEvent",this)},getColor:function(){return this.colorNode},getTexCoord:function(){return this.texCoordNode},getNormal:function(){return this.normalNode},getHeight:function(e){return e<this.height_.length?this.height_[e]:0},createTexCoords:function(){for(var e=[],t=this.xDimension_.getValue(),i=this.zDimension_.getValue(),n=t-1,r=i-1,s=0;s<i;++s)for(var o=0;o<t;++o)e.push(new a(o/n,s/r));return e},createNormals:function(e,t,i){for(var n=!this.ccw_.getValue(),r=[],s=[],a=0;a<e.length;++a)r[a]=[];for(var l=0;l<t.length;l+=3){var h=t[l],c=t[l+1],d=t[l+2];r[h].push(s.length),r[c].push(s.length+1),r[d].push(s.length+2);var p=o.normal(e[h],e[c],e[d],new u(0,0,0));n&&p.negate(),s.push(p),s.push(p),s.push(p)}return this.refineNormals(r,s,this.creaseAngle_.getValue())},createCoordIndex:function(){for(var e=[],t=this.xDimension_.getValue(),i=this.zDimension_.getValue(),n=t-1,r=i-1,s=0;s<r;++s)for(var o=0;o<n;++o){var a=s*t+o,u=(s+1)*t+o,l=(s+1)*t+(o+1),h=s*t+(o+1);e.push(a),e.push(u),e.push(l),e.push(a),e.push(l),e.push(h)}return e},createPoints:function(){for(var e=[],t=this.xDimension_.getValue(),i=this.zDimension_.getValue(),n=this.xSpacing_.getValue(),r=this.zSpacing_.getValue(),s=0;s<i;++s)for(var o=0;o<t;++o)e.push(new u(n*o,this.getHeight(o+s*t),r*s));return e},build:function(){if(!(this.xDimension_.getValue()<2||this.zDimension_.getValue()<2)){var e=this.colorPerVertex_.getValue(),t=this.normalPerVertex_.getValue(),i=this.createCoordIndex(),n=this.getAttrib(),r=n.length,s=this.getAttribs(),o=this.getColor(),a=this.getTexCoord(),u=this.getNormal(),l=this.createPoints(),h=this.getColors(),c=this.getMultiTexCoords(),d=this.getNormals(),p=this.getVertices(),f=0;if(a)a.init(c);else{var g=this.createTexCoords(),m=this.getTexCoords();c.push(m)}for(var _=0,x=i.length;_<x;++f)for(var y=0;y<6;++y,++_){for(var v=i[_],w=l[v],b=0;b<r;++b)n[b].addValue(v,s[b]);if(o&&(e?o.addColor(v,h):o.addColor(f,h)),a)a.addTexCoord(v,c);else{var S=g[v];m.push(S.x,S.y,0,1)}u&&(t?u.addVector(v,d):u.addVector(f,d)),p.push(w.x,w.y,w.z,1)}if(!u)for(var C=this.createNormals(l,i),T=0;T<C.length;++T){var F=C[T];d.push(F.x,F.y,F.z)}this.setSolid(this.solid_.getValue()),this.setCCW(this.ccw_.getValue())}}}),l}),define("x_ite/Components/ParticleSystems/ExplosionEmitter",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/ParticleSystems/X3DParticleEmitterNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.ExplosionEmitter),this.position_.setUnit("length"),this.speed_.setUnit("speed"),this.mass_.setUnit("mass"),this.surfaceArea_.setUnit("area"),this.getRandomVelocity=this.getSphericalRandomVelocity}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"position",new e.SFVec3f),new t(r.inputOutput,"speed",new e.SFFloat),new t(r.inputOutput,"variation",new e.SFFloat(.25)),new t(r.initializeOnly,"mass",new e.SFFloat),new t(r.initializeOnly,"surfaceArea",new e.SFFloat)]),getTypeName:function(){return"ExplosionEmitter"},getComponentName:function(){return"ParticleSystems"},getContainerField:function(){return"emitter"},initialize:function(){n.prototype.initialize.call(this),this.position_.addInterest("set_position__",this),this.set_position__()},set_position__:function(){this.position=this.position_.getValue()},isExplosive:function(){return!0},getRandomPosition:function(e){return e.assign(this.position)}}),s}),define("x_ite/Components/Geometry3D/Extrusion",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r,s,o,a,u,l){"use strict";function h(e){n.call(this,e),this.addType(r.Extrusion),this.creaseAngle_.setUnit("angle"),this.crossSection_.setUnit("length"),this.spine_.setUnit("length")}return h.prototype=Object.assign(Object.create(n.prototype),{constructor:h,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"beginCap",new e.SFBool(!0)),new t(r.initializeOnly,"endCap",new e.SFBool(!0)),new t(r.initializeOnly,"solid",new e.SFBool(!0)),new t(r.initializeOnly,"ccw",new e.SFBool(!0)),new t(r.initializeOnly,"convex",new e.SFBool(!0)),new t(r.initializeOnly,"creaseAngle",new e.SFFloat),new t(r.inputOutput,"crossSection",new e.MFVec2f(new o(1,1),new o(1,-1),new o(-1,-1),new o(-1,1),new o(1,1))),new t(r.inputOutput,"orientation",new e.MFRotation(new u)),new t(r.inputOutput,"scale",new e.MFVec2f(new o(1,1))),new t(r.inputOutput,"spine",new e.MFVec3f(new a(0,0,0),new a(0,1,0)))]),getTypeName:function(){return"Extrusion"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},getClosedOrientation:function(){var e=this.orientation_;if(e.length){var t=e[0].getValue(),i=e[e.length-1].getValue();return t.equals(i)}return!0},createPoints:function(){var e=new a(1,1,1);return function(){for(var t=this.crossSection_,i=this.orientation_,n=this.scale_,r=this.spine_,s=[],o=this.createRotations(),u=0,l=r.length;u<l;++u){var h=o[u];if(i.length&&h.rotate(i[Math.min(u,i.length-1)].getValue()),n.length){var c=n[Math.min(u,n.length-1)].getValue();h.scale(e.set(c.x,1,c.y))}for(var d=0,p=t.length;d<p;++d){var f=t[d].getValue();s.push(h.multVecMatrix(new a(f.x,0,f.y)))}}return s}}(),createRotations:function(){var e=[],t=new a(0,0,0),i=new a(0,0,0),n=new a(0,0,0),r=new a(0,0,0),s=new a(0,0,0),o=new a(0,0,0),h=new u(0,0,1,0);return function(){for(var u=this.spine_,c=u.length,d=u[0].getValue(),p=u[u.length-1].getValue(),f=d.equals(p)&&this.getClosedOrientation(),g=e.length;g<c;++g)e[g]=new l;if(e.length=c,t.set(0,0,0),i.set(0,0,0),n.set(0,0,0),f){for(var g=1,m=c-2;g<m&&(i.assign(u[g].getValue()).subtract(u[m].getValue()).normalize(),i.equals(a.Zero));++g);for(var g=0,m=c-2;g<m&&(n.assign(u[g+1].getValue()).subtract(u[g].getValue()).cross(o.assign(u[m].getValue()).subtract(u[g].getValue())).normalize(),n.equals(a.Zero));++g);}else{for(var g=0,m=c-1;g<m&&(i.assign(u[g+1].getValue()).subtract(u[g].getValue()).normalize(),i.equals(a.Zero));++g);for(var g=1,m=c-1;g<m&&(n.assign(u[g+1].getValue()).subtract(u[g].getValue()).cross(o.assign(u[g-1].getValue()).subtract(u[g].getValue())).normalize(),n.equals(a.Zero));++g);}i.equals(a.Zero)&&i.set(0,1,0),n.equals(a.Zero)&&h.setFromToVec(a.yAxis,i).multVecRot(n.assign(a.zAxis)),t.assign(i).cross(n);var _=d;e[0].set(t.x,t.y,t.z,0,i.x,i.y,i.z,0,n.x,n.y,n.z,0,_.x,_.y,_.z,1),r.assign(i),s.assign(n);for(var g=1,m=c-1;g<m;++g){var _=u[g].getValue();i.assign(u[g+1].getValue()).subtract(u[g-1].getValue()).normalize(),n.assign(u[g+1].getValue()).subtract(_).cross(o.assign(u[g-1].getValue()).subtract(_)).normalize(),s.dot(n)<0&&n.negate(),i.equals(a.Zero)?i.assign(r):r.assign(i),n.equals(a.Zero)?n.assign(s):s.assign(n),t.assign(i).cross(n),e[g].set(t.x,t.y,t.z,0,i.x,i.y,i.z,0,n.x,n.y,n.z,0,_.x,_.y,_.z,1)}if(f)e[c-1].assign(e[0]);else{var _=p;i.assign(_).subtract(u[c-2].getValue()).normalize(),c>2&&n.assign(_).subtract(u[c-2].getValue()).cross(o.assign(u[c-3].getValue()).subtract(u[c-2].getValue())).normalize(),s.dot(n)<0&&n.negate(),i.equals(a.Zero)&&i.assign(r),n.equals(a.Zero)&&n.assign(s),t.assign(i).cross(n),e[c-1].set(t.x,t.y,t.z,0,i.x,i.y,i.z,0,n.x,n.y,n.z,0,_.x,_.y,_.z,1)}return e}}(),build:function(){var e=new o(0,0,0),t=new o(0,0,0),i=new o(0,0,0);return function(){function n(e,t){return e*d+t}var r=!this.ccw_.getValue(),u=this.crossSection_,l=this.spine_,h=l.length,c=this.getTexCoords();if(!(h<2||u.length<2)){this.getMultiTexCoords().push(c);var d=u.length,p=l[0].getValue(),f=l[h-1].getValue(),g=p.equals(f)&&this.getClosedOrientation(),m=u[0].getValue(),_=u[u.length-1].getValue(),x=m.equals(_);e.assign(u[0].getValue()),t.assign(u[0].getValue());for(var y=1,v=u.length;y<v;++y)e.min(u[y].getValue()),t.max(u[y].getValue());for(var w=i.assign(t).subtract(e),b=Math.max(w.x,w.y),S=x?u.length-1:u.length,C=[],T=[],F=this.createPoints(),O=0,v=F.length;O<v;++O)C[O]=[];for(var N=this.getNormals(),M=this.getVertices(),D=u.length-1,E=h-1,V=n(0,0),B=n(0,x?0:D),I=0;I<E;++I)for(var y=0;y<D;++y){var A=g&&I===h-2?0:I+1,P=x&&y===u.length-2?0:y+1,R=n(I,y),L=n(I,P),z=n(A,P),k=n(A,y),X=F[R],U=F[L],j=F[z],G=F[k],q=U.distance(j)>=1e-7,H=G.distance(X)>=1e-7;if(r)var W=s.normal(j,U,X,new a(0,0,0)),Y=s.normal(G,j,X,new a(0,0,0));else var W=s.normal(X,U,j,new a(0,0,0)),Y=s.normal(X,j,G,new a(0,0,0));if(0==y&&(H?V=R:(R=V,X=F[R])),y==u.length-2&&(q?B=L:(z=B,j=F[z])),q){if(H)c.push(y/D,I/E,0,1);else{var $=(I/E+(I+1)/E)/2;c.push(y/D,$,0,1)}C[R].push(T.length),T.push(W),M.push(X.x,X.y,X.z,1),c.push((y+1)/D,I/E,0,1),C[L].push(T.length),T.push(W),M.push(U.x,U.y,U.z,1),c.push((y+1)/D,(I+1)/E,0,1),C[z].push(T.length),T.push(W),M.push(j.x,j.y,j.z,1)}if(H){if(c.push(y/D,I/E,0,1),C[R].push(T.length),T.push(Y),M.push(X.x,X.y,X.z,1),q)c.push((y+1)/D,(I+1)/E,0,1);else{var $=((I+1)/E+I/E)/2;c.push((y+1)/D,$,0,1)}C[z].push(T.length),T.push(Y),M.push(j.x,j.y,j.z,1),c.push(y/D,(I+1)/E,0,1),C[k].push(T.length),T.push(Y),M.push(G.x,G.y,G.z,1)}}T=this.refineNormals(C,T,this.creaseAngle_.getValue());for(var K=0;K<T.length;++K){var Q=T[K];N.push(Q.x,Q.y,Q.z)}if(b&&u.length>2){if(this.beginCap_.getValue()){for(var Z=0,J=[],ee=[],y=0;y<S;++y){var te=n(Z,S-1-y),ie=F[te].copy();ie.index=te,ie.texCoord=o.subtract(u[S-1-y].getValue(),e).divide(b),J.push(ie)}if(this.convex_.getValue()?s.triangulateConvexPolygon(J,ee):s.triangulatePolygon(J,ee),ee.length>=3){var Q=s.normal(F[ee[0].index],F[ee[1].index],F[ee[2].index],new a(0,0,0));r&&Q.negate(),this.addCap(c,Q,F,ee)}}if(this.endCap_.getValue()){for(var Z=h-1,J=[],ee=[],y=0;y<S;++y){var te=n(Z,y),ie=F[te].copy();ie.index=te,ie.texCoord=o.subtract(u[y].getValue(),e).divide(b),J.push(ie)}if(this.convex_.getValue()?s.triangulateConvexPolygon(J,ee):s.triangulatePolygon(J,ee),ee.length>=3){var Q=s.normal(F[ee[0].index],F[ee[1].index],F[ee[2].index],new a(0,0,0));r&&Q.negate(),this.addCap(c,Q,F,ee)}}}this.setSolid(this.solid_.getValue()),this.setCCW(this.ccw_.getValue())}}}(),addCap:function(e,t,i,n){for(var r=this.getNormals(),s=this.getVertices(),o=0;o<n.length;o+=3){var a=i[n[o].index],u=i[n[o+1].index],l=i[n[o+2].index],h=n[o].texCoord,c=n[o+1].texCoord,d=n[o+2].texCoord;e.push(h.x,h.y,0,1),e.push(c.x,c.y,0,1),e.push(d.x,d.y,0,1),r.push(t.x,t.y,t.z,t.x,t.y,t.z,t.x,t.y,t.z),s.push(a.x,a.y,a.z,1,u.x,u.y,u.z,1,l.x,l.y,l.z,1)}}}),h}),define("x_ite/Components/Shaders/X3DVertexAttributeNode",["x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DVertexAttributeNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i}),i}),define("x_ite/Components/Shaders/FloatVertexAttribute",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shaders/X3DVertexAttributeNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.FloatVertexAttribute)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"name",new e.SFString),new t(r.initializeOnly,"numComponents",new e.SFInt32(4)),new t(r.inputOutput,"value",new e.MFFloat)]),getTypeName:function(){return"FloatVertexAttribute"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"attrib"},initialize:function(){n.prototype.initialize.call(this),this.numComponents_.addInterest("set_numComponents",this),this.value_.addInterest("set_value",this),this.set_numComponents(),this.set_value()},set_numComponents:function(){this.numComponents=s.clamp(this.numComponents_.getValue(),1,4)},set_value:function(){this.value=this.value_.getValue(),this.length=this.value_.length},addValue:function(e,t){var i=this.value,n=e*this.numComponents,r=n+this.numComponents;if(r<=this.length)for(;n<r;++n)t.push(i[n]);else for(;n<r;++n)t.push(0)},enable:function(e,t,i){t.enableFloatAttrib(e,this.name_.getValue(),i,this.numComponents)},disable:function(e,t){t.disableFloatAttrib(e,this.name_.getValue())}}),o}),define("x_ite/Components/ParticleSystems/ForcePhysicsModel",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/ParticleSystems/X3DParticlePhysicsModelNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.ForcePhysicsModel),this.force_.setUnit("force")}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"enabled",new e.SFBool(!0)),new t(r.inputOutput,"force",new e.SFVec3f(0,-9.8,0))]),getTypeName:function(){return"ForcePhysicsModel"},getComponentName:function(){return"ParticleSystems"},getContainerField:function(){return"physics"},addForce:function(e,t,i,n){this.enabled_.getValue()&&(i[e].assign(this.force_.getValue()),n[e]=0)}}),s}),define("x_ite/Rendering/DependentRenderer",["x_ite/Basic/X3DBaseNode","x_ite/Rendering/X3DRenderObject","x_ite/Bits/TraverseType"],function(e,t,i){"use strict";function n(i){e.call(this,i),t.call(this,i),this.renderObject=null}return n.prototype=Object.assign(Object.create(e.prototype),t.prototype,{constructor:n,initialize:function(){e.prototype.initialize.call(this),t.prototype.initialize.call(this)},isIndependent:function(){return!1},setRenderer:function(e){this.renderObject=e},getBrowser:function(){return this.renderObject.getBrowser()},getLayer:function(){return this.renderObject.getLayer()},getBackground:function(){return this.renderObject.getBackground()},getFog:function(){return this.renderObject.getFog()},getNavigationInfo:function(){return this.renderObject.getNavigationInfo()},getViewpoint:function(){return this.renderObject.getViewpoint()},getLightContainer:function(){return this.renderObject.getLights()[this.lightIndex++]},render:function(e,n){switch(e){case i.COLLISION:t.prototype.render.call(this,e,n);break;case i.DEPTH:t.prototype.render.call(this,e,n);break;case i.DISPLAY:this.lightIndex=0,t.prototype.render.call(this,e,n);for(var r=this.renderObject.getLights(),s=0,o=r.length;s<o;++s)r[s].getModelViewMatrix().pop()}}}),n}),define("x_ite/Components/CubeMapTexturing/GeneratedCubeMapTexture",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/CubeMapTexturing/X3DEnvironmentTextureNode","x_ite/Rendering/DependentRenderer","x_ite/Rendering/TextureBuffer","x_ite/Bits/X3DConstants","x_ite/Bits/TraverseType","standard/Math/Geometry/Camera","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4","standard/Math/Algorithm"],function(e,t,i,n,r,s,o,a,u,l,h,c,d,p,f){"use strict";function g(e){n.call(this,e),this.addType(o.GeneratedCubeMapTexture),this.renderer=new r(e),this.projectionMatrix=new p,this.modelMatrix=new p,this.viewVolume=new l}var m=[new h(c.zAxis,new c(0,0,-1)),new h(c.zAxis,new c(0,0,1)),new h(c.zAxis,new c(1,0,0)),new h(c.zAxis,new c(-1,0,0)),new h(c.zAxis,new c(0,-1,0)),new h(c.zAxis,new c(0,1,0))],_=[new c(-1,-1,1),new c(-1,-1,1),new c(-1,-1,1),new c(-1,-1,1),new c(1,1,1),new c(1,1,1)],x=new p;return g.prototype=Object.assign(Object.create(n.prototype),{constructor:g,fieldDefinitions:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"update",new e.SFString("NONE")),new t(o.initializeOnly,"size",new e.SFInt32(128)),new t(o.initializeOnly,"textureProperties",new e.SFNode)]),getTypeName:function(){return"GeneratedCubeMapTexture"},getComponentName:function(){return"CubeMapTexturing"},getContainerField:function(){return"texture"},initialize:function(){n.prototype.initialize.call(this),this.renderer.setup();var e=f.nextPowerOfTwo(this.size_.getValue());if(e>0){e=f.nextPowerOfTwo(e);var t=this.getBrowser().getContext(),i=new Uint8Array(e*e*4);t.bindTexture(this.getTarget(),this.getTexture());for(var r=0;r<6;++r)t.texImage2D(this.getTargets()[r],0,t.RGBA,e,e,0,t.RGBA,t.UNSIGNED_BYTE,i);this.viewport=new d(0,0,e,e),this.frameBuffer=new s(this.getBrowser(),e,e),this.isLive().addInterest("set_live__",this),this.set_live__()}},traverse:function(e,t){e===a.DISPLAY&&"NONE"!==this.update_.getValue()&&this.frameBuffer&&t.isIndependent()&&(t.getGeneratedCubeMapTextures().push(this),this.modelMatrix.assign(t.getModelViewMatrix().get()).multRight(t.getCameraSpaceMatrix().get()))},renderTexture:function(e,t){this.renderer.setRenderer(e);var i=this.renderer,n=e.getBrowser(),r=e.getLayer(),s=n.getContext(),o=i.getBackground(),l=i.getNavigationInfo(),h=i.getViewpoint(),c=n.getHeadlight(),d=l.headlight_.getValue(),g=l.getNearValue(),y=l.getFarValue(h),v=u.perspective(f.radians(90),g,y,1,1,this.projectionMatrix),w=o.isTransparent();w!==this.transparent_.getValue()&&(this.transparent_=w),this.frameBuffer.bind(),i.getViewVolumes().push(this.viewVolume.set(v,this.viewport,this.viewport)),i.getProjectionMatrix().pushMatrix(v),s.bindTexture(this.getTarget(),this.getTexture()),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,!1);for(var b=0;b<6;++b){s.clear(s.COLOR_BUFFER_BIT),i.getCameraSpaceMatrix().pushMatrix(this.modelMatrix),i.getCameraSpaceMatrix().rotate(m[b]),i.getCameraSpaceMatrix().scale(_[b]);try{i.getInverseCameraSpaceMatrix().pushMatrix(x.assign(i.getCameraSpaceMatrix().get()).inverse())}catch(e){console.log(e),i.getInverseCameraSpaceMatrix().pushMatrix(p.Identity)}i.getModelViewMatrix().pushMatrix(x),d&&(c.getModelViewMatrix().pushMatrix(x),c.getModelViewMatrix().multLeft(h.getCameraSpaceMatrix())),r.traverse(a.DISPLAY,i),d&&c.getModelViewMatrix().pop(),i.getModelViewMatrix().pop(),i.getCameraSpaceMatrix().pop(),i.getInverseCameraSpaceMatrix().pop();var S=this.frameBuffer.readPixels(),C=this.frameBuffer.getWidth(),T=this.frameBuffer.getHeight();s.texImage2D(this.getTargets()[b],0,s.RGBA,C,T,!1,s.RGBA,s.UNSIGNED_BYTE,S)}this.set_textureQuality__(),i.getProjectionMatrix().pop(),i.getViewVolumes().pop(),this.frameBuffer.unbind(),"NEXT_FRAME_ONLY"===this.update_.getValue()&&(this.update_="NONE")}}),g}),define("x_ite/Components/Geospatial/GeoCoordinate",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DCoordinateNode","x_ite/Components/Geospatial/X3DGeospatialObject","x_ite/Bits/X3DConstants","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,s,o,a){"use strict";function u(e){n.call(this,e),r.call(this,e),this.addType(s.GeoCoordinate)}return u.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:u,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.initializeOnly,"geoOrigin",new e.SFNode),new t(s.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new t(s.inputOutput,"point",new e.MFVec3d)]),getTypeName:function(){return"GeoCoordinate"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"coord"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this),this.point_.addInterest("set_point__",this),this.set_point__()},set_point__:function(){this.point=this.point_.getValue(),this.length=this.point_.length},isEmpty:function(){return 0===this.length},getSize:function(){return this.length},get1Point:function(){var e=new a(0,0,0);return function(t,i){if(t<this.length){const n=this.point;return t*=3,this.getCoord(e.set(n[t],n[t+1],n[t+2]),i)}return i.set(0,0,0)}}(),addPoint:function(){var e=new a(0,0,0),t=new a(0,0,0);return function(i,n){if(i<this.length){const r=this.point;i*=3,this.getCoord(e.set(r[i],r[i+1],r[i+2]),t),n.push(t[0],t[1],t[2],1)}else n.push(0,0,0,1)}}(),addPoints:function(){var e=new a(0,0,0),t=new a(0,0,0);return function(i,n){const r=this.point;for(var s=0,o=3*this.length;s<o;s+=3)this.getCoord(e.set(r[s],r[s+1],r[s+2]),t),i.push(t[0],t[1],t[2],1);for(var s=o,o=3*n;s<o;s+=3)i.push(0,0,0,1)}}(),getNormal:function(){var e=new a(0,0,0),t=new a(0,0,0),i=new a(0,0,0);return function(n,r,s){var u=this.length;return n<u&&r<u&&s<u?o.normal(this.get1Point(n,e),this.get1Point(r,t),this.get1Point(s,i),new a(0,0,0)):new a(0,0,0)}}(),getQuadNormal:function(){var e=new a(0,0,0),t=new a(0,0,0),i=new a(0,0,0),n=new a(0,0,0);return function(r,s,u,l){var h=this.length;return r<h&&s<h&&u<h&&l<h?o.quadNormal(this.get1Point(r,e),this.get1Point(s,t),this.get1Point(u,i),this.get1Point(l,n),new a(0,0,0)):new a(0,0,0)}}()}),u}),define("x_ite/Components/Geospatial/GeoElevationGrid",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Components/Geospatial/X3DGeospatialObject","x_ite/Bits/X3DConstants","x_ite/Bits/X3DCast","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,s,o,a,u,l){"use strict";function h(e){n.call(this,e),r.call(this,e),this.addType(s.GeoElevationGrid),this.creaseAngle_.setUnit("angle"),this.height_.setUnit("length"),this.colorNode=null,this.texCoordNode=null,this.normalNode=null}return h.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:h,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.initializeOnly,"geoOrigin",new e.SFNode),new t(s.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new t(s.initializeOnly,"geoGridOrigin",new e.SFVec3d),new t(s.initializeOnly,"xDimension",new e.SFInt32),new t(s.initializeOnly,"zDimension",new e.SFInt32),new t(s.initializeOnly,"xSpacing",new e.SFDouble(1)),new t(s.initializeOnly,"zSpacing",new e.SFDouble(1)),new t(s.inputOutput,"yScale",new e.SFFloat(1)),new t(s.initializeOnly,"solid",new e.SFBool(!0)),new t(s.initializeOnly,"ccw",new e.SFBool(!0)),new t(s.initializeOnly,"creaseAngle",new e.SFDouble),new t(s.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new t(s.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new t(s.inputOutput,"color",new e.SFNode),new t(s.inputOutput,"texCoord",new e.SFNode),new t(s.inputOutput,"normal",new e.SFNode),new t(s.inputOutput,"height",new e.MFDouble(0,0))]),getTypeName:function(){return"GeoElevationGrid"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this),this.color_.addInterest("set_color__",this),this.texCoord_.addInterest("set_texCoord__",this),this.normal_.addInterest("set_normal__",this),this.set_color__(),this.set_texCoord__(),this.set_normal__()},set_color__:function(){this.colorNode&&(this.colorNode.removeInterest("addNodeEvent",this),this.colorNode.removeInterest("set_transparent__",this)),this.colorNode=o(s.X3DColorNode,this.color_),this.colorNode?(this.colorNode.addInterest("addNodeEvent",this),this.colorNode.addInterest("set_transparent__",this),this.set_transparent__()):this.transparent_=!1},set_transparent__:function(){this.transparent_=this.colorNode.isTransparent()},set_texCoord__:function(){this.texCoordNode&&this.texCoordNode.removeInterest("addNodeEvent",this),this.texCoordNode=o(s.X3DTextureCoordinateNode,this.texCoord_),this.texCoordNode&&this.texCoordNode.addInterest("addNodeEvent",this),this.setCurrentTexCoord(this.texCoordNode)},set_normal__:function(){this.normalNode&&this.normalNode.removeInterest("addNodeEvent",this),this.normalNode=o(s.X3DNormalNode,this.normal_),this.normalNode&&this.normalNode.addInterest("addNodeEvent",this)},getColor:function(){return this.colorNode},getTexCoord:function(){return this.texCoordNode},getNormal:function(){return this.normalNode},getHeight:function(e){return e<this.height_.length?this.height_[e]*this.yScale_.getValue():0},createTexCoords:function(){
for(var e=[],t=this.xDimension_.getValue(),i=this.zDimension_.getValue(),n=t-1,r=i-1,s=0;s<i;++s)for(var o=0;o<t;++o)e.push(new u(o/n,s/r));return e},createNormals:function(e,t,i){for(var n=!this.ccw_.getValue(),r=[],s=[],o=0;o<e.length;++o)r[o]=[];for(var u=0;u<t.length;u+=3){var h=t[u],c=t[u+1],d=t[u+2];r[h].push(s.length),r[c].push(s.length+1),r[d].push(s.length+2);var p=a.normal(e[h],e[c],e[d],new l(0,0,0));n&&p.negate(),s.push(p),s.push(p),s.push(p)}return this.refineNormals(r,s,this.creaseAngle_.getValue())},createCoordIndex:function(){for(var e=[],t=this.xDimension_.getValue(),i=this.zDimension_.getValue(),n=t-1,r=i-1,s=0;s<r;++s)for(var o=0;o<n;++o){var a=s*t+o,u=(s+1)*t+o,l=(s+1)*t+(o+1),h=s*t+(o+1);e.push(a),e.push(l),e.push(u),e.push(a),e.push(h),e.push(l)}return e},createPoints:function(){var e=[],t=this.xDimension_.getValue(),i=this.zDimension_.getValue(),n=this.xSpacing_.getValue(),r=this.zSpacing_.getValue();if(this.getStandardOrder())for(var s=0;s<i;++s)for(var o=0;o<t;++o){var a=new l(r*s,n*o,this.getHeight(o+s*t));a.add(this.geoGridOrigin_.getValue()),e.push(this.getCoord(a,a))}else for(var s=0;s<i;++s)for(var o=0;o<t;++o){var a=new l(n*o,r*s,this.getHeight(o+s*t));a.add(this.geoGridOrigin_.getValue()),e.push(this.getCoord(a,a))}return e},build:function(){if(!(this.xDimension_.getValue()<2||this.zDimension_.getValue()<2)){var e=this.colorPerVertex_.getValue(),t=this.normalPerVertex_.getValue(),i=this.createCoordIndex(),n=this.getColor(),r=this.getTexCoord(),s=this.getNormal(),o=this.createPoints(),a=this.getColors(),u=this.getMultiTexCoords(),l=this.getNormals(),h=this.getVertices(),c=0;if(r)r.init(u);else{var d=this.createTexCoords(),p=this.getTexCoords();u.push(p)}for(var f=0;f<i.length;++c)for(var g=0;g<6;++g,++f){var m=i[f],_=o[m];if(n&&(e?n.addColor(m,a):n.addColor(c,a)),r)r.addTexCoord(m,u);else{var x=d[m];p.push(x.x,x.y,0,1)}s&&(t?s.addVector(m,l):s.addVector(c,l)),h.push(_.x,_.y,_.z,1)}if(!s)for(var y=this.createNormals(o,i),v=0;v<y.length;++v){var w=y[v];l.push(w.x,w.y,w.z)}this.setSolid(this.solid_.getValue()),this.setCCW(this.ccw_.getValue())}}}),h}),define("x_ite/Components/Networking/Inline",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Components/Grouping/Group","x_ite/Bits/X3DConstants","x_ite/InputOutput/FileLoader"],function(e,t,i,n,r,s,o,a,u){"use strict";function l(t){n.call(this,t),r.call(this,t),s.call(this,t),this.addType(a.Inline),this.addChildObjects("buffer",new e.SFTime),this.scene=this.getBrowser().getDefaultScene(),this.group=new o(t),this.getBBox=this.group.getBBox.bind(this.group),this.group.addParent(this)}return l.prototype=Object.assign(Object.create(n.prototype),r.prototype,s.prototype,{constructor:l,fieldDefinitions:new i([new t(a.inputOutput,"metadata",new e.SFNode),new t(a.inputOutput,"load",new e.SFBool(!0)),new t(a.inputOutput,"url",new e.MFString),new t(a.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(a.initializeOnly,"bboxCenter",new e.SFVec3f)]),getTypeName:function(){return"Inline"},getComponentName:function(){return"Networking"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this),s.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this),this.group.setPrivate(!0),this.group.setup(),this.group.isCameraObject_.addFieldInterest(this.isCameraObject_),this.load_.addInterest("set_load__",this),this.url_.addInterest("set_url__",this),this.buffer_.addInterest("set_buffer__",this),this.set_url__()},set_live__:function(){this.getPrivate()||this.scene.setLive(this.isLive().getValue())},set_load__:function(){this.load_.getValue()?(this.setLoadState(a.NOT_STARTED_STATE),this.requestAsyncLoad()):this.requestUnload()},set_url__:function(){this.load_.getValue()&&(this.setLoadState(a.NOT_STARTED_STATE),this.requestAsyncLoad())},requestImmediateLoad:function(){try{if(this.checkLoadState()===a.COMPLETE_STATE||this.checkLoadState()===a.IN_PROGRESS_STATE)return;this.setLoadState(a.IN_PROGRESS_STATE),this.setInternalScene(new u(this).createX3DFromURL(this.url_,null))}catch(e){console.log(e),this.setInternalScene(this.getBrowser().getDefaultScene())}},requestAsyncLoad:function(){this.checkLoadState()!==a.COMPLETE_STATE&&this.checkLoadState()!==a.IN_PROGRESS_STATE&&(this.setLoadState(a.IN_PROGRESS_STATE),this.buffer_.addEvent())},set_buffer__:function(){new u(this).createX3DFromURL(this.url_,null,this.setInternalSceneAsync.bind(this))},requestUnload:function(){this.checkLoadState()!==a.NOT_STARTED_STATE&&this.checkLoadState()!==a.FAILED_STATE&&(this.setLoadState(a.NOT_STARTED_STATE),this.setInternalScene(this.getBrowser().getDefaultScene()))},setInternalSceneAsync:function(e){e?(this.setLoadState(a.COMPLETE_STATE),this.setInternalScene(e)):(this.setLoadState(a.FAILED_STATE),this.setInternalScene(this.getBrowser().getDefaultScene()))},setInternalScene:function(e){this.scene.setLive(!1),this.scene.rootNodes.removeInterest("setValue",this.group.children_),this.scene=e,this.scene.setExecutionContext(this.getExecutionContext()),this.scene.setPrivate(this.getExecutionContext().getPrivate()),this.scene.setup(),this.scene.rootNodes.addInterest("setValue",this.group.children_),this.group.children_=this.scene.rootNodes,this.set_live__(),this.getBrowser().addBrowserEvent()},getInternalScene:function(){return this.scene},traverse:function(e,t){this.group.traverse(e,t)}}),l}),define("x_ite/Components/Geospatial/GeoLOD",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Components/Geospatial/X3DGeospatialObject","x_ite/Bits/X3DConstants","x_ite/Bits/TraverseType","x_ite/Components/Grouping/Group","x_ite/Components/Networking/Inline","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Box3"],function(e,t,i,n,r,s,o,a,u,l,h,c,d){"use strict";function p(e){n.call(this,e),r.call(this,e),s.call(this,e),this.addType(o.GeoLOD),this.range_.setUnit("length"),this.rootGroup=new u(this.getBrowser().getPrivateScene()),this.rootInline=new l(e),this.child1Inline=new l(e),this.child2Inline=new l(e),this.child3Inline=new l(e),this.child4Inline=new l(e),this.childrenLoaded=!1,this.childBBox=new d,this.keepCurrentLevel=!1,this.modelViewMatrix=new c}var f=new h(0,0,0);return p.prototype=Object.assign(Object.create(n.prototype),r.prototype,s.prototype,{constructor:p,fieldDefinitions:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.initializeOnly,"geoOrigin",new e.SFNode),new t(o.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new t(o.initializeOnly,"rootUrl",new e.MFString),new t(o.initializeOnly,"child1Url",new e.MFString),new t(o.initializeOnly,"child2Url",new e.MFString),new t(o.initializeOnly,"child3Url",new e.MFString),new t(o.initializeOnly,"child4Url",new e.MFString),new t(o.initializeOnly,"center",new e.SFVec3d),new t(o.initializeOnly,"range",new e.SFFloat(10)),new t(o.outputOnly,"level_changed",new e.SFInt32(-1)),new t(o.initializeOnly,"rootNode",new e.MFNode),new t(o.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(o.initializeOnly,"bboxCenter",new e.SFVec3f),new t(o.outputOnly,"children",new e.MFNode)]),getTypeName:function(){return"GeoLOD"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this),s.prototype.initialize.call(this),this.rootNode_.addFieldInterest(this.rootGroup.children_),this.rootGroup.children_=this.rootNode_,this.rootGroup.setPrivate(!0),this.rootGroup.setup(),this.rootInline.loadState_.addInterest("set_rootLoadState__",this),this.child1Inline.loadState_.addInterest("set_childLoadState__",this),this.child2Inline.loadState_.addInterest("set_childLoadState__",this),this.child3Inline.loadState_.addInterest("set_childLoadState__",this),this.child4Inline.loadState_.addInterest("set_childLoadState__",this),this.rootUrl_.addFieldInterest(this.rootInline.url_),this.child1Url_.addFieldInterest(this.child1Inline.url_),this.child2Url_.addFieldInterest(this.child2Inline.url_),this.child3Url_.addFieldInterest(this.child3Inline.url_),this.child4Url_.addFieldInterest(this.child4Inline.url_),this.rootInline.load_=!0,this.child1Inline.load_=!1,this.child2Inline.load_=!1,this.child3Inline.load_=!1,this.child4Inline.load_=!1,this.rootInline.url_=this.rootUrl_,this.child1Inline.url_=this.child1Url_,this.child2Inline.url_=this.child2Url_,this.child3Inline.url_=this.child3Url_,this.child4Inline.url_=this.child4Url_,this.rootInline.setup(),this.child1Inline.setup(),this.child2Inline.setup(),this.child3Inline.setup(),this.child4Inline.setup()},getBBox:function(e){if(this.bboxSize_.getValue().equals(this.defaultBBoxSize)){var t=this.level_changed_.getValue();switch(this.childrenLoaded?t:0){case 0:return this.rootNode_.length?this.rootGroup.getBBox(e):this.rootInline.getBBox(e);case 1:return e.set(),e.add(this.child1Inline.getBBox(this.childBBox)),e.add(this.child2Inline.getBBox(this.childBBox)),e.add(this.child3Inline.getBBox(this.childBBox)),e.add(this.child4Inline.getBBox(this.childBBox)),e}return e.set()}return e.set(this.bboxSize_.getValue(),this.bboxCenter_.getValue())},set_rootLoadState__:function(){0===this.level_changed_.getValue()&&(this.rootNode_.length||this.rootInline.checkLoadState()===o.COMPLETE_STATE&&(this.children_=this.rootInline.getInternalScene().getRootNodes(),this.childrenLoaded=!1))},set_childLoadState__:function(){var t=new e.MFNode;return function(){if(1===this.level_changed_.getValue()){var e=0;if(this.child1Inline.checkLoadState()===o.COMPLETE_STATE){for(var i=this.child1Inline.getInternalScene().getRootNodes(),n=0,r=i.length;n<r;++n)t.push(i[n]);++e}else this.child1Inline.checkLoadState()===o.FAILED_STATE&&++e;if(this.child2Inline.checkLoadState()===o.COMPLETE_STATE){for(var i=this.child2Inline.getInternalScene().getRootNodes(),n=0,r=i.length;n<r;++n)t.push(i[n]);++e}else this.child2Inline.checkLoadState()===o.FAILED_STATE&&++e;if(this.child3Inline.checkLoadState()===o.COMPLETE_STATE){for(var i=this.child3Inline.getInternalScene().getRootNodes(),n=0,r=i.length;n<r;++n)t.push(i[n]);++e}else this.child3Inline.checkLoadState()===o.FAILED_STATE&&++e;if(this.child4Inline.checkLoadState()===o.COMPLETE_STATE){for(var i=this.child4Inline.getInternalScene().getRootNodes(),n=0,r=i.length;n<r;++n)t.push(i[n]);++e}else this.child4Inline.checkLoadState()===o.FAILED_STATE&&++e;4===e&&(this.childrenLoaded=!0,this.children_.assign(t))}}}(),getLevel:function(e){return this.getDistance(e)<this.range_.getValue()?1:0},getDistance:function(e){return e.translate(this.getCoord(this.center_.getValue(),f)),e.origin.abs()},traverse:function(e,t){if(e==a.DISPLAY){var i=this.getLevel(this.modelViewMatrix.assign(t.getModelViewMatrix().get()));if(i!==this.level_changed_.getValue())switch(this.level_changed_=i,i){case 0:this.rootNode_.length?(this.children_=this.rootNode_,this.childrenLoaded=!1):this.rootInline.checkLoadState()==o.COMPLETE_STATE&&(this.children_=this.rootInline.getInternalScene().getRootNodes(),this.childrenLoaded=!1),this.child1Inline.load_=!1,this.child2Inline.load_=!1,this.child3Inline.load_=!1,this.child4Inline.load_=!1;break;case 1:this.child1Inline.load_=!0,this.child2Inline.load_=!0,this.child3Inline.load_=!0,this.child4Inline.load_=!0}}switch(this.childrenLoaded?this.level_changed_.getValue():0){case 0:this.rootNode_.length?this.rootGroup.traverse(e,t):this.rootInline.traverse(e,t);break;case 1:this.child1Inline.traverse(e,t),this.child2Inline.traverse(e,t),this.child3Inline.traverse(e,t),this.child4Inline.traverse(e,t)}}}),p}),define("x_ite/Components/Geospatial/GeoLocation",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DTransformMatrix3DNode","x_ite/Components/Geospatial/X3DGeospatialObject","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r,s,o){"use strict";function a(e){n.call(this,e),r.call(this,e),this.addType(s.GeoLocation)}var u=new o;return a.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:a,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new t(s.inputOutput,"geoCoords",new e.SFVec3d),new t(s.initializeOnly,"geoOrigin",new e.SFNode),new t(s.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(s.initializeOnly,"bboxCenter",new e.SFVec3f),new t(s.inputOnly,"addChildren",new e.MFNode),new t(s.inputOnly,"removeChildren",new e.MFNode),new t(s.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"GeoLocation"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this),this.addInterest("eventsProcessed",this),this.eventsProcessed()},eventsProcessed:function(){this.setMatrix(this.getLocationMatrix(this.geoCoords_.getValue(),u))}}),a}),define("x_ite/Components/Core/X3DInfoNode",["x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DInfoNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i}),i}),define("x_ite/Components/Geospatial/GeoMetadata",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DInfoNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.GeoMetadata)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"url",new e.MFString),new t(r.inputOutput,"summary",new e.MFString),new t(r.inputOutput,"data",new e.MFNode)]),getTypeName:function(){return"GeoMetadata"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"children"}}),s}),define("x_ite/Components/Geospatial/GeoOrigin",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants","x_ite/Browser/Geospatial/Geospatial"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.GeoOrigin),this.radians=!1}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new t(r.inputOutput,"geoCoords",new e.SFVec3d),new t(r.initializeOnly,"rotateYUp",new e.SFBool)]),getTypeName:function(){return"GeoOrigin"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"geoOrigin"},initialize:function(){n.prototype.initialize.call(this),this.geoSystem_.addInterest("set_geoSystem__",this),this.set_geoSystem__()},set_geoSystem__:function(){this.referenceFrame=s.getReferenceFrame(this.geoSystem_,this.radians)},getOrigin:function(e){return this.referenceFrame.convert(this.geoCoords_.getValue(),e)}}),o}),define("x_ite/Components/Geospatial/GeoPositionInterpolator",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Components/Geospatial/X3DGeospatialObject","x_ite/Browser/Geospatial/Geocentric","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,s,o,a){"use strict";function u(e){n.call(this,e),r.call(this,e),this.addType(o.GeoPositionInterpolator),this.value_changed_.setUnit("length"),this.geocentric=new s}return u.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:u,fieldDefinitions:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.initializeOnly,"geoOrigin",new e.SFNode),new t(o.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new t(o.inputOnly,"set_fraction",new e.SFFloat),new t(o.inputOutput,"key",new e.MFFloat),new t(o.inputOutput,"keyValue",new e.MFVec3d),new t(o.outputOnly,"value_changed",new e.SFVec3d),new t(o.outputOnly,"geovalue_changed",new e.SFVec3d)]),keyValue0:new a(0,0,0),keyValue1:new a(0,0,0),geovalue:new a(0,0,0),value:new a(0,0,0),getTypeName:function(){return"GeoPositionInterpolator"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"children"},setup:function(){r.prototype.initialize.call(this),n.prototype.setup.call(this)},initialize:function(){n.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){var t=this.key_,i=this.keyValue_;i.length<t.length&&i.resize(t.length,i.length?i[i.length-1]:new e.SFVec3f)},interpolate:function(e,t,i){try{this.getCoord(this.keyValue_[e].getValue(),this.keyValue0),this.getCoord(this.keyValue_[t].getValue(),this.keyValue1);var n=this.geocentric.slerp(this.keyValue0,this.keyValue1,i);this.geovalue_changed_=this.getGeoCoord(n,this.geovalue),this.value_changed_=n}catch(e){}}}),u}),define("x_ite/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode",["x_ite/Fields","x_ite/Components/Core/X3DSensorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n){"use strict";function r(n){t.call(this,n),this.addType(i.X3DEnvironmentalSensorNode),this.addChildObjects("traversed",new e.SFBool(!0)),this.size_.setUnit("length"),this.center_.setUnit("length"),this.currentTraversed=!0}return r.prototype=Object.assign(Object.create(t.prototype),{constructor:r,initialize:function(){t.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this),this.enabled_.addInterest("set_live__",this),this.size_.addInterest("set_live__",this),this.traversed_.addInterest("set_live__",this),this.set_live__()},set_live__:function(){this.isLive().getValue()&&this.traversed_.getValue()&&this.enabled_.getValue()&&!this.size_.getValue().equals(n.Zero)?this.getBrowser().sensorEvents().addInterest("update",this):(this.getBrowser().sensorEvents().removeInterest("update",this),this.isActive_.getValue()&&(this.isActive_=!1,this.exitTime_=this.getBrowser().getCurrentTime()))},setTraversed:function(e){e?this.traversed_.getValue()===!1&&(this.traversed_=!0):this.currentTraversed!==this.traversed_.getValue()&&(this.traversed_=this.currentTraversed),this.currentTraversed=e},getTraversed:function(){return this.currentTraversed},update:function(){}}),r}),define("x_ite/Components/EnvironmentalSensor/ProximitySensor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r,s,o,a,u){"use strict";function l(e){n.call(this,e),this.addType(s.ProximitySensor),this.setCameraObject(!0),this.centerOfRotation_changed_.setUnit("length"),this.position_changed_.setUnit("length"),this.viewpoint=null,this.modelViewMatrix=new u,this.invModelViewMatrix=new u,this.centerOfRotationMatrix=new u,this.position=new o(0,0,0),this.orientation=new a(0,0,1,0),this.centerOfRotation=new o(0,0,0),this.viewer=new o(0,0,0),this.inside=!1}function h(e,t){try{switch(e){case r.CAMERA:return this.viewpoint=t.getViewpoint(),void this.modelViewMatrix.assign(t.getModelViewMatrix().get());case r.DISPLAY:if(this.setTraversed(!0),this.inside)return;if(this.size_.getValue().equals(c))this.inside=!0;else{var i=this.invModelViewMatrix.assign(t.getModelViewMatrix().get()).inverse();this.viewer.set(i[12],i[13],i[14]),this.inside=this.intersectsPoint(this.viewer)}return}}catch(e){}}var c=new o(-1,-1,-1);return l.prototype=Object.assign(Object.create(n.prototype),{constructor:l,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"enabled",new e.SFBool(!0)),new t(s.inputOutput,"size",new e.SFVec3f),new t(s.inputOutput,"center",new e.SFVec3f),new t(s.outputOnly,"enterTime",new e.SFTime),new t(s.outputOnly,"exitTime",new e.SFTime),new t(s.outputOnly,"isActive",new e.SFBool),new t(s.outputOnly,"position_changed",new e.SFVec3f),new t(s.outputOnly,"orientation_changed",new e.SFRotation),new t(s.outputOnly,"centerOfRotation_changed",new e.SFVec3f)]),getTypeName:function(){return"ProximitySensor"},getComponentName:function(){return"EnvironmentalSensor"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.enabled_.addInterest("set_enabled__",this),this.size_.addInterest("set_extents__",this),this.center_.addInterest("set_extents__",this),this.traversed_.addFieldInterest(this.isCameraObject_),this.min=new o(0,0,0),this.max=new o(0,0,0),this.set_enabled__(),this.set_extents__()},set_enabled__:function(){this.setCameraObject(this.enabled_.getValue()),this.enabled_.getValue()?this.traverse=h:delete this.traverse},set_extents__:function(){var e=this.size_.getValue(),t=this.center_.getValue(),i=e.x/2,n=e.y/2,r=e.z/2,s=t.x,o=t.y,a=t.z;this.min.set(s-i,o-n,a-r),this.max.set(s+i,o+n,a+r)},update:function(){try{if(this.inside&&this.getTraversed()){var e=this.modelViewMatrix,t=this.centerOfRotationMatrix;t.assign(this.viewpoint.getModelMatrix()),t.translate(this.viewpoint.getUserCenterOfRotation()),t.multRight(this.invModelViewMatrix.assign(e).inverse()),e.multRight(this.viewpoint.getInverseCameraSpaceMatrix()),e.get(null,this.orientation),e.inverse(),this.position.set(e[12],e[13],e[14]),this.orientation.inverse(),this.centerOfRotation.set(t[12],t[13],t[14]),this.isActive_.getValue()?(this.position_changed_.getValue().equals(this.position)||(this.position_changed_=this.position),this.orientation_changed_.getValue().equals(this.orientation)||(this.orientation_changed_=this.orientation),this.centerOfRotation_changed_.getValue().equals(this.centerOfRotation)||(this.centerOfRotation_changed_=this.centerOfRotation)):(this.isActive_=!0,this.enterTime_=this.getBrowser().getCurrentTime(),this.position_changed_=this.position,this.orientation_changed_=this.orientation,this.centerOfRotation_changed_=this.centerOfRotation),this.inside=!1}else this.isActive_.getValue()&&(this.isActive_=!1,this.exitTime_=this.getBrowser().getCurrentTime())}catch(e){}this.setTraversed(!1)},traverse:function(){},intersectsPoint:function(e){var t=this.min,i=this.max;return t.x<=e.x&&i.x>=e.x&&t.y<=e.y&&i.y>=e.y&&t.z<=e.z&&i.z>=e.z}}),l}),define("x_ite/Components/Geospatial/GeoProximitySensor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode","x_ite/Components/Geospatial/X3DGeospatialObject","x_ite/Components/EnvironmentalSensor/ProximitySensor","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,s,o,a){"use strict";function u(e){n.call(this,e),r.call(this,e),this.addType(o.GeoProximitySensor),this.position_changed_.setUnit("length"),this.centerOfRotation_changed_.setUnit("length"),this.proximitySensor=new s(e),this.setCameraObject(this.proximitySensor.getCameraObject())}var l=new a(0,0,0);return u.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:u,fieldDefinitions:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.initializeOnly,"geoOrigin",new e.SFNode),new t(o.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new t(o.inputOutput,"enabled",new e.SFBool(!0)),new t(o.inputOutput,"size",new e.SFVec3f),new t(o.inputOutput,"center",new e.SFVec3f),new t(o.outputOnly,"isActive",new e.SFBool),new t(o.outputOnly,"enterTime",new e.SFTime),new t(o.outputOnly,"exitTime",new e.SFTime),new t(o.outputOnly,"geoCoord_changed",new e.SFVec3d),new t(o.outputOnly,"position_changed",new e.SFVec3f),new t(o.outputOnly,"orientation_changed",new e.SFRotation),new t(o.outputOnly,"centerOfRotation_changed",new e.SFVec3f)]),getTypeName:function(){return"GeoProximitySensor"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this),this.enabled_.addFieldInterest(this.proximitySensor.enabled_),this.size_.addFieldInterest(this.proximitySensor.size_),this.center_.addFieldInterest(this.proximitySensor.center_),this.proximitySensor.isCameraObject_.addFieldInterest(this.isCameraObject_),this.proximitySensor.isActive_.addFieldInterest(this.isActive_),this.proximitySensor.enterTime_.addFieldInterest(this.enterTime_),this.proximitySensor.exitTime_.addFieldInterest(this.exitTime_),this.proximitySensor.position_changed_.addFieldInterest(this.position_changed_),this.proximitySensor.orientation_changed_.addFieldInterest(this.orientation_changed_),this.proximitySensor.centerOfRotation_changed_.addFieldInterest(this.centerOfRotation_changed_),this.proximitySensor.position_changed_.addInterest("set_position__",this),this.proximitySensor.enabled_=this.enabled_,this.proximitySensor.size_=this.size_,this.proximitySensor.center_=this.center_,this.proximitySensor.setup()},set_position__:function(e){this.geoCoord_changed_=this.getGeoCoord(this.proximitySensor.position_changed_.getValue(),l)},traverse:function(e,t){this.proximitySensor.traverse(e,t)}}),u}),define("x_ite/Components/Geospatial/GeoTouchSensor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/PointingDeviceSensor/X3DTouchSensorNode","x_ite/Components/Geospatial/X3DGeospatialObject","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r,s,o,a){"use strict";function u(e){n.call(this,e),r.call(this,e),this.addType(s.GeoTouchSensor),this.hitPoint_changed_.setUnit("length")}var l=new a,h=new o(0,0,0);return u.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:u,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.initializeOnly,"geoOrigin",new e.SFNode),new t(s.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new t(s.inputOutput,"enabled",new e.SFBool(!0)),new t(s.inputOutput,"description",new e.SFString),new t(s.outputOnly,"hitTexCoord_changed",new e.SFVec2f),new t(s.outputOnly,"hitNormal_changed",new e.SFVec3f),new t(s.outputOnly,"hitPoint_changed",new e.SFVec3f),new t(s.outputOnly,"hitGeoCoord_changed",new e.SFVec3d),new t(s.outputOnly,"isOver",new e.SFBool),new t(s.outputOnly,"isActive",new e.SFBool),new t(s.outputOnly,"touchTime",new e.SFTime)]),getTypeName:function(){return"GeoTouchSensor"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this)},set_over__:function(e,t,i,r,s){try{if(n.prototype.set_over__.call(this,e,t,i,r,s),this.isOver_.getValue()){var o=t.intersection;l.assign(i).inverse(),this.hitTexCoord_changed_=o.texCoord,this.hitNormal_changed_=i.multMatrixDir(o.normal.copy()).normalize(),this.hitPoint_changed_=l.multVecMatrix(o.point.copy()),this.hitGeoCoord_changed_=this.getGeoCoord(this.hitPoint_changed_.getValue(),h)}}catch(e){console.log(e)}}}),u}),define("x_ite/Components/Geospatial/GeoTransform",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DTransformMatrix3DNode","x_ite/Components/Geospatial/X3DGeospatialObject","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r,s,o){"use strict";function a(e){n.call(this,e),r.call(this,e),this.addType(s.GeoTransform),this.translation_.setUnit("length")}var u=new o,l=new o;return a.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:a,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"translation",new e.SFVec3f),new t(s.inputOutput,"rotation",new e.SFRotation),new t(s.inputOutput,"scale",new e.SFVec3f(1,1,1)),new t(s.inputOutput,"scaleOrientation",new e.SFRotation),new t(s.initializeOnly,"geoOrigin",new e.SFNode),new t(s.initializeOnly,"geoSystem",new e.MFString("GD","WE")),new t(s.inputOutput,"geoCenter",new e.SFVec3d),new t(s.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(s.initializeOnly,"bboxCenter",new e.SFVec3f),new t(s.inputOnly,"addChildren",new e.MFNode),new t(s.inputOnly,"removeChildren",new e.MFNode),new t(s.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"GeoTransform"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this),this.addInterest("eventsProcessed",this),this.eventsProcessed()},eventsProcessed:function(){try{this.setHidden(0===this.scale_.x||0===this.scale_.y||0===this.scale_.z),this.getLocationMatrix(this.geoCenter_.getValue(),l),u.set(this.translation_.getValue(),this.rotation_.getValue(),this.scale_.getValue(),this.scaleOrientation_.getValue()),this.setMatrix(u.multRight(l).multLeft(l.inverse()))}catch(e){this.setHidden(!0)}}}),a}),define("x_ite/Components/CubeMapTexturing/ImageCubeMapTexture",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/CubeMapTexturing/X3DEnvironmentTextureNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Bits/X3DConstants","x_ite/Browser/Networking/urls","standard/Networking/URI","standard/Math/Numbers/Vector2","standard/Math/Algorithm","x_ite/DEBUG"],function(e,t,i,n,r,s,o,a,u,l,h,c){"use strict";function d(e){r.call(this,e),s.call(this,e),this.addType(o.ImageCubeMapTexture),this.urlStack=new t.MFString}var p=new Uint8Array([255,255,255,255]),f=[new l(1,1),new l(3,1),new l(0,1),new l(2,1),new l(1,0),new l(1,2)];return d.prototype=Object.assign(Object.create(r.prototype),s.prototype,{constructor:d,fieldDefinitions:new n([new i(o.inputOutput,"metadata",new t.SFNode),new i(o.inputOutput,"url",new t.MFString),new i(o.initializeOnly,"textureProperties",new t.SFNode)]),getTypeName:function(){return"ImageCubeMapTexture"},getComponentName:function(){return"CubeMapTexturing"},getContainerField:function(){return"texture"},initialize:function(){r.prototype.initialize.call(this),s.prototype.initialize.call(this);var t=this.getBrowser().getContext();t.bindTexture(this.getTarget(),this.getTexture());for(var i=0;i<6;++i)t.texImage2D(this.getTargets()[i],0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,p);this.url_.addInterest("set_url__",this),this.canvas=e("<canvas></canvas>"),this.image=e("<img></img>"),this.image.on("load",this.setImage.bind(this)),this.image.on("error",this.setError.bind(this)),this.image.bind("abort",this.setError.bind(this)),this.image[0].crossOrigin="Anonymous",this.requestAsyncLoad()},set_url__:function(){this.setLoadState(o.NOT_STARTED_STATE),this.requestAsyncLoad()},requestAsyncLoad:function(){this.checkLoadState()!==o.COMPLETE_STATE&&this.checkLoadState()!==o.IN_PROGRESS_STATE&&(this.setLoadState(o.IN_PROGRESS_STATE),this.urlStack.setValue(this.url_),this.loadNext())},loadNext:function(){if(0===this.urlStack.length)return this.clearTexture(),void this.setLoadState(o.FAILED_STATE);this.URL=new u(this.urlStack.shift()),this.URL=this.getExecutionContext().getURL().transform(this.URL),this.image.attr("src",this.URL)},setError:function(){var e=this.URL.toString();c&&(this.URL.isLocal()||"localhost"===this.URL.host||e.match(a.fallbackExpression)||this.urlStack.unshift(a.fallbackUrl+e)),"data"!==this.URL.scheme&&console.warn("Error loading image:",this.URL.toString()),this.loadNext()},setImage:function(){c&&"data"!==this.URL.scheme&&console.info("Done loading image cube map texture:",this.URL.toString());try{var e=this.image[0],t=e.width,i=e.height,n=Math.floor(t/4),r=Math.floor(i/3),s=this.canvas[0],a=s.getContext("2d")
;h.isPowerOfTwo(n)&&h.isPowerOfTwo(r)&&4*n===t&&3*r===i?(s.width=t,s.height=i,a.drawImage(e,0,0)):(n=h.nextPowerOfTwo(n),r=h.nextPowerOfTwo(r),t=4*n,i=3*r,s.width=t,s.height=i,a.drawImage(e,0,0,e.width,e.height,0,0,t,i));var u=this.getBrowser().getContext(),l=!0;u.bindTexture(this.getTarget(),this.getTexture()),u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,!1);for(var d=0;d<6;++d){var p=a.getImageData(f[d].x*n,f[d].y*r,n,r).data;if(l)for(var g=3;g<p.length;g+=4)if(255!==p[g]){l=!1;break}u.texImage2D(this.getTargets()[d],0,u.RGBA,n,r,!1,u.RGBA,u.UNSIGNED_BYTE,new Uint8Array(p))}this.set_textureQuality__();var m=!l;m!==this.transparent_.getValue()&&(this.transparent_=m),this.setLoadState(o.COMPLETE_STATE)}catch(e){console.log(e.message),this.setError()}}}),d}),define("x_ite/Components/Rendering/IndexedLineSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DLineGeometryNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(s.IndexedLineSet),this.setGeometryType(1),this.colorNode=null,this.coordNode=null}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new t(s.inputOutput,"colorIndex",new e.MFInt32),new t(s.inputOutput,"coordIndex",new e.MFInt32),new t(s.inputOutput,"attrib",new e.MFNode),new t(s.inputOutput,"fogCoord",new e.SFNode),new t(s.inputOutput,"color",new e.SFNode),new t(s.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"IndexedLineSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this.attrib_.addInterest("set_attrib__",this),this.color_.addInterest("set_color__",this),this.coord_.addInterest("set_coord__",this),this.setPrimitiveMode(this.getBrowser().getContext().LINES),this.setSolid(!1),this.set_attrib__(),this.set_color__(),this.set_coord__()},set_attrib__:function(){for(var e=this.getAttrib(),t=0,i=e.length;t<i;++t)e[t].removeInterest("addNodeEvent",this);e.length=0;for(var t=0,i=this.attrib_.length;t<i;++t){var n=r(s.X3DVertexAttributeNode,this.attrib_[t]);n&&e.push(n)}for(var t=0;t<this.attribNodes.length;++t)e[t].addInterest("addNodeEvent",this)},set_color__:function(){this.colorNode&&(this.colorNode.removeInterest("addNodeEvent",this),this.colorNode.removeInterest("set_transparent__",this)),this.colorNode=r(s.X3DColorNode,this.color_),this.colorNode?(this.colorNode.addInterest("addNodeEvent",this),this.colorNode.addInterest("set_transparent__",this),this.set_transparent__()):this.transparent_=!1},set_transparent__:function(){this.transparent_=this.colorNode.isTransparent()},set_coord__:function(){this.coordNode&&this.coordNode.removeInterest("addNodeEvent",this),this.coordNode=r(s.X3DCoordinateNode,this.coord_),this.coordNode&&this.coordNode.addInterest("addNodeEvent",this)},getColorPerVertexIndex:function(e){return e<this.colorIndex_.length?this.colorIndex_[e]:this.coordIndex_[e]},getColorIndex:function(e){return e<this.colorIndex_.length?this.colorIndex_[e]:e},getPolylineIndices:function(){var e=this.coordIndex_,t=[],i=[];if(e.length){for(var n=0,n=0,r=e.length;n<r;++n){e[n]>=0?i.push(n):(t.push(i),i=[])}e[e.length-1]>=0&&t.push(i)}return t},build:function(){if(this.coordNode&&!this.coordNode.isEmpty())for(var e=this.coordIndex_,t=this.getPolylineIndices(),i=this.colorPerVertex_.getValue(),n=this.getAttrib(),r=n.length,s=this.getAttribs(),o=this.colorNode,a=this.coordNode,u=this.getColors(),l=this.getVertices(),h=0,c=0;c<t.length;++c){var d=t[c];if(d.length>1)for(var p=0,f=d.length-1;p<f;++p)for(var g=p,m=p+2;g<m;++g){for(var _=d[g],x=e[_],y=0;y<r;++y)n[y].addValue(x,s[y]);o&&(i?o.addColor(this.getColorPerVertexIndex(_),u):o.addColor(this.getColorIndex(h),u)),a.addPoint(x,l)}++h}}}),o}),define("x_ite/Components/CADGeometry/IndexedQuadSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.IndexedQuadSet)}var o=[0,1,2,0,2,3];return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"solid",new e.SFBool(!0)),new t(r.initializeOnly,"ccw",new e.SFBool(!0)),new t(r.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new t(r.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new t(r.inputOutput,"index",new e.MFInt32),new t(r.inputOutput,"attrib",new e.MFNode),new t(r.inputOutput,"fogCoord",new e.SFNode),new t(r.inputOutput,"color",new e.SFNode),new t(r.inputOutput,"texCoord",new e.SFNode),new t(r.inputOutput,"normal",new e.SFNode),new t(r.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"IndexedQuadSet"},getComponentName:function(){return"CADGeometry"},getContainerField:function(){return"geometry"},getTriangleIndex:function(e){var t=e%6;return(e-t)/6*4+o[t]},getPolygonIndex:function(e){return this.index_[e]},build:function(){var e=this.index_.length;e-=e%4,n.prototype.build.call(this,4,e,6,e/4*6)}}),s}),define("x_ite/Components/Rendering/IndexedTriangleFanSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.IndexedTriangleFanSet),this.triangleIndex=[]}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"solid",new e.SFBool(!0)),new t(r.initializeOnly,"ccw",new e.SFBool(!0)),new t(r.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new t(r.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new t(r.inputOutput,"index",new e.MFInt32),new t(r.inputOutput,"attrib",new e.MFNode),new t(r.inputOutput,"fogCoord",new e.SFNode),new t(r.inputOutput,"color",new e.SFNode),new t(r.inputOutput,"texCoord",new e.SFNode),new t(r.inputOutput,"normal",new e.SFNode),new t(r.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"IndexedTriangleFanSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this.index_.addInterest("set_index__",this),this.set_index__()},set_index__:function(){var e=this.index_,t=this.triangleIndex;t.length=0;for(var i=0,n=e.length;i<n;++i){var r=e[i];if(++i<n){var s=e[i];if(s<0)continue;for(++i;i<n;++i){var o=e[i];if(o<0)break;t.push(r,s,o),s=o}}}},getPolygonIndex:function(e){return this.triangleIndex[e]},build:function(){n.prototype.build.call(this,3,this.triangleIndex.length,3,this.triangleIndex.length)}}),s}),define("x_ite/Components/Rendering/IndexedTriangleSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.IndexedTriangleSet)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"solid",new e.SFBool(!0)),new t(r.initializeOnly,"ccw",new e.SFBool(!0)),new t(r.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new t(r.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new t(r.inputOutput,"index",new e.MFInt32),new t(r.inputOutput,"attrib",new e.MFNode),new t(r.inputOutput,"fogCoord",new e.SFNode),new t(r.inputOutput,"color",new e.SFNode),new t(r.inputOutput,"texCoord",new e.SFNode),new t(r.inputOutput,"normal",new e.SFNode),new t(r.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"IndexedTriangleSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},getPolygonIndex:function(e){return this.index_[e]},build:function(){n.prototype.build.call(this,3,this.index_.length,3,this.index_.length)}}),s}),define("x_ite/Components/Rendering/IndexedTriangleStripSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.IndexedTriangleStripSet),this.triangleIndex=[]}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"solid",new e.SFBool(!0)),new t(r.initializeOnly,"ccw",new e.SFBool(!0)),new t(r.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new t(r.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new t(r.inputOutput,"index",new e.MFInt32),new t(r.inputOutput,"attrib",new e.MFNode),new t(r.inputOutput,"fogCoord",new e.SFNode),new t(r.inputOutput,"color",new e.SFNode),new t(r.inputOutput,"texCoord",new e.SFNode),new t(r.inputOutput,"normal",new e.SFNode),new t(r.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"IndexedTriangleStripSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this.index_.addInterest("set_index__",this),this.set_index__()},set_index__:function(){var e=this.index_,t=this.triangleIndex;t.length=0;for(var i=0,n=e.length;i<n;++i){var r=e[i];if(!(r<0)&&++i<n){var s=e[i];if(s<0)continue;++i;for(var o=0;i<n;++i,++o){var a=e[i];if(a<0)break;t.push(r,s,a),1&o?s=a:r=a}}}},getPolygonIndex:function(e){return this.triangleIndex[e]},build:function(){n.prototype.build.call(this,3,this.triangleIndex.length,3,this.triangleIndex.length)}}),s}),define("x_ite/Components/EventUtilities/IntegerSequencer",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/EventUtilities/X3DSequencerNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.IntegerSequencer)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_fraction",new e.SFFloat),new t(r.inputOnly,"previous",new e.SFBool),new t(r.inputOnly,"next",new e.SFBool),new t(r.inputOutput,"key",new e.MFFloat),new t(r.inputOutput,"keyValue",new e.MFInt32),new t(r.outputOnly,"value_changed",new e.SFInt32)]),getTypeName:function(){return"IntegerSequencer"},getComponentName:function(){return"EventUtilities"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.keyValue_.addInterest("set_index__",this)},getSize:function(){return this.keyValue_.length},sequence:function(e){this.value_changed_=this.keyValue_[e]}}),s}),define("x_ite/Components/EventUtilities/IntegerTrigger",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/EventUtilities/X3DTriggerNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.IntegerTrigger)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_boolean",new e.SFBool),new t(r.inputOutput,"integerKey",new e.SFInt32(-1)),new t(r.outputOnly,"triggerValue",new e.SFInt32)]),getTypeName:function(){return"IntegerTrigger"},getComponentName:function(){return"EventUtilities"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.set_boolean_.addInterest("set_boolean__",this)},set_boolean__:function(){this.triggerValue_=this.integerKey_}}),s}),define("x_ite/Components/KeyDeviceSensor/X3DKeyDeviceSensorNode",["x_ite/Components/Core/X3DSensorNode","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DKeyDeviceSensorNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,initialize:function(){e.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this),this.set_live__()},set_live__:function(){this.isLive().getValue()?(this.enabled_.addInterest("set_enabled__",this),this.enabled_.getValue()&&this.enable()):(this.enabled_.removeInterest("set_enabled__",this),this.disable())},set_enabled__:function(){this.enabled_.getValue()?this.enable():this.disable()},enable:function(){this.getBrowser().addKeyDeviceSensorNode(this)},disable:function(){this.getBrowser().removeKeyDeviceSensorNode(this),this.release()},keydown:function(){},keyup:function(){},release:function(){}}),i}),define("x_ite/Components/KeyDeviceSensor/KeySensor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/KeyDeviceSensor/X3DKeyDeviceSensorNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.KeySensor)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"enabled",new e.SFBool(!0)),new t(r.outputOnly,"controlKey",new e.SFBool),new t(r.outputOnly,"shiftKey",new e.SFBool),new t(r.outputOnly,"altKey",new e.SFBool),new t(r.outputOnly,"actionKeyPress",new e.SFInt32),new t(r.outputOnly,"actionKeyRelease",new e.SFInt32),new t(r.outputOnly,"keyPress",new e.SFString),new t(r.outputOnly,"keyRelease",new e.SFString),new t(r.outputOnly,"isActive",new e.SFBool)]),getTypeName:function(){return"KeySensor"},getComponentName:function(){return"KeyDeviceSensor"},getContainerField:function(){return"children"},keydown:function(e){switch(e.preventDefault(),this.isActive_.getValue()||(this.isActive_=!0),e.which){case 16:this.shiftKey_=!0;break;case 17:this.controlKey_=!0;break;case 18:this.altKey_=!0;break;case 112:this.actionKeyPress_=1;break;case 113:this.actionKeyPress_=2;break;case 114:this.actionKeyPress_=3;break;case 115:this.actionKeyPress_=4;break;case 116:this.actionKeyPress_=5;break;case 117:this.actionKeyPress_=6;break;case 118:this.actionKeyPress_=7;break;case 119:this.actionKeyPress_=8;break;case 120:this.actionKeyPress_=9;break;case 121:this.actionKeyPress_=10;break;case 122:this.actionKeyPress_=11;break;case 123:this.actionKeyPress_=12;break;case 36:this.actionKeyPress_=13;break;case 35:this.actionKeyPress_=14;break;case 33:this.actionKeyPress_=15;break;case 34:this.actionKeyPress_=16;break;case 38:this.actionKeyPress_=17;break;case 40:this.actionKeyPress_=18;break;case 37:this.actionKeyPress_=19;break;case 39:this.actionKeyPress_=20;break;default:if(e.charCode||e.keyCode)switch(e.key){case"AltGraph":case"CapsLock":case"Insert":break;case"Backspace":this.keyPress_=String.fromCharCode(8);break;case"Delete":this.keyPress_=String.fromCharCode(127);break;case"Enter":this.keyPress_="\n";break;case"Escape":this.keyPress_=String.fromCharCode(27);break;case"Tab":this.keyPress_="\t";break;default:1===e.key.length&&(this.keyPress_=e.key)}}},keyup:function(e){switch(e.preventDefault(),e.which){case 16:this.shiftKey_=!1;break;case 17:this.controlKey_=!1;break;case 18:this.altKey_=!1;break;case 112:this.actionKeyRelease_=1;break;case 113:this.actionKeyRelease_=2;break;case 114:this.actionKeyRelease_=3;break;case 115:this.actionKeyRelease_=4;break;case 116:this.actionKeyRelease_=5;break;case 117:this.actionKeyRelease_=6;break;case 118:this.actionKeyRelease_=7;break;case 119:this.actionKeyRelease_=8;break;case 120:this.actionKeyRelease_=9;break;case 121:this.actionKeyRelease_=10;break;case 122:this.actionKeyRelease_=11;break;case 123:this.actionKeyRelease_=12;break;case 36:this.actionKeyRelease_=13;break;case 35:this.actionKeyRelease_=14;break;case 33:this.actionKeyRelease_=15;break;case 34:this.actionKeyRelease_=16;break;case 38:this.actionKeyRelease_=17;break;case 40:this.actionKeyRelease_=18;break;case 37:this.actionKeyRelease_=19;break;case 39:this.actionKeyRelease_=20;break;default:if(e.charCode||e.keyCode)switch(e.key){case"AltGraph":case"CapsLock":case"Insert":break;case"Backspace":this.keyRelease_=String.fromCharCode(8);break;case"Delete":this.keyRelease_=String.fromCharCode(127);break;case"Enter":this.keyRelease_="\n";break;case"Escape":this.keyRelease_=String.fromCharCode(27);break;case"Tab":this.keyRelease_="\t";break;default:1===e.key.length&&(this.keyRelease_=e.key)}}this.isActive_.getValue()&&(this.isActive_=!1)},release:function(){this.shiftKey_.getValue()&&(this.shiftKey_=!1),this.controlKey_.getValue()&&(this.controlKey_=!1),this.altKey_.getValue()&&(this.altKey_=!1)}}),s}),define("x_ite/Components/Navigation/LOD",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/X3DCast","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4","standard/Math/Algorithm"],function(e,t,i,n,r,s,o,a,u){"use strict";function l(e){n.call(this,e),this.addType(o.LOD),"2.0"==e.getSpecificationVersion()&&this.addAlias("level",this.children_),this.center_.setUnit("length"),this.range_.setUnit("length"),this.frameRate=60,this.keepCurrentLevel=!1}return l.prototype=Object.assign(Object.create(n.prototype),{constructor:l,fieldDefinitions:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.initializeOnly,"forceTransitions",new e.SFBool),new t(o.initializeOnly,"center",new e.SFVec3f),new t(o.initializeOnly,"range",new e.MFFloat),new t(o.outputOnly,"level_changed",new e.SFInt32(-1)),new t(o.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(o.initializeOnly,"bboxCenter",new e.SFVec3f),new t(o.inputOnly,"addChildren",new e.MFNode),new t(o.inputOnly,"removeChildren",new e.MFNode),new t(o.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"LOD"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.child=this.getChild(this.level_changed_.getValue()),this.set_cameraObjects__()},set_cameraObjects__:function(){this.child&&this.child.getCameraObject?this.setCameraObject(this.child.getCameraObject()):this.setCameraObject(!1)},getBBox:function(e){if(this.bboxSize_.getValue().equals(this.defaultBBoxSize)){var t=r(o.X3DBoundedObject,this.child);return t?t.getBBox(e):e.set()}return e.set(this.bboxSize_.getValue(),this.bboxCenter_.getValue())},getLevel:function(){return function(e,t){if(0===this.range_.length){var i=this.children_.length;if(i<2)return 0;if(this.frameRate=(179*this.frameRate+e.currentFrameRate)/180,2===i)return Number(this.frameRate>55);var n=1-u.clamp((this.frameRate-20)/35,0,1);return Math.min(Math.floor(n*i),i-1)}var r=this.getDistance(t);return u.upperBound(this.range_,0,this.range_.length,r,u.less)}}(),getDistance:function(e){return e.translate(this.center_.getValue()),e.origin.abs()},traverse:function(){var e=new a;return function(t,i){if(!this.keepCurrentLevel&&t===s.DISPLAY){var n=this.getLevel(i.getBrowser(),e.assign(i.getModelViewMatrix().get())),r=this.level_changed_.getValue();this.forceTransitions_.getValue()&&(n>r?n=r+1:n<r&&(n=r-1)),n!==r&&(this.level_changed_=n,this.child=this.getChild(Math.min(n,this.children_.length-1)),this.set_cameraObjects__())}this.child&&this.child.traverse(t,i)}}()}),l}),define("x_ite/Components/Layout/X3DLayoutNode",["x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DLayoutNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i}),i}),define("x_ite/Components/Layout/Layout",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Layout/X3DLayoutNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r,s,o,a,u,l){"use strict";function h(e){n.call(this,e),this.addType(s.Layout),this.alignX=p,this.alignY=p,this.offsetUnitX=_,this.offsetUnitY=_,this.offsetX=0,this.offsetY=0,this.sizeUnitX=_,this.sizeUnitY=_,this.sizeX=1,this.sizeY=1,this.scaleModeX=v,this.scaleModeY=v,this.parent=null,this.rectangleCenter=new o(0,0),this.rectangleSize=new o(0,0),this.matrix=new l}var c=0,d=c++,p=c++,f=c++,g=c++,m=c++,_=c++,x=c++,y=c++,v=c++,w=c++;return h.prototype=Object.assign(Object.create(n.prototype),{constructor:h,viewportPixel:new o(0,0),pixelSize:new o(0,0),translation:new a(0,0,0),offset:new a(0,0,0),scale:new a(1,1,1),currentTranslation:new a(0,0,0),currentRotation:new u(0,0,1,0),currentScale:new a(0,0,0),modelViewMatrix:new l,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"align",new e.MFString("CENTER","CENTER")),new t(s.inputOutput,"offsetUnits",new e.MFString("WORLD","WORLD")),new t(s.inputOutput,"offset",new e.MFFloat(0,0)),new t(s.inputOutput,"sizeUnits",new e.MFString("WORLD","WORLD")),new t(s.inputOutput,"size",new e.MFFloat(1,1)),new t(s.inputOutput,"scaleMode",new e.MFString("NONE","NONE"))]),getTypeName:function(){return"Layout"},getComponentName:function(){return"Layout"},getContainerField:function(){return"layout"},initialize:function(){n.prototype.initialize.call(this),this.align_.addInterest("set_align__",this),this.offsetUnits_.addInterest("set_offsetUnits__",this),this.offset_.addInterest("set_offset__",this),this.sizeUnits_.addInterest("set_sizeUnits__",this),this.size_.addInterest("set_size__",this),this.scaleMode_.addInterest("set_scaleMode__",this),this.set_align__(),this.set_offsetUnits__(),this.set_offset__(),this.set_sizeUnits__(),this.set_size__(),this.set_scaleMode__()},set_align__:function(){this.align_.length>0?"LEFT"===this.align_[0]?this.alignX=d:"RIGHT"===this.align_[0]?this.alignX=f:this.alignX=p:this.alignX=p,this.align_.length>1?"BOTTOM"===this.align_[1]?this.alignY=g:"TOP"===this.align_[1]?this.alignY=m:this.alignY=p:this.alignY=p},set_offsetUnits__:function(){this.offsetUnits_.length>0?("FRACTION"===this.offsetUnits_[0]?this.offsetUnitX=x:"PIXEL"===this.offsetUnits_[0]?this.offsetUnitX=y:this.offsetUnitX=_,this.offsetUnits_.length>1?"FRACTION"===this.offsetUnits_[1]?this.offsetUnitY=x:"PIXEL"===this.offsetUnits_[1]?this.offsetUnitY=y:this.offsetUnitY=_:this.offsetUnitY=this.offsetUnitX):(this.offsetUnitX=_,this.offsetUnitY=_)},set_offset__:function(){this.offset_.length>0?(this.offsetX=this.offset_[0],this.offset_.length>1?this.offsetY=this.offset_[1]:this.offsetY=offsetX):(this.offsetX=0,this.offsetY=0)},set_sizeUnits__:function(){this.sizeUnits_.length>0?("FRACTION"===this.sizeUnits_[0]?this.sizeUnitX=x:"PIXEL"===this.sizeUnits_[0]?this.sizeUnitX=y:this.sizeUnitX=_,this.sizeUnits_.length>1?"FRACTION"===this.sizeUnits_[1]?this.sizeUnitY=x:"PIXEL"===this.sizeUnits_[1]?this.sizeUnitY=y:this.sizeUnitY=_:this.sizeUnitY=this.sizeUnitX):(this.sizeUnitX=_,this.sizeUnitY=_)},set_size__:function(){this.size_.length>0?(this.sizeX=this.size_[0],this.size_.length>1?this.sizeY=this.size_[1]:this.sizeY=this.sizeX):(this.sizeX=0,this.sizeY=0)},set_scaleMode__:function(){this.scaleMode_.length>0?("FRACTION"===this.scaleMode_[0]?this.scaleModeX=x:"PIXEL"===this.scaleMode_[0]?this.scaleModeX=y:"STRETCH"===this.scaleMode_[0]?this.scaleModeX=w:this.scaleModeX=v,this.scaleMode_.length>1?"FRACTION"===this.scaleMode_[1]?this.scaleModeY=x:"PIXEL"===this.scaleMode_[1]?this.scaleModeY=y:"STRETCH"===this.scaleMode_[1]?this.scaleModeY=w:this.scaleModeY=v:this.scaleModeY=this.scaleModeX):(this.scaleModeX=v,this.scaleModeY=v)},getRectangleCenter:function(){return this.rectangleCenter},getRectangleSize:function(){return this.rectangleSize},getAlignX:function(){return this.alignX},getAlignY:function(){return this.alignY},getOffsetUnitX:function(){return this.offsetUnitX===_?this.parent?this.parent.getOffsetUnitX():x:this.offsetUnitX},getOffsetUnitY:function(){return this.offsetUnitY===_?this.parent?this.parent.getOffsetUnitY():x:this.offsetUnitY},getOffsetX:function(){return this.offsetX},getOffsetY:function(){return this.offsetY},getSizeUnitX:function(){return this.sizeUnitX===_?this.parent?this.parent.getSizeUnitX():x:this.sizeUnitX},getSizeUnitY:function(){return this.sizeUnitY===_?this.parent?this.parent.getSizeUnitY():x:this.sizeUnitY},getSizeX:function(){return this.sizeX},getSizeY:function(){return this.sizeY},getScaleModeX:function(){return this.parent?this.scaleModeX:this.scaleModeX===v?x:this.scaleModeX},getScaleModeY:function(){return this.parent?this.scaleModeY:this.scaleModeY===v?x:this.scaleModeY},transform:function(e,t){var i=this.matrix,n=r(s.OrthoViewpoint,t.getViewpoint());if(n){var o=this.parent=t.getParentLayout(),a=t.getViewVolume().getScissor(),u=n.getViewportSize(a),l=this.viewportPixel,h=this.pixelSize,c=o?o.getRectangleSize():u,_=this.rectangleSize,b=this.rectangleCenter;switch(l.set(a[2],a[3]),h.assign(u).divVec(l),this.getSizeUnitX()){case x:_.x=this.sizeX*c.x;break;case y:_.x=this.sizeX*h.x}switch(this.getSizeUnitY()){case x:_.y=this.sizeY*c.y;break;case y:_.y=this.sizeY*h.y}var S=this.translation.set(0,0,0);switch(this.getAlignX()){case d:S.x=-(c.x-_.x)/2;break;case p:this.getSizeUnitX()===y&&1&l.x&&(S.x=-h.x/2);break;case f:S.x=(c.x-_.x)/2}switch(this.getAlignY()){case g:S.y=-(c.y-_.y)/2;break;case p:this.getSizeUnitX===y&&1&l.y&&(S.y=-h.y/2);break;case m:S.y=(c.y-_.y)/2}var C=this.offset.set(0,0,0);switch(this.getOffsetUnitX()){case x:C.x=this.offsetX*c.x;break;case y:C.x=this.offsetX*u.x/l.x}switch(this.getOffsetUnitY()){case x:C.y=this.offsetY*c.y;break;case y:C.y=this.offsetY*u.y/l.y}var T=this.scale.set(1,1,1),F=this.currentTranslation,O=this.currentRotation,N=this.currentScale;switch(t.getModelViewMatrix().get().get(F,O,N),this.getScaleModeX()){case v:T.x=N.x;break;case x:T.x=_.x;break;case w:break;case y:T.x=u.x/l.x}switch(this.getScaleModeY()){case v:T.y=N.y;break;case x:T.y=_.y;break;case w:break;case y:T.y=u.y/l.y}this.getScaleModeX()===w?this.getScaleModeY()===w?_.x>_.y?(T.x=_.x,T.y=T.x):(T.y=_.y,T.x=T.y):T.x=T.y:this.getScaleModeY()===w&&(T.y=T.x),b.assign(S).add(C),i.set(F,O),i.translate(S.add(C)),i.scale(T)}else i.identity();return i}}),h}),define("x_ite/Components/Layout/LayoutGroup",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/X3DCast","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r,s,o,a){"use strict";function u(e){n.call(this,e),this.addType(o.LayoutGroup),this.viewportNode=null,this.layoutNode=null,this.modelViewMatrix=new a,this.screenMatrix=new a}return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,fieldDefinitions:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"layout",new e.SFNode),new t(o.inputOutput,"viewport",new e.SFNode),new t(o.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(o.initializeOnly,"bboxCenter",new e.SFVec3f),new t(o.inputOnly,"addChildren",new e.MFNode),new t(o.inputOnly,"removeChildren",new e.MFNode),new t(o.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"LayoutGroup"},getComponentName:function(){return"Layout"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.viewport_.addInterest("set_viewport__",this),this.layout_.addInterest("set_layout__",this),this.set_viewport__(),this.set_layout__()},set_viewport__:function(){this.viewportNode=r(o.X3DViewportNode,this.viewport_)},set_layout__:function(){this.layoutNode=r(o.X3DLayoutNode,this.layout_)},getBBox:function(e){return n.prototype.getBBox.call(this,e).multRight(this.getMatrix())},getMatrix:function(){try{this.layoutNode?this.matrix.assign(this.modelViewMatrix).inverse().multLeft(this.screenMatrix):this.matrix.identity()}catch(e){}return this.matrix},traverse:function(e,t){switch(e){case s.POINTER:case s.CAMERA:case s.DEPTH:case s.DISPLAY:if(this.viewportNode&&this.viewportNode.push(),this.layoutNode){var i=t.getModelViewMatrix();this.modelViewMatrix.assign(i.get()),i.push(),i.set(this.screenMatrix.assign(this.layoutNode.transform(e,t))),t.getLayouts().push(this.layoutNode),n.prototype.traverse.call(this,e,t),t.getLayouts().pop(),i.pop()}else n.prototype.traverse.call(this,e,t);this.viewportNode&&this.viewportNode.pop()}}}),u}),define("x_ite/Components/Layout/LayoutLayer",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Layering/X3DLayerNode","x_ite/Components/Layout/LayoutGroup","x_ite/Components/Navigation/OrthoViewpoint","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s,o){"use strict";function a(e){n.call(this,e,new s(e),new r(e)),this.addType(o.LayoutLayer)}return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,fieldDefinitions:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"isPickable",new e.SFBool(!0)),new t(o.inputOutput,"layout",new e.SFNode),new t(o.inputOutput,"viewport",new e.SFNode),new t(o.inputOnly,"addChildren",new e.MFNode),new t(o.inputOnly,"removeChildren",new e.MFNode),new t(o.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"LayoutLayer"},getComponentName:function(){return"Layout"},getContainerField:function(){return"layers"},initialize:function(){this.layout_.addFieldInterest(this.getGroup().layout_),this.getGroup().layout_=this.layout_,n.prototype.initialize.call(this)}}),a}),define("x_ite/Components/Shape/LineProperties",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.LineProperties)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"applied",new e.SFBool(!0)),new t(r.inputOutput,"linetype",new e.SFInt32(1)),new t(r.inputOutput,"linewidthScaleFactor",new e.SFFloat)]),getTypeName:function(){return"LineProperties"},getComponentName:function(){return"Shape"},getContainerField:function(){return"lineProperties"},initialize:function(){n.prototype.initialize.call(this),this.linewidthScaleFactor_.addInterest("set_linewidthScaleFactor__",this),this.set_linewidthScaleFactor__()},getLinewidthScaleFactor:function(){return this.linewidthScaleFactor},set_linewidthScaleFactor__:function(){this.linewidthScaleFactor=Math.max(1,this.linewidthScaleFactor_.getValue())}}),s}),define("x_ite/Components/Rendering/LineSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DLineGeometryNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(s.LineSet),this.setGeometryType(1),this.colorNode=null,this.coordNode=null}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"vertexCount",new e.MFInt32),new t(s.inputOutput,"attrib",new e.MFNode),new t(s.inputOutput,"fogCoord",new e.SFNode),new t(s.inputOutput,"color",new e.SFNode),new t(s.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"LineSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this.attrib_.addInterest("set_attrib__",this),this.color_.addInterest("set_color__",this),this.coord_.addInterest("set_coord__",this),this.setPrimitiveMode(this.getBrowser().getContext().LINES),this.setSolid(!1),this.set_attrib__(),this.set_color__(),
this.set_coord__()},set_attrib__:function(){for(var e=this.getAttrib(),t=0,i=e.length;t<i;++t)e[t].removeInterest("addNodeEvent",this);e.length=0;for(var t=0,i=this.attrib_.length;t<i;++t){var n=r(s.X3DVertexAttributeNode,this.attrib_[t]);n&&e.push(n)}for(var t=0;t<this.attribNodes.length;++t)e[t].addInterest("addNodeEvent",this)},set_color__:function(){this.colorNode&&(this.colorNode.removeInterest("addNodeEvent",this),this.colorNode.removeInterest("set_transparent__",this)),this.colorNode=r(s.X3DColorNode,this.color_),this.colorNode?(this.colorNode.addInterest("addNodeEvent",this),this.colorNode.addInterest("set_transparent__",this),this.set_transparent__()):this.transparent_=!1},set_transparent__:function(){this.transparent_=this.colorNode.isTransparent()},set_coord__:function(){this.coordNode&&this.coordNode.removeInterest("addNodeEvent",this),this.coordNode=r(s.X3DCoordinateNode,this.coord_),this.coordNode&&this.coordNode.addInterest("addNodeEvent",this)},build:function(){if(this.coordNode&&!this.coordNode.isEmpty())for(var e=this.vertexCount_,t=this.getAttrib(),i=t.length,n=this.getAttribs(),r=this.colorNode,s=this.coordNode,o=this.getColors(),a=this.getVertices(),u=s.getSize(),l=0,h=0,c=e.length;h<c;++h){var d=e[h];if(l+d>u)break;if(d>1){d=2*d-2;for(var p=0;p<d;++p,l+=1&p){for(var f=0;f<i;++f)t[f].addValue(l,n[f]);r&&r.addColor(l,o),s.addPoint(l,a)}++l}else l+=d}}}),o}),define("x_ite/Components/EnvironmentalEffects/LocalFog",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Components/EnvironmentalEffects/X3DFogObject","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),r.call(this,e),this.addType(s.LocalFog)}return o.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:o,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"enabled",new e.SFBool(!0)),new t(s.inputOutput,"fogType",new e.SFString("LINEAR")),new t(s.inputOutput,"color",new e.SFColor(1,1,1)),new t(s.inputOutput,"visibilityRange",new e.SFFloat)]),getTypeName:function(){return"LocalFog"},getComponentName:function(){return"EnvironmentalEffects"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this)},push:function(e){if(this.enabled_.getValue()){var t=this.getFogs().pop();t.set(this,e.getModelViewMatrix().get()),e.pushLocalFog(t)}},pop:function(e){this.enabled_.getValue()&&e.getBrowser().getLocalFogs().push(e.popLocalFog())}}),o}),define("x_ite/Components/Shape/X3DMaterialNode",["x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DMaterialNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i}),i}),define("x_ite/Components/Shape/Material",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shape/X3DMaterialNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(e,t,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(r.Material),this.addChildObjects("transparent",new e.SFBool),this.transparent_.setAccessType(r.outputOnly),this.diffuseColor=new Float32Array(3),this.specularColor=new Float32Array(3),this.emissiveColor=new Float32Array(3)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"ambientIntensity",new e.SFFloat(.2)),new t(r.inputOutput,"diffuseColor",new e.SFColor(.8,.8,.8)),new t(r.inputOutput,"specularColor",new e.SFColor),new t(r.inputOutput,"emissiveColor",new e.SFColor),new t(r.inputOutput,"shininess",new e.SFFloat(.2)),new t(r.inputOutput,"transparency",new e.SFFloat)]),getTypeName:function(){return"Material"},getComponentName:function(){return"Shape"},getContainerField:function(){return"material"},initialize:function(){n.prototype.initialize.call(this),this.ambientIntensity_.addInterest("set_ambientIntensity__",this),this.diffuseColor_.addInterest("set_diffuseColor__",this),this.specularColor_.addInterest("set_specularColor__",this),this.emissiveColor_.addInterest("set_emissiveColor__",this),this.shininess_.addInterest("set_shininess__",this),this.transparency_.addInterest("set_transparency__",this),this.set_ambientIntensity__(),this.set_diffuseColor__(),this.set_specularColor__(),this.set_emissiveColor__(),this.set_shininess__(),this.set_transparency__()},set_ambientIntensity__:function(){this.ambientIntensity=Math.max(this.ambientIntensity_.getValue(),0)},set_diffuseColor__:function(){var e=this.diffuseColor,t=this.diffuseColor_.getValue();e[0]=t.r,e[1]=t.g,e[2]=t.b},set_specularColor__:function(){var e=this.specularColor,t=this.specularColor_.getValue();e[0]=t.r,e[1]=t.g,e[2]=t.b},set_emissiveColor__:function(){var e=this.emissiveColor,t=this.emissiveColor_.getValue();e[0]=t.r,e[1]=t.g,e[2]=t.b},set_shininess__:function(){this.shininess=s.clamp(this.shininess_.getValue(),0,1)},set_transparency__:function(){var e=s.clamp(this.transparency_.getValue(),0,1);this.transparency=e,e!=this.transparent_.getValue()&&(this.transparent_=e)},setShaderUniforms:function(e,t){e.uniform1i(t.x3d_SeparateBackColor,!1),e.uniform1f(t.x3d_AmbientIntensity,this.ambientIntensity),e.uniform3fv(t.x3d_DiffuseColor,this.diffuseColor),e.uniform3fv(t.x3d_SpecularColor,this.specularColor),e.uniform3fv(t.x3d_EmissiveColor,this.emissiveColor),e.uniform1f(t.x3d_Shininess,this.shininess),e.uniform1f(t.x3d_Transparency,this.transparency)}}),o}),define("x_ite/Components/Shaders/Matrix3VertexAttribute",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shaders/X3DVertexAttributeNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix3"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.Matrix3VertexAttribute)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"name",new e.SFString),new t(r.inputOutput,"value",new e.MFMatrix3f)]),getTypeName:function(){return"Matrix3VertexAttribute"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"attrib"},initialize:function(){n.prototype.initialize.call(this),this.value_.addInterest("set_value",this),this.set_value()},set_value:function(){this.value=this.value_.getValue(),this.length=this.value_.length},addValue:function(e,t){if(e<this.length)for(var i=this.value,n=9*e,r=n+9;n<r;++n)t.push(i[n]);else for(var i=s.Identity,n=0;n<9;++n)t.push(i[n])},enable:function(e,t,i){t.enableMatrix3Attrib(e,this.name_.getValue(),i)},disable:function(e,t){t.disableMatrix3Attrib(e,this.name_.getValue())}}),o}),define("x_ite/Components/Shaders/Matrix4VertexAttribute",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shaders/X3DVertexAttributeNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.Matrix4VertexAttribute)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"name",new e.SFString),new t(r.inputOutput,"value",new e.MFMatrix4f)]),getTypeName:function(){return"Matrix4VertexAttribute"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"attrib"},initialize:function(){n.prototype.initialize.call(this),this.value_.addInterest("set_value",this),this.set_value()},set_value:function(){this.value=this.value_.getValue(),this.length=this.value_.length},addValue:function(e,t){if(e<this.length)for(var i=this.value,n=16*e,r=n+16;n<r;++n)t.push(i[n]);else for(var i=Matrix4.Identity,n=0;n<16;++n)t.push(i[n])},enable:function(e,t,i){t.enableMatrix4Attrib(e,this.name_.getValue(),i)},disable:function(e,t){t.disableMatrix4Attrib(e,this.name_.getValue())}}),s}),define("x_ite/Components/Core/X3DMetadataObject",["x_ite/Bits/X3DConstants"],function(e){"use strict";function t(t){this.addType(e.X3DMetadataObject)}return t.prototype={constructor:t,initialize:function(){}},t}),define("x_ite/Components/Core/MetadataBoolean",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),r.call(this,e),this.addType(s.MetadataBoolean)}return o.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:o,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"name",new e.SFString),new t(s.inputOutput,"reference",new e.SFString),new t(s.inputOutput,"value",new e.MFBool)]),getTypeName:function(){return"MetadataBoolean"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),o}),define("x_ite/Components/Core/MetadataDouble",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),r.call(this,e),this.addType(s.MetadataDouble)}return o.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:o,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"name",new e.SFString),new t(s.inputOutput,"reference",new e.SFString),new t(s.inputOutput,"value",new e.MFDouble)]),getTypeName:function(){return"MetadataDouble"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),o}),define("x_ite/Components/Core/MetadataFloat",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),r.call(this,e),this.addType(s.MetadataFloat)}return o.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:o,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"name",new e.SFString),new t(s.inputOutput,"reference",new e.SFString),new t(s.inputOutput,"value",new e.MFFloat)]),getTypeName:function(){return"MetadataFloat"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),o}),define("x_ite/Components/Core/MetadataInteger",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),r.call(this,e),this.addType(s.MetadataInteger)}return o.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:o,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"name",new e.SFString),new t(s.inputOutput,"reference",new e.SFString),new t(s.inputOutput,"value",new e.MFInt32)]),getTypeName:function(){return"MetadataInteger"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),o}),define("x_ite/Components/Core/MetadataSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),r.call(this,e),this.addType(s.MetadataSet)}return o.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:o,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"name",new e.SFString),new t(s.inputOutput,"reference",new e.SFString),new t(s.inputOutput,"value",new e.MFNode)]),getTypeName:function(){return"MetadataSet"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),o}),define("x_ite/Components/Core/MetadataString",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),r.call(this,e),this.addType(s.MetadataString)}return o.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:o,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"name",new e.SFString),new t(s.inputOutput,"reference",new e.SFString),new t(s.inputOutput,"value",new e.MFString)]),getTypeName:function(){return"MetadataString"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),o}),define("x_ite/Components/Texturing/MovieTexture",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Texturing/X3DTexture2DNode","x_ite/Components/Sound/X3DSoundSourceNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Bits/X3DConstants","x_ite/Browser/Networking/urls","standard/Networking/URI","standard/Math/Algorithm","x_ite/DEBUG"],function(e,t,i,n,r,s,o,a,u,l,h,c){"use strict";function d(e){r.call(this,e),s.call(this,e),o.call(this,e),this.addType(a.MovieTexture),this.addChildObjects("buffer",new t.SFTime),this.urlStack=new t.MFString}return d.prototype=Object.assign(Object.create(r.prototype),s.prototype,o.prototype,{constructor:d,fieldDefinitions:new n([new i(a.inputOutput,"metadata",new t.SFNode),new i(a.inputOutput,"enabled",new t.SFBool(!0)),new i(a.inputOutput,"description",new t.SFString),new i(a.inputOutput,"url",new t.MFString),new i(a.inputOutput,"speed",new t.SFFloat(1)),new i(a.inputOutput,"pitch",new t.SFFloat(1)),new i(a.inputOutput,"loop",new t.SFBool),new i(a.inputOutput,"startTime",new t.SFTime),new i(a.inputOutput,"resumeTime",new t.SFTime),new i(a.inputOutput,"pauseTime",new t.SFTime),new i(a.inputOutput,"stopTime",new t.SFTime),new i(a.outputOnly,"isPaused",new t.SFBool),new i(a.outputOnly,"isActive",new t.SFBool),new i(a.outputOnly,"cycleTime",new t.SFTime),new i(a.outputOnly,"elapsedTime",new t.SFTime),new i(a.outputOnly,"duration_changed",new t.SFTime(-1)),new i(a.initializeOnly,"repeatS",new t.SFBool(!0)),new i(a.initializeOnly,"repeatT",new t.SFBool(!0)),new i(a.initializeOnly,"textureProperties",new t.SFNode)]),getTypeName:function(){return"MovieTexture"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texture"},initialize:function(){r.prototype.initialize.call(this),s.prototype.initialize.call(this),o.prototype.initialize.call(this),this.url_.addInterest("set_url__",this),this.buffer_.addInterest("set_buffer__",this),this.canvas=e("<canvas></canvas>"),this.video=e("<video></video>"),this.video.on("error",this.setError.bind(this)),this.video.bind("abort",this.setError.bind(this)),this.video[0].preload="auto",this.video[0].volume=0,this.video[0].crossOrigin="Anonymous",this.set_url__()},set_url__:function(){this.setLoadState(a.NOT_STARTED_STATE),this.requestAsyncLoad()},requestAsyncLoad:function(){this.checkLoadState()!==a.COMPLETE_STATE&&this.checkLoadState()!==a.IN_PROGRESS_STATE&&(this.setLoadState(a.IN_PROGRESS_STATE),this.buffer_.addEvent())},set_buffer__:function(){this.setMedia(null),this.urlStack.setValue(this.url_),this.video.bind("canplaythrough",this.setVideo.bind(this)),this.loadNext()},loadNext:function(){if(0===this.urlStack.length)return this.duration_changed_=-1,this.clearTexture(),void this.setLoadState(a.FAILED_STATE);this.URL=new l(this.urlStack.shift()),this.URL=this.getExecutionContext().getURL().transform(this.URL),this.video.attr("src",this.URL)},setError:function(){var e=this.URL.toString();c&&(this.URL.isLocal()||"localhost"===this.URL.host||e.match(u.fallbackExpression)||this.urlStack.unshift(u.fallbackUrl+e)),"data"!==this.URL.scheme&&console.warn("Error loading movie:",this.URL.toString()),this.loadNext()},setVideo:function(){c&&"data"!==this.URL.scheme&&console.info("Done loading movie:",this.URL.toString());try{var e=this.video[0],t=e.videoWidth,i=e.videoHeight,n=this.canvas[0],r=n.getContext("2d");if(!h.isPowerOfTwo(t)||!h.isPowerOfTwo(i))throw new Error("The movie texture is a non power-of-two texture.");n.width=t,n.height=i,r.drawImage(e,0,0);var s=r.getImageData(0,0,t,i).data;setTimeout(function(){this.video.unbind("canplaythrough"),this.setMedia(this.video),this.setTexture(t,i,!1,new Uint8Array(s),!0),this.setLoadState(a.COMPLETE_STATE)}.bind(this),16)}catch(e){console.log(e.message),this.setError()}},set_time:function(){s.prototype.set_time.call(this),this.checkLoadState()===a.COMPLETE_STATE&&this.updateTexture(this.getMedia()[0],!0)},traverse:r.prototype.traverse}),d}),define("x_ite/Components/Rendering/X3DNormalNode",["x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DNormalNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i}),i}),define("x_ite/Components/Rendering/Normal",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DNormalNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.Normal)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"vector",new e.MFVec3f)]),getTypeName:function(){return"Normal"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"normal"},initialize:function(){n.prototype.initialize.call(this),this.vector_.addInterest("set_vector__",this),this.set_vector__()},set_vector__:function(){this.vector=this.vector_.getValue(),this.length=this.vector_.length},addVector:function(e,t){if(!(e>=0&&e<this.length))return t.push(0,0,0);{const i=this.vector;e*=3,t.push(i[e],i[e+1],i[e+2])}}}),o}),define("x_ite/Components/Interpolation/NormalInterpolator",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(e,t,i,n,r,s,o){"use strict";function a(e){n.call(this,e),this.addType(r.NormalInterpolator)}var u=new s(0,0,0),l=new s(0,0,0);return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_fraction",new e.SFFloat),new t(r.inputOutput,"key",new e.MFFloat),new t(r.inputOutput,"keyValue",new e.MFVec3f),new t(r.outputOnly,"value_changed",new e.MFVec3f)]),getTypeName:function(){return"NormalInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){},interpolate:function(e,t,i){var n=this.keyValue_.getValue(),r=this.key_.length>1?Math.floor(this.keyValue_.length/this.key_.length):0;this.value_changed_.length=r;var s=this.value_changed_.getValue();e*=r,t=e+r,e*=3,t*=3,r*=3;for(var a=0;a<r;a+=3)try{var h=a+1,c=a+2;u.set(n[e+a],n[e+h],n[e+c]),l.set(n[t+a],n[t+h],n[t+c]);var d=o.simpleSlerp(u,l,i);s[a]=d[0],s[h]=d[1],s[c]=d[2]}catch(e){}this.value_changed_.addEvent()}}),a}),define("x_ite/Components/Followers/OrientationDamper",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Rotation4"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.OrientationDamper)}var a=new s(0,0,1,0),u=new s(0,0,1,0);return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_value",new e.SFRotation),new t(r.inputOnly,"set_destination",new e.SFRotation),new t(r.initializeOnly,"initialValue",new e.SFRotation),new t(r.initializeOnly,"initialDestination",new e.SFRotation),new t(r.initializeOnly,"order",new e.SFInt32(3)),new t(r.inputOutput,"tau",new e.SFTime(.3)),new t(r.inputOutput,"tolerance",new e.SFFloat(-1)),new t(r.outputOnly,"isActive",new e.SFBool),new t(r.outputOnly,"value_changed",new e.SFRotation)]),getTypeName:function(){return"OrientationDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0,1,0)},equals:function(e,t,i){return a.assign(e).inverse().multRight(t),Math.abs(a.angle)<i},interpolate:function(e,t,i){return u.assign(e).slerp(t,i)}}),o}),define("x_ite/Components/Shape/X3DShapeNode",["x_ite/Components/Core/X3DChildNode","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants","standard/Math/Geometry/Box3","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,s){"use strict";function o(i){e.call(this,i),t.call(this,i),this.addType(n.X3DShapeNode),this.bbox=new r,this.bboxSize=new s(0,0,0),this.bboxCenter=new s(0,0,0)}return o.prototype=Object.assign(Object.create(e.prototype),t.prototype,{constructor:o,initialize:function(){e.prototype.initialize.call(this),t.prototype.initialize.call(this),this.bboxSize_.addInterest("set_bbox__",this),this.bboxCenter_.addInterest("set_bbox__",this),this.appearance_.addInterest("set_apparance__",this),this.geometry_.addInterest("set_geometry__",this),this.set_apparance__(),this.set_geometry__()},getBBox:function(e){return e.assign(this.bbox)},getBBoxSize:function(){return this.bboxSize},getBBoxCenter:function(){return this.bboxCenter},getAppearance:function(){return this.apparanceNode},getGeometry:function(){return this.geometryNode},setTransparent:function(e){this.transparent=e},isTransparent:function(){return this.transparent},set_bbox__:function(){this.bboxSize_.getValue().equals(this.defaultBBoxSize)?this.getGeometry()?this.bbox.assign(this.getGeometry().getBBox()):this.bbox.set():this.bbox.set(this.bboxSize_.getValue(),this.bboxCenter_.getValue()),this.bboxSize.assign(this.bbox.size),this.bboxCenter.assign(this.bbox.center)},set_apparance__:function(){this.apparanceNode&&this.apparanceNode.transparent_.removeInterest("set_transparent__",this),this.apparanceNode=i(n.X3DAppearanceNode,this.appearance_),this.apparanceNode?this.apparanceNode.transparent_.addInterest("set_transparent__",this):this.apparanceNode=this.getBrowser().getDefaultAppearance(),this.set_transparent__()},set_geometry__:function(){this.geometryNode&&(this.geometryNode.transparent_.addInterest("set_transparent__",this),this.geometryNode.bbox_changed_.addInterest("set_bbox__",this)),this.geometryNode=i(n.X3DGeometryNode,this.geometry_),this.geometryNode&&(this.geometryNode.transparent_.addInterest("set_transparent__",this),this.geometryNode.bbox_changed_.addInterest("set_bbox__",this)),this.set_transparent__(),this.set_bbox__()},set_transparent__:function(){this.transparent=this.apparanceNode&&this.apparanceNode.transparent_.getValue()||this.geometryNode&&this.geometryNode.transparent_.getValue()}}),o}),define("standard/Math/Utility/BVH",["standard/Math/Numbers/Vector3","standard/Math/Geometry/Plane3","standard/Math/Algorithms/QuickSort"],function(e,t,i){"use strict";function n(e,t){function i(e,n){var r=i.vertices;return t=i.axis,Math.min(r[e+t],r[e+4+t],r[e+8+t])<Math.min(r[n+t],r[n+4+t],r[n+8+t])}return i.vertices=e,i.axis=t,i}function r(e,t){this.vertices=e.vertices,this.normals=e.normals,this.i4=12*t,this.i3=9*t}function s(i,n,o,h){this.min=new e(0,0,0),this.max=new e(0,0,0),this.planes=[],this.intersection=new e(0,0,0);var d=i.vertices,p=this.min,f=this.max,g=o+h,m=12*n[o];p.set(d[m],d[m+1],d[m+2]),f.assign(p);for(var _=o;_<g;++_)m=12*n[_],a.set(d[m],d[m+1],d[m+2]),u.set(d[m+4],d[m+5],d[m+6]),l.set(d[m+8],d[m+9],d[m+10]),p.min(a,u,l),f.max(a,u,l);for(var _=0;_<5;++_)this.planes[_]=new t(_%2?p:f,c[_]);if(h>2){i.sorter.compare.axis=this.getLongestAxis(p,f),i.sorter.sort(o,g);var x=h>>>1}else var x=1;var y=h-x;this.left=x>1?new s(i,n,o,x):new r(i,n[o]),this.right=y>1?new s(i,n,o+x,y):new r(i,n[o+x])}function o(e,t){this.vertices=e,this.normals=t;var o=e.length/12;switch(o){case 0:this.root=null;break;case 1:this.root=new r(this,0);break;default:for(var a=[],u=0;u<o;++u)a.push(u);this.sorter=new i(a,n(e,0)),this.root=new s(this,a,0,o)}}var a=new e(0,0,0),u=new e(0,0,0),l=new e(0,0,0),h={u:0,v:0,t:0},c=[new e(0,0,1),new e(0,0,-1),new e(0,1,0),new e(0,-1,0),new e(1,0,0)];return r.prototype={intersectsLine:function(t,i,n){var r=this.vertices,s=this.normals,o=this.i4,c=this.i3;if(a.x=r[o],a.y=r[o+1],a.z=r[o+2],u.x=r[o+4],u.y=r[o+5],u.z=r[o+6],l.x=r[o+8],l.y=r[o+9],l.z=r[o+10],t.intersectsTriangle(a,u,l,h)){var d=h.u,p=h.v,f=1-d-p,g=i.size++;g>=i.length&&i.push(new e(0,0,0)),i[g].set(f*r[o]+d*r[o+4]+p*r[o+8],f*r[o+1]+d*r[o+5]+p*r[o+9],f*r[o+2]+d*r[o+6]+p*r[o+10]),n&&(g>=n.length&&n.push(new e(0,0,0)),n[g].set(f*s[c]+d*s[c+3]+p*s[c+6],f*s[c+1]+d*s[c+4]+p*s[c+7],f*s[c+2]+d*s[c+5]+p*s[c+8]))}}},s.prototype={intersectsLine:function(e,t,i){this.intersectsBBox(e)&&(this.left.intersectsLine(e,t,i),this.right.intersectsLine(e,t,i))},intersectsBBox:function(e){var t=this.planes,i=this.min,n=this.max,r=i.x,s=n.x,o=i.y,a=n.y,u=i.z,l=n.z,h=this.intersection;return!!(t[0].intersectsLine(e,h)&&h.x>=r&&h.x<=s&&h.y>=o&&h.y<=a)||(!!(t[1].intersectsLine(e,h)&&h.x>=r&&h.x<=s&&h.y>=o&&h.y<=a)||(!!(t[2].intersectsLine(e,h)&&h.x>=r&&h.x<=s&&h.z>=u&&h.z<=l)||(!!(t[3].intersectsLine(e,h)&&h.x>=r&&h.x<=s&&h.z>=u&&h.z<=l)||!!(t[4].intersectsLine(e,h)&&h.y>=o&&h.y<=a&&h.z>=u&&h.z<=l))))},getLongestAxis:function(e,t){var i=t.x-e.x,n=t.y-e.y,r=t.z-e.z;return i<n?n<r?2:1:i<r?2:0}},o.prototype={constructor:o,intersectsLine:function(e,t,i){return t.size=0,this.root?(this.root.intersectsLine(e,t,i),t.size):0}},o}),define("x_ite/Components/ParticleSystems/ParticleSystem",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shape/X3DShapeNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","x_ite/Bits/X3DCast","standard/Math/Numbers/Color4","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4","standard/Math/Numbers/Matrix3","standard/Math/Algorithms/QuickSort","standard/Math/Algorithm","standard/Math/Utility/BVH"],function(e,t,i,n,r,s,o,a,u,l,h,c,d,p,f){"use strict";function g(e,t){return e.distance<t.distance}function m(e){n.call(this,e),this.addType(s.ParticleSystem),this.particleSize_.setUnit("length"),this.createParticles=!0,this.particles=[],this.velocities=[],this.speeds=[],this.turbulences=[],this.geometryType=x,this.maxParticles=0,this.numParticles=0,this.particleLifetime=0,this.lifetimeVariation=0,this.emitterNode=null,this.forcePhysicsModelNodes=[],this.boundedPhysicsModelNodes=[],this.boundedNormals=[],this.boundedVertices=[],this.boundedVolume=null,this.creationTime=0,this.pauseTime=0,this.deltaTime=0,this.numForces=0,this.colorKeys=[],this.colorRamppNode=null,this.colorRamp=[],this.colorMaterial=!1,this.texCoordKeys=[],this.texCoordRampNode=null,this.texCoordRamp=[],this.texCoordAnim=!1,this.vertexCount=0,this.shaderNode=this.getBrowser().getPointShader(),this.rotation=new c,this.particleSorter=new d(this.particles,g),this.sortParticles=!1}var _=0,x=_++,y=_++,v=_++,w=_++,b=_++,S=_++,C={POINT:x,LINE:y,TRIANGLE:v,QUAD:w,GEOMETRY:b,SPRITE:S},T=new h,F=new u(0,0,0),O=new u(0,0,0),N=new u(0,0,0),M=new u(0,0,0),D=new u(0,0,0),E=new u(0,0,0),V=new u(0,0,0),B=new u(0,0,0),I=new u(0,0,0),A=new u(0,0,0);return m.prototype=Object.assign(Object.create(n.prototype),{constructor:m,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"enabled",new e.SFBool(!0)),new t(s.inputOutput,"createParticles",new e.SFBool(!0)),new t(s.initializeOnly,"geometryType",new e.SFString("QUAD")),new t(s.inputOutput,"maxParticles",new e.SFInt32(200)),new t(s.inputOutput,"particleLifetime",new e.SFFloat(5)),new t(s.inputOutput,"lifetimeVariation",new e.SFFloat(.25)),new t(s.inputOutput,"particleSize",new e.SFVec2f(.02,.02)),new t(s.initializeOnly,"emitter",new e.SFNode),new t(s.initializeOnly,"physics",new e.MFNode),new t(s.initializeOnly,"colorKey",new e.MFFloat),new t(s.initializeOnly,"colorRamp",new e.SFNode),new t(s.initializeOnly,"texCoordKey",new e.MFFloat),new t(s.initializeOnly,"texCoordRamp",new e.SFNode),new t(s.outputOnly,"isActive",new e.SFBool),new t(s.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(s.initializeOnly,"bboxCenter",new e.SFVec3f),new t(s.inputOutput,"appearance",new e.SFNode),new t(s.inputOutput,"geometry",new e.SFNode)]),getTypeName:function(){return"ParticleSystem"},getComponentName:function(){return"ParticleSystems"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this);var e=this.getBrowser().getContext();this.isLive().addInterest("set_live__",this),this.getBrowser().getBrowserOptions().Shading_.addInterest("set_shader__",this),this.enabled_.addInterest("set_enabled__",this),this.createParticles_.addInterest("set_createParticles__",this),this.geometryType_.addInterest("set_geometryType__",this),this.maxParticles_.addInterest("set_enabled__",this),this.particleLifetime_.addInterest("set_particleLifetime__",this),this.lifetimeVariation_.addInterest("set_lifetimeVariation__",this),this.emitter_.addInterest("set_emitter__",this),this.physics_.addInterest("set_physics__",this),this.colorKey_.addInterest("set_color__",this),this.colorRamp_.addInterest("set_colorRamp__",this),this.texCoordKey_.addInterest("set_texCoord__",this),this.texCoordRamp_.addInterest("set_texCoordRamp__",this),this.idBuffer=e.createBuffer(),this.positionBuffer=e.createBuffer(),this.elapsedTimeBuffer=e.createBuffer(),this.lifeBuffer=e.createBuffer(),this.colorBuffer=e.createBuffer(),this.texCoordBuffers=[e.createBuffer()],this.normalBuffer=e.createBuffer(),this.vertexBuffer=e.createBuffer(),this.idArray=new Float32Array,this.positionArray=new Float32Array,this.elapsedTimeArray=new Float32Array,this.lifeArray=new Float32Array,this.colorArray=new Float32Array,this.texCoordArray=new Float32Array,this.normalArray=new Float32Array,this.vertexArray=new Float32Array,this.primitiveMode=e.TRIANGLES,this.set_emitter__(),this.set_enabled__(),this.set_createParticles__(),this.set_particleLifetime__(),this.set_lifetimeVariation__(),this.set_physics__(),this.set_colorRamp__(),this.set_texCoordRamp__()},set_bbox__:function(){this.bboxSize_.getValue().equals(this.defaultBBoxSize)?this.bbox.set():this.bbox.set(this.bboxSize_.getValue(),this.bboxCenter_.getValue()),this.bboxSize=this.bbox.size,this.bboxCenter=this.bbox.center},set_transparent__:function(){switch(this.geometryType){case x:this.setTransparent(!0);break;default:this.setTransparent(this.getAppearance()&&this.getAppearance().transparent_.getValue()||this.colorRampNode&&this.colorRampNode.isTransparent()||this.geometryType===b&&this.geometryNode&&this.geometryNode.transparent_.getValue())}},set_live__:function(){this.isLive().getValue()?this.isActive_.getValue()&&this.maxParticles_.getValue()&&(this.getBrowser().sensorEvents().addInterest("animateParticles",this),this.pauseTime&&(this.creationTime+=performance.now()/1e3-this.pauseTime,this.pauseTime=0)):this.isActive_.getValue()&&this.maxParticles_.getValue()&&(this.getBrowser().sensorEvents().removeInterest("animateParticles",this),0===this.pauseTime&&(this.pauseTime=performance.now()/1e3))},set_enabled__:function(){
this.enabled_.getValue()&&this.maxParticles_.getValue()?this.isActive_.getValue()||(this.isLive().getValue()?(this.getBrowser().sensorEvents().addInterest("animateParticles",this),this.pauseTime=0):this.pauseTime=performance.now()/1e3,this.isActive_=!0):this.isActive_.getValue()&&(this.isLive().getValue()&&this.getBrowser().sensorEvents().removeInterest("animateParticles",this),this.isActive_=!1,this.numParticles=0),this.set_maxParticles__()},set_createParticles__:function(){this.createParticles=this.createParticles_.getValue()},set_geometryType__:function(){var e=this.getBrowser().getContext(),t=this.maxParticles;switch(this.geometryType=C[this.geometryType_.getValue()],this.geometryType||(this.geometryType=x),this.geometryType){case x:this.idArray=new Float32Array(t),this.positionArray=new Float32Array(3*t),this.elapsedTimeArray=new Float32Array(t),this.lifeArray=new Float32Array(t),this.colorArray=new Float32Array(4*t),this.texCoordArray=new Float32Array,this.normalArray=new Float32Array,this.vertexArray=new Float32Array(4*t);for(var i=0,n=this.idArray,r=n.length;i<r;++i)n[i]=i;this.colorArray.fill(1),this.vertexArray.fill(1),this.primitiveMode=e.POINTS,this.texCoordCount=0,this.vertexCount=1;break;case y:this.idArray=new Float32Array(2*t),this.positionArray=new Float32Array(6*t),this.elapsedTimeArray=new Float32Array(2*t),this.lifeArray=new Float32Array(2*t),this.colorArray=new Float32Array(8*t),this.texCoordArray=new Float32Array,this.normalArray=new Float32Array,this.vertexArray=new Float32Array(8*t);for(var i=0,n=this.idArray,r=n.length;i<r;++i)n[i]=Math.floor(i/2);this.colorArray.fill(1),this.vertexArray.fill(1),this.primitiveMode=e.LINES,this.texCoordCount=2,this.vertexCount=2;break;case v:case w:case S:this.idArray=new Float32Array(6*t),this.positionArray=new Float32Array(18*t),this.elapsedTimeArray=new Float32Array(6*t),this.lifeArray=new Float32Array(6*t),this.colorArray=new Float32Array(24*t),this.texCoordArray=new Float32Array(24*t),this.normalArray=new Float32Array(18*t),this.vertexArray=new Float32Array(24*t);for(var i=0,n=this.idArray,r=n.length;i<r;++i)n[i]=Math.floor(i/6);this.colorArray.fill(1),this.vertexArray.fill(1);for(var s=this.texCoordArray,o=this.normalArray,i=0,a=18*t;i<a;i+=3)o[i]=0,o[i+1]=0,o[i+2]=1;e.bindBuffer(e.ARRAY_BUFFER,this.normalBuffer),e.bufferData(e.ARRAY_BUFFER,this.normalArray,e.STATIC_DRAW);for(var i=0;i<t;++i){var u=24*i;s[u]=s[u+12]=0,s[u+1]=s[u+13]=0,s[u+2]=s[u+14]=0,s[u+3]=s[u+15]=1,s[u+4]=1,s[u+5]=0,s[u+6]=0,s[u+7]=1,s[u+8]=s[u+16]=1,s[u+9]=s[u+17]=1,s[u+10]=s[u+18]=0,s[u+11]=s[u+19]=1,s[u+20]=0,s[u+21]=1,s[u+22]=0,s[u+23]=1}e.bindBuffer(e.ARRAY_BUFFER,this.texCoordBuffers[0]),e.bufferData(e.ARRAY_BUFFER,this.texCoordArray,e.STATIC_DRAW),this.primitiveMode=e.TRIANGLES,this.texCoordCount=4,this.vertexCount=6;break;case b:this.texCoordCount=0,this.vertexCount=0}e.bindBuffer(e.ARRAY_BUFFER,this.idBuffer),e.bufferData(e.ARRAY_BUFFER,this.idArray,e.STATIC_DRAW),this.set_shader__(),this.set_transparent__()},set_shader__:function(){switch(this.geometryType){case x:this.shaderGeometryType=0,this.shaderNode=this.getBrowser().getPointShader();break;case y:this.shaderGeometryType=1,this.shaderNode=this.getBrowser().getLineShader();break;case v:case w:case S:this.shaderGeometryType=3,this.shaderNode=this.getBrowser().getDefaultShader();break;case b:this.shaderGeometryType=3,this.shaderNode=this.getBrowser().getDefaultShader()}},set_maxParticles__:function(){for(var e=this.particles,t=Math.max(0,this.maxParticles_.getValue()),i=this.numParticles,n=Math.min(e.length,t);i<n;++i)e[i].life=1,e[i].lifetime=-1;for(var i=e.length,n=t;i<n;++i)e[i]={life:1,lifetime:-1,elapsedTime:0,position:new u(0,0,0),velocity:new u(0,0,0),color:new l(1,1,1,1),distance:0};this.maxParticles=t,this.numParticles=Math.min(this.numParticles,t),this.emitterNode.isExplosive()||(this.creationTime=performance.now()/1e3),this.set_geometryType__()},set_particleLifetime__:function(){this.particleLifetime=this.particleLifetime_.getValue()},set_lifetimeVariation__:function(){this.lifetimeVariation=this.lifetimeVariation_.getValue()},set_emitter__:function(){this.emitterNode=o(s.X3DParticleEmitterNode,this.emitter_),this.emitterNode||(this.emitterNode=this.getBrowser().getDefaultEmitter()),this.createParticles=this.createParticles_.getValue()},set_physics__:function(){for(var e=this.physics_.getValue(),t=this.forcePhysicsModelNodes,i=this.boundedPhysicsModelNodes,n=0,r=i.length;n<r;++n)i[n].removeInterest("set_boundedPhysics__",this);t.length=0,i.length=0;for(var n=0,r=e.length;n<r;++n)try{for(var o=e[n].getValue().getInnerNode(),a=o.getType(),u=a.length-1;u>=0;--u){switch(a[u]){case s.ForcePhysicsModel:case s.WindPhysicsModel:t.push(o);break;case s.BoundedPhysicsModel:o.addInterest("set_boundedPhysics__",this),i.push(o);break;default:continue}break}}catch(e){}this.set_boundedPhysics__()},set_boundedPhysics__:function(){var e=this.boundedPhysicsModelNodes,t=this.boundedNormals,i=this.boundedVertices;t.length=0,i.length=0;for(var n=0,r=e.length;n<r;++n)e[n].addGeometry(t,i);this.boundedVolume=new f(i,t)},set_colorRamp__:function(){this.colorRampNode&&this.colorRampNode.removeInterest("set_color__",this),this.colorRampNode=o(s.X3DColorNode,this.colorRamp_),this.colorRampNode&&this.colorRampNode.addInterest("set_color__",this),this.set_color__(),this.set_transparent__()},set_color__:function(){for(var e=this.colorKey_,t=this.colorKeys,i=this.colorRamp,n=0,r=e.length;n<r;++n)t[n]=e[n];t.length=r,this.colorRampNode&&this.colorRampNode.getVectors(this.colorRamp);for(var n=i.length,r=e.length;n<r;++n)i[n]=new l(1,1,1,1);i.length=r,this.colorMaterial=Boolean(t.length&&this.colorRampNode)},set_texCoordRamp__:function(){this.texCoordRampNode&&this.texCoordRampNode.removeInterest("set_texCoord__",this),this.texCoordRampNode=o(s.X3DTextureCoordinateNode,this.texCoordRamp_),this.texCoordRampNode&&this.texCoordRampNode.addInterest("set_texCoord__",this),this.set_texCoord__()},set_texCoord__:function(){for(var e=this.texCoordKey_,t=this.texCoordKeys,i=this.texCoordRamp,n=0,r=e.length;n<r;++n)t[n]=e[n];t.length=r,this.texCoordRampNode&&this.texCoordRampNode.getTexCoord(i);for(var n=i.length,r=e.length*this.texCoordCount;n<r;++n)i[n]=new l(0,0,0,0);i.length=r,this.texCoordAnim=Boolean(t.length&&this.texCoordRampNode)},intersectsBox:function(e,t){},animateParticles:function(){var e=this.emitterNode,t=1/Math.max(10,this.getBrowser().getCurrentFrameRate()),i=this.deltaTime=(14*this.deltaTime+t)/15;if(e.isExplosive()){var n=performance.now()/1e3,r=this.particleLifetime+this.particleLifetime*this.lifetimeVariation;0===this.numParticles||n-this.creationTime>r?(this.creationTime=n,this.numParticles=this.maxParticles,this.createParticles=this.createParticles_.getValue(),i=Number.POSITIVE_INFINITY):this.createParticles=!1}else if(this.numParticles<this.maxParticles){var n=performance.now()/1e3,s=Math.max(0,Math.floor((n-this.creationTime)*this.maxParticles/this.particleLifetime));s&&(this.creationTime=n),this.numParticles=Math.floor(Math.min(this.maxParticles,this.numParticles+s))}if(e.getMass()){for(var o=this.forcePhysicsModelNodes,a=this.velocities,l=this.speeds,h=this.turbulences,c=this.deltaTime/e.getMass(),d=a.length,p=o.length;d<p;++d)a[d]=new u(0,0,0);for(var d=0,p=o.length;d<p;++d)o[d].addForce(d,e,a,h);for(var d=0,p=a.length;d<p;++d)a[d].multiply(c),l[d]=a[d].abs();this.numForces=p}else this.numForces=0;e.animate(this,i),this.updateGeometry(null),this.getBrowser().addBrowserEvent()},updateGeometry:function(e){switch(this.geometryType){case x:e||this.updatePoint();break;case y:e||this.updateLine();break;case v:case w:case S:this.updateQuad(e);break;case b:}},updatePoint:function(){var e=this.getBrowser().getContext(),t=this.particles,i=this.numParticles,n=this.positionArray,r=this.elapsedTimeArray,s=this.lifeArray,o=this.colorArray,a=this.vertexArray;if(this.colorMaterial){for(var u=0;u<i;++u){var l=t[u].color,h=4*u;o[h]=l.x,o[h+1]=l.y,o[h+2]=l.z,o[h+3]=l.w}e.bindBuffer(e.ARRAY_BUFFER,this.colorBuffer),e.bufferData(e.ARRAY_BUFFER,this.colorArray,e.STATIC_DRAW)}for(var u=0;u<i;++u){var c=t[u].position,d=t[u].elapsedTime/t[u].lifetime,p=3*u,h=4*u;n[p]=c.x,n[p+1]=c.y,n[p+2]=c.z,r[u]=d,s[u]=t[u].life,a[h]=c.x,a[h+1]=c.y,a[h+2]=c.z}e.bindBuffer(e.ARRAY_BUFFER,this.positionBuffer),e.bufferData(e.ARRAY_BUFFER,this.positionArray,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.elapsedTimeBuffer),e.bufferData(e.ARRAY_BUFFER,this.elapsedTimeArray,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.lifeBuffer),e.bufferData(e.ARRAY_BUFFER,this.lifeArray,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertexArray,e.STATIC_DRAW)},updateLine:function(){var e=this.getBrowser().getContext(),t=this.particles,i=this.numParticles,n=this.positionArray,r=this.elapsedTimeArray,s=this.lifeArray,o=this.colorArray,a=this.vertexArray,u=this.particleSize_.y/2;if(this.colorMaterial){for(var l=0;l<i;++l){var h=t[l].color,c=8*l;o[c]=h.x,o[c+1]=h.y,o[c+2]=h.z,o[c+3]=h.w,o[c+4]=h.x,o[c+5]=h.y,o[c+6]=h.z,o[c+7]=h.w}e.bindBuffer(e.ARRAY_BUFFER,this.colorBuffer),e.bufferData(e.ARRAY_BUFFER,this.colorArray,e.STATIC_DRAW)}for(var l=0;l<i;++l){var d=t[l],p=d.position,f=t[l].elapsedTime/t[l].lifetime,g=t[l].life,m=p.x,_=p.y,x=p.z,y=2*l,v=6*l,c=8*l;n[v]=m,n[v+1]=_,n[v+2]=x,n[v+3]=m,n[v+4]=_,n[v+5]=x,r[y]=f,r[y+1]=f,s[y]=g,s[y+1]=g,M.assign(d.velocity).normalize().multiply(u),a[c]=m-M.x,a[c+1]=_-M.y,a[c+2]=x-M.z,a[c+4]=m+M.x,a[c+5]=_+M.y,a[c+6]=x+M.z}e.bindBuffer(e.ARRAY_BUFFER,this.positionBuffer),e.bufferData(e.ARRAY_BUFFER,this.positionArray,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.elapsedTimeBuffer),e.bufferData(e.ARRAY_BUFFER,this.elapsedTimeArray,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.lifeBuffer),e.bufferData(e.ARRAY_BUFFER,this.lifeArray,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertexArray,e.STATIC_DRAW)},updateQuad:function(e){try{var t=this.getBrowser().getContext(),i=this.particles,n=this.maxParticles,r=this.numParticles,s=this.positionArray,o=this.elapsedTimeArray,a=this.lifeArray,u=this.colorArray,l=this.texCoordArray,h=this.normalArray,c=this.vertexArray,d=this.particleSize_.x/2,f=this.particleSize_.y/2;if(!e){if(this.colorMaterial){for(var g=0;g<n;++g){var m=i[g].color,_=24*g;u[_]=u[_+4]=u[_+8]=u[_+12]=u[_+16]=u[_+20]=m.x,u[_+1]=u[_+5]=u[_+9]=u[_+13]=u[_+17]=u[_+21]=m.y,u[_+2]=u[_+6]=u[_+10]=u[_+14]=u[_+18]=u[_+22]=m.z,u[_+3]=u[_+7]=u[_+11]=u[_+15]=u[_+19]=u[_+23]=m.w}t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,this.colorArray,t.STATIC_DRAW)}if(this.texCoordAnim&&this.texCoordArray.length){for(var x=this.texCoordKeys,y=this.texCoordRamp,v=x.length,w=0,g=0;g<n;++g){var b=i[g],C=b.elapsedTime/b.lifetime;if(1==v||C<=x[0])w=0;else if(C>=x[v-1])w=v-2;else{var T=p.upperBound(x,0,v,C,p.less);w=T<v?T-1:0}w*=this.texCoordCount;var F=y[w],O=y[w+1],I=y[w+2],A=y[w+3],_=24*g;l[_]=l[_+12]=F.x,l[_+1]=l[_+13]=F.y,l[_+2]=l[_+14]=F.z,l[_+3]=l[_+15]=F.w,l[_+4]=O.x,l[_+5]=O.y,l[_+6]=O.z,l[_+7]=O.w,l[_+8]=l[_+16]=I.x,l[_+9]=l[_+17]=I.y,l[_+10]=l[_+18]=I.z,l[_+11]=l[_+19]=I.w,l[_+20]=A.x,l[_+21]=A.y,l[_+22]=A.z,l[_+23]=A.w}t.bindBuffer(t.ARRAY_BUFFER,this.texCoordBuffers[0]),t.bufferData(t.ARRAY_BUFFER,this.texCoordArray,t.STATIC_DRAW)}}if(this.geometryType===S){if(e){var P=this.getScreenAlignedRotation(e);M.set(P[0],P[1],P[2]).cross(N.set(P[3],P[4],P[5])).normalize();for(var R=M.x,L=M.y,z=M.z,g=0,v=18*n;g<v;g+=3)h[g]=R,h[g+1]=L,h[g+2]=z;t.bindBuffer(t.ARRAY_BUFFER,this.normalBuffer),t.bufferData(t.ARRAY_BUFFER,this.normalArray,t.STATIC_DRAW),D.set(-d,-f,0),E.set(d,-f,0),V.set(d,f,0),B.set(-d,f,0),P.multVecMatrix(D),P.multVecMatrix(E),P.multVecMatrix(V),P.multVecMatrix(B);for(var g=0;g<r;++g){var k=i[g].position,X=i[g].elapsedTime/i[g].lifetime,U=k.x,j=k.y,G=k.z,q=6*g,H=18*g,_=24*g;s[H]=s[H+3]=s[H+6]=s[H+9]=s[H+12]=s[H+15]=U,s[H+1]=s[H+4]=s[H+7]=s[H+10]=s[H+13]=s[H+16]=j,s[H+2]=s[H+5]=s[H+8]=s[H+11]=s[H+14]=s[H+17]=G,o[q]=o[q+1]=o[q+2]=o[q+3]=o[q+4]=o[q+5]=X,a[q]=a[q+1]=a[q+2]=a[q+3]=a[q+4]=a[q+5]=i[g].life,c[_]=c[_+12]=U+D.x,c[_+1]=c[_+13]=j+D.y,c[_+2]=c[_+14]=G+D.z,c[_+4]=U+E.x,c[_+5]=j+E.y,c[_+6]=G+E.z,c[_+8]=c[_+16]=U+V.x,c[_+9]=c[_+17]=j+V.y,c[_+10]=c[_+18]=G+V.z,c[_+20]=U+B.x,c[_+21]=j+B.y,c[_+22]=G+B.z}t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer),t.bufferData(t.ARRAY_BUFFER,this.positionArray,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.elapsedTimeBuffer),t.bufferData(t.ARRAY_BUFFER,this.elapsedTimeArray,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.lifeBuffer),t.bufferData(t.ARRAY_BUFFER,this.lifeArray,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertexArray,t.STATIC_DRAW)}}else if(!e){for(var g=0;g<r;++g){var k=i[g].position,X=i[g].elapsedTime/i[g].lifetime,U=k.x,j=k.y,G=k.z,q=6*g,H=18*g,_=24*g;s[H]=s[H+3]=s[H+6]=s[H+9]=s[H+12]=s[H+15]=U,s[H+1]=s[H+4]=s[H+7]=s[H+10]=s[H+13]=s[H+16]=j,s[H+2]=s[H+5]=s[H+8]=s[H+11]=s[H+14]=s[H+17]=G,o[q]=o[q+1]=o[q+2]=o[q+3]=o[q+4]=o[q+5]=X,a[q]=a[q+1]=a[q+2]=a[q+3]=a[q+4]=a[q+5]=i[g].life,c[_]=c[_+12]=U-d,c[_+1]=c[_+13]=j-f,c[_+2]=c[_+14]=G,c[_+4]=U+d,c[_+5]=j-f,c[_+6]=G,c[_+8]=c[_+16]=U+d,c[_+9]=c[_+17]=j+f,c[_+10]=c[_+18]=G,c[_+20]=U-d,c[_+21]=j+f,c[_+22]=G}t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer),t.bufferData(t.ARRAY_BUFFER,this.positionArray,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.elapsedTimeBuffer),t.bufferData(t.ARRAY_BUFFER,this.elapsedTimeArray,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.lifeBuffer),t.bufferData(t.ARRAY_BUFFER,this.lifeArray,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertexArray,t.STATIC_DRAW)}}catch(e){console.log(e)}},traverse:function(e,t){if(this.isActive_.getValue()){switch(e){case r.POINTER:break;case r.COLLISION:break;case r.DEPTH:t.addDepthShape(this);break;case r.DISPLAY:t.addDisplayShape(this)&&this.getAppearance().traverse(e,t)}this.geometryType===b&&this.getGeometry()&&this.getGeometry().traverse(e,t)}},depth:function(e,t,i){if(this.updateGeometry(t.modelViewMatrix),this.geometryType===b){var n=this.getGeometry();n&&n.displayParticlesDepth(e,t,i,this.particles,this.numParticles)}else{if(this.numParticles<=0)return;i.enableFloatAttrib(e,"x3d_ParticleId",this.idBuffer,1),i.enableFloatAttrib(e,"x3d_ParticlePosition",this.positionBuffer,3),i.enableFloatAttrib(e,"x3d_ParticleElapsedTime",this.elapsedTimeBuffer,1),i.enableFloatAttrib(e,"x3d_ParticleLife",this.lifeBuffer,1),i.enableVertexAttribute(e,this.vertexBuffer),e.drawArrays(this.primitiveMode,0,this.numParticles*this.vertexCount),i.disableFloatAttrib(e,"x3d_ParticleId"),i.disableFloatAttrib(e,"x3d_ParticlePosition"),i.disableFloatAttrib(e,"x3d_ParticleElapsedTime"),i.disableFloatAttrib(e,"x3d_ParticleLife")}},display:function(e,t){try{if(this.numParticles<=0)return;if(this.getAppearance().enable(e,t),this.updateGeometry(t.modelViewMatrix),this.geometryType===b){var i=this.getGeometry();i&&i.displayParticles(e,t,this.particles,this.numParticles)}else{var n=t.renderer.getBrowser(),r=t.shaderNode;r===n.getDefaultShader()&&(r=this.shaderNode),t.geometryType=this.shaderGeometryType,t.colorMaterial=this.colorMaterial,r.enable(e),r.setLocalUniforms(e,t),r.enableFloatAttrib(e,"x3d_ParticleId",this.idBuffer,1),r.enableFloatAttrib(e,"x3d_ParticlePosition",this.positionBuffer,3),r.enableFloatAttrib(e,"x3d_ParticleElapsedTime",this.elapsedTimeBuffer,1),r.enableFloatAttrib(e,"x3d_ParticleLife",this.lifeBuffer,1),this.colorMaterial&&r.enableColorAttribute(e,this.colorBuffer),this.texCoordArray.length&&r.enableTexCoordAttribute(e,this.texCoordBuffers),this.normalArray.length&&r.enableNormalAttribute(e,this.normalBuffer),r.enableVertexAttribute(e,this.vertexBuffer);var s=!1;switch(this.geometryType){case x:case y:break;case v:case w:case S:s=!0;break;case b:}if(r.wireframe&&s)for(var o=0,a=this.numParticles*this.vertexCount;o<a;o+=3)e.drawArrays(r.primitiveMode,o,3);else{var u=h.prototype.determinant3.call(t.modelViewMatrix)>0;e.frontFace(u?e.CCW:e.CW),e.enable(e.CULL_FACE),e.cullFace(e.BACK),e.drawArrays(this.primitiveMode,0,this.numParticles*this.vertexCount)}r.disableFloatAttrib(e,"x3d_ParticleId"),r.disableFloatAttrib(e,"x3d_ParticlePosition"),r.disableFloatAttrib(e,"x3d_ParticleElapsedTime"),r.disableFloatAttrib(e,"x3d_ParticleLife"),r.disableColorAttribute(e),r.disableTexCoordAttribute(e),r.disableNormalAttribute(e),r.disable(e)}this.getAppearance().disable(e,t)}catch(e){console.log(e)}},getScreenAlignedRotation:function(e){T.assign(e).inverse(),T.multDirMatrix(F.assign(u.zAxis)),T.multDirMatrix(O.assign(u.yAxis)),I.assign(O).cross(F),A.assign(F).cross(I);var t=F;return I.normalize(),A.normalize(),t.normalize(),this.rotation.set(I.x,I.y,I.z,A.x,A.y,A.z,t.x,t.y,t.z)}}),m}),define("x_ite/Components/Texturing/PixelTexture",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Texturing/X3DTexture2DNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix3"],function(e,t,i,n,r,s,o){"use strict";function a(e){r.call(this,e),this.addType(s.PixelTexture),this.addChildObjects("loadState",new t.SFInt32(s.NOT_STARTED_STATE))}return a.prototype=Object.assign(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new i(s.inputOutput,"metadata",new t.SFNode),new i(s.inputOutput,"image",new t.SFImage(0,0,0,new t.MFInt32)),new i(s.initializeOnly,"repeatS",new t.SFBool(!0)),new i(s.initializeOnly,"repeatT",new t.SFBool(!0)),new i(s.initializeOnly,"textureProperties",new t.SFNode)]),getTypeName:function(){return"PixelTexture"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texture"},initialize:function(){r.prototype.initialize.call(this),this.image_.addInterest("set_image__",this),this.set_image__()},checkLoadState:function(){return this.loadState_.getValue()},convert:function(e,t,i,n){switch(t){case 1:for(var r=0,s=0;r<n;++r,s+=4){var o=i[r];e[s]=e[s+1]=e[s+2]=255&o,e[s+3]=255}break;case 2:for(var r=0,s=0;r<n;++r,s+=4){var o=i[r];e[s]=e[s+1]=e[s+2]=o>>>8&255,e[s+3]=255&o}break;case 3:for(var r=0,s=0;r<n;++r,s+=4){var o=i[r];e[s]=o>>>16&255,e[s+1]=o>>>8&255,e[s+2]=255&o,e[s+3]=255}break;case 4:for(var r=0,s=0;r<n;++r,s+=4){var o=i[r];e[s]=o>>>24,e[s+1]=o>>>16&255,e[s+2]=o>>>8&255,e[s+3]=255&o}}},set_image__:function(){var t=this.image_.width,i=this.image_.height,n=this.image_.comp,r=this.image_.array,a=!(n%2),u=null;if(t>0&&i>0&&n>0&&n<5){if(o.isPowerOfTwo(t)&&o.isPowerOfTwo(i))u=new Uint8Array(t*i*4),this.convert(u,n,r.getValue(),r.length);else if(Math.max(t,i)<this.getBrowser().getMinTextureSize()&&!this.textureProperties_.getValue()){u=new Uint8Array(t*i*4),this.convert(u,n,r.getValue(),r.length);var l=t,h=i;t=4*o.nextPowerOfTwo(l),i=4*o.nextPowerOfTwo(h),u=this.resize(u,l,h,t,i)}else{var c=e("<canvas></canvas>")[0],d=e("<canvas></canvas>")[0],p=c.getContext("2d"),f=d.getContext("2d"),g=p.createImageData(t,i);c.width=t,c.height=i,this.convert(g.data,n,r,r.length),p.putImageData(g,0,0),t=o.nextPowerOfTwo(t),i=o.nextPowerOfTwo(i),d.width=t,d.height=i,f.drawImage(c,0,0,c.width,c.height,0,0,t,i),u=f.getImageData(0,0,t,i).data}this.setTexture(t,i,a,new Uint8Array(u),!1),this.loadState_=s.COMPLETE_STATE}else this.clearTexture(),this.loadState_=s.FAILED_STATE}}),a}),define("x_ite/Components/PointingDeviceSensor/PlaneSensor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/PointingDeviceSensor/X3DDragSensorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Line3","standard/Math/Geometry/Plane3","standard/Math/Geometry/ViewVolume","standard/Math/Algorithm"],function(e,t,i,n,r,s,o,a,u,l,h,c,d){"use strict";function p(e){n.call(this,e),this.addType(r.PlaneSensor),this.offset_.setUnit("length"),this.minPosition_.setUnit("length"),this.maxPosition_.setUnit("length"),this.translation_changed_.setUnit("length")}var f=new l(o.Zero,o.Zero),g=new o(0,0,0),m=new l(o.Zero,o.Zero);return p.prototype=Object.assign(Object.create(n.prototype),{constructor:p,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"enabled",new e.SFBool(!0)),new t(r.inputOutput,"description",new e.SFString),new t(r.inputOutput,"axisRotation",new e.SFRotation),new t(r.inputOutput,"autoOffset",new e.SFBool(!0)),new t(r.inputOutput,"offset",new e.SFVec3f),new t(r.inputOutput,"minPosition",new e.SFVec2f),new t(r.inputOutput,"maxPosition",new e.SFVec2f(-1,-1)),new t(r.outputOnly,"trackPoint_changed",new e.SFVec3f),new t(r.outputOnly,"translation_changed",new e.SFVec3f),new t(r.outputOnly,"isOver",new e.SFBool),new t(r.outputOnly,"isActive",new e.SFBool)]),getTypeName:function(){return"PlaneSensor"},getComponentName:function(){return"PointingDeviceSensor"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.modelViewMatrix=new u,this.invModelViewMatrix=new u,this.projectionMatrix=new u,this.viewport=new a,this.planeSensor=!0,this.plane=null,this.line=null,this.startOffset=new o(0,0,0),this.startPoint=new o(0,0,0)},getLineTrackPoint:function(e,t,i){return c.projectLine(t,this.modelViewMatrix,this.projectionMatrix,this.viewport,f),f.getClosestPointToPoint(new o(e.pointer.x,e.pointer.y,0),g),c.unProjectRay(g.x,g.y,this.modelViewMatrix,this.projectionMatrix,this.viewport,m),t.getClosestPointToLine(m,i)},set_active__:function(e,t,i,r,s){n.prototype.set_active__.call(this,e,t,i,r,s);try{if(this.isActive_.getValue()){this.modelViewMatrix.assign(i),this.projectionMatrix.assign(r),this.viewport.assign(s),this.invModelViewMatrix.assign(i).inverse();var a=t.hitRay.copy().multLineMatrix(this.invModelViewMatrix),u=this.invModelViewMatrix.multVecMatrix(t.intersection.point.copy()),c=this.axisRotation_.getValue();if(this.minPosition_.x===this.maxPosition_.x){this.planeSensor=!1;var d=c.multVecRot(new o(0,Math.abs(this.maxPosition_.y-this.minPosition_.y),0));this.line=new l(u,d.normalize())}else if(this.minPosition_.y===this.maxPosition_.y){this.planeSensor=!1;var d=c.multVecRot(new o(Math.abs(this.maxPosition_.x-this.minPosition_.x),0,0));this.line=new l(u,d.normalize())}else this.planeSensor=!0,this.plane=new h(u,c.multVecRot(new o(0,0,1)));if(this.planeSensor)this.plane.intersectsLine(a,this.startPoint)&&this.trackStart(this.startPoint);else if(this.getLineTrackPoint(t,this.line,this.startPoint)){var p=new o(0,0,0);try{this.getLineTrackPoint(t,new l(this.line.direction,this.line.direction),p)}catch(e){p=this.startPoint}this.trackStart(p)}}else this.autoOffset_.getValue()&&(this.offset_=this.translation_changed_)}catch(e){console.log(e)}},trackStart:function(e){this.startOffset.assign(this.offset_.getValue()),this.trackPoint_changed_=e,this.translation_changed_=this.offset_.getValue()},set_motion__:function(e){try{if(this.planeSensor){var t=e.hitRay.copy().multLineMatrix(this.invModelViewMatrix),i=new o(0,0,0);if(!this.plane.intersectsLine(t,i))throw new Error("Plane and line are parallel.");this.track(i,i.copy())}else{var i=new o(0,0,0),n=new o(0,0,0);if(!this.getLineTrackPoint(e,this.line,i))throw new Error("Lines are parallel.");try{this.getLineTrackPoint(e,new l(o.Zero,this.line.direction),n)}catch(e){n.assign(i)}this.track(i,n)}}catch(e){this.trackPoint_changed_.addEvent(),this.translation_changed_.addEvent()}},track:function(e,t){var i=this.axisRotation_.getValue(),n=s.inverse(i).multVecRot(e.add(this.startOffset).subtract(this.startPoint));this.minPosition_.x>this.maxPosition_.x||(n.x=d.clamp(n.x,this.minPosition_.x,this.maxPosition_.x)),this.minPosition_.y>this.maxPosition_.y||(n.y=d.clamp(n.y,this.minPosition_.y,this.maxPosition_.y)),i.multVecRot(n),this.trackPoint_changed_.getValue().equals(t)||(this.trackPoint_changed_=t),this.translation_changed_.getValue().equals(n)||(this.translation_changed_=n)}}),p}),define("x_ite/Components/Lighting/PointLight",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Lighting/X3DLightNode","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Geometry/Box3","standard/Math/Geometry/Camera","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Utility/MatrixStack","standard/Math/Algorithm","standard/Utility/ObjectCache"],function(e,t,i,n,r,s,o,a,u,l,h,c,d,p,f,g,m){"use strict";function _(){this.location=new h(0,0,0),this.shadowBuffer=null,this.viewVolume=new l,this.viewport=new c(0,0,0,0),this.projectionMatrix=new p,this.modelViewMatrix=new f(p),this.modelMatrix=new p,this.invLightSpaceMatrix=new p,this.invLightSpaceProjectionMatrix=new p,this.shadowMatrix=new p,this.shadowMatrixArray=new Float32Array(16),this.invGroupMatrix=new p,this.rotation=new d,this.rotationMatrix=new p,this.textureUnit=0}function x(e){n.call(this,e),this.addType(o.PointLight),this.location_.setUnit("length"),this.radius_.setUnit("length")}var y=[(new p).setRotation(new d(new h(1,0,0),h.zAxis)),(new p).setRotation(new d(new h(-1,0,0),h.zAxis)),(new p).setRotation(new d(new h(0,0,-1),h.zAxis)),(new p).setRotation(new d(new h(0,0,1),h.zAxis)),(new p).setRotation(new d(new h(0,1,0),h.zAxis)),(new p).setRotation(new d(new h(0,-1,0),h.zAxis))],v=[new c(0,.5,.25,.5),new c(.5,.5,.25,.5),new c(.75,.5,.25,.5),new c(.25,.5,.25,.5),new c(0,0,.5,.5),new c(.5,0,.5,.5)],w=m(_);return _.prototype={constructor:_,getModelViewMatrix:function(){return this.modelViewMatrix},set:function(e,t,i,n){var r=e.getContext(),s=t.getShadowMapSize();this.browser=e,this.lightNode=t,this.groupNode=i,this.modelViewMatrix.pushMatrix(n),t.getShadowIntensity()>0&&s>0&&(this.shadowBuffer=e.popShadowBuffer(s),this.shadowBuffer?e.getCombinedTextureUnits().length?(this.textureUnit=e.getCombinedTextureUnits().pop(),r.activeTexture(r.TEXTURE0+this.textureUnit),e.getExtension("WEBGL_depth_texture")?r.bindTexture(r.TEXTURE_2D,this.shadowBuffer.getDepthTexture()):r.bindTexture(r.TEXTURE_2D,this.shadowBuffer.getColorTexture()),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.activeTexture(r.TEXTURE0)):console.warn("Not enough combined texture units for shadow map available."):console.warn("Couldn't create shadow buffer."))},renderShadowMap:function(e){try{if(!this.shadowBuffer)return;var t=this.lightNode,i=e.getCameraSpaceMatrix().get(),n=this.modelMatrix.assign(this.modelViewMatrix.get()).multRight(i),r=this.invLightSpaceMatrix.assign(t.getGlobal()?n:p.Identity);r.translate(t.getLocation()),r.inverse();var o=t.getShadowMapSize(),a=this.invGroupMatrix.assign(this.groupNode.getMatrix()).inverse();this.shadowBuffer.bind();for(var l=0;l<6;++l){var h=v[l],c=this.viewport.set(h[0]*o,h[1]*o,h[2]*o,h[3]*o),d=u.perspective2(g.radians(90),.125,1e4,c[2],c[3],this.projectionMatrix);e.getViewVolumes().push(this.viewVolume.set(d,c,c)),e.getProjectionMatrix().pushMatrix(this.projectionMatrix),e.getModelViewMatrix().pushMatrix(y[l]),e.getModelViewMatrix().multLeft(r),e.getModelViewMatrix().multLeft(a),e.render(s.DEPTH,this.groupNode),e.getModelViewMatrix().pop(),e.getProjectionMatrix().pop(),e.getViewVolumes().pop()}this.shadowBuffer.unbind(),t.getGlobal()||r.multLeft(n.inverse()),this.invLightSpaceProjectionMatrix.assign(r)}catch(e){console.log(e)}},setGlobalVariables:function(e){this.modelViewMatrix.get().multVecMatrix(this.location.assign(this.lightNode.location_.getValue())),this.shadowMatrix.assign(e.getCameraSpaceMatrix().get()).multRight(this.invLightSpaceProjectionMatrix),this.shadowMatrixArray.set(this.shadowMatrix)},setShaderUniforms:function(e,t){var i=this.lightNode,n=i.getColor(),r=i.getAttenuation(),s=this.location,o=i.getShadowColor(),a=t.numLights++;e.uniform1i(t.x3d_LightType[a],2),e.uniform3f(t.x3d_LightColor[a],n.r,n.g,n.b),e.uniform1f(t.x3d_LightIntensity[a],i.getIntensity()),e.uniform1f(t.x3d_LightAmbientIntensity[a],i.getAmbientIntensity()),e.uniform3f(t.x3d_LightAttenuation[a],Math.max(0,r.x),Math.max(0,r.y),Math.max(0,r.z)),e.uniform3f(t.x3d_LightLocation[a],s.x,s.y,s.z),e.uniform1f(t.x3d_LightRadius[a],i.getRadius()),this.textureUnit&&(e.uniform3f(t.x3d_ShadowColor[a],o.r,o.g,o.b),e.uniform1f(t.x3d_ShadowIntensity[a],i.getShadowIntensity()),e.uniform1f(t.x3d_ShadowBias[a],i.getShadowBias()),e.uniformMatrix4fv(t.x3d_ShadowMatrix[a],!1,this.shadowMatrixArray),e.uniform1i(t.x3d_ShadowMapSize[a],i.getShadowMapSize()),e.uniform1i(t.x3d_ShadowMap[a],this.textureUnit))},dispose:function(){this.textureUnit&&this.browser.getCombinedTextureUnits().push(this.textureUnit),this.browser.pushShadowBuffer(this.shadowBuffer),this.modelViewMatrix.clear(),this.browser=null,this.lightNode=null,this.groupNode=null,this.shadowBuffer=null,this.textureUnit=0,w.push(this)}},x.prototype=Object.assign(Object.create(n.prototype),{constructor:x,fieldDefinitions:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"global",new e.SFBool(!0)),new t(o.inputOutput,"on",new e.SFBool(!0)),new t(o.inputOutput,"color",new e.SFColor(1,1,1)),new t(o.inputOutput,"intensity",new e.SFFloat(1)),new t(o.inputOutput,"ambientIntensity",new e.SFFloat),new t(o.inputOutput,"attenuation",new e.SFVec3f(1,0,0)),new t(o.inputOutput,"location",new e.SFVec3f),new t(o.inputOutput,"radius",new e.SFFloat(100)),new t(o.inputOutput,"shadowColor",new e.SFColor),new t(o.inputOutput,"shadowIntensity",new e.SFFloat),new t(o.inputOutput,"shadowBias",new e.SFFloat(.005)),new t(o.initializeOnly,"shadowMapSize",new e.SFInt32(1024))]),getTypeName:function(){return"PointLight"},getComponentName:function(){return"Lighting"},getContainerField:function(){return"children"},getAttenuation:function(){return this.attenuation_.getValue()},getLocation:function(){return this.location_.getValue()},getRadius:function(){return Math.max(0,this.radius_.getValue())},getLights:function(){return w}}),x}),define("x_ite/Components/Rendering/PointSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DLineGeometryNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(s.PointSet),this.setGeometryType(0),this.colorNode=null,this.coordNode=null,this.transparent_=!0}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"attrib",new e.MFNode),new t(s.inputOutput,"fogCoord",new e.SFNode),new t(s.inputOutput,"color",new e.SFNode),new t(s.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"PointSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this.attrib_.addInterest("set_attrib__",this),this.color_.addInterest("set_color__",this),this.coord_.addInterest("set_coord__",this);var e=this.getBrowser();this.setPrimitiveMode(e.getContext().POINTS),this.setSolid(!1),this.set_attrib__(),this.set_color__(),this.set_coord__()},getShader:function(e){return e.getPointShader()},set_attrib__:function(){for(var e=this.getAttrib(),t=0,i=e.length;t<i;++t)e[t].removeInterest("addNodeEvent",this);e.length=0;for(var t=0,i=this.attrib_.length;t<i;++t){var n=r(s.X3DVertexAttributeNode,this.attrib_[t]);n&&e.push(n)}for(var t=0;t<this.attribNodes.length;++t)e[t].addInterest("addNodeEvent",this)},set_color__:function(){this.colorNode&&this.colorNode.removeInterest("addNodeEvent",this),this.colorNode=r(s.X3DColorNode,this.color_),this.colorNode&&this.colorNode.addInterest("addNodeEvent",this)},set_coord__:function(){
this.coordNode&&this.coordNode.removeInterest("addNodeEvent",this),this.coordNode=r(s.X3DCoordinateNode,this.coord_),this.coordNode&&this.coordNode.addInterest("addNodeEvent",this)},build:function(){if(this.coordNode&&!this.coordNode.isEmpty()){for(var e=this.getAttrib(),t=e.length,i=this.getAttribs(),n=this.colorNode,r=this.coordNode,s=this.getColors(),o=this.getVertices(),a=r.point_.length,u=0;u<t;++u)for(var l=0;l<a;++l)e[u].addValue(l,i[u]);n&&n.addColors(s,a),r.addPoints(o,a)}}}),o}),define("x_ite/Components/Geometry2D/Polyline2D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DLineGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.Polyline2D),this.setGeometryType(1),this.lineSegments_.setUnit("length")}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"lineSegments",new e.MFVec2f)]),getTypeName:function(){return"Polyline2D"},getComponentName:function(){return"Geometry2D"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this.setPrimitiveMode(this.getBrowser().getContext().LINE_STRIP)},build:function(){for(var e=this.lineSegments_.getValue(),t=this.getVertices(),i=0,n=2*this.lineSegments_.length;i<n;i+=2)t.push(e[i],e[i+1],0,1);this.setSolid(!1)}}),o}),define("x_ite/Components/ParticleSystems/PolylineEmitter",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/ParticleSystems/X3DParticleEmitterNode","x_ite/Components/Rendering/IndexedLineSet","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(e,t,i,n,r,s,o,a){"use strict";function u(e){n.call(this,e),this.addType(s.PolylineEmitter),this.speed_.setUnit("speed"),this.mass_.setUnit("mass"),this.surfaceArea_.setUnit("area"),this.direction=new o(0,0,0),this.polylineNode=new r(e),this.polylines=[],this.lengthSoFarArray=[0]}function l(e){return e.set(0,0,0)}var h=new o(0,0,0),c=new o(0,0,0);return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"direction",new e.SFVec3f(0,1,0)),new t(s.inputOutput,"speed",new e.SFFloat),new t(s.inputOutput,"variation",new e.SFFloat(.25)),new t(s.initializeOnly,"mass",new e.SFFloat),new t(s.initializeOnly,"surfaceArea",new e.SFFloat),new t(s.inputOutput,"coordIndex",new e.MFInt32(-1)),new t(s.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"PolylineEmitter"},getComponentName:function(){return"ParticleSystems"},getContainerField:function(){return"emitter"},initialize:function(){n.prototype.initialize.call(this),this.direction_.addInterest("set_direction__",this),this.coordIndex_.addFieldInterest(this.polylineNode.coordIndex_),this.coord_.addFieldInterest(this.polylineNode.coord_),this.polylineNode.coordIndex_=this.coordIndex_,this.polylineNode.coord_=this.coord_,this.polylineNode.addInterest("set_polyline",this),this.polylineNode.setPrivate(!0),this.polylineNode.setup(),this.set_direction__(),this.set_polyline()},set_direction__:function(){this.direction.assign(this.direction_.getValue()).normalize(),this.direction.equals(o.Zero)?this.getRandomVelocity=this.getSphericalRandomVelocity:delete this.getRandomVelocity},set_polyline:function(){var e=this.vertices=this.polylineNode.getVertices().getValue();if(e.length){delete this.getRandomPosition;var t=0,i=this.lengthSoFarArray;i.length=1;for(var n=0,r=e.length;n<r;n+=8)h.set(e[n],e[n+1],e[n+2]),c.set(e[n+4],e[n+5],e[n+6]),t+=c.subtract(h).abs(),i.push(t)}else this.getRandomPosition=l},getRandomPosition:function(e){var t=this.lengthSoFarArray,i=t.length,n=Math.random()*t[i-1],r=0,s=0,o=0;if(1==i||n<=t[0])r=0,o=0;else if(n>=t[i-1])r=i-2,o=1;else{var u=a.upperBound(t,0,i,n,a.less);if(u<i){s=u,r=u-1;var l=t[r],d=t[s];o=a.clamp((n-l)/(d-l),0,1)}else r=0,o=0}r*=8,s=r+4;var p=this.vertices;return h.set(p[r],p[r+1],p[r+2]),c.set(p[s],p[s+1],p[s+2]),e.x=h.x+o*(c.x-h.x),e.y=h.y+o*(c.y-h.y),e.z=h.z+o*(c.z-h.z),e},getRandomVelocity:function(e){var t=this.direction,i=this.getRandomSpeed();return e.x=t.x*i,e.y=t.y*i,e.z=t.z*i,e}}),u}),define("x_ite/Components/Geometry2D/Polypoint2D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DLineGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.Polypoint2D),this.setGeometryType(0),this.point_.setUnit("length"),this.transparent_=!0}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"point",new e.MFVec2f)]),getTypeName:function(){return"Polypoint2D"},getComponentName:function(){return"Geometry2D"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this);var e=this.getBrowser();this.setPrimitiveMode(e.getContext().POINTS),this.setSolid(!1)},getShader:function(e){return e.getPointShader()},build:function(){for(var e=this.point_.getValue(),t=this.getVertices(),i=0,n=2*this.point_.length;i<n;i+=2)t.push(e[i],e[i+1],0,1)}}),o}),define("x_ite/Components/Followers/PositionChaser2D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.PositionChaser2D)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_value",new e.SFVec2f),new t(r.inputOnly,"set_destination",new e.SFVec2f),new t(r.initializeOnly,"initialValue",new e.SFVec2f),new t(r.initializeOnly,"initialDestination",new e.SFVec2f),new t(r.initializeOnly,"duration",new e.SFTime(1)),new t(r.outputOnly,"isActive",new e.SFBool),new t(r.outputOnly,"value_changed",new e.SFVec2f)]),getTypeName:function(){return"PositionChaser2D"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0)}}),o}),define("x_ite/Components/Followers/PositionDamper",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.PositionDamper)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_value",new e.SFVec3f),new t(r.inputOnly,"set_destination",new e.SFVec3f),new t(r.initializeOnly,"initialValue",new e.SFVec3f),new t(r.initializeOnly,"initialDestination",new e.SFVec3f),new t(r.initializeOnly,"order",new e.SFInt32(3)),new t(r.inputOutput,"tolerance",new e.SFFloat(-1)),new t(r.inputOutput,"tau",new e.SFTime(.3)),new t(r.outputOnly,"value_changed",new e.SFVec3f),new t(r.outputOnly,"isActive",new e.SFBool)]),getTypeName:function(){return"PositionDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0,0)}}),o}),define("x_ite/Components/Followers/PositionDamper2D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.PositionDamper2D)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_value",new e.SFVec2f),new t(r.inputOnly,"set_destination",new e.SFVec2f),new t(r.initializeOnly,"initialValue",new e.SFVec2f),new t(r.initializeOnly,"initialDestination",new e.SFVec2f),new t(r.initializeOnly,"order",new e.SFInt32(3)),new t(r.inputOutput,"tau",new e.SFTime(.3)),new t(r.inputOutput,"tolerance",new e.SFFloat(-1)),new t(r.outputOnly,"isActive",new e.SFBool),new t(r.outputOnly,"value_changed",new e.SFVec2f)]),getTypeName:function(){return"PositionDamper2D"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0)}}),o}),define("x_ite/Components/Interpolation/PositionInterpolator2D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.PositionInterpolator2D)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_fraction",new e.SFFloat),new t(r.inputOutput,"key",new e.MFFloat),new t(r.inputOutput,"keyValue",new e.MFVec2f),new t(r.outputOnly,"value_changed",new e.SFVec2f)]),getTypeName:function(){return"PositionInterpolator2D"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){var t=this.key_,i=this.keyValue_;i.length<t.length&&i.resize(t.length,i.length?i[i.length-1]:new e.SFVec2f)},interpolate:function(){var e=new s(0,0);return function(t,i,n){this.value_changed_=e.assign(this.keyValue_[t].getValue()).lerp(this.keyValue_[i].getValue(),n)}}()}),o}),define("x_ite/Components/CADGeometry/QuadSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.QuadSet)}var o=[0,1,2,0,2,3];return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"solid",new e.SFBool(!0)),new t(r.initializeOnly,"ccw",new e.SFBool(!0)),new t(r.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new t(r.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new t(r.inputOutput,"attrib",new e.MFNode),new t(r.inputOutput,"fogCoord",new e.SFNode),new t(r.inputOutput,"color",new e.SFNode),new t(r.inputOutput,"texCoord",new e.SFNode),new t(r.inputOutput,"normal",new e.SFNode),new t(r.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"QuadSet"},getComponentName:function(){return"CADGeometry"},getContainerField:function(){return"geometry"},getTriangleIndex:function(e){var t=e%6;return(e-t)/6*4+o[t]},build:function(){if(this.getCoord()){var e=this.getCoord().getSize();e-=e%4,n.prototype.build.call(this,4,e,6,e/4*6)}},createNormals:function(e,t){return this.createFaceNormals(e,t)}}),s}),define("x_ite/Components/Geometry2D/Rectangle2D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,s,o){"use strict";function a(e){n.call(this,e),this.addType(r.Rectangle2D),this.setGeometryType(2),this.size_.setUnit("length")}var u=new s(2,2);return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"size",new e.SFVec2f(2,2)),new t(r.initializeOnly,"solid",new e.SFBool)]),getTypeName:function(){return"Rectangle2D"},getComponentName:function(){return"Geometry2D"},getContainerField:function(){return"geometry"},build:function(){var e=this.getBrowser().getRectangle2DOptions(),t=e.getGeometry(),i=this.size_.getValue();if(this.setMultiTexCoords(t.getMultiTexCoords()),this.setNormals(t.getNormals()),i.equals(u))this.setVertices(t.getVertices()),this.getMin().assign(t.getMin()),this.getMax().assign(t.getMax());else{for(var n=o.divide(i,2),r=n.x,s=n.y,a=t.getVertices().getValue(),l=this.getVertices(),h=0;h<a.length;h+=4)l.push(r*a[h],s*a[h+1],a[h+2],1);this.getMin().set(-r,-s,0),this.getMax().set(r,s,0)}this.setSolid(this.solid_.getValue())}}),a}),define("x_ite/Components/Followers/ScalarChaser",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.ScalarChaser)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_value",new e.SFFloat),new t(r.inputOnly,"set_destination",new e.SFFloat),new t(r.initializeOnly,"initialValue",new e.SFFloat),new t(r.initializeOnly,"initialDestination",new e.SFFloat),new t(r.initializeOnly,"duration",new e.SFTime(1)),new t(r.outputOnly,"isActive",new e.SFBool),new t(r.outputOnly,"value_changed",new e.SFFloat)]),getTypeName:function(){return"ScalarChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return 0},setPreviousValue:function(e){this.previousValue=e},setDestination:function(e){this.destination=e},duplicate:function(e){return e},assign:function(e,t,i){e[t]=i},equals:function(e,t,i){return Math.abs(e-t)<i},interpolate:function(e,t,i){return s.lerp(e,t,i)},step:function(e,t,i){this.output+=(e-t)*i}}),o}),define("x_ite/Components/Followers/ScalarDamper",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.ScalarDamper)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_value",new e.SFFloat),new t(r.inputOnly,"set_destination",new e.SFFloat),new t(r.initializeOnly,"initialValue",new e.SFFloat),new t(r.initializeOnly,"initialDestination",new e.SFFloat),new t(r.initializeOnly,"order",new e.SFInt32(3)),new t(r.inputOutput,"tau",new e.SFTime(.3)),new t(r.inputOutput,"tolerance",new e.SFFloat(-1)),new t(r.outputOnly,"isActive",new e.SFBool),new t(r.outputOnly,"value_changed",new e.SFFloat)]),getTypeName:function(){return"ScalarDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return 0},duplicate:function(e){return e},assign:function(e,t,i){e[t]=i},equals:function(e,t,i){return Math.abs(e-t)<i},interpolate:function(e,t,i){return s.lerp(e,t,i)}}),o}),define("x_ite/Browser/Layout/ScreenText",["jquery","x_ite/Fields","x_ite/Browser/Text/X3DTextGeometry","x_ite/Browser/Text/TextAlignment","x_ite/Components/Texturing/PixelTexture","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/TraverseType","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Box3","standard/Math/Geometry/ViewVolume","standard/Math/Algorithm"],function(e,t,i,n,r,s,o,a,u,l,h,c,d,p,f){"use strict";function g(t,n){i.call(this,t,n),t.transparent_=!0,this.texCoordArray=s.createArray(),this.texture=new r(t.getExecutionContext()),this.canvas=e("<canvas></canvas>"),this.context=this.canvas[0].getContext("2d"),this.matrix=new c,this.texture.textureProperties_=n.getBrowser().getScreenTextureProperties(),this.texture.setup()}var m=[],_=new u(0,0,0),x=new u(1,1,0),y=new d;return g.prototype=Object.assign(Object.create(i.prototype),{constructor:g,modelViewMatrix:new c,getMatrix:function(){return this.matrix},update:function(){i.prototype.update.call(this);var e=this.getFontStyle(),t=this.getText();switch(t.textBounds_.x=Math.ceil(t.textBounds_.x)+1,t.textBounds_.y=Math.ceil(t.textBounds_.y)+1,this.getBBox().getExtents(_,x),_.x-=1,_.y-=1,e.getMajorAlignment()){case n.BEGIN:case n.FIRST:_.x=Math.floor(_.x),x.x=_.x+t.textBounds_.x;break;case n.MIDDLE:_.x=Math.round(_.x),x.x=_.x+t.textBounds_.x;break;case n.END:x.x=Math.ceil(x.x),_.x=x.x-t.textBounds_.x}switch(e.getMinorAlignment()){case n.BEGIN:case n.FIRST:x.y=Math.ceil(x.y),_.y=x.y-t.textBounds_.y;break;case n.MIDDLE:x.y=Math.round(x.y),_.y=x.y-t.textBounds_.y;break;case n.END:_.y=Math.floor(_.y),x.y=_.y+t.textBounds_.y}t.origin_.x=_.x,t.origin_.y=x.y,this.getBBox().setExtents(_,x)},build:function(){var e=this.getFontStyle(),t=e.getFont();if(t){var i=this.getText(),n=this.getGlyphs(),r=this.getMinorAlignment(),s=this.getTranslations(),o=this.getCharSpacings(),a=e.getScale(),u=a/t.unitsPerEm,l=this.texCoordArray,h=i.getNormals(),c=i.getVertices(),d=this.canvas[0],p=this.context;l.length=0,i.getMultiTexCoords().push(l),this.getBBox().getExtents(_,x),h.push(0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1),c.push(_.x,_.y,0,1,x.x,_.y,0,1,x.x,x.y,0,1,_.x,_.y,0,1,x.x,x.y,0,1,_.x,x.y,0,1);var g=i.textBounds_.x,m=i.textBounds_.y;f.isPowerOfTwo(g)&&f.isPowerOfTwo(m)?(d.width=g,d.height=m):(d.width=f.nextPowerOfTwo(g),d.height=f.nextPowerOfTwo(m));var y=g/d.width,v=m/d.height,w=1-v;if(l.push(0,w,0,1,y,w,0,1,y,1,0,1,0,w,0,1,y,1,0,1,0,1,0,1),p.fillStyle="rgba(255,255,255,0)",p.fillRect(0,0,d.width,d.height),p.fillStyle="rgba(255,255,255,1)",e.horizontal_.getValue())for(var b=0,S=n.length;b<S;++b)for(var C=n[b],T=o[b],F=s[b],O=0,N=0,M=C.length;N<M;++N){var D=C[N],E=r.x+F.x+O+N*T-_.x,w=r.y+F.y-x.y;this.drawGlyph(p,t,D,E,w,a);var V=0;N+1<C.length&&(V=t.getKerningValue(D,C[N+1])),O+=(D.advanceWidth+V)*u}else for(var B=e.leftToRight_.getValue(),I=e.topToBottom_.getValue(),A=B?0:i.string_.length-1,P=B?i.string_.length:-1,R=B?1:-1,b=A,L=0;b!==P;b+=R)for(var C=n[b],z=C.length,k=I?0:z-1,X=I?z:-1,U=I?1:-1,N=k;N!==X;N+=U,++L){var F=s[L],E=r.x+F.x-_.x,w=r.y+F.y-x.y;this.drawGlyph(p,t,C[N],E,w,a)}var j=p.getImageData(0,0,d.width,d.height);j?this.texture.setTexture(d.width,d.height,!0,new Uint8Array(j.data),!0):this.texture.clear()}},drawGlyph:function(e,t,i,n,r,s){var o=i.components;if(m.length=0,i.isComposite)for(var a=0,u=o.length;a<u;++a){var l=o[a];m.push(i.getPath(l.dx/t.unitsPerEm*s+n,l.dy/t.unitsPerEm*s-r,s))}else m.push(i.getPath(n,-r,s));for(var h=0,c=m.length;h<c;++h){var d=m[h],p=d.commands;e.beginPath();for(var f=0,u=p.length;f<u;++f){var g=p[f];switch(g.type){case"M":e.moveTo(g.x,g.y);continue;case"Z":e.closePath();continue;case"L":e.lineTo(g.x,g.y);continue;case"C":e.bezierCurveTo(g.x1,g.y1,g.x2,g.y2,g.x,g.y);continue;case"Q":e.quadraticCurveTo(g.x1,g.y1,g.x,g.y);continue}}d.fill&&e.fill(),d.stroke&&(e.lineWidth=d.strokeWidth,e.stroke())}},getGlyphExtents:function(e,t,i,n){var r=this.getFontStyle(),s=r.getFont(),o=s.unitsPerEm;i.set((e.xMin||0)/o,(e.yMin||0)/o,0),n.set((e.xMax||0)/o,(e.yMax||0)/o,0)},transform:function(){var e=new l(0,0,0,0),t=new l(0,0,0,0),i=new l(0,0,0,0),n=new u(0,0,0),r=new c;return function(s){var o=this.getText(),a=s.getModelViewMatrix().get(),l=s.getProjectionMatrix().get(),h=s.getViewVolume().getViewport(),c=s.getViewpoint().getScreenScale(a.origin,h);e.set(a[0],a[1],a[2],a[3]),t.set(a[4],a[5],a[6],a[7]),i.set(a[8],a[9],a[10],a[11]),e.normalize().multiply(c.x),t.normalize().multiply(c.y),i.normalize().multiply(c.z),r.set(e.x,e.y,e.z,e.w,t.x,t.y,t.z,t.w,i.x,i.y,i.z,i.w,a[12],a[13],a[14],a[15]),p.projectPoint(u.Zero,r,l,h,n),n.x=Math.round(n.x),n.y=Math.round(n.y),p.unProjectPoint(n.x,n.y,n.z,r,l,h,n),n.z=0,r.translate(n),this.matrix.assign(a).inverse().multLeft(r),y.assign(this.getBBox()).multRight(this.matrix),o.setBBox(y)}}(),traverse:function(e,t){this.transform(t)},display:function(e,t){c.prototype.multLeft.call(t.modelViewMatrix,this.matrix),t.textureNode=this.texture,t.textureTransformNode=this.getBrowser().getDefaultTextureTransform()},transformLine:function(e){return e.multLineMatrix(c.inverse(this.matrix))},transformMatrix:function(e){return e.multLeft(this.matrix)}}),g}),define("x_ite/Components/Layout/ScreenFontStyle",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Text/X3DFontStyleNode","x_ite/Browser/Layout/ScreenText","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(s.ScreenFontStyle)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"language",new e.SFString),new t(s.inputOutput,"family",new e.MFString("SERIF")),new t(s.inputOutput,"style",new e.SFString("PLAIN")),new t(s.inputOutput,"pointSize",new e.SFFloat(12)),new t(s.inputOutput,"spacing",new e.SFFloat(1)),new t(s.inputOutput,"horizontal",new e.SFBool(!0)),new t(s.inputOutput,"leftToRight",new e.SFBool(!0)),new t(s.inputOutput,"topToBottom",new e.SFBool(!0)),new t(s.inputOutput,"justify",new e.MFString("BEGIN"))]),getTypeName:function(){return"ScreenFontStyle"},getComponentName:function(){return"Layout"},getContainerField:function(){return"fontStyle"},getTextGeometry:function(e){return new r(e,this)},getScale:function(){return this.pointSize_.getValue()*this.getBrowser().getPointSize()}}),o}),define("x_ite/Components/Layout/ScreenGroup",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/X3DConstants","x_ite/Bits/TraverseType","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/ViewVolume"],function(e,t,i,n,r,s,o,a,u,l,h){"use strict";function c(e){n.call(this,e),this.addType(r.ScreenGroup),this.screenMatrix=new l}return c.prototype=Object.assign(Object.create(n.prototype),{constructor:c,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(r.initializeOnly,"bboxCenter",new e.SFVec3f),new t(r.inputOnly,"addChildren",new e.MFNode),new t(r.inputOnly,"removeChildren",new e.MFNode),new t(r.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"ScreenGroup"},getComponentName:function(){return"Layout"},getContainerField:function(){return"children"},getBBox:function(e){return n.prototype.getBBox.call(this,e).multRight(this.getMatrix())},getMatrix:function(){try{this.matrix.assign(this.modelViewMatrix).inverse().multLeft(this.screenMatrix)}catch(e){}return this.matrix},scale:function(){var e=new a(0,0,0,0),t=new a(0,0,0,0),i=new a(0,0,0,0),n=new o(0,0,0);return function(r){var s=r.getModelViewMatrix().get(),a=r.getProjectionMatrix().get(),u=r.getViewVolume().getViewport(),l=this.screenMatrix,c=r.getViewpoint().getScreenScale(s.origin,u);return e.set(s[0],s[1],s[2],s[3]),t.set(s[4],s[5],s[6],s[7]),i.set(s[8],s[9],s[10],s[11]),e.normalize().multiply(c.x),t.normalize().multiply(c.y),i.normalize().multiply(c.z),l.set(e.x,e.y,e.z,e.w,t.x,t.y,t.z,t.w,i.x,i.y,i.z,i.w,s[12],s[13],s[14],s[15]),h.projectPoint(o.Zero,l,a,u,n),n.x=Math.round(n.x),n.y=Math.round(n.y),h.unProjectPoint(n.x,n.y,n.z,l,a,u,n),n.z=0,l.translate(n),l}}(),traverse:function(e,t){try{var i=t.getModelViewMatrix();switch(e){case s.CAMERA:case s.DEPTH:i.pushMatrix(this.screenMatrix);break;default:i.pushMatrix(this.scale(t))}n.prototype.traverse.call(this,e,t),i.pop()}catch(e){}}}),c}),define("x_ite/Browser/Scripting/evaluate",[],function(){return function(){with(arguments[0])return eval(arguments[1])}}),define("x_ite/Components/Scripting/X3DScriptNode",["x_ite/Components/Core/X3DChildNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Bits/X3DConstants"],function(e,t,i){"use strict";function n(n){e.call(this,n),t.call(this,n),this.addType(i.X3DScriptNode)}return n.prototype=Object.assign(Object.create(e.prototype),t.prototype,{constructor:n}),n}),define("x_ite/Components/Scripting/Script",["jquery","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Basic/X3DField","x_ite/Basic/X3DArrayField","x_ite/Fields","x_ite/Browser/X3DBrowser","x_ite/Configuration/ComponentInfo","x_ite/Configuration/ComponentInfoArray","x_ite/Configuration/ProfileInfo","x_ite/Configuration/ProfileInfoArray","x_ite/Configuration/UnitInfo","x_ite/Configuration/UnitInfoArray","x_ite/Execution/X3DExecutionContext","x_ite/Execution/X3DScene","x_ite/Prototype/ExternProtoDeclarationArray","x_ite/Prototype/ProtoDeclarationArray","x_ite/Prototype/X3DExternProtoDeclaration","x_ite/Prototype/X3DProtoDeclaration","x_ite/Routing/RouteArray","x_ite/Routing/X3DRoute","x_ite/Browser/Scripting/evaluate","x_ite/Components/Scripting/X3DScriptNode","x_ite/InputOutput/FileLoader","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s,o,a,u,l,h,c,d,p,f,g,m,_,x,y,v,w,b,S,C){function T(e){b.call(this,e),this.addChildObjects("buffer",new s.SFTime),this.addType(C.Script)}return T.prototype=Object.assign(Object.create(b.prototype),{constructor:T,fieldDefinitions:new i([new t(C.inputOutput,"metadata",new s.SFNode),new t(C.inputOutput,"url",new s.MFString),new t(C.initializeOnly,"directOutput",new s.SFBool),new t(C.initializeOnly,"mustEvaluate",new s.SFBool)]),getTypeName:function(){return"Script"},getComponentName:function(){return"Scripting"},getContainerField:function(){return"children"},initialize:function(){b.prototype.initialize.call(this),this.url_.addInterest("set_url__",this),this.buffer_.addInterest("set_buffer__",this);var e=this.getUserDefinedFields();for(var t of e.values())t.setSet(!1);this.set_url__()},set_url__:function(){this.setLoadState(C.NOT_STARTED_STATE),this.requestAsyncLoad()},getExtendedEventHandling:function(){return!1},hasUserDefinedFields:function(){return!0},getSourceText:function(){return this.url_},requestAsyncLoad:function(){this.checkLoadState()!==C.COMPLETE_STATE&&this.checkLoadState()!==C.IN_PROGRESS_STATE&&0!==this.url_.length&&(this.setLoadState(C.IN_PROGRESS_STATE),this.buffer_.addEvent())},set_buffer__:function(){new S(this).loadScript(this.url_,function(e){null===e?this.setLoadState(C.FAILED_STATE):(this.setLoadState(C.COMPLETE_STATE),this.initialize__(e))}.bind(this))},getContext:function(e){try{var t=["initialize","prepareEvents","eventsProcessed","shutdown"],i=this.getUserDefinedFields();for(var n of i.values())switch(n.getAccessType()){case C.inputOnly:t.push(n.getName());break;case C.inputOutput:t.push("set_"+n.getName())}e+="\n;var "+t.join(",")+";",e+="\n["+t.join(",")+"];";for(var r=this.getGlobal(),s=w(r,e),o={},a=0;a<t.length;++a)"function"==typeof s[a]?o[t[a]]=s[a]:o[t[a]]=null;return o}catch(e){return this.setError("while evaluating script source",e),{}}},getGlobal:function(){function e(e){var t=w.createX3DFromString(String(e));if(t.getRootNodes().length&&t.getRootNodes()[0])return s.SFNode.call(this,t.getRootNodes()[0].getValue());throw new Error("SFNode.new: invalid argument, must be 'string' is 'undefined'.")}var w=this.getBrowser();e.prototype=Object.create(s.SFNode.prototype),e.prototype.constructor=e;var b={NULL:{value:null},FALSE:{value:!1},TRUE:{value:!0},print:{value:function(){w.println.apply(w,arguments)}},trace:{value:function(){w.println.apply(w,arguments)}},Browser:{value:w},X3DConstants:{value:C},X3DBrowser:{value:o},X3DExecutionContext:{value:p},X3DScene:{value:f},ComponentInfo:{value:a},ComponentInfoArray:{value:u},ProfileInfo:{value:l},ProfileInfoArray:{value:h},UnitInfo:{value:c},UnitInfoArray:{value:d},ExternProtoDeclarationArray:{value:g},ProtoDeclarationArray:{value:m},X3DExternProtoDeclaration:{value:_},X3DProtoDeclaration:{value:x},RouteArray:{value:y},X3DRoute:{value:v},X3DFieldDefinition:{value:t},FieldDefinitionArray:{value:i},X3DField:{value:n},X3DArrayField:{value:r},SFBool:{value:function e(){return this instanceof e?arguments.length?new Boolean(arguments[0]):new Boolean:arguments.length?Boolean(arguments[0]):Boolean()}},SFDouble:{value:function e(){return this instanceof e?arguments.length?new Number(arguments[0]):new Number:arguments.length?Number(arguments[0]):Number()}},SFFloat:{value:function e(){return this instanceof e?arguments.length?new Number(arguments[0]):new Number:arguments.length?Number(arguments[0]):Number()}},SFInt32:{value:function e(){return this instanceof e?arguments.length?new Number(~~arguments[0]):new Number:arguments.length?Number(~~arguments[0]):Number()}},SFString:{value:function e(){return this instanceof e?arguments.length?new String(arguments[0]):new String:arguments.length?String(arguments[0]):String()}},SFTime:{value:function e(){return this instanceof e?arguments.length?new Number(arguments[0]):new Number:arguments.length?Number(arguments[0]):Number()}},SFColor:{value:s.SFColor},SFColorRGBA:{value:s.SFColorRGBA},SFImage:{value:s.SFImage},SFMatrix3d:{value:s.SFMatrix3d},SFMatrix3f:{value:s.SFMatrix3f},SFMatrix4d:{value:s.SFMatrix4d},SFMatrix4f:{value:s.SFMatrix4f},SFNode:{value:e},SFRotation:{value:s.SFRotation},SFVec3d:{value:s.SFVec2d},SFVec2f:{value:s.SFVec2f},SFVec2d:{value:s.SFVec3d},SFVec3f:{value:s.SFVec3f},SFVec4d:{value:s.SFVec4d},SFVec4f:{value:s.SFVec4f},VrmlMatrix:{value:s.VrmlMatrix},MFBool:{value:s.MFBool},MFColor:{value:s.MFColor},MFColorRGBA:{value:s.MFColorRGBA},MFDouble:{value:s.MFDouble},MFFloat:{value:s.MFFloat},MFImage:{value:s.MFImage},MFInt32:{value:s.MFInt32},MFMatrix3d:{value:s.MFMatrix3d},MFMatrix3f:{value:s.MFMatrix3f},MFMatrix4d:{value:s.MFMatrix4d},MFMatrix4f:{value:s.MFMatrix4f},MFNode:{value:s.MFNode},MFRotation:{value:s.MFRotation},MFString:{value:s.MFString},MFTime:{value:s.MFTime},MFVec2d:{value:s.MFVec2d},MFVec2f:{value:s.MFVec2f},MFVec3d:{value:s.MFVec3d},MFVec3f:{value:s.MFVec3f},MFVec4d:{value:s.MFVec4d},MFVec4f:{value:s.MFVec4f}},S=this.getUserDefinedFields();for(var T of S.values()){var F=T.getName();T.getAccessType()!==C.inputOnly&&(F in b||(b[F]={get:T.valueOf.bind(T),set:T.setValue.bind(T)}),T.getAccessType()===C.inputOutput&&(b[F+"_changed"]={get:T.valueOf.bind(T),set:T.setValue.bind(T)}))}return Object.create(Object.prototype,b)},set_live__:function(){var t=this.getUserDefinedFields();if(this.isLive().getValue()){e.isFunction(this.context.prepareEvents)&&this.getBrowser().prepareEvents().addInterest("prepareEvents__",this),e.isFunction(this.context.eventsProcessed)&&this.addInterest("eventsProcessed__",this);for(var i of t.values())switch(i.getAccessType()){case C.inputOnly:var n=this.context[i.getName()];e.isFunction(n)&&i.addInterest("set_field__",this,n);break;case C.inputOutput:var n=this.context["set_"+i.getName()];e.isFunction(n)&&i.addInterest("set_field__",this,n)}}else{this.context.prepareEvents&&this.getBrowser().prepareEvents().removeInterest("prepareEvents__",this),this.context.eventsProcessed&&this.removeInterest("eventsProcessed__",this);for(var i of t.values())switch(i.getAccessType()){case C.inputOnly:case C.inputOutput:i.removeInterest("set_field__",this)}}},initialize__:function(t){if(this.context=this.getContext(t),this.isLive().addInterest("set_live__",this),this.set_live__(),this.context.initialize){var i=this.getBrowser();i.getScriptStack().push(this);try{this.context.initialize()}catch(e){this.setError("in function 'initialize'",e)}i.getScriptStack().pop()}var n=this.getUserDefinedFields();for(var r of n.values())if(r.getSet()){var s=this.context[r.getName()];e.isFunction(s)&&this.set_field__(r,s)}},prepareEvents__:function(){var e=this.getBrowser();e.getScriptStack().push(this);try{this.context.prepareEvents(),e.addBrowserEvent()}catch(e){this.setError("in function 'prepareEvents'",e)}e.getScriptStack().pop()},set_field__:function(e,t){
var i=this.getBrowser(),n=i.getCurrentTime();e.setTainted(!0),i.getScriptStack().push(this);try{t(e.valueOf(),n)}catch(t){this.setError("in function '"+e.getName()+"'",t)}i.getScriptStack().pop(),e.setTainted(!1)},eventsProcessed__:function(){var e=this.getBrowser();e.getScriptStack().push(this);try{this.context.eventsProcessed()}catch(e){this.setError("in function 'eventsProcessed'",e)}e.getScriptStack().pop()},shutdown__:function(){var e=this.getBrowser();e.getScriptStack().push(this);try{this.context.shutdown()}catch(e){this.setError("in function 'shutdown'",e)}e.getScriptStack().pop()},setError:function(e,t){console.error("JavaScript Error in Script '"+this.getName()+"', "+e+"\nworld url is '"+this.getExecutionContext().getURL()+"':"),console.error(t)}}),T}),define("x_ite/Components/Shape/Shape",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shape/X3DShapeNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Algorithm","standard/Math/Geometry/Line3","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Algorithms/QuickSort"],function(e,t,i,n,r,s,o,a,u,l,h){"use strict";function c(e){n.call(this,e),this.addType(s.Shape)}return c.prototype=Object.assign(Object.create(n.prototype),{constructor:c,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(s.initializeOnly,"bboxCenter",new e.SFVec3f),new t(s.inputOutput,"appearance",new e.SFNode),new t(s.inputOutput,"geometry",new e.SFNode)]),getTypeName:function(){return"Shape"},getComponentName:function(){return"Shape"},getContainerField:function(){return"children"},set_geometry__:function(){n.prototype.set_geometry__.call(this),this.getGeometry()?delete this.traverse:this.traverse=Function.prototype},intersectsBox:function(e,t,i){return this.getGeometry().intersectsBox(e,t,i)},traverse:function(e,t){switch(e){case r.POINTER:this.pointer(t);break;case r.COLLISION:t.addCollisionShape(this);break;case r.DEPTH:t.addDepthShape(this);break;case r.DISPLAY:t.addDisplayShape(this)&&this.getAppearance().traverse(e,t)}this.getGeometry().traverse(e,t)},pointer:function(){var e=new l,t=new l,i=new a(new u(0,0,0),new u(0,0,0)),n=[],r=new h(n,function(e,t){return e.point.z>t.point.z});return function(s){try{var a=this.getGeometry();if(a.getGeometryType()<2)return;var u=s.getBrowser();if(e.assign(s.getModelViewMatrix().get()),t.assign(e).inverse(),i.assign(u.getHitRay()).multLineMatrix(t),a.intersectsLine(i,s.getShaderObjects(),e,n)){for(var l=0;l<n.length;++l)e.multVecMatrix(n[l].point);r.sort(0,n.length);var h=o.lowerBound(n,0,n.length,-s.getNavigationInfo().getNearValue(),function(e,t){return e.point.z>t});h!==n.length&&(t.multMatrixDir(n[h].normal).normalize(),u.addHit(n[h],s.getLayer(),this,e.multRight(s.getCameraSpaceMatrix().get()))),n.length=0}}catch(e){console.log(e)}}}(),depth:function(e,t,i){this.getGeometry().depth(e,t,i)},display:function(e,t){this.getAppearance().enable(e,t),this.getGeometry().display(e,t),this.getAppearance().disable(e,t)}}),c}),define("x_ite/Components/Sound/X3DSoundNode",["x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DSoundNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i}),i}),define("standard/Math/Geometry/Sphere3",["standard/Math/Numbers/Vector3"],function(e){"use strict";function t(e,t){this.radius=e,this.center=t.copy()}var i=new e(0,0,0),n=new e(0,0,0),r=new e(0,0,0),s=new e(0,0,0),o=new e(0,0,0),a=new e(0,0,0),u=new e(0,0,0),l=new e(0,0,0);return t.prototype={constructor:t,set:function(e,t){this.radius=e,this.center.assign(t)},intersectsLine:function(t,n,r){i.assign(this.center).subtract(t.point);var s=e.dot(i,t.direction);if(s<0)return!1;var o=e.dot(i,i)-Math.pow(s,2),a=Math.pow(this.radius,2);if(o>a)return!1;var u=Math.sqrt(a-o),l=s-u,h=s+u;return n.assign(t.direction).multiply(l).add(t.point),r.assign(t.direction).multiply(h).add(t.point),!0},intersectsTriangle:function(t,i,h){var c=this.center,d=this.radius;t.subtract(c),i.subtract(c),h.subtract(c),n.assign(i).subtract(t),r.assign(h).subtract(t);var p=d*d,f=n.cross(r),g=e.dot(t,f);if(g*g>p*e.dot(f,f))return!1;var m=e.dot(t,t),_=e.dot(t,i),x=e.dot(t,h),y=e.dot(i,i),v=e.dot(i,h),w=e.dot(h,h),b=m>p&&_>m&&x>m,S=y>p&&_>y&&v>y,C=w>p&&x>w&&v>w;if(b||S||C)return!1;n.assign(i).subtract(t),s.assign(h).subtract(i),o.assign(t).subtract(h);var T=_-m,F=v-y,O=x-w,N=e.dot(n,n),M=e.dot(s,s),D=e.dot(o,o);a.assign(t).multiply(N).subtract(n.multiply(T)),u.assign(i).multiply(M).subtract(s.multiply(F)),l.assign(h).multiply(D).subtract(o.multiply(O));var E=h.multiply(N).subtract(a),V=t.multiply(M).subtract(u),B=i.multiply(D).subtract(l),I=e.dot(a,a)>p*N*N&&e.dot(a,E)>0,A=e.dot(u,u)>p*M*M&&e.dot(u,V)>0,P=e.dot(l,l)>p*D*D&&e.dot(l,B)>0;return!(I||A||P)},toString:function(){return this.radius+" "+this.center.toString()}},t}),define("x_ite/Components/Sound/Sound",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Sound/X3DSoundNode","x_ite/Bits/X3DCast","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Line3","standard/Math/Geometry/Sphere3","standard/Math/Algorithm"],function(e,t,i,n,r,s,o,a,u,l,h,c,d){"use strict";function p(t){n.call(this,t),this.addType(o.Sound),this.addChildObjects("traversed",new e.SFBool(!0)),this.location_.setUnit("length"),this.minBack_.setUnit("length"),this.minFront_.setUnit("length"),this.maxBack_.setUnit("length"),this.maxFront_.setUnit("length"),this.currentTraversed=!0}return p.prototype=Object.assign(Object.create(n.prototype),{constructor:p,fieldDefinitions:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"intensity",new e.SFFloat(1)),new t(o.initializeOnly,"spatialize",new e.SFBool(!0)),new t(o.inputOutput,"location",new e.SFVec3f),new t(o.inputOutput,"direction",new e.SFVec3f(0,0,1)),new t(o.inputOutput,"minBack",new e.SFFloat(1)),new t(o.inputOutput,"minFront",new e.SFFloat(1)),new t(o.inputOutput,"maxBack",new e.SFFloat(10)),new t(o.inputOutput,"maxFront",new e.SFFloat(10)),new t(o.inputOutput,"priority",new e.SFFloat),new t(o.inputOutput,"source",new e.SFNode)]),getTypeName:function(){return"Sound"},getComponentName:function(){return"Sound"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this),this.traversed_.addInterest("set_live__",this),this.source_.addInterest("set_source__",this),this.set_live__(),this.set_source__()},setTraversed:function(e){e?this.traversed_.getValue()===!1&&(this.traversed_=!0):this.currentTraversed!==this.traversed_.getValue()&&(this.traversed_=this.currentTraversed),this.currentTraversed=e},getTraversed:function(){return this.currentTraversed},set_live__:function(){this.isLive().getValue()&&this.traversed_.getValue()?this.getBrowser().sensorEvents().addInterest("update",this):this.getBrowser().sensorEvents().removeInterest("update",this)},set_source__:function(){this.sourceNode&&this.sourceNode.setVolume(0),this.sourceNode=r(o.X3DSoundSourceNode,this.source_)},update:function(){this.getTraversed()||this.sourceNode&&this.sourceNode.setVolume(0),this.setTraversed(!1)},traverse:function(){var e={distance:0,intersection:new a(0,0,0)},t={distance:0,intersection:new a(0,0,0)};return function(i,n){try{if(i!==s.DISPLAY)return;if(!this.sourceNode)return;if(!this.sourceNode.isActive_.getValue()||this.sourceNode.isPaused_.getValue())return;this.setTraversed(!0);var r=n.getModelViewMatrix().get();if(this.getEllipsoidParameter(r,Math.max(this.maxBack_.getValue(),0),Math.max(this.maxFront_.getValue(),0),t),t.distance<1)if(this.getEllipsoidParameter(r,Math.max(this.minBack_.getValue(),0),Math.max(this.minFront_.getValue(),0),e),e.distance<1)this.sourceNode.setVolume(this.intensity_.getValue());else{var o=t.intersection.abs(),a=t.intersection.distance(e.intersection),u=Math.min(o/a,1),l=d.clamp(this.intensity_.getValue(),0,1),h=l*u;this.sourceNode.setVolume(h)}else this.sourceNode.setVolume(0)}catch(e){this.sourceNode&&this.sourceNode.setVolume(0)}}}(),getEllipsoidParameter:function(){var e=new a(0,0,0),t=new l,i=new l,n=(new a(0,0,0),new u),r=new a(1,1,1),s=new c(1,a.Zero),o=new h(a.Zero,a.zAxis),d=new a(0,0,0),p=new a(0,0,0);return function(u,l,h,c){var f=(l+h)/2,g=f-l,m=Math.sqrt(f*f-g*g);e.set(0,0,g),r.set(m,m,f),n.setFromToVec(a.zAxis,this.direction_.getValue()),t.assign(u),t.translate(this.location_.getValue()),t.rotate(n),t.translate(e),t.scale(r),i.assign(t),i.inverse();var _=i.origin;e.negate().divVec(r),o.set(_,e.subtract(_).normalize()),s.intersectsLine(o,d,p),_.distance(d)<_.distance(p)?c.intersection.assign(t.multVecMatrix(d)):c.intersection.assign(t.multVecMatrix(p)),c.distance=_.abs()}}()}),p}),define("x_ite/Components/Geometry3D/Sphere",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.Sphere),this.radius_.setUnit("length")}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"radius",new e.SFFloat(1)),new t(r.initializeOnly,"solid",new e.SFBool(!0))]),getTypeName:function(){return"Sphere"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},set_live__:function(){n.prototype.set_live__.call(this),this.isLive().getValue()?this.getBrowser().getSphereOptions().addInterest("eventsProcessed",this):this.getBrowser().getSphereOptions().removeInterest("eventsProcessed",this)},build:function(){var e=this.getBrowser().getSphereOptions(),t=e.getGeometry(),i=this.radius_.getValue();if(this.setMultiTexCoords(t.getMultiTexCoords()),this.setNormals(t.getNormals()),1===i)this.setVertices(t.getVertices()),this.getMin().assign(t.getMin()),this.getMax().assign(t.getMax());else{for(var n=t.getVertices().getValue(),r=this.getVertices(),s=0;s<n.length;s+=4)r.push(i*n[s],i*n[s+1],i*n[s+2],1);i=Math.abs(i),this.getMin().set(-i,-i,-i),this.getMax().set(i,i,i)}this.setSolid(this.solid_.getValue())}}),s}),define("x_ite/Components/PointingDeviceSensor/SphereSensor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/PointingDeviceSensor/X3DDragSensorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Triangle3","standard/Math/Geometry/Line3","standard/Math/Geometry/Plane3","standard/Math/Geometry/Sphere3"],function(e,t,i,n,r,s,o,a,u,l,h,c){"use strict";function d(e){n.call(this,e),this.addType(r.SphereSensor)}return d.prototype=Object.assign(Object.create(n.prototype),{constructor:d,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"enabled",new e.SFBool(!0)),new t(r.inputOutput,"description",new e.SFString),new t(r.inputOutput,"autoOffset",new e.SFBool(!0)),new t(r.inputOutput,"offset",new e.SFRotation),new t(r.outputOnly,"trackPoint_changed",new e.SFVec3f),new t(r.outputOnly,"rotation_changed",new e.SFRotation),new t(r.outputOnly,"isOver",new e.SFBool),new t(r.outputOnly,"isActive",new e.SFBool)]),getTypeName:function(){return"SphereSensor"},getComponentName:function(){return"PointingDeviceSensor"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.modelViewMatrix=new a,this.invModelViewMatrix=new a,this.sphere=null,this.zPlane=null,this.behind=!1,this.fromVector=new s(0,0,0),this.startPoint=new s(0,0,0),this.startOffset=new o(0,0,1,0)},getTrackPoint:function(e,t,i){var n=new s(0,0,0);return!!this.sphere.intersectsLine(e,t,n)&&((s.subtract(e.point,n).abs()<s.subtract(e.point,t).abs())-i&&t.assign(n),!0)},set_active__:function(e,t,i,r,o){n.prototype.set_active__.call(this,e,t,i,r,o);try{if(this.isActive_.getValue()){this.modelViewMatrix.assign(i),this.invModelViewMatrix.assign(i).inverse();var a=this.invModelViewMatrix.multVecMatrix(t.intersection.point.copy()),u=new s(0,0,0);this.zPlane=new h(u,this.invModelViewMatrix.multDirMatrix(new s(0,0,1)).normalize()),this.sphere=new c(a.abs(),u),this.behind=this.zPlane.getDistanceToPoint(a)<0,this.fromVector.assign(a),this.startPoint.assign(a),this.startOffset.assign(this.offset_.getValue()),this.trackPoint_changed_=a,this.rotation_changed_=this.offset_.getValue()}else this.autoOffset_.getValue()&&(this.offset_=this.rotation_changed_)}catch(e){}},set_motion__:function(e){try{var t=e.hitRay.copy().multLineMatrix(this.invModelViewMatrix),i=new s(0,0,0);if(this.getTrackPoint(t,i,this.behind)){var n=this.invModelViewMatrix.multDirMatrix(new s(0,0,1)).normalize();this.zPlane=new h(i,n)}else{var r=new s(0,0,0);this.zPlane.intersectsLine(t,r),t=new l(r,s.subtract(this.sphere.center,r).normalize()),this.getTrackPoint(t,i,!1);var a=u.normal(this.sphere.center,i,this.startPoint,new s(0,0,0)),c=s.subtract(i,this.sphere.center).normalize(),d=s.cross(a,c).normalize(),p=s.subtract(i,d.multiply(s.subtract(r,i).abs()));t=new l(p,s.subtract(this.sphere.center,p).normalize()),this.getTrackPoint(t,i,!1)}this.trackPoint_changed_=i;var f=s.subtract(i,this.sphere.center),g=new o(this.fromVector,f);this.behind&&g.inverse(),this.rotation_changed_=o.multRight(this.startOffset,g)}catch(e){this.trackPoint_changed_.addEvent(),this.rotation_changed_.addEvent()}}}),d}),define("x_ite/Browser/Interpolation/CatmullRomSplineInterpolator",["standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4"],function(e,t){"use strict";function i(){this.T0=[],this.T1=[]}var n=[],r=[],s=[],o=new e(0,0,0,0),a=new t(2,-2,1,1,-3,3,-2,-1,0,0,1,0,1,0,0,0);return i.prototype={constructor:i,generate:function(e,t,i,o,a){var u=this.T0,l=this.T1;if(u.length=0,l.length=0,n.length=0,r.length=0,s.length=0,t.length>1){if(0===o.length){e?n.push(this.divide(this.subtract(i[1],i[i.length-2]),2)):n.push(this.create());for(var h=1,c=i.length-1;h<c;++h)n.push(this.divide(this.subtract(i[h+1],i[h-1]),2));n.push(this.copy(n[0]))}else{for(var h=0,c=o.length;h<c;++h)n.push(this.copy(o[h]));if(a){for(var d=0,h=0,c=i.length-1;h<c;++h)d+=this.abs(this.subtract(i[h],i[h+1]));for(var h=0,c=n.length-1;h<c;++h){var p=this.abs(n[h]);p&&(n[h]=this.multiply(n[h],d/p))}}}if(e){var f=t.length-1,g=t.length-2,m=t[1]-t[0]+t[f]-t[g];s.push(2*(t[1]-t[0])/m),r.push(2*(t[f]-t[g])/m)}else s.push(1),r.push(1);for(var h=1,c=t.length-1;h<c;++h){var m=t[h+1]-t[h-1];s.push(2*(t[h+1]-t[h])/m),r.push(2*(t[h]-t[h-1])/m)}s.push(s[0]),r.push(r[0]);for(var h=0,c=n.length;h<c;++h)u.push(this.multiply(n[h],r[h])),l.push(this.multiply(n[h],s[h]))}else u.push(this.create()),l.push(this.create())},interpolate:function(e,t,i,n){return o.set(Math.pow(i,3),Math.pow(i,2),i,1),this.dot(a.multVecMatrix(o),n[e],n[t],this.T0[e],this.T1[t])}},i}),define("x_ite/Browser/Interpolation/CatmullRomSplineInterpolatorTemplate",["x_ite/Browser/Interpolation/CatmullRomSplineInterpolator"],function(e){"use strict";return function(t){function i(){this.T0=[],this.T1=[]}var n=new t(0,0,0,0),r=new t(0,0,0,0),s=new t(0,0,0,0),o=new t(0,0,0,0);return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,create:function(){return new t(0,0,0,0)},copy:function(e){return e.copy()},subtract:function(e,i){return t.subtract(e,i)},multiply:function(e,i){return t.multiply(e,i)},divide:function(e,i){return t.divide(e,i)},abs:function(e){return e.abs()},dot:function(e,t,i,a,u){return n.assign(t).multiply(e[0]),r.assign(i).multiply(e[1]),s.assign(a).multiply(e[2]),o.assign(u).multiply(e[3]),n.add(r).add(s).add(o)}}),i}}),define("x_ite/Browser/Interpolation/CatmullRomSplineInterpolator3",["x_ite/Browser/Interpolation/CatmullRomSplineInterpolatorTemplate","standard/Math/Numbers/Vector3"],function(e,t){"use strict";return e(t)}),define("x_ite/Components/Interpolation/SplinePositionInterpolator",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Browser/Interpolation/CatmullRomSplineInterpolator3","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(s.SplinePositionInterpolator),this.spline=new r}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOnly,"set_fraction",new e.SFFloat),new t(s.inputOutput,"closed",new e.SFBool),new t(s.inputOutput,"key",new e.MFFloat),new t(s.inputOutput,"keyValue",new e.MFVec3f),new t(s.inputOutput,"keyVelocity",new e.MFVec3f),new t(s.inputOutput,"normalizeVelocity",new e.SFBool),new t(s.outputOnly,"value_changed",new e.SFVec3f)]),getTypeName:function(){return"SplinePositionInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this),this.keyVelocity_.addInterest("set_keyVelocity__",this),this.normalizeVelocity_.addInterest("set_normalizeVelocity__",this)},set_keyValue__:function(){var t=this.key_,i=this.keyValue_;i.length<t.length&&i.resize(t.length,i.length?i[i.length-1]:new e.SFVec3f),this.set_keyVelocity__()},set_keyVelocity__:function(){this.keyVelocity_.length&&this.keyVelocity_.length<this.key_.length&&this.keyVelocity_.resize(this.key_.length,new e.SFVec3f),this.set_normalizeVelocity__()},set_normalizeVelocity__:function(){this.spline.generate(this.closed_.getValue(),this.key_,this.keyValue_,this.keyVelocity_,this.normalizeVelocity_.getValue())},interpolate:function(e,t,i){this.value_changed_=this.spline.interpolate(e,t,i,this.keyValue_)}}),o}),define("x_ite/Browser/Interpolation/CatmullRomSplineInterpolator2",["x_ite/Browser/Interpolation/CatmullRomSplineInterpolatorTemplate","standard/Math/Numbers/Vector2"],function(e,t){"use strict";return e(t)}),define("x_ite/Components/Interpolation/SplinePositionInterpolator2D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Browser/Interpolation/CatmullRomSplineInterpolator2","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(s.SplinePositionInterpolator2D),this.spline=new r}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOnly,"set_fraction",new e.SFFloat),new t(s.inputOutput,"closed",new e.SFBool),new t(s.inputOutput,"key",new e.MFFloat),new t(s.inputOutput,"keyValue",new e.MFVec2f),new t(s.inputOutput,"keyVelocity",new e.MFVec2f),new t(s.inputOutput,"normalizeVelocity",new e.SFBool),new t(s.outputOnly,"value_changed",new e.SFVec2f)]),getTypeName:function(){return"SplinePositionInterpolator2D"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this),this.keyVelocity_.addInterest("set_keyVelocity__",this),this.normalizeVelocity_.addInterest("set_normalizeVelocity__",this)},set_keyValue__:function(){var t=this.key_,i=this.keyValue_;i.length<t.length&&i.resize(t.length,i.length?i[i.length-1]:new e.SFVec2f),this.set_keyVelocity__()},set_keyVelocity__:function(){this.keyVelocity_.length&&this.keyVelocity_.length<this.key_.length&&this.keyVelocity_.resize(this.key_.length,new e.SFVec2f),this.set_normalizeVelocity__()},set_normalizeVelocity__:function(){this.spline.generate(this.closed_.getValue(),this.key_,this.keyValue_,this.keyVelocity_,this.normalizeVelocity_.getValue())},interpolate:function(e,t,i){this.value_changed_=this.spline.interpolate(e,t,i,this.keyValue_)}}),o}),define("x_ite/Browser/Interpolation/CatmullRomSplineInterpolator1",["x_ite/Browser/Interpolation/CatmullRomSplineInterpolator"],function(e){"use strict";function t(){this.T0=[],this.T1=[]}return t.prototype=Object.assign(Object.create(e.prototype),{constructor:t,create:function(){return 0},copy:function(e){return e},subtract:function(e,t){return e-t},multiply:function(e,t){return e*t},divide:function(e,t){return e/t},abs:function(e){return Math.abs(e)},dot:function(e,t,i,n,r){return t*e[0]+i*e[1]+n*e[2]+r*e[3]}}),t}),define("x_ite/Components/Interpolation/SplineScalarInterpolator",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Browser/Interpolation/CatmullRomSplineInterpolator1","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(s.SplineScalarInterpolator),this.spline=new r}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOnly,"set_fraction",new e.SFFloat),new t(s.inputOutput,"closed",new e.SFBool),new t(s.inputOutput,"key",new e.MFFloat),new t(s.inputOutput,"keyValue",new e.MFFloat),new t(s.inputOutput,"keyVelocity",new e.MFFloat),new t(s.inputOutput,"normalizeVelocity",new e.SFBool),new t(s.outputOnly,"value_changed",new e.SFFloat)]),getTypeName:function(){return"SplineScalarInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this),this.keyVelocity_.addInterest("set_keyVelocity__",this),this.normalizeVelocity_.addInterest("set_normalizeVelocity__",this)},set_keyValue__:function(){var t=this.key_,i=this.keyValue_;i.length<t.length&&i.resize(t.length,i.length?i[i.length-1]:new e.SFFloat),this.set_keyVelocity__()},set_keyVelocity__:function(){this.keyVelocity_.length&&this.keyVelocity_.length<this.key_.length&&this.keyVelocity_.resize(this.key_.length,new e.SFFloat),this.set_normalizeVelocity__()},set_normalizeVelocity__:function(){this.spline.generate(this.closed_.getValue(),this.key_,this.keyValue_,this.keyVelocity_,this.normalizeVelocity_.getValue())},interpolate:function(e,t,i){this.value_changed_=this.spline.interpolate(e,t,i,this.keyValue_)}}),o}),define("x_ite/Components/Lighting/SpotLight",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Lighting/X3DLightNode","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Geometry/Box3","standard/Math/Geometry/Camera","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Utility/MatrixStack","standard/Math/Algorithm","standard/Utility/ObjectCache"],function(e,t,i,n,r,s,o,a,u,l,h,c,d,p,f,g,m){"use strict";function _(){this.location=new h(0,0,0),this.direction=new h(0,0,0),this.renderShadow=!0,this.shadowBuffer=null,this.bbox=new a,this.viewVolume=new l,this.viewport=new c(0,0,0,0),this.projectionMatrix=new p,this.modelViewMatrix=new f(p),this.modelMatrix=new p,this.invLightSpaceMatrix=new p,this.invLightSpaceProjectionMatrix=new p,this.shadowMatrix=new p,this.shadowMatrixArray=new Float32Array(16),this.invGroupMatrix=new p,this.rotation=new d,this.lightBBoxMin=new h(0,0,0),this.lightBBoxMax=new h(0,0,0),this.textureUnit=0}function x(e){n.call(this,e),this.addType(o.SpotLight),this.location_.setUnit("length"),this.radius_.setUnit("length"),this.beamWidth_.setUnit("angle"),this.cutOffAngle_.setUnit("angle")}var y=m(_);return _.prototype={constructor:_,getModelViewMatrix:function(){return this.modelViewMatrix},set:function(e,t,i,n){var r=e.getContext(),s=t.getShadowMapSize();this.browser=e,this.lightNode=t,this.groupNode=i,this.modelViewMatrix.pushMatrix(n),t.getShadowIntensity()>0&&s>0&&(this.shadowBuffer=e.popShadowBuffer(s),this.shadowBuffer?e.getCombinedTextureUnits().length?(this.textureUnit=e.getCombinedTextureUnits().pop(),r.activeTexture(r.TEXTURE0+this.textureUnit),e.getExtension("WEBGL_depth_texture")?r.bindTexture(r.TEXTURE_2D,this.shadowBuffer.getDepthTexture()):r.bindTexture(r.TEXTURE_2D,this.shadowBuffer.getColorTexture()),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.activeTexture(r.TEXTURE0)):console.warn("Not enough combined texture units for shadow map available."):console.warn("Couldn't create shadow buffer."))},renderShadowMap:function(e){try{if(!this.shadowBuffer)return;var t=this.lightNode,i=e.getCameraSpaceMatrix().get(),n=this.modelMatrix.assign(this.modelViewMatrix.get()).multRight(i),o=this.invLightSpaceMatrix.assign(t.getGlobal()?n:p.Identity);o.translate(t.getLocation()),o.rotate(this.rotation.setFromToVec(h.zAxis,this.direction.assign(t.getDirection()).negate())),o.inverse();var a=r.prototype.getBBox.call(this.groupNode,this.bbox),l=(a.multRight(o),t.getShadowMapSize()),c=Math.min(t.getRadius(),-this.lightBBoxMin.z),d=this.viewport.set(0,0,l,l),f=u.perspective(2*t.getCutOffAngle(),.125,Math.max(1e4,c),l,l,this.projectionMatrix),g=this.invGroupMatrix.assign(this.groupNode.getMatrix()).inverse();this.renderShadow=c>0,this.shadowBuffer.bind(),e.getViewVolumes().push(this.viewVolume.set(f,d,d)),e.getProjectionMatrix().pushMatrix(f),e.getModelViewMatrix().pushMatrix(o),e.getModelViewMatrix().multLeft(g),e.render(s.DEPTH,this.groupNode),e.getModelViewMatrix().pop(),e.getProjectionMatrix().pop(),e.getViewVolumes().pop(),this.shadowBuffer.unbind(),t.getGlobal()||o.multLeft(n.inverse()),this.invLightSpaceProjectionMatrix.assign(o).multRight(f).multRight(t.getBiasMatrix())}catch(e){console.log(e)}},setGlobalVariables:function(e){var t=this.lightNode,i=this.modelViewMatrix.get();i.multVecMatrix(this.location.assign(t.location_.getValue())),i.multDirMatrix(this.direction.assign(t.direction_.getValue())).normalize(),this.shadowMatrix.assign(e.getCameraSpaceMatrix().get()).multRight(this.invLightSpaceProjectionMatrix),this.shadowMatrixArray.set(this.shadowMatrix)},setShaderUniforms:function(e,t){var i=this.lightNode,n=i.getColor(),r=i.getAttenuation(),s=this.location,o=this.direction,a=i.getShadowColor(),u=t.numLights++;e.uniform1i(t.x3d_LightType[u],3),e.uniform3f(t.x3d_LightColor[u],n.r,n.g,n.b),e.uniform1f(t.x3d_LightIntensity[u],i.getIntensity()),e.uniform1f(t.x3d_LightAmbientIntensity[u],i.getAmbientIntensity()),e.uniform3f(t.x3d_LightAttenuation[u],Math.max(0,r.x),Math.max(0,r.y),Math.max(0,r.z)),e.uniform3f(t.x3d_LightLocation[u],s.x,s.y,s.z),e.uniform3f(t.x3d_LightDirection[u],o.x,o.y,o.z),e.uniform1f(t.x3d_LightRadius[u],i.getRadius()),e.uniform1f(t.x3d_LightBeamWidth[u],i.getBeamWidth()),e.uniform1f(t.x3d_LightCutOffAngle[u],i.getCutOffAngle()),this.renderShadow&&this.textureUnit&&(e.uniform3f(t.x3d_ShadowColor[u],a.r,a.g,a.b),e.uniform1f(t.x3d_ShadowIntensity[u],i.getShadowIntensity()),e.uniform1f(t.x3d_ShadowBias[u],i.getShadowBias()),e.uniformMatrix4fv(t.x3d_ShadowMatrix[u],!1,this.shadowMatrixArray),e.uniform1i(t.x3d_ShadowMapSize[u],i.getShadowMapSize()),e.uniform1i(t.x3d_ShadowMap[u],this.textureUnit))},dispose:function(){this.textureUnit&&this.browser.getCombinedTextureUnits().push(this.textureUnit),this.browser.pushShadowBuffer(this.shadowBuffer),this.modelViewMatrix.clear(),this.browser=null,this.lightNode=null,this.groupNode=null,this.shadowBuffer=null,this.textureUnit=0,y.push(this)}},x.prototype=Object.assign(Object.create(n.prototype),{constructor:x,fieldDefinitions:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"global",new e.SFBool(!0)),new t(o.inputOutput,"on",new e.SFBool(!0)),new t(o.inputOutput,"color",new e.SFColor(1,1,1)),new t(o.inputOutput,"intensity",new e.SFFloat(1)),new t(o.inputOutput,"ambientIntensity",new e.SFFloat),new t(o.inputOutput,"attenuation",new e.SFVec3f(1,0,0)),new t(o.inputOutput,"location",new e.SFVec3f),new t(o.inputOutput,"direction",new e.SFVec3f(0,0,-1)),new t(o.inputOutput,"radius",new e.SFFloat(100)),new t(o.inputOutput,"beamWidth",new e.SFFloat(.785398)),new t(o.inputOutput,"cutOffAngle",new e.SFFloat(1.5708)),new t(o.inputOutput,"shadowColor",new e.SFColor),new t(o.inputOutput,"shadowIntensity",new e.SFFloat),new t(o.inputOutput,"shadowBias",new e.SFFloat(.005)),new t(o.initializeOnly,"shadowMapSize",new e.SFInt32(1024))]),getTypeName:function(){return"SpotLight"},getComponentName:function(){return"Lighting"},getContainerField:function(){return"children"},getAttenuation:function(){return this.attenuation_.getValue()},getLocation:function(){return this.location_.getValue()},getRadius:function(){return Math.max(0,this.radius_.getValue())},getBeamWidth:function(){var e=this.beamWidth_.getValue(),t=this.getCutOffAngle();return e>t?t:g.clamp(e,0,Math.PI/2)},getCutOffAngle:function(){return g.clamp(this.cutOffAngle_.getValue(),0,Math.PI/2)},getLights:function(){return y}}),x}),define("x_ite/Browser/Interpolation/SquatInterpolator",["standard/Math/Numbers/Rotation4"],function(e){"use strict";function t(){this.s=[]}var i=new e(0,0,1,0);return t.prototype={constructor:t,generate:function(t,i,n){var r=this.s;if(r.length=0,i.length>1){t?r.push(e.spline(n[i.length-2].getValue(),n[0].getValue(),n[1].getValue())):r.push(n[0].getValue());for(var s=1,o=i.length-1;s<o;++s)r.push(e.spline(n[s-1].getValue(),n[s].getValue(),n[s+1].getValue()));t?r.push(e.spline(n[i.length-2].getValue(),n[i.length-1].getValue(),n[1].getValue())):r.push(n[i.length-1].getValue())}else i.length>0&&r.push(n[0].getValue().copy())},interpolate:function(e,t,n,r){return i.assign(r[e].getValue()).squad(this.s[e],this.s[t],r[t].getValue(),n)}},t}),define("x_ite/Components/Interpolation/SquadOrientationInterpolator",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Browser/Interpolation/SquatInterpolator","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(s.SquadOrientationInterpolator),this.squad=new r}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOnly,"set_fraction",new e.SFFloat),new t(s.inputOutput,"closed",new e.SFBool),new t(s.inputOutput,"key",new e.MFFloat),new t(s.inputOutput,"keyValue",new e.MFRotation),new t(s.outputOnly,"value_changed",new e.SFRotation)]),getTypeName:function(){return"SquadOrientationInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){var t=this.key_,i=this.keyValue_;i.length<t.length&&i.resize(t.length,i.length?i[i.length-1]:new e.SFRotation),this.squad.generate(this.closed_.getValue(),this.key_,this.keyValue_)},interpolate:function(e,t,i){try{this.value_changed_=this.squad.interpolate(e,t,i,this.keyValue_)}catch(e){console.log(e)}}}),o}),define("x_ite/Components/Grouping/StaticGroup",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Components/Grouping/Group","x_ite/Bits/X3DConstants","x_ite/Bits/TraverseType","standard/Math/Geometry/Box3","standard/Math/Geometry/ViewVolume"],function(e,t,i,n,r,s,o,a,u,l){"use strict";function h(e){n.call(this,e),r.call(this,e),this.addType(o.StaticGroup),this.group=new s(this.getExecutionContext()),this.collisionShapes=null,this.depthShapes=null,this.opaqueShapes=null,
this.transparentShapes=null,this.bbox=new u}return h.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:h,fieldDefinitions:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(o.initializeOnly,"bboxCenter",new e.SFVec3f),new t(o.initializeOnly,"children",new e.MFNode)]),getTypeName:function(){return"StaticGroup"},getComponentName:function(){return"Grouping"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this),this.bboxSize_.addFieldInterest(this.group.bboxSize_),this.bboxCenter_.addFieldInterest(this.group.bboxCenter_),this.children_.addFieldInterest(this.group.children_),this.group.bboxSize_=this.bboxSize_,this.group.bboxCenter_=this.bboxCenter_,this.group.children_=this.children_,this.group.setPrivate(!0),this.group.setup(),this.group.isCameraObject_.addFieldInterest(this.isCameraObject_),this.group.children_.addInterest("set_children__",this),this.set_children__()},getBBox:function(e){return e.assign(this.bbox)},set_children__:function(){this.group.getBBox(this.bbox),this.collisionShapes=null,this.depthShapes=null,this.opaqueShapes=null,this.transparentShapes=null},traverse:function(){var e=new l;return e.intersectsSphere=function(){return!0},function(t,i){switch(t){case a.CAMERA:break;case a.POINTER:case a.COLLISION:if(!this.collisionShapes){var n=i.getViewVolumes(),r=i.getViewport(),s=i.getProjectionMatrix(),o=i.getModelViewMatrix(),u=i.getNumCollisionShapes();n.push(e.set(s,r,r)),o.push(),o.identity(),this.group.traverse(t,i),o.pop(),n.pop();var l=i.getNumCollisionShapes();this.collisionShapes=i.getCollisionShapes().splice(u,l-u),i.setNumCollisionShapes(u)}for(var h=this.collisionShapes,o=i.getModelViewMatrix(),c=0,d=h.length;c<d;++c){var p=h[c];o.push(),o.multLeft(p.modelViewMatrix),p.shapeNode.traverse(t,i),o.pop()}break;case a.DEPTH:if(!this.depthShapes){var n=i.getViewVolumes(),r=i.getViewport(),s=i.getProjectionMatrix(),o=i.getModelViewMatrix(),f=i.getNumDepthShapes();n.push(e.set(s,r,r)),o.push(),o.identity(),this.group.traverse(t,i),o.pop(),n.pop();var g=i.getNumDepthShapes();this.depthShapes=i.getDepthShapes().splice(f,g-f),i.setNumDepthShapes(f)}for(var m=this.depthShapes,o=i.getModelViewMatrix(),c=0,d=m.length;c<d;++c){var _=m[c];o.push(),o.multLeft(_.modelViewMatrix),_.shapeNode.traverse(t,i),o.pop()}break;case a.DISPLAY:if(!this.opaqueShapes){var n=i.getViewVolumes(),r=i.getViewport(),s=i.getProjectionMatrix(),o=i.getModelViewMatrix(),x=i.getNumOpaqueShapes(),y=i.getNumTransparentShapes();n.push(e.set(s,r,r)),o.push(),o.identity(),this.group.traverse(t,i),o.pop(),n.pop();var v=i.getNumOpaqueShapes(),w=i.getNumTransparentShapes();this.opaqueShapes=i.getOpaqueShapes().splice(x,v-x),this.transparentShapes=i.getTransparentShapes().splice(y,w-y),i.setNumOpaqueShapes(x),i.setNumTransparentShapes(y)}for(var b=this.opaqueShapes,S=this.transparentShapes,o=i.getModelViewMatrix(),c=0,d=b.length;c<d;++c){var C=b[c];o.push(),o.multLeft(C.modelViewMatrix),C.shapeNode.traverse(t,i),o.pop()}for(var c=0,d=S.length;c<d;++c){var T=S[c];o.push(),o.multLeft(T.modelViewMatrix),T.shapeNode.traverse(t,i),o.pop()}}}}()}),h}),define("x_ite/Components/KeyDeviceSensor/StringSensor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/KeyDeviceSensor/X3DKeyDeviceSensorNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.StringSensor)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"enabled",new e.SFBool(!0)),new t(r.inputOutput,"deletionAllowed",new e.SFBool(!0)),new t(r.outputOnly,"enteredText",new e.SFString),new t(r.outputOnly,"finalText",new e.SFString),new t(r.outputOnly,"isActive",new e.SFBool)]),getTypeName:function(){return"StringSensor"},getComponentName:function(){return"KeyDeviceSensor"},getContainerField:function(){return"children"},keydown:function(e){switch(e.preventDefault(),e.key){case"Backspace":this.isActive_.getValue()&&this.deletionAllowed_.getValue()&&this.enteredText_.length&&(this.enteredText_=this.enteredText_.getValue().substr(0,this.enteredText_.length-1));break;case"Enter":this.finalText_=this.enteredText_,this.enteredText_.set(""),this.isActive_.getValue()&&(this.isActive_=!1);break;case"Escape":this.enteredText_.set(""),this.isActive_.getValue()&&(this.isActive_=!1);break;case"Tab":break;default:(e.charCode||e.keyCode)&&1===e.key.length&&(this.isActive_.getValue()||(this.isActive_=!0,this.enteredText_=""),this.enteredText_=this.enteredText_.getValue()+e.key)}}}),s}),define("x_ite/Components/ParticleSystems/SurfaceEmitter",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/ParticleSystems/X3DParticleEmitterNode","x_ite/Bits/X3DConstants","x_ite/Bits/X3DCast","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(e,t,i,n,r,s,o,a,u){"use strict";function l(e){n.call(this,e),this.addType(r.SurfaceEmitter),this.speed_.setUnit("speed"),this.mass_.setUnit("mass"),this.surfaceArea_.setUnit("area"),this.surfaceNode=null,this.areaSoFarArray=[0]}function h(e){return e.set(0,0,0)}var c=new a(0,0,0),d=new a(0,0,0),p=new a(0,0,0),f=new a(0,0,0);return l.prototype=Object.assign(Object.create(n.prototype),{constructor:l,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"speed",new e.SFFloat),new t(r.inputOutput,"variation",new e.SFFloat(.25)),new t(r.initializeOnly,"mass",new e.SFFloat),new t(r.initializeOnly,"surfaceArea",new e.SFFloat),new t(r.initializeOnly,"surface",new e.SFNode)]),getTypeName:function(){return"SurfaceEmitter"},getComponentName:function(){return"ParticleSystems"},getContainerField:function(){return"emitter"},initialize:function(){n.prototype.initialize.call(this),this.surface_.addInterest("set_surface__",this),this.set_surface__()},set_surface__:function(){this.surfaceNode&&this.surfaceNode.removeInterest("set_geometry__",this),this.surfaceNode=s(r.X3DGeometryNode,this.surface_),this.surfaceNode&&this.surfaceNode.addInterest("set_geometry__",this),this.set_geometry__()},set_geometry__:function(){if(this.surfaceNode){delete this.getRandomPosition,delete this.getRandomVelocity;var e=0,t=this.areaSoFarArray,i=this.surfaceNode.getVertices().getValue();this.normals=this.surfaceNode.getNormals().getValue(),this.vertices=i,t.length=1;for(var n=0,r=i.length;n<r;n+=12)c.set(i[n],i[n+1],i[n+2]),d.set(i[n+4],i[n+5],i[n+6]),p.set(i[n+8],i[n+9],i[n+10]),e+=o.area(c,d,p),t.push(e)}else this.getRandomPosition=h,this.getRandomVelocity=this.getSphericalRandomVelocity,f.set(0,0,0)},getRandomPosition:function(e){var t=this.areaSoFarArray,i=t.length,n=Math.random()*t[i-1],r=0;if(1==i||n<=t[0])r=0;else if(n>=t[i-1])r=i-2;else{var s=u.upperBound(t,0,i,n,u.less);r=s<i?s-1:0}var o=Math.random(),a=Math.random();o+a>1&&(o=1-o,a=1-a);var l=12*r,h=this.vertices,c=1-o-a;e.x=o*h[l]+a*h[l+4]+c*h[l+8],e.y=o*h[l+1]+a*h[l+5]+c*h[l+9],e.z=o*h[l+2]+a*h[l+6]+c*h[l+10];var l=9*r,d=this.normals;return f.x=o*d[l]+a*d[l+3]+c*d[l+6],f.y=o*d[l+1]+a*d[l+4]+c*d[l+7],f.z=o*d[l+2]+a*d[l+5]+c*d[l+8],e},getRandomVelocity:function(e){var t=this.getRandomSpeed();return e.x=f.x*t,e.y=f.y*t,e.z=f.z*t,e}}),l}),define("x_ite/Components/Grouping/Switch",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(s.Switch),"2.0"==e.getSpecificationVersion()&&this.addAlias("choice",this.children_)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"whichChoice",new e.SFInt32(-1)),new t(s.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(s.initializeOnly,"bboxCenter",new e.SFVec3f),new t(s.inputOnly,"addChildren",new e.MFNode),new t(s.inputOnly,"removeChildren",new e.MFNode),new t(s.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"Switch"},getComponentName:function(){return"Grouping"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.whichChoice_.addInterest("set_whichChoice__",this),this.set_whichChoice__()},getBBox:function(e){if(this.bboxSize_.getValue().equals(this.defaultBBoxSize)){var t=r(s.X3DBoundedObject,this.child);return t?t.getBBox(e):e.set()}return e.set(this.bboxSize_.getValue(),this.bboxCenter_.getValue())},set_whichChoice__:function(){this.set_cameraObjects__()},set_cameraObjects__:function(){this.child=this.getChild(this.whichChoice_.getValue()),this.child&&this.child.getCameraObject?this.setCameraObject(this.child.getCameraObject()):this.setCameraObject(!1)},traverse:function(e,t){this.child&&this.child.traverse(e,t)}}),o}),define("x_ite/Components/Followers/TexCoordChaser2D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Browser/Followers/X3DArrayChaserTemplate","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2"],function(e,t,i,n,r,s,o){"use strict";function a(e){n.call(this,e),u.call(this,e),this.addType(s.TexCoordChaser2D)}var u=r(n);return a.prototype=Object.assign(Object.create(n.prototype),u.prototype,{constructor:a,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOnly,"set_value",new e.MFVec2f),new t(s.inputOnly,"set_destination",new e.MFVec2f),new t(s.initializeOnly,"initialValue",new e.MFVec2f),new t(s.initializeOnly,"initialDestination",new e.MFVec2f),new t(s.initializeOnly,"duration",new e.SFTime(1)),new t(s.outputOnly,"isActive",new e.SFBool),new t(s.outputOnly,"value_changed",new e.MFVec2f)]),getTypeName:function(){return"TexCoordChaser2D"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new o(0,0)},getArray:function(){return new e.MFVec2f}}),a}),define("x_ite/Components/Followers/TexCoordDamper2D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Browser/Followers/X3DArrayFollowerTemplate","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2"],function(e,t,i,n,r,s,o){"use strict";function a(e){n.call(this,e),u.call(this,e),this.addType(s.TexCoordDamper2D)}var u=r(n);return a.prototype=Object.assign(Object.create(n.prototype),u.prototype,{constructor:a,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOnly,"set_value",new e.MFVec2f),new t(s.inputOnly,"set_destination",new e.MFVec2f),new t(s.initializeOnly,"initialValue",new e.MFVec2f),new t(s.initializeOnly,"initialDestination",new e.MFVec2f),new t(s.initializeOnly,"order",new e.SFInt32(3)),new t(s.inputOutput,"tau",new e.SFTime(.3)),new t(s.inputOutput,"tolerance",new e.SFFloat(-1)),new t(s.outputOnly,"isActive",new e.SFBool),new t(s.outputOnly,"value_changed",new e.MFVec2f)]),getTypeName:function(){return"TexCoordDamper2D"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new o(0,0,0)},getArray:function(){return new e.MFVec2f}}),a}),define("x_ite/Components/Text/Text",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(s.Text),this.length_.setUnit("length"),this.maxExtent_.setUnit("length"),this.origin_.setUnit("length"),this.textBounds_.setUnit("length"),this.lineBounds_.setUnit("length")}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"string",new e.MFString),new t(s.inputOutput,"length",new e.MFFloat),new t(s.inputOutput,"maxExtent",new e.SFFloat),new t(s.initializeOnly,"solid",new e.SFBool),new t(s.outputOnly,"origin",new e.SFVec3f),new t(s.outputOnly,"textBounds",new e.SFVec2f),new t(s.outputOnly,"lineBounds",new e.MFVec2f),new t(s.inputOutput,"fontStyle",new e.SFNode)]),getTypeName:function(){return"Text"},getComponentName:function(){return"Text"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this.fontStyle_.addInterest("set_fontStyle__",this),this.set_fontStyle__(),this.eventsProcessed()},getMatrix:function(){return this.textGeometry.getMatrix()},getLength:function(e){return e<this.length_.length?Math.max(0,this.length_[e]):0},set_live__:function(){n.prototype.set_live__.call(this),this.isLive().getValue()?this.getBrowser().getBrowserOptions().PrimitiveQuality_.addInterest("eventsProcessed",this):this.getBrowser().getBrowserOptions().PrimitiveQuality_.removeInterest("eventsProcessed",this)},set_fontStyle__:function(){this.fontStyleNode&&this.fontStyleNode.removeInterest("addNodeEvent",this),this.fontStyleNode=r(s.X3DFontStyleNode,this.fontStyle_),this.fontStyleNode||(this.fontStyleNode=this.getBrowser().getDefaultFontStyle()),this.fontStyleNode.addInterest("addNodeEvent",this),this.textGeometry=this.fontStyleNode.getTextGeometry(this)},build:function(){this.textGeometry.update(),this.textGeometry.build(),this.setSolid(this.solid_.getValue())},traverse:function(e,t){try{this.textGeometry.traverse(e,t),n.prototype.traverse.call(this,e,t)}catch(e){console.log(e)}},display:function(e,t){try{this.textGeometry.display(e,t),n.prototype.display.call(this,e,t)}catch(e){console.log(e)}},transformLine:function(e){return this.textGeometry.transformLine(e)},transformMatrix:function(e){return this.textGeometry.transformMatrix(e)}}),o}),define("x_ite/Components/EnvironmentalEffects/TextureBackground",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/EnvironmentalEffects/X3DBackgroundNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(s.TextureBackground)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOnly,"set_bind",new e.SFBool),new t(s.inputOutput,"skyAngle",new e.MFFloat),new t(s.inputOutput,"skyColor",new e.MFColor(0,0,0)),new t(s.inputOutput,"groundAngle",new e.MFFloat),new t(s.inputOutput,"groundColor",new e.MFColor),new t(s.inputOutput,"transparency",new e.SFFloat),new t(s.outputOnly,"isBound",new e.SFBool),new t(s.outputOnly,"bindTime",new e.SFTime),new t(s.inputOutput,"frontTexture",new e.SFNode),new t(s.inputOutput,"backTexture",new e.SFNode),new t(s.inputOutput,"leftTexture",new e.SFNode),new t(s.inputOutput,"rightTexture",new e.SFNode),new t(s.inputOutput,"topTexture",new e.SFNode),new t(s.inputOutput,"bottomTexture",new e.SFNode)]),getTypeName:function(){return"TextureBackground"},getComponentName:function(){return"EnvironmentalEffects"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.frontTexture_.addInterest("set_frontTexture__",this),this.backTexture_.addInterest("set_backTexture__",this),this.leftTexture_.addInterest("set_leftTexture__",this),this.rightTexture_.addInterest("set_rightTexture__",this),this.topTexture_.addInterest("set_topTexture__",this),this.bottomTexture_.addInterest("set_bottomTexture__",this),this.set_frontTexture__(this.frontTexture_),this.set_backTexture__(this.backTexture_),this.set_leftTexture__(this.leftTexture_),this.set_rightTexture__(this.rightTexture_),this.set_topTexture__(this.topTexture_),this.set_bottomTexture__(this.bottomTexture_)},set_frontTexture__:function(){n.prototype.set_frontTexture__.call(this,r(s.X3DTextureNode,this.frontTexture_))},set_backTexture__:function(){n.prototype.set_backTexture__.call(this,r(s.X3DTextureNode,this.backTexture_))},set_leftTexture__:function(){n.prototype.set_leftTexture__.call(this,r(s.X3DTextureNode,this.leftTexture_))},set_rightTexture__:function(){n.prototype.set_rightTexture__.call(this,r(s.X3DTextureNode,this.rightTexture_))},set_topTexture__:function(){n.prototype.set_topTexture__.call(this,r(s.X3DTextureNode,this.topTexture_))},set_bottomTexture__:function(){n.prototype.set_bottomTexture__.call(this,r(s.X3DTextureNode,this.bottomTexture_))}}),o}),define("x_ite/Components/Texturing3D/TextureCoordinate3D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Texturing/X3DTextureCoordinateNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.TextureCoordinate3D)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"point",new e.MFVec3f)]),getTypeName:function(){return"TextureCoordinate3D"},getComponentName:function(){return"Texturing3D"},getContainerField:function(){return"texCoord"},initialize:function(){n.prototype.initialize.call(this),this.point_.addInterest("set_point__",this),this.set_point__()},set_point__:function(){this.point=this.point_.getValue(),this.length=this.point_.length},addTexCoordToChannel:function(e,t){if(e>=0&&e<this.length){var i=this.point;e*=3,t.push(i[e],i[e+1],i[e+2],1)}else t.push(0,0,0,1)},getTexCoord:function(e){for(var t=this.point_,i=0,n=t.length;i<n;++i){var r=t[i];e[i]=new Vector4(r.x,r.y,r.z,1)}return e.length=n,e}}),s}),define("x_ite/Components/Texturing3D/TextureCoordinate4D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Texturing/X3DTextureCoordinateNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.TextureCoordinate4D)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"point",new e.MFVec4f)]),getTypeName:function(){return"TextureCoordinate4D"},getComponentName:function(){return"Texturing3D"},getContainerField:function(){return"texCoord"},initialize:function(){n.prototype.initialize.call(this),this.point_.addInterest("set_point__",this),this.set_point__()},set_point__:function(){this.point=this.point_.getValue(),this.length=this.point_.length},addTexCoordToChannel:function(e,t){if(e>=0&&e<this.length){var i=this.point;e*=4,t.push(i[e],i[e+1],i[e+2],i[e+3])}else t.push(0,0,0,1)},getTexCoord:function(e){for(var t=this.point_,i=0,n=t.length;i<n;++i){var r=t[i];e[i]=new Vector4(r.x,r.y,r.z,r.w)}return e.length=n,e}}),s}),define("x_ite/Components/Texturing3D/TextureTransform3D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Texturing/X3DTextureTransformNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4"],function(e,t,i,n,r,s,o){"use strict";function a(e){n.call(this,e),this.addType(r.TextureTransform3D)}var u=new s(0,0,0);return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"translation",new e.SFVec3f),new t(r.inputOutput,"rotation",new e.SFRotation),new t(r.inputOutput,"scale",new e.SFVec3f(1,1,1)),new t(r.inputOutput,"center",new e.SFVec3f)]),getTypeName:function(){return"TextureTransform3D"},getComponentName:function(){return"Texturing3D"},getContainerField:function(){return"textureTransform"},initialize:function(){n.prototype.initialize.call(this),this.addInterest("eventsProcessed",this),this.eventsProcessed()},eventsProcessed:function(){n.prototype.eventsProcessed.call(this);var e=this.translation_.getValue(),t=this.rotation_.getValue(),i=this.scale_.getValue(),r=this.center_.getValue(),a=this.getMatrix();a.identity(),r.equals(s.Zero)||a.translate(u.assign(r).negate()),i.equals(s.One)||a.scale(i),t.equals(o.Identity)||a.rotate(t),r.equals(s.Zero)||a.translate(r),e.equals(s.Zero)||a.translate(e),this.setMatrix(a)}}),a}),define("x_ite/Components/Texturing3D/TextureTransformMatrix3D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Texturing/X3DTextureTransformNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.TextureTransformMatrix3D)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"matrix",new e.SFMatrix4f(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1))]),getTypeName:function(){return"TextureTransformMatrix3D"},getComponentName:function(){return"Texturing3D"},getContainerField:function(){return"textureTransform"},eventsProcessed:function(){n.prototype.eventsProcessed.call(this);var e=this.getMatrix();e.assign(this.matrix_.getValue()),this.setMatrix(e)}}),s}),define("x_ite/Components/EventUtilities/TimeTrigger",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/EventUtilities/X3DTriggerNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.TimeTrigger)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_boolean",new e.SFBool),new t(r.outputOnly,"triggerTime",new e.SFTime)]),getTypeName:function(){return"TimeTrigger"},getComponentName:function(){return"EventUtilities"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.set_boolean_.addInterest("set_boolean__",this)},set_boolean__:function(){this.triggerTime_=this.getBrowser().getCurrentTime()}}),s}),define("x_ite/Components/Grouping/Transform",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DTransformNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.Transform)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"translation",new e.SFVec3f),new t(r.inputOutput,"rotation",new e.SFRotation),new t(r.inputOutput,"scale",new e.SFVec3f(1,1,1)),new t(r.inputOutput,"scaleOrientation",new e.SFRotation),new t(r.inputOutput,"center",new e.SFVec3f),new t(r.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(r.initializeOnly,"bboxCenter",new e.SFVec3f),new t(r.inputOnly,"addChildren",new e.MFNode),new t(r.inputOnly,"removeChildren",new e.MFNode),new t(r.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"Transform"},getComponentName:function(){return"Grouping"},getContainerField:function(){return"children"}}),s}),define("x_ite/Components/EnvironmentalSensor/TransformSensor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode","x_ite/Bits/X3DConstants","x_ite/Bits/X3DCast","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Geometry/Box3"],function(e,t,i,n,r,s,o,a,u){"use strict";function l(e){n.call(this,e),this.addType(r.TransformSensor),this.position_changed_.setUnit("length"),this.bbox=new u,this.targetObjectNode=null}var h=new u,c=new o(0,0,0),d=new a(0,0,1,0),p=new o(-1,-1,-1);return l.prototype=Object.assign(Object.create(n.prototype),{constructor:l,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"enabled",new e.SFBool(!0)),new t(r.inputOutput,"size",new e.SFVec3f),new t(r.inputOutput,"center",new e.SFVec3f),new t(r.outputOnly,"enterTime",new e.SFTime),new t(r.outputOnly,"exitTime",new e.SFTime),new t(r.outputOnly,"isActive",new e.SFBool),new t(r.outputOnly,"position_changed",new e.SFVec3f),new t(r.outputOnly,"orientation_changed",new e.SFRotation),new t(r.inputOutput,"targetObject",new e.SFNode)]),getTypeName:function(){return"TransformSensor"},getComponentName:function(){return"EnvironmentalSensor"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.isLive().addInterest("set_enabled__",this),this.enabled_.addInterest("set_enabled__",this),this.size_.addInterest("set_enabled__",this),this.size_.addInterest("set_bbox__",this),this.center_.addInterest("set_bbox__",this),this.targetObject_.addInterest("set_targetObject__",this),this.set_bbox__(),this.set_targetObject__()},set_live__:function(){},set_enabled__:function(){this.isLive().getValue()&&this.targetObjectNode&&this.enabled_.getValue()&&!this.size_.getValue().equals(o.Zero)?this.getBrowser().sensorEvents().addInterest("update",this):(this.getBrowser().sensorEvents().removeInterest("update",this),this.isActive_.getValue()&&(this.isActive_=!1,this.exitTime_=this.getBrowser().getCurrentTime()))},set_bbox__:function(){this.bbox.set(this.size_.getValue(),this.center_.getValue())},set_targetObject__:function(){this.targetObjectNode=s(r.X3DBoundedObject,this.targetObject_),this.set_enabled__()},update:function(){this.targetObjectNode.getBBox(h),this.size_.getValue().equals(p)||this.bbox.intersectsBox(h)?(h.getMatrix().get(c,d),this.isActive_.getValue()?(this.position_changed_.getValue().equals(c)||(this.position_changed_=c),this.orientation_changed_.getValue().equals(d)||(this.orientation_changed_=d)):(this.isActive_=!0,this.enterTime_=this.getBrowser().getCurrentTime(),this.position_changed_=c,this.orientation_changed_=d)):this.isActive_.getValue()&&(this.isActive_=!1,this.exitTime_=this.getBrowser().getCurrentTime())}}),l}),define("x_ite/Components/Rendering/TriangleFanSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.TriangleFanSet),this.triangleIndex=[]}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"solid",new e.SFBool(!0)),new t(r.initializeOnly,"ccw",new e.SFBool(!0)),new t(r.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new t(r.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new t(r.inputOutput,"fanCount",new e.MFInt32),new t(r.inputOutput,"attrib",new e.MFNode),new t(r.inputOutput,"fogCoord",new e.SFNode),new t(r.inputOutput,"color",new e.SFNode),new t(r.inputOutput,"texCoord",new e.SFNode),new t(r.inputOutput,"normal",new e.SFNode),new t(r.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"TriangleFanSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this.fanCount_.addInterest("set_fanCount__",this),this.set_fanCount__()},set_fanCount__:function(){var e=this.fanCount_,t=this.triangleIndex;t.length=0;for(var i=0,n=e.length,r=0;i<n;++i){for(var s=e[i],o=1,a=s-1;o<a;++o)t.push(r,r+o,r+o+1);r+=s}},getPolygonIndex:function(e){return this.triangleIndex[e]},build:function(){n.prototype.build.call(this,3,this.triangleIndex.length,3,this.triangleIndex.length)}}),s});define("x_ite/Components/Rendering/TriangleSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.TriangleSet)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"solid",new e.SFBool(!0)),new t(r.initializeOnly,"ccw",new e.SFBool(!0)),new t(r.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new t(r.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new t(r.inputOutput,"attrib",new e.MFNode),new t(r.inputOutput,"fogCoord",new e.SFNode),new t(r.inputOutput,"color",new e.SFNode),new t(r.inputOutput,"texCoord",new e.SFNode),new t(r.inputOutput,"normal",new e.SFNode),new t(r.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"TriangleSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},build:function(){this.getCoord()&&n.prototype.build.call(this,3,this.getCoord().getSize(),3,this.getCoord().getSize())},createNormals:function(e,t){return this.createFaceNormals(e,t)}}),s}),define("x_ite/Components/Geometry2D/TriangleSet2D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(r.TriangleSet2D),this.setGeometryType(2),this.vertices_.setUnit("length")}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"vertices",new e.MFVec2f),new t(r.initializeOnly,"solid",new e.SFBool)]),getTypeName:function(){return"TriangleSet2D"},getComponentName:function(){return"Geometry2D"},getContainerField:function(){return"geometry"},build:function(){for(var e=this.vertices_.getValue(),t=this.getNormals(),i=this.getVertices(),n=0,r=2*this.vertices_.length;n<r;n+=2)t.push(0,0,1),i.push(e[n],e[n+1],0,1);this.setSolid(this.solid_.getValue())},buildTexCoords:function(){var e=this.getTexCoordParams(),t=e.min,i=e.Ssize,n=this.getTexCoords(),r=this.getVertices().getValue();this.getMultiTexCoords().push(n);for(var s=0,o=r.length;s<o;s+=4)n.push((r[s]-t[0])/i,(r[s+1]-t[1])/i,0,1)}}),o}),define("x_ite/Components/Rendering/TriangleStripSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.TriangleStripSet),this.triangleIndex=[]}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"solid",new e.SFBool(!0)),new t(r.initializeOnly,"ccw",new e.SFBool(!0)),new t(r.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new t(r.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new t(r.inputOutput,"stripCount",new e.MFInt32),new t(r.inputOutput,"attrib",new e.MFNode),new t(r.inputOutput,"fogCoord",new e.SFNode),new t(r.inputOutput,"color",new e.SFNode),new t(r.inputOutput,"texCoord",new e.SFNode),new t(r.inputOutput,"normal",new e.SFNode),new t(r.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"TriangleStripSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this.stripCount_.addInterest("set_stripCount__",this),this.set_stripCount__()},set_stripCount__:function(){var e=this.stripCount_,t=this.triangleIndex;t.length=0;for(var i=0,n=e.length,r=0;i<n;++i){for(var s=e[i],o=0,a=s-2;o<a;++o){var u=1&o;t.push(r+(u?o+1:o),r+(u?o:o+1),r+(o+2))}r+=s}},getPolygonIndex:function(e){return this.triangleIndex[e]},build:function(){n.prototype.build.call(this,3,this.triangleIndex.length,3,this.triangleIndex.length)}}),s}),
define("x_ite/Components/Shape/TwoSidedMaterial",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shape/X3DMaterialNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(e,t,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(r.TwoSidedMaterial),this.addChildObjects("transparent",new e.SFBool),this.transparent_.setAccessType(r.outputOnly),this.diffuseColor=new Float32Array(3),this.specularColor=new Float32Array(3),this.emissiveColor=new Float32Array(3),this.backDiffuseColor=new Float32Array(3),this.backSpecularColor=new Float32Array(3),this.backEmissiveColor=new Float32Array(3)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"separateBackColor",new e.SFBool),new t(r.inputOutput,"ambientIntensity",new e.SFFloat(.2)),new t(r.inputOutput,"diffuseColor",new e.SFColor(.8,.8,.8)),new t(r.inputOutput,"specularColor",new e.SFColor),new t(r.inputOutput,"emissiveColor",new e.SFColor),new t(r.inputOutput,"shininess",new e.SFFloat(.2)),new t(r.inputOutput,"transparency",new e.SFFloat),new t(r.inputOutput,"backAmbientIntensity",new e.SFFloat(.2)),new t(r.inputOutput,"backDiffuseColor",new e.SFColor(.8,.8,.8)),new t(r.inputOutput,"backSpecularColor",new e.SFColor),new t(r.inputOutput,"backEmissiveColor",new e.SFColor),new t(r.inputOutput,"backShininess",new e.SFFloat(.2)),new t(r.inputOutput,"backTransparency",new e.SFFloat)]),getTypeName:function(){return"TwoSidedMaterial"},getComponentName:function(){return"Shape"},getContainerField:function(){return"material"},initialize:function(){n.prototype.initialize.call(this),this.ambientIntensity_.addInterest("set_ambientIntensity__",this),this.diffuseColor_.addInterest("set_diffuseColor__",this),this.specularColor_.addInterest("set_specularColor__",this),this.emissiveColor_.addInterest("set_emissiveColor__",this),this.shininess_.addInterest("set_shininess__",this),this.transparency_.addInterest("set_transparency__",this),this.backAmbientIntensity_.addInterest("set_backAmbientIntensity__",this),this.backDiffuseColor_.addInterest("set_backDiffuseColor__",this),this.backSpecularColor_.addInterest("set_backSpecularColor__",this),this.backEmissiveColor_.addInterest("set_backEmissiveColor__",this),this.backShininess_.addInterest("set_backShininess__",this),this.backTransparency_.addInterest("set_backTransparency__",this),this.set_ambientIntensity__(),this.set_diffuseColor__(),this.set_specularColor__(),this.set_emissiveColor__(),this.set_shininess__(),this.set_transparency__(),this.set_backAmbientIntensity__(),this.set_backDiffuseColor__(),this.set_backSpecularColor__(),this.set_backEmissiveColor__(),this.set_backShininess__(),this.set_backTransparency__()},set_ambientIntensity__:function(){this.ambientIntensity=Math.max(this.ambientIntensity_.getValue(),0)},set_diffuseColor__:function(){var e=this.diffuseColor,t=this.diffuseColor_.getValue();e[0]=t.r,e[1]=t.g,e[2]=t.b},set_specularColor__:function(){var e=this.specularColor,t=this.specularColor_.getValue();e[0]=t.r,e[1]=t.g,e[2]=t.b},set_emissiveColor__:function(){var e=this.emissiveColor,t=this.emissiveColor_.getValue();e[0]=t.r,e[1]=t.g,e[2]=t.b},set_shininess__:function(){this.shininess=s.clamp(this.shininess_.getValue(),0,1)},set_transparency__:function(){this.transparency=s.clamp(this.transparency_.getValue(),0,1),this.set_transparent__()},set_backAmbientIntensity__:function(){this.backAmbientIntensity=Math.max(this.backAmbientIntensity_.getValue(),0)},set_backDiffuseColor__:function(){var e=this.backDiffuseColor,t=this.backDiffuseColor_.getValue();e[0]=t.r,e[1]=t.g,e[2]=t.b},set_backSpecularColor__:function(){var e=this.backSpecularColor,t=this.backSpecularColor_.getValue();e[0]=t.r,e[1]=t.g,e[2]=t.b},set_backEmissiveColor__:function(){var e=this.backEmissiveColor,t=this.backEmissiveColor_.getValue();e[0]=t.r,e[1]=t.g,e[2]=t.b},set_backShininess__:function(){this.backShininess=s.clamp(this.backShininess_.getValue(),0,1)},set_backTransparency__:function(){this.backTransparency=s.clamp(this.backTransparency_.getValue(),0,1),this.set_transparent__()},set_transparent__:function(){var e=this.transparency_.getValue()||this.backTransparency_.getValue();e!=this.transparent_.getValue()&&(this.transparent_=e)},setShaderUniforms:function(e,t){e.uniform1f(t.x3d_AmbientIntensity,this.ambientIntensity),e.uniform3fv(t.x3d_DiffuseColor,this.diffuseColor),e.uniform3fv(t.x3d_SpecularColor,this.specularColor),e.uniform3fv(t.x3d_EmissiveColor,this.emissiveColor),e.uniform1f(t.x3d_Shininess,this.shininess),e.uniform1f(t.x3d_Transparency,this.transparency),this.separateBackColor_.getValue()?(e.uniform1i(t.x3d_SeparateBackColor,!0),e.uniform1f(t.x3d_BackAmbientIntensity,this.backAmbientIntensity),e.uniform3fv(t.x3d_BackDiffuseColor,this.backDiffuseColor),e.uniform3fv(t.x3d_BackSpecularColor,this.backSpecularColor),e.uniform3fv(t.x3d_BackEmissiveColor,this.backEmissiveColor),e.uniform1f(t.x3d_BackShininess,this.backShininess),e.uniform1f(t.x3d_BackTransparency,this.backTransparency)):e.uniform1i(t.x3d_SeparateBackColor,!1)}}),o}),define("x_ite/Components/Navigation/ViewpointGroup",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Components/EnvironmentalSensor/ProximitySensor","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,s,o,a){"use strict";function u(e){n.call(this,e),this.addType(o.ViewpointGroup),this.size_.setUnit("length"),this.center_.setUnit("length"),this.proximitySensor=new r(e),this.cameraObjects=[],this.viewpointGroups=[]}function l(e,t){switch(e){case s.CAMERA:if(this.proximitySensor.traverse(e,t),this.proximitySensor.isActive_.getValue())for(var i=0,n=this.cameraObjects.length;i<n;++i)this.cameraObjects[i].traverse(e,t);return;case s.DISPLAY:if(this.proximitySensor.traverse(e,t),this.proximitySensor.isActive_.getValue())for(var i=0,n=this.viewpointGroups.length;i<n;++i)this.viewpointGroups[i].traverse(e,t);return}}function h(e,t){switch(e){case s.CAMERA:for(var i=0,n=this.cameraObjects.length;i<n;++i)this.cameraObjects[i].traverse(e,t);return;case s.DISPLAY:for(var i=0,n=this.viewpointGroups.length;i<n;++i)this.viewpointGroups[i].traverse(e,t);return}}return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,fieldDefinitions:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"displayed",new e.SFBool(!0)),new t(o.inputOutput,"description",new e.SFString),new t(o.inputOutput,"retainUserOffsets",new e.SFBool),new t(o.inputOutput,"size",new e.SFVec3f),new t(o.inputOutput,"center",new e.SFVec3f),new t(o.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"ViewpointGroup"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.proximitySensor.setup(),this.size_.addFieldInterest(this.proximitySensor.size_),this.center_.addFieldInterest(this.proximitySensor.center_),this.proximitySensor.size_=this.size_,this.proximitySensor.center_=this.center_,this.displayed_.addInterest("set_displayed__",this),this.size_.addInterest("set_displayed__",this),this.children_.addInterest("set_children__",this),this.set_displayed__(),this.set_children__()},isActive:function(){return this.proximitySensor.isActive_.getValue()},set_displayed__:function(){var e=!this.size_.getValue().equals(a.Zero),t=this.displayed_.getValue();this.proximitySensor.enabled_=t&&e,t&&e?(this.proximitySensor.isCameraObject_.addFieldInterest(this.isCameraObject_),this.setCameraObject(this.proximitySensor.getCameraObject()),this.traverse=l):(this.proximitySensor.isCameraObject_.removeFieldInterest(this.isCameraObject_),this.setCameraObject(t),t?this.traverse=h:delete this.traverse)},set_children__:function(){this.cameraObjects.length=0,this.viewpointGroups.length=0;for(var e=this.children_,t=0,i=e.length;t<i;++t)try{for(var n=e[t].getValue().getInnerNode(),r=n.getType(),s=r.length-1;s>=0;--s)switch(r[s]){case o.X3DViewpointNode:this.cameraObjects.push(n);break;case o.ViewpointGroup:this.cameraObjects.push(n),this.viewpointGroups.push(n)}}catch(e){}},traverse:function(){}}),u}),define("x_ite/Components/EnvironmentalSensor/VisibilitySensor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,s,o){"use strict";function a(e){n.call(this,e),this.addType(s.VisibilitySensor),this.visible=!1}var u=new o(-1,-1,-1);return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"enabled",new e.SFBool(!0)),new t(s.inputOutput,"size",new e.SFVec3f),new t(s.inputOutput,"center",new e.SFVec3f),new t(s.outputOnly,"enterTime",new e.SFTime),new t(s.outputOnly,"exitTime",new e.SFTime),new t(s.outputOnly,"isActive",new e.SFBool)]),size:new o(0,0,0),center:new o(0,0,0),getTypeName:function(){return"VisibilitySensor"},getComponentName:function(){return"EnvironmentalSensor"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.enabled_.addInterest("set_enabled__",this),this.set_enabled__()},set_enabled__:function(){this.enabled_.getValue()?delete this.traverse:this.traverse=Function.prototype},update:function(){this.visible&&this.getTraversed()?(this.isActive_.getValue()||(this.isActive_=!0,this.enterTime_=this.getBrowser().getCurrentTime()),this.visible=!1):this.isActive_.getValue()&&(this.isActive_=!1,this.exitTime_=this.getBrowser().getCurrentTime()),this.setTraversed(!1)},traverse:function(e,t){if(e===r.DISPLAY&&(this.setTraversed(!0),!this.visible))if(this.size_.getValue().equals(u))this.visible=!0;else{var i=t.getViewVolume(),n=t.getModelViewMatrix().get(),s=n.multDirMatrix(this.size.assign(this.size_.getValue())),o=n.multVecMatrix(this.center.assign(this.center_.getValue()));this.visible=i.intersectsSphere(s.abs()/2,o)}}}),a}),define("x_ite/Components/ParticleSystems/VolumeEmitter",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/ParticleSystems/X3DParticleEmitterNode","x_ite/Components/Geometry3D/IndexedFaceSet","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Geometry/Line3","standard/Math/Geometry/Plane3","standard/Math/Geometry/Triangle3","standard/Math/Algorithm","standard/Math/Utility/BVH","standard/Math/Algorithms/QuickSort"],function(e,t,i,n,r,s,o,a,u,l,h,c,d,p){"use strict";function f(e,t){return S.getDistanceToPoint(e)<S.getDistanceToPoint(t)}function g(e){n.call(this,e),this.addType(s.VolumeEmitter),this.speed_.setUnit("speed"),this.mass_.setUnit("mass"),this.surfaceArea_.setUnit("area"),this.direction=new o(0,0,0),this.volumeNode=new r(e),this.areaSoFarArray=[0],this.intersections=[],this.sorter=new p(this.intersections,f)}var m=new o(0,0,0),_=new o(0,0,0),x=new o(0,0,0),y=new o(0,0,0),v=new o(0,0,0),w=new a(0,0,1,0),b=new u(o.Zero,o.zAxis),S=new l(o.Zero,o.zAxis);return g.prototype=Object.assign(Object.create(n.prototype),{constructor:g,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.initializeOnly,"internal",new e.SFBool(!0)),new t(s.inputOutput,"direction",new e.SFVec3f(0,1,0)),new t(s.inputOutput,"speed",new e.SFFloat),new t(s.inputOutput,"variation",new e.SFFloat(.25)),new t(s.initializeOnly,"mass",new e.SFFloat),new t(s.initializeOnly,"surfaceArea",new e.SFFloat),new t(s.inputOutput,"coordIndex",new e.MFInt32(-1)),new t(s.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"VolumeEmitter"},getComponentName:function(){return"ParticleSystems"},getContainerField:function(){return"emitter"},initialize:function(){n.prototype.initialize.call(this),this.direction_.addInterest("set_direction__",this),this.coordIndex_.addFieldInterest(this.volumeNode.coordIndex_),this.coord_.addFieldInterest(this.volumeNode.coord_),this.volumeNode.creaseAngle_=Math.PI,this.volumeNode.convex_=!1,this.volumeNode.coordIndex_=this.coordIndex_,this.volumeNode.coord_=this.coord_,this.volumeNode.addInterest("set_geometry__",this),this.volumeNode.setPrivate(!0),this.volumeNode.setup(),this.set_direction__(),this.set_geometry__()},set_direction__:function(){this.direction.assign(this.direction_.getValue()).normalize(),this.direction.equals(o.Zero)?this.getRandomVelocity=this.getSphericalRandomVelocity:delete this.getRandomVelocity},set_geometry__:function(){var e=0,t=this.areaSoFarArray,i=this.volumeNode.getNormals().getValue(),n=this.volumeNode.getVertices().getValue();this.normals=i,this.vertices=n,t.length=1;for(var r=0,s=n.length;r<s;r+=12)m.set(n[r],n[r+1],n[r+2]),_.set(n[r+4],n[r+5],n[r+6]),x.set(n[r+8],n[r+9],n[r+10]),e+=h.area(m,_,x),t.push(e);this.bvh=new d(n,i)},getRandomPosition:function(e){var t=this.areaSoFarArray,i=t.length,n=Math.random()*t[i-1],r=0;if(1==i||n<=t[0])r=0;else if(n>=t[i-1])r=i-2;else{var s=c.upperBound(t,0,i,n,c.less);r=s<i?s-1:0}var a=Math.random(),u=Math.random();a+u>1&&(a=1-a,u=1-u);var l=1-a-u,h=12*r,d=this.vertices;y.x=a*d[h]+u*d[h+4]+l*d[h+8],y.y=a*d[h+1]+u*d[h+5]+l*d[h+9],y.z=a*d[h+2]+u*d[h+6]+l*d[h+10];var h=9*r,p=this.normals;v.x=a*p[h]+u*p[h+3]+l*p[h+6],v.y=a*p[h+1]+u*p[h+4]+l*p[h+7],v.z=a*p[h+2]+u*p[h+5]+l*p[h+8],w.setFromToVec(o.zAxis,v),w.multVecRot(this.getRandomSurfaceNormal(v)),b.set(y,v),S.set(y,v);var f=this.intersections,g=this.bvh.intersectsLine(b,f);if(g-=g%2){this.sorter.sort(0,g);var s=2*Math.round(this.getRandomValue(0,g/2-1)),m=f[s],_=f[s+1],l=Math.random();return e.x=m.x+(_.x-m.x)*l,e.y=m.y+(_.y-m.y)*l,e.z=m.z+(_.z-m.z)*l,e}return e.set(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY)},getRandomVelocity:function(e){var t=this.direction,i=this.getRandomSpeed();return e.x=t.x*i,e.y=t.y*i,e.z=t.z*i,e}}),g}),define("x_ite/Components/ParticleSystems/WindPhysicsModel",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/ParticleSystems/X3DParticlePhysicsModelNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(e,t,i,n,r,s,o){"use strict";function a(e){n.call(this,e),this.addType(r.WindPhysicsModel),this.speed_.setUnit("speed")}var u=new s(0,0,0);return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"enabled",new e.SFBool(!0)),new t(r.inputOutput,"direction",new e.SFVec3f),new t(r.inputOutput,"speed",new e.SFFloat(.1)),new t(r.inputOutput,"gustiness",new e.SFFloat(.1)),new t(r.inputOutput,"turbulence",new e.SFFloat)]),getTypeName:function(){return"WindPhysicsModel"},getComponentName:function(){return"ParticleSystems"},getContainerField:function(){return"physics"},getRandomSpeed:function(e){var t=Math.max(0,this.speed_.getValue()),i=t*Math.max(0,this.gustiness_.getValue());return e.getRandomValue(Math.max(0,t-i),t+i)},addForce:function(e,t,i,n){var r=t.surfaceArea_.getValue();if(this.enabled_.getValue()){var a=this.getRandomSpeed(t),l=.64615*Math.pow(10,2*Math.log(a));this.direction_.getValue().equals(s.Zero)?t.getRandomNormal(u):u.assign(this.direction_.getValue()).normalize(),i[e].assign(u.multiply(r*l)),n[e]=Math.PI*o.clamp(this.turbulence_.getValue(),0,1)}}}),a}),define("x_ite/Components/Core/WorldInfo",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DInfoNode","x_ite/Bits/X3DConstants"],function(e,t,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.WorldInfo)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"title",new e.SFString),new t(r.initializeOnly,"info",new e.MFString)]),getTypeName:function(){return"WorldInfo"},getComponentName:function(){return"Core"},getContainerField:function(){return"children"}}),s}),define("x_ite/Components/X_ITE/BlendMode",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s){"use strict";function o(e){n.call(this,e),this.addType(s.BlendMode),this.blendTypes={},this.blendModes={}}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"blendColor",new e.SFColorRGBA),new t(s.inputOutput,"sourceColorFactor",new e.SFString("SRC_ALPHA")),new t(s.inputOutput,"sourceAlphaFactor",new e.SFString("ONE_MINUS_SRC_ALPHA")),new t(s.inputOutput,"destinationColorFactor",new e.SFString("ONE")),new t(s.inputOutput,"destinationAlphaFactor",new e.SFString("ONE_MINUS_SRC_ALPHA")),new t(s.inputOutput,"colorEquation",new e.SFString("FUNC_ADD")),new t(s.inputOutput,"alphaEquation",new e.SFString("FUNC_ADD"))]),getTypeName:function(){return"BlendMode"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"blendMode"},initialize:function(){n.prototype.initialize.call(this);var e=this.getBrowser().getContext(),t=e.getExtension("EXT_blend_minmax");this.blendTypes.ZERO=e.ZERO,this.blendTypes.ONE=e.ONE,this.blendTypes.SRC_COLOR=e.SRC_COLOR,this.blendTypes.ONE_MINUS_SRC_COLOR=e.ONE_MINUS_SRC_COLOR,this.blendTypes.DST_COLOR=e.DST_COLOR,this.blendTypes.ONE_MINUS_DST_COLOR=e.ONE_MINUS_DST_COLOR,this.blendTypes.SRC_ALPHA=e.SRC_ALPHA,this.blendTypes.ONE_MINUS_SRC_ALPHA=e.ONE_MINUS_SRC_ALPHA,this.blendTypes.DST_ALPHA=e.DST_ALPHA,this.blendTypes.ONE_MINUS_DST_ALPHA=e.ONE_MINUS_DST_ALPHA,this.blendTypes.SRC_ALPHA_SATURATE=e.SRC_ALPHA_SATURATE,this.blendTypes.CONSTANT_COLOR=e.CONSTANT_COLOR,this.blendTypes.ONE_MINUS_CONSTANT_COLOR=e.ONE_MINUS_CONSTANT_COLOR,this.blendTypes.CONSTANT_ALPHA=e.CONSTANT_ALPHA,this.blendTypes.ONE_MINUS_CONSTANT_ALPHA=e.ONE_MINUS_CONSTANT_ALPHA,this.blendModes.FUNC_ADD=e.FUNC_ADD,this.blendModes.FUNC_SUBTRACT=e.FUNC_SUBTRACT,this.blendModes.FUNC_REVERSE_SUBTRACT=e.FUNC_REVERSE_SUBTRACT,this.blendModes.MIN=e.MIN||t.MIN_EXT,this.blendModes.MAX=e.MAX||t.MAX_EXT,this.sourceColorFactor_.addInterest("set_sourceColorFactor__",this),this.sourceAlphaFactor_.addInterest("set_sourceAlphaFactor__",this),this.destinationColorFactor_.addInterest("set_destinationColorFactor__",this),this.destinationAlphaFactor_.addInterest("set_destinationAlphaFactor__",this),this.colorEquation_.addInterest("set_colorEquation__",this),this.alphaEquation_.addInterest("set_alphaEquation__",this),this.set_sourceColorFactor__(),this.set_sourceAlphaFactor__(),this.set_destinationColorFactor__(),this.set_destinationAlphaFactor__(),this.set_colorEquation__(),this.set_alphaEquation__()},set_sourceColorFactor__:function(){this.sourceColorFactorType=this.blendTypes[this.sourceColorFactor_.getValue()],this.sourceColorFactorType||(this.sourceColorFactorType=this.blendTypes.SRC_ALPHA)},set_sourceAlphaFactor__:function(){this.sourceAlphaFactorType=this.blendTypes[this.sourceAlphaFactor_.getValue()],this.sourceAlphaFactorType||(this.sourceAlphaFactorType=this.blendTypes.ONE_MINUS_SRC_ALPHA)},set_destinationColorFactor__:function(){this.destinationColorFactorType=this.blendTypes[this.destinationColorFactor_.getValue()],this.destinationColorFactorType||(this.destinationColorFactorType=this.blendTypes.ONE)},set_destinationAlphaFactor__:function(){this.destinationAlphaFactorType=this.blendTypes[this.destinationAlphaFactor_.getValue()],this.destinationAlphaFactorType||(this.destinationAlphaFactorType=this.blendTypes.ONE_MINUS_SRC_ALPHA)},set_colorEquation__:function(){this.colorEquationType=this.blendModes[this.colorEquation_.getValue()],this.colorEquationType||(this.colorEquationType=this.blendModes.FUNC_ADD)},set_alphaEquation__:function(){this.alphaEquationType=this.blendModes[this.alphaEquation_.getValue()],this.alphaEquationType||(this.alphaEquationType=this.blendModes.FUNC_ADD)},enable:function(e){var t=this.blendColor_.getValue();e.blendColor(t.r,t.g,t.b,t.a),e.blendFuncSeparate(this.sourceColorFactorType,this.sourceAlphaFactorType,this.destinationColorFactorType,this.destinationAlphaFactorType),e.blendEquationSeparate(this.colorEquationType,this.alphaEquationType)},disable:function(e){e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD)}}),o}),define("x_ite/Configuration/SupportedNodes",["x_ite/Components/Networking/Anchor","x_ite/Components/Shape/Appearance","x_ite/Components/Geometry2D/Arc2D","x_ite/Components/Geometry2D/ArcClose2D","x_ite/Components/Sound/AudioClip","x_ite/Components/EnvironmentalEffects/Background","x_ite/Components/Navigation/Billboard","x_ite/Components/EventUtilities/BooleanFilter","x_ite/Components/EventUtilities/BooleanSequencer","x_ite/Components/EventUtilities/BooleanToggle","x_ite/Components/EventUtilities/BooleanTrigger","x_ite/Components/ParticleSystems/BoundedPhysicsModel","x_ite/Components/Geometry3D/Box","x_ite/Components/CADGeometry/CADAssembly","x_ite/Components/CADGeometry/CADFace","x_ite/Components/CADGeometry/CADLayer","x_ite/Components/CADGeometry/CADPart","x_ite/Components/Geometry2D/Circle2D","x_ite/Components/Rendering/ClipPlane","x_ite/Components/Navigation/Collision","x_ite/Components/Rendering/Color","x_ite/Components/Followers/ColorChaser","x_ite/Components/Followers/ColorDamper","x_ite/Components/Interpolation/ColorInterpolator","x_ite/Components/Rendering/ColorRGBA","x_ite/Components/CubeMapTexturing/ComposedCubeMapTexture","x_ite/Components/Shaders/ComposedShader","x_ite/Components/Geometry3D/Cone","x_ite/Components/ParticleSystems/ConeEmitter","x_ite/Components/Rendering/Coordinate","x_ite/Components/Followers/CoordinateChaser","x_ite/Components/Followers/CoordinateDamper","x_ite/Components/NURBS/CoordinateDouble","x_ite/Components/Interpolation/CoordinateInterpolator","x_ite/Components/Interpolation/CoordinateInterpolator2D","x_ite/Components/Geometry3D/Cylinder","x_ite/Components/PointingDeviceSensor/CylinderSensor","x_ite/Components/Lighting/DirectionalLight","x_ite/Components/Geometry2D/Disk2D","x_ite/Components/Interpolation/EaseInEaseOut","x_ite/Components/Geometry3D/ElevationGrid","x_ite/Components/ParticleSystems/ExplosionEmitter","x_ite/Components/Geometry3D/Extrusion","x_ite/Components/Shaders/FloatVertexAttribute","x_ite/Components/EnvironmentalEffects/Fog","x_ite/Components/Text/FontStyle","x_ite/Components/ParticleSystems/ForcePhysicsModel","x_ite/Components/CubeMapTexturing/GeneratedCubeMapTexture","x_ite/Components/Geospatial/GeoCoordinate","x_ite/Components/Geospatial/GeoElevationGrid","x_ite/Components/Geospatial/GeoLOD","x_ite/Components/Geospatial/GeoLocation","x_ite/Components/Geospatial/GeoMetadata","x_ite/Components/Geospatial/GeoOrigin","x_ite/Components/Geospatial/GeoPositionInterpolator","x_ite/Components/Geospatial/GeoProximitySensor","x_ite/Components/Geospatial/GeoTouchSensor","x_ite/Components/Geospatial/GeoTransform","x_ite/Components/Geospatial/GeoViewpoint","x_ite/Components/Grouping/Group","x_ite/Components/CubeMapTexturing/ImageCubeMapTexture","x_ite/Components/Texturing/ImageTexture","x_ite/Components/Geometry3D/IndexedFaceSet","x_ite/Components/Rendering/IndexedLineSet","x_ite/Components/CADGeometry/IndexedQuadSet","x_ite/Components/Rendering/IndexedTriangleFanSet","x_ite/Components/Rendering/IndexedTriangleSet","x_ite/Components/Rendering/IndexedTriangleStripSet","x_ite/Components/Networking/Inline","x_ite/Components/EventUtilities/IntegerSequencer","x_ite/Components/EventUtilities/IntegerTrigger","x_ite/Components/KeyDeviceSensor/KeySensor","x_ite/Components/Navigation/LOD","x_ite/Components/Layering/Layer","x_ite/Components/Layering/LayerSet","x_ite/Components/Layout/Layout","x_ite/Components/Layout/LayoutGroup","x_ite/Components/Layout/LayoutLayer","x_ite/Components/Shape/LineProperties","x_ite/Components/Rendering/LineSet","x_ite/Components/Networking/LoadSensor","x_ite/Components/EnvironmentalEffects/LocalFog","x_ite/Components/Shape/Material","x_ite/Components/Shaders/Matrix3VertexAttribute","x_ite/Components/Shaders/Matrix4VertexAttribute","x_ite/Components/Core/MetadataBoolean","x_ite/Components/Core/MetadataDouble","x_ite/Components/Core/MetadataFloat","x_ite/Components/Core/MetadataInteger","x_ite/Components/Core/MetadataSet","x_ite/Components/Core/MetadataString","x_ite/Components/Texturing/MovieTexture","x_ite/Components/Navigation/NavigationInfo","x_ite/Components/Rendering/Normal","x_ite/Components/Interpolation/NormalInterpolator","x_ite/Components/Followers/OrientationChaser","x_ite/Components/Followers/OrientationDamper","x_ite/Components/Interpolation/OrientationInterpolator","x_ite/Components/Navigation/OrthoViewpoint","x_ite/Components/ParticleSystems/ParticleSystem","x_ite/Components/Texturing/PixelTexture","x_ite/Components/PointingDeviceSensor/PlaneSensor","x_ite/Components/ParticleSystems/PointEmitter","x_ite/Components/Lighting/PointLight","x_ite/Components/Rendering/PointSet","x_ite/Components/Geometry2D/Polyline2D","x_ite/Components/ParticleSystems/PolylineEmitter","x_ite/Components/Geometry2D/Polypoint2D","x_ite/Components/Followers/PositionChaser","x_ite/Components/Followers/PositionChaser2D","x_ite/Components/Followers/PositionDamper","x_ite/Components/Followers/PositionDamper2D","x_ite/Components/Interpolation/PositionInterpolator","x_ite/Components/Interpolation/PositionInterpolator2D","x_ite/Components/EnvironmentalSensor/ProximitySensor","x_ite/Components/CADGeometry/QuadSet","x_ite/Components/Geometry2D/Rectangle2D","x_ite/Components/Followers/ScalarChaser","x_ite/Components/Followers/ScalarDamper","x_ite/Components/Interpolation/ScalarInterpolator","x_ite/Components/Layout/ScreenFontStyle","x_ite/Components/Layout/ScreenGroup","x_ite/Components/Scripting/Script","x_ite/Components/Shaders/ShaderPart","x_ite/Components/Shape/Shape","x_ite/Components/Sound/Sound","x_ite/Components/Geometry3D/Sphere","x_ite/Components/PointingDeviceSensor/SphereSensor","x_ite/Components/Interpolation/SplinePositionInterpolator","x_ite/Components/Interpolation/SplinePositionInterpolator2D","x_ite/Components/Interpolation/SplineScalarInterpolator","x_ite/Components/Lighting/SpotLight","x_ite/Components/Interpolation/SquadOrientationInterpolator","x_ite/Components/Grouping/StaticGroup","x_ite/Components/KeyDeviceSensor/StringSensor","x_ite/Components/ParticleSystems/SurfaceEmitter","x_ite/Components/Grouping/Switch","x_ite/Components/Followers/TexCoordChaser2D","x_ite/Components/Followers/TexCoordDamper2D","x_ite/Components/Text/Text","x_ite/Components/EnvironmentalEffects/TextureBackground","x_ite/Components/Texturing/TextureCoordinate","x_ite/Components/Texturing3D/TextureCoordinate3D","x_ite/Components/Texturing3D/TextureCoordinate4D","x_ite/Components/Texturing/TextureProperties","x_ite/Components/Texturing/TextureTransform","x_ite/Components/Texturing3D/TextureTransform3D","x_ite/Components/Texturing3D/TextureTransformMatrix3D","x_ite/Components/Time/TimeSensor","x_ite/Components/EventUtilities/TimeTrigger","x_ite/Components/PointingDeviceSensor/TouchSensor","x_ite/Components/Grouping/Transform","x_ite/Components/EnvironmentalSensor/TransformSensor","x_ite/Components/Rendering/TriangleFanSet","x_ite/Components/Rendering/TriangleSet","x_ite/Components/Geometry2D/TriangleSet2D","x_ite/Components/Rendering/TriangleStripSet","x_ite/Components/Shape/TwoSidedMaterial","x_ite/Components/Navigation/Viewpoint","x_ite/Components/Navigation/ViewpointGroup","x_ite/Components/Layering/Viewport","x_ite/Components/EnvironmentalSensor/VisibilitySensor","x_ite/Components/ParticleSystems/VolumeEmitter","x_ite/Components/ParticleSystems/WindPhysicsModel","x_ite/Components/Core/WorldInfo","x_ite/Components/X_ITE/BlendMode"],function(e,t,i,n,r,s,o,a,u,l,h,c,d,p,f,g,m,_,x,y,v,w,b,S,C,T,F,O,N,M,D,E,V,B,I,A,P,R,L,z,k,X,U,j,G,q,H,W,Y,$,K,Q,Z,J,ee,te,ie,ne,re,se,oe,ae,ue,le,he,ce,de,pe,fe,ge,me,_e,xe,ye,ve,we,be,Se,Ce,Te,Fe,Oe,Ne,Me,De,Ee,Ve,Be,Ie,Ae,Pe,Re,Le,ze,ke,Xe,Ue,je,Ge,qe,He,We,Ye,$e,Ke,Qe,Ze,Je,et,tt,it,nt,rt,st,ot,at,ut,lt,ht,ct,dt,pt,ft,gt,mt,_t,xt,yt,vt,wt,bt,St,Ct,Tt,Ft,Ot,Nt,Mt,Dt,Et,Vt,Bt,It,At,Pt,Rt,Lt,zt,kt,Xt,Ut,jt,Gt,qt,Ht,Wt,Yt,$t,Kt,Qt,Zt,Jt,ei,ti,ii,ni){"use strict";function ri(e){return new this(e)}var si={MetadataBool:Ee,Anchor:e,Appearance:t,Arc2D:i,ArcClose2D:n,AudioClip:r,Background:s,Billboard:o,BooleanFilter:a,BooleanSequencer:u,BooleanToggle:l,BooleanTrigger:h,BoundedPhysicsModel:c,Box:d,CADAssembly:p,CADFace:f,CADLayer:g,CADPart:m,Circle2D:_,ClipPlane:x,Collision:y,Color:v,ColorChaser:w,ColorDamper:b,ColorInterpolator:S,ColorRGBA:C,ComposedCubeMapTexture:T,ComposedShader:F,Cone:O,ConeEmitter:N,Coordinate:M,CoordinateChaser:D,CoordinateDamper:E,CoordinateDouble:V,CoordinateInterpolator:B,CoordinateInterpolator2D:I,Cylinder:A,CylinderSensor:P,DirectionalLight:R,Disk2D:L,EaseInEaseOut:z,ElevationGrid:k,ExplosionEmitter:X,Extrusion:U,FloatVertexAttribute:j,Fog:G,FontStyle:q,ForcePhysicsModel:H,GeneratedCubeMapTexture:W,GeoCoordinate:Y,GeoElevationGrid:$,GeoLOD:K,GeoLocation:Q,GeoMetadata:Z,GeoOrigin:J,GeoPositionInterpolator:ee,GeoProximitySensor:te,GeoTouchSensor:ie,GeoTransform:ne,GeoViewpoint:re,Group:se,ImageCubeMapTexture:oe,ImageTexture:ae,IndexedFaceSet:ue,IndexedLineSet:le,IndexedQuadSet:he,IndexedTriangleFanSet:ce,IndexedTriangleSet:de,IndexedTriangleStripSet:pe,Inline:fe,IntegerSequencer:ge,IntegerTrigger:me,KeySensor:_e,LOD:xe,Layer:ye,LayerSet:ve,Layout:we,LayoutGroup:be,LayoutLayer:Se,LineProperties:Ce,LineSet:Te,LoadSensor:Fe,LocalFog:Oe,Material:Ne,Matrix3VertexAttribute:Me,Matrix4VertexAttribute:De,MetadataBoolean:Ee,MetadataDouble:Ve,MetadataFloat:Be,MetadataInteger:Ie,MetadataSet:Ae,MetadataString:Pe,MovieTexture:Re,NavigationInfo:Le,Normal:ze,NormalInterpolator:ke,OrientationChaser:Xe,OrientationDamper:Ue,OrientationInterpolator:je,OrthoViewpoint:Ge,ParticleSystem:qe,PixelTexture:He,PlaneSensor:We,PointEmitter:Ye,PointLight:$e,PointSet:Ke,Polyline2D:Qe,PolylineEmitter:Ze,Polypoint2D:Je,PositionChaser:et,PositionChaser2D:tt,PositionDamper:it,PositionDamper2D:nt,PositionInterpolator:rt,PositionInterpolator2D:st,ProximitySensor:ot,QuadSet:at,Rectangle2D:ut,ScalarChaser:lt,ScalarDamper:ht,ScalarInterpolator:ct,ScreenFontStyle:dt,ScreenGroup:pt,Script:ft,ShaderPart:gt,Shape:mt,Sound:_t,Sphere:xt,SphereSensor:yt,SplinePositionInterpolator:vt,SplinePositionInterpolator2D:wt,SplineScalarInterpolator:bt,SpotLight:St,SquadOrientationInterpolator:Ct,StaticGroup:Tt,StringSensor:Ft,SurfaceEmitter:Ot,Switch:Nt,TexCoordChaser2D:Mt,TexCoordDamper2D:Dt,Text:Et,TextureBackground:Vt,TextureCoordinate:Bt,TextureCoordinate3D:It,TextureCoordinate4D:At,TextureProperties:Pt,TextureTransform:Rt,TextureTransform3D:Lt,TextureTransformMatrix3D:zt,TimeSensor:kt,TimeTrigger:Xt,TouchSensor:Ut,Transform:jt,TransformSensor:Gt,TriangleFanSet:qt,TriangleSet:Ht,TriangleSet2D:Wt,TriangleStripSet:Yt,TwoSidedMaterial:$t,Viewpoint:Kt,ViewpointGroup:Qt,Viewport:Zt,VisibilitySensor:Jt,VolumeEmitter:ei,WindPhysicsModel:ti,WorldInfo:ii,BlendMode:ni};for(var oi in si){var ai=si[oi];ai.createInstance=ri.bind(ai),si[oi.toUpperCase()]=ai}return si}),
define("x_ite/Browser/X3DBrowser",["jquery","x_ite/Browser/VERSION","x_ite/Base/Events","x_ite/Fields","x_ite/Browser/X3DBrowserContext","x_ite/Configuration/ComponentInfo","x_ite/Configuration/SupportedProfiles","x_ite/Configuration/SupportedComponents","x_ite/Configuration/SupportedNodes","x_ite/Execution/Scene","x_ite/Execution/X3DScene","x_ite/InputOutput/FileLoader","x_ite/Parser/XMLParser","x_ite/Parser/JSONParser","x_ite/Bits/X3DConstants","locale/gettext"],function(e,t,i,n,r,s,o,a,u,l,h,c,d,p,f,g){"use strict";function m(e){r.call(this,e),this.currentSpeed=0,this.currentFrameRate=60,this.description_="",this.supportedNodes=u,this.supportedComponents=a(this),this.supportedProfiles=o(this),this.components={},this.browserCallbacks=new Map,this.replaceWorld(this.createScene())}return m.prototype=Object.assign(Object.create(r.prototype),{constructor:m,getTypeName:function(){return"X3DBrowser"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"browser"},initialize:function(){r.prototype.initialize.call(this),this.getLoadSensor().isLoaded_.addInterest("set_loaded__",this)},set_loaded__:function(e){this.getLoadSensor().isLoaded_.removeInterest("set_loaded__",this),this.getLoadSensor().enabled_=!1;var t=this.getElement().attr("src");t=t?'"'+t+'"':this.getElement().attr("url"),t?(this.initialized().set(this.getCurrentTime()),this.load(t)):(this.initialized().setValue(this.getCurrentTime()),this.callBrowserCallbacks("initialized"),this.callBrowserEventHandler("onload")),this.print("Welcome to "+this.name+" X3D Browser "+this.version+":\n        Current Graphics Renderer\n                Name: "+this.getVendor()+" "+this.getWebGLVersion()+"\n                Shading language: "+this.getShadingLanguageVersion()+"\n        Rendering Properties\n                Antialiased: "+this.getAntialiased()+"\n                Depth size: "+this.getDepthSize()+" bits\n                Color depth: "+this.getColorDepth()+" bits\n                Max clip planes: 6\n                Max lights: 8\n                Texture units: "+this.getMaxTextureUnits()+" / "+this.getMaxCombinedTextureUnits()+"\n                Max texture size: "+this.getMaxTextureSize()+" × "+this.getMaxTextureSize()+" pixel\n                Texture memory: "+this.getTextureMemory()+"\n                Max vertex uniform vectors: "+this.getMaxVertexUniformVectors()+"\n                Max fragment uniform vectors: "+this.getMaxFragmentUniformVectors()+"\n                Max vertex attribs: "+this.getMaxVertexAttribs()+"\n")},getName:function(){return this.name},getVersion:function(){return this.version},getCurrentSpeed:function(){return this.currentSpeed},getCurrentFrameRate:function(){return this.currentFrameRate},setDescription:function(e){this.description=e},getWorldURL:function(){return this.currentScene.worldURL},getProfile:function(e){var t=this.supportedProfiles.get(e);if(t)return t;throw Error("Profile '"+e+"' is not supported.")},getComponent:function(e,t){var i=this.supportedComponents.get(e);if(i)return new s(this,{title:i.title,name:e,level:t,providerUrl:this.getProviderUrl()});throw Error("Component '"+e+"' at level '"+t+"' is not supported.")},createScene:function(){var e=new l(this);return e.setup(),this.isExternal()?e:(e.setLive(!0),e)},replaceWorld:function(e){if(this.loadCount_.removeInterest("set_loadCount__",this),this.prepareEvents().removeInterest("bind",this),this.loader&&this.loader.abort(),this.getWorld()&&(this.getExecutionContext().setLive(!1),this.shutdown().processInterests(),this.callBrowserCallbacks("shutdown"),this.callBrowserEventHandler("onshutdown")),i.clear(),e instanceof n.MFNode){var t=e;e=this.createScene();for(var r=0,s=t.length;r<s;++r)e.isLive().addInterest(t[r].getValue().getExecutionContext().isLive());e.setRootNodes(t)}e instanceof h||(e=this.createScene()),this.description="",this.getBrowserOptions().configure(),this.setBrowserLoading(!0),this.loadCount_.addInterest("set_loadCount__",this),this.prepareEvents().removeInterest("bind",this);for(var o in e.getLoadingObjects())this.addLoadCount(e.getLoadingObjects()[o]);e.setLive(this.isLive().getValue()),this.setExecutionContext(e)},set_loadCount__:function(e){e.getValue()||(this.loadCount_.removeInterest("set_loadCount__",this),this.prepareEvents().addInterest("bind",this),this.addBrowserEvent())},bind:function(){this.prepareEvents().removeInterest("bind",this),this.setBrowserLoading(!1),this.initialized().getValue()&&(this.initialized().setValue(this.getCurrentTime()),this.callBrowserCallbacks("initialized"),this.callBrowserEventHandler("onload"))},createVrmlFromString:function(e){var t=new n.MFNode;return t.setValue(this.createX3DFromString(e).rootNodes),t},createX3DFromString:function(e){var t=this.currentScene,i=this.isExternal(),n=new c(this.getWorld()).createX3DFromString(this.currentScene.getURL(),e);return i||(n.setExecutionContext(t),t.isLive().addInterest("setLive",n),t.isLive().getValue()&&n.setLive(!0)),n.setup(),n},createVrmlFromURL:function(e,t,i){if(!(t instanceof n.SFNode))throw new Error("Browser.createVrmlFromURL: node must be of type SFNode.");if(!t.getValue())throw new Error("Browser.createVrmlFromURL: node IS NULL.");var r=t.getValue().getField(i);if(!r.isInput())throw new Error("Browser.createVrmlFromURL: event named '"+i+"' must be a input field.");if(r.getType()!==f.MFNode)throw new Error("Browser.createVrmlFromURL: event named '"+i+"' must be of type MFNode.");var s=this.currentScene,o=this.isExternal(),a=new c(this.getWorld());this.addLoadCount(a),a.createX3DFromURL(e,null,function(e){this.removeLoadCount(a),e&&(o||(e.setExecutionContext(s),s.isLive().addInterest("setLive",e),s.isLive().getValue()&&e.setLive(!0)),e.setup(),r.setValue(e.rootNodes))}.bind(this))},createX3DFromURL:function(e,t,i){if(3===arguments.length)return this.createVrmlFromURL(e,t,i);var n=this.currentScene,r=this.isExternal(),s=new c(this.getWorld()).createX3DFromURL(e,null);return r||(s.setExecutionContext(n),n.isLive().addInterest("setLive",s),n.isLive().getValue()&&s.setLive(!0)),s.setup(),s},loadURL:function(e,t){this.loadCount_.removeInterest("set_loadCount__",this),this.prepareEvents().removeInterest("bind",this),this.loader&&this.loader.abort(),this.setBrowserLoading(!0),this.addLoadCount(this),this.loader=new c(this.getWorld()),this.loader.createX3DFromURL(e,t,function(t){this.getBrowserOptions().getSplashScreen()||this.getCanvas().fadeIn(0),t?this.replaceWorld(t):(this.callBrowserCallbacks("error",e),this.callBrowserEventHandler("onerror"),setTimeout(function(){this.getSplashScreen().find(".x_ite-private-spinner-text").text(g("Failed loading world."))}.bind(this),31))}.bind(this),function(e){this.currentScene.changeViewpoint(e),this.removeLoadCount(this),this.setBrowserLoading(!1)}.bind(this),function(e,t){t?window.open(e,t):location=e,this.removeLoadCount(this),this.setBrowserLoading(!1)}.bind(this))},addBrowserListener:function(e,t){},removeBrowserListener:function(e){},addBrowserCallback:function(e,t){this.browserCallbacks.set(e,t)},removeBrowserCallback:function(e){this.browserCallbacks.delete(e)},getBrowserCallbacks:function(){return this.browserCallbacks},callBrowserCallbacks:function(e){var t=arguments;this.browserCallbacks.size&&new Map(this.browserCallbacks).forEach(function(e){e.apply(null,t)})},importJS:function(e){var t=this.currentScene,i=this.isExternal(),n=this.createScene();return new p(n).parseJavaScript(e),i||(n.setExecutionContext(t),t.isLive().addInterest(n,"setLive"),t.isLive().getValue()&&n.setLive(!0)),n.setup(),n},importDocument:function(e){if(e){var t=this.currentScene,i=this.isExternal(),n=this.createScene();return new d(n).parseIntoScene(e),i||(n.setExecutionContext(t),t.isLive().addInterest("setLive",n),t.isLive().getValue()&&n.setLive(!0)),n.setup(),n}},getBrowserProperty:function(e){return this.getBrowserProperties().getField(e).getValue()},setBrowserOption:function(e,t){this.getBrowserOptions().getField(e).setValue(t)},getBrowserOption:function(e){return this.getBrowserOptions().getField(e).getValue()},getRenderingProperty:function(e){this.getRenderingProperties().getField(e).getValue()},firstViewpoint:function(){var e=this.getActiveLayer();if(e){var t=e.getUserViewpoints();t.length&&this.bindViewpoint(t[0])}},previousViewpoint:function(){var e=this.getActiveLayer();if(e){var t=e.getUserViewpoints();if(0===t.length)return;for(var i=0,n=0;n<t.length&&!t[n].isBound_.getValue();++n)++i;i<t.length?0===i?this.bindViewpoint(t[t.length-1]):this.bindViewpoint(t[i-1]):this.bindViewpoint(t[t.length-1])}},nextViewpoint:function(){var e=this.getActiveLayer();if(e){var t=e.getUserViewpoints();if(0===t.length)return;for(var i=0,n=0;n<t.length&&!t[n].isBound_.getValue();++n)++i;i<t.length?i===t.length-1?this.bindViewpoint(t[0]):this.bindViewpoint(t[i+1]):this.bindViewpoint(t[0])}},lastViewpoint:function(){var e=this.getActiveLayer();if(e){var t=e.getUserViewpoints();t.length&&this.bindViewpoint(t[t.length-1])}},changeViewpoint:function(e){try{this.currentScene.changeViewpoint(e)}catch(e){console.log(e.message)}},bindViewpoint:function(e){e.setAnimate(!0),e.isBound_.getValue()?e.transitionStart(e):e.set_bind_=!0},addRoute:function(e,t,i,n){this.currentScene.addRoute(e,t,i,n)},deleteRoute:function(e,t,i,n){try{var r=this.currentScene.getRoute(e,t,i,n);r&&this.currentScene.deleteRoute(r)}catch(e){console.log(e)}},beginUpdate:function(){this.setLive(!0),this.getExecutionContext().setLive(!0),this.advanceTime(performance.now())},endUpdate:function(){this.setLive(!1),this.getExecutionContext().setLive(!1)},print:function(){for(var t="",i=0;i<arguments.length;++i)t+=arguments[i];console.log(t);var n=e(".x_ite-console");n.length&&n.append(document.createTextNode(t))},println:function(){for(var t="",i=0;i<arguments.length;++i)t+=arguments[i];console.log(t),t+="\n";var n=e(".x_ite-console");n.length&&n.append(document.createTextNode(t))}}),Object.defineProperty(m.prototype,"name",{get:function(){return"X_ITE"},enumerable:!0,configurable:!1}),Object.defineProperty(m.prototype,"version",{get:function(){return t},enumerable:!0,configurable:!1}),Object.defineProperty(m.prototype,"description",{get:function(){return this.description_},set:function(e){this.description_=e,this.getNotification().string_=e},enumerable:!0,configurable:!1}),Object.defineProperty(m.prototype,"currentScene",{get:function(){return this.getScriptStack()[this.getScriptStack().length-1].getExecutionContext()},enumerable:!0,configurable:!1}),m}),define("x_ite/X3D",["jquery","x_ite/Error","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Basic/X3DField","x_ite/Basic/X3DArrayField","x_ite/Fields","x_ite/Browser/X3DBrowser","x_ite/Configuration/ComponentInfo","x_ite/Configuration/ComponentInfoArray","x_ite/Configuration/ProfileInfo","x_ite/Configuration/ProfileInfoArray","x_ite/Configuration/UnitInfo","x_ite/Configuration/UnitInfoArray","x_ite/Execution/X3DExecutionContext","x_ite/Execution/X3DScene","x_ite/Prototype/ExternProtoDeclarationArray","x_ite/Prototype/ProtoDeclarationArray","x_ite/Prototype/X3DExternProtoDeclaration","x_ite/Prototype/X3DProtoDeclaration","x_ite/Routing/RouteArray","x_ite/Routing/X3DRoute","x_ite/Bits/X3DConstants"],function(e,t,i,n,r,s,o,a,u,l,h,c,d,p,f,g,m,_,x,y,v,w,b){"use strict";function S(t,i){var n=e("<X3DCanvas></X3DCanvas>");return t instanceof o.MFString&&n.attr("url",t.toString()),T(n),n[0]}function C(t){return e(t).data("browser")}function T(t){if(t=e(t),!t.find(".x_ite-private-browser").length){var i=new a(t);return t.data("browser",i),i.setup(),i}}function F(i,n){"function"==typeof i&&N.done(i),"function"==typeof n&&M.done(n),O||(O=!0,e(function(){var i=e("X3DCanvas");i.children().hide();try{e.map(i,T),N.resolve()}catch(e){t.fallback(i,e),M.resolve(e)}}))}console||(console={}),console.log||(console.log=function(){}),console.info||(console.info=console.log),console.warn||(console.warn=console.log),console.error||(console.error=console.log);var O=!1,N=e.Deferred(),M=e.Deferred();return Object.assign(F,o,{require:require,define:define,getBrowser:C,createBrowser:S,X3DConstants:b,X3DFieldDefinition:i,FieldDefinitionArray:n,X3DField:r,X3DArrayField:s,X3DExecutionContext:f,X3DScene:g,ComponentInfo:u,ComponentInfoArray:l,ProfileInfo:h,ProfileInfoArray:c,UnitInfo:d,UnitInfoArray:p,ExternProtoDeclarationArray:m,ProtoDeclarationArray:_,X3DExterProtonDeclaration:x,X3DProtoDeclaration:y,RouteArray:v,X3DRoute:w}),F}),function(){"use strict";function e(e,t){r?r(e,t):(s.push(e),o.push(t))}function t(e){require(["x_ite/Error"],function(t){t(e,o)})}function i(){return window.X3D===e&&(void 0===n?delete window.X3D:window.X3D=n),e}var n=window.X3D,r=null;if(e.noConflict=i,e.require=require,e.define=define,window.X3D=e,document.createElement("X3DCanvas"),void 0===window.Proxy)return t("Proxy is not defined");var s=[],o=[];require(["jquery","x_ite/X3D"],function(t,i){t.noConflict(!0),r=i,Object.assign(e,i),i();for(var n=0;n<s.length;++n)i(s[n],o[n])},t)}(),define("x_ite",function(){});for(var key in x_iteNoConfict)void 0===x_iteNoConfict[key]?delete window[key]:window[key]=x_iteNoConfict[key]}();
