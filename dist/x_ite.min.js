/* X_ITE X3D v4.5.1a-760
 * See LICENSE.txt for a detailed listing of used licences. */
!function(){var x_iteNoConfict={sprintf:window.sprintf,vsprintf:window.vsprintf},requirejs,require,define;!function(global,setTimeout){function commentReplace(t,e){return e||""}function isFunction(t){return"[object Function]"===ostring.call(t)}function isArray(t){return"[object Array]"===ostring.call(t)}function each(t,e){if(t){var n;for(n=0;n<t.length&&(!t[n]||!e(t[n],n,t));n+=1);}}function eachReverse(t,e){if(t){var n;for(n=t.length-1;n>-1&&(!t[n]||!e(t[n],n,t));n-=1);}}function hasProp(t,e){return hasOwn.call(t,e)}function getOwn(t,e){return hasProp(t,e)&&t[e]}function eachProp(t,e){var n;for(n in t)if(hasProp(t,n)&&e(t[n],n))break}function mixin(t,e,n,i){return e&&eachProp(e,function(e,r){!n&&hasProp(t,r)||(!i||"object"!=typeof e||!e||isArray(e)||isFunction(e)||e instanceof RegExp?t[r]=e:(t[r]||(t[r]={}),mixin(t[r],e,n,i)))}),t}function bind(t,e){return function(){return e.apply(t,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(t){throw t}function getGlobal(t){if(!t)return t;var e=global;return each(t.split("."),function(t){e=e[t]}),e}function makeError(t,e,n,i){var r=new Error(e+"\nhttps://requirejs.org/docs/errors.html#"+t);return r.requireType=t,r.requireModules=i,n&&(r.originalError=n),r}function newContext(t){function e(t){var e,n;for(e=0;e<t.length;e++)if("."===(n=t[e]))t.splice(e,1),e-=1;else if(".."===n){if(0===e||1===e&&".."===t[2]||".."===t[e-1])continue;e>0&&(t.splice(e-1,2),e-=2)}}function n(t,n,i){var r,o,s,a,u,l,c,h,d,p,f,g,m=n&&n.split("/"),x=S.map,v=x&&x["*"];if(t&&(t=t.split("/"),c=t.length-1,S.nodeIdCompat&&jsSuffixRegExp.test(t[c])&&(t[c]=t[c].replace(jsSuffixRegExp,"")),"."===t[0].charAt(0)&&m&&(g=m.slice(0,m.length-1),t=g.concat(t)),e(t),t=t.join("/")),i&&x&&(m||v)){s=t.split("/");t:for(a=s.length;a>0;a-=1){if(l=s.slice(0,a).join("/"),m)for(u=m.length;u>0;u-=1)if((o=getOwn(x,m.slice(0,u).join("/")))&&(o=getOwn(o,l))){h=o,d=a;break t}!p&&v&&getOwn(v,l)&&(p=getOwn(v,l),f=a)}!h&&p&&(h=p,d=f),h&&(s.splice(0,d,h),t=s.join("/"))}return r=getOwn(S.pkgs,t),r?r:t}function i(t){isBrowser&&each(scripts(),function(e){if(e.getAttribute("data-requiremodule")===t&&e.getAttribute("data-requirecontext")===y.contextName)return e.parentNode.removeChild(e),!0})}function r(t){var e=getOwn(S.paths,t);if(e&&isArray(e)&&e.length>1)return e.shift(),y.require.undef(t),y.makeRequire(null,{skipMap:!0})([t]),!0}function o(t){var e,n=t?t.indexOf("!"):-1;return n>-1&&(e=t.substring(0,n),t=t.substring(n+1,t.length)),[e,t]}function s(t,e,i,r){var s,a,u,l,c=null,h=e?e.name:null,d=t,p=!0,f="";return t||(p=!1,t="_@r"+(D+=1)),l=o(t),c=l[0],t=l[1],c&&(c=n(c,h,r),a=getOwn(N,c)),t&&(c?f=i?t:a&&a.normalize?a.normalize(t,function(t){return n(t,h,r)}):t.indexOf("!")===-1?n(t,h,r):t:(f=n(t,h,r),l=o(f),c=l[0],f=l[1],i=!0,s=y.nameToUrl(f))),u=!c||a||i?"":"_unnormalized"+(V+=1),{prefix:c,name:f,parentMap:e,unnormalized:!!u,url:s,originalName:d,isDefine:p,id:(c?c+"!"+f:f)+u}}function a(t){var e=t.id,n=getOwn(C,e);return n||(n=C[e]=new y.Module(t)),n}function u(t,e,n){var i=t.id,r=getOwn(C,i);!hasProp(N,i)||r&&!r.defineEmitComplete?(r=a(t),r.error&&"error"===e?n(r.error):r.on(e,n)):"defined"===e&&n(N[i])}function l(t,e){var n=t.requireModules,i=!1;e?e(t):(each(n,function(e){var n=getOwn(C,e);n&&(n.error=t,n.events.error&&(i=!0,n.emit("error",t)))}),i||req.onError(t))}function c(){globalDefQueue.length&&(each(globalDefQueue,function(t){var e=t[0];"string"==typeof e&&(y.defQueueMap[e]=!0),O.push(t)}),globalDefQueue=[])}function h(t){delete C[t],delete T[t]}function d(t,e,n){var i=t.map.id;t.error?t.emit("error",t.error):(e[i]=!0,each(t.depMaps,function(i,r){var o=i.id,s=getOwn(C,o);!s||t.depMatched[r]||n[o]||(getOwn(e,o)?(t.defineDep(r,N[o]),t.check()):d(s,e,n))}),n[i]=!0)}function p(){var t,e,n=1e3*S.waitSeconds,o=n&&y.startTime+n<(new Date).getTime(),s=[],a=[],u=!1,c=!0;if(!v){if(v=!0,eachProp(T,function(t){var n=t.map,l=n.id;if(t.enabled&&(n.isDefine||a.push(t),!t.error))if(!t.inited&&o)r(l)?(e=!0,u=!0):(s.push(l),i(l));else if(!t.inited&&t.fetched&&n.isDefine&&(u=!0,!n.prefix))return c=!1}),o&&s.length)return t=makeError("timeout","Load timeout for modules: "+s,null,s),t.contextName=y.contextName,l(t);c&&each(a,function(t){d(t,{},{})}),o&&!e||!u||!isBrowser&&!isWebWorker||b||(b=setTimeout(function(){b=0,p()},50)),v=!1}}function f(t){hasProp(N,t[0])||a(s(t[0],null,!0)).init(t[1],t[2])}function g(t,e,n,i){t.detachEvent&&!isOpera?i&&t.detachEvent(i,e):t.removeEventListener(n,e,!1)}function m(t){var e=t.currentTarget||t.srcElement;return g(e,y.onScriptLoad,"load","onreadystatechange"),g(e,y.onScriptError,"error"),{node:e,id:e&&e.getAttribute("data-requiremodule")}}function x(){var t;for(c();O.length;){if(t=O.shift(),null===t[0])return l(makeError("mismatch","Mismatched anonymous define() module: "+t[t.length-1]));f(t)}y.defQueueMap={}}var v,_,y,w,b,S={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},C={},T={},F={},O=[],N={},E={},M={},D=1,V=1;return w={require:function(t){return t.require?t.require:t.require=y.makeRequire(t.map)},exports:function(t){if(t.usingExports=!0,t.map.isDefine)return t.exports?N[t.map.id]=t.exports:t.exports=N[t.map.id]={}},module:function(t){return t.module?t.module:t.module={id:t.map.id,uri:t.map.url,config:function(){return getOwn(S.config,t.map.id)||{}},exports:t.exports||(t.exports={})}}},_=function(t){this.events=getOwn(F,t.id)||{},this.map=t,this.shim=getOwn(S.shim,t.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},_.prototype={init:function(t,e,n,i){i=i||{},this.inited||(this.factory=e,n?this.on("error",n):this.events.error&&(n=bind(this,function(t){this.emit("error",t)})),this.depMaps=t&&t.slice(0),this.errback=n,this.inited=!0,this.ignore=i.ignore,i.enabled||this.enabled?this.enable():this.check())},defineDep:function(t,e){this.depMatched[t]||(this.depMatched[t]=!0,this.depCount-=1,this.depExports[t]=e)},fetch:function(){if(!this.fetched){this.fetched=!0,y.startTime=(new Date).getTime();var t=this.map;if(!this.shim)return t.prefix?this.callPlugin():this.load();y.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return t.prefix?this.callPlugin():this.load()}))}},load:function(){var t=this.map.url;E[t]||(E[t]=!0,y.load(this.map.id,t))},check:function(){if(this.enabled&&!this.enabling){var t,e,n=this.map.id,i=this.depExports,r=this.exports,o=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(o)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{r=y.execCb(n,o,i,r)}catch(e){t=e}else r=y.execCb(n,o,i,r);if(this.map.isDefine&&void 0===r&&(e=this.module,e?r=e.exports:this.usingExports&&(r=this.exports)),t)return t.requireMap=this.map,t.requireModules=this.map.isDefine?[this.map.id]:null,t.requireType=this.map.isDefine?"define":"require",l(this.error=t)}else r=o;if(this.exports=r,this.map.isDefine&&!this.ignore&&(N[n]=r,req.onResourceLoad)){var s=[];each(this.depMaps,function(t){s.push(t.normalizedMap||t)}),req.onResourceLoad(y,this.map,s)}h(n),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else hasProp(y.defQueueMap,n)||this.fetch()}},callPlugin:function(){var t=this.map,e=t.id,i=s(t.prefix);this.depMaps.push(i),u(i,"defined",bind(this,function(i){var r,o,c,d=getOwn(M,this.map.id),p=this.map.name,f=this.map.parentMap?this.map.parentMap.name:null,g=y.makeRequire(t.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(i.normalize&&(p=i.normalize(p,function(t){return n(t,f,!0)})||""),o=s(t.prefix+"!"+p,this.map.parentMap,!0),u(o,"defined",bind(this,function(t){this.map.normalizedMap=o,this.init([],function(){return t},null,{enabled:!0,ignore:!0})})),void((c=getOwn(C,o.id))&&(this.depMaps.push(o),this.events.error&&c.on("error",bind(this,function(t){this.emit("error",t)})),c.enable()))):d?(this.map.url=y.nameToUrl(d),void this.load()):(r=bind(this,function(t){this.init([],function(){return t},null,{enabled:!0})}),r.error=bind(this,function(t){this.inited=!0,this.error=t,t.requireModules=[e],eachProp(C,function(t){0===t.map.id.indexOf(e+"_unnormalized")&&h(t.map.id)}),l(t)}),r.fromText=bind(this,function(n,i){var o=t.name,u=s(o),c=useInteractive;i&&(n=i),c&&(useInteractive=!1),a(u),hasProp(S.config,e)&&(S.config[o]=S.config[e]);try{req.exec(n)}catch(t){return l(makeError("fromtexteval","fromText eval for "+e+" failed: "+t,t,[e]))}c&&(useInteractive=!0),this.depMaps.push(u),y.completeLoad(o),g([o],r)}),void i.load(t.name,g,r,S))})),y.enable(i,this),this.pluginMaps[i.id]=i},enable:function(){T[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(t,e){var n,i,r;if("string"==typeof t){if(t=s(t,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[e]=t,r=getOwn(w,t.id))return void(this.depExports[e]=r(this));this.depCount+=1,u(t,"defined",bind(this,function(t){this.undefed||(this.defineDep(e,t),this.check())})),this.errback?u(t,"error",bind(this,this.errback)):this.events.error&&u(t,"error",bind(this,function(t){this.emit("error",t)}))}n=t.id,i=C[n],hasProp(w,n)||!i||i.enabled||y.enable(t,this)})),eachProp(this.pluginMaps,bind(this,function(t){var e=getOwn(C,t.id);e&&!e.enabled&&y.enable(t,this)})),this.enabling=!1,this.check()},on:function(t,e){var n=this.events[t];n||(n=this.events[t]=[]),n.push(e)},emit:function(t,e){each(this.events[t],function(t){t(e)}),"error"===t&&delete this.events[t]}},y={config:S,contextName:t,registry:C,defined:N,urlFetched:E,defQueue:O,defQueueMap:{},Module:_,makeModuleMap:s,nextTick:req.nextTick,onError:l,configure:function(t){if(t.baseUrl&&"/"!==t.baseUrl.charAt(t.baseUrl.length-1)&&(t.baseUrl+="/"),"string"==typeof t.urlArgs){var e=t.urlArgs;t.urlArgs=function(t,n){return(n.indexOf("?")===-1?"?":"&")+e}}var n=S.shim,i={paths:!0,bundles:!0,config:!0,map:!0};eachProp(t,function(t,e){i[e]?(S[e]||(S[e]={}),mixin(S[e],t,!0,!0)):S[e]=t}),t.bundles&&eachProp(t.bundles,function(t,e){each(t,function(t){t!==e&&(M[t]=e)})}),t.shim&&(eachProp(t.shim,function(t,e){isArray(t)&&(t={deps:t}),!t.exports&&!t.init||t.exportsFn||(t.exportsFn=y.makeShimExports(t)),n[e]=t}),S.shim=n),t.packages&&each(t.packages,function(t){var e,n;t="string"==typeof t?{name:t}:t,n=t.name,e=t.location,e&&(S.paths[n]=t.location),S.pkgs[n]=t.name+"/"+(t.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(C,function(t,e){t.inited||t.map.unnormalized||(t.map=s(e,null,!0))}),(t.deps||t.callback)&&y.require(t.deps||[],t.callback)},makeShimExports:function(t){function e(){var e;return t.init&&(e=t.init.apply(global,arguments)),e||t.exports&&getGlobal(t.exports)}return e},makeRequire:function(e,r){function o(n,i,u){var c,h,d;return r.enableBuildCallback&&i&&isFunction(i)&&(i.__requireJsBuild=!0),"string"==typeof n?isFunction(i)?l(makeError("requireargs","Invalid require call"),u):e&&hasProp(w,n)?w[n](C[e.id]):req.get?req.get(y,n,e,o):(h=s(n,e,!1,!0),c=h.id,hasProp(N,c)?N[c]:l(makeError("notloaded",'Module name "'+c+'" has not been loaded yet for context: '+t+(e?"":". Use require([])")))):(x(),y.nextTick(function(){x(),d=a(s(null,e)),d.skipMap=r.skipMap,d.init(n,i,u,{enabled:!0}),p()}),o)}return r=r||{},mixin(o,{isBrowser:isBrowser,toUrl:function(t){var i,r=t.lastIndexOf("."),o=t.split("/")[0],s="."===o||".."===o;return r!==-1&&(!s||r>1)&&(i=t.substring(r,t.length),t=t.substring(0,r)),y.nameToUrl(n(t,e&&e.id,!0),i,!0)},defined:function(t){return hasProp(N,s(t,e,!1,!0).id)},specified:function(t){return t=s(t,e,!1,!0).id,hasProp(N,t)||hasProp(C,t)}}),e||(o.undef=function(t){c();var n=s(t,e,!0),r=getOwn(C,t);r.undefed=!0,i(t),delete N[t],delete E[n.url],delete F[t],eachReverse(O,function(e,n){e[0]===t&&O.splice(n,1)}),delete y.defQueueMap[t],r&&(r.events.defined&&(F[t]=r.events),h(t))}),o},enable:function(t){getOwn(C,t.id)&&a(t).enable()},completeLoad:function(t){var e,n,i,o=getOwn(S.shim,t)||{},s=o.exports;for(c();O.length;){if(n=O.shift(),null===n[0]){if(n[0]=t,e)break;e=!0}else n[0]===t&&(e=!0);f(n)}if(y.defQueueMap={},i=getOwn(C,t),!e&&!hasProp(N,t)&&i&&!i.inited){if(!(!S.enforceDefine||s&&getGlobal(s)))return r(t)?void 0:l(makeError("nodefine","No define call for "+t,null,[t]));f([t,o.deps||[],o.exportsFn])}p()},nameToUrl:function(t,e,n){var i,r,o,s,a,u,l,c=getOwn(S.pkgs,t);if(c&&(t=c),l=getOwn(M,t))return y.nameToUrl(l,e,n);if(req.jsExtRegExp.test(t))a=t+(e||"");else{for(i=S.paths,r=t.split("/"),o=r.length;o>0;o-=1)if(s=r.slice(0,o).join("/"),u=getOwn(i,s)){isArray(u)&&(u=u[0]),r.splice(0,o,u);break}a=r.join("/"),a+=e||(/^data\:|^blob\:|\?/.test(a)||n?"":".js"),a=("/"===a.charAt(0)||a.match(/^[\w\+\.\-]+:/)?"":S.baseUrl)+a}return S.urlArgs&&!/^blob\:/.test(a)?a+S.urlArgs(t,a):a},load:function(t,e){req.load(y,t,e)},execCb:function(t,e,n,i){return e.apply(i,n)},onScriptLoad:function(t){if("load"===t.type||readyRegExp.test((t.currentTarget||t.srcElement).readyState)){interactiveScript=null;var e=m(t);y.completeLoad(e.id)}},onScriptError:function(t){var e=m(t);if(!r(e.id)){var n=[];return eachProp(C,function(t,i){0!==i.indexOf("_@r")&&each(t.depMaps,function(t){if(t.id===e.id)return n.push(i),!0})}),l(makeError("scripterror",'Script error for "'+e.id+(n.length?'", needed by: '+n.join(", "):'"'),t,[e.id]))}}},y.require=y.makeRequire(),y}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(t){if("interactive"===t.readyState)return interactiveScript=t}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.3.6",commentRegExp=/\/\*[\s\S]*?\*\/|([^:"'=]|^)\/\/.*$/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if(void 0===define){if(void 0!==requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}void 0===require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(t,e,n,i){var r,o,s="_";return isArray(t)||"string"==typeof t||(o=t,isArray(e)?(t=e,e=n,n=i):t=[]),o&&o.context&&(s=o.context),r=getOwn(contexts,s),r||(r=contexts[s]=req.s.newContext(s)),o&&r.configure(o),r.require(t,e,n)},req.config=function(t){return req(t)},req.nextTick=void 0!==setTimeout?function(t){setTimeout(t,4)}:function(t){t()},require||(require=req),req.version="2.3.6",req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(t){req[t]=function(){var e=contexts._;return e.require[t].apply(e,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],(baseElement=document.getElementsByTagName("base")[0])&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(t,e,n){var i=t.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return i.type=t.scriptType||"text/javascript",i.charset="utf-8",i.async=!0,i},req.load=function(t,e,n){var i,r=t&&t.config||{};if(isBrowser)return i=req.createNode(r,e,n),i.setAttribute("data-requirecontext",t.contextName),i.setAttribute("data-requiremodule",e),!i.attachEvent||i.attachEvent.toString&&i.attachEvent.toString().indexOf("[native code")<0||isOpera?(i.addEventListener("load",t.onScriptLoad,!1),i.addEventListener("error",t.onScriptError,!1)):(useInteractive=!0,i.attachEvent("onreadystatechange",t.onScriptLoad)),i.src=n,r.onNodeCreated&&r.onNodeCreated(i,r,e,n),currentlyAddingScript=i,baseElement?head.insertBefore(i,baseElement):head.appendChild(i),currentlyAddingScript=null,i;if(isWebWorker)try{setTimeout(function(){},0),importScripts(n),t.completeLoad(e)}catch(i){t.onError(makeError("importscripts","importScripts failed for "+e+" at "+n,i,[e]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(t){if(head||(head=t.parentNode),dataMain=t.getAttribute("data-main"))return mainScript=dataMain,cfg.baseUrl||mainScript.indexOf("!")!==-1||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0}),define=function(t,e,n){var i,r;"string"!=typeof t&&(n=e,e=t,t=null),isArray(e)||(n=e,e=null),!e&&isFunction(n)&&(e=[],n.length&&(n.toString().replace(/\/\*[\s\S]*?\*\/|([^:"'=]|^)\/\/.*$/gm,commentReplace).replace(/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,function(t,n){e.push(n)}),e=(1===n.length?["require"]:["require","exports","module"]).concat(e))),useInteractive&&(i=currentlyAddingScript||getInteractiveScript())&&(t||(t=i.getAttribute("data-requiremodule")),r=contexts[i.getAttribute("data-requirecontext")]),r?(r.defQueue.push([t,e,n]),r.defQueueMap[t]=!0):globalDefQueue.push([t,e,n])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this,"undefined"==typeof setTimeout?void 0:setTimeout),define("../node_modules/requirejs/require.js",function(){}),function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,function(t,e){function n(t,e,n){e=e||st;var i,r=e.createElement("script");if(r.text=t,n)for(i in yt)n[i]&&(r[i]=n[i]);e.head.appendChild(r).parentNode.removeChild(r)}function i(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?dt[pt.call(t)]||"object":typeof t}function r(t){var e=!!t&&"length"in t&&t.length,n=i(t);return!vt(t)&&!_t(t)&&("array"===n||0===e||"number"==typeof e&&e>0&&e-1 in t)}function o(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}function s(t,e,n){return vt(e)?wt.grep(t,function(t,i){return!!e.call(t,i,t)!==n}):e.nodeType?wt.grep(t,function(t){return t===e!==n}):"string"!=typeof e?wt.grep(t,function(t){return ht.call(e,t)>-1!==n}):wt.filter(e,t,n)}function a(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}function u(t){var e={};return wt.each(t.match(Dt)||[],function(t,n){e[n]=!0}),e}function l(t){return t}function c(t){throw t}function h(t,e,n,i){var r;try{t&&vt(r=t.promise)?r.call(t).done(e).fail(n):t&&vt(r=t.then)?r.call(t,e,n):e.apply(void 0,[t].slice(i))}catch(t){n.apply(void 0,[t])}}function d(){st.removeEventListener("DOMContentLoaded",d),t.removeEventListener("load",d),wt.ready()}function p(t,e){return e.toUpperCase()}function f(t){return t.replace(Lt,"ms-").replace(At,p)}function g(){this.expando=wt.expando+g.uid++}function m(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:Ut.test(t)?JSON.parse(t):t)}function x(t,e,n){var i;if(void 0===n&&1===t.nodeType)if(i="data-"+e.replace(zt,"-$&").toLowerCase(),"string"==typeof(n=t.getAttribute(i))){try{n=m(n)}catch(t){}kt.set(t,e,n)}else n=void 0;return n}function v(t,e,n,i){var r,o,s=20,a=i?function(){return i.cur()}:function(){return wt.css(t,e,"")},u=a(),l=n&&n[3]||(wt.cssNumber[e]?"":"px"),c=(wt.cssNumber[e]||"px"!==l&&+u)&&jt.exec(wt.css(t,e));if(c&&c[3]!==l){for(u/=2,l=l||c[3],c=+u||1;s--;)wt.style(t,e,c+l),(1-o)*(1-(o=a()/u||.5))<=0&&(s=0),c/=o;c*=2,wt.style(t,e,c+l),n=n||[]}return n&&(c=+c||+u||0,r=n[1]?c+(n[1]+1)*n[2]:+n[2],i&&(i.unit=l,i.start=c,i.end=r)),r}function _(t){var e,n=t.ownerDocument,i=t.nodeName,r=Wt[i];return r?r:(e=n.body.appendChild(n.createElement(i)),r=wt.css(e,"display"),e.parentNode.removeChild(e),"none"===r&&(r="block"),Wt[i]=r,r)}function y(t,e){for(var n,i,r=[],o=0,s=t.length;o<s;o++)i=t[o],i.style&&(n=i.style.display,e?("none"===n&&(r[o]=Rt.get(i,"display")||null,r[o]||(i.style.display="")),""===i.style.display&&Ht(i)&&(r[o]=_(i))):"none"!==n&&(r[o]="none",Rt.set(i,"display",n)));for(o=0;o<s;o++)null!=r[o]&&(t[o].style.display=r[o]);return t}function w(t,e){var n;return n=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&o(t,e)?wt.merge([t],n):n}function b(t,e){for(var n=0,i=t.length;n<i;n++)Rt.set(t[n],"globalEval",!e||Rt.get(e[n],"globalEval"))}function S(t,e,n,r,o){for(var s,a,u,l,c,h,d=e.createDocumentFragment(),p=[],f=0,g=t.length;f<g;f++)if((s=t[f])||0===s)if("object"===i(s))wt.merge(p,s.nodeType?[s]:s);else if(Kt.test(s)){for(a=a||d.appendChild(e.createElement("div")),u=($t.exec(s)||["",""])[1].toLowerCase(),l=Qt[u]||Qt._default,a.innerHTML=l[1]+wt.htmlPrefilter(s)+l[2],h=l[0];h--;)a=a.lastChild;wt.merge(p,a.childNodes),a=d.firstChild,a.textContent=""}else p.push(e.createTextNode(s));for(d.textContent="",f=0;s=p[f++];)if(r&&wt.inArray(s,r)>-1)o&&o.push(s);else if(c=wt.contains(s.ownerDocument,s),a=w(d.appendChild(s),"script"),c&&b(a),n)for(h=0;s=a[h++];)Zt.test(s.type||"")&&n.push(s);return d}function C(){return!0}function T(){return!1}function F(){try{return st.activeElement}catch(t){}}function O(t,e,n,i,r,o){var s,a;if("object"==typeof e){"string"!=typeof n&&(i=i||n,n=void 0);for(a in e)O(t,a,n,i,e[a],o);return t}if(null==i&&null==r?(r=n,i=n=void 0):null==r&&("string"==typeof n?(r=i,i=void 0):(r=i,i=n,n=void 0)),r===!1)r=T;else if(!r)return t;return 1===o&&(s=r,r=function(t){return wt().off(t),s.apply(this,arguments)},r.guid=s.guid||(s.guid=wt.guid++)),t.each(function(){wt.event.add(this,e,r,i,n)})}function N(t,e){return o(t,"table")&&o(11!==e.nodeType?e:e.firstChild,"tr")?wt(t).children("tbody")[0]||t:t}function E(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function M(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function D(t,e){var n,i,r,o,s,a,u,l;if(1===e.nodeType){if(Rt.hasData(t)&&(o=Rt.access(t),s=Rt.set(e,o),l=o.events)){delete s.handle,s.events={};for(r in l)for(n=0,i=l[r].length;n<i;n++)wt.event.add(e,r,l[r][n])}kt.hasData(t)&&(a=kt.access(t),u=wt.extend({},a),kt.set(e,u))}}function V(t,e){var n=e.nodeName.toLowerCase();"input"===n&&Yt.test(t.type)?e.checked=t.checked:"input"!==n&&"textarea"!==n||(e.defaultValue=t.defaultValue)}function I(t,e,i,r){e=lt.apply([],e);var o,s,a,u,l,c,h=0,d=t.length,p=d-1,f=e[0],g=vt(f);if(g||d>1&&"string"==typeof f&&!xt.checkClone&&re.test(f))return t.each(function(n){var o=t.eq(n);g&&(e[0]=f.call(this,n,o.html())),I(o,e,i,r)});if(d&&(o=S(e,t[0].ownerDocument,!1,t,r),s=o.firstChild,1===o.childNodes.length&&(o=s),s||r)){for(a=wt.map(w(o,"script"),E),u=a.length;h<d;h++)l=o,h!==p&&(l=wt.clone(l,!0,!0),u&&wt.merge(a,w(l,"script"))),i.call(t[h],l,h);if(u)for(c=a[a.length-1].ownerDocument,wt.map(a,M),h=0;h<u;h++)l=a[h],Zt.test(l.type||"")&&!Rt.access(l,"globalEval")&&wt.contains(c,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?wt._evalUrl&&wt._evalUrl(l.src):n(l.textContent.replace(oe,""),c,l))}return t}function B(t,e,n){for(var i,r=e?wt.filter(e,t):t,o=0;null!=(i=r[o]);o++)n||1!==i.nodeType||wt.cleanData(w(i)),i.parentNode&&(n&&wt.contains(i.ownerDocument,i)&&b(w(i,"script")),i.parentNode.removeChild(i));return t}function L(t,e,n){var i,r,o,s,a=t.style;return n=n||ae(t),n&&(s=n.getPropertyValue(e)||n[e],""!==s||wt.contains(t.ownerDocument,t)||(s=wt.style(t,e)),!xt.pixelBoxStyles()&&se.test(s)&&ue.test(e)&&(i=a.width,r=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=n.width,a.width=i,a.minWidth=r,a.maxWidth=o)),void 0!==s?s+"":s}function A(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}function P(t){if(t in fe)return t;for(var e=t[0].toUpperCase()+t.slice(1),n=pe.length;n--;)if((t=pe[n]+e)in fe)return t}function R(t){var e=wt.cssProps[t];return e||(e=wt.cssProps[t]=P(t)||t),e}function k(t,e,n){var i=jt.exec(e);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):e}function U(t,e,n,i,r,o){var s="width"===e?1:0,a=0,u=0;if(n===(i?"border":"content"))return 0;for(;s<4;s+=2)"margin"===n&&(u+=wt.css(t,n+Gt[s],!0,r)),i?("content"===n&&(u-=wt.css(t,"padding"+Gt[s],!0,r)),"margin"!==n&&(u-=wt.css(t,"border"+Gt[s]+"Width",!0,r))):(u+=wt.css(t,"padding"+Gt[s],!0,r),"padding"!==n?u+=wt.css(t,"border"+Gt[s]+"Width",!0,r):a+=wt.css(t,"border"+Gt[s]+"Width",!0,r));return!i&&o>=0&&(u+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-o-u-a-.5))),u}function z(t,e,n){var i=ae(t),r=L(t,e,i),o="border-box"===wt.css(t,"boxSizing",!1,i),s=o;if(se.test(r)){if(!n)return r;r="auto"}return s=s&&(xt.boxSizingReliable()||r===t.style[e]),("auto"===r||!parseFloat(r)&&"inline"===wt.css(t,"display",!1,i))&&(r=t["offset"+e[0].toUpperCase()+e.slice(1)],s=!0),(r=parseFloat(r)||0)+U(t,e,n||(o?"border":"content"),s,i,r)+"px"}function X(t,e,n,i,r){return new X.prototype.init(t,e,n,i,r)}function j(){me&&(st.hidden===!1&&t.requestAnimationFrame?t.requestAnimationFrame(j):t.setTimeout(j,wt.fx.interval),wt.fx.tick())}function G(){return t.setTimeout(function(){ge=void 0}),ge=Date.now()}function H(t,e){var n,i=0,r={height:t};for(e=e?1:0;i<4;i+=2-e)n=Gt[i],r["margin"+n]=r["padding"+n]=t;return e&&(r.opacity=r.width=t),r}function q(t,e,n){for(var i,r=($.tweeners[e]||[]).concat($.tweeners["*"]),o=0,s=r.length;o<s;o++)if(i=r[o].call(n,e,t))return i}function W(t,e,n){var i,r,o,s,a,u,l,c,h="width"in e||"height"in e,d=this,p={},f=t.style,g=t.nodeType&&Ht(t),m=Rt.get(t,"fxshow");n.queue||(s=wt._queueHooks(t,"fx"),null==s.unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,d.always(function(){d.always(function(){s.unqueued--,wt.queue(t,"fx").length||s.empty.fire()})}));for(i in e)if(r=e[i],xe.test(r)){if(delete e[i],o=o||"toggle"===r,r===(g?"hide":"show")){if("show"!==r||!m||void 0===m[i])continue;g=!0}p[i]=m&&m[i]||wt.style(t,i)}if((u=!wt.isEmptyObject(e))||!wt.isEmptyObject(p)){h&&1===t.nodeType&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],l=m&&m.display,null==l&&(l=Rt.get(t,"display")),c=wt.css(t,"display"),"none"===c&&(l?c=l:(y([t],!0),l=t.style.display||l,c=wt.css(t,"display"),y([t]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===wt.css(t,"float")&&(u||(d.done(function(){f.display=l}),null==l&&(c=f.display,l="none"===c?"":c)),f.display="inline-block")),n.overflow&&(f.overflow="hidden",d.always(function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]})),u=!1;for(i in p)u||(m?"hidden"in m&&(g=m.hidden):m=Rt.access(t,"fxshow",{display:l}),o&&(m.hidden=!g),g&&y([t],!0),d.done(function(){g||y([t]),Rt.remove(t,"fxshow");for(i in p)wt.style(t,i,p[i])})),u=q(g?m[i]:0,i,d),i in m||(m[i]=u.start,g&&(u.end=u.start,u.start=0))}}function Y(t,e){var n,i,r,o,s;for(n in t)if(i=f(n),r=e[i],o=t[n],Array.isArray(o)&&(r=o[1],o=t[n]=o[0]),n!==i&&(t[i]=o,delete t[n]),(s=wt.cssHooks[i])&&"expand"in s){o=s.expand(o),delete t[i];for(n in o)n in t||(t[n]=o[n],e[n]=r)}else e[i]=r}function $(t,e,n){var i,r,o=0,s=$.prefilters.length,a=wt.Deferred().always(function(){delete u.elem}),u=function(){if(r)return!1;for(var e=ge||G(),n=Math.max(0,l.startTime+l.duration-e),i=n/l.duration||0,o=1-i,s=0,u=l.tweens.length;s<u;s++)l.tweens[s].run(o);return a.notifyWith(t,[l,o,n]),o<1&&u?n:(u||a.notifyWith(t,[l,1,0]),a.resolveWith(t,[l]),!1)},l=a.promise({elem:t,props:wt.extend({},e),opts:wt.extend(!0,{specialEasing:{},easing:wt.easing._default},n),originalProperties:e,originalOptions:n,startTime:ge||G(),duration:n.duration,tweens:[],createTween:function(e,n){var i=wt.Tween(t,l.opts,e,n,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(i),i},stop:function(e){var n=0,i=e?l.tweens.length:0;if(r)return this;for(r=!0;n<i;n++)l.tweens[n].run(1);return e?(a.notifyWith(t,[l,1,0]),a.resolveWith(t,[l,e])):a.rejectWith(t,[l,e]),this}}),c=l.props;for(Y(c,l.opts.specialEasing);o<s;o++)if(i=$.prefilters[o].call(l,t,c,l.opts))return vt(i.stop)&&(wt._queueHooks(l.elem,l.opts.queue).stop=i.stop.bind(i)),i;return wt.map(c,q,l),vt(l.opts.start)&&l.opts.start.call(t,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),wt.fx.timer(wt.extend(u,{elem:t,anim:l,queue:l.opts.queue})),l}function Z(t){return(t.match(Dt)||[]).join(" ")}function Q(t){return t.getAttribute&&t.getAttribute("class")||""}function K(t){return Array.isArray(t)?t:"string"==typeof t?t.match(Dt)||[]:[]}function J(t,e,n,r){var o;if(Array.isArray(e))wt.each(e,function(e,i){n||Ne.test(t)?r(t,i):J(t+"["+("object"==typeof i&&null!=i?e:"")+"]",i,n,r)});else if(n||"object"!==i(e))r(t,e);else for(o in e)J(t+"["+o+"]",e[o],n,r)}function tt(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var i,r=0,o=e.toLowerCase().match(Dt)||[];if(vt(n))for(;i=o[r++];)"+"===i[0]?(i=i.slice(1)||"*",(t[i]=t[i]||[]).unshift(n)):(t[i]=t[i]||[]).push(n)}}function et(t,e,n,i){function r(a){var u;return o[a]=!0,wt.each(t[a]||[],function(t,a){var l=a(e,n,i);return"string"!=typeof l||s||o[l]?s?!(u=l):void 0:(e.dataTypes.unshift(l),r(l),!1)}),u}var o={},s=t===Le;return r(e.dataTypes[0])||!o["*"]&&r("*")}function nt(t,e){var n,i,r=wt.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((r[n]?t:i||(i={}))[n]=e[n]);return i&&wt.extend(!0,t,i),t}function it(t,e,n){for(var i,r,o,s,a=t.contents,u=t.dataTypes;"*"===u[0];)u.shift(),void 0===i&&(i=t.mimeType||e.getResponseHeader("Content-Type"));if(i)for(r in a)if(a[r]&&a[r].test(i)){u.unshift(r);break}if(u[0]in n)o=u[0];else{for(r in n){if(!u[0]||t.converters[r+" "+u[0]]){o=r;break}s||(s=r)}o=o||s}if(o)return o!==u[0]&&u.unshift(o),n[o]}function rt(t,e,n,i){var r,o,s,a,u,l={},c=t.dataTypes.slice();if(c[1])for(s in t.converters)l[s.toLowerCase()]=t.converters[s];for(o=c.shift();o;)if(t.responseFields[o]&&(n[t.responseFields[o]]=e),!u&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(s=l[u+" "+o]||l["* "+o]))for(r in l)if(a=r.split(" "),a[1]===o&&(s=l[u+" "+a[0]]||l["* "+a[0]])){s===!0?s=l[r]:l[r]!==!0&&(o=a[0],c.unshift(a[1]));break}if(s!==!0)if(s&&t.throws)e=s(e);else try{e=s(e)}catch(t){return{state:"parsererror",error:s?t:"No conversion from "+u+" to "+o}}}return{state:"success",data:e}}var ot=[],st=t.document,at=Object.getPrototypeOf,ut=ot.slice,lt=ot.concat,ct=ot.push,ht=ot.indexOf,dt={},pt=dt.toString,ft=dt.hasOwnProperty,gt=ft.toString,mt=gt.call(Object),xt={},vt=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType},_t=function(t){return null!=t&&t===t.window},yt={type:!0,src:!0,noModule:!0},wt=function(t,e){return new wt.fn.init(t,e)};wt.fn=wt.prototype={jquery:"3.3.1",constructor:wt,length:0,toArray:function(){return ut.call(this)},get:function(t){return null==t?ut.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=wt.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return wt.each(this,t)},map:function(t){return this.pushStack(wt.map(this,function(e,n){return t.call(e,n,e)}))},slice:function(){return this.pushStack(ut.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,n=+t+(t<0?e:0);return this.pushStack(n>=0&&n<e?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:ct,sort:ot.sort,splice:ot.splice},wt.extend=wt.fn.extend=function(){var t,e,n,i,r,o,s=arguments[0]||{},a=1,u=arguments.length,l=!1;for("boolean"==typeof s&&(l=s,s=arguments[a]||{},a++),"object"==typeof s||vt(s)||(s={}),a===u&&(s=this,a--);a<u;a++)if(null!=(t=arguments[a]))for(e in t)n=s[e],i=t[e],
s!==i&&(l&&i&&(wt.isPlainObject(i)||(r=Array.isArray(i)))?(r?(r=!1,o=n&&Array.isArray(n)?n:[]):o=n&&wt.isPlainObject(n)?n:{},s[e]=wt.extend(l,o,i)):void 0!==i&&(s[e]=i));return s},wt.extend({expando:"jQuery"+("3.3.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,n;return!(!t||"[object Object]"!==pt.call(t))&&(!(e=at(t))||"function"==typeof(n=ft.call(e,"constructor")&&e.constructor)&&gt.call(n)===mt)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t){n(t)},each:function(t,e){var n,i=0;if(r(t))for(n=t.length;i<n&&e.call(t[i],i,t[i])!==!1;i++);else for(i in t)if(e.call(t[i],i,t[i])===!1)break;return t},trim:function(t){return null==t?"":(t+"").replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},makeArray:function(t,e){var n=e||[];return null!=t&&(r(Object(t))?wt.merge(n,"string"==typeof t?[t]:t):ct.call(n,t)),n},inArray:function(t,e,n){return null==e?-1:ht.call(e,t,n)},merge:function(t,e){for(var n=+e.length,i=0,r=t.length;i<n;i++)t[r++]=e[i];return t.length=r,t},grep:function(t,e,n){for(var i=[],r=0,o=t.length,s=!n;r<o;r++)!e(t[r],r)!==s&&i.push(t[r]);return i},map:function(t,e,n){var i,o,s=0,a=[];if(r(t))for(i=t.length;s<i;s++)null!=(o=e(t[s],s,n))&&a.push(o);else for(s in t)null!=(o=e(t[s],s,n))&&a.push(o);return lt.apply([],a)},guid:1,support:xt}),"function"==typeof Symbol&&(wt.fn[Symbol.iterator]=ot[Symbol.iterator]),wt.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){dt["[object "+e+"]"]=e.toLowerCase()});var bt=function(t){function e(t,e,n,i){var r,o,s,a,u,c,d,p=e&&e.ownerDocument,f=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==f&&9!==f&&11!==f)return n;if(!i&&((e?e.ownerDocument||e:k)!==D&&M(e),e=e||D,I)){if(11!==f&&(u=gt.exec(t)))if(r=u[1]){if(9===f){if(!(s=e.getElementById(r)))return n;if(s.id===r)return n.push(s),n}else if(p&&(s=p.getElementById(r))&&P(e,s)&&s.id===r)return n.push(s),n}else{if(u[2])return Z.apply(n,e.getElementsByTagName(t)),n;if((r=u[3])&&y.getElementsByClassName&&e.getElementsByClassName)return Z.apply(n,e.getElementsByClassName(r)),n}if(y.qsa&&!G[t+" "]&&(!B||!B.test(t))){if(1!==f)p=e,d=t;else if("object"!==e.nodeName.toLowerCase()){for((a=e.getAttribute("id"))?a=a.replace(_t,yt):e.setAttribute("id",a=R),c=C(t),o=c.length;o--;)c[o]="#"+a+" "+h(c[o]);d=c.join(","),p=mt.test(t)&&l(e.parentNode)||e}if(d)try{return Z.apply(n,p.querySelectorAll(d)),n}catch(t){}finally{a===R&&e.removeAttribute("id")}}}return F(t.replace(ot,"$1"),e,n,i)}function n(){function t(n,i){return e.push(n+" ")>w.cacheLength&&delete t[e.shift()],t[n+" "]=i}var e=[];return t}function i(t){return t[R]=!0,t}function r(t){var e=D.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function o(t,e){for(var n=t.split("|"),i=n.length;i--;)w.attrHandle[n[i]]=e}function s(t,e){var n=e&&t,i=n&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(i)return i;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function a(t){return function(e){return"form"in e?e.parentNode&&e.disabled===!1?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&bt(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function u(t){return i(function(e){return e=+e,i(function(n,i){for(var r,o=t([],n.length,e),s=o.length;s--;)n[r=o[s]]&&(n[r]=!(i[r]=n[r]))})})}function l(t){return t&&void 0!==t.getElementsByTagName&&t}function c(){}function h(t){for(var e=0,n=t.length,i="";e<n;e++)i+=t[e].value;return i}function d(t,e,n){var i=e.dir,r=e.next,o=r||i,s=n&&"parentNode"===o,a=z++;return e.first?function(e,n,r){for(;e=e[i];)if(1===e.nodeType||s)return t(e,n,r);return!1}:function(e,n,u){var l,c,h,d=[U,a];if(u){for(;e=e[i];)if((1===e.nodeType||s)&&t(e,n,u))return!0}else for(;e=e[i];)if(1===e.nodeType||s)if(h=e[R]||(e[R]={}),c=h[e.uniqueID]||(h[e.uniqueID]={}),r&&r===e.nodeName.toLowerCase())e=e[i]||e;else{if((l=c[o])&&l[0]===U&&l[1]===a)return d[2]=l[2];if(c[o]=d,d[2]=t(e,n,u))return!0}return!1}}function p(t){return t.length>1?function(e,n,i){for(var r=t.length;r--;)if(!t[r](e,n,i))return!1;return!0}:t[0]}function f(t,n,i){for(var r=0,o=n.length;r<o;r++)e(t,n[r],i);return i}function g(t,e,n,i,r){for(var o,s=[],a=0,u=t.length,l=null!=e;a<u;a++)(o=t[a])&&(n&&!n(o,i,r)||(s.push(o),l&&e.push(a)));return s}function m(t,e,n,r,o,s){return r&&!r[R]&&(r=m(r)),o&&!o[R]&&(o=m(o,s)),i(function(i,s,a,u){var l,c,h,d=[],p=[],m=s.length,x=i||f(e||"*",a.nodeType?[a]:a,[]),v=!t||!i&&e?x:g(x,d,t,a,u),_=n?o||(i?t:m||r)?[]:s:v;if(n&&n(v,_,a,u),r)for(l=g(_,p),r(l,[],a,u),c=l.length;c--;)(h=l[c])&&(_[p[c]]=!(v[p[c]]=h));if(i){if(o||t){if(o){for(l=[],c=_.length;c--;)(h=_[c])&&l.push(v[c]=h);o(null,_=[],l,u)}for(c=_.length;c--;)(h=_[c])&&(l=o?K(i,h):d[c])>-1&&(i[l]=!(s[l]=h))}}else _=g(_===s?_.splice(m,_.length):_),o?o(null,s,_,u):Z.apply(s,_)})}function x(t){for(var e,n,i,r=t.length,o=w.relative[t[0].type],s=o||w.relative[" "],a=o?1:0,u=d(function(t){return t===e},s,!0),l=d(function(t){return K(e,t)>-1},s,!0),c=[function(t,n,i){var r=!o&&(i||n!==O)||((e=n).nodeType?u(t,n,i):l(t,n,i));return e=null,r}];a<r;a++)if(n=w.relative[t[a].type])c=[d(p(c),n)];else{if(n=w.filter[t[a].type].apply(null,t[a].matches),n[R]){for(i=++a;i<r&&!w.relative[t[i].type];i++);return m(a>1&&p(c),a>1&&h(t.slice(0,a-1).concat({value:" "===t[a-2].type?"*":""})).replace(ot,"$1"),n,a<i&&x(t.slice(a,i)),i<r&&x(t=t.slice(i)),i<r&&h(t))}c.push(n)}return p(c)}function v(t,n){var r=n.length>0,o=t.length>0,s=function(i,s,a,u,l){var c,h,d,p=0,f="0",m=i&&[],x=[],v=O,_=i||o&&w.find.TAG("*",l),y=U+=null==v?1:Math.random()||.1,b=_.length;for(l&&(O=s===D||s||l);f!==b&&null!=(c=_[f]);f++){if(o&&c){for(h=0,s||c.ownerDocument===D||(M(c),a=!I);d=t[h++];)if(d(c,s||D,a)){u.push(c);break}l&&(U=y)}r&&((c=!d&&c)&&p--,i&&m.push(c))}if(p+=f,r&&f!==p){for(h=0;d=n[h++];)d(m,x,s,a);if(i){if(p>0)for(;f--;)m[f]||x[f]||(x[f]=Y.call(u));x=g(x)}Z.apply(u,x),l&&!i&&x.length>0&&p+n.length>1&&e.uniqueSort(u)}return l&&(U=y,O=v),m};return r?i(s):s}var _,y,w,b,S,C,T,F,O,N,E,M,D,V,I,B,L,A,P,R="sizzle"+1*new Date,k=t.document,U=0,z=0,X=n(),j=n(),G=n(),H=function(t,e){return t===e&&(E=!0),0},q={}.hasOwnProperty,W=[],Y=W.pop,$=W.push,Z=W.push,Q=W.slice,K=function(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1},J="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",tt="[\\x20\\t\\r\\n\\f]",et="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",nt="\\["+tt+"*("+et+")(?:"+tt+"*([*^$|!~]?=)"+tt+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+et+"))|)"+tt+"*\\]",it=":("+et+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+nt+")*)|.*)\\)|)",rt=new RegExp(tt+"+","g"),ot=new RegExp("^"+tt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+tt+"+$","g"),st=new RegExp("^"+tt+"*,"+tt+"*"),at=new RegExp("^"+tt+"*([>+~]|"+tt+")"+tt+"*"),ut=new RegExp("="+tt+"*([^\\]'\"]*?)"+tt+"*\\]","g"),lt=new RegExp(it),ct=new RegExp("^"+et+"$"),ht={ID:new RegExp("^#("+et+")"),CLASS:new RegExp("^\\.("+et+")"),TAG:new RegExp("^("+et+"|[*])"),ATTR:new RegExp("^"+nt),PSEUDO:new RegExp("^"+it),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+tt+"*(even|odd|(([+-]|)(\\d*)n|)"+tt+"*(?:([+-]|)"+tt+"*(\\d+)|))"+tt+"*\\)|)","i"),bool:new RegExp("^(?:"+J+")$","i"),needsContext:new RegExp("^"+tt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+tt+"*((?:-\\d)?\\d*)"+tt+"*\\)|)(?=[^-]|$)","i")},dt=/^(?:input|select|textarea|button)$/i,pt=/^h\d$/i,ft=/^[^{]+\{\s*\[native \w/,gt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,mt=/[+~]/,xt=new RegExp("\\\\([\\da-f]{1,6}"+tt+"?|("+tt+")|.)","ig"),vt=function(t,e,n){var i="0x"+e-65536;return i!==i||n?e:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},_t=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,yt=function(t,e){return e?"\0"===t?"�":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},wt=function(){M()},bt=d(function(t){return t.disabled===!0&&("form"in t||"label"in t)},{dir:"parentNode",next:"legend"});try{Z.apply(W=Q.call(k.childNodes),k.childNodes),W[k.childNodes.length].nodeType}catch(t){Z={apply:W.length?function(t,e){$.apply(t,Q.call(e))}:function(t,e){for(var n=t.length,i=0;t[n++]=e[i++];);t.length=n-1}}}y=e.support={},S=e.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},M=e.setDocument=function(t){var e,n,i=t?t.ownerDocument||t:k;return i!==D&&9===i.nodeType&&i.documentElement?(D=i,V=D.documentElement,I=!S(D),k!==D&&(n=D.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",wt,!1):n.attachEvent&&n.attachEvent("onunload",wt)),y.attributes=r(function(t){return t.className="i",!t.getAttribute("className")}),y.getElementsByTagName=r(function(t){return t.appendChild(D.createComment("")),!t.getElementsByTagName("*").length}),y.getElementsByClassName=ft.test(D.getElementsByClassName),y.getById=r(function(t){return V.appendChild(t).id=R,!D.getElementsByName||!D.getElementsByName(R).length}),y.getById?(w.filter.ID=function(t){var e=t.replace(xt,vt);return function(t){return t.getAttribute("id")===e}},w.find.ID=function(t,e){if(void 0!==e.getElementById&&I){var n=e.getElementById(t);return n?[n]:[]}}):(w.filter.ID=function(t){var e=t.replace(xt,vt);return function(t){var n=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}},w.find.ID=function(t,e){if(void 0!==e.getElementById&&I){var n,i,r,o=e.getElementById(t);if(o){if((n=o.getAttributeNode("id"))&&n.value===t)return[o];for(r=e.getElementsByName(t),i=0;o=r[i++];)if((n=o.getAttributeNode("id"))&&n.value===t)return[o]}return[]}}),w.find.TAG=y.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):y.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,i=[],r=0,o=e.getElementsByTagName(t);if("*"===t){for(;n=o[r++];)1===n.nodeType&&i.push(n);return i}return o},w.find.CLASS=y.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&I)return e.getElementsByClassName(t)},L=[],B=[],(y.qsa=ft.test(D.querySelectorAll))&&(r(function(t){V.appendChild(t).innerHTML="<a id='"+R+"'></a><select id='"+R+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&B.push("[*^$]="+tt+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||B.push("\\["+tt+"*(?:value|"+J+")"),t.querySelectorAll("[id~="+R+"-]").length||B.push("~="),t.querySelectorAll(":checked").length||B.push(":checked"),t.querySelectorAll("a#"+R+"+*").length||B.push(".#.+[+~]")}),r(function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=D.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&B.push("name"+tt+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&B.push(":enabled",":disabled"),V.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&B.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),B.push(",.*:")})),(y.matchesSelector=ft.test(A=V.matches||V.webkitMatchesSelector||V.mozMatchesSelector||V.oMatchesSelector||V.msMatchesSelector))&&r(function(t){y.disconnectedMatch=A.call(t,"*"),A.call(t,"[s!='']:x"),L.push("!=",it)}),B=B.length&&new RegExp(B.join("|")),L=L.length&&new RegExp(L.join("|")),e=ft.test(V.compareDocumentPosition),P=e||ft.test(V.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},H=e?function(t,e){if(t===e)return E=!0,0;var n=!t.compareDocumentPosition-!e.compareDocumentPosition;return n?n:(n=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1,1&n||!y.sortDetached&&e.compareDocumentPosition(t)===n?t===D||t.ownerDocument===k&&P(k,t)?-1:e===D||e.ownerDocument===k&&P(k,e)?1:N?K(N,t)-K(N,e):0:4&n?-1:1)}:function(t,e){if(t===e)return E=!0,0;var n,i=0,r=t.parentNode,o=e.parentNode,a=[t],u=[e];if(!r||!o)return t===D?-1:e===D?1:r?-1:o?1:N?K(N,t)-K(N,e):0;if(r===o)return s(t,e);for(n=t;n=n.parentNode;)a.unshift(n);for(n=e;n=n.parentNode;)u.unshift(n);for(;a[i]===u[i];)i++;return i?s(a[i],u[i]):a[i]===k?-1:u[i]===k?1:0},D):D},e.matches=function(t,n){return e(t,null,null,n)},e.matchesSelector=function(t,n){if((t.ownerDocument||t)!==D&&M(t),n=n.replace(ut,"='$1']"),y.matchesSelector&&I&&!G[n+" "]&&(!L||!L.test(n))&&(!B||!B.test(n)))try{var i=A.call(t,n);if(i||y.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){}return e(n,D,null,[t]).length>0},e.contains=function(t,e){return(t.ownerDocument||t)!==D&&M(t),P(t,e)},e.attr=function(t,e){(t.ownerDocument||t)!==D&&M(t);var n=w.attrHandle[e.toLowerCase()],i=n&&q.call(w.attrHandle,e.toLowerCase())?n(t,e,!I):void 0;return void 0!==i?i:y.attributes||!I?t.getAttribute(e):(i=t.getAttributeNode(e))&&i.specified?i.value:null},e.escape=function(t){return(t+"").replace(_t,yt)},e.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},e.uniqueSort=function(t){var e,n=[],i=0,r=0;if(E=!y.detectDuplicates,N=!y.sortStable&&t.slice(0),t.sort(H),E){for(;e=t[r++];)e===t[r]&&(i=n.push(r));for(;i--;)t.splice(n[i],1)}return N=null,t},b=e.getText=function(t){var e,n="",i=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=b(t)}else if(3===r||4===r)return t.nodeValue}else for(;e=t[i++];)n+=b(e);return n},w=e.selectors={cacheLength:50,createPseudo:i,match:ht,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(xt,vt),t[3]=(t[3]||t[4]||t[5]||"").replace(xt,vt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||e.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&e.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return ht.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&lt.test(n)&&(e=C(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(xt,vt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=X[t+" "];return e||(e=new RegExp("(^|"+tt+")"+t+"("+tt+"|$)"))&&X(t,function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(t,n,i){return function(r){var o=e.attr(r,t);return null==o?"!="===n:!n||(o+="","="===n?o===i:"!="===n?o!==i:"^="===n?i&&0===o.indexOf(i):"*="===n?i&&o.indexOf(i)>-1:"$="===n?i&&o.slice(-i.length)===i:"~="===n?(" "+o.replace(rt," ")+" ").indexOf(i)>-1:"|="===n&&(o===i||o.slice(0,i.length+1)===i+"-"))}},CHILD:function(t,e,n,i,r){var o="nth"!==t.slice(0,3),s="last"!==t.slice(-4),a="of-type"===e;return 1===i&&0===r?function(t){return!!t.parentNode}:function(e,n,u){var l,c,h,d,p,f,g=o!==s?"nextSibling":"previousSibling",m=e.parentNode,x=a&&e.nodeName.toLowerCase(),v=!u&&!a,_=!1;if(m){if(o){for(;g;){for(d=e;d=d[g];)if(a?d.nodeName.toLowerCase()===x:1===d.nodeType)return!1;f=g="only"===t&&!f&&"nextSibling"}return!0}if(f=[s?m.firstChild:m.lastChild],s&&v){for(d=m,h=d[R]||(d[R]={}),c=h[d.uniqueID]||(h[d.uniqueID]={}),l=c[t]||[],p=l[0]===U&&l[1],_=p&&l[2],d=p&&m.childNodes[p];d=++p&&d&&d[g]||(_=p=0)||f.pop();)if(1===d.nodeType&&++_&&d===e){c[t]=[U,p,_];break}}else if(v&&(d=e,h=d[R]||(d[R]={}),c=h[d.uniqueID]||(h[d.uniqueID]={}),l=c[t]||[],p=l[0]===U&&l[1],_=p),_===!1)for(;(d=++p&&d&&d[g]||(_=p=0)||f.pop())&&((a?d.nodeName.toLowerCase()!==x:1!==d.nodeType)||!++_||(v&&(h=d[R]||(d[R]={}),c=h[d.uniqueID]||(h[d.uniqueID]={}),c[t]=[U,_]),d!==e)););return(_-=r)===i||_%i==0&&_/i>=0}}},PSEUDO:function(t,n){var r,o=w.pseudos[t]||w.setFilters[t.toLowerCase()]||e.error("unsupported pseudo: "+t);return o[R]?o(n):o.length>1?(r=[t,t,"",n],w.setFilters.hasOwnProperty(t.toLowerCase())?i(function(t,e){for(var i,r=o(t,n),s=r.length;s--;)i=K(t,r[s]),t[i]=!(e[i]=r[s])}):function(t){return o(t,0,r)}):o}},pseudos:{not:i(function(t){var e=[],n=[],r=T(t.replace(ot,"$1"));return r[R]?i(function(t,e,n,i){for(var o,s=r(t,null,i,[]),a=t.length;a--;)(o=s[a])&&(t[a]=!(e[a]=o))}):function(t,i,o){return e[0]=t,r(e,null,o,n),e[0]=null,!n.pop()}}),has:i(function(t){return function(n){return e(t,n).length>0}}),contains:i(function(t){return t=t.replace(xt,vt),function(e){return(e.textContent||e.innerText||b(e)).indexOf(t)>-1}}),lang:i(function(t){return ct.test(t||"")||e.error("unsupported lang: "+t),t=t.replace(xt,vt).toLowerCase(),function(e){var n;do if(n=I?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(n=n.toLowerCase())===t||0===n.indexOf(t+"-");while((e=e.parentNode)&&1===e.nodeType)return!1}}),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===V},focus:function(t){return t===D.activeElement&&(!D.hasFocus||D.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:a(!1),disabled:a(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,t.selected===!0},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!w.pseudos.empty(t)},header:function(t){return pt.test(t.nodeName)},input:function(t){return dt.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:u(function(){return[0]}),last:u(function(t,e){return[e-1]}),eq:u(function(t,e,n){return[n<0?n+e:n]}),even:u(function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t}),odd:u(function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t}),lt:u(function(t,e,n){for(var i=n<0?n+e:n;--i>=0;)t.push(i);return t}),gt:u(function(t,e,n){for(var i=n<0?n+e:n;++i<e;)t.push(i);return t})}},w.pseudos.nth=w.pseudos.eq;for(_ in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})w.pseudos[_]=function(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}(_);for(_ in{submit:!0,reset:!0})w.pseudos[_]=function(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}(_);return c.prototype=w.filters=w.pseudos,w.setFilters=new c,C=e.tokenize=function(t,n){var i,r,o,s,a,u,l,c=j[t+" "];if(c)return n?0:c.slice(0);for(a=t,u=[],l=w.preFilter;a;){i&&!(r=st.exec(a))||(r&&(a=a.slice(r[0].length)||a),u.push(o=[])),i=!1,(r=at.exec(a))&&(i=r.shift(),o.push({value:i,type:r[0].replace(ot," ")}),a=a.slice(i.length));for(s in w.filter)!(r=ht[s].exec(a))||l[s]&&!(r=l[s](r))||(i=r.shift(),o.push({value:i,type:s,matches:r}),a=a.slice(i.length));if(!i)break}return n?a.length:a?e.error(t):j(t,u).slice(0)},T=e.compile=function(t,e){var n,i=[],r=[],o=G[t+" "];if(!o){for(e||(e=C(t)),n=e.length;n--;)o=x(e[n]),o[R]?i.push(o):r.push(o);o=G(t,v(r,i)),o.selector=t}return o},F=e.select=function(t,e,n,i){var r,o,s,a,u,c="function"==typeof t&&t,d=!i&&C(t=c.selector||t);if(n=n||[],1===d.length){if(o=d[0]=d[0].slice(0),o.length>2&&"ID"===(s=o[0]).type&&9===e.nodeType&&I&&w.relative[o[1].type]){if(!(e=(w.find.ID(s.matches[0].replace(xt,vt),e)||[])[0]))return n;c&&(e=e.parentNode),t=t.slice(o.shift().value.length)}for(r=ht.needsContext.test(t)?0:o.length;r--&&(s=o[r],!w.relative[a=s.type]);)if((u=w.find[a])&&(i=u(s.matches[0].replace(xt,vt),mt.test(o[0].type)&&l(e.parentNode)||e))){if(o.splice(r,1),!(t=i.length&&h(o)))return Z.apply(n,i),n;break}}return(c||T(t,d))(i,e,!I,n,!e||mt.test(t)&&l(e.parentNode)||e),n},y.sortStable=R.split("").sort(H).join("")===R,y.detectDuplicates=!!E,M(),y.sortDetached=r(function(t){return 1&t.compareDocumentPosition(D.createElement("fieldset"))}),r(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||o("type|href|height|width",function(t,e,n){if(!n)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),y.attributes&&r(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||o("value",function(t,e,n){if(!n&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),r(function(t){return null==t.getAttribute("disabled")})||o(J,function(t,e,n){var i;if(!n)return t[e]===!0?e.toLowerCase():(i=t.getAttributeNode(e))&&i.specified?i.value:null}),e}(t);wt.find=bt,wt.expr=bt.selectors,wt.expr[":"]=wt.expr.pseudos,wt.uniqueSort=wt.unique=bt.uniqueSort,wt.text=bt.getText,wt.isXMLDoc=bt.isXML,wt.contains=bt.contains,wt.escapeSelector=bt.escape;var St=function(t,e,n){for(var i=[],r=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&wt(t).is(n))break;i.push(t)}return i},Ct=function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n},Tt=wt.expr.match.needsContext,Ft=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;wt.filter=function(t,e,n){var i=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===i.nodeType?wt.find.matchesSelector(i,t)?[i]:[]:wt.find.matches(t,wt.grep(e,function(t){return 1===t.nodeType}))},wt.fn.extend({find:function(t){var e,n,i=this.length,r=this;if("string"!=typeof t)return this.pushStack(wt(t).filter(function(){for(e=0;e<i;e++)if(wt.contains(r[e],this))return!0}));for(n=this.pushStack([]),e=0;e<i;e++)wt.find(t,r[e],n);return i>1?wt.uniqueSort(n):n},filter:function(t){return this.pushStack(s(this,t||[],!1))},not:function(t){return this.pushStack(s(this,t||[],!0))},is:function(t){return!!s(this,"string"==typeof t&&Tt.test(t)?wt(t):t||[],!1).length}});var Ot,Nt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(wt.fn.init=function(t,e,n){var i,r;if(!t)return this;if(n=n||Ot,"string"==typeof t){if(!(i="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:Nt.exec(t))||!i[1]&&e)return!e||e.jquery?(e||n).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof wt?e[0]:e,wt.merge(this,wt.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:st,!0)),Ft.test(i[1])&&wt.isPlainObject(e))for(i in e)vt(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return r=st.getElementById(i[2]),r&&(this[0]=r,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):vt(t)?void 0!==n.ready?n.ready(t):t(wt):wt.makeArray(t,this)}).prototype=wt.fn,Ot=wt(st);var Et=/^(?:parents|prev(?:Until|All))/,Mt={children:!0,contents:!0,next:!0,prev:!0};wt.fn.extend({has:function(t){var e=wt(t,this),n=e.length;return this.filter(function(){for(var t=0;t<n;t++)if(wt.contains(this,e[t]))return!0})},closest:function(t,e){var n,i=0,r=this.length,o=[],s="string"!=typeof t&&wt(t);if(!Tt.test(t))for(;i<r;i++)for(n=this[i];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(s?s.index(n)>-1:1===n.nodeType&&wt.find.matchesSelector(n,t))){o.push(n);break}return this.pushStack(o.length>1?wt.uniqueSort(o):o)},index:function(t){return t?"string"==typeof t?ht.call(wt(t),this[0]):ht.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(wt.uniqueSort(wt.merge(this.get(),wt(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),wt.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return St(t,"parentNode")},parentsUntil:function(t,e,n){return St(t,"parentNode",n)},next:function(t){return a(t,"nextSibling")},prev:function(t){return a(t,"previousSibling")},nextAll:function(t){return St(t,"nextSibling")},prevAll:function(t){return St(t,"previousSibling")},nextUntil:function(t,e,n){return St(t,"nextSibling",n)},prevUntil:function(t,e,n){return St(t,"previousSibling",n)},siblings:function(t){return Ct((t.parentNode||{}).firstChild,t)},children:function(t){return Ct(t.firstChild)},contents:function(t){return o(t,"iframe")?t.contentDocument:(o(t,"template")&&(t=t.content||t),wt.merge([],t.childNodes))}},function(t,e){wt.fn[t]=function(n,i){var r=wt.map(this,e,n);return"Until"!==t.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=wt.filter(i,r)),this.length>1&&(Mt[t]||wt.uniqueSort(r),Et.test(t)&&r.reverse()),this.pushStack(r)}});var Dt=/[^\x20\t\r\n\f]+/g;wt.Callbacks=function(t){t="string"==typeof t?u(t):wt.extend({},t);var e,n,r,o,s=[],a=[],l=-1,c=function(){for(o=o||t.once,r=e=!0;a.length;l=-1)for(n=a.shift();++l<s.length;)s[l].apply(n[0],n[1])===!1&&t.stopOnFalse&&(l=s.length,n=!1);t.memory||(n=!1),e=!1,o&&(s=n?[]:"")},h={add:function(){return s&&(n&&!e&&(l=s.length-1,a.push(n)),function e(n){wt.each(n,function(n,r){vt(r)?t.unique&&h.has(r)||s.push(r):r&&r.length&&"string"!==i(r)&&e(r)})}(arguments),n&&!e&&c()),this},remove:function(){return wt.each(arguments,function(t,e){for(var n;(n=wt.inArray(e,s,n))>-1;)s.splice(n,1),n<=l&&l--}),this},has:function(t){return t?wt.inArray(t,s)>-1:s.length>0},empty:function(){return s&&(s=[]),this},disable:function(){return o=a=[],s=n="",this},disabled:function(){return!s},lock:function(){return o=a=[],n||e||(s=n=""),this},locked:function(){return!!o},fireWith:function(t,n){return o||(n=n||[],n=[t,n.slice?n.slice():n],a.push(n),e||c()),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!r}};return h},wt.extend({Deferred:function(e){var n=[["notify","progress",wt.Callbacks("memory"),wt.Callbacks("memory"),2],["resolve","done",wt.Callbacks("once memory"),wt.Callbacks("once memory"),0,"resolved"],["reject","fail",wt.Callbacks("once memory"),wt.Callbacks("once memory"),1,"rejected"]],i="pending",r={state:function(){return i},always:function(){return o.done(arguments).fail(arguments),this},catch:function(t){return r.then(null,t)},pipe:function(){var t=arguments;return wt.Deferred(function(e){wt.each(n,function(n,i){var r=vt(t[i[4]])&&t[i[4]];o[i[1]](function(){var t=r&&r.apply(this,arguments);t&&vt(t.promise)?t.promise().progress(e.notify).done(e.resolve).fail(e.reject):e[i[0]+"With"](this,r?[t]:arguments)})}),t=null}).promise()},then:function(e,i,r){function o(e,n,i,r){return function(){var a=this,u=arguments,h=function(){var t,h;if(!(e<s)){if((t=i.apply(a,u))===n.promise())throw new TypeError("Thenable self-resolution");h=t&&("object"==typeof t||"function"==typeof t)&&t.then,vt(h)?r?h.call(t,o(s,n,l,r),o(s,n,c,r)):(s++,h.call(t,o(s,n,l,r),o(s,n,c,r),o(s,n,l,n.notifyWith))):(i!==l&&(a=void 0,u=[t]),(r||n.resolveWith)(a,u))}},d=r?h:function(){try{h()}catch(t){wt.Deferred.exceptionHook&&wt.Deferred.exceptionHook(t,d.stackTrace),e+1>=s&&(i!==c&&(a=void 0,u=[t]),n.rejectWith(a,u))}};e?d():(wt.Deferred.getStackHook&&(d.stackTrace=wt.Deferred.getStackHook()),t.setTimeout(d))}}var s=0;return wt.Deferred(function(t){n[0][3].add(o(0,t,vt(r)?r:l,t.notifyWith)),n[1][3].add(o(0,t,vt(e)?e:l)),n[2][3].add(o(0,t,vt(i)?i:c))}).promise()},promise:function(t){return null!=t?wt.extend(t,r):r}},o={};return wt.each(n,function(t,e){var s=e[2],a=e[5];r[e[1]]=s.add,a&&s.add(function(){i=a},n[3-t][2].disable,n[3-t][3].disable,n[0][2].lock,n[0][3].lock),s.add(e[3].fire),o[e[0]]=function(){return o[e[0]+"With"](this===o?void 0:this,arguments),this},o[e[0]+"With"]=s.fireWith}),r.promise(o),e&&e.call(o,o),o},when:function(t){var e=arguments.length,n=e,i=Array(n),r=ut.call(arguments),o=wt.Deferred(),s=function(t){return function(n){i[t]=this,r[t]=arguments.length>1?ut.call(arguments):n,--e||o.resolveWith(i,r)}};if(e<=1&&(h(t,o.done(s(n)).resolve,o.reject,!e),"pending"===o.state()||vt(r[n]&&r[n].then)))return o.then();for(;n--;)h(r[n],s(n),o.reject);return o.promise()}});var Vt=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;wt.Deferred.exceptionHook=function(e,n){t.console&&t.console.warn&&e&&Vt.test(e.name)&&t.console.warn("jQuery.Deferred exception: "+e.message,e.stack,n)},wt.readyException=function(e){t.setTimeout(function(){throw e})};var It=wt.Deferred();wt.fn.ready=function(t){return It.then(t).catch(function(t){wt.readyException(t)}),this},wt.extend({isReady:!1,readyWait:1,ready:function(t){(t===!0?--wt.readyWait:wt.isReady)||(wt.isReady=!0,t!==!0&&--wt.readyWait>0||It.resolveWith(st,[wt]))}}),wt.ready.then=It.then,"complete"===st.readyState||"loading"!==st.readyState&&!st.documentElement.doScroll?t.setTimeout(wt.ready):(st.addEventListener("DOMContentLoaded",d),t.addEventListener("load",d));var Bt=function(t,e,n,r,o,s,a){var u=0,l=t.length,c=null==n;if("object"===i(n)){o=!0;for(u in n)Bt(t,e,u,n[u],!0,s,a)}else if(void 0!==r&&(o=!0,vt(r)||(a=!0),c&&(a?(e.call(t,r),e=null):(c=e,e=function(t,e,n){return c.call(wt(t),n)})),e))for(;u<l;u++)e(t[u],n,a?r:r.call(t[u],u,e(t[u],n)));return o?t:c?e.call(t):l?e(t[0],n):s},Lt=/^-ms-/,At=/-([a-z])/g,Pt=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};g.uid=1,g.prototype={cache:function(t){var e=t[this.expando];return e||(e={},Pt(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,n){var i,r=this.cache(t);if("string"==typeof e)r[f(e)]=n;else for(i in e)r[f(i)]=e[i];return r},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][f(e)]},access:function(t,e,n){return void 0===e||e&&"string"==typeof e&&void 0===n?this.get(t,e):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,i=t[this.expando];if(void 0!==i){if(void 0!==e){Array.isArray(e)?e=e.map(f):(e=f(e),e=e in i?[e]:e.match(Dt)||[]),n=e.length;for(;n--;)delete i[e[n]]}(void 0===e||wt.isEmptyObject(i))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!wt.isEmptyObject(e)}};var Rt=new g,kt=new g,Ut=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,zt=/[A-Z]/g;wt.extend({hasData:function(t){return kt.hasData(t)||Rt.hasData(t)},data:function(t,e,n){return kt.access(t,e,n)},removeData:function(t,e){kt.remove(t,e)},_data:function(t,e,n){return Rt.access(t,e,n)},_removeData:function(t,e){Rt.remove(t,e)}}),wt.fn.extend({data:function(t,e){var n,i,r,o=this[0],s=o&&o.attributes;if(void 0===t){if(this.length&&(r=kt.get(o),1===o.nodeType&&!Rt.get(o,"hasDataAttrs"))){for(n=s.length;n--;)s[n]&&(i=s[n].name,0===i.indexOf("data-")&&(i=f(i.slice(5)),x(o,i,r[i])));Rt.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof t?this.each(function(){kt.set(this,t)}):Bt(this,function(e){var n;if(o&&void 0===e){if(void 0!==(n=kt.get(o,t)))return n;if(void 0!==(n=x(o,t)))return n}else this.each(function(){kt.set(this,t,e)})},null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){kt.remove(this,t)})}}),wt.extend({queue:function(t,e,n){var i;if(t)return e=(e||"fx")+"queue",i=Rt.get(t,e),n&&(!i||Array.isArray(n)?i=Rt.access(t,e,wt.makeArray(n)):i.push(n)),i||[]},dequeue:function(t,e){e=e||"fx";var n=wt.queue(t,e),i=n.length,r=n.shift(),o=wt._queueHooks(t,e),s=function(){wt.dequeue(t,e)};"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===e&&n.unshift("inprogress"),delete o.stop,r.call(t,s,o)),!i&&o&&o.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return Rt.get(t,n)||Rt.access(t,n,{empty:wt.Callbacks("once memory").add(function(){Rt.remove(t,[e+"queue",n])})})}}),wt.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?wt.queue(this[0],t):void 0===e?this:this.each(function(){var n=wt.queue(this,t,e);wt._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&wt.dequeue(this,t)})},dequeue:function(t){return this.each(function(){wt.dequeue(this,t)})},clearQueue:function(t){
return this.queue(t||"fx",[])},promise:function(t,e){var n,i=1,r=wt.Deferred(),o=this,s=this.length,a=function(){--i||r.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";s--;)(n=Rt.get(o[s],t+"queueHooks"))&&n.empty&&(i++,n.empty.add(a));return a(),r.promise(e)}});var Xt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,jt=new RegExp("^(?:([+-])=|)("+Xt+")([a-z%]*)$","i"),Gt=["Top","Right","Bottom","Left"],Ht=function(t,e){return t=e||t,"none"===t.style.display||""===t.style.display&&wt.contains(t.ownerDocument,t)&&"none"===wt.css(t,"display")},qt=function(t,e,n,i){var r,o,s={};for(o in e)s[o]=t.style[o],t.style[o]=e[o];r=n.apply(t,i||[]);for(o in e)t.style[o]=s[o];return r},Wt={};wt.fn.extend({show:function(){return y(this,!0)},hide:function(){return y(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){Ht(this)?wt(this).show():wt(this).hide()})}});var Yt=/^(?:checkbox|radio)$/i,$t=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,Zt=/^$|^module$|\/(?:java|ecma)script/i,Qt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Qt.optgroup=Qt.option,Qt.tbody=Qt.tfoot=Qt.colgroup=Qt.caption=Qt.thead,Qt.th=Qt.td;var Kt=/<|&#?\w+;/;!function(){var t=st.createDocumentFragment(),e=t.appendChild(st.createElement("div")),n=st.createElement("input");n.setAttribute("type","radio"),n.setAttribute("checked","checked"),n.setAttribute("name","t"),e.appendChild(n),xt.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",xt.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();var Jt=st.documentElement,te=/^key/,ee=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,ne=/^([^.]*)(?:\.(.+)|)/;wt.event={global:{},add:function(t,e,n,i,r){var o,s,a,u,l,c,h,d,p,f,g,m=Rt.get(t);if(m)for(n.handler&&(o=n,n=o.handler,r=o.selector),r&&wt.find.matchesSelector(Jt,r),n.guid||(n.guid=wt.guid++),(u=m.events)||(u=m.events={}),(s=m.handle)||(s=m.handle=function(e){return void 0!==wt&&wt.event.triggered!==e.type?wt.event.dispatch.apply(t,arguments):void 0}),e=(e||"").match(Dt)||[""],l=e.length;l--;)a=ne.exec(e[l])||[],p=g=a[1],f=(a[2]||"").split(".").sort(),p&&(h=wt.event.special[p]||{},p=(r?h.delegateType:h.bindType)||p,h=wt.event.special[p]||{},c=wt.extend({type:p,origType:g,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&wt.expr.match.needsContext.test(r),namespace:f.join(".")},o),(d=u[p])||(d=u[p]=[],d.delegateCount=0,h.setup&&h.setup.call(t,i,f,s)!==!1||t.addEventListener&&t.addEventListener(p,s)),h.add&&(h.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),r?d.splice(d.delegateCount++,0,c):d.push(c),wt.event.global[p]=!0)},remove:function(t,e,n,i,r){var o,s,a,u,l,c,h,d,p,f,g,m=Rt.hasData(t)&&Rt.get(t);if(m&&(u=m.events)){for(e=(e||"").match(Dt)||[""],l=e.length;l--;)if(a=ne.exec(e[l])||[],p=g=a[1],f=(a[2]||"").split(".").sort(),p){for(h=wt.event.special[p]||{},p=(i?h.delegateType:h.bindType)||p,d=u[p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=d.length;o--;)c=d[o],!r&&g!==c.origType||n&&n.guid!==c.guid||a&&!a.test(c.namespace)||i&&i!==c.selector&&("**"!==i||!c.selector)||(d.splice(o,1),c.selector&&d.delegateCount--,h.remove&&h.remove.call(t,c));s&&!d.length&&(h.teardown&&h.teardown.call(t,f,m.handle)!==!1||wt.removeEvent(t,p,m.handle),delete u[p])}else for(p in u)wt.event.remove(t,p+e[l],n,i,!0);wt.isEmptyObject(u)&&Rt.remove(t,"handle events")}},dispatch:function(t){var e,n,i,r,o,s,a=wt.event.fix(t),u=new Array(arguments.length),l=(Rt.get(this,"events")||{})[a.type]||[],c=wt.event.special[a.type]||{};for(u[0]=a,e=1;e<arguments.length;e++)u[e]=arguments[e];if(a.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,a)!==!1){for(s=wt.event.handlers.call(this,a,l),e=0;(r=s[e++])&&!a.isPropagationStopped();)for(a.currentTarget=r.elem,n=0;(o=r.handlers[n++])&&!a.isImmediatePropagationStopped();)a.rnamespace&&!a.rnamespace.test(o.namespace)||(a.handleObj=o,a.data=o.data,void 0!==(i=((wt.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,u))&&(a.result=i)===!1&&(a.preventDefault(),a.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,a),a.result}},handlers:function(t,e){var n,i,r,o,s,a=[],u=e.delegateCount,l=t.target;if(u&&l.nodeType&&!("click"===t.type&&t.button>=1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==t.type||l.disabled!==!0)){for(o=[],s={},n=0;n<u;n++)i=e[n],r=i.selector+" ",void 0===s[r]&&(s[r]=i.needsContext?wt(r,this).index(l)>-1:wt.find(r,this,null,[l]).length),s[r]&&o.push(i);o.length&&a.push({elem:l,handlers:o})}return l=this,u<e.length&&a.push({elem:l,handlers:e.slice(u)}),a},addProp:function(t,e){Object.defineProperty(wt.Event.prototype,t,{enumerable:!0,configurable:!0,get:vt(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[wt.expando]?t:new wt.Event(t)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==F()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===F()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&o(this,"input"))return this.click(),!1},_default:function(t){return o(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},wt.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)},wt.Event=function(t,e){if(!(this instanceof wt.Event))return new wt.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&t.returnValue===!1?C:T,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&wt.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[wt.expando]=!0},wt.Event.prototype={constructor:wt.Event,isDefaultPrevented:T,isPropagationStopped:T,isImmediatePropagationStopped:T,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=C,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=C,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=C,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},wt.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(t){var e=t.button;return null==t.which&&te.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&ee.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},wt.event.addProp),wt.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){wt.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,i=this,r=t.relatedTarget,o=t.handleObj;return r&&(r===i||wt.contains(i,r))||(t.type=o.origType,n=o.handler.apply(this,arguments),t.type=e),n}}}),wt.fn.extend({on:function(t,e,n,i){return O(this,t,e,n,i)},one:function(t,e,n,i){return O(this,t,e,n,i,1)},off:function(t,e,n){var i,r;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,wt(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof t){for(r in t)this.off(r,e,t[r]);return this}return e!==!1&&"function"!=typeof e||(n=e,e=void 0),n===!1&&(n=T),this.each(function(){wt.event.remove(this,t,n,e)})}});var ie=/<script|<style|<link/i,re=/checked\s*(?:[^=]|=\s*.checked.)/i,oe=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;wt.extend({htmlPrefilter:function(t){return t.replace(/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,"<$1></$2>")},clone:function(t,e,n){var i,r,o,s,a=t.cloneNode(!0),u=wt.contains(t.ownerDocument,t);if(!(xt.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||wt.isXMLDoc(t)))for(s=w(a),o=w(t),i=0,r=o.length;i<r;i++)V(o[i],s[i]);if(e)if(n)for(o=o||w(t),s=s||w(a),i=0,r=o.length;i<r;i++)D(o[i],s[i]);else D(t,a);return s=w(a,"script"),s.length>0&&b(s,!u&&w(t,"script")),a},cleanData:function(t){for(var e,n,i,r=wt.event.special,o=0;void 0!==(n=t[o]);o++)if(Pt(n)){if(e=n[Rt.expando]){if(e.events)for(i in e.events)r[i]?wt.event.remove(n,i):wt.removeEvent(n,i,e.handle);n[Rt.expando]=void 0}n[kt.expando]&&(n[kt.expando]=void 0)}}}),wt.fn.extend({detach:function(t){return B(this,t,!0)},remove:function(t){return B(this,t)},text:function(t){return Bt(this,function(t){return void 0===t?wt.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return I(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){N(this,t).appendChild(t)}})},prepend:function(){return I(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=N(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return I(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return I(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(wt.cleanData(w(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return wt.clone(this,t,e)})},html:function(t){return Bt(this,function(t){var e=this[0]||{},n=0,i=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!ie.test(t)&&!Qt[($t.exec(t)||["",""])[1].toLowerCase()]){t=wt.htmlPrefilter(t);try{for(;n<i;n++)e=this[n]||{},1===e.nodeType&&(wt.cleanData(w(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=[];return I(this,arguments,function(e){var n=this.parentNode;wt.inArray(this,t)<0&&(wt.cleanData(w(this)),n&&n.replaceChild(e,this))},t)}}),wt.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){wt.fn[t]=function(t){for(var n,i=[],r=wt(t),o=r.length-1,s=0;s<=o;s++)n=s===o?this:this.clone(!0),wt(r[s])[e](n),ct.apply(i,n.get());return this.pushStack(i)}});var se=new RegExp("^("+Xt+")(?!px)[a-z%]+$","i"),ae=function(e){var n=e.ownerDocument.defaultView;return n&&n.opener||(n=t),n.getComputedStyle(e)},ue=new RegExp(Gt.join("|"),"i");!function(){function e(){if(l){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",Jt.appendChild(u).appendChild(l);var e=t.getComputedStyle(l);i="1%"!==e.top,a=12===n(e.marginLeft),l.style.right="60%",s=36===n(e.right),r=36===n(e.width),l.style.position="absolute",o=36===l.offsetWidth||"absolute",Jt.removeChild(u),l=null}}function n(t){return Math.round(parseFloat(t))}var i,r,o,s,a,u=st.createElement("div"),l=st.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",xt.clearCloneStyle="content-box"===l.style.backgroundClip,wt.extend(xt,{boxSizingReliable:function(){return e(),r},pixelBoxStyles:function(){return e(),s},pixelPosition:function(){return e(),i},reliableMarginLeft:function(){return e(),a},scrollboxSize:function(){return e(),o}}))}();var le=/^(none|table(?!-c[ea]).+)/,ce=/^--/,he={position:"absolute",visibility:"hidden",display:"block"},de={letterSpacing:"0",fontWeight:"400"},pe=["Webkit","Moz","ms"],fe=st.createElement("div").style;wt.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=L(t,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,n,i){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,o,s,a=f(e),u=ce.test(e),l=t.style;if(u||(e=R(a)),s=wt.cssHooks[e]||wt.cssHooks[a],void 0===n)return s&&"get"in s&&void 0!==(r=s.get(t,!1,i))?r:l[e];o=typeof n,"string"===o&&(r=jt.exec(n))&&r[1]&&(n=v(t,e,r),o="number"),null!=n&&n===n&&("number"===o&&(n+=r&&r[3]||(wt.cssNumber[a]?"":"px")),xt.clearCloneStyle||""!==n||0!==e.indexOf("background")||(l[e]="inherit"),s&&"set"in s&&void 0===(n=s.set(t,n,i))||(u?l.setProperty(e,n):l[e]=n))}},css:function(t,e,n,i){var r,o,s,a=f(e);return ce.test(e)||(e=R(a)),s=wt.cssHooks[e]||wt.cssHooks[a],s&&"get"in s&&(r=s.get(t,!0,n)),void 0===r&&(r=L(t,e,i)),"normal"===r&&e in de&&(r=de[e]),""===n||n?(o=parseFloat(r),n===!0||isFinite(o)?o||0:r):r}}),wt.each(["height","width"],function(t,e){wt.cssHooks[e]={get:function(t,n,i){if(n)return!le.test(wt.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?z(t,e,i):qt(t,he,function(){return z(t,e,i)})},set:function(t,n,i){var r,o=ae(t),s="border-box"===wt.css(t,"boxSizing",!1,o),a=i&&U(t,e,i,s,o);return s&&xt.scrollboxSize()===o.position&&(a-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(o[e])-U(t,e,"border",!1,o)-.5)),a&&(r=jt.exec(n))&&"px"!==(r[3]||"px")&&(t.style[e]=n,n=wt.css(t,e)),k(t,n,a)}}}),wt.cssHooks.marginLeft=A(xt.reliableMarginLeft,function(t,e){if(e)return(parseFloat(L(t,"marginLeft"))||t.getBoundingClientRect().left-qt(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px"}),wt.each({margin:"",padding:"",border:"Width"},function(t,e){wt.cssHooks[t+e]={expand:function(n){for(var i=0,r={},o="string"==typeof n?n.split(" "):[n];i<4;i++)r[t+Gt[i]+e]=o[i]||o[i-2]||o[0];return r}},"margin"!==t&&(wt.cssHooks[t+e].set=k)}),wt.fn.extend({css:function(t,e){return Bt(this,function(t,e,n){var i,r,o={},s=0;if(Array.isArray(e)){for(i=ae(t),r=e.length;s<r;s++)o[e[s]]=wt.css(t,e[s],!1,i);return o}return void 0!==n?wt.style(t,e,n):wt.css(t,e)},t,e,arguments.length>1)}}),wt.Tween=X,X.prototype={constructor:X,init:function(t,e,n,i,r,o){this.elem=t,this.prop=n,this.easing=r||wt.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=o||(wt.cssNumber[n]?"":"px")},cur:function(){var t=X.propHooks[this.prop];return t&&t.get?t.get(this):X.propHooks._default.get(this)},run:function(t){var e,n=X.propHooks[this.prop];return this.options.duration?this.pos=e=wt.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):X.propHooks._default.set(this),this}},X.prototype.init.prototype=X.prototype,X.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=wt.css(t.elem,t.prop,""),e&&"auto"!==e?e:0)},set:function(t){wt.fx.step[t.prop]?wt.fx.step[t.prop](t):1!==t.elem.nodeType||null==t.elem.style[wt.cssProps[t.prop]]&&!wt.cssHooks[t.prop]?t.elem[t.prop]=t.now:wt.style(t.elem,t.prop,t.now+t.unit)}}},X.propHooks.scrollTop=X.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},wt.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},wt.fx=X.prototype.init,wt.fx.step={};var ge,me,xe=/^(?:toggle|show|hide)$/,ve=/queueHooks$/;wt.Animation=wt.extend($,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return v(n.elem,t,jt.exec(e),n),n}]},tweener:function(t,e){vt(t)?(e=t,t=["*"]):t=t.match(Dt);for(var n,i=0,r=t.length;i<r;i++)n=t[i],$.tweeners[n]=$.tweeners[n]||[],$.tweeners[n].unshift(e)},prefilters:[W],prefilter:function(t,e){e?$.prefilters.unshift(t):$.prefilters.push(t)}}),wt.speed=function(t,e,n){var i=t&&"object"==typeof t?wt.extend({},t):{complete:n||!n&&e||vt(t)&&t,duration:t,easing:n&&e||e&&!vt(e)&&e};return wt.fx.off?i.duration=0:"number"!=typeof i.duration&&(i.duration in wt.fx.speeds?i.duration=wt.fx.speeds[i.duration]:i.duration=wt.fx.speeds._default),null!=i.queue&&i.queue!==!0||(i.queue="fx"),i.old=i.complete,i.complete=function(){vt(i.old)&&i.old.call(this),i.queue&&wt.dequeue(this,i.queue)},i},wt.fn.extend({fadeTo:function(t,e,n,i){return this.filter(Ht).css("opacity",0).show().end().animate({opacity:e},t,n,i)},animate:function(t,e,n,i){var r=wt.isEmptyObject(t),o=wt.speed(e,n,i),s=function(){var e=$(this,wt.extend({},t),o);(r||Rt.get(this,"finish"))&&e.stop(!0)};return s.finish=s,r||o.queue===!1?this.each(s):this.queue(o.queue,s)},stop:function(t,e,n){var i=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=void 0),e&&t!==!1&&this.queue(t||"fx",[]),this.each(function(){var e=!0,r=null!=t&&t+"queueHooks",o=wt.timers,s=Rt.get(this);if(r)s[r]&&s[r].stop&&i(s[r]);else for(r in s)s[r]&&s[r].stop&&ve.test(r)&&i(s[r]);for(r=o.length;r--;)o[r].elem!==this||null!=t&&o[r].queue!==t||(o[r].anim.stop(n),e=!1,o.splice(r,1));!e&&n||wt.dequeue(this,t)})},finish:function(t){return t!==!1&&(t=t||"fx"),this.each(function(){var e,n=Rt.get(this),i=n[t+"queue"],r=n[t+"queueHooks"],o=wt.timers,s=i?i.length:0;for(n.finish=!0,wt.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;e<s;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete n.finish})}}),wt.each(["toggle","show","hide"],function(t,e){var n=wt.fn[e];wt.fn[e]=function(t,i,r){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(H(e,!0),t,i,r)}}),wt.each({slideDown:H("show"),slideUp:H("hide"),slideToggle:H("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){wt.fn[t]=function(t,n,i){return this.animate(e,t,n,i)}}),wt.timers=[],wt.fx.tick=function(){var t,e=0,n=wt.timers;for(ge=Date.now();e<n.length;e++)(t=n[e])()||n[e]!==t||n.splice(e--,1);n.length||wt.fx.stop(),ge=void 0},wt.fx.timer=function(t){wt.timers.push(t),wt.fx.start()},wt.fx.interval=13,wt.fx.start=function(){me||(me=!0,j())},wt.fx.stop=function(){me=null},wt.fx.speeds={slow:600,fast:200,_default:400},wt.fn.delay=function(e,n){return e=wt.fx?wt.fx.speeds[e]||e:e,n=n||"fx",this.queue(n,function(n,i){var r=t.setTimeout(n,e);i.stop=function(){t.clearTimeout(r)}})},function(){var t=st.createElement("input"),e=st.createElement("select"),n=e.appendChild(st.createElement("option"));t.type="checkbox",xt.checkOn=""!==t.value,xt.optSelected=n.selected,t=st.createElement("input"),t.value="t",t.type="radio",xt.radioValue="t"===t.value}();var _e,ye=wt.expr.attrHandle;wt.fn.extend({attr:function(t,e){return Bt(this,wt.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){wt.removeAttr(this,t)})}}),wt.extend({attr:function(t,e,n){var i,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===t.getAttribute?wt.prop(t,e,n):(1===o&&wt.isXMLDoc(t)||(r=wt.attrHooks[e.toLowerCase()]||(wt.expr.match.bool.test(e)?_e:void 0)),void 0!==n?null===n?void wt.removeAttr(t,e):r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:(t.setAttribute(e,n+""),n):r&&"get"in r&&null!==(i=r.get(t,e))?i:(i=wt.find.attr(t,e),null==i?void 0:i))},attrHooks:{type:{set:function(t,e){if(!xt.radioValue&&"radio"===e&&o(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,i=0,r=e&&e.match(Dt);if(r&&1===t.nodeType)for(;n=r[i++];)t.removeAttribute(n)}}),_e={set:function(t,e,n){return e===!1?wt.removeAttr(t,n):t.setAttribute(n,n),n}},wt.each(wt.expr.match.bool.source.match(/\w+/g),function(t,e){var n=ye[e]||wt.find.attr;ye[e]=function(t,e,i){var r,o,s=e.toLowerCase();return i||(o=ye[s],ye[s]=r,r=null!=n(t,e,i)?s:null,ye[s]=o),r}});var we=/^(?:input|select|textarea|button)$/i,be=/^(?:a|area)$/i;wt.fn.extend({prop:function(t,e){return Bt(this,wt.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[wt.propFix[t]||t]})}}),wt.extend({prop:function(t,e,n){var i,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&wt.isXMLDoc(t)||(e=wt.propFix[e]||e,r=wt.propHooks[e]),void 0!==n?r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:t[e]=n:r&&"get"in r&&null!==(i=r.get(t,e))?i:t[e]},propHooks:{tabIndex:{get:function(t){var e=wt.find.attr(t,"tabindex");return e?parseInt(e,10):we.test(t.nodeName)||be.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),xt.optSelected||(wt.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),wt.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){wt.propFix[this.toLowerCase()]=this}),wt.fn.extend({addClass:function(t){var e,n,i,r,o,s,a,u=0;if(vt(t))return this.each(function(e){wt(this).addClass(t.call(this,e,Q(this)))});if(e=K(t),e.length)for(;n=this[u++];)if(r=Q(n),i=1===n.nodeType&&" "+Z(r)+" "){for(s=0;o=e[s++];)i.indexOf(" "+o+" ")<0&&(i+=o+" ");a=Z(i),r!==a&&n.setAttribute("class",a)}return this},removeClass:function(t){var e,n,i,r,o,s,a,u=0;if(vt(t))return this.each(function(e){wt(this).removeClass(t.call(this,e,Q(this)))});if(!arguments.length)return this.attr("class","");if(e=K(t),e.length)for(;n=this[u++];)if(r=Q(n),i=1===n.nodeType&&" "+Z(r)+" "){for(s=0;o=e[s++];)for(;i.indexOf(" "+o+" ")>-1;)i=i.replace(" "+o+" "," ");a=Z(i),r!==a&&n.setAttribute("class",a)}return this},toggleClass:function(t,e){var n=typeof t,i="string"===n||Array.isArray(t);return"boolean"==typeof e&&i?e?this.addClass(t):this.removeClass(t):vt(t)?this.each(function(n){wt(this).toggleClass(t.call(this,n,Q(this),e),e)}):this.each(function(){var e,r,o,s;if(i)for(r=0,o=wt(this),s=K(t);e=s[r++];)o.hasClass(e)?o.removeClass(e):o.addClass(e);else void 0!==t&&"boolean"!==n||(e=Q(this),e&&Rt.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||t===!1?"":Rt.get(this,"__className__")||""))})},hasClass:function(t){var e,n,i=0;for(e=" "+t+" ";n=this[i++];)if(1===n.nodeType&&(" "+Z(Q(n))+" ").indexOf(e)>-1)return!0;return!1}});wt.fn.extend({val:function(t){var e,n,i,r=this[0];if(arguments.length)return i=vt(t),this.each(function(n){var r;1===this.nodeType&&(r=i?t.call(this,n,wt(this).val()):t,null==r?r="":"number"==typeof r?r+="":Array.isArray(r)&&(r=wt.map(r,function(t){return null==t?"":t+""})),(e=wt.valHooks[this.type]||wt.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))});if(r)return(e=wt.valHooks[r.type]||wt.valHooks[r.nodeName.toLowerCase()])&&"get"in e&&void 0!==(n=e.get(r,"value"))?n:(n=r.value,"string"==typeof n?n.replace(/\r/g,""):null==n?"":n)}}),wt.extend({valHooks:{option:{get:function(t){var e=wt.find.attr(t,"value");return null!=e?e:Z(wt.text(t))}},select:{get:function(t){var e,n,i,r=t.options,s=t.selectedIndex,a="select-one"===t.type,u=a?null:[],l=a?s+1:r.length;for(i=s<0?l:a?s:0;i<l;i++)if(n=r[i],(n.selected||i===s)&&!n.disabled&&(!n.parentNode.disabled||!o(n.parentNode,"optgroup"))){if(e=wt(n).val(),a)return e;u.push(e)}return u},set:function(t,e){for(var n,i,r=t.options,o=wt.makeArray(e),s=r.length;s--;)i=r[s],(i.selected=wt.inArray(wt.valHooks.option.get(i),o)>-1)&&(n=!0);return n||(t.selectedIndex=-1),o}}}}),wt.each(["radio","checkbox"],function(){wt.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=wt.inArray(wt(t).val(),e)>-1}},xt.checkOn||(wt.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}),xt.focusin="onfocusin"in t;var Se=/^(?:focusinfocus|focusoutblur)$/,Ce=function(t){t.stopPropagation()};wt.extend(wt.event,{trigger:function(e,n,i,r){var o,s,a,u,l,c,h,d,p=[i||st],f=ft.call(e,"type")?e.type:e,g=ft.call(e,"namespace")?e.namespace.split("."):[];if(s=d=a=i=i||st,3!==i.nodeType&&8!==i.nodeType&&!Se.test(f+wt.event.triggered)&&(f.indexOf(".")>-1&&(g=f.split("."),f=g.shift(),g.sort()),l=f.indexOf(":")<0&&"on"+f,e=e[wt.expando]?e:new wt.Event(f,"object"==typeof e&&e),e.isTrigger=r?2:3,e.namespace=g.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=i),n=null==n?[e]:wt.makeArray(n,[e]),h=wt.event.special[f]||{},r||!h.trigger||h.trigger.apply(i,n)!==!1)){if(!r&&!h.noBubble&&!_t(i)){for(u=h.delegateType||f,Se.test(u+f)||(s=s.parentNode);s;s=s.parentNode)p.push(s),a=s;a===(i.ownerDocument||st)&&p.push(a.defaultView||a.parentWindow||t)}for(o=0;(s=p[o++])&&!e.isPropagationStopped();)d=s,e.type=o>1?u:h.bindType||f,c=(Rt.get(s,"events")||{})[e.type]&&Rt.get(s,"handle"),c&&c.apply(s,n),(c=l&&s[l])&&c.apply&&Pt(s)&&(e.result=c.apply(s,n),e.result===!1&&e.preventDefault());return e.type=f,r||e.isDefaultPrevented()||h._default&&h._default.apply(p.pop(),n)!==!1||!Pt(i)||l&&vt(i[f])&&!_t(i)&&(a=i[l],a&&(i[l]=null),wt.event.triggered=f,e.isPropagationStopped()&&d.addEventListener(f,Ce),i[f](),e.isPropagationStopped()&&d.removeEventListener(f,Ce),wt.event.triggered=void 0,a&&(i[l]=a)),e.result}},simulate:function(t,e,n){var i=wt.extend(new wt.Event,n,{type:t,isSimulated:!0});wt.event.trigger(i,null,e)}}),wt.fn.extend({trigger:function(t,e){return this.each(function(){wt.event.trigger(t,e,this)})},triggerHandler:function(t,e){var n=this[0];if(n)return wt.event.trigger(t,e,n,!0)}}),xt.focusin||wt.each({focus:"focusin",blur:"focusout"},function(t,e){var n=function(t){wt.event.simulate(e,t.target,wt.event.fix(t))};wt.event.special[e]={setup:function(){var i=this.ownerDocument||this,r=Rt.access(i,e);r||i.addEventListener(t,n,!0),Rt.access(i,e,(r||0)+1)},teardown:function(){var i=this.ownerDocument||this,r=Rt.access(i,e)-1;r?Rt.access(i,e,r):(i.removeEventListener(t,n,!0),Rt.remove(i,e))}}});var Te=t.location,Fe=Date.now(),Oe=/\?/;wt.parseXML=function(e){var n;if(!e||"string"!=typeof e)return null;try{n=(new t.DOMParser).parseFromString(e,"text/xml")}catch(t){n=void 0}return n&&!n.getElementsByTagName("parsererror").length||wt.error("Invalid XML: "+e),n};var Ne=/\[\]$/,Ee=/^(?:submit|button|image|reset|file)$/i,Me=/^(?:input|select|textarea|keygen)/i;wt.param=function(t,e){var n,i=[],r=function(t,e){var n=vt(e)?e():e;i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==n?"":n)};if(Array.isArray(t)||t.jquery&&!wt.isPlainObject(t))wt.each(t,function(){r(this.name,this.value)});else for(n in t)J(n,t[n],e,r);return i.join("&")},wt.fn.extend({serialize:function(){return wt.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=wt.prop(this,"elements");return t?wt.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!wt(this).is(":disabled")&&Me.test(this.nodeName)&&!Ee.test(t)&&(this.checked||!Yt.test(t))}).map(function(t,e){var n=wt(this).val();return null==n?null:Array.isArray(n)?wt.map(n,function(t){return{name:e.name,value:t.replace(/\r?\n/g,"\r\n")}}):{name:e.name,value:n.replace(/\r?\n/g,"\r\n")}}).get()}});var De=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ve=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ie=/^(?:GET|HEAD)$/,Be={},Le={},Ae="*/".concat("*"),Pe=st.createElement("a");Pe.href=Te.href,wt.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Te.href,type:"GET",isLocal:Ve.test(Te.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ae,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":wt.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?nt(nt(t,wt.ajaxSettings),e):nt(wt.ajaxSettings,t)},ajaxPrefilter:tt(Be),ajaxTransport:tt(Le),ajax:function(e,n){function i(e,n,i,a){var l,d,p,y,w,b=n;c||(c=!0,u&&t.clearTimeout(u),r=void 0,s=a||"",S.readyState=e>0?4:0,l=e>=200&&e<300||304===e,i&&(y=it(f,S,i)),y=rt(f,y,S,l),l?(f.ifModified&&(w=S.getResponseHeader("Last-Modified"),w&&(wt.lastModified[o]=w),(w=S.getResponseHeader("etag"))&&(wt.etag[o]=w)),204===e||"HEAD"===f.type?b="nocontent":304===e?b="notmodified":(b=y.state,d=y.data,p=y.error,l=!p)):(p=b,!e&&b||(b="error",e<0&&(e=0))),S.status=e,S.statusText=(n||b)+"",l?x.resolveWith(g,[d,b,S]):x.rejectWith(g,[S,b,p]),S.statusCode(_),_=void 0,h&&m.trigger(l?"ajaxSuccess":"ajaxError",[S,f,l?d:p]),v.fireWith(g,[S,b]),h&&(m.trigger("ajaxComplete",[S,f]),--wt.active||wt.event.trigger("ajaxStop")))}"object"==typeof e&&(n=e,e=void 0),n=n||{};var r,o,s,a,u,l,c,h,d,p,f=wt.ajaxSetup({},n),g=f.context||f,m=f.context&&(g.nodeType||g.jquery)?wt(g):wt.event,x=wt.Deferred(),v=wt.Callbacks("once memory"),_=f.statusCode||{},y={},w={},b="canceled",S={readyState:0,getResponseHeader:function(t){var e;if(c){if(!a)for(a={};e=De.exec(s);)a[e[1].toLowerCase()]=e[2];e=a[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return c?s:null},setRequestHeader:function(t,e){return null==c&&(t=w[t.toLowerCase()]=w[t.toLowerCase()]||t,y[t]=e),this},overrideMimeType:function(t){return null==c&&(f.mimeType=t),this},statusCode:function(t){var e;if(t)if(c)S.always(t[S.status]);else for(e in t)_[e]=[_[e],t[e]];return this},abort:function(t){var e=t||b;return r&&r.abort(e),i(0,e),this}};if(x.promise(S),f.url=((e||f.url||Te.href)+"").replace(/^\/\//,Te.protocol+"//"),f.type=n.method||n.type||f.method||f.type,f.dataTypes=(f.dataType||"*").toLowerCase().match(Dt)||[""],null==f.crossDomain){l=st.createElement("a");try{l.href=f.url,l.href=l.href,f.crossDomain=Pe.protocol+"//"+Pe.host!=l.protocol+"//"+l.host}catch(t){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!=typeof f.data&&(f.data=wt.param(f.data,f.traditional)),et(Be,f,n,S),c)return S;h=wt.event&&f.global,h&&0==wt.active++&&wt.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!Ie.test(f.type),o=f.url.replace(/#.*$/,""),f.hasContent?f.data&&f.processData&&0===(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&(f.data=f.data.replace(/%20/g,"+")):(p=f.url.slice(o.length),f.data&&(f.processData||"string"==typeof f.data)&&(o+=(Oe.test(o)?"&":"?")+f.data,delete f.data),f.cache===!1&&(o=o.replace(/([?&])_=[^&]*/,"$1"),p=(Oe.test(o)?"&":"?")+"_="+Fe+++p),f.url=o+p),f.ifModified&&(wt.lastModified[o]&&S.setRequestHeader("If-Modified-Since",wt.lastModified[o]),wt.etag[o]&&S.setRequestHeader("If-None-Match",wt.etag[o])),(f.data&&f.hasContent&&f.contentType!==!1||n.contentType)&&S.setRequestHeader("Content-Type",f.contentType),S.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+Ae+"; q=0.01":""):f.accepts["*"]);for(d in f.headers)S.setRequestHeader(d,f.headers[d]);if(f.beforeSend&&(f.beforeSend.call(g,S,f)===!1||c))return S.abort();if(b="abort",v.add(f.complete),S.done(f.success),S.fail(f.error),r=et(Le,f,n,S)){if(S.readyState=1,h&&m.trigger("ajaxSend",[S,f]),c)return S;f.async&&f.timeout>0&&(u=t.setTimeout(function(){S.abort("timeout")},f.timeout));try{c=!1,r.send(y,i)}catch(t){if(c)throw t;i(-1,t)}}else i(-1,"No Transport");return S},getJSON:function(t,e,n){return wt.get(t,e,n,"json")},getScript:function(t,e){return wt.get(t,void 0,e,"script")}}),
wt.each(["get","post"],function(t,e){wt[e]=function(t,n,i,r){return vt(n)&&(r=r||i,i=n,n=void 0),wt.ajax(wt.extend({url:t,type:e,dataType:r,data:n,success:i},wt.isPlainObject(t)&&t))}}),wt._evalUrl=function(t){return wt.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},wt.fn.extend({wrapAll:function(t){var e;return this[0]&&(vt(t)&&(t=t.call(this[0])),e=wt(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this},wrapInner:function(t){return vt(t)?this.each(function(e){wt(this).wrapInner(t.call(this,e))}):this.each(function(){var e=wt(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)})},wrap:function(t){var e=vt(t);return this.each(function(n){wt(this).wrapAll(e?t.call(this,n):t)})},unwrap:function(t){return this.parent(t).not("body").each(function(){wt(this).replaceWith(this.childNodes)}),this}}),wt.expr.pseudos.hidden=function(t){return!wt.expr.pseudos.visible(t)},wt.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},wt.ajaxSettings.xhr=function(){try{return new t.XMLHttpRequest}catch(t){}};var Re={0:200,1223:204},ke=wt.ajaxSettings.xhr();xt.cors=!!ke&&"withCredentials"in ke,xt.ajax=ke=!!ke,wt.ajaxTransport(function(e){var n,i;if(xt.cors||ke&&!e.crossDomain)return{send:function(r,o){var s,a=e.xhr();if(a.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(s in e.xhrFields)a[s]=e.xhrFields[s];e.mimeType&&a.overrideMimeType&&a.overrideMimeType(e.mimeType),e.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest");for(s in r)a.setRequestHeader(s,r[s]);n=function(t){return function(){n&&(n=i=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===t?a.abort():"error"===t?"number"!=typeof a.status?o(0,"error"):o(a.status,a.statusText):o(Re[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=n(),i=a.onerror=a.ontimeout=n("error"),void 0!==a.onabort?a.onabort=i:a.onreadystatechange=function(){4===a.readyState&&t.setTimeout(function(){n&&i()})},n=n("abort");try{a.send(e.hasContent&&e.data||null)}catch(t){if(n)throw t}},abort:function(){n&&n()}}}),wt.ajaxPrefilter(function(t){t.crossDomain&&(t.contents.script=!1)}),wt.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return wt.globalEval(t),t}}}),wt.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),wt.ajaxTransport("script",function(t){if(t.crossDomain){var e,n;return{send:function(i,r){e=wt("<script>").prop({charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&r("error"===t.type?404:200,t.type)}),st.head.appendChild(e[0])},abort:function(){n&&n()}}}});var Ue=[],ze=/(=)\?(?=&|$)|\?\?/;wt.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Ue.pop()||wt.expando+"_"+Fe++;return this[t]=!0,t}}),wt.ajaxPrefilter("json jsonp",function(e,n,i){var r,o,s,a=e.jsonp!==!1&&(ze.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&ze.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=vt(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(ze,"$1"+r):e.jsonp!==!1&&(e.url+=(Oe.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return s||wt.error(r+" was not called"),s[0]},e.dataTypes[0]="json",o=t[r],t[r]=function(){s=arguments},i.always(function(){void 0===o?wt(t).removeProp(r):t[r]=o,e[r]&&(e.jsonpCallback=n.jsonpCallback,Ue.push(r)),s&&vt(o)&&o(s[0]),s=o=void 0}),"script"}),xt.createHTMLDocument=function(){var t=st.implementation.createHTMLDocument("").body;return t.innerHTML="<form></form><form></form>",2===t.childNodes.length}(),wt.parseHTML=function(t,e,n){if("string"!=typeof t)return[];"boolean"==typeof e&&(n=e,e=!1);var i,r,o;return e||(xt.createHTMLDocument?(e=st.implementation.createHTMLDocument(""),i=e.createElement("base"),i.href=st.location.href,e.head.appendChild(i)):e=st),r=Ft.exec(t),o=!n&&[],r?[e.createElement(r[1])]:(r=S([t],e,o),o&&o.length&&wt(o).remove(),wt.merge([],r.childNodes))},wt.fn.load=function(t,e,n){var i,r,o,s=this,a=t.indexOf(" ");return a>-1&&(i=Z(t.slice(a)),t=t.slice(0,a)),vt(e)?(n=e,e=void 0):e&&"object"==typeof e&&(r="POST"),s.length>0&&wt.ajax({url:t,type:r||"GET",dataType:"html",data:e}).done(function(t){o=arguments,s.html(i?wt("<div>").append(wt.parseHTML(t)).find(i):t)}).always(n&&function(t,e){s.each(function(){n.apply(this,o||[t.responseText,e,t])})}),this},wt.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){wt.fn[e]=function(t){return this.on(e,t)}}),wt.expr.pseudos.animated=function(t){return wt.grep(wt.timers,function(e){return t===e.elem}).length},wt.offset={setOffset:function(t,e,n){var i,r,o,s,a,u,l,c=wt.css(t,"position"),h=wt(t),d={};"static"===c&&(t.style.position="relative"),a=h.offset(),o=wt.css(t,"top"),u=wt.css(t,"left"),l=("absolute"===c||"fixed"===c)&&(o+u).indexOf("auto")>-1,l?(i=h.position(),s=i.top,r=i.left):(s=parseFloat(o)||0,r=parseFloat(u)||0),vt(e)&&(e=e.call(t,n,wt.extend({},a))),null!=e.top&&(d.top=e.top-a.top+s),null!=e.left&&(d.left=e.left-a.left+r),"using"in e?e.using.call(t,d):h.css(d)}},wt.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){wt.offset.setOffset(this,t,e)});var e,n,i=this[0];if(i)return i.getClientRects().length?(e=i.getBoundingClientRect(),n=i.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var t,e,n,i=this[0],r={top:0,left:0};if("fixed"===wt.css(i,"position"))e=i.getBoundingClientRect();else{for(e=this.offset(),n=i.ownerDocument,t=i.offsetParent||n.documentElement;t&&(t===n.body||t===n.documentElement)&&"static"===wt.css(t,"position");)t=t.parentNode;t&&t!==i&&1===t.nodeType&&(r=wt(t).offset(),r.top+=wt.css(t,"borderTopWidth",!0),r.left+=wt.css(t,"borderLeftWidth",!0))}return{top:e.top-r.top-wt.css(i,"marginTop",!0),left:e.left-r.left-wt.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&"static"===wt.css(t,"position");)t=t.offsetParent;return t||Jt})}}),wt.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var n="pageYOffset"===e;wt.fn[t]=function(i){return Bt(this,function(t,i,r){var o;if(_t(t)?o=t:9===t.nodeType&&(o=t.defaultView),void 0===r)return o?o[e]:t[i];o?o.scrollTo(n?o.pageXOffset:r,n?r:o.pageYOffset):t[i]=r},t,i,arguments.length)}}),wt.each(["top","left"],function(t,e){wt.cssHooks[e]=A(xt.pixelPosition,function(t,n){if(n)return n=L(t,e),se.test(n)?wt(t).position()[e]+"px":n})}),wt.each({Height:"height",Width:"width"},function(t,e){wt.each({padding:"inner"+t,content:e,"":"outer"+t},function(n,i){wt.fn[i]=function(r,o){var s=arguments.length&&(n||"boolean"!=typeof r),a=n||(r===!0||o===!0?"margin":"border");return Bt(this,function(e,n,r){var o;return _t(e)?0===i.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(o=e.documentElement,Math.max(e.body["scroll"+t],o["scroll"+t],e.body["offset"+t],o["offset"+t],o["client"+t])):void 0===r?wt.css(e,n,a):wt.style(e,n,r,a)},e,s?r:void 0,s)}})}),wt.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(t,e){wt.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}}),wt.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),wt.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,i){return this.on(e,t,n,i)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)}}),wt.proxy=function(t,e){var n,i,r;if("string"==typeof e&&(n=t[e],e=t,t=n),vt(t))return i=ut.call(arguments,2),r=function(){return t.apply(e||this,i.concat(ut.call(arguments)))},r.guid=t.guid=t.guid||wt.guid++,r},wt.holdReady=function(t){t?wt.readyWait++:wt.ready(!0)},wt.isArray=Array.isArray,wt.parseJSON=JSON.parse,wt.nodeName=o,wt.isFunction=vt,wt.isWindow=_t,wt.camelCase=f,wt.type=i,wt.now=Date.now,wt.isNumeric=function(t){var e=wt.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},"function"==typeof define&&define.amd&&define("jquery",[],function(){return wt});var Xe=t.jQuery,je=t.$;return wt.noConflict=function(e){return t.$===wt&&(t.$=je),e&&t.jQuery===wt&&(t.jQuery=Xe),wt},e||(t.jQuery=t.$=wt),wt}),define("jquery/dist/jquery",function(){}),define("x_ite/Error",["jquery"],function(t){"use strict";function e(n,i){t(function(){var r=t("X3DCanvas");e.fallback(r,n);for(var o=0;o<i.length;++o){var s=i[o];"function"==typeof s&&s(r,n)}})}function n(e,n){console.log(n);var i=t(".x_ite-console");i.length&&i.append(document.createTextNode(n)),e.addClass("x_ite-browser-fallback"),e.children(".x_ite-private-browser").hide(),e.children(":not(.x_ite-private-browser)").addClass("x_ite-fallback"),e.children(":not(.x_ite-private-browser)").show()}return e.fallback=n,e}),define("x_ite/Basic/X3DFieldDefinition",[],function(){"use strict";function t(t,e,n){this.accessType=t,this.dataType=n.getType(),this.name=e,this.value=n,Object.preventExtensions(this),Object.freeze(this),Object.seal(this)}return t.prototype.constructor=t,t}),define("x_ite/Basic/FieldDefinitionArray",[],function(){"use strict";function t(t){this.array=t,this.index={};for(var n=0,i=t.length;n<i;++n)this.index[t[n].name]=t[n];return new Proxy(this,e)}var e={get:function(t,e){var n=t[e];return void 0!==n?n:t.array[e]},set:function(t,e,n){return!1},has:function(t,e){return Number.isInteger(+e)?e<t.array.length:e in t},enumerate:function(t){for(var e=[],n=0,i=t.array.length;n<i;++n)array.push(n);return e[Symbol.iterator]()}};return Object.assign(t.prototype,{constructor:t,add:function(t){this.array.push(t),this.index[t.name]=t},get:function(t){return this.index[t]},getValue:function(){return this.array}}),Object.defineProperty(t.prototype,"length",{get:function(){return this.array.length},enumerable:!1,configurable:!1}),t}),define("x_ite/Bits/X3DConstants",[],function(){"use strict";var t=0,e=0,n=0;return{CONNECTION_ERROR:t++,BROWSER_EVENT:t++,INITIALIZED_EVENT:t++,SHUTDOWN_EVENT:t++,INITIALIZED_ERROR:t++,NOT_STARTED_STATE:e++,IN_PROGRESS_STATE:e++,COMPLETE_STATE:e++,FAILED_STATE:e++,initializeOnly:parseInt("001",2),inputOnly:parseInt("010",2),outputOnly:parseInt("100",2),inputOutput:parseInt("111",2),SFBool:n++,SFColor:n++,SFColorRGBA:n++,SFDouble:n++,SFFloat:n++,SFImage:n++,SFInt32:n++,SFMatrix3d:n++,SFMatrix3f:n++,SFMatrix4d:n++,SFMatrix4f:n++,SFNode:n++,SFRotation:n++,SFString:n++,SFTime:n++,SFVec2d:n++,SFVec2f:n++,SFVec3d:n++,SFVec3f:n++,SFVec4d:n++,SFVec4f:n++,VrmlMatrix:n++,MFBool:n++,MFColor:n++,MFColorRGBA:n++,MFDouble:n++,MFFloat:n++,MFImage:n++,MFInt32:n++,MFMatrix3d:n++,MFMatrix3f:n++,MFMatrix4d:n++,MFMatrix4f:n++,MFNode:n++,MFRotation:n++,MFString:n++,MFTime:n++,MFVec2d:n++,MFVec2f:n++,MFVec3d:n++,MFVec3f:n++,MFVec4d:n++,MFVec4f:n++,X3DBaseNode:0}}),define("x_ite/InputOutput/Generator",["x_ite/Bits/X3DConstants"],function(t){"use strict";function e(){this.indent="",this.indentChar="  ",this.executionContextStack=[null],this.importedNodesIndex=new Map,this.exportedNodesIndex=new Map,this.nodes=new Set,this.names=new Map,this.namesByNode=new Map,this.importedNames=new Map,this.routeNodes=new Set,this.level=0,this.newName=0,this.containerFields=[],this.units=!0,this.unitCategories=[],this.names.set(null,new Map)}return e.prototype={constructor:e,Indent:function(){return this.indent},IncIndent:function(){this.indent+=this.indentChar},DecIndent:function(){this.indent=this.indent.substr(0,this.indent.length-this.indentChar.length)},PadRight:function(t,e){for(var n=0,i=e-t.length;n<i;++n)t+=" ";return t},PushExecutionContext:function(t){this.executionContextStack.push(t),this.names.has(t)||this.names.set(t,new Map),this.importedNodesIndex.has(t)||this.importedNodesIndex.set(t,new Set),this.exportedNodesIndex.has(t)||this.exportedNodesIndex.set(t,new Set)},PopExecutionContext:function(){this.executionContextStack.pop(),this.ExecutionContext()||(this.importedNodesIndex.clear(),this.exportedNodesIndex.clear())},ExecutionContext:function(){return this.executionContextStack[this.executionContextStack.length-1]},EnterScope:function(){0===this.level&&(this.newName=0),++this.level},LeaveScope:function(){0===--this.level&&(this.nodes.clear(),this.namesByNode.clear(),this.importedNames.clear())},ExportedNodes:function(t){var e=this.exportedNodesIndex.get(this.ExecutionContext());t.forEach(function(t){try{e.add(t.getLocalNode())}catch(t){}})},ImportedNodes:function(t){var e=this.importedNodesIndex.get(this.ExecutionContext());t.forEach(function(t){try{e.add(t.getInlineNode())}catch(t){}})},AddImportedNode:function(t,e){this.importedNames.set(t,e)},AddRouteNode:function(t){this.routeNodes.add(t)},ExistsRouteNode:function(t){return this.routeNodes.has(t)},IsSharedNode:function(t){return!1},AddNode:function(t){this.nodes.add(t),this.AddRouteNode(t)},ExistsNode:function(t){return this.nodes.has(t)},Name:function(t){var e=this.namesByNode.get(t);if(void 0!==e)return e;var n=this.names.get(this.ExecutionContext());if(0===t.getName().length){if(this.NeedsName(t)){var e=this.UniqueName();return n.set(e,t),this.namesByNode.set(t,e),e}return t.getName()}var e=t.getName(),i=null!==e.match(/(_\d+$)/);if(e=e.replace(/(_\d+$)/,""),0===e.length){if(!this.NeedsName(t))return"";e=this.UniqueName()}else{for(var r=0,o=i?e+"_"+ ++r:e;n.has(o);)o=e+"_"+ ++r;e=o}return n.set(e,t),this.namesByNode.set(t,e),e},NeedsName:function(t){if(t.getCloneCount()>1)return!0;if(t.hasRoutes())return!0;var e=t.getExecutionContext(),n=this.importedNodesIndex.get(e);if(n&&n.has(t))return!0;var n=this.exportedNodesIndex.get(e);return!(!n||!n.has(t))},UniqueName:function(){for(var t=this.names.get(this.ExecutionContext());;){var e="_"+ ++this.newName;if(!t.has(e))return e}},LocalName:function(t){var e=this.importedNames.get(t);if(void 0!==e)return e;if(this.ExistsNode(t))return this.Name(t);throw new Error("Couldn't get local name for node '"+t.getTypeName()+"'.")},PushContainerField:function(t){this.containerFields.push(t)},PopContainerField:function(){this.containerFields.pop()},ContainerField:function(){return this.containerFields.length?this.containerFields[this.containerFields.length-1]:null},AccessType:function(e){switch(e){case t.initializeOnly:return"initializeOnly";case t.inputOnly:return"inputOnly";case t.outputOnly:return"outputOnly";case t.inputOutput:return"inputOutput"}},SetUnits:function(t){this.units=t},GetUnits:function(){return this.units},PushUnitCategory:function(t){this.unitCategories.push(t)},PopUnitCategory:function(){this.unitCategories.pop()},Unit:function(t){var e=this.unitCategories.length;return 0==e?t:this.unitCategories[e-1]},ToUnit:function(t,e){if(this.units){var n=this.ExecutionContext();if(n)return n.toUnit(t,e)}return e},XMLEncode:function(t){return t.replace(/&/g,"&amp;").replace(/\\/g,"&#92;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,'\\"')},escapeCDATA:function(t){return t.replace(/\]\]\>/g,"\\]\\]\\>")}},e.Get=function(t){return t.generator||(t.generator=new e),t.generator},e}),define("x_ite/Base/X3DObject",["x_ite/InputOutput/Generator"],function(t){"use strict";function e(){}return e.prototype={constructor:e,_id:0,_name:"",_interests:new Map,getId:function(){function t(){return this._id}var e=0;return function(){return this.getId=t,this._id=++e}}(),setName:function(t){this._name=t},getName:function(){return this._name},hasInterest:function(t,e){return this._interests.has(e.getId()+t)},addInterest:function(t,e){this.hasOwnProperty("_interests")||(this._interests=new Map);var n=e[t];if(arguments.length>2){var i=Array.prototype.slice.call(arguments,0);i[0]=e,i[1]=this,this._interests.set(e.getId()+t,Function.prototype.bind.apply(n,i))}else{var r=this;this._interests.set(e.getId()+t,function(){n.call(e,r)})}},removeInterest:function(t,e){this._interests.delete(e.getId()+t)},getInterests:function(){return this._interests},processInterests:function(){this._interests.forEach(function(t){t()})},toString:function(e){var n={string:""};return e&&t.Get(n).PushExecutionContext(e),this.toStream(n),n.string},toVRMLString:function(){var t={string:""};return this.toVRMLStream(t),t.string},toXMLString:function(){var t={string:""};return this.toXMLStream(t),t.string},dispose:function(){}},e}),define("x_ite/Base/X3DChildObject",["x_ite/Base/X3DObject"],function(t){"use strict";function e(){t.call(this)}return e.prototype=Object.assign(Object.create(t.prototype),{constructor:e,_tainted:!1,_parents:new Set,setTainted:function(t){this._tainted=t},getTainted:function(){return this._tainted},addEvent:function(){this._tainted||this._parents.forEach(function(t){t.addEvent(this)},this)},addEventObject:function(t,e){this._parents.forEach(function(t){t.addEventObject(this,e)},this)},addParent:function(t){this.hasOwnProperty("_parents")||(this._parents=new Set),this._parents.add(t)},removeParent:function(t){this._parents.delete(t)},getParents:function(){return this._parents},addClones:Function.prototype,removeClones:Function.prototype,dispose:function(){this._parents.clear(),t.prototype.dispose.call(this)}}),e}),define("x_ite/Base/Events",[],function(){"use strict";return{stack:[],create:function(t){if(this.stack.length){var e=this.stack.pop();return e.field=t,e.clear(),e}var e=new Set;return e.field=t,e},copy:function(t){if(this.stack.length){var e=this.stack.pop();return e.field=t.field,e.clear(),t.forEach(function(t){this.add(t)},e),e}var e=new Set(t);return e.field=t.field,e},push:function(t){this.stack.push(t)},clear:function(){this.stack.length=0}}}),define("x_ite/Basic/X3DField",["jquery","x_ite/Base/X3DChildObject","x_ite/Bits/X3DConstants","x_ite/Base/Events"],function(t,e,n,i){"use strict";function r(t){return e.call(this),this._value=t,this}return r.prototype=Object.assign(Object.create(e.prototype),{constructor:r,_value:null,_accessType:n.initializeOnly,_unit:null,_set:!1,_uniformLocation:null,_references:new Map,_fieldInterests:new Map,_fieldCallbacks:new Map,_inputRoutes:new Map,_outputRoutes:new Map,_routeCallbacks:new Map,clone:function(){return this.copy()},equals:function(t){return this._value===t.valueOf()},assign:function(t){this.set(t.getValue()),this.addEvent()},set:function(t){this._value=t},setValue:function(t){this.set(t instanceof this.constructor?t.getValue():t),this.addEvent()},getValue:function(){return this._value},setAccessType:function(t){this._accessType=t},getAccessType:function(){return this._accessType},isInitializable:function(){return this.getAccessType()&n.initializeOnly},isInput:function(){return this.getAccessType()&n.inputOnly},isOutput:function(){return this.getAccessType()&n.outputOnly},isReadable:function(){return this.getAccessType()!==n.inputOnly},isWritable:function(){return this.getAccessType()!==n.initializeOnly},setUnit:function(t){return this._unit=t},getUnit:function(){return this._unit},setSet:function(t){return this._set=t},getSet:function(){return this._set},hasReferences:function(){return!!this.hasOwnProperty("_references")&&0!==this._references.size},isReference:function(t){return t===this.getAccessType()||t===n.inputOutput},addReference:function(t){var e=this.getReferences();if(!e.has(t.getId()))switch(e.set(t.getId(),t),this.getAccessType()&t.getAccessType()){case n.initializeOnly:return t.addFieldInterest(this),void this.set(t.getValue(),t.length);case n.inputOnly:return void t.addFieldInterest(this);case n.outputOnly:return void this.addFieldInterest(t);case n.inputOutput:return t.addFieldInterest(this),this.addFieldInterest(t),void this.set(t.getValue(),t.length)}},getReferences:function(){return this.hasOwnProperty("_references")||(this._references=new Map),this._references},updateReferences:function(){this.hasOwnProperty("_references")&&this._references.forEach(function(t){switch(this.getAccessType()&t.getAccessType()){case n.inputOnly:case n.outputOnly:break;case n.initializeOnly:case n.inputOutput:this.set(t.getValue(),t.length)}},this)},addFieldInterest:function(t){this.hasOwnProperty("_fieldInterests")||(this._fieldInterests=new Map),this._fieldInterests.set(t.getId(),t)},removeFieldInterest:function(t){this._fieldInterests.delete(t.getId())},getFieldInterests:function(){return this._fieldInterests},addFieldCallback:function(t,e){this.hasOwnProperty("_fieldCallbacks")||(this._fieldCallbacks=new Map),this._fieldCallbacks.set(t,e)},removeFieldCallback:function(t){this._fieldCallbacks.delete(t)},getFieldCallbacks:function(){return this._fieldCallbacks},addInputRoute:function(t){this.hasOwnProperty("_inputRoutes")||(this._inputRoutes=new Map),this._inputRoutes.set(t.getId(),t),this.processRouteCallbacks()},removeInputRoute:function(t){this._inputRoutes.delete(t.getId()),this.processRouteCallbacks()},getInputRoutes:function(){return this._inputRoutes},addOutputRoute:function(t){this.hasOwnProperty("_outputRoutes")||(this._outputRoutes=new Map),this._outputRoutes.set(t.getId(),t),this.processRouteCallbacks()},removeOutputRoute:function(t){this._outputRoutes.delete(t.getId()),this.processRouteCallbacks()},getOutputRoutes:function(){return this._outputRoutes},addRouteCallback:function(t,e){this.hasOwnProperty("_routeCallbacks")||(this._routeCallbacks=new Map),this._routeCallbacks.set(t,e)},removeRouteCallback:function(t){this._routeCallbacks.delete(t)},getRouteCallbacks:function(){return this._routeCallbacks},processRouteCallbacks:function(){this._routeCallbacks.size&&this._routeCallbacks.forEach(function(t){t()})},processEvent:function(t){if(!t.has(this.getId())){t.add(this.getId()),this.setTainted(!1);var e=t.field;e!==this&&this.set(e.getValue(),e.length),this.processInterests();var n=!0;this._fieldInterests.forEach(function(e){n?(n=!1,e.addEventObject(this,t)):e.addEventObject(this,i.copy(t))},this),n&&i.push(t),this._fieldCallbacks.size&&this._fieldCallbacks.forEach(function(t){t(this.valueOf())},this)}},valueOf:function(){return this},fromString:function(t,e){var n=require("x_ite/Parser/Parser"),i=new n(e);i.setUnits(!!e),i.setInput(t),i.fieldValue(this),this.addEvent()}}),r}),define("x_ite/Basic/X3DArrayField",["x_ite/Basic/X3DField"],function(t){"use strict";function e(e){t.call(this,e)}return e.prototype=Object.assign(Object.create(t.prototype),{constructor:e}),e}),define("x_ite/Fields/SFBool",["x_ite/Basic/X3DField","x_ite/Bits/X3DConstants"],function(t,e){"use strict";function n(e){return t.call(this,!!e)}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,copy:function(){return new n(this.getValue())},isDefaultValue:function(){return this.getValue()===!1},set:function(e){t.prototype.set.call(this,!!e)},getTypeName:function(){return"SFBool"},getType:function(){return e.SFBool},valueOf:function(){return this.getValue()},toStream:function(t){t.string+=this.getValue()?"TRUE":"FALSE"},toVRMLStream:function(t){this.toStream(t)},toXMLStream:function(t){t.string+=this.getValue()?"true":"false"}}),n}),define("standard/Math/Algorithm",[],function(){"use strict";var t={signum:function(t){return(0<t)-(t<0)},radians:function(t){return t*(Math.PI/180)},degrees:function(t){return t*(180/Math.PI)},random:function(t,e){return t+Math.random()*(e-t)},clamp:function(t,e,n){return Math.min(Math.max(t,e),n)},interval:function(t,e,n){return t>=n?(t-e)%(n-e)+e:t<e?(t-n)%(n-e)+n:t},lerp:function(t,e,n){return t+n*(e-t)},slerp:function(t,e,n){var i=t.dot(e);if(i<=-1)throw new Error("slerp is not possible: vectors are inverse collinear.");if(i>=1)return t;i<0&&(i=-i,e.negate());var r=Math.acos(i),o=Math.sin(r),s=Math.sin((1-n)*r)/o,a=Math.sin(n*r)/o;return t.x=t.x*s+e.x*a,t.y=t.y*s+e.y*a,t.z=t.z*s+e.z*a,t.w=t.w*s+e.w*a,t},simpleSlerp:function(t,e,n){var i=t.dot(e);if(i<=-1)throw new Error("slerp is not possible: vectors are inverse collinear.");if(i>=1)return t;var r=Math.acos(i),o=Math.sin(r),s=Math.sin((1-n)*r)/o,a=Math.sin(n*r)/o;return t.x=t.x*s+e.x*a,t.y=t.y*s+e.y*a,t.z=t.z*s+e.z*a,t.w=t.w*s+e.w*a,t},isPowerOfTwo:function(t){return 0==(t-1&t)},nextPowerOfTwo:function(t){--t;for(var e=1;!(32&e);e<<=1)t|=t>>e;return++t},cmp:function(t,e){return t>e?1:t<e?-1:0},less:function(t,e){return t<e},greater:function(t,e){return t>e},lowerBound:function(t,e,n,i,r){for(var o=0,s=0,a=n-e;a>0;)s=a>>>1,o=e+s,r(t[o],i)?(e=++o,a-=s+1):a=s;return e},upperBound:function(t,e,n,i,r){for(var o=0,s=0,a=n-e;a>0;)s=a>>>1,o=e+s,r(i,t[o])?a=s:(e=++o,a-=s+1);return e},set_difference:function(t,e,n){for(var i in t)i in e||(n[i]=t[i]);return n}};return Object.preventExtensions(t),Object.freeze(t),Object.seal(t),t}),define("standard/Math/Numbers/Color3",["standard/Math/Algorithm"],function(t){"use strict";function e(t,e,i){arguments.length?(this.r_=n(t,0,1),this.g_=n(e,0,1),this.b_=n(i,0,1)):(this.r_=0,this.g_=0,this.b_=0)}var n=t.clamp;e.prototype={constructor:e,length:3,copy:function(){var t=Object.create(e.prototype);return t.r_=this.r_,t.g_=this.g_,t.b_=this.b_,t},assign:function(t){this.r_=t.r_,this.g_=t.g_,this.b_=t.b_},set:function(t,e,i){this.r_=n(t,0,1),this.g_=n(e,0,1),this.b_=n(i,0,1)},equals:function(t){return this.r_===t.r_&&this.g_===t.g_&&this.b_===t.b_},getHSV:function(t){var e,n,i,r=Math.min(this.r_,this.g_,this.b_),o=Math.max(this.r_,this.g_,this.b_);i=o;var s=o-r;return 0!==o&&0!==s?(n=s/o,e=this.r_===o?(this.g_-this.b_)/s:this.g_===o?2+(this.b_-this.r_)/s:4+(this.r_-this.g_)/s,(e*=Math.PI/3)<0&&(e+=2*Math.PI)):n=e=0,t[0]=e,t[1]=n,t[2]=i,t},setHSV:function(e,i,r){if(i=n(i,0,1),r=n(r,0,1),0===i)this.r_=this.g_=this.b_=r;else{var o=t.degrees(t.interval(e,0,2*Math.PI))/60,s=Math.floor(o),a=o-s,u=r*(1-i),l=r*(1-i*a),c=r*(1-i*(1-a));switch(s%6){case 0:this.r_=r,this.g_=c,this.b_=u;break;case 1:this.r_=l,this.g_=r,this.b_=u;break;case 2:this.r_=u,this.g_=r,this.b_=c;break;case 3:this.r_=u,this.g_=l,this.b_=r;break;case 4:this.r_=c,this.g_=u,this.b_=r;break;default:this.r_=r,this.g_=u,this.b_=l}}},toString:function(){return this.r_+" "+this.g_+" "+this.b_}};var i={get:function(){return this.r_},set:function(t){this.r_=n(t,0,1)},enumerable:!0,configurable:!1},r={get:function(){return this.g_},set:function(t){this.g_=n(t,0,1)},enumerable:!0,configurable:!1},o={get:function(){return this.b_},set:function(t){this.b_=n(t,0,1)},enumerable:!0,configurable:!1};return Object.defineProperty(e.prototype,"r",i),Object.defineProperty(e.prototype,"g",r),Object.defineProperty(e.prototype,"b",o),i.enumerable=!1,r.enumerable=!1,o.enumerable=!1,Object.defineProperty(e.prototype,"0",i),Object.defineProperty(e.prototype,"1",r),Object.defineProperty(e.prototype,"2",o),Object.assign(e,{HSV:function(t,e,n){var i=Object.create(this.prototype);return i.setHSV(t,e,n),i},lerp:function(t,e,n,i){var r=t[0],o=e[0],s=t[1],a=e[1],u=t[2],l=e[2];0===s&&(r=o),0===a&&(o=r);var c=Math.abs(o-r);if(c<=Math.PI)return i[0]=r+n*(o-r),i[1]=s+n*(a-s),i[2]=u+n*(l-u),i;var h=2*Math.PI,d=(h-c)*n,p=r<o?r-d:r+d;return p<0?p+=h:p>h&&(p-=h),i[0]=p,i[1]=s+n*(a-s),i[2]=u+n*(l-u),i}}),e}),define("x_ite/Fields/SFColor",["standard/Math/Numbers/Color3","x_ite/Basic/X3DField","x_ite/Bits/X3DConstants"],function(t,e,n){"use strict";function i(n,i,r){return arguments.length?arguments[0]instanceof t?e.call(this,arguments[0]):e.call(this,new t(1*n,1*i,1*r)):e.call(this,new t)}i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,copy:function(){return new i(this.getValue().copy())},getTypeName:function(){return"SFColor"},getType:function(){return n.SFColor},equals:function(t){return this.getValue().equals(t.getValue())},isDefaultValue:function(){return 0===this.getValue().r&&0===this.getValue().g&&0===this.getValue().b},set:function(t){this.getValue().assign(t)},getHSV:function(){return this.getValue().getHSV([])},setHSV:function(t,e,n){this.getValue().setHSV(t,e,n),this.addEvent()},lerp:function(){var e=[],n=[],r=[];return function(o,s){var a=new i;return this.getValue().getHSV(e),o.getValue().getHSV(n),t.lerp(e,n,s,r),a.setHSV(r[0],r[1],r[2],r[3]),a}}(),toStream:function(t){t.string+=this.getValue().toString()},toVRMLStream:function(t){this.toStream(t)},toXMLStream:function(t){this.toStream(t)}});var r={get:function(){return this.getValue().r},set:function(t){this.getValue().r=1*t,this.addEvent()},enumerable:!0,configurable:!1},o={get:function(){return this.getValue().g},set:function(t){this.getValue().g=1*t,this.addEvent()},enumerable:!0,configurable:!1},s={get:function(){return this.getValue().b},set:function(t){this.getValue().b=1*t,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(i.prototype,"r",r),Object.defineProperty(i.prototype,"g",o),Object.defineProperty(i.prototype,"b",s),r.enumerable=!1,o.enumerable=!1,s.enumerable=!1,Object.defineProperty(i.prototype,"0",r),Object.defineProperty(i.prototype,"1",o),Object.defineProperty(i.prototype,"2",s),i}),define("standard/Math/Numbers/Color4",["standard/Math/Numbers/Color3","standard/Math/Algorithm"],function(t,e){"use strict";function n(t,e,n,r){arguments.length?(this.r_=i(t,0,1),this.g_=i(e,0,1),this.b_=i(n,0,1),this.a_=i(r,0,1)):(this.r_=0,this.g_=0,this.b_=0,this.a_=0)}var i=e.clamp;n.prototype={constructor:n,length:4,copy:function(){var t=Object.create(n.prototype);return t.r_=this.r_,t.g_=this.g_,t.b_=this.b_,t.a_=this.a_,t},assign:function(t){this.r_=t.r_,this.g_=t.g_,this.b_=t.b_,this.a_=t.a_},set:function(t,e,n,r){this.r_=i(t,0,1),this.g_=i(e,0,1),this.b_=i(n,0,1),this.a_=i(r,0,1)},equals:function(t){return this.r_===t.r_&&this.g_===t.g_&&this.b_===t.b_&&this.a_===t.a_},getHSVA:function(e){return t.prototype.getHSV.call(this,e),e[3]=this.a_,e},setHSVA:function(e,n,r,o){t.prototype.setHSV.call(this,e,n,r),this.a_=i(o,0,1)},toString:function(){return this.r_+" "+this.g_+" "+this.b_+" "+this.a_}};var r={get:function(){return this.r_},set:function(t){this.r_=i(t,0,1)},enumerable:!0,configurable:!1},o={get:function(){return this.g_},set:function(t){this.g_=i(t,0,1)},enumerable:!0,configurable:!1},s={get:function(){return this.b_},set:function(t){this.b_=i(t,0,1)},enumerable:!0,configurable:!1},a={get:function(){return this.a_},set:function(t){this.a_=i(t,0,1)},enumerable:!0,configurable:!1};return Object.defineProperty(n.prototype,"r",r),Object.defineProperty(n.prototype,"g",o),Object.defineProperty(n.prototype,"b",s),Object.defineProperty(n.prototype,"a",a),r.enumerable=!1,o.enumerable=!1,s.enumerable=!1,a.enumerable=!1,Object.defineProperty(n.prototype,"0",r),Object.defineProperty(n.prototype,"1",o),Object.defineProperty(n.prototype,"2",s),Object.defineProperty(n.prototype,"3",a),Object.assign(n,{HSVA:function(t,e,n,i){var r=Object.create(this.prototype);return r.setHSVA(t,e,n,i),r},lerp:function(e,n,i,r){var o=e[3];return t.lerp(e,n,i,r),r[3]=o+i*(n[3]-o),r}}),n}),define("x_ite/Fields/SFColorRGBA",["x_ite/Basic/X3DField","x_ite/Fields/SFColor","x_ite/Bits/X3DConstants","standard/Math/Numbers/Color4"],function(t,e,n,i){"use strict";function r(e,n,r,o){return arguments.length?arguments[0]instanceof i?t.call(this,arguments[0]):t.call(this,new i(1*e,1*n,1*r,1*o)):t.call(this,new i)}r.prototype=Object.assign(Object.create(t.prototype),{constructor:r,copy:function(){return new r(this.getValue().copy())},getTypeName:function(){return"SFColorRGBA"},getType:function(){return n.SFColorRGBA},equals:e.prototype.equals,isDefaultValue:function(){
return 0===this.getValue().r&&0===this.getValue().g&&0===this.getValue().b&&0===this.getValue().a},set:e.prototype.set,getHSVA:function(){return this.getValue().getHSVA([])},setHSVA:function(t,e,n,i){this.getValue().setHSVA(t,e,n,i),this.addEvent()},lerp:function(){var t=[],e=[],n=[];return function(o,s){var a=new r;return this.getValue().getHSVA(t),o.getValue().getHSVA(e),i.lerp(t,e,s,n),a.setHSVA(n[0],n[1],n[2],n[3]),a}}(),toStream:e.prototype.toStream,toVRMLStream:e.prototype.toVRMLStream,toXMLStream:e.prototype.toXMLStream});var o={get:function(){return this.getValue().r},set:function(t){this.getValue().r=1*t,this.addEvent()},enumerable:!0,configurable:!1},s={get:function(){return this.getValue().g},set:function(t){this.getValue().g=1*t,this.addEvent()},enumerable:!0,configurable:!1},a={get:function(){return this.getValue().b},set:function(t){this.getValue().b=1*t,this.addEvent()},enumerable:!0,configurable:!1},u={get:function(){return this.getValue().a},set:function(t){this.getValue().a=1*t,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(r.prototype,"r",o),Object.defineProperty(r.prototype,"g",s),Object.defineProperty(r.prototype,"b",a),Object.defineProperty(r.prototype,"a",u),o.enumerable=!1,s.enumerable=!1,a.enumerable=!1,u.enumerable=!1,Object.defineProperty(r.prototype,"0",o),Object.defineProperty(r.prototype,"1",s),Object.defineProperty(r.prototype,"2",a),Object.defineProperty(r.prototype,"3",u),r}),define("x_ite/Fields/SFDouble",["x_ite/Basic/X3DField","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(t,e,n){"use strict";function i(e){return t.call(this,arguments.length?1*e:0)}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,copy:function(){return new i(this.getValue())},getTypeName:function(){return"SFDouble"},getType:function(){return e.SFDouble},isDefaultValue:function(){return 0===this.getValue()},set:function(e){t.prototype.set.call(this,+e)},valueOf:t.prototype.getValue,toStream:function(t){var e=n.Get(t),i=e.Unit(this.getUnit());t.string+=String(e.ToUnit(i,this.getValue()))},toVRMLStream:function(t){this.toStream(t)},toXMLStream:function(t){this.toStream(t)}}),i}),define("x_ite/Fields/SFFloat",["x_ite/Basic/X3DField","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(t,e,n){"use strict";function i(e){return t.call(this,arguments.length?1*e:0)}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,copy:function(){return new i(this.getValue())},getTypeName:function(){return"SFFloat"},getType:function(){return e.SFFloat},isDefaultValue:function(){return 0===this.getValue()},set:function(e){t.prototype.set.call(this,1*e)},valueOf:t.prototype.getValue,toStream:function(t){var e=n.Get(t),i=e.Unit(this.getUnit());t.string+=String(e.ToUnit(i,this.getValue()))},toVRMLStream:function(t){this.toStream(t)},toXMLStream:function(t){this.toStream(t)}}),i}),define("x_ite/Fields/SFInt32",["x_ite/Basic/X3DField","x_ite/Bits/X3DConstants"],function(t,e){"use strict";function n(e){return t.call(this,~~e)}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,copy:function(){return new n(this.getValue())},getTypeName:function(){return"SFInt32"},getType:function(){return e.SFInt32},isDefaultValue:function(){return 0===this.getValue()},set:function(e){t.prototype.set.call(this,~~e)},valueOf:t.prototype.getValue,toStream:function(t,e){t.string+=this.getValue().toString(e)},toVRMLStream:function(t){this.toStream(t)},toXMLStream:function(t){t.string+=this.getValue().toString()}}),n}),define("x_ite/Fields/SFImage",["x_ite/Basic/X3DField","x_ite/Fields/SFInt32","x_ite/Bits/X3DConstants"],function(t,e,n){"use strict";function i(t,e,n,i){var r=require("x_ite/Fields/ArrayFields").MFInt32;this.width=~~t,this.height=~~e,this.comp=~~n,this.array=new r,this.array.setValue(i),this.array.length=this.width*this.height}function r(e,n,r,o){var s=require("x_ite/Fields/ArrayFields").MFInt32;return arguments[0]instanceof i?t.call(this,arguments[0]):4===arguments.length?t.call(this,new i(e,n,r,o)):t.call(this,new i(0,0,0,new s)),this.getValue().getArray().addParent(this),this.addInterest("set_size__",this),this}i.prototype={constructor:i,copy:function(){return new i(this.width,this.height,this.comp,this.array)},equals:function(t){return this.width===t.width&&this.height===t.height&&this.comp===t.comp&&this.array.equals(t.array)},assign:function(t){this.width=t.width,this.height=t.height,this.comp=t.comp,this.array.assign(t.array)},set:function(t,e,n,i){this.width=~~t,this.height=~~e,this.comp=~~n,this.array.assign(i)},setWidth:function(t){this.width=~~t,this.array.length=this.width*this.height},getWidth:function(){return this.width},setHeight:function(t){this.height=~~t,this.array.length=this.width*this.height},getHeight:function(){return this.height},setComp:function(t){this.comp=~~t},getComp:function(){return this.comp},setArray:function(t){this.array.assign(t),this.array.length=this.width*this.height},getArray:function(){return this.array}},r.prototype=Object.assign(Object.create(t.prototype),{constructor:r,set_size__:function(){this.getValue().getArray().length=this.width*this.height},copy:function(){return new r(this.getValue().copy())},equals:function(t){return this.getValue().equals(t.getValue())},isDefaultValue:function(){return 0===this.width&&0===this.height&&0===this.comp},set:function(t){this.getValue().assign(t)},getTypeName:function(){return"SFImage"},getType:function(){return n.SFImage},toStream:function(t){var n=this.array,i=new e;t.string+=this.width+" "+this.height+" "+this.comp;for(var r=0,o=this.width*this.height;r<o;++r)t.string+=" 0x",i.set(n[r]),i.toXMLStream(t)},toVRMLStream:function(t){this.toStream(t)},toXMLStream:function(t){this.toStream(t)}});var o={get:function(){return this.getValue().getWidth()},set:function(t){this.getValue().setWidth(t),this.addEvent()},enumerable:!0,configurable:!1},s={get:function(){return this.getValue().getHeight()},set:function(t){this.getValue().setHeight(t),this.addEvent()},enumerable:!0,configurable:!1},a={get:function(){return this.getValue().getComp()},set:function(t){this.getValue().setComp(t),this.addEvent()},enumerable:!0,configurable:!1},u={get:function(){return this.getValue().getArray()},set:function(t){this.getValue().setArray(t),this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(r.prototype,"width",o),Object.defineProperty(r.prototype,"height",s),Object.defineProperty(r.prototype,"comp",a),Object.defineProperty(r.prototype,"array",u),o.enumerable=!1,s.enumerable=!1,Object.defineProperty(r.prototype,"x",o),Object.defineProperty(r.prototype,"y",s),r}),define("x_ite/Fields/SFMatrixPrototypeTemplate",["x_ite/Basic/X3DField"],function(t){"use strict";return function(e,n){return Object.assign(Object.create(t.prototype),{copy:function(){return new this.constructor(this.getValue().copy())},equals:function(t){return this.getValue().equals(t.getValue())},isDefaultValue:function(){return this.getValue().equals(e.Identity)},set:function(t){this.getValue().assign(t)},setTransform:function(t,e,n,i,r){t=t?t.getValue():null,e=e?e.getValue():null,n=n?n.getValue():null,i=i?i.getValue():null,r=r?r.getValue():null,this.getValue().set(t,e,n,i,r)},getTransform:function(t,e,n,i,r){t=t?t.getValue():null,e=e?e.getValue():null,n=n?n.getValue():null,i=i?i.getValue():null,r=r?r.getValue():null,this.getValue().get(t,e,n,i,r)},transpose:function(){return new this.constructor(e.transpose(this.getValue()))},inverse:function(){return new this.constructor(e.inverse(this.getValue()))},multLeft:function(t){return new this.constructor(e.multLeft(this.getValue(),t.getValue()))},multRight:function(t){return new this.constructor(e.multRight(this.getValue(),t.getValue()))},multVecMatrix:function(t){return new n(this.getValue().multVecMatrix(t.getValue().copy()))},multMatrixVec:function(t){return new n(this.getValue().multMatrixVec(t.getValue().copy()))},multDirMatrix:function(t){return new n(this.getValue().multDirMatrix(t.getValue().copy()))},multMatrixDir:function(t){return new n(this.getValue().multMatrixDir(t.getValue().copy()))},toStream:function(t){t.string+=this.getValue().toString()},toVRMLStream:function(t){this.toStream(t)},toXMLStream:function(t){this.toStream(t)}})}}),define("x_ite/Fields/SFVecPrototypeTemplate",["x_ite/Basic/X3DField","x_ite/InputOutput/Generator"],function(t,e){"use strict";return function(n){return Object.assign(Object.create(t.prototype),{copy:function(){return new this.constructor(this.getValue().copy())},equals:function(t){return this.getValue().equals(t.getValue())},isDefaultValue:function(){return this.getValue().equals(n.Zero)},set:function(t){this.getValue().assign(t)},add:function(t){return new this.constructor(n.add(this.getValue(),t.getValue()))},distance:function(t){return this.getValue().distance(t.getValue())},divide:function(t){return new this.constructor(n.divide(this.getValue(),t))},divVec:function(t){return new this.constructor(n.divVec(this.getValue(),t.getValue()))},dot:function(t){return this.getValue().dot(t.getValue())},length:function(){return this.getValue().abs()},lerp:function(t,e){return new this.constructor(n.lerp(this.getValue(),t,e))},multiply:function(t){return new this.constructor(n.multiply(this.getValue(),t))},multVec:function(t){return new this.constructor(n.multVec(this.getValue(),t.getValue()))},negate:function(){return new this.constructor(n.negate(this.getValue().copy()))},normalize:function(t){return new this.constructor(n.normalize(this.getValue()))},subtract:function(t){return new this.constructor(n.subtract(this.getValue(),t.getValue()))},toStream:function(t){for(var n=e.Get(t),i=this.getValue(),r=n.Unit(this.getUnit()),o=0,s=i.length-1;o<s;++o)t.string+=String(n.ToUnit(r,i[o])),t.string+=" ";t.string+=String(n.ToUnit(r,i[o]))},toVRMLStream:function(t){this.toStream(t)},toXMLStream:function(t){this.toStream(t)}})}}),define("standard/Math/Numbers/Vector2",["standard/Math/Algorithm"],function(t){"use strict";function e(t,e){this.x=t,this.y=e}return e.prototype={constructor:e,length:2,copy:function(){var t=Object.create(e.prototype);return t.x=this.x,t.y=this.y,t},assign:function(t){return this.x=t.x,this.y=t.y,this},set:function(t,e){return this.x=t,this.y=e,this},equals:function(t){return this.x===t.x&&this.y===t.y},negate:function(){return this.x=-this.x,this.y=-this.y,this},add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this},multiply:function(t){return this.x*=t,this.y*=t,this},multVec:function(t){return this.x*=t.x,this.y*=t.y,this},divide:function(t){return this.x/=t,this.y/=t,this},divVec:function(t){return this.x/=t.x,this.y/=t.y,this},normalize:function(){var t=this.x,e=this.y,n=Math.sqrt(t*t+e*e);return n&&(this.x=t/n,this.y=e/n),this},dot:function(t){return this.x*t.x+this.y*t.y},norm:function(){var t=this.x,e=this.y;return t*t+e*e},abs:function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)},distance:function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},lerp:function(t,e){var n=this.x,i=this.y;return this.x=n+e*(t.x-n),this.y=i+e*(t.y-i),this},min:function(t){for(var e=this.x,n=this.y,i=0,r=arguments.length;i<r;++i){var t=arguments[i];e=Math.min(e,t.x),n=Math.min(n,t.y)}return this.x=e,this.y=n,this},max:function(t){for(var e=this.x,n=this.y,i=0,r=arguments.length;i<r;++i){var t=arguments[i];e=Math.max(e,t.x),n=Math.max(n,t.y)}return this.x=e,this.y=n,this},toString:function(){return this.x+" "+this.y}},Object.defineProperty(e.prototype,"0",{get:function(){return this.x},set:function(t){this.x=t},enumerable:!1,configurable:!1}),Object.defineProperty(e.prototype,"1",{get:function(){return this.y},set:function(t){this.y=t},enumerable:!1,configurable:!1}),Object.assign(e,{Zero:new e(0,0),One:new e(1,1),negate:function(t){var e=Object.create(this.prototype);return e.x=-t.x,e.y=-t.y,e},add:function(t,e){var n=Object.create(this.prototype);return n.x=t.x+e.x,n.y=t.y+e.y,n},subtract:function(t,e){var n=Object.create(this.prototype);return n.x=t.x-e.x,n.y=t.y-e.y,n},multiply:function(t,e){var n=Object.create(this.prototype);return n.x=t.x*e,n.y=t.y*e,n},multVec:function(t,e){var n=Object.create(this.prototype);return n.x=t.x*e.x,n.y=t.y*e.y,n},divide:function(t,e){var n=Object.create(this.prototype);return n.x=t.x/e,n.y=t.y/e,n},divVec:function(t,e){var n=Object.create(this.prototype);return n.x=t.x/e.x,n.y=t.y/e.y,n},normalize:function(t){var e=Object.create(this.prototype),n=t.x,i=t.y,r=Math.sqrt(n*n+i*i);return r?(e.x=n/r,e.y=i/r):(e.x=0,e.y=0),e},dot:function(t,e){return t.dot(e)},lerp:function(t,n,i){var r=t.x,o=t.y;return new e(r+i*(n.x-r),o+i*(n.y-o))},min:function(t,n){for(var i=t.x,r=t.y,o=1,s=arguments.length;o<s;++o){var a=arguments[o];i=Math.min(i,a.x),r=Math.min(r,a.y)}return new e(i,r)},max:function(t,n){for(var i=t.x,r=t.y,o=1,s=arguments.length;o<s;++o){var a=arguments[o];i=Math.max(i,a.x),r=Math.max(r,a.y)}return new e(i,r)}}),e}),define("x_ite/Fields/SFVec2",["x_ite/Basic/X3DField","x_ite/Fields/SFVecPrototypeTemplate","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2"],function(t,e,n,i){"use strict";function r(n,r){function o(e,n){return arguments.length?arguments[0]instanceof i?t.call(this,arguments[0]):t.call(this,new i(1*e,1*n)):t.call(this,new i(0,0))}o.prototype=Object.assign(Object.create(t.prototype),e(i),{constructor:o,getTypeName:function(){return n},getType:function(){return r}});var s={get:function(){return this.getValue().x},set:function(t){this.getValue().x=1*t,this.addEvent()},enumerable:!0,configurable:!1},a={get:function(){return this.getValue().y},set:function(t){this.getValue().y=1*t,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(o.prototype,"x",s),Object.defineProperty(o.prototype,"y",a),s.enumerable=!1,a.enumerable=!1,Object.defineProperty(o.prototype,"0",s),Object.defineProperty(o.prototype,"1",a),o}return{SFVec2d:r("SFVec2d",n.SFVec2d),SFVec2f:r("SFVec2f",n.SFVec2f)}}),define("standard/Math/Numbers/Vector3",["standard/Math/Algorithm"],function(t){"use strict";function e(t,e,n){this.x=t,this.y=e,this.z=n}e.prototype={constructor:e,length:3,copy:function(){var t=Object.create(e.prototype);return t.x=this.x,t.y=this.y,t.z=this.z,t},assign:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},multiply:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multVec:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this},divide:function(t){return this.x/=t,this.y/=t,this.z/=t,this},divVec:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},cross:function(t){var e=this.x,n=this.y,i=this.z;return this.x=n*t.z-i*t.y,this.y=i*t.x-e*t.z,this.z=e*t.y-n*t.x,this},normalize:function(){var t=this.x,e=this.y,n=this.z,i=Math.sqrt(t*t+e*e+n*n);return i&&(this.x=t/i,this.y=e/i,this.z=n/i),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},norm:function(){var t=this.x,e=this.y,n=this.z;return t*t+e*e+n*n},abs:function(){var t=this.x,e=this.y,n=this.z;return Math.sqrt(t*t+e*e+n*n)},distance:function(t){var e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return Math.sqrt(e*e+n*n+i*i)},lerp:function(t,e){var n=this.x,i=this.y,r=this.z;return this.x=n+e*(t.x-n),this.y=i+e*(t.y-i),this.z=r+e*(t.z-r),this},slerp:function(e,i){return t.simpleSlerp(this,n.assign(e),i)},min:function(t){for(var e=this.x,n=this.y,i=this.z,r=0,o=arguments.length;r<o;++r){var t=arguments[r];e=Math.min(e,t.x),n=Math.min(n,t.y),i=Math.min(i,t.z)}return this.x=e,this.y=n,this.z=i,this},max:function(t){for(var e=this.x,n=this.y,i=this.z,r=0,o=arguments.length;r<o;++r){var t=arguments[r];e=Math.max(e,t.x),n=Math.max(n,t.y),i=Math.max(i,t.z)}return this.x=e,this.y=n,this.z=i,this},toString:function(){return this.x+" "+this.y+" "+this.z}},Object.defineProperty(e.prototype,"0",{get:function(){return this.x},set:function(t){this.x=t},enumerable:!1,configurable:!1}),Object.defineProperty(e.prototype,"1",{get:function(){return this.y},set:function(t){this.y=t},enumerable:!1,configurable:!1}),Object.defineProperty(e.prototype,"2",{get:function(){return this.z},set:function(t){this.z=t},enumerable:!1,configurable:!1}),Object.assign(e,{Zero:new e(0,0,0),One:new e(1,1,1),xAxis:new e(1,0,0),yAxis:new e(0,1,0),zAxis:new e(0,0,1),negate:function(t){var e=Object.create(this.prototype);return e.x=-t.x,e.y=-t.y,e.z=-t.z,e},add:function(t,e){var n=Object.create(this.prototype);return n.x=t.x+e.x,n.y=t.y+e.y,n.z=t.z+e.z,n},subtract:function(t,e){var n=Object.create(this.prototype);return n.x=t.x-e.x,n.y=t.y-e.y,n.z=t.z-e.z,n},multiply:function(t,e){var n=Object.create(this.prototype);return n.x=t.x*e,n.y=t.y*e,n.z=t.z*e,n},multVec:function(t,e){var n=Object.create(this.prototype);return n.x=t.x*e.x,n.y=t.y*e.y,n.z=t.z*e.z,n},divide:function(t,e){var n=Object.create(this.prototype);return n.x=t.x/e,n.y=t.y/e,n.z=t.z/e,n},divVec:function(t,e){var n=Object.create(this.prototype);return n.x=t.x/e.x,n.y=t.y/e.y,n.z=t.z/e.z,n},cross:function(t,e){var n=Object.create(this.prototype);return n.x=t.y*e.z-t.z*e.y,n.y=t.z*e.x-t.x*e.z,n.z=t.x*e.y-t.y*e.x,n},normalize:function(t){var e=Object.create(this.prototype),n=t.x,i=t.y,r=t.z,o=Math.sqrt(n*n+i*i+r*r);return o?(e.x=n/o,e.y=i/o,e.z=r/o):(e.x=0,e.y=0,e.z=0),e},dot:function(t,e){return t.dot(e)},lerp:function(t,n,i){var r=t.x,o=t.y,s=t.z;return new e(r+i*(n.x-r),o+i*(n.y-o),s+i*(n.z-s))},slerp:function(e,i,r){return t.simpleSlerp(e.copy(),n.assign(i),r)},min:function(t,n){for(var i=t.x,r=t.y,o=t.z,s=1,a=arguments.length;s<a;++s){var u=arguments[s];i=Math.min(i,u.x),r=Math.min(r,u.y),o=Math.min(o,u.z)}return new e(i,r,o)},max:function(t,n){for(var i=t.x,r=t.y,o=t.z,s=1,a=arguments.length;s<a;++s){var u=arguments[s];i=Math.max(i,u.x),r=Math.max(r,u.y),o=Math.max(o,u.z)}return new e(i,r,o)}});var n=new e(0,0,0);return e}),define("standard/Math/Numbers/Matrix2",["standard/Math/Numbers/Vector2","standard/Math/Algorithm"],function(t,e){"use strict";function n(){arguments.length?(this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3]):this.identity()}return n.prototype={constructor:n,order:2,length:4,copy:function(){var t=Object.create(n.prototype);return t[0]=this[0],t[1]=this[1],t[2]=this[2],t[3]=this[3],t},assign:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this},equals:function(t){return this[0]===t[0]&&this[1]===t[1]&&this[2]===t[2]&&this[3]===t[3]},set1:function(t,e,n){this[t*this.order+e]=n},get1:function(t,e){return this[t*this.order+e]},set:function(){switch(arguments.length){case 0:this.identity();break;case 4:this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3]}},determinant1:function(){return this[0]},determinant:function(){return this[0]*this[3]-this[1]*this[2]},transpose:function(){var t=this[1];return this[1]=this[2],this[2]=t,this},inverse:function(){var t=this.determinant();if(0===t)throw new Error("Matrix2 .inverse: determinant is 0.");return this[0]=array[0]/t,this[1]=-array[1]/t,this[2]=-array[2]/t,this[3]=array[3]/t,this},multLeft:function(t){var e=this[0],n=this[1],i=this[2],r=this[3],o=t[0],s=t[1],a=t[2],u=t[3];return this[0]=e*o+i*s,this[1]=n*o+r*s,this[2]=e*a+i*u,this[3]=n*a+r*u,this},multRight:function(t){var e=this[0],n=this[1],i=this[2],r=this[3],o=t[0],s=t[1],a=t[2],u=t[3];return this[0]=o*e+a*n,this[1]=s*e+u*n,this[2]=o*i+a*r,this[3]=s*i+u*r,this},identity:function(){this[0]=1,this[1]=0,this[2]=0,this[3]=1},toString:function(){return this[0]+" "+this[1]+" "+this[2]+" "+this[3]}},Object.defineProperty(n.prototype,"x",{get:function(){var e=new t(0,0);return function(){return e.set(this[0],this[1])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(n.prototype,"xAxis",{get:function(){return this[0]},enumerable:!1,configurable:!1}),Object.defineProperty(n.prototype,"origin",{get:function(){return this[2]},enumerable:!1,configurable:!1}),Object.defineProperty(n.prototype,"submatrix",{get:function(){return this[0]},enumerable:!1,configurable:!1}),Object.assign(n,{Identity:new n}),n}),define("standard/Math/Algorithms/eigendecomposition",[],function(){"use strict";var t=[],e=[],n=[];return function(i,r){var o,s,a,u,l,c,h,d,p,f,g,m,x,v=i.order,_=r.values,y=r.vectors,w=i.length;for(m=0;m<v;++m)for(t[m]=t[m]||new Array(v),e[m]=_[m]=i.get1(m,m),n[m]=0,x=0;x<v;++x)y[m][x]=m===x?1:0,t[m][x]=i.get1(x,m);for(m=0;m<50;++m){for(o=0,f=0;f<v-1;++f)for(g=f+1;g<v;++g)o+=Math.abs(t[f][g]);if(0===o)break;for(p=m<3?.2*o/w:0,f=0;f<v-1;++f)for(g=f+1;g<v;++g)if(d=100*Math.abs(t[f][g]),m>3&&Math.abs(_[f])+d===Math.abs(_[f])&&Math.abs(_[g])+d===Math.abs(_[g]))t[f][g]=0;else if(Math.abs(t[f][g])>p){for(h=_[g]-_[f],Math.abs(h)+d===Math.abs(h)?l=t[f][g]/h:(s=.5*h/t[f][g],l=1/(Math.abs(s)+Math.sqrt(1+s*s)),s<0&&(l=-l)),a=1/Math.sqrt(1+l*l),u=l*a,c=u/(1+a),h=l*t[f][g],n[f]-=h,n[g]+=h,_[f]-=h,_[g]+=h,t[f][g]=0,x=0;x<f;++x)d=t[x][f],h=t[x][g],t[x][f]=d-u*(h+d*c),t[x][g]=h+u*(d-h*c);for(x=f+1;x<g;++x)d=t[f][x],h=t[x][g],t[f][x]=d-u*(h+d*c),t[x][g]=h+u*(d-h*c);for(x=g+1;x<v;++x)d=t[f][x],h=t[g][x],t[f][x]=d-u*(h+d*c),t[g][x]=h+u*(d-h*c);for(x=0;x<v;++x)d=y[x][f],h=y[x][g],y[x][f]=d-u*(h+d*c),y[x][g]=h+u*(d-h*c)}for(f=0;f<v;++f)_[f]=e[f]+=n[f],n[f]=0}return r}}),define("standard/Math/Numbers/Matrix3",["standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix2","standard/Math/Algorithms/eigendecomposition"],function(t,e,n,i){"use strict";function r(){arguments.length?(this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3],this[4]=arguments[4],this[5]=arguments[5],this[6]=arguments[6],this[7]=arguments[7],this[8]=arguments[8]):this.identity()}return r.prototype={constructor:r,order:3,length:9,copy:function(){var t=Object.create(r.prototype);return t[0]=this[0],t[1]=this[1],t[2]=this[2],t[3]=this[3],t[4]=this[4],t[5]=this[5],t[6]=this[6],t[7]=this[7],t[8]=this[8],t},assign:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this},equals:function(t){return this[0]===t[0]&&this[1]===t[1]&&this[2]===t[2]&&this[3]===t[3]&&this[4]===t[4]&&this[5]===t[5]&&this[6]===t[6]&&this[7]===t[7]&&this[8]===t[8]},rotation:function(){return math.atan2(this[1],this[0])},set1:function(t,e,n){return this[t*this.order+e]=n,this},get1:function(t,e){return this[t*this.order+e]},set:function(e,n,i,r,o){switch(arguments.length){case 0:this.identity();break;case 1:null===e&&(e=t.Zero),this.identity(),this.translate(e);break;case 2:null===e&&(e=t.Zero),null===n&&(n=0),this.identity(),this.translate(e),0!==n&&this.rotate(n);break;case 3:null===e&&(e=t.Zero),null===n&&(n=0),null===i&&(i=t.One),this.identity(),this.translate(e),0!==n&&this.rotate(n),i.equals(t.One)||this.scale(i);break;case 4:if(null===e&&(e=t.Zero),null===n&&(n=0),null===i&&(i=t.One),null===r&&(r=0),this.identity(),this.translate(e),0!==n&&this.rotate(n),!i.equals(t.One)){0!==r?(this.rotate(r),this.scale(i),this.rotate(-r)):this.scale(i)}break;case 5:null===e&&(e=t.Zero),null===n&&(n=0),null===i&&(i=t.One),null===r&&(r=0),null===o&&(o=t.Zero),this.identity(),this.translate(e);var s=!o.equals(t.Zero);s&&this.translate(o),0!==n&&this.rotate(n),i.equals(t.One)||(0!==r?(this.rotate(r),this.scale(i),this.rotate(-r)):this.scale(i)),s&&this.translate(t.negate(o));break;case 9:this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3],this[4]=arguments[4],this[5]=arguments[5],this[6]=arguments[6],this[7]=arguments[7],this[8]=arguments[8]}return this},get:function(){var i=new t(0,0),o=new e(0,0,0),s=new t(0,0),a=new e(0,0,0),u=new t(0,0),l=new n,c=new n,h=new t(0,0);return function(t,e,n,d,p){switch(null===t&&(t=i),null===e&&(e=o),null===n&&(n=s),null===d&&(d=a),null===p&&(p=u),arguments.length){case 1:t.set(this[6],this[7]);break;case 2:this.factor(t,l,s,c),e[0]=l[0],e[1]=l[1],e[2]=Math.atan2(l[1],l[0]);break;case 3:this.factor(t,l,n,c),e[0]=l[0],e[1]=l[1],e[2]=Math.atan2(l[1],l[0]);break;case 4:this.factor(t,l,n,c),e[0]=l[0],e[1]=l[1],e[2]=Math.atan2(l[1],l[0]),d[0]=c[0],d[1]=c[1],d[2]=Math.atan2(c[1],c[0]);break;case 5:var f=new r;f.set(h.assign(p).negate()),f.multLeft(this),f.translate(p),f.get(t,e,n,d)}}}(),factor:function(){var t=new n,e=new n,r=new n,o={values:[],vectors:[[],[]]};return function(n,s,a,u){n.set(this[6],this[7]);var l=this.submatrix,c=l.determinant(),h=c<0?-1:1;if(0===c)throw new Error("Matrix3 .factor: determinant is 0.");r.assign(l).transpose().multLeft(l);var d=i(r,o);u.set(d.vectors[0][0],d.vectors[0][1],d.vectors[1][0],d.vectors[1][1]),a.x=h*Math.sqrt(d.values[0]),a.y=h*Math.sqrt(d.values[1]),t[0]=1/a.x,t[3]=1/a.y,s.assign(e.assign(u).multRight(t).transpose().multLeft(u).multRight(l)),u.transpose()}}(),determinant2:function(){return this[0]*this[4]-this[1]*this[3]},determinant:function(){var t=this[0],e=this[1],n=this[2],i=this[3],r=this[4],o=this[5],s=this[6],a=this[7],u=this[8];return t*(r*u-o*a)-e*(i*u-o*s)+n*(i*a-r*s)},transpose:function(){var t;return t=this[1],this[1]=this[3],this[3]=t,t=this[2],this[2]=this[6],this[6]=t,t=this[5],this[5]=this[7],this[7]=t,this},inverse:function(){var t=this[0],e=this[1],n=this[2],i=this[3],r=this[4],o=this[5],s=this[6],a=this[7],u=this[8],l=t*r,c=t*a,h=i*e,d=i*a,p=s*e,f=s*r,g=l*u-c*o-h*u+d*n+p*o-f*n;if(0===g)throw new Error("Matrix3 .inverse: determinant is 0.");g=1/g;var m=(r*u-a*o)*g,x=-(e*u-a*n)*g,v=(e*o-r*n)*g,_=-(i*u-s*o)*g,y=(t*u-s*n)*g,w=-(t*o-i*n)*g;return this[0]=m,this[1]=x,this[2]=v,this[3]=_,this[4]=y,this[5]=w,this[6]=(d-f)*g,this[7]=-(c-p)*g,this[8]=(l-h)*g,this},multLeft:function(t){var e=this[0],n=this[1],i=this[2],r=this[3],o=this[4],s=this[5],a=this[6],u=this[7],l=this[8],c=t[0],h=t[1],d=t[2],p=t[3],f=t[4],g=t[5],m=t[6],x=t[7],v=t[8];return this[0]=e*c+r*h+a*d,this[1]=n*c+o*h+u*d,this[2]=i*c+s*h+l*d,this[3]=e*p+r*f+a*g,this[4]=n*p+o*f+u*g,this[5]=i*p+s*f+l*g,this[6]=e*m+r*x+a*v,this[7]=n*m+o*x+u*v,this[8]=i*m+s*x+l*v,this},multRight:function(t){var e=this[0],n=this[1],i=this[2],r=this[3],o=this[4],s=this[5],a=this[6],u=this[7],l=this[8],c=t[0],h=t[1],d=t[2],p=t[3],f=t[4],g=t[5],m=t[6],x=t[7],v=t[8];return this[0]=e*c+n*p+i*m,this[1]=e*h+n*f+i*x,this[2]=e*d+n*g+i*v,this[3]=r*c+o*p+s*m,this[4]=r*h+o*f+s*x,this[5]=r*d+o*g+s*v,this[6]=a*c+u*p+l*m,this[7]=a*h+u*f+l*x,this[8]=a*d+u*g+l*v,this},multVecMatrix:function(t){if(2===t.length){var e=t.x,n=t.y,i=e*this[2]+n*this[5]+this[8];return t.x=(e*this[0]+n*this[3]+this[6])/i,t.y=(e*this[1]+n*this[4]+this[7])/i,t}var e=t.x,n=t.y,r=t.z;return t.x=e*this[0]+n*this[3]+r*this[6],t.y=e*this[1]+n*this[4]+r*this[7],t.z=e*this[2]+n*this[5]+r*this[8],t},multMatrixVec:function(t){if(2===t.length){var e=t.x,n=t.y,i=e*this[6]+n*this[7]+this[8];return t.x=(e*this[0]+n*this[1]+this[2])/i,t.y=(e*this[3]+n*this[4]+this[5])/i,t}var e=t.x,n=t.y,r=t.z;return t.x=e*this[0]+n*this[1]+r*this[2],t.y=e*this[3]+n*this[4]+r*this[5],t.z=e*this[6]+n*this[7]+r*this[8],t},multDirMatrix:function(t){var e=t.x,n=t.y;return t.x=e*this[0]+n*this[3],t.y=e*this[1]+n*this[4],t},multMatrixDir:function(t){var e=t.x,n=t.y;return t.x=e*this[0]+n*this[1],t.y=e*this[3]+n*this[4],t},identity:function(){this[0]=1,this[1]=0,this[2]=0,this[3]=0,this[4]=1,this[5]=0,this[6]=0,this[7]=0,this[8]=1},translate:function(t){var e=t.x,n=t.y;return this[6]+=this[0]*e+this[3]*n,this[7]+=this[1]*e+this[4]*n,this},rotate:function(t){return this.multLeft(r.Rotation(t)),this},scale:function(t){var e=t.x,n=t.y;return this[0]*=e,this[3]*=n,this[1]*=e,this[4]*=n,this},toString:function(){return this[0]+" "+this[1]+" "+this[2]+" "+this[3]+" "+this[4]+" "+this[5]+" "+this[6]+" "+this[7]+" "+this[8]}},Object.defineProperty(r.prototype,"x",{get:function(){var t=new e(0,0,0);return function(){return t.set(this[0],this[1],this[2])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"y",{get:function(){var t=new e(0,0,0);return function(){return t.set(this[3],this[4],this[5])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"xAxis",{get:function(){var e=new t(0,0);return function(){return e.set(this[0],this[1])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"yAxis",{get:function(){var e=new t(0,0);return function(){return e.set(this[3],this[4])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"origin",{get:function(){var e=new t(0,0);return function(){return e.set(this[6],this[7])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"submatrix",{get:function(){var t=new n;return function(){return t[0]=this[0],t[1]=this[1],t[2]=this[3],t[3]=this[4],t}}(),enumerable:!1,configurable:!1}),Object.assign(r,{Identity:new r,Rotation:function(t){var e=Math.sin(t),n=Math.cos(t);return new r(n,e,0,-e,n,0,0,0,1)},Matrix2:function(t){return new r(t[0],t[1],0,t[2],t[3],0,0,0,1)},transpose:function(t){var e=Object.create(this.prototype);return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],e},inverse:function(t){var e=Object.create(this.prototype),n=t[0],i=t[1],r=t[2],o=t[3],s=t[4],a=t[5],u=t[6],l=t[7],c=t[8],h=n*s,d=n*l,p=o*i,f=o*l,g=u*i,m=u*s,x=h*c-d*a-p*c+f*r+g*a-m*r;if(0===x)throw new Error("Matrix3 .inverse: determinant is 0.");x=1/x;var v=(s*c-l*a)*x,_=-(i*c-l*r)*x,y=(i*a-s*r)*x,w=-(o*c-u*a)*x,b=(n*c-u*r)*x,S=-(n*a-o*r)*x;return e[0]=v,e[1]=_,e[2]=y,e[3]=w,e[4]=b,e[5]=S,e[6]=(f-m)*x,e[7]=-(d-g)*x,e[8]=(h-p)*x,e},multLeft:function(t,e){var n=Object.create(this.prototype),i=t[0],r=t[1],o=t[2],s=t[3],a=t[4],u=t[5],l=t[6],c=t[7],h=t[8],d=e[0],p=e[1],f=e[2],g=e[3],m=e[4],x=e[5],v=e[6],_=e[7],y=e[8];return n[0]=i*d+s*p+l*f,n[1]=r*d+a*p+c*f,n[2]=o*d+u*p+h*f,n[3]=i*g+s*m+l*x,n[4]=r*g+a*m+c*x,n[5]=o*g+u*m+h*x,n[6]=i*v+s*_+l*y,n[7]=r*v+a*_+c*y,n[8]=o*v+u*_+h*y,n},multRight:function(t,e){var n=Object.create(this.prototype),i=t[0],r=t[1],o=t[2],s=t[3],a=t[4],u=t[5],l=t[6],c=t[7],h=t[8],d=e[0],p=e[1],f=e[2],g=e[3],m=e[4],x=e[5],v=e[6],_=e[7],y=e[8];return n[0]=i*d+r*g+o*v,n[1]=i*p+r*m+o*_,n[2]=i*f+r*x+o*y,n[3]=s*d+a*g+u*v,n[4]=s*p+a*m+u*_,n[5]=s*f+a*x+u*y,n[6]=l*d+c*g+h*v,n[7]=l*p+c*m+h*_,n[8]=l*f+c*x+h*y,n}}),r}),define("x_ite/Fields/SFMatrix3",["x_ite/Basic/X3DField","x_ite/Fields/SFMatrixPrototypeTemplate","x_ite/Fields/SFVec2","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix3"],function(t,e,n,i,r){"use strict";function o(n,i,o){function s(e,n,i,o,s,a,u,l,c){return arguments.length?arguments[0]instanceof r?t.call(this,arguments[0]):t.call(this,new r(1*e,1*n,1*i,1*o,1*s,1*a,1*u,1*l,1*c)):t.call(this,new r)}s.prototype=Object.assign(Object.create(t.prototype),e(r,o),{constructor:s,getTypeName:function(){return n},getType:function(){return i},setTransform:function(t,e,n,i,r){t=t?t.getValue():null,e=e?e:0,n=n?n.getValue():null,i=i?i:0,r=r?r.getValue():null,this.getValue().set(t,e,n,i,r)}});for(var a=0;a<r.prototype.length;++a)!function(t){Object.defineProperty(s.prototype,t,{get:function(){return this.getValue()[t]},set:function(e){this.getValue()[t]=1*e,this.addEvent()},enumerable:!1,configurable:!1})}(a);return s}return{SFMatrix3d:o("SFMatrix3d",i.SFMatrix3d,n.SFVec2d),SFMatrix3f:o("SFMatrix3f",i.SFMatrix3f,n.SFVec2f)}}),define("x_ite/Fields/SFVec3",["x_ite/Basic/X3DField","x_ite/Fields/SFVecPrototypeTemplate","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,n,i){"use strict";function r(n,r){function o(e,n,r){return arguments.length?arguments[0]instanceof i?t.call(this,arguments[0]):t.call(this,new i(1*e,1*n,1*r)):t.call(this,new i(0,0,0))}o.prototype=Object.assign(Object.create(t.prototype),e(i),{constructor:o,getTypeName:function(){return n},getType:function(){return r},cross:function(t){
return new this.constructor(i.cross(this.getValue(),t.getValue()))}});var s={get:function(){return this.getValue().x},set:function(t){this.getValue().x=1*t,this.addEvent()},enumerable:!0,configurable:!1},a={get:function(){return this.getValue().y},set:function(t){this.getValue().y=1*t,this.addEvent()},enumerable:!0,configurable:!1},u={get:function(){return this.getValue().z},set:function(t){this.getValue().z=1*t,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(o.prototype,"x",s),Object.defineProperty(o.prototype,"y",a),Object.defineProperty(o.prototype,"z",u),s.enumerable=!1,a.enumerable=!1,u.enumerable=!1,Object.defineProperty(o.prototype,"0",s),Object.defineProperty(o.prototype,"1",a),Object.defineProperty(o.prototype,"2",u),o}return{SFVec3d:r("SFVec3d",n.SFVec3d),SFVec3f:r("SFVec3f",n.SFVec3f)}}),define("standard/Math/Numbers/Vector4",["standard/Math/Algorithm"],function(t){"use strict";function e(t,e,n,i){this.x=t,this.y=e,this.z=n,this.w=i}return e.prototype={constructor:e,length:4,copy:function(){var t=Object.create(e.prototype);return t.x=this.x,t.y=this.y,t.z=this.z,t.w=this.w,t},assign:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},set:function(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this},multiply:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},multVec:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this},divide:function(t){return this.x/=t,this.y/=t,this.z/=t,this.w/=t,this},divVec:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this},normalize:function(){var t=this.x,e=this.y,n=this.z,i=this.w,r=Math.sqrt(t*t+e*e+n*n+i*i);return r&&(this.x=t/r,this.y=e/r,this.z=n/r,this.w=i/r),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},norm:function(){var t=this.x,e=this.y,n=this.z,i=this.w;return t*t+e*e+n*n+i*i},abs:function(){var t=this.x,e=this.y,n=this.z,i=this.w;return Math.sqrt(t*t+e*e+n*n+i*i)},distance:function(t){var e=this.x-t.x,n=this.y-t.y,i=this.z-t.z,r=this.w-t.w;return Math.sqrt(e*e+n*n+i*i+r*r)},lerp:function(t,e){var n=this.x,i=this.y,r=this.z,o=this.w;return this.x=n+e*(t.x-n),this.y=i+e*(t.y-i),this.z=r+e*(t.z-r),this.w=o+e*(t.w-o),this},min:function(t){for(var e=this.x,n=this.y,i=this.z,r=this.w,o=0,s=arguments.length;o<s;++o){var t=arguments[o];e=Math.min(e,t.x),n=Math.min(n,t.y),i=Math.min(i,t.z),r=Math.min(r,t.w)}return this.x=e,this.y=n,this.z=i,this.w=r,this},max:function(t){for(var e=this.x,n=this.y,i=this.z,r=this.w,o=0,s=arguments.length;o<s;++o){var t=arguments[o];e=Math.max(e,t.x),n=Math.max(n,t.y),i=Math.max(i,t.z),r=Math.max(r,t.w)}return this.x=e,this.y=n,this.z=i,this.w=r,this},toString:function(){return this.x+" "+this.y+" "+this.z+" "+this.w}},Object.defineProperty(e.prototype,"0",{get:function(){return this.x},set:function(t){this.x=t},enumerable:!1,configurable:!1}),Object.defineProperty(e.prototype,"1",{get:function(){return this.y},set:function(t){this.y=t},enumerable:!1,configurable:!1}),Object.defineProperty(e.prototype,"2",{get:function(){return this.z},set:function(t){this.z=t},enumerable:!1,configurable:!1}),Object.defineProperty(e.prototype,"3",{get:function(){return this.w},set:function(t){this.w=t},enumerable:!1,configurable:!1}),Object.assign(e,{Zero:new e(0,0,0,0),One:new e(1,1,1,1),xAxis:new e(1,0,0,0),yAxis:new e(0,1,0,0),zAxis:new e(0,0,1,0),wAxis:new e(0,0,0,1),negate:function(t){var e=Object.create(this.prototype);return e.x=-t.x,e.y=-t.y,e.z=-t.z,e.w=-t.w,e},add:function(t,e){var n=Object.create(this.prototype);return n.x=t.x+e.x,n.y=t.y+e.y,n.z=t.z+e.z,n.w=t.w+e.w,n},subtract:function(t,e){var n=Object.create(this.prototype);return n.x=t.x-e.x,n.y=t.y-e.y,n.z=t.z-e.z,n.w=t.w-e.w,n},multiply:function(t,e){var n=Object.create(this.prototype);return n.x=t.x*e,n.y=t.y*e,n.z=t.z*e,n.w=t.w*e,n},multVec:function(t,e){var n=Object.create(this.prototype);return n.x=t.x*e.x,n.y=t.y*e.y,n.z=t.z*e.z,n.w=t.w*e.w,n},divide:function(t,e){var n=Object.create(this.prototype);return n.x=t.x/e,n.y=t.y/e,n.z=t.z/e,n.w=t.w/e,n},divVec:function(t,e){var n=Object.create(this.prototype);return n.x=t.x/e.x,n.y=t.y/e.y,n.z=t.z/e.z,n.w=t.w/e.w,n},normalize:function(t){var e=Object.create(this.prototype),n=t.x,i=t.y,r=t.z,o=t.w,s=Math.sqrt(n*n+i*i+r*r+o*o);return s?(e.x=n/s,e.y=i/s,e.z=r/s,e.w=o/s):(e.x=0,e.y=0,e.z=0,e.w=0),e},dot:function(t,e){return t.dot(e)},lerp:function(t,n,i){var r=t.x,o=t.y,s=t.z,a=t.w;return new e(r+i*(n.x-r),o+i*(n.y-o),s+i*(n.z-s),a+i*(n.w-a))},min:function(t,n){for(var i=t.x,r=t.y,o=t.z,s=t.w,a=1,u=arguments.length;a<u;++a){var l=arguments[a];i=Math.min(i,l.x),r=Math.min(r,l.y),o=Math.min(o,l.z),s=Math.min(s,l.w)}return new e(i,r,o,s)},max:function(t,n){for(var i=t.x,r=t.y,o=t.z,s=t.w,a=1,u=arguments.length;a<u;++a){var l=arguments[a];i=Math.max(i,l.x),r=Math.max(r,l.y),o=Math.max(o,l.z),s=Math.max(s,l.w)}return new e(i,r,o,s)}}),e}),define("standard/Math/Numbers/Quaternion",["standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(t,n){"use strict";function i(t,e,n,i){this.x=t,this.y=e,this.z=n,this.w=i}i.prototype={constructor:i,length:4,copy:function(){var t=Object.create(i.prototype);return t.x=this.x,t.y=this.y,t.z=this.z,t.w=this.w,t},assign:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},set:function(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this},setMatrix:function(t){var e;e=t[0]>t[4]?t[0]>t[8]?0:2:t[4]>t[8]?1:2;var n=t[0]+t[4]+t[8];if(n>t[3*e+e]){this[3]=Math.sqrt(n+1)/2;var i=4*this[3];this[0]=(t[5]-t[7])/i,this[1]=(t[6]-t[2])/i,this[2]=(t[1]-t[3])/i}else{var r=(e+1)%3,o=(e+2)%3;this[e]=Math.sqrt(t[3*e+e]-t[3*r+r]-t[3*o+o]+1)/2;var i=4*this[e];this[r]=(t[3*e+r]+t[3*r+e])/i,this[o]=(t[3*e+o]+t[3*o+e])/i,this[3]=(t[3*r+o]-t[3*o+r])/i}return this},getMatrix:function(t){var e=this.x,n=this.y,i=this.z,r=this.w,o=e*e,s=e*n,a=n*n,u=n*i,l=i*e,c=i*i,h=r*e,d=r*n,p=r*i;return t[0]=1-2*(a+c),t[1]=2*(s+p),t[2]=2*(l-d),t[3]=2*(s-p),t[4]=1-2*(c+o),t[5]=2*(u+h),t[6]=2*(l+d),t[7]=2*(u-h),t[8]=1-2*(a+o),t},isReal:function(){return!(this.x||this.y||this.z)},isImag:function(){return!this.w},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},inverse:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this},multiply:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},multLeft:function(t){var e=this.x,n=this.y,i=this.z,r=this.w,o=t.x,s=t.y,a=t.z,u=t.w;return this.x=r*o+e*u+n*a-i*s,this.y=r*s+n*u+i*o-e*a,this.z=r*a+i*u+e*s-n*o,this.w=r*u-e*o-n*s-i*a,this},multRight:function(t){var e=this.x,n=this.y,i=this.z,r=this.w,o=t.x,s=t.y,a=t.z,u=t.w;return this.x=u*e+o*r+s*i-a*n,this.y=u*n+s*r+a*e-o*i,this.z=u*i+a*r+o*n-s*e,this.w=u*r-o*e-s*n-a*i,this},divide:function(t){return this.x/=t,this.y/=t,this.z/=t,this.w/=t,this},multVecQuat:function(t){var e=this.x,n=this.y,i=this.z,r=this.w,o=t.x,s=t.y,a=t.z,u=r*r-e*e-n*n-i*i,l=2*(o*e+s*n+a*i),c=2*r;return t.x=u*o+l*e+c*(n*a-i*s),t.y=u*s+l*n+c*(i*o-e*a),t.z=u*a+l*i+c*(e*s-n*o),t},multQuatVec:function(t){var e=this.x,n=this.y,i=this.z,r=this.w,o=t.x,s=t.y,a=t.z,u=r*r-e*e-n*n-i*i,l=2*(o*e+s*n+a*i),c=2*r;return t.x=u*o+l*e-c*(n*a-i*s),t.y=u*s+l*n-c*(i*o-e*a),t.z=u*a+l*i-c*(e*s-n*o),t},normalize:function(){var t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return t&&(t=1/t,this.x*=t,this.y*=t,this.z*=t,this.w*=t),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},norm:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},abs:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},pow:function(t){if(t instanceof i)return this.assign(e.assign(t).multRight(this.log()).exp());if(this.isReal())return this.set(0,0,0,Math.pow(this.w,t));var n=this.abs(),r=Math.acos(this.w/n),o=this.imag.abs(),s=Math.pow(n,t),a=t*r,u=s/o*Math.sin(a);return this.x*=u,this.y*=u,this.z*=u,this.w=s*Math.cos(a),this},log:function(){if(this.isReal())return this.w>0?this.set(0,0,0,Math.log(this.w)):this.set(Math.PI,0,0,Math.log(-this.w));var t=this.abs(),e=this.imag.normalize().multiply(Math.acos(this.w/t)),n=Math.log(t);return this.x=e.x,this.y=e.y,this.z=e.z,this.w=n,this},exp:function(){if(this.isReal())return this.set(0,0,0,Math.exp(this.w));var t=this.imag,e=t.abs(),n=Math.exp(this.w),i=n*Math.cos(e),r=t.multiply(n*Math.sin(e)/e);return this.x=r.x,this.y=r.y,this.z=r.z,this.w=i,this},slerp:function(t,e){return n.slerp(this,r.assign(t),e)},squad:function(t,e,i,a){return n.slerp(n.slerp(this,r.assign(i),a),n.slerp(o.assign(t),s.assign(e),a),2*a*(1-a))},toString:function(){return this.x+" "+this.y+" "+this.z+" "+this.w}},Object.defineProperty(i.prototype,"0",{get:function(){return this.x},set:function(t){this.x=t},enumerable:!1,configurable:!1}),Object.defineProperty(i.prototype,"1",{get:function(){return this.y},set:function(t){this.y=t},enumerable:!1,configurable:!1}),Object.defineProperty(i.prototype,"2",{get:function(){return this.z},set:function(t){this.z=t},enumerable:!1,configurable:!1}),Object.defineProperty(i.prototype,"3",{get:function(){return this.w},set:function(t){this.w=t},enumerable:!1,configurable:!1}),Object.defineProperty(i.prototype,"real",{get:function(){return this.w},enumerable:!1,configurable:!1}),Object.defineProperty(i.prototype,"imag",{get:function(){var e=new t(0,0,0);return function(){return e.set(this.x,this.y,this.z)}}(),enumerable:!1,configurable:!1}),Object.assign(i,{negate:function(t){var e=Object.create(this.prototype);return e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=-this.w,e},inverse:function(t){var e=Object.create(this.prototype);return e.x=-t.x,e.y=-t.y,e.z=-t.z,e.w=t.w,e},add:function(t,e){var n=Object.create(this.prototype);return n.x=t.x+e.x,n.y=t.y+e.y,n.z=t.z+e.z,n.w=t.w+e.w,n},subtract:function(t,e){var n=Object.create(this.prototype);return n.x=t.x-e.x,n.y=t.y-e.y,n.z=t.z-e.z,n.w=t.w-e.w,n},multiply:function(t,e){var n=Object.create(this.prototype);return n.x=t.x*e,n.y=t.y*e,n.z=t.z*e,n.w=t.w*e,n},multLeft:function(t,e){var n=Object.create(this.prototype),i=t.x,r=t.y,o=t.z,s=t.w,a=e.x,u=e.y,l=e.z,c=e.w;return n.x=s*a+i*c+r*l-o*u,n.y=s*u+r*c+o*a-i*l,n.z=s*l+o*c+i*u-r*a,n.w=s*c-i*a-r*u-o*l,n},multRight:function(t,e){var n=Object.create(this.prototype),i=t.x,r=t.y,o=t.z,s=t.w,a=e.x,u=e.y,l=e.z,c=e.w;return n.x=c*i+a*s+u*o-l*r,n.y=c*r+u*s+l*i-a*o,n.z=c*o+l*s+a*r-u*i,n.w=c*s-a*i-u*r-l*o,n},divide:function(t,e){var n=Object.create(this.prototype);return n.x=t.x/e,n.y=t.y/e,n.z=t.z/e,n.w=t.w/e,n},normalize:function(t){var e=Object.create(this.prototype),n=t.x,i=t.y,r=t.z,o=t.w,s=Math.sqrt(n*n+i*i+r*r+o*o);return s?(s=1/s,e.x=n*s,e.y=i*s,e.z=r*s,e.w=o*s):(e.x=0,e.y=0,e.z=0,e.w=0),e},slerp:function(t,e,i){return n.slerp(t.copy(),o.assign(e),i)},squad:function(t,e,i,a,u){return n.slerp(n.slerp(t.copy(),r.assign(a),u),n.slerp(o.assign(e),s.assign(i),u),2*u*(1-u))},spline:function(t,e,n){return a.assign(t),u.assign(e),l.assign(n),a.dot(u)<0&&a.negate(),l.dot(u)<0&&l.negate(),c.assign(u).inverse(),u.multRight(r.assign(c).multRight(a).log().add(o.assign(c).multRight(l).log()).divide(-4).exp()).normalize().copy()}});var r=new i(0,0,0,1),o=new i(0,0,0,1),s=new i(0,0,0,1),a=new i(0,0,0,1),u=new i(0,0,0,1),l=new i(0,0,0,1),c=new i(0,0,0,1);return i}),define("standard/Math/Numbers/Rotation4",["standard/Math/Numbers/Quaternion","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Algorithm"],function(t,e,n,i){"use strict";function r(n,i,r,o){switch(this.x_=0,this.y_=0,this.z_=1,this.angle_=0,arguments.length){case 0:return void(this.value=new t(0,0,0,1));case 1:return this.value=arguments[0],void this.update();case 2:var s=arguments[0],a=arguments[1];return this.value=new t(0,0,0,1),a instanceof e?this.setFromToVec(s,a):void this.set(s.x,s.y,s.z,a);case 4:return this.value=new t(0,0,0,1),void this.set(n,i,r,o)}}r.prototype={constructor:r,length:4,update:function(){var t=this.get();return this.x_=t.x,this.y_=t.y,this.z_=t.z,this.angle_=t.w,this},copy:function(){var t=Object.create(r.prototype);return t.x_=this.x_,t.y_=this.y_,t.z_=this.z_,t.angle_=this.angle_,t.value=this.value.copy(),t},assign:function(t){return this.x_=t.x_,this.y_=t.y_,this.z_=t.z_,this.angle_=t.angle_,this.value.assign(t.value),this},set:function(t,e,n,r){this.x_=t,this.y_=e,this.z_=n,this.angle_=r;var o=Math.sqrt(t*t+e*e+n*n);if(0===o)return this.value.set(0,0,0,1),this;var s=i.interval(r/2,0,Math.PI),o=Math.sin(s)/o;return this.value.set(t*o,e*o,n*o,Math.cos(s)),this},get:function(){var t=new n(0,0,0,0);return function(){var e=this.value;if(Math.abs(e.w>1))return n.zAxis;var i=2*Math.acos(e.w),r=Math.sin(i/2);if(0===r)return n.zAxis;var o=e.imag.divide(r);return t.set(o.x,o.y,o.z,i)}}(),setAxisAngle:function(t,e){return this.set(t.x,t.y,t.z,e)},setFromToVec:function(){var t=new e(0,0,0),n=new e(0,0,0),r=new e(0,0,0),o=new e(0,0,0);return function(s,a){t.assign(s).normalize(),n.assign(a).normalize();var u=i.clamp(t.dot(n),-1,1),l=r.assign(t).cross(n).normalize();return 0===l.abs()?u>0?this.value.set(0,0,0,1):(o.assign(t).cross(e.xAxis),0===o.norm()&&o.assign(t).cross(e.yAxis),o.normalize(),this.value.set(o.x,o.y,o.z,0)):(l.multiply(Math.sqrt(Math.abs(1-u)/2)),this.value.set(l.x,l.y,l.z,Math.sqrt(Math.abs(1+u)/2))),this.update(),this}}(),setAxis:function(t){this.set(t.x,t.y,t.z,this.angle_)},getAxis:function(){var t=new e(0,0,0);return function(){return t.set(this.x_,this.y_,this.z_)}}(),setMatrix:function(t){return this.value.setMatrix(t).normalize(),this.update(),this},getMatrix:function(t){return this.value.getMatrix(t)},equals:function(t){return this.value.equals(t.value)},inverse:function(){return this.value.inverse(),this.update(),this},multLeft:function(t){return this.value.multLeft(t.value).normalize(),this.update(),this},multRight:function(t){return this.value.multRight(t.value).normalize(),this.update(),this},multVecRot:function(t){return this.value.multVecQuat(t)},multRotVec:function(t){return this.value.multQuatVec(t)},normalize:function(){return this.value.normalize(),this.update(),this},pow:function(t){return this.value.pow(t),this.update(),this},slerp:function(t,e){return this.value.slerp(t.value,e),this.update(),this},squad:function(t,e,n,i){return this.value.squad(t.value,e.value,n.value,i),this.update(),this},toString:function(){return this.x_+" "+this.y_+" "+this.z_+" "+this.angle_}};var o={get:function(){return this.x_},set:function(t){this.x_=t,this.set(t,this.y_,this.z_,this.angle_)},enumerable:!0,configurable:!1},s={get:function(){return this.y_},set:function(t){this.y_=t,this.set(this.x_,t,this.z_,this.angle_)},enumerable:!0,configurable:!1},a={get:function(){return this.z_},set:function(t){this.z_=t,this.set(this.x_,this.y_,t,this.angle_)},enumerable:!0,configurable:!1},u={get:function(){return this.angle_},set:function(t){this.angle_=t,this.set(this.x_,this.y_,this.z_,t)},enumerable:!0,configurable:!1};return Object.defineProperty(r.prototype,"x",o),Object.defineProperty(r.prototype,"y",s),Object.defineProperty(r.prototype,"z",a),Object.defineProperty(r.prototype,"angle",u),o.enumerable=!1,s.enumerable=!1,a.enumerable=!1,u.enumerable=!1,Object.defineProperty(r.prototype,"0",o),Object.defineProperty(r.prototype,"1",s),Object.defineProperty(r.prototype,"2",a),Object.defineProperty(r.prototype,"3",u),Object.assign(r,{Identity:new r,inverse:function(e){var n=Object.create(this.prototype);return n.value=t.inverse(e.value),n.update(),n},multRight:function(e,n){var i=Object.create(this.prototype);return i.value=t.multRight(e.value,n.value),i.update(),i},normalize:function(){var t=Object.create(this.prototype);return t.value=rotation.value.copy(),t.update(),t},slerp:function(e,n,i){var r=Object.create(this.prototype);return r.value=t.slerp(e.value,n.value,i),r.update(),r},squad:function(e,n,i,r,o){var s=Object.create(this.prototype);return s.value=t.squad(e.value,n,i,r.value,o),s.update(),s},bezier:function(e,n,i,r,o){var s=Object.create(this.prototype);return s.value=t.bezier(e.value,n,i,r.value,o),s.update(),s},spline:function(e,n,i){var r=Object.create(this.prototype);return r.value=t.spline(e.value,n.value,i.value),r.update(),r}}),r}),define("standard/Math/Numbers/Matrix4",["standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix3","standard/Math/Algorithms/eigendecomposition"],function(t,e,n,i,r){"use strict";function o(){arguments.length?(this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3],this[4]=arguments[4],this[5]=arguments[5],this[6]=arguments[6],this[7]=arguments[7],this[8]=arguments[8],this[9]=arguments[9],this[10]=arguments[10],this[11]=arguments[11],this[12]=arguments[12],this[13]=arguments[13],this[14]=arguments[14],this[15]=arguments[15]):this.identity()}o.prototype={constructor:o,order:4,length:16,copy:function(){var t=Object.create(o.prototype);return t[0]=this[0],t[1]=this[1],t[2]=this[2],t[3]=this[3],t[4]=this[4],t[5]=this[5],t[6]=this[6],t[7]=this[7],t[8]=this[8],t[9]=this[9],t[10]=this[10],t[11]=this[11],t[12]=this[12],t[13]=this[13],t[14]=this[14],t[15]=this[15],t},assign:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this},equals:function(t){return this[0]===t[0]&&this[1]===t[1]&&this[2]===t[2]&&this[3]===t[3]&&this[4]===t[4]&&this[5]===t[5]&&this[6]===t[6]&&this[7]===t[7]&&this[8]===t[8]&&this[9]===t[9]&&this[10]===t[10]&&this[11]===t[11]&&this[12]===t[12]&&this[13]===t[13]&&this[14]===t[14]&&this[15]===t[15]},set1:function(t,e,n){return this[t*this.order+e]=n,this},get1:function(t,e){return this[t*this.order+e]},set:function(e,i,r,o,s){switch(arguments.length){case 0:this.identity();break;case 1:null===e&&(e=t.Zero),this.identity(),this.translate(e);break;case 2:null===e&&(e=t.Zero),null===i&&(i=n.Identity),this.identity(),this.translate(e),i.equals(n.Identity)||this.rotate(i);break;case 3:null===e&&(e=t.Zero),null===i&&(i=n.Identity),null===r&&(r=t.One),this.identity(),this.translate(e),i.equals(n.Identity)||this.rotate(i),r.equals(t.One)||this.scale(r);break;case 4:if(null===e&&(e=t.Zero),null===i&&(i=n.Identity),null===r&&(r=t.One),null===o&&(o=n.Identity),this.identity(),this.translate(e),i.equals(n.Identity)||this.rotate(i),!r.equals(t.One)){!o.equals(n.Identity)?(this.rotate(o),this.scale(r),this.rotate(n.inverse(o))):this.scale(r)}break;case 5:null===e&&(e=t.Zero),null===i&&(i=n.Identity),null===r&&(r=t.One),null===o&&(o=n.Identity),null===s&&(s=t.Zero),this.identity(),this.translate(e);var a=!s.equals(t.Zero);a&&this.translate(s),i.equals(n.Identity)||this.rotate(i),r.equals(t.One)||(o.equals(n.Identity)?this.scale(r):(this.rotate(o),this.scale(r),this.rotate(n.inverse(o)))),a&&this.translate(t.negate(s));break;case 16:this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3],this[4]=arguments[4],this[5]=arguments[5],this[6]=arguments[6],this[7]=arguments[7],this[8]=arguments[8],this[9]=arguments[9],this[10]=arguments[10],this[11]=arguments[11],this[12]=arguments[12],this[13]=arguments[13],this[14]=arguments[14],this[15]=arguments[15]}return this},get:function(){var e=new t(0,0,0),r=new n,s=new t(0,0,0),a=new n,u=new t(0,0,0),l=new i,c=new i,h=new t(0,0,0);return function(t,n,i,d,p){switch(null===t&&(t=e),null===n&&(n=r),null===i&&(i=s),null===d&&(d=a),null===p&&(p=u),arguments.length){case 1:t.set(this[12],this[13],this[14]);break;case 2:this.factor(t,l,s,c),n.setMatrix(l);break;case 3:this.factor(t,l,i,c),n.setMatrix(l);break;case 4:this.factor(t,l,i,c),n.setMatrix(l),d.setMatrix(c);break;case 5:var f=new o;f.set(h.assign(p).negate()),f.multLeft(this),f.translate(p),f.get(t,n,i,d)}}}(),setRotation:function(t){return this.setQuaternion(t.value)},setQuaternion:function(t){var e=t.x,n=t.y,i=t.z,r=t.w,o=n*n,s=i*i,a=e*n,u=i*r,l=i*e,c=n*r,h=e*e,d=n*i,p=e*r;return this[0]=1-2*(o+s),this[1]=2*(a+u),this[2]=2*(l-c),this[3]=0,this[4]=2*(a-u),this[5]=1-2*(s+h),this[6]=2*(d+p),this[7]=0,this[8]=2*(l+c),this[9]=2*(d-p),this[10]=1-2*(o+h),this[11]=0,this[12]=0,this[13]=0,this[14]=0,this[15]=1,this},factor:function(){var t=new i,e=new i,n=new i,o={values:[],vectors:[[],[],[]]};return function(i,s,a,u){i.set(this[12],this[13],this[14]);var l=this.submatrix,c=l.determinant(),h=c<0?-1:1;if(0===c)throw new Error("Matrix4 .factor: determinant is 0.");n.assign(l).transpose().multLeft(l);var d=r(n,o);return u.set(d.vectors[0][0],d.vectors[0][1],d.vectors[0][2],d.vectors[1][0],d.vectors[1][1],d.vectors[1][2],d.vectors[2][0],d.vectors[2][1],d.vectors[2][2]),a.x=h*Math.sqrt(d.values[0]),a.y=h*Math.sqrt(d.values[1]),a.z=h*Math.sqrt(d.values[2]),t[0]=1/a.x,t[4]=1/a.y,t[8]=1/a.z,s.assign(e.assign(u).multRight(t).transpose().multLeft(u).multRight(l)),u.transpose(),!0}}(),determinant3:function(){var t=this[0],e=this[1],n=this[2],i=this[4],r=this[5],o=this[6],s=this[8],a=this[9],u=this[10];return t*(r*u-o*a)-e*(i*u-o*s)+n*(i*a-r*s)},determinant:function(){var t=this[0],e=this[1],n=this[2],i=this[3],r=this[4],o=this[5],s=this[6],a=this[7],u=this[8],l=this[9],c=this[10],h=this[11],d=this[12],p=this[13],f=this[14],g=this[15],m=c*g,x=f*h,v=s*g,_=f*a,y=s*h,w=c*a,b=n*g,S=f*i,C=n*h,T=c*i,F=n*a,O=s*i;return t*(m*o+_*l+y*p-x*o-v*l-w*p)+r*(x*e+b*l+T*p-m*e-S*l-C*p)+u*(v*e+S*o+F*p-_*e-b*o-O*p)+d*(w*e+C*o+O*l-y*e-T*o-F*l)},transpose:function(){var t;return t=this[1],this[1]=this[4],this[1]=t,t=this[2],this[2]=this[8],this[2]=t,t=this[3],this[3]=this[12],this[3]=t,t=this[6],this[6]=this[9],this[6]=t,t=this[7],this[7]=this[13],this[7]=t,t=this[11],this[11]=this[14],this[11]=t,this},inverse:function(){var t=this[0],e=this[1],n=this[2],i=this[3],r=this[4],o=this[5],s=this[6],a=this[7],u=this[8],l=this[9],c=this[10],h=this[11],d=this[12],p=this[13],f=this[14],g=this[15],m=c*g,x=f*h,v=s*g,_=f*a,y=s*h,w=c*a,b=n*g,S=f*i,C=n*h,T=c*i,F=n*a,O=s*i,N=u*p,E=d*l,M=r*p,D=d*o,V=r*l,I=u*o,B=t*p,L=d*e,A=t*l,P=u*e,R=t*o,k=r*e,U=m*o+_*l+y*p-(x*o+v*l+w*p),z=x*e+b*l+T*p-(m*e+S*l+C*p),X=v*e+S*o+F*p-(_*e+b*o+O*p),j=w*e+C*o+O*l-(y*e+T*o+F*l),G=t*U+r*z+u*X+d*j;if(0===G)throw new Error("Matrix4 .inverse: determinant is 0.");return G=1/G,this[0]=G*U,this[1]=G*z,this[2]=G*X,this[3]=G*j,this[4]=G*(x*r+v*u+w*d-m*r-_*u-y*d),this[5]=G*(m*t+S*u+C*d-x*t-b*u-T*d),this[6]=G*(_*t+b*r+O*d-v*t-S*r-F*d),this[7]=G*(y*t+T*r+F*u-w*t-C*r-O*u),this[8]=G*(N*a+D*h+V*g-E*a-M*h-I*g),this[9]=G*(E*i+B*h+P*g-N*i-L*h-A*g),this[10]=G*(M*i+L*a+R*g-D*i-B*a-k*g),this[11]=G*(I*i+A*a+k*h-V*i-P*a-R*h),this[12]=G*(M*c+I*f+E*s-V*f-N*s-D*c),this[13]=G*(A*f+N*n+L*c-B*c-P*f-E*n),this[14]=G*(B*s+k*f+D*n-R*f-M*n-L*s),this[15]=G*(R*c+V*n+P*s-A*s-k*c-I*n),this},multLeft:function(t){var e=this[0],n=this[1],i=this[2],r=this[3],o=this[4],s=this[5],a=this[6],u=this[7],l=this[8],c=this[9],h=this[10],d=this[11],p=this[12],f=this[13],g=this[14],m=this[15],x=t[0],v=t[1],_=t[2],y=t[3],w=t[4],b=t[5],S=t[6],C=t[7],T=t[8],F=t[9],O=t[10],N=t[11],E=t[12],M=t[13],D=t[14],V=t[15];return this[0]=e*x+o*v+l*_+p*y,this[1]=n*x+s*v+c*_+f*y,this[2]=i*x+a*v+h*_+g*y,this[3]=r*x+u*v+d*_+m*y,this[4]=e*w+o*b+l*S+p*C,this[5]=n*w+s*b+c*S+f*C,this[6]=i*w+a*b+h*S+g*C,this[7]=r*w+u*b+d*S+m*C,this[8]=e*T+o*F+l*O+p*N,this[9]=n*T+s*F+c*O+f*N,this[10]=i*T+a*F+h*O+g*N,this[11]=r*T+u*F+d*O+m*N,this[12]=e*E+o*M+l*D+p*V,this[13]=n*E+s*M+c*D+f*V,this[14]=i*E+a*M+h*D+g*V,this[15]=r*E+u*M+d*D+m*V,this},multRight:function(t){var e=this[0],n=this[1],i=this[2],r=this[3],o=this[4],s=this[5],a=this[6],u=this[7],l=this[8],c=this[9],h=this[10],d=this[11],p=this[12],f=this[13],g=this[14],m=this[15],x=t[0],v=t[1],_=t[2],y=t[3],w=t[4],b=t[5],S=t[6],C=t[7],T=t[8],F=t[9],O=t[10],N=t[11],E=t[12],M=t[13],D=t[14],V=t[15];return this[0]=e*x+n*w+i*T+r*E,this[1]=e*v+n*b+i*F+r*M,this[2]=e*_+n*S+i*O+r*D,this[3]=e*y+n*C+i*N+r*V,this[4]=o*x+s*w+a*T+u*E,this[5]=o*v+s*b+a*F+u*M,this[6]=o*_+s*S+a*O+u*D,this[7]=o*y+s*C+a*N+u*V,this[8]=l*x+c*w+h*T+d*E,this[9]=l*v+c*b+h*F+d*M,this[10]=l*_+c*S+h*O+d*D,this[11]=l*y+c*C+h*N+d*V,this[12]=p*x+f*w+g*T+m*E,this[13]=p*v+f*b+g*F+m*M,this[14]=p*_+f*S+g*O+m*D,this[15]=p*y+f*C+g*N+m*V,this},multVecMatrix:function(t){if(3===t.length){var e=t.x,n=t.y,i=t.z,r=1/(e*this[3]+n*this[7]+i*this[11]+this[15]);return t.x=(e*this[0]+n*this[4]+i*this[8]+this[12])*r,t.y=(e*this[1]+n*this[5]+i*this[9]+this[13])*r,t.z=(e*this[2]+n*this[6]+i*this[10]+this[14])*r,t}var e=t.x,n=t.y,i=t.z,r=t.w;return t.x=e*this[0]+n*this[4]+i*this[8]+r*this[12],t.y=e*this[1]+n*this[5]+i*this[9]+r*this[13],t.z=e*this[2]+n*this[6]+i*this[10]+r*this[14],t.w=e*this[3]+n*this[7]+i*this[11]+r*this[15],t},multMatrixVec:function(t){if(3===t.length){var e=t.x,n=t.y,i=t.z,r=1/(e*this[12]+n*this[13]+i*this[14]+this[15]);return t.x=(e*this[0]+n*this[1]+i*this[2]+this[3])*r,t.y=(e*this[4]+n*this[5]+i*this[6]+this[7])*r,t.z=(e*this[8]+n*this[9]+i*this[10]+this[11])*r,t}var e=t.x,n=t.y,i=t.z,r=t.w;return t.x=e*this[0]+n*this[1]+i*this[2]+r*this[3],t.y=e*this[4]+n*this[5]+i*this[6]+r*this[7],t.z=e*this[8]+n*this[9]+i*this[10]+r*this[11],t.w=e*this[12]+n*this[13]+i*this[14]+r*this[15],t},multDirMatrix:function(t){var e=t.x,n=t.y,i=t.z;return t.x=e*this[0]+n*this[4]+i*this[8],t.y=e*this[1]+n*this[5]+i*this[9],t.z=e*this[2]+n*this[6]+i*this[10],t},multMatrixDir:function(t){var e=t.x,n=t.y,i=t.z;return t.x=e*this[0]+n*this[1]+i*this[2],t.y=e*this[4]+n*this[5]+i*this[6],t.z=e*this[8]+n*this[9]+i*this[10],t},identity:function(){this[0]=1,this[1]=0,this[2]=0,this[3]=0,this[4]=0,this[5]=1,this[6]=0,this[7]=0,this[8]=0,this[9]=0,this[10]=1,this[11]=0,this[12]=0,this[13]=0,this[14]=0,this[15]=1},translate:function(t){var e=t.x,n=t.y,i=t.z;return this[12]+=this[0]*e+this[4]*n+this[8]*i,this[13]+=this[1]*e+this[5]*n+this[9]*i,this[14]+=this[2]*e+this[6]*n+this[10]*i,this},rotate:function(t){return this.multLeft(s.setQuaternion(t.value)),this},scale:function(t){var e=t.x,n=t.y,i=t.z;return this[0]*=e,this[4]*=n,this[8]*=i,this[1]*=e,this[5]*=n,this[9]*=i,this[2]*=e,this[6]*=n,this[10]*=i,this},getDepth:function(t){var e=t.x,n=t.y,i=t.z,r=1/(e*this[3]+n*this[7]+i*this[11]+this[15]);return(e*this[2]+n*this[6]+i*this[10]+this[14])*r},toString:function(){return this[0]+" "+this[1]+" "+this[2]+" "+this[3]+" "+this[4]+" "+this[5]+" "+this[6]+" "+this[7]+" "+this[8]+" "+this[9]+" "+this[10]+" "+this[11]+" "+this[12]+" "+this[13]+" "+this[14]+" "+this[15]}},Object.defineProperty(o.prototype,"x",{get:function(){var t=new e(0,0,0,0);return function(){return t.set(this[0],this[1],this[2],this[3])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(o.prototype,"y",{get:function(){var t=new e(0,0,0,0);return function(){return t.set(this[4],this[5],this[6],this[7])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(o.prototype,"z",{get:function(){var t=new e(0,0,0,0);return function(){return t.set(this[8],this[9],this[10],this[11])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(o.prototype,"xAxis",{get:function(){var e=new t(0,0,0);return function(){return e.set(this[0],this[1],this[2])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(o.prototype,"yAxis",{get:function(){var e=new t(0,0,0);return function(){return e.set(this[4],this[5],this[6])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(o.prototype,"zAxis",{get:function(){var e=new t(0,0,0);return function(){return e.set(this[8],this[9],this[10])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(o.prototype,"origin",{get:function(){var e=new t(0,0,0);return function(){return e.set(this[12],this[13],this[14])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(o.prototype,"submatrix",{get:function(){var t=new i;return function(){return t[0]=this[0],t[1]=this[1],t[2]=this[2],t[3]=this[4],t[4]=this[5],t[5]=this[6],t[6]=this[8],t[7]=this[9],t[8]=this[10],t}}(),enumerable:!1,configurable:!1}),Object.assign(o,{Identity:new o,Rotation:function(t){return Object.create(this.prototype).setQuaternion(t.value)},Quaternion:function(t){return Object.create(this.prototype).setQuaternion(t)},Matrix3:function(t){return new o(t[0],t[1],t[2],0,t[3],t[4],t[5],0,t[6],t[7],t[8],0,0,0,0,1)},transpose:function(t){var e=Object.create(this.prototype);return e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15],e},inverse:function(t){var e=Object.create(this.prototype),n=t[0],i=t[1],r=t[2],o=t[3],s=t[4],a=t[5],u=t[6],l=t[7],c=t[8],h=t[9],d=t[10],p=t[11],f=t[12],g=t[13],m=t[14],x=t[15],v=d*x,_=m*p,y=u*x,w=m*l,b=u*p,S=d*l,C=r*x,T=m*o,F=r*p,O=d*o,N=r*l,E=u*o,M=c*g,D=f*h,V=s*g,I=f*a,B=s*h,L=c*a,A=n*g,P=f*i,R=n*h,k=c*i,U=n*a,z=s*i,X=v*a+w*h+b*g-(_*a+y*h+S*g),j=_*i+C*h+O*g-(v*i+T*h+F*g),G=y*i+T*a+N*g-(w*i+C*a+E*g),H=S*i+F*a+E*h-(b*i+O*a+N*h),q=n*X+s*j+c*G+f*H;if(0==q)throw new Error("Matrix4 .inverse: determinant is 0.");return q=1/q,e[0]=q*X,e[1]=q*j,e[2]=q*G,e[3]=q*H,e[4]=q*(_*s+y*c+S*f-v*s-w*c-b*f),e[5]=q*(v*n+T*c+F*f-_*n-C*c-O*f),e[6]=q*(w*n+C*s+E*f-y*n-T*s-N*f),e[7]=q*(b*n+O*s+N*c-S*n-F*s-E*c),e[8]=q*(M*l+I*p+B*x-D*l-V*p-L*x),e[9]=q*(D*o+A*p+k*x-M*o-P*p-R*x),e[10]=q*(V*o+P*l+U*x-I*o-A*l-z*x),e[11]=q*(L*o+R*l+z*p-B*o-k*l-U*p),e[12]=q*(V*d+L*m+D*u-B*m-M*u-I*d),e[13]=q*(R*m+M*r+P*d-A*d-k*m-D*r),e[14]=q*(A*u+z*m+I*r-U*m-V*r-P*u),e[15]=q*(U*d+B*r+k*u-R*u-z*d-L*r),e},multLeft:function(t,e){var n=Object.create(this.prototype),i=t[0],r=t[1],o=t[2],s=t[3],a=t[4],u=t[5],l=t[6],c=t[7],h=t[8],d=t[9],p=t[10],f=t[11],g=t[12],m=t[13],x=t[14],v=t[15],_=e[0],y=e[1],w=e[2],b=e[3],S=e[4],C=e[5],T=e[6],F=e[7],O=e[8],N=e[9],E=e[10],M=e[11],D=e[12],V=e[13],I=e[14],B=e[15];return n[0]=i*_+a*y+h*w+g*b,n[1]=r*_+u*y+d*w+m*b,n[2]=o*_+l*y+p*w+x*b,n[3]=s*_+c*y+f*w+v*b,n[4]=i*S+a*C+h*T+g*F,n[5]=r*S+u*C+d*T+m*F,n[6]=o*S+l*C+p*T+x*F,n[7]=s*S+c*C+f*T+v*F,n[8]=i*O+a*N+h*E+g*M,n[9]=r*O+u*N+d*E+m*M,n[10]=o*O+l*N+p*E+x*M,n[11]=s*O+c*N+f*E+v*M,n[12]=i*D+a*V+h*I+g*B,n[13]=r*D+u*V+d*I+m*B,n[14]=o*D+l*V+p*I+x*B,n[15]=s*D+c*V+f*I+v*B,n},multRight:function(t,e){var n=Object.create(this.prototype),i=t[0],r=t[1],o=t[2],s=t[3],a=t[4],u=t[5],l=t[6],c=t[7],h=t[8],d=t[9],p=t[10],f=t[11],g=t[12],m=t[13],x=t[14],v=t[15],_=e[0],y=e[1],w=e[2],b=e[3],S=e[4],C=e[5],T=e[6],F=e[7],O=e[8],N=e[9],E=e[10],M=e[11],D=e[12],V=e[13],I=e[14],B=e[15];return n[0]=i*_+r*S+o*O+s*D,n[1]=i*y+r*C+o*N+s*V,n[2]=i*w+r*T+o*E+s*I,n[3]=i*b+r*F+o*M+s*B,n[4]=a*_+u*S+l*O+c*D,n[5]=a*y+u*C+l*N+c*V,n[6]=a*w+u*T+l*E+c*I,n[7]=a*b+u*F+l*M+c*B,n[8]=h*_+d*S+p*O+f*D,n[9]=h*y+d*C+p*N+f*V,n[10]=h*w+d*T+p*E+f*I,n[11]=h*b+d*F+p*M+f*B,n[12]=g*_+m*S+x*O+v*D,n[13]=g*y+m*C+x*N+v*V,n[14]=g*w+m*T+x*E+v*I,n[15]=g*b+m*F+x*M+v*B,n}});var s=new o;return o}),define("x_ite/Fields/SFMatrix4",["x_ite/Basic/X3DField","x_ite/Fields/SFMatrixPrototypeTemplate","x_ite/Fields/SFVec3","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4"],function(t,e,n,i,r){"use strict";function o(n,i,o){function s(e,n,i,o,s,a,u,l,c,h,d,p,f,g,m,x){return arguments.length?arguments[0]instanceof r?t.call(this,arguments[0]):t.call(this,new r(1*e,1*n,1*i,1*o,1*s,1*a,1*u,1*l,1*c,1*h,1*d,1*p,1*f,1*g,1*m,1*x)):t.call(this,new r)}s.prototype=Object.assign(Object.create(t.prototype),e(r,o),{constructor:s,getTypeName:function(){return n},getType:function(){return i}});for(var a=0;a<r.prototype.length;++a)!function(t){Object.defineProperty(s.prototype,t,{get:function(){return this.getValue()[t]},
set:function(e){this.getValue()[t]=e,this.addEvent()},enumerable:!1,configurable:!1})}(a);return s}return{SFMatrix4d:o("SFMatrix4d",i.SFMatrix4d,n.SFVec3d),SFMatrix4f:o("SFMatrix4f",i.SFMatrix4f,n.SFVec3f),VrmlMatrix:o("VrmlMatrix",i.VrmlMatrix,n.SFVec3f)}}),define("x_ite/Fields/SFNodeCache",["x_ite/Fields/SFNode","x_ite/Fields/SFNode"],function(){"use strict";function t(){}var e=new WeakMap;return t.prototype={add:function(t,n){var i=require("x_ite/Fields/SFNode"),n=n?i.call(n,t):new i(t);return e.set(t,n),n},get:function(t){var n=e.get(t);return n?n:(n=new(require("x_ite/Fields/SFNode"))(t),e.set(t,n),n)}},new t}),define("x_ite/Fields/SFNode",["x_ite/Basic/X3DField","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator","x_ite/Fields/SFNodeCache"],function(t,e,n,i){"use strict";function r(e){return e?(e.addParent(this),t.call(this,e)):t.call(this,null),new Proxy(this,o)}var o={get:function(t,n){try{var i=t[n];if(void 0!==i)return i;var r=t.getValue().getField(n);if(r.getAccessType()===e.inputOnly)return;return r.valueOf()}catch(t){return}},set:function(t,n,i){if(n in t)return t[n]=i,!0;try{var r=t.getValue().getField(n);return r.getAccessType()!==e.outputOnly&&r.setValue(i),!0}catch(e){return console.error(t,n,e),!1}},has:function(t,e){try{return Boolean(t.getValue().getField(e))}catch(n){return e in t}},enumerate:function(t){if(!t.getValue())return[][Symbol.iterator]();for(var e=[],n=t.getValue().getFieldDefinitions(),i=0,r=n.length;i<r;++i)array.push(n[i].name);return e[Symbol.iterator]()}};return r.prototype=Object.assign(Object.create(t.prototype),{constructor:r,_cloneCount:0,clone:function(){return new r(this.getValue())},copy:function(t){var e=this.getValue();return e?new r(e.copy(t)):new r},getTypeName:function(){return"SFNode"},getType:function(){return e.SFNode},equals:function(t){return t?this.getValue()===t.getValue():null===this.getValue()},isDefaultValue:function(){return null===this.getValue()},set:function(e){var n=this.getValue();n&&(n.removeClones(this._cloneCount),n.removeParent(this)),e?(e.addParent(this),e.addClones(this._cloneCount),t.prototype.set.call(this,e)):t.prototype.set.call(this,null)},getNodeTypeName:function(){var t=this.getValue();if(t)return t.getTypeName();throw new Error("SFNode.getNodeTypeName: node is null.")},getNodeName:function(){var t=this.getValue();if(t)return t.getName();throw new Error("SFNode.getNodeName: node is null.")},getNodeType:function(){var t=this.getValue();if(t)return t.getType().slice();throw new Error("SFNode.getNodeType: node is null.")},getFieldDefinitions:function(){var t=this.getValue();if(t)return t.getFieldDefinitions();throw new Error("SFNode.getFieldDefinitions: node is null.")},addFieldCallback:function(e,n,i){switch(arguments.length){case 2:return t.prototype.addFieldCallback.apply(this,arguments);case 3:var r=this.getValue();if(r)return r.getField(e).addFieldCallback(n,i);throw new Error("SFNode.addFieldCallback: node is null.")}},removeFieldCallback:function(e,n){switch(arguments.length){case 1:return t.prototype.removeFieldCallback.apply(this,arguments);case 2:var i=this.getValue();if(i)return i.getField(e).removeFieldCallback(n);throw new Error("SFNode.removeFieldCallback: node is null.")}},addClones:function(t){var e=this.getValue();this._cloneCount+=t,e&&e.addClones(t)},removeClones:function(t){var e=this.getValue();this._cloneCount-=t,e&&e.removeClones(t)},valueOf:function(){var t=this.getValue();return t?i.get(t):null},toStream:function(t){var e=this.getValue();e?e.toStream(t):t.string+="NULL"},toVRMLStream:function(t){var e=this.getValue();e?e.toVRMLStream(t):t.string+="NULL"},toXMLString:function(){var t={string:""},e=n.Get(t),i=this.getValue();return e.PushExecutionContext(i.getExecutionContext()),this.toXMLStream(t),e.PopExecutionContext(),t.string},toXMLStream:function(t){var e=this.getValue();e?e.toXMLStream(t):t.string+="NULL"},dispose:function(){this.set(null),t.prototype.dispose.call(this)}}),r}),define("x_ite/Fields/SFRotation",["x_ite/Fields/SFVec3","x_ite/Basic/X3DField","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator","standard/Math/Numbers/Rotation4"],function(t,e,n,i,r){"use strict";function o(t,n,i,o){switch(arguments.length){case 1:return e.call(this,arguments[0]);case 2:return arguments[1]instanceof s?e.call(this,new r(arguments[0].getValue(),arguments[1].getValue())):e.call(this,new r(arguments[0].getValue(),1*arguments[1]));case 4:return e.call(this,new r(1*t,1*n,1*i,1*o));default:return e.call(this,new r)}}var s=t.SFVec3f;o.prototype=Object.assign(Object.create(e.prototype),{constructor:o,copy:function(){return new o(this.getValue().copy())},equals:function(t){return this.getValue().equals(t.getValue())},isDefaultValue:function(){return this.getValue().equals(r.Identity)},getTypeName:function(){return"SFRotation"},getType:function(){return n.SFRotation},set:function(t){this.getValue().assign(t)},setAxis:function(t){this.getValue().setAxis(t.getValue()),this.addEvent()},getAxis:function(){return new s(this.getValue().getAxis().copy())},inverse:function(){return new o(r.inverse(this.getValue()))},multiply:function(t){return new o(r.multRight(this.getValue(),t.getValue()))},multVec:function(t){return new s(this.getValue().multVecRot(t.getValue().copy()))},slerp:function(t,e){return new o(r.slerp(this.getValue(),t.getValue(),e))},toStream:function(t){var e=i.Get(t),n=this.getValue();t.string+=n.x+" "+n.y+" "+n.z+" "+e.ToUnit("angle",n.angle)},toVRMLStream:function(t){this.toStream(t)},toXMLStream:function(t){this.toStream(t)}});var a={get:function(){return this.getValue().x},set:function(t){this.getValue().x=1*t,this.addEvent()},enumerable:!0,configurable:!1},u={get:function(){return this.getValue().y},set:function(t){this.getValue().y=1*t,this.addEvent()},enumerable:!0,configurable:!1},l={get:function(){return this.getValue().z},set:function(t){this.getValue().z=1*t,this.addEvent()},enumerable:!0,configurable:!1},c={get:function(){return this.getValue().angle},set:function(t){this.getValue().angle=1*t,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(o.prototype,"x",a),Object.defineProperty(o.prototype,"y",u),Object.defineProperty(o.prototype,"z",l),Object.defineProperty(o.prototype,"angle",c),a.enumerable=!1,u.enumerable=!1,l.enumerable=!1,c.enumerable=!1,Object.defineProperty(o.prototype,"0",a),Object.defineProperty(o.prototype,"1",u),Object.defineProperty(o.prototype,"2",l),Object.defineProperty(o.prototype,"3",c),o}),define("x_ite/Fields/SFString",["x_ite/Basic/X3DField","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(t,e,n){"use strict";function i(e){return t.call(this,arguments.length?""+e:"")}return Object.assign(i,{unescape:function(t){return t.replace(/\\([\\"])/g,"$1")},escape:function(t){return t.replace(/([\\"])/g,"\\$1")}}),i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,copy:function(){return new i(this.getValue())},getTypeName:function(){return"SFString"},getType:function(){return e.SFString},isDefaultValue:function(){return""===this.getValue()},set:function(e){t.prototype.set.call(this,""+e)},valueOf:t.prototype.getValue,toStream:function(t){t.string+='"'+i.escape(this.getValue())+'"'},toVRMLStream:function(t){this.toStream(t)},toXMLStream:function(t){t.string+=n.Get(t).XMLEncode(this.getValue())}}),Object.defineProperty(i.prototype,"length",{get:function(){return this.getValue().length},enumerable:!0,configurable:!1}),i}),define("x_ite/Fields/SFTime",["x_ite/Basic/X3DField","x_ite/Bits/X3DConstants"],function(t,e){"use strict";function n(e){return t.call(this,arguments.length?1*e:0)}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,copy:function(){return new n(this.getValue())},getTypeName:function(){return"SFTime"},getType:function(){return e.SFTime},isDefaultValue:function(){return 0===this.getValue()},set:function(e){t.prototype.set.call(this,1*e)},valueOf:t.prototype.getValue,toStream:function(t){t.string+=String(this.getValue())},toVRMLStream:function(t){this.toStream(t)},toXMLStream:function(t){this.toStream(t)}}),n}),define("x_ite/Fields/SFVec4",["x_ite/Basic/X3DField","x_ite/Fields/SFVecPrototypeTemplate","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector4"],function(t,e,n,i){"use strict";function r(n,r){function o(e,n,r,o){return arguments.length?arguments[0]instanceof i?t.call(this,arguments[0]):t.call(this,new i(1*e,1*n,1*r,1*o)):t.call(this,new i(0,0,0,0))}o.prototype=Object.assign(Object.create(t.prototype),e(i),{constructor:o,getTypeName:function(){return n},getType:function(){return r}});var s={get:function(){return this.getValue().x},set:function(t){this.getValue().x=1*t,this.addEvent()},enumerable:!0,configurable:!1},a={get:function(){return this.getValue().y},set:function(t){this.getValue().y=1*t,this.addEvent()},enumerable:!0,configurable:!1},u={get:function(){return this.getValue().z},set:function(t){this.getValue().z=1*t,this.addEvent()},enumerable:!0,configurable:!1},l={get:function(){return this.getValue().w},set:function(t){this.getValue().w=1*t,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(o.prototype,"x",s),Object.defineProperty(o.prototype,"y",a),Object.defineProperty(o.prototype,"z",u),Object.defineProperty(o.prototype,"w",l),s.enumerable=!1,a.enumerable=!1,u.enumerable=!1,l.enumerable=!1,Object.defineProperty(o.prototype,"0",s),Object.defineProperty(o.prototype,"1",a),Object.defineProperty(o.prototype,"2",u),Object.defineProperty(o.prototype,"3",l),o}return{SFVec4d:r("SFVec4d",n.SFVec4d),SFVec4f:r("SFVec4f",n.SFVec4f)}}),define("x_ite/Basic/X3DObjectArrayField",["jquery","x_ite/Basic/X3DField","x_ite/Basic/X3DArrayField","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(t,e,n,i,r){"use strict";function o(t){return n.call(this,[]),this._target=this,t[0]instanceof Array&&(t=t[0]),o.prototype.push.apply(this,t),new Proxy(this,s)}var s={get:function(t,e){try{var n=1*e;if(Number.isInteger(n)){var i=t.getValue();return n>=i.length&&t.resize(n+1),i[n].valueOf()}return t[e]}catch(n){if("symbol"==typeof e)return;console.log(t,typeof e,e,n)}},set:function(t,e,n){try{if(e in t)return t[e]=n,!0;var i=t.getValue(),r=parseInt(e);return r>=i.length&&t.resize(r+1),i[r].setValue(n),!0}catch(n){return console.log(t,e,n),!1}},has:function(t,e){return Number.isInteger(+e)?e<t.getValue().length:e in t},enumerate:function(t){for(var e=[],n=t.getValue(),i=0,r=n.length;i<r;++i)n.push(i);return e[Symbol.iterator]()}};return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,getTarget:function(){return this._target},copy:function(){var t=this._target,e=new t.constructor,n=t.getValue();return o.prototype.push.apply(e,n),e},equals:function(t){var e=this._target,n=e.getValue(),i=t.getValue(),r=n.length;if(n===i)return!0;if(r!==i.length)return!1;for(var o=0;o<r;++o)if(!n[o].equals(i[o]))return!1;return!0},set:function(t){var n=this._target;n.resize(t.length,void 0,!0);for(var i=n.getValue(),r=0,o=t.length;r<o;++r)i[r].set(t[r]instanceof e?t[r].getValue():t[r])},isDefaultValue:function(){return 0===this.length},setValue:function(t){var e=this._target;e.set(t instanceof o?t.getValue():t),e.addEvent()},unshift:function(t){for(var e=this._target,n=e.getValue(),i=arguments.length-1;i>=0;--i){var r=new(e.getSingleType());r.setValue(arguments[i]),e.addChildObject(r),n.unshift(r)}return e.addEvent(),n.length},shift:function(){var t=this._target,e=t.getValue();if(e.length){var n=e.shift();return t.removeChildObject(n),t.addEvent(),n.valueOf()}},push:function(t){for(var e=this._target,n=e.getValue(),i=0,r=arguments.length;i<r;++i){var o=new(e.getSingleType());o.setValue(arguments[i]),e.addChildObject(o),n.push(o)}return e.addEvent(),n.length},pop:function(){var t=this._target,e=t.getValue();if(e.length){var n=e.pop();return t.removeChildObject(n),t.addEvent(),n.valueOf()}},splice:function(t,e){var n=this._target,i=n.getValue();t>i.length&&(t=i.length),t+e>i.length&&(e=i.length-t);var r=n.erase(t,t+e);return arguments.length>2&&n.insert(t,arguments,2,arguments.length),r},insert:function(t,e,n,i){for(var r=this._target,o=[t,0],s=n;s<i;++s){var a=new(r.getSingleType());a.setValue(e[s]),r.addChildObject(a),o.push(a)}Array.prototype.splice.apply(r.getValue(),o),r.addEvent()},find:function(e,n,i){var r=this._target;if(t.isFunction(i)){for(var o=r.getValue(),s=e;s<n;++s)if(i(o[s].valueOf()))return s;return n}for(var o=r.getValue(),s=e;s<n;++s)if(o[s].equals(i))return s;return n},remove:function(e,n,i){var r=this._target;if(t.isFunction(i)){var o=r.getValue();if((e=r.find(e,n,i))!==n)for(var s=e;++s<n;){var a=o[s];if(!i(a.valueOf())){var u=o[e];o[e++]=a,o[s]=u}}return e!==n&&r.addEvent(),e}var o=r.getValue();if((e=r.find(e,n,i))!==n)for(var s=e;++s<n;){var a=o[s];if(!a.equals(i)){var u=o[e];o[e++]=a,o[s]=u}}return e!==n&&r.addEvent(),e},erase:function(t,e){for(var n=this._target,i=n.getValue().splice(t,e-t),r=0,o=i.length;r<o;++r)n.removeChildObject(i[r]);return n.addEvent(),new n.constructor(i)},resize:function(t,e,n){var i=this._target,r=i.getValue();if(t<r.length){for(var o=t,s=r.length;o<s;++o)i.removeChildObject(r[o]);r.length=t,n||i.addEvent()}else if(t>r.length){for(var o=r.length;o<t;++o){var a=new(i.getSingleType());void 0!==e&&a.setValue(e),i.addChildObject(a),r.push(a)}n||i.addEvent()}},addChildObject:function(t){t.addParent(this._target)},removeChildObject:function(t){t.removeParent(this._target)},toStream:function(t){var e=this._target,n=e.getValue(),i=r.Get(t);switch(n.length){case 0:t.string+="[ ]";break;case 1:i.PushUnitCategory(e.getUnit()),n[0].toStream(t),i.PopUnitCategory();break;default:i.PushUnitCategory(e.getUnit()),t.string+="[\n",i.IncIndent();for(var o=0,s=n.length-1;o<s;++o)t.string+=i.Indent(),n[o].toStream(t),t.string+=",\n";t.string+=i.Indent(),n[s].toStream(t),t.string+="\n",i.DecIndent(),t.string+=i.Indent(),t.string+="]",i.PopUnitCategory()}},toVRMLStream:function(t){this.toStream(t)},toXMLStream:function(t){var e=this._target,n=e.length;if(n){var i=r.Get(t),o=e.getValue();i.PushUnitCategory(e.getUnit());for(var s=0,a=n-1;s<a;++s)o[s].toXMLStream(t),t.string+=", ";o[a].toXMLStream(t),i.PopUnitCategory()}},dispose:function(){for(var t=this._target,e=t.getValue(),i=0,r=t.length;i<r;++i)t.removeChildObject(e[i]);e.length=0,n.prototype.dispose.call(t)}}),Object.defineProperty(o.prototype,"length",{get:function(){return this._target.getValue().length},set:function(t){this._target.resize(t)},enumerable:!1,configurable:!1}),o}),define("x_ite/Basic/X3DTypedArrayField",["x_ite/Basic/X3DArrayField","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator","standard/Math/Algorithm"],function(t,e,n,i){"use strict";function r(e){return t.call(this,new(this.getArrayType())(2)),this._target=this,this._tmp=[],e[0]instanceof Array&&(e=e[0]),r.prototype.push.apply(this,e),new Proxy(this,a)}function o(t,e,n,i){for(var r=t.getValue(),o=t._tmp,s=0;s<i;++s,++e)o[s]=r[e];return n.set.apply(n,o),n}function s(t,e,n,i){for(var r=t.getValue(),o=0;o<i;++o,++e)r[e]=n[o];t.addEvent()}var a={get:function(t,e){try{var n=1*e;if(Number.isInteger(n)){var i=t.getValue(),r=t.getComponents(),a=t.getValueType();if(n>=t._length&&(i=t.resize(n+1)),1===r)return a(i[n]);var u=new a,l=u.getValue(),c=n*r;return u.addEvent=function(){return s(t,c,l,r)},u.getValue=function(){return o(t,c,l,r)},u}return t[e]}catch(n){if("symbol"==typeof e)return;console.log(t,typeof e,e,n)}},set:function(t,e,n){try{if(e in t)return t[e]=n,!0;var i=parseInt(e),r=t.getValue(),o=t.getComponents();if(i>=t._length&&(r=t.resize(i+1)),1===o)r[i]=n;else{i*=o;for(var s=0;s<o;++s,++i)r[i]=n[s]}return t.addEvent(),!0}catch(n){return console.log(t,e,n),!1}},has:function(t,e){return Number.isInteger(+e)?e<t._length:e in t},enumerate:function(t){for(var e=[],n=0,i=t._length;n<i;++n)array.push(n);return e[Symbol.iterator]()}};return r.prototype=Object.assign(Object.create(t.prototype),{constructor:r,_length:0,getTarget:function(){return this._target},copy:function(){var e=this._target,n=e.getValue(),i=new e.constructor,r=new(e.getArrayType())(n);return i._length=e._length,t.prototype.set.call(i,r,e._length),i},equals:function(t){if(this===t)return!0;var e=this._target,n=e._length;if(n!==t._length)return!1;for(var i=e.getValue(),r=t.getValue(),o=0,s=n*e.getComponents();o<s;++o)if(i[o]!==r[o])return!1;return!0},assign:function(t){var e=this._target;e.set(t.getValue(),t.length),e.addEvent()},set:function(t,e){var n=this._target,i=n.getComponents(),r=n.getValue(),o=n._length,s=void 0!==e?e*i:t.length,a=s%i;a&&(s-=a,console.warn("Array length must be multiple of components size, which is "+i+".")),s/=i,r.length<t.length?(r=n.grow(t.length),r.set(t),a&&r.fill(0,s*i,s*i+a)):(r.set(t),s<o&&r.fill(0,s*i,o*i)),n._length=s},isDefaultValue:function(){return 0===this._length},setValue:function(t){var e=this._target;t instanceof e.constructor?e.assign(t):(e.set(t),e.addEvent())},unshift:function(t){var e=this._target,n=e.getComponents(),i=e._length,r=arguments.length,o=e.grow((i+r)*n);if(o.copyWithin(r*n,0,i*n),1===n)o.set(arguments,0);else for(var s=0,a=0;a<r;++a)for(var u=arguments[a],l=0;l<n;++l,++s)o[s]=u[l];return e._length+=r,e.addEvent(),o.length},shift:function(){var t=this._target,e=t._length;if(e){var n=t.getValue(),i=t.getComponents(),r=t.getValueType(),o=e-1;if(1===i)var s=r(n[0]);else{for(var a=t._tmp,u=0;u<i;++u)a[u]=n[u];var s=Object.create(r.prototype);r.apply(s,a)}return n.copyWithin(0,i,e*i),n.fill(0,i*o,e*i),t._length=o,t.addEvent(),s}},push:function(t){var e=this._target,n=e.getComponents(),i=e._length,r=arguments.length,o=e.grow((i+r)*n);if(1===n)o.set(arguments,i);else for(var s=i*n,a=0;a<r;++a)for(var u=arguments[a],l=0;l<n;++l,++s)o[s]=u[l];return e._length+=r,e.addEvent(),e._length},pop:function(){var t=this._target,e=t._length;if(e){var n=t.getValue(),i=t.getComponents(),r=t.getValueType(),o=e-1;if(1===i)var s=r(n[e-1]);else{for(var a=t._tmp,u=0,l=o*i;u<i;++u,++l)a[u]=n[l];var s=Object.create(r.prototype);r.apply(s,a)}return n.fill(0,o*i,e*i),t._length=o,t.addEvent(),s}},splice:function(t,e){var n=this._target,i=n._length;t>i&&(t=i),t+e>i&&(e=i-t);var r=n.erase(t,t+e);return arguments.length>2&&n.spliceInsert(t,Array.prototype.splice.call(arguments,2)),n.addEvent(),r},spliceInsert:function(t,e){var n=this._target,i=n.getComponents(),r=n._length,o=e.length;t*=i;var s=n.grow((r+o)*i);if(s.copyWithin(t+o*i,t,r*i),1===i)s.set(e,t);else for(var a=0,u=t;a<o;++a)for(var l=e[a],c=0;c<i;++c,++u)s[u]=l[c];n._length+=o},insert:function(t,e,n,i){var r=this._target,o=r._length,s=e.getValue(),a=r.getComponents(),u=i-n;t*=a,n*=a,i*=a;var l=r.grow((o+u)*a);for(l.copyWithin(t+u*a,t,o*a);n<i;++t,++n)l[t]=s[n];r._length+=u,r.addEvent()},erase:function(t,e){var n=this._target,i=n.getValue(),r=n.getComponents(),o=e-t,s=n._length,a=s-o,u=new n.constructor;t*=r,e*=r;for(var l=u.grow(o*r),c=0,h=t;h<e;++c,++h)l[c]=i[h];return i.copyWithin(t,e,s*r),i.fill(0,a*r,s*r),n._length=a,u._length=o,n.addEvent(),u},resize:function(t,e,n){var i=this._target,r=i._length,o=i.getValue(),s=i.getComponents();if(t<r)o.fill(0,t*s,r*s),n||i.addEvent();else if(t>r){if(o=i.grow(t*s),void 0!==e)if(1===s)o.fill(e,r*s,t*s);else for(var a=r*s,u=t*s;a<u;)for(var l=0;l<s;++l,++a)o[a]=e[l];n||i.addEvent()}return i._length=t,o},grow:function(e){var n=this._target,r=n.getValue();if(e<r.length)return r;var o=i.nextPowerOfTwo(e),s=new(n.getArrayType())(o);return s.set(r),t.prototype.set.call(n,s),s},shrinkToFit:function(){var e=this._target,n=e.getValue(),i=e._length*e.getComponents();if(n.length==i)return n;var r=n.subarray(0,i);return t.prototype.set.call(e,r),r},toStream:function(t){var e=this._target,i=n.Get(t),r=e.getValue(),o=e._length,s=e.getComponents(),a=new(e.getSingleType());switch(o){case 0:t.string+="[ ]";break;case 1:if(i.PushUnitCategory(e.getUnit()),1===s)a.set(r[0]),a.toStream(t);else{for(var u=0,l=0;u<s;++u,++l)a[u]=r[l];a.toStream(t)}i.PopUnitCategory();break;default:if(i.PushUnitCategory(e.getUnit()),t.string+="[\n",i.IncIndent(),1===s){for(var c=0,h=o-1;c<h;++c)t.string+=i.Indent(),a.set(r[c*s]),a.toStream(t),t.string+=",\n";t.string+=i.Indent(),a.set(r[h*s]),a.toStream(t),t.string+="\n"}else{for(var c=0,h=o-1;c<h;++c){t.string+=i.Indent();for(var u=0,l=c*s;u<s;++u,++l)a[u]=r[l];a.toStream(t),t.string+=",\n"}t.string+=i.Indent();for(var u=0,l=h*s;u<s;++u,++l)a[u]=r[l];a.toStream(t),t.string+="\n"}i.DecIndent(),t.string+=i.Indent(),t.string+="]",i.PopUnitCategory()}},toVRMLStream:function(t){this.toStream(t)},toXMLStream:function(t){var e=this._target,i=e._length;if(i){var r=n.Get(t),o=e.getValue(),s=e.getComponents(),a=new(e.getSingleType());if(r.PushUnitCategory(e.getUnit()),1===s){for(var u=0,l=i-1;u<l;++u)a.set(o[u*s]),a.toXMLStream(t),t.string+=", ";a.set(o[l*s]),a.toXMLStream(t)}else{for(var u=0,l=i-1;u<l;++u){for(var c=0,h=u*s;c<s;++c,++h)a[c]=o[h];a.toXMLStream(t),t.string+=", "}for(var c=0,h=l*s;c<s;++c,++h)a[c]=o[h];a.toXMLStream(t)}r.PopUnitCategory()}},dispose:function(){t.prototype.dispose.call(this._target)}}),Object.defineProperty(r.prototype,"length",{get:function(){return this._length},set:function(t){this._target.resize(t)},enumerable:!1,configurable:!1}),r}),define("x_ite/Fields/ArrayFields",["x_ite/Fields/SFBool","x_ite/Fields/SFColor","x_ite/Fields/SFColorRGBA","x_ite/Fields/SFDouble","x_ite/Fields/SFFloat","x_ite/Fields/SFImage","x_ite/Fields/SFInt32","x_ite/Fields/SFMatrix3","x_ite/Fields/SFMatrix4","x_ite/Fields/SFNode","x_ite/Fields/SFRotation","x_ite/Fields/SFString","x_ite/Fields/SFTime","x_ite/Fields/SFVec2","x_ite/Fields/SFVec3","x_ite/Fields/SFVec4","x_ite/Basic/X3DObjectArrayField","x_ite/Basic/X3DTypedArrayField","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(t,e,n,i,r,o,s,a,u,l,c,h,d,p,f,g,m,x,v,_){"use strict";function y(t){return m.call(this,arguments)}function w(t){return m.call(this,arguments)}function b(t,e,n,i,r,o){function s(t){return x.call(this,arguments)}return s.prototype=Object.assign(Object.create(x.prototype),{constructor:s,getSingleType:function(){return n},getValueType:function(){return i},getArrayType:function(){return r},getComponents:function(){return o},getTypeName:function(){return t},getType:function(){return e}}),s}function S(t){return t}var C=a.SFMatrix3d,T=a.SFMatrix3f,F=u.SFMatrix4d,O=u.SFMatrix4f,N=p.SFVec2d,E=p.SFVec2f,M=f.SFVec3d,D=f.SFVec3f,V=g.SFVec4d,I=g.SFVec4f;y.prototype=Object.assign(Object.create(m.prototype),{constructor:y,_cloneCount:0,getSingleType:function(){return l},getValueType:function(){return l},getArrayType:function(){return Array},getComponents:function(){return 1},getTypeName:function(){return"MFNode"},getType:function(){return v.MFNode},clone:function(){var t=new y;return t.setValue(this),t},copy:function(t){for(var e=new y,n=this.getValue(),i=0,r=n.length;i<r;++i)e.push(n[i].copy(t));return e},addClones:function(t){var e=this.getValue();this._cloneCount+=t;for(var n=0,i=e.length;n<i;++n)e[n].addClones(t)},removeClones:function(t){var e=this.getValue();this._cloneCount+=t;for(var n=0,i=e.length;n<i;++n)e[n].removeClones(t)},addChildObject:function(t){m.prototype.addChildObject.call(this,t),t.addClones(this._cloneCount)},removeChildObject:function(t){m.prototype.removeChildObject.call(this,t),t.removeClones(this._cloneCount)},toStream:function(t){var e=this._target,n=e.getValue(),i=_.Get(t);switch(n.length){case 0:t.string+="[ ]";break;case 1:i.PushUnitCategory(e.getUnit()),n[0].toStream(t),i.PopUnitCategory();break;default:i.PushUnitCategory(e.getUnit()),t.string+="[\n",i.IncIndent();for(var r=0,o=n.length-1;r<o;++r)t.string+=i.Indent(),n[r].toStream(t),t.string+="\n";t.string+=i.Indent(),n[o].toStream(t),t.string+="\n",i.DecIndent(),t.string+=i.Indent(),t.string+="]",i.PopUnitCategory()}},toVRMLStream:function(t){var e=this._target,n=e.getValue(),i=_.Get(t);switch(n.length){case 0:t.string+="[ ]";break;case 1:i.EnterScope(),n[0].toVRMLStream(t),i.LeaveScope();break;default:i.EnterScope(),t.string+="[\n",i.IncIndent();for(var r=0,o=n.length-1;r<o;++r)t.string+=i.Indent(),n[r].toVRMLStream(t),t.string+="\n";t.string+=i.Indent(),n[o].toVRMLStream(t),t.string+="\n",i.DecIndent(),t.string+=i.Indent(),t.string+="]",i.LeaveScope()}},toXMLStream:function(t){var e=_.Get(t),n=this.length;if(n){e.EnterScope();for(var i=this.getValue(),r=0,o=n-1;r<o;++r){var s=i[r].getValue();s?(s.toXMLStream(t),t.string+="\n"):(t.string+=e.Indent(),t.string+="<!-- NULL -->\n")}var s=i[o].getValue();s?s.toXMLStream(t):(t.string+=e.Indent(),t.string+="<!-- NULL -->"),e.LeaveScope()}}}),w.prototype=Object.assign(Object.create(m.prototype),{constructor:w,getValueType:function(){return String},getSingleType:function(){return h},getArrayType:function(){return Array},getComponents:function(){return 1},getTypeName:function(){return"MFString"},getType:function(){return v.MFString},toXMLStream:function(t){var e=this.length;if(e){for(var n=this.getValue(),i=0,r=e-1;i<r;++i)t.string+='"',n[i].toXMLStream(t),t.string+='"',t.string+=", ";t.string+='"',n[r].toXMLStream(t),t.string+='"'}}});var B={MFBool:b("MFBool",v.MFBool,t,Boolean,Uint8Array,1),MFColor:b("MFColor",v.MFColor,e,e,Float32Array,3),MFColorRGBA:b("MFColorRGBA",v.MFColorRGBA,n,n,Float32Array,4),MFDouble:b("MFDouble",v.MFDouble,i,S,Float64Array,1),MFFloat:b("MFFloat",v.MFFloat,r,S,Float32Array,1),MFImage:function(t,e,n,i,r,o){function s(t){return m.call(this,arguments)}return s.prototype=Object.assign(Object.create(m.prototype),{constructor:s,getSingleType:function(){return n},getValueType:function(){return i},getArrayType:function(){return r},getComponents:function(){return o},getTypeName:function(){return t},getType:function(){return e}}),s}("MFImage",v.MFImage,o,o,Array,1),MFInt32:b("MFInt32",v.MFInt32,s,S,Int32Array,1),MFMatrix3d:b("MFMatrix3d",v.MFMatrix3d,C,C,Float64Array,9),MFMatrix3f:b("MFMatrix3f",v.MFMatrix3f,T,T,Float32Array,9),MFMatrix4d:b("MFMatrix4d",v.MFMatrix4d,F,F,Float64Array,16),MFMatrix4f:b("MFMatrix4f",v.MFMatrix4f,O,O,Float32Array,16),MFNode:y,MFRotation:b("MFRotation",v.MFRotation,c,c,Float64Array,4),MFString:w,MFTime:b("MFTime",v.MFTime,d,S,Float64Array,1),MFVec2d:b("MFVec2d",v.MFVec2d,N,N,Float64Array,2),MFVec2f:b("MFVec2f",v.MFVec2f,E,E,Float32Array,2),MFVec3d:b("MFVec3d",v.MFVec3d,M,M,Float64Array,3),MFVec3f:b("MFVec3f",v.MFVec3f,D,D,Float32Array,3),MFVec4d:b("MFVec4d",v.MFVec4d,V,V,Float64Array,4),MFVec4f:b("MFVec4f",v.MFVec4f,I,I,Float32Array,4)};return Object.preventExtensions(B),Object.freeze(B),Object.seal(B),B}),define("x_ite/Fields",["x_ite/Fields/SFBool","x_ite/Fields/SFColor","x_ite/Fields/SFColorRGBA","x_ite/Fields/SFDouble","x_ite/Fields/SFFloat","x_ite/Fields/SFImage","x_ite/Fields/SFInt32","x_ite/Fields/SFMatrix3","x_ite/Fields/SFMatrix4","x_ite/Fields/SFNode","x_ite/Fields/SFRotation","x_ite/Fields/SFString","x_ite/Fields/SFTime","x_ite/Fields/SFVec2","x_ite/Fields/SFVec3","x_ite/Fields/SFVec4","x_ite/Fields/ArrayFields"],function(t,e,n,i,r,o,s,a,u,l,c,h,d,p,f,g,m){"use strict";var x=Object.assign({SFBool:t,SFColor:e,SFColorRGBA:n,SFDouble:i,SFFloat:r,SFImage:o,SFInt32:s,SFMatrix3d:a.SFMatrix3d,SFMatrix3f:a.SFMatrix3f,SFMatrix4d:u.SFMatrix4d,SFMatrix4f:u.SFMatrix4f,SFNode:l,SFRotation:c,SFString:h,SFTime:d,SFVec2d:p.SFVec2d,SFVec2f:p.SFVec2f,SFVec3d:f.SFVec3d,SFVec3f:f.SFVec3f,SFVec4d:g.SFVec4d,SFVec4f:g.SFVec4f,VrmlMatrix:u.VrmlMatrix},m);return Object.preventExtensions(x),Object.freeze(x),Object.seal(x),x}),define("x_ite/Browser/VERSION",[],function(){return"4.5.1a"}),define("x_ite/DEBUG",[],function(){"use strict";return!1}),define("x_ite/Base/X3DEventObject",["x_ite/Base/X3DChildObject","x_ite/Base/Events"],function(t,e){"use strict";function n(e){t.call(this),this._browser=e}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,getBrowser:function(){return this._browser},getExtendedEventHandling:function(){return!0},addEvent:function(t){t.setSet(!0),t.getTainted()||(t.setTainted(!0),this.addEventObject(t,e.create(t)))},addEventObject:function(t,e){var n=this.getBrowser();t.setSet(!0),n.addBrowserEvent(),n.addTaintedField(t,e),this.getTainted()||(t.isInput()||this.getExtendedEventHandling()&&!t.isOutput())&&this.addNodeEvent()},addNodeEvent:function(){if(!this.getTainted()){var t=this.getBrowser();this.setTainted(!0),t.addTaintedNode(this),t.addBrowserEvent()}},processEvents:function(){this.setTainted(!1),this.processInterests()}}),n}),define("x_ite/Basic/X3DBaseNode",["x_ite/Base/X3DEventObject","x_ite/Base/Events","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Fields","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(t,e,n,i,r,o,s){"use strict";function a(e){if(!this.hasOwnProperty("_executionContext")){t.call(this,e.getBrowser()),this._executionContext=e,this._type=[o.X3DBaseNode],this._fields=new Map,this._predefinedFields=new Map,this._userDefinedFields=new Map,this._cloneCount=0,this.hasUserDefinedFields()&&(this.fieldDefinitions=new i(this.fieldDefinitions.getValue().slice()));for(var n=this.fieldDefinitions.getValue(),r=0,s=n.length;r<s;++r)this.addField(n[r])}}return a.prototype=Object.assign(Object.create(t.prototype),{constructor:a,fieldDefinitions:new i([]),_private:!1,_live:!0,_initialized:!1,setExecutionContext:function(t){this._executionContext=t},getExecutionContext:function(){return this._executionContext},getScene:function(){for(var t=this._executionContext;!t.isRootContext();)t=t.getExecutionContext();return t},getMasterScene:function(){for(var t=this._executionContext.getScene();!t.isMasterContext();)t=t.getScene();return t},addType:function(t){this._type.push(t)},getType:function(){return this._type},isType:function(t){for(var e=this._type,n=e.length-1;n>=0;--n)if(t.has(e[n]))return!0;return!1},getInnerNode:function(){return this},isLive:function(){function t(){return this.isLive_}return function(){return this.isLive=t,this.addChildObjects("isLive",new r.SFBool(this.getLiveState())),this.isLive_.removeParent(this),this._executionContext!==this&&this._executionContext.isLive().addInterest("_set_live__",this),this.isLive()}}(),setLive:function(t){this._live=t.valueOf(),this._set_live__()},getLive:function(){return this._live},getLiveState:function(){return this!==this._executionContext?this.getLive()&&this._executionContext.isLive().getValue():this.getLive()},_set_live__:function(){var t=this.getLiveState(),n=this.isLive();if(t){if(n.getValue())return;n.setValue(!0),n.processEvent(e.create(n))}else n.getValue()&&(n.setValue(!1),n.processEvent(e.create(n)))},setInitialized:function(t){this._initialized=t},isInitialized:function(){return this._initialized},setup:function(){this._initialized||(this._initialized=!0,this._fields.forEach(function(t){t.updateReferences(),t.setTainted(!1)}),this.initialize())},initialize:function(){},create:function(t){return new this.constructor(t)},copy:function(){function t(t){return t.getCloneCount()>1||!!t.hasRoutes()}return function(e){var n=this.getName();if(n.length){var i=e.getNamedNodes().get(n);if(i)return i}else t(this)&&this.getExecutionContext().updateNamedNode(this.getExecutionContext().getUniqueName(n),this);var r=this.create(e);return n.length&&e.updateNamedNode(n,r),this.getPredefinedFields().forEach(function(t){try{var n=r.getField(t.getName());if(n.setSet(t.getSet()),t.hasReferences())t.getReferences().forEach(function(t){try{n.addReference(e.getField(t.getName()))}catch(t){console.error(t.message)}});else if(t.getAccessType()&o.initializeOnly)switch(t.getType()){case o.SFNode:case o.MFNode:n.setValue(t.copy(e));break;default:n.setValue(t)}}catch(t){console.log(t.message)}}),this.getUserDefinedFields().forEach(function(t){var n=t.copy(e);r.addUserDefinedField(t.getAccessType(),t.getName(),n),n.setSet(t.getSet()),t.hasReferences()&&t.getReferences().forEach(function(t){try{n.addReference(e.getField(t.getName()))}catch(n){console.error("No reference '"+t.getName()+"' inside execution context "+e.getTypeName()+" '"+e.getName()+"'.")}})}),e.addUninitializedNode(r),r}}(),flatCopy:function(t){
var e=this.create(t||this.getExecutionContext());return this._fields.forEach(function(t){e._fields.get(t.getName()).assign(t)}),e.setup(),e},addChildObjects:function(t,e){for(var n=0,i=arguments.length;n<i;n+=2)this.addChildObject(arguments[n],arguments[n+1])},addChildObject:function(t,e){e.addParent(this),e.setName(t),Object.defineProperty(this,t+"_",{get:function(){return e},set:function(t){e.setValue(t)},enumerable:!0,configurable:!1})},addField:function(t){var e=t.accessType,n=t.name,i=t.value.clone();i.setTainted(!0),i.addParent(this),i.setName(n),i.setAccessType(e),this.setField(n,i)},setField:function(t,e,n){this._fields.set(t,e),this.getPrivate()||e.addClones(1),n?this._userDefinedFields.set(t,e):(this._predefinedFields.set(t,e),Object.defineProperty(this,t+"_",{get:function(){return e},set:function(t){e.setValue(t)},enumerable:!0,configurable:!0}))},removeField:function(t){var e=this._fields.get(t);if(e){this._fields.delete(t),this._userDefinedFields.delete(t);for(var n=this.fieldDefinitions.getValue(),i=0,r=n.length;i<r;++i)if(n[i].name===t){n.splice(i,1);break}this.getPrivate()||e.removeClones(1)}},getField:function(){return function(t){var e=this._fields.get(t);if(e)return e;var n=t.match(/^set_(.*?)$/);if(n&&(e=this._fields.get(n[1]))&&e.getAccessType()===o.inputOutput)return e;var n=t.match(/^(.*?)_changed$/);if(n&&(e=this._fields.get(n[1]))&&e.getAccessType()===o.inputOutput)return e;throw new Error("Unkown field '"+t+"' in node class "+this.getTypeName()+".")}}(),getFieldDefinitions:function(){return this.fieldDefinitions},hasUserDefinedFields:function(){return!1},addUserDefinedField:function(t,e,i){this._fields.has(e)&&this.removeField(e),i.setTainted(!0),i.addParent(this),i.setName(e),i.setAccessType(t),this.fieldDefinitions.add(new n(t,e,i)),this.setField(e,i,!0)},getUserDefinedFields:function(){return this._userDefinedFields},getPredefinedFields:function(){return this._predefinedFields},getChangedFields:function(t){var e=[],n=this.getPredefinedFields();if(t){this.getUserDefinedFields().forEach(function(t){e.push(t)})}return n.forEach(function(n){if(t&&(n.getInputRoutes().size||n.getOutputRoutes().size))return void e.push(n);if(0===n.getReferences().size){if(!n.isInitializable())return;if(this.isDefaultValue(n))return}e.push(n)},this),e},isDefaultValue:function(t){var e=this.getFieldDefinitions().get(t.getName());return e?e.value.equals(t):!t.getSet()},getFields:function(){return this._fields},getSourceText:function(){return null},hasRoutes:function(){for(var t of this._fields.values()){if(t.getInputRoutes().size)return!0;if(t.getOutputRoutes().size)return!0}return!1},getPrivate:function(){return this._private},setPrivate:function(t){this._private=t,t?this._fields.forEach(function(t){t.removeClones(1)}):this._fields.forEach(function(t){t.addClones(1)})},getCloneCount:function(){return this._cloneCount},addClones:function(t){0!==t&&(this._cloneCount+=t)},removeClones:function(t){0!==t&&(this._cloneCount-=t)},traverse:function(){},toStream:function(t){t.string+=this.getTypeName()+" { }"},toVRMLStream:function(t){var e=s.Get(t);if(e.IsSharedNode(this))return void(t.string+="NULL");e.EnterScope();var n=e.Name(this);if(n.length&&e.ExistsNode(this))return t.string+="USE",t.string+=" ",t.string+=n,void e.LeaveScope();n.length&&(e.AddNode(this),t.string+="DEF",t.string+=" ",t.string+=n,t.string+=" "),t.string+=this.getTypeName(),t.string+=" ",t.string+="{";var i=0,r=0,o=this.getUserDefinedFields();this.hasUserDefinedFields()&&(o.forEach(function(t){i=Math.max(i,t.getTypeName().length),r=Math.max(r,e.AccessType(t.getAccessType()).length)}),o.size&&(t.string+="\n",e.IncIndent(),o.forEach(function(e){this.toVRMLStreamUserDefinedField(t,e,i,r),t.string+="\n"},this),e.DecIndent(),t.string+="\n"));var a=this.getChangedFields();0===a.length?o.size?t.string+=e.Indent():t.string+=" ":(0===o.size&&(t.string+="\n"),e.IncIndent(),a.forEach(function(e){this.toVRMLStreamField(t,e,i,r),t.string+="\n"},this),e.DecIndent(),t.string+=e.Indent()),t.string+="}",e.LeaveScope()},toVRMLStreamField:function(t,e,n,i){var r=s.Get(t);if(0!==e.getReferences().size&&r.ExecutionContext()){var a=0,u=!1;e.getReferences().forEach(function(n){u|=n.isInitializable(),t.string+=r.Indent(),t.string+=e.getName(),t.string+=" ",t.string+="IS",t.string+=" ",t.string+=n.getName(),++a!==e.getReferences().size&&(t.string+="\n")}),e.getAccessType()!==o.inputOutput||u||e.isDefaultValue()||(t.string+="\n",t.string+=r.Indent(),t.string+=e.getName(),t.string+=" ",e.toVRMLStream(t))}else e.isInitializable()&&(t.string+=r.Indent(),t.string+=e.getName(),t.string+=" ",e.toVRMLStream(t))},toVRMLStreamUserDefinedField:function(t,e,n,i){var r=s.Get(t);if(0!==e.getReferences().size&&r.ExecutionContext()){var a=0,u=!1;e.getReferences().forEach(function(o){u|=o.isInitializable(),t.string+=r.Indent(),t.string+=r.PadRight(r.AccessType(e.getAccessType()),i),t.string+=" ",t.string+=r.PadRight(e.getTypeName(),n),t.string+=" ",t.string+=e.getName(),t.string+=" ",t.string+="IS",t.string+=" ",t.string+=o.getName(),++a!==e.getReferences().size&&(t.string+="\n")}),e.getAccessType()!==o.inputOutput||u||e.isDefaultValue()||(t.string+="\n",t.string+=r.Indent(),t.string+=r.PadRight(r.AccessType(e.getAccessType()),i),t.string+=" ",t.string+=r.PadRight(e.getTypeName(),n),t.string+=" ",t.string+=e.getName(),e.isInitializable()&&(t.string+=" ",e.toVRMLStream(t)))}else t.string+=r.Indent(),t.string+=r.PadRight(r.AccessType(e.getAccessType()),i),t.string+=" ",t.string+=r.PadRight(e.getTypeName(),n),t.string+=" ",t.string+=e.getName(),e.isInitializable()&&(t.string+=" ",e.toVRMLStream(t))},toXMLStream:function(t){var e=s.Get(t);if(e.IsSharedNode(this))return t.string+=e.Indent(),void(t.string+="<!-- NULL -->");e.EnterScope();var n=e.Name(this);if(n.length&&e.ExistsNode(this)){t.string+=e.Indent(),t.string+="<",t.string+=this.getTypeName(),t.string+=" ",t.string+="USE='",t.string+=e.XMLEncode(n),t.string+="'";var i=e.ContainerField();return i&&i.getName()!==this.getContainerField()&&(t.string+=" ",t.string+="containerField='",t.string+=e.XMLEncode(i.getName()),t.string+="'"),t.string+="/>",void e.LeaveScope()}t.string+=e.Indent(),t.string+="<",t.string+=this.getTypeName(),n.length&&(e.AddNode(this),t.string+=" ",t.string+="DEF='",t.string+=e.XMLEncode(n),t.string+="'");var i=e.ContainerField();i&&i.getName()!==this.getContainerField()&&(t.string+=" ",t.string+="containerField='",t.string+=e.XMLEncode(i.getName()),t.string+="'");var r=this.getChangedFields(),a=this.getUserDefinedFields(),u=[],l=[],c=this.getSourceText();c&&0===c.length&&(c=null),e.IncIndent(),e.IncIndent();for(var h=0,d=r.length;h<d;++h){var p=r[h],f=!1;if(e.ExecutionContext()&&p.getAccessType()===o.inputOutput&&0!==p.getReferences().size){var g=!1;p.getReferences().forEach(function(t){g|=t.isInitializable()}),g||(f=!0)}if(0===p.getReferences().size||!e.ExecutionContext()||f){if(f&&u.push(p),p.isInitializable())switch(p.getType()){case o.SFNode:case o.MFNode:l.push(p);break;default:if(p===c)break;t.string+="\n",t.string+=e.Indent(),t.string+=p.getName(),t.string+="='",p.toXMLStream(t),t.string+="'"}}else u.push(p)}if(e.DecIndent(),e.DecIndent(),this.hasUserDefinedFields()&&0!==a.size||0!==u.length||0!==l.length||c){if(t.string+=">\n",e.IncIndent(),this.hasUserDefinedFields()&&a.forEach(function(n){t.string+=e.Indent(),t.string+="<field",t.string+=" ",t.string+="accessType='",t.string+=e.AccessType(n.getAccessType()),t.string+="'",t.string+=" ",t.string+="type='",t.string+=n.getTypeName(),t.string+="'",t.string+=" ",t.string+="name='",t.string+=e.XMLEncode(n.getName()),t.string+="'";var i=!1;if(n.getAccessType()===o.inputOutput&&0!==n.getReferences().size){var r=!1;n.getReferences().forEach(function(t){r|=t.isInitializable()}),r||(i=!0)}if(0===n.getReferences().size||!e.ExecutionContext()||i)if(i&&e.ExecutionContext()&&u.push(n),!n.isInitializable()||n.isDefaultValue())t.string+="/>\n";else switch(n.getType()){case o.SFNode:case o.MFNode:e.PushContainerField(n),t.string+=">\n",e.IncIndent(),n.toXMLStream(t),t.string+="\n",e.DecIndent(),t.string+=e.Indent(),t.string+="</field>\n",e.PopContainerField();break;default:t.string+=" ",t.string+="value='",n.toXMLStream(t),t.string+="'",t.string+="/>\n"}else e.ExecutionContext()&&u.push(n),t.string+="/>\n"}),u.length){t.string+=e.Indent(),t.string+="<IS>",t.string+="\n",e.IncIndent();for(var h=0,d=u.length;h<d;++h){var p=u[h];p.getReferences().forEach(function(n){t.string+=e.Indent(),t.string+="<connect",t.string+=" ",t.string+="nodeField='",t.string+=e.XMLEncode(p.getName()),t.string+="'",t.string+=" ",t.string+="protoField='",t.string+=e.XMLEncode(n.getName()),t.string+="'",t.string+="/>\n"})}e.DecIndent(),t.string+=e.Indent(),t.string+="</IS>\n"}for(var h=0,d=l.length;h<d;++h){var p=l[h];e.PushContainerField(p),p.toXMLStream(t),t.string+="\n",e.PopContainerField()}if(c)for(var h=0,d=c.length;h<d;++h){var m=c[h];t.string+="<![CDATA[",t.string+=e.escapeCDATA(m),t.string+="]]>\n"}e.DecIndent(),t.string+=e.Indent(),t.string+="</",t.string+=this.getTypeName(),t.string+=">"}else t.string+="/>";e.LeaveScope()},dispose:function(){var t=this.getPredefinedFields(),e=this.getUserDefinedFields();t.forEach(function(t){t.dispose()}),e.forEach(function(t){t.dispose()}),new Set(this.getParents()).forEach(function(t){t instanceof r.SFNode&&(new Set(t.getParents()).forEach(function(e){if(e instanceof r.MFNode){var n=e.length;e.erase(e.remove(0,n,t),n)}}),t.setValue(null))})}}),a.prototype.addAlias=a.prototype.setField,a}),define("x_ite/Browser/Core/PrimitiveQuality",[],function(){"use strict";var t=0,e={LOW:t++,MEDIUM:t++,HIGH:t++};return Object.preventExtensions(e),Object.freeze(e),Object.seal(e),e}),define("x_ite/Browser/Core/Shading",[],function(){"use strict";var t=0,e={POINT:t++,WIREFRAME:t++,FLAT:t++,GOURAUD:t++,PHONG:t++};return Object.preventExtensions(e),Object.freeze(e),Object.seal(e),e}),define("x_ite/Browser/Core/TextureQuality",[],function(){"use strict";var t=0,e={LOW:t++,MEDIUM:t++,HIGH:t++};return Object.preventExtensions(e),Object.freeze(e),Object.seal(e),e}),define("x_ite/Browser/Core/BrowserOptions",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Basic/X3DBaseNode","x_ite/Bits/X3DConstants","x_ite/Browser/Core/PrimitiveQuality","x_ite/Browser/Core/Shading","x_ite/Browser/Core/TextureQuality"],function(t,e,n,i,r,o,s,a){"use strict";function u(t,e){return"true"===t||"TRUE"===t||"false"!==t&&"FALSE"!==t&&e}function l(t){i.call(this,t),this.addAlias("AntiAliased",this.Antialiased_),this.textureQuality=a.MEDIUM,this.primitiveQuality=o.MEDIUM,this.shading=s.GOURAUD,this.setAttributeSplashScreen()}return l.prototype=Object.assign(Object.create(i.prototype),{constructor:l,fieldDefinitions:new n([new e(r.inputOutput,"SplashScreen",new t.SFBool(!0)),new e(r.inputOutput,"Dashboard",new t.SFBool(!0)),new e(r.inputOutput,"Rubberband",new t.SFBool(!0)),new e(r.inputOutput,"EnableInlineViewpoints",new t.SFBool(!0)),new e(r.inputOutput,"Antialiased",new t.SFBool(!0)),new e(r.inputOutput,"TextureQuality",new t.SFString("MEDIUM")),new e(r.inputOutput,"PrimitiveQuality",new t.SFString("MEDIUM")),new e(r.inputOutput,"QualityWhenMoving",new t.SFString("MEDIUM")),new e(r.inputOutput,"Shading",new t.SFString("GOURAUD")),new e(r.inputOutput,"MotionBlur",new t.SFBool),new e(r.inputOutput,"Gravity",new t.SFFloat(9.80665)),new e(r.inputOutput,"StraightenHorizon",new t.SFBool(!0)),new e(r.inputOutput,"LogarithmicDepthBuffer",new t.SFBool(!1))]),getTypeName:function(){return"BrowserOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"browserOptions"},initialize:function(){i.prototype.initialize.call(this),this.SplashScreen_.addInterest("set_splashScreen__",this),this.Rubberband_.addInterest("set_rubberband__",this),this.PrimitiveQuality_.addInterest("set_primitiveQuality__",this),this.TextureQuality_.addInterest("set_textureQuality__",this),this.Shading_.addInterest("set_shading__",this),this.StraightenHorizon_.addInterest("set_straightenHorizon__",this),this.LogarithmicDepthBuffer_.addInterest("set_logarithmicDepthBuffer__",this),this.configure()},configure:function(){if(this.isInitialized()){for(var t=this.getFieldDefinitions(),e=0;e<t.length;++e){var n=t[e],i=this.getField(n.name);void 0===this.getBrowser().getLocalStorage()["BrowserOptions."+n.name]&&(i.equals(n.value)||i.setValue(n.value))}var r=this.getBrowser().getLocalStorage()["BrowserOptions.Rubberband"],o=this.getBrowser().getLocalStorage()["BrowserOptions.PrimitiveQuality"],s=this.getBrowser().getLocalStorage()["BrowserOptions.TextureQuality"],a=this.getBrowser().getLocalStorage()["BrowserOptions.StraightenHorizon"];this.setAttributeSplashScreen(),void 0!==r&&r!==this.Rubberband_.getValue()&&(this.Rubberband_=r),void 0!==o&&o!==this.PrimitiveQuality_.getValue().toUpperCase()&&(this.PrimitiveQuality_=o),void 0!==s&&s!==this.TextureQuality_.getValue().toUpperCase()&&(this.TextureQuality_=s),void 0!==a&&a!==this.StraightenHorizon_.getValue()&&(this.StraightenHorizon_=a)}},setAttributeSplashScreen:function(){this.SplashScreen_.set(this.getSplashScreen())},getCache:function(){return u(this.getBrowser().getElement().attr("cache"),!0)},getContextMenu:function(){return u(this.getBrowser().getElement().attr("contextMenu"),!0)},getDebug:function(){return u(this.getBrowser().getElement().attr("debug"),!1)},getNotifications:function(){return u(this.getBrowser().getElement().attr("notifications"),!0)},getSplashScreen:function(){return u(this.getBrowser().getElement().attr("splashScreen"),!0)},getTimings:function(){return u(this.getBrowser().getElement().attr("timings"),!0)},getPrimitiveQuality:function(){return this.primitiveQuality},getShading:function(){return this.shading},getTextureQuality:function(){return this.textureQuality},set_splashScreen__:function(t){this.getBrowser().getElement().attr("splashScreen",t.getValue()?"true":"false")},set_rubberband__:function(t){this.getBrowser().getLocalStorage()["BrowserOptions.Rubberband"]=t.getValue()},set_primitiveQuality__:function(t){var e=this.getBrowser(),n=t.getValue().toUpperCase();e.getLocalStorage()["BrowserOptions.PrimitiveQuality"]=n;var i=e.getConeOptions(),r=e.getCylinderOptions(),s=e.getSphereOptions();switch(n){case"LOW":if(this.primitiveQuality===o.LOW)break;this.primitiveQuality=o.LOW,e.setGeometry2DPrimitiveQuality&&e.setGeometry2DPrimitiveQuality(this.primitiveQuality),i.xDimension_=16,r.xDimension_=16,s.xDimension_=20,s.yDimension_=9;break;case"HIGH":if(this.primitiveQuality===o.HIGH)break;this.primitiveQuality=o.HIGH,e.setGeometry2DPrimitiveQuality&&e.setGeometry2DPrimitiveQuality(this.primitiveQuality),i.xDimension_=32,r.xDimension_=32,s.xDimension_=64,s.yDimension_=31;break;default:if(this.primitiveQuality===o.MEDIUM)break;this.primitiveQuality=o.MEDIUM,e.setGeometry2DPrimitiveQuality&&e.setGeometry2DPrimitiveQuality(this.primitiveQuality),i.xDimension_=20,r.xDimension_=20,s.xDimension_=32,s.yDimension_=15}},set_textureQuality__:function(t){var e=t.getValue().toUpperCase();this.getBrowser().getLocalStorage()["BrowserOptions.TextureQuality"]=e;var n=this.getBrowser().getDefaultTextureProperties();switch(e){case"LOW":if(this.textureQuality===a.LOW)break;this.textureQuality=a.LOW,n.magnificationFilter_="AVG_PIXEL",n.minificationFilter_="AVG_PIXEL",n.textureCompression_="FASTEST",n.generateMipMaps_=!0;break;case"HIGH":if(this.textureQuality===a.HIGH)break;this.textureQuality=a.HIGH,n.magnificationFilter_="NICEST",n.minificationFilter_="NICEST",n.textureCompression_="NICEST",n.generateMipMaps_=!0;break;default:if(this.textureQuality===a.MEDIUM)break;this.textureQuality=a.MEDIUM,n.magnificationFilter_="NICEST",n.minificationFilter_="AVG_PIXEL_AVG_MIPMAP",n.textureCompression_="NICEST",n.generateMipMaps_=!0}},set_shading__:function(t){switch(t.getValue().toUpperCase()){case"POINT":case"POINTSET":this.shading=s.POINT;break;case"WIREFRAME":this.shading=s.WIREFRAME;break;case"FLAT":this.shading=s.FLAT;break;case"PHONG":this.shading=s.PHONG;break;default:this.shading=s.GOURAUD}this.getBrowser().setShading(this.shading)},set_straightenHorizon__:function(t){this.getBrowser().getLocalStorage()["BrowserOptions.StraightenHorizon"]=t.getValue()},set_logarithmicDepthBuffer__:function(t){var e=this.getBrowser(),n=e.getContext();(t=t.getValue()&&(n.getVersion()>=2||Boolean(e.getExtension("EXT_frag_depth"))))!==e.getRenderingProperties().LogarithmicDepthBuffer_.getValue()&&(e.getRenderingProperties().LogarithmicDepthBuffer_=t,e.hasPointShader()&&(e.getPointShader().parts_[0].getValue().url_.addEvent(),e.getPointShader().parts_[1].getValue().url_.addEvent()),e.hasLineShader()&&(e.getLineShader().parts_[0].getValue().url_.addEvent(),e.getLineShader().parts_[1].getValue().url_.addEvent()),e.hasGouraudShader()&&(e.getGouraudShader().parts_[0].getValue().url_.addEvent(),e.getGouraudShader().parts_[1].getValue().url_.addEvent()),e.hasPhongShader()&&(e.getPhongShader().parts_[0].getValue().url_.addEvent(),e.getPhongShader().parts_[1].getValue().url_.addEvent()),e.hasShadowShader()&&(e.getShadowShader().parts_[0].getValue().url_.addEvent(),e.getShadowShader().parts_[1].getValue().url_.addEvent()))}}),l}),define("x_ite/Browser/Core/BrowserProperties",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Basic/X3DBaseNode","x_ite/Bits/X3DConstants"],function(t,e,n,i,r){"use strict";function o(t){i.call(this,t)}return o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,fieldDefinitions:new n([new e(r.initializeOnly,"ABSTRACT_NODES",new t.SFBool(!0)),new e(r.initializeOnly,"CONCRETE_NODES",new t.SFBool(!0)),new e(r.initializeOnly,"EXTERNAL_INTERACTIONS",new t.SFBool(!0)),new e(r.initializeOnly,"PROTOTYPE_CREATE",new t.SFBool(!0)),new e(r.initializeOnly,"DOM_IMPORT",new t.SFBool(!0)),new e(r.initializeOnly,"XML_ENCODING",new t.SFBool(!0)),new e(r.initializeOnly,"CLASSIC_VRML_ENCODING",new t.SFBool(!0)),new e(r.initializeOnly,"BINARY_ENCODING",new t.SFBool)]),getTypeName:function(){return"BrowserProperties"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"browserProperties"}}),o}),define("x_ite/Browser/Core/RenderingProperties",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Basic/X3DBaseNode","x_ite/Bits/X3DConstants"],function(t,e,n,i,r){"use strict";function o(t){i.call(this,t),this.addAlias("AntiAliased",this.Antialiased_)}return o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,fieldDefinitions:new n([new e(r.outputOnly,"Shading",new t.SFString),new e(r.outputOnly,"MaxTextureSize",new t.SFInt32),new e(r.outputOnly,"TextureUnits",new t.SFInt32),new e(r.outputOnly,"MaxLights",new t.SFInt32),new e(r.outputOnly,"Antialiased",new t.SFBool(!0)),new e(r.outputOnly,"ColorDepth",new t.SFInt32),new e(r.outputOnly,"TextureMemory",new t.SFDouble),new e(r.outputOnly,"LogarithmicDepthBuffer",new t.SFBool(!1))]),getTypeName:function(){return"RenderingProperties"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"renderingProperties"},initialize:function(){i.prototype.initialize.call(this);var t=this.getBrowser();this.MaxTextureSize_=t.getMaxTextureSize(),this.TextureUnits_=t.getCombinedTextureUnits(),this.MaxLights_=t.getMaxLights(),this.ColorDepth_=t.getColorDepth(),this.TextureMemory_=t.getTextureMemory(),t.getBrowserOptions().Shading_.addInterest("set_shading__",this),this.set_shading__(t.getBrowserOptions().Shading_)},set_shading__:function(t){this.Shading_=t}}),o}),define("x_ite/Browser/Core/Notification",["jquery","x_ite/Fields/SFString","x_ite/Basic/X3DBaseNode"],function(t,e,n){"use strict";function i(t){n.call(this,t),this.addChildObjects("string",new e)}return t.fn.textWidth=function(e){var n=t(this).children(),i=t(this).html(),r="<span>"+i+"</span>";t(this).html(r);var o=t(this).find("span:first").width();return t(this).empty(),t(this).append(n),o},i.prototype=Object.assign(Object.create(n.prototype),{constructor:i,getTypeName:function(){return"Notification"},getComponentName:function(){return"X_ITE"},initialize:function(){n.prototype.initialize.call(this),this.element=t("<div></div>").addClass("x_ite-private-notification").appendTo(this.getBrowser().getElement().find(".x_ite-private-surface")).animate({width:0}),t("<span></span>").appendTo(this.element),this.string_.addInterest("set_string__",this)},set_string__:function(){this.getBrowser().getBrowserOptions().getNotifications()&&0!==this.string_.length&&(this.element.children().text(this.string_.getValue()),this.element.stop(!0,!0).fadeIn(0).animate({width:this.element.textWidth()}).animate({delay:1},5e3).animate({width:0}).fadeOut(0))}}),i}),define("text/text",["module"],function(t){"use strict";function e(t,e){return void 0===t||""===t?e:t}function n(t,n,i,r){if(n===r)return!0;if(t===i){if("http"===t)return e(n,"80")===e(r,"80");if("https"===t)return e(n,"443")===e(r,"443")}return!1}var i,r,o,s,a,u=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],l="undefined"!=typeof location&&location.href,c=l&&location.protocol&&location.protocol.replace(/\:/,""),h=l&&location.hostname,d=l&&(location.port||void 0),p={},f=t.config&&t.config()||{};return i={version:"2.0.15",strip:function(t){if(t){t=t.replace(/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,"");var e=t.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);e&&(t=e[1])}else t="";return t},jsEscape:function(t){return t.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:f.createXhr||function(){var t,e,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(e=0;e<3;e+=1){n=u[e];try{t=new ActiveXObject(n)}catch(t){}if(t){u=[n];break}}return t},parseName:function(t){var e,n,i,r=!1,o=t.lastIndexOf("."),s=0===t.indexOf("./")||0===t.indexOf("../");return o!==-1&&(!s||o>1)?(e=t.substring(0,o),n=t.substring(o+1)):e=t,i=n||e,o=i.indexOf("!"),o!==-1&&(r="strip"===i.substring(o+1),i=i.substring(0,o),n?n=i:e=i),{moduleName:e,ext:n,strip:r}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(t,e,r,o){var s,a,u,l=i.xdRegExp.exec(t);return!l||(s=l[2],a=l[3],a=a.split(":"),u=a[1],a=a[0],(!s||s===e)&&(!a||a.toLowerCase()===r.toLowerCase())&&(!u&&!a||n(s,u,e,o)))},finishLoad:function(t,e,n,r){n=e?i.strip(n):n,f.isBuild&&(p[t]=n),r(n)},load:function(t,e,n,r){if(r&&r.isBuild&&!r.inlineText)return void n();f.isBuild=r&&r.isBuild;var o=i.parseName(t),s=o.moduleName+(o.ext?"."+o.ext:""),a=e.toUrl(s),u=f.useXhr||i.useXhr;if(0===a.indexOf("empty:"))return void n();!l||u(a,c,h,d)?i.get(a,function(e){i.finishLoad(t,o.strip,e,n)},function(t){n.error&&n.error(t)}):e([s],function(t){i.finishLoad(o.moduleName+"."+o.ext,o.strip,t,n)})},write:function(t,e,n,r){if(p.hasOwnProperty(e)){var o=i.jsEscape(p[e]);n.asModule(t+"!"+e,"define(function () { return '"+o+"';});\n")}},writeFile:function(t,e,n,r,o){var s=i.parseName(e),a=s.ext?"."+s.ext:"",u=s.moduleName+a,l=n.toUrl(s.moduleName+a)+".js";i.load(u,n,function(e){var n=function(t){return r(l,t)};n.asModule=function(t,e){return r.asModule(t,l,e)},i.write(t,u,n,o)},o)}},"node"===f.env||!f.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(r=require.nodeRequire("fs"),i.get=function(t,e,n){try{var i=r.readFileSync(t,"utf8");"\ufeff"===i[0]&&(i=i.substring(1)),e(i)}catch(t){n&&n(t)}}):"xhr"===f.env||!f.env&&i.createXhr()?i.get=function(t,e,n,r){var o,s=i.createXhr();if(s.open("GET",t,!0),r)for(o in r)r.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),r[o]);f.onXhr&&f.onXhr(s,t),s.onreadystatechange=function(i){var r,o;4===s.readyState&&(r=s.status||0,r>399&&r<600?(o=new Error(t+" HTTP status: "+r),o.xhr=s,n&&n(o)):e(s.responseText),f.onXhrComplete&&f.onXhrComplete(s,t))},s.send(null)}:"rhino"===f.env||!f.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?i.get=function(t,e){var n,i,r=new java.io.File(t),o=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),"utf-8")),a="";try{for(n=new java.lang.StringBuffer,i=s.readLine(),i&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),null!==i&&n.append(i);null!==(i=s.readLine());)n.append(o),n.append(i);a=String(n.toString())}finally{s.close()}e(a)}:("xpconnect"===f.env||!f.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(o=Components.classes,s=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),a="@mozilla.org/windows-registry-key;1"in o,i.get=function(t,e){var n,i,r,u={};a&&(t=t.replace(/\//g,"\\")),r=new FileUtils.File(t);try{n=o["@mozilla.org/network/file-input-stream;1"].createInstance(s.nsIFileInputStream),n.init(r,1,0,!1),i=o["@mozilla.org/intl/converter-input-stream;1"].createInstance(s.nsIConverterInputStream),i.init(n,"utf-8",n.available(),s.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),i.readString(n.available(),u),i.close(),n.close(),e(u.value)}catch(t){throw new Error((r&&r.path||"")+": "+t)}}),i}),define("text",["text/text"],function(t){return t}),define("text!locale/de.po",[],function(){return'msgid ""\nmsgstr ""\n"Project-Id-Version: X_ITE\\n"\n"POT-Creation-Date: 2015-12-23 04:56+0100\\n"\n"PO-Revision-Date: 2015-12-23 04:57+0100\\n"\n"Last-Translator: Holger Seelig <holger.seelig@yahoo.de>\\n"\n"Language-Team: \\n"\n"Language: de\\n"\n"MIME-Version: 1.0\\n"\n"Content-Type: text/plain; charset=UTF-8\\n"\n"Content-Transfer-Encoding: 8bit\\n"\n"X-Generator: Poedit 1.8.4\\n"\n"X-Poedit-Basepath: ../x_ite\\n"\n"Plural-Forms: nplurals=2; plural=(n != 1);\\n"\n"X-Poedit-SourceCharset: UTF-8\\n"\n"X-Poedit-SearchPath-0: .\\n"\n\n#: Browser/Core/BrowserTimings.js:96\nmsgid "Less Properties"\nmsgstr "Weniger Eigenschaften"\n\n#: Browser/Core/BrowserTimings.js:98\nmsgid "More Properties"\nmsgstr "Mehr Eigenschaften"\n\n#: Browser/Core/BrowserTimings.js:124\nmsgid "Frame rate"\nmsgstr "Bildrate"\n\n#: Browser/Core/BrowserTimings.js:124\nmsgid "fps"\nmsgstr "BpS"\n\n#: Browser/Core/BrowserTimings.js:125\nmsgid "Speed"\nmsgstr "Geschwindigkeit"\n\n#: Browser/Core/BrowserTimings.js:125\nmsgid "m/s"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:125\nmsgid "km/h"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:150\nmsgid "Browser"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:150 Browser/Core/BrowserTimings.js:151\n#: Browser/Core/BrowserTimings.js:152 Browser/Core/BrowserTimings.js:153\n#: Browser/Core/BrowserTimings.js:154 Browser/Core/BrowserTimings.js:155\n#: Browser/Core/BrowserTimings.js:156\nmsgid "ms"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:151\nmsgid "X3D"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:152\nmsgid "Routing"\nmsgstr "Routen"\n\n#: Browser/Core/BrowserTimings.js:153\nmsgid "Pointer"\nmsgstr "Zeigegerät"\n\n#: Browser/Core/BrowserTimings.js:154\nmsgid "Camera"\nmsgstr "Kamera"\n\n#: Browser/Core/BrowserTimings.js:155\nmsgid "Collision"\nmsgstr "Kollision"\n\n#: Browser/Core/BrowserTimings.js:156\nmsgid "Display"\nmsgstr "Anzeige"\n\n#: Browser/Core/BrowserTimings.js:157\nmsgid "Shapes"\nmsgstr "Formen"\n\n#: Browser/Core/BrowserTimings.js:158\nmsgid "Sensors"\nmsgstr "Sensoren"\n\n#: Browser/Core/BrowserTimings.js:163 Browser/Core/ContextMenu.js:210\nmsgid "Browser Timings"\nmsgstr "Zeitberechnung"\n\n#: Browser/Core/ContextMenu.js:19\nmsgid "X_ITE Browser"\nmsgstr ""\n\n#: Browser/Core/ContextMenu.js:59\nmsgid "Viewpoints"\nmsgstr "Ansichtspunkte"\n\n#: Browser/Core/ContextMenu.js:87\nmsgid "Available Viewers"\nmsgstr "Verfügbare Betrachter"\n\n#: Browser/Core/ContextMenu.js:145\nmsgid "Straighten Horizon"\nmsgstr "Horizont gerade richten"\n\n#: Browser/Core/ContextMenu.js:95 Browser/Core/ContextMenu.js:107\n#: Browser/Core/ContextMenu.js:121 Browser/Core/ContextMenu.js:135\nmsgid "Primitive Quality"\nmsgstr "Qualität der Grundobjekte"\n\n#: Browser/Core/ContextMenu.js:99 Browser/Core/ContextMenu.js:147\nmsgid "High"\nmsgstr "Hoch"\n\n#: Browser/Core/ContextMenu.js:107 Browser/Core/ContextMenu.js:155\nmsgid "high"\nmsgstr "hoch"\n\n#: Browser/Core/ContextMenu.js:113 Browser/Core/ContextMenu.js:161\nmsgid "Medium"\nmsgstr "Mittel"\n\n#: Browser/Core/ContextMenu.js:121 Browser/Core/ContextMenu.js:169\nmsgid "medium"\nmsgstr "mittel"\n\n#: Browser/Core/ContextMenu.js:127 Browser/Core/ContextMenu.js:175\nmsgid "Low"\nmsgstr "Niedrig"\n\n#: Browser/Core/ContextMenu.js:135 Browser/Core/ContextMenu.js:183\nmsgid "low"\nmsgstr "niedrig"\n\n#: Browser/Core/ContextMenu.js:143 Browser/Core/ContextMenu.js:155\n#: Browser/Core/ContextMenu.js:169 Browser/Core/ContextMenu.js:183\nmsgid "Texture Quality"\nmsgstr "Textur Qualität"\n\n#: Browser/Core/ContextMenu.js:191\nmsgid "Display Rubberband"\nmsgstr "Gummiband anzeigen"\n\n#: Browser/Core/ContextMenu.js:202 Browser/Core/ContextMenu.js:204\nmsgid "Rubberband"\nmsgstr "Gummiband"\n\n#: Browser/Core/ContextMenu.js:202\nmsgid "on"\nmsgstr "an"\n\n#: Browser/Core/ContextMenu.js:204\nmsgid "off"\nmsgstr "aus"\n\n#: Browser/Core/ContextMenu.js:225\nmsgid "Mute Browser"\nmsgstr "Browser stumm schalten"\n\n#: Browser/Core/ContextMenu.js:233\nmsgid "Browser muted"\nmsgstr "Browser stumm geschalten"\n\n#: Browser/Core/ContextMenu.js:233\nmsgid "Browser unmuted"\nmsgstr "Browser Ton an"\n\n#: Browser/Core/ContextMenu.js:239\nmsgid "Leave Fullscreen"\nmsgstr "Vollbild verlassen"\n\n#: Browser/Core/ContextMenu.js:239\nmsgid "Fullscreen"\nmsgstr "Vollbild"\n\n#: Browser/Core/ContextMenu.js:249\nmsgid "About X_ITE"\nmsgstr "Über X_ITE"\n\n#: Browser/Core/ContextMenu.js:342\nmsgid "Examine Viewer"\nmsgstr "Untersuchen"\n\n#: Browser/Core/ContextMenu.js:344\nmsgid "Walk Viewer"\nmsgstr "Laufen"\n\n#: Browser/Core/ContextMenu.js:346\nmsgid "Fly Viewer"\nmsgstr "Fliegen"\n\n#: Browser/Core/ContextMenu.js:348\nmsgid "Plane Viewer"\nmsgstr "Ebenen Betrachter"\n\n#: Browser/Core/ContextMenu.js:350\n#, fuzzy\nmsgid "Look At Viewer"\nmsgstr "Auf Objekte zielen"\n\n#: Browser/Core/ContextMenu.js:352\nmsgid "None Viewer"\nmsgstr "Kein Betrachter"\n\n#: Browser/Networking/X3DNetworkingContext.js:101\n#, javascript-format\nmsgid "Loading %d file"\nmsgstr "Lade %d Datei"\n\n#: Browser/Networking/X3DNetworkingContext.js:101\n#, javascript-format\nmsgid "Loading %d files"\nmsgstr "Lade %d Dateien"\n\n#: Browser/Networking/X3DNetworkingContext.js:104\nmsgid "Loading done"\nmsgstr "Fertig mit Laden"\n\n#: Browser/X3DBrowser.js:313\nmsgid "Failed loading world."\nmsgstr "Laden der Dateien fehlgeschlagen."\n\n#~ msgid "Look At"\n#~ msgstr "Auf Objekte zielen"\n'}),define("text!locale/fr.po",[],function(){
return'msgid ""\nmsgstr ""\n"Project-Id-Version: X_ITE\\n"\n"POT-Creation-Date: 2015-12-23 04:58+0100\\n"\n"PO-Revision-Date: 2015-12-23 05:07+0100\\n"\n"Last-Translator: Holger Seelig <holger.seelig@yahoo.de>\\n"\n"Language-Team: \\n"\n"Language: fr\\n"\n"MIME-Version: 1.0\\n"\n"Content-Type: text/plain; charset=UTF-8\\n"\n"Content-Transfer-Encoding: 8bit\\n"\n"X-Generator: Poedit 1.8.4\\n"\n"X-Poedit-Basepath: ../x_ite\\n"\n"Plural-Forms: nplurals=2; plural=(n != 1);\\n"\n"X-Poedit-SourceCharset: UTF-8\\n"\n"X-Poedit-SearchPath-0: .\\n"\n\n#: Browser/Core/BrowserTimings.js:96\nmsgid "Less Properties"\nmsgstr "Moins de propriétés"\n\n#: Browser/Core/BrowserTimings.js:98\nmsgid "More Properties"\nmsgstr "Plus de propriétés"\n\n#: Browser/Core/BrowserTimings.js:124\nmsgid "Frame rate"\nmsgstr "Fréquence"\n\n#: Browser/Core/BrowserTimings.js:124\nmsgid "fps"\nmsgstr "fps"\n\n#: Browser/Core/BrowserTimings.js:125\nmsgid "Speed"\nmsgstr "Vélocité"\n\n#: Browser/Core/BrowserTimings.js:125\nmsgid "m/s"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:125\nmsgid "km/h"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:150\n#, fuzzy\nmsgid "Browser"\nmsgstr "X_ITE Navigateur"\n\n#: Browser/Core/BrowserTimings.js:150 Browser/Core/BrowserTimings.js:151\n#: Browser/Core/BrowserTimings.js:152 Browser/Core/BrowserTimings.js:153\n#: Browser/Core/BrowserTimings.js:154 Browser/Core/BrowserTimings.js:155\n#: Browser/Core/BrowserTimings.js:156\nmsgid "ms"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:151\nmsgid "X3D"\nmsgstr ""\n\n#: Browser/Core/BrowserTimings.js:152\nmsgid "Routing"\nmsgstr "Routes"\n\n#: Browser/Core/BrowserTimings.js:153\nmsgid "Pointer"\nmsgstr "Pointeur"\n\n#: Browser/Core/BrowserTimings.js:154\nmsgid "Camera"\nmsgstr "Caméra"\n\n#: Browser/Core/BrowserTimings.js:155\nmsgid "Collision"\nmsgstr "Collision"\n\n#: Browser/Core/BrowserTimings.js:156\nmsgid "Display"\nmsgstr "Visualisation"\n\n#: Browser/Core/BrowserTimings.js:157\nmsgid "Shapes"\nmsgstr "Formes"\n\n#: Browser/Core/BrowserTimings.js:158\nmsgid "Sensors"\nmsgstr "Senseurs"\n\n#: Browser/Core/BrowserTimings.js:163 Browser/Core/ContextMenu.js:210\nmsgid "Browser Timings"\nmsgstr "Calcul du temps"\n\n#: Browser/Core/ContextMenu.js:19\nmsgid "X_ITE Browser"\nmsgstr "X_ITE Navigateur"\n\n#: Browser/Core/ContextMenu.js:59\nmsgid "Viewpoints"\nmsgstr "Points de vue"\n\n#: Browser/Core/ContextMenu.js:87\nmsgid "Available Viewers"\nmsgstr "Visionneurs disponibles"\n\n#: Browser/Core/ContextMenu.js:145\nmsgid "Straighten Horizon"\nmsgstr "Redresser l\'horizon"\n\n#: Browser/Core/ContextMenu.js:95 Browser/Core/ContextMenu.js:107\n#: Browser/Core/ContextMenu.js:121 Browser/Core/ContextMenu.js:135\nmsgid "Primitive Quality"\nmsgstr "Qualité des objets simples"\n\n#: Browser/Core/ContextMenu.js:99 Browser/Core/ContextMenu.js:147\nmsgid "High"\nmsgstr "Haut"\n\n#: Browser/Core/ContextMenu.js:107 Browser/Core/ContextMenu.js:155\nmsgid "high"\nmsgstr "haut"\n\n#: Browser/Core/ContextMenu.js:113 Browser/Core/ContextMenu.js:161\nmsgid "Medium"\nmsgstr "Moyenne"\n\n#: Browser/Core/ContextMenu.js:121 Browser/Core/ContextMenu.js:169\nmsgid "medium"\nmsgstr "moyenne"\n\n#: Browser/Core/ContextMenu.js:127 Browser/Core/ContextMenu.js:175\nmsgid "Low"\nmsgstr "Faible"\n\n#: Browser/Core/ContextMenu.js:135 Browser/Core/ContextMenu.js:183\nmsgid "low"\nmsgstr "faible"\n\n#: Browser/Core/ContextMenu.js:143 Browser/Core/ContextMenu.js:155\n#: Browser/Core/ContextMenu.js:169 Browser/Core/ContextMenu.js:183\nmsgid "Texture Quality"\nmsgstr "Qualité des textures"\n\n#: Browser/Core/ContextMenu.js:191\nmsgid "Display Rubberband"\nmsgstr "Présenter le bande élastique"\n\n#: Browser/Core/ContextMenu.js:202 Browser/Core/ContextMenu.js:204\nmsgid "Rubberband"\nmsgstr "Bande élastique"\n\n#: Browser/Core/ContextMenu.js:202\nmsgid "on"\nmsgstr "marche"\n\n#: Browser/Core/ContextMenu.js:204\nmsgid "off"\nmsgstr "arrêt"\n\n#: Browser/Core/ContextMenu.js:225\nmsgid "Mute Browser"\nmsgstr "Rendre navigateur muet"\n\n#: Browser/Core/ContextMenu.js:233\nmsgid "Browser muted"\nmsgstr "Navigateur muet"\n\n#: Browser/Core/ContextMenu.js:233\nmsgid "Browser unmuted"\nmsgstr "Son de navigateur réactivé"\n\n#: Browser/Core/ContextMenu.js:239\nmsgid "Leave Fullscreen"\nmsgstr "Sortie en plein écran"\n\n#: Browser/Core/ContextMenu.js:239\nmsgid "Fullscreen"\nmsgstr "Plein écran"\n\n#: Browser/Core/ContextMenu.js:249\nmsgid "About X_ITE"\nmsgstr "À propos de X_ITE"\n\n#: Browser/Core/ContextMenu.js:342\nmsgid "Examine Viewer"\nmsgstr "Examiner"\n\n#: Browser/Core/ContextMenu.js:344\nmsgid "Walk Viewer"\nmsgstr "Aller"\n\n#: Browser/Core/ContextMenu.js:346\nmsgid "Fly Viewer"\nmsgstr "Voler"\n\n#: Browser/Core/ContextMenu.js:348\nmsgid "Plane Viewer"\nmsgstr "Visionneur de la plaine"\n\n#: Browser/Core/ContextMenu.js:350\n#, fuzzy\nmsgid "Look At Viewer"\nmsgstr "Regarder un objet de près"\n\n#: Browser/Core/ContextMenu.js:352\nmsgid "None Viewer"\nmsgstr "Pas de visionneur"\n\n#: Browser/Networking/X3DNetworkingContext.js:101\n#, javascript-format\nmsgid "Loading %d file"\nmsgstr "Télécharger %d fichier"\n\n#: Browser/Networking/X3DNetworkingContext.js:101\n#, javascript-format\nmsgid "Loading %d files"\nmsgstr "Télécharger %d fichiers"\n\n#: Browser/Networking/X3DNetworkingContext.js:104\nmsgid "Loading done"\nmsgstr "Téléchargement fini"\n\n#: Browser/X3DBrowser.js:313\nmsgid "Failed loading world."\nmsgstr "Le chargement des fichiers ayant échoué."\n\n#~ msgid "Look At"\n#~ msgstr "Regarder un objet de près"\n'}),define("locale/gettext",["text!locale/de.po","text!locale/fr.po"],function(t,e){"use strict";function n(t,e){for(var n=null,i=[];n=t.exec(e);)i.push(n);return i}function i(t){var e=r[s];if(void 0===e)return t;var n=e[t];return void 0===n?t:n}var r={en:"C",de:t,fr:e},o=/msgid\s+"(.*?)"\nmsgstr\s+"(.*?)"\n/g,s=function(){for(var t=0;t<navigator.languages;++t){var e=navigator.languages[t].split("-")[0];if(r[e])return e}return(navigator.language||navigator.userLanguage).split("-")[0]}();return function(t){if(r[t])for(var e=n(o,r[t]),i=r[t]={},s=0,a=e.length;s<a;++s)e[s][2].length&&(i[e[s][1]]=e[s][2])}(s),i}),define("x_ite/Browser/Core/BrowserTimings",["jquery","x_ite/Fields/SFBool","x_ite/Basic/X3DBaseNode","locale/gettext"],function(t,e,n,i){"use strict";function r(t){return Math.floor(100*t)/100}function o(t){n.call(this,t),this.addChildObjects("enabled",new e)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,getTypeName:function(){return"BrowserTimings"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"browserTimings"},initialize:function(){n.prototype.initialize.call(this),this.enabled_.addInterest("set_enabled__",this),this.localeOptions={minimumFractionDigits:2,maximumFractionDigits:2},this.type=this.getBrowser().getLocalStorage()["BrowserTimings.type"]||"LESS",this.startTime=0,this.frames=0,this.element=t("<div></div>").addClass("x_ite-private-browser-timings").appendTo(this.getBrowser().getElement().find(".x_ite-private-surface")),this.table=t("<table></table>").appendTo(this.element),this.header=t("<thead></thead>").append(t("<tr></tr>").append(t("<th colspan='2'></th>"))).appendTo(this.table),this.body=t("<tbody></tbody>").appendTo(this.table),this.footer=t("<tfoot></tfoot>").append(t("<tr></tr>").append(t("<td colspan='2'></td>"))).appendTo(this.table),this.button=t("<button></button>").click(this.set_type__.bind(this)).appendTo(this.footer.find("td")),this.rows=[],this.set_button__(),this.getBrowser().getLocalStorage()["BrowserTimings.enabled"]&&(this.enabled_=!0)},setEnabled:function(t){this.enabled_=t},getEnabled:function(){return this.enabled_.getValue()},set_enabled__:function(t){this.getBrowser().getBrowserOptions().getTimings()&&(this.getBrowser().getLocalStorage()["BrowserTimings.enabled"]=t.getValue(),t.getValue()?(this.element.fadeIn(),this.getBrowser().prepareEvents().addInterest("update",this),this.update()):(this.element.fadeOut(),this.getBrowser().prepareEvents().removeInterest("update",this)))},set_type__:function(){"MORE"===this.type?this.type="LESS":this.type="MORE",this.getBrowser().getLocalStorage()["BrowserTimings.type"]=this.type,this.set_button__(),this.build()},set_button__:function(){"MORE"===this.type?this.button.text(i("Less Properties")):this.button.text(i("More Properties"))},update:function(){var t=this.getBrowser().getCurrentTime();t-this.startTime>1?(this.build(),this.frames=0,this.startTime=t):++this.frames},build:function(){var e=this.getBrowser(),n=e.getCurrentTime(),o=navigator.language||navigator.userLanguage,s=this.localeOptions,a=this.rows,u=0;if(a[u++]=t("<tr></tr>").append(t("<td></td>").text(i("Frame rate")+":")).append(t("<td></td>").text(r(this.frames/(n-this.startTime)).toLocaleString(o,s)+" "+i("fps"))),a[u++]=t("<tr></tr>").append(t("<td></td>").text(i("Speed")+":")).append(t("<td></td>").text(r(this.getSpeed(e.currentSpeed)).toLocaleString(o,s)+" "+this.getSpeedUnit(e.currentSpeed))),"MORE"===this.type){for(var l=e.getWorld().getLayerSet().getLayers(),c=e.getActiveLayer(),h=e.systemTime,d=c&&e.getCollisionCount()?c.collisionTime:0,p=e.collisionTime+d,f=e.browserTime-(e.cameraTime+e.collisionTime+e.displayTime+d),g=e.prepareEvents().getInterests().size-1,m=e.sensorEvents().getInterests().size,x=0,v=0,_=0;_<l.length;++_){var y=l[_];x+=y.numOpaqueShapes,v+=y.numTransparentShapes}a[1].addClass("x_ite-private-more"),a[u++]=t("<tr></tr>").append(t("<td></td>").text(i("Browser")+":")).append(t("<td></td>").text(r(h).toLocaleString(o,s)+" "+i("ms"))),a[u++]=t("<tr></tr>").append(t("<td></td>").text(i("X3D")+":")).append(t("<td></td>").text(r(e.browserTime).toLocaleString(o,s)+" "+i("ms"))),a[u++]=t("<tr></tr>").append(t("<td></td>").text(i("Routing")+":")).append(t("<td></td>").text(r(f).toLocaleString(o,s)+" "+i("ms"))),a[u++]=t("<tr></tr>").append(t("<td></td>").text(i("Pointer")+":")).append(t("<td></td>").text(r(e.pointerTime).toLocaleString(o,s)+" "+i("ms"))),a[u++]=t("<tr></tr>").append(t("<td></td>").text(i("Camera")+":")).append(t("<td></td>").text(r(e.cameraTime).toLocaleString(o,s)+" "+i("ms"))),a[u++]=t("<tr></tr>").append(t("<td></td>").text(i("Picking")+":")).append(t("<td></td>").text(r(e.pickingTime).toLocaleString(o,s)+" "+i("ms"))),a[u++]=t("<tr></tr>").append(t("<td></td>").text(i("Collision")+":")).append(t("<td></td>").text(r(p).toLocaleString(o,s)+" "+i("ms"))),a[u++]=t("<tr></tr>").append(t("<td></td>").text(i("Display")+":")).append(t("<td></td>").text(r(e.displayTime).toLocaleString(o,s)+" "+i("ms"))),a[u++]=t("<tr></tr>").append(t("<td></td>").text(i("Shapes")+":")).append(t("<td></td>").text(x+" + "+v)),a[u++]=t("<tr></tr>").append(t("<td></td>").text(i("Sensors")+":")).append(t("<td></td>").text(g+m))}a.length=u,this.header.find("th").text(i("Browser Timings")),this.body.empty(),this.body.append(a)},getSpeed:function(t){return t<15?t:3.6*t},getSpeedUnit:function(t){return i(t<15?"m/s":"km/h")}}),o}),function(t){"function"==typeof define&&define.amd?define("contextMenu/dist/jquery.contextMenu",["jquery"],t):t("object"==typeof exports?require("jquery"):jQuery)}(function(t){"use strict";function e(t){for(var e,n=t.split(/\s+/),i=[],r=0;e=n[r];r++)e=e.charAt(0).toUpperCase(),i.push(e);return i}function n(e){return e.id&&t('label[for="'+e.id+'"]').val()||e.name}function i(e,r,o){return o||(o=0),r.each(function(){var r,s,a=t(this),u=this,l=this.nodeName.toLowerCase();switch("label"===l&&a.find("input, textarea, select").length&&(r=a.text(),a=a.children().first(),u=a.get(0),l=u.nodeName.toLowerCase()),l){case"menu":s={name:a.attr("label"),items:{}},o=i(s.items,a.children(),o);break;case"a":case"button":s={name:a.text(),disabled:!!a.attr("disabled"),callback:function(){return function(){a.get(0).click()}}()};break;case"menuitem":case"command":switch(a.attr("type")){case void 0:case"command":case"menuitem":s={name:a.attr("label"),disabled:!!a.attr("disabled"),icon:a.attr("icon"),callback:function(){return function(){a.get(0).click()}}()};break;case"checkbox":s={type:"checkbox",disabled:!!a.attr("disabled"),name:a.attr("label"),selected:!!a.attr("checked")};break;case"radio":s={type:"radio",disabled:!!a.attr("disabled"),name:a.attr("label"),radio:a.attr("radiogroup"),value:a.attr("id"),selected:!!a.attr("checked")};break;default:s=void 0}break;case"hr":s="-------";break;case"input":switch(a.attr("type")){case"text":s={type:"text",name:r||n(u),disabled:!!a.attr("disabled"),value:a.val()};break;case"checkbox":s={type:"checkbox",name:r||n(u),disabled:!!a.attr("disabled"),selected:!!a.attr("checked")};break;case"radio":s={type:"radio",name:r||n(u),disabled:!!a.attr("disabled"),radio:!!a.attr("name"),value:a.val(),selected:!!a.attr("checked")};break;default:s=void 0}break;case"select":s={type:"select",name:r||n(u),disabled:!!a.attr("disabled"),selected:a.val(),options:{}},a.children().each(function(){s.options[this.value]=t(this).text()});break;case"textarea":s={type:"textarea",name:r||n(u),disabled:!!a.attr("disabled"),value:a.val()};break;case"label":break;default:s={type:"html",html:a.clone(!0)}}s&&(o++,e["key"+o]=s)}),o}t.support.htmlMenuitem="HTMLMenuItemElement"in window,t.support.htmlCommand="HTMLCommandElement"in window,t.support.eventSelectstart="onselectstart"in document.documentElement,t.ui&&t.widget||(t.cleanData=function(e){return function(n){var i,r,o;for(o=0;null!=n[o];o++){r=n[o];try{i=t._data(r,"events"),i&&i.remove&&t(r).triggerHandler("remove")}catch(t){}}e(n)}}(t.cleanData));var r=null,o=!1,s=t(window),a=0,u={},l={},c={},h={selector:null,appendTo:null,trigger:"right",autoHide:!1,delay:200,reposition:!0,hideOnSecondTrigger:!1,selectableSubMenu:!1,classNames:{hover:"context-menu-hover",disabled:"context-menu-disabled",visible:"context-menu-visible",notSelectable:"context-menu-not-selectable",icon:"context-menu-icon",iconEdit:"context-menu-icon-edit",iconCut:"context-menu-icon-cut",iconCopy:"context-menu-icon-copy",iconPaste:"context-menu-icon-paste",iconDelete:"context-menu-icon-delete",iconAdd:"context-menu-icon-add",iconQuit:"context-menu-icon-quit",iconLoadingClass:"context-menu-icon-loading"},determinePosition:function(e){if(t.ui&&t.ui.position)e.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none");else{var n=this.offset();n.top+=this.outerHeight(),n.left+=this.outerWidth()/2-e.outerWidth()/2,e.css(n)}},position:function(t,e,n){var i;if(!e&&!n)return void t.determinePosition.call(this,t.$menu);if("maintain"===e&&"maintain"===n)i=t.$menu.position();else{var r=t.$menu.offsetParent().offset();i={top:n-r.top,left:e-r.left}}var o=s.scrollTop()+s.height(),a=s.scrollLeft()+s.width(),u=t.$menu.outerHeight(),l=t.$menu.outerWidth();i.top+u>o&&(i.top-=u),i.top<0&&(i.top=0),i.left+l>a&&(i.left-=l),i.left<0&&(i.left=0),t.$menu.css(i)},positionSubmenu:function(e){if(void 0!==e)if(t.ui&&t.ui.position)e.css("display","block").position({my:"left top-5",at:"right top",of:this,collision:"flipfit fit"}).css("display","");else{var n={top:-9,left:this.outerWidth()-5};e.css(n)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{preShow:t.noop,show:t.noop,hide:t.noop,activated:t.noop},callback:null,items:{}},d={timer:null,pageX:null,pageY:null},p=function(t){for(var e=0,n=t;;)if(e=Math.max(e,parseInt(n.css("z-index"),10)||0),!(n=n.parent())||!n.length||"html body".indexOf(n.prop("nodeName").toLowerCase())>-1)break;return e},f={abortevent:function(t){t.preventDefault(),t.stopImmediatePropagation()},contextmenu:function(e){var n=t(this);if(e.data.events.preShow(n,e)!==!1&&("right"===e.data.trigger&&(e.preventDefault(),e.stopImmediatePropagation()),!("right"!==e.data.trigger&&"demand"!==e.data.trigger&&e.originalEvent||!(void 0===e.mouseButton||!e.data||"left"===e.data.trigger&&0===e.mouseButton||"right"===e.data.trigger&&2===e.mouseButton)||n.hasClass("context-menu-active")||n.hasClass("context-menu-disabled")))){if(r=n,e.data.build){var i=e.data.build(r,e);if(i===!1)return;if(e.data=t.extend(!0,{},h,e.data,i||{}),!e.data.items||t.isEmptyObject(e.data.items))throw window.console&&(console.error||console.log).call(console,"No items specified to show in contextMenu"),new Error("No Items specified");e.data.$trigger=r,g.create(e.data)}g.show.call(n,e.data,e.pageX,e.pageY)}},click:function(e){e.preventDefault(),e.stopImmediatePropagation(),t(this).trigger(t.Event("contextmenu",{data:e.data,pageX:e.pageX,pageY:e.pageY}))},mousedown:function(e){var n=t(this);r&&r.length&&!r.is(n)&&r.data("contextMenu").$menu.trigger("contextmenu:hide"),2===e.button&&(r=n.data("contextMenuActive",!0))},mouseup:function(e){var n=t(this);n.data("contextMenuActive")&&r&&r.length&&r.is(n)&&!n.hasClass("context-menu-disabled")&&(e.preventDefault(),e.stopImmediatePropagation(),r=n,n.trigger(t.Event("contextmenu",{data:e.data,pageX:e.pageX,pageY:e.pageY}))),n.removeData("contextMenuActive")},mouseenter:function(e){var n=t(this),i=t(e.relatedTarget),o=t(document);i.is(".context-menu-list")||i.closest(".context-menu-list").length||r&&r.length||(d.pageX=e.pageX,d.pageY=e.pageY,d.data=e.data,o.on("mousemove.contextMenuShow",f.mousemove),d.timer=setTimeout(function(){d.timer=null,o.off("mousemove.contextMenuShow"),r=n,n.trigger(t.Event("contextmenu",{data:d.data,pageX:d.pageX,pageY:d.pageY}))},e.data.delay))},mousemove:function(t){d.pageX=t.pageX,d.pageY=t.pageY},mouseleave:function(e){var n=t(e.relatedTarget);if(!n.is(".context-menu-list")&&!n.closest(".context-menu-list").length){try{clearTimeout(d.timer)}catch(t){}d.timer=null}},layerClick:function(e){var n,i,r=t(this),o=r.data("contextMenuRoot"),a=e.button,u=e.pageX,l=e.pageY,c=void 0===u;e.preventDefault(),setTimeout(function(){if(c)return void(null!==o&&void 0!==o&&null!==o.$menu&&void 0!==o.$menu&&o.$menu.trigger("contextmenu:hide"));var r,h="left"===o.trigger&&0===a||"right"===o.trigger&&2===a;if(document.elementFromPoint&&o.$layer){if(o.$layer.hide(),n=document.elementFromPoint(u-s.scrollLeft(),l-s.scrollTop()),n.isContentEditable){var d=document.createRange(),p=window.getSelection();d.selectNode(n),d.collapse(!0),p.removeAllRanges(),p.addRange(d)}t(n).trigger(e),o.$layer.show()}if(o.hideOnSecondTrigger&&h&&null!==o.$menu&&void 0!==o.$menu)return void o.$menu.trigger("contextmenu:hide");if(o.reposition&&h)if(document.elementFromPoint){if(o.$trigger.is(n))return void o.position.call(o.$trigger,o,u,l)}else if(i=o.$trigger.offset(),r=t(window),i.top+=r.scrollTop(),i.top<=e.pageY&&(i.left+=r.scrollLeft(),i.left<=e.pageX&&(i.bottom=i.top+o.$trigger.outerHeight(),i.bottom>=e.pageY&&(i.right=i.left+o.$trigger.outerWidth(),i.right>=e.pageX))))return void o.position.call(o.$trigger,o,u,l);n&&h&&o.$trigger.one("contextmenu:hidden",function(){t(n).contextMenu({x:u,y:l,button:a})}),null!==o&&void 0!==o&&null!==o.$menu&&void 0!==o.$menu&&o.$menu.trigger("contextmenu:hide")},50)},keyStop:function(t,e){e.isInput||t.preventDefault(),t.stopPropagation()},key:function(t){var e={};r&&(e=r.data("contextMenu")||{}),void 0===e.zIndex&&(e.zIndex=0);var n=0,i=function(t){""!==t.style.zIndex?n=t.style.zIndex:null!==t.offsetParent&&void 0!==t.offsetParent?i(t.offsetParent):null!==t.parentElement&&void 0!==t.parentElement&&i(t.parentElement)};if(i(t.target),!(e.$menu&&parseInt(n,10)>parseInt(e.$menu.css("zIndex"),10))){switch(t.keyCode){case 9:case 38:if(f.keyStop(t,e),e.isInput){if(9===t.keyCode&&t.shiftKey)return t.preventDefault(),e.$selected&&e.$selected.find("input, textarea, select").blur(),void(null!==e.$menu&&void 0!==e.$menu&&e.$menu.trigger("prevcommand"));if(38===t.keyCode&&"checkbox"===e.$selected.find("input, textarea, select").prop("type"))return void t.preventDefault()}else if(9!==t.keyCode||t.shiftKey)return void(null!==e.$menu&&void 0!==e.$menu&&e.$menu.trigger("prevcommand"));break;case 40:if(f.keyStop(t,e),!e.isInput)return void(null!==e.$menu&&void 0!==e.$menu&&e.$menu.trigger("nextcommand"));if(9===t.keyCode)return t.preventDefault(),e.$selected&&e.$selected.find("input, textarea, select").blur(),void(null!==e.$menu&&void 0!==e.$menu&&e.$menu.trigger("nextcommand"));if(40===t.keyCode&&"checkbox"===e.$selected.find("input, textarea, select").prop("type"))return void t.preventDefault();break;case 37:if(f.keyStop(t,e),e.isInput||!e.$selected||!e.$selected.length)break;if(!e.$selected.parent().hasClass("context-menu-root")){var o=e.$selected.parent().parent();return e.$selected.trigger("contextmenu:blur"),void(e.$selected=o)}break;case 39:if(f.keyStop(t,e),e.isInput||!e.$selected||!e.$selected.length)break;var s=e.$selected.data("contextMenu")||{};if(s.$menu&&e.$selected.hasClass("context-menu-submenu"))return e.$selected=null,s.$selected=null,void s.$menu.trigger("nextcommand");break;case 35:case 36:return e.$selected&&e.$selected.find("input, textarea, select").length?void 0:((e.$selected&&e.$selected.parent()||e.$menu).children(":not(."+e.classNames.disabled+", ."+e.classNames.notSelectable+")")[36===t.keyCode?"first":"last"]().trigger("contextmenu:focus"),void t.preventDefault());case 13:if(f.keyStop(t,e),e.isInput){if(e.$selected&&!e.$selected.is("textarea, select"))return void t.preventDefault();break}return void(void 0!==e.$selected&&null!==e.$selected&&e.$selected.trigger("mouseup"));case 32:case 33:case 34:return void f.keyStop(t,e);case 27:return f.keyStop(t,e),void(null!==e.$menu&&void 0!==e.$menu&&e.$menu.trigger("contextmenu:hide"));default:var a=String.fromCharCode(t.keyCode).toUpperCase();if(e.accesskeys&&e.accesskeys[a])return void e.accesskeys[a].$node.trigger(e.accesskeys[a].$menu?"contextmenu:focus":"mouseup")}t.stopPropagation(),void 0!==e.$selected&&null!==e.$selected&&e.$selected.trigger(t)}},prevItem:function(e){e.stopPropagation();var n=t(this).data("contextMenu")||{},i=t(this).data("contextMenuRoot")||{};if(n.$selected){var r=n.$selected;n=n.$selected.parent().data("contextMenu")||{},n.$selected=r}for(var o=n.$menu.children(),s=n.$selected&&n.$selected.prev().length?n.$selected.prev():o.last(),a=s;s.hasClass(i.classNames.disabled)||s.hasClass(i.classNames.notSelectable)||s.is(":hidden");)if(s=s.prev().length?s.prev():o.last(),s.is(a))return;n.$selected&&f.itemMouseleave.call(n.$selected.get(0),e),f.itemMouseenter.call(s.get(0),e);var u=s.find("input, textarea, select");u.length&&u.focus()},nextItem:function(e){e.stopPropagation();var n=t(this).data("contextMenu")||{},i=t(this).data("contextMenuRoot")||{};if(n.$selected){var r=n.$selected;n=n.$selected.parent().data("contextMenu")||{},n.$selected=r}for(var o=n.$menu.children(),s=n.$selected&&n.$selected.next().length?n.$selected.next():o.first(),a=s;s.hasClass(i.classNames.disabled)||s.hasClass(i.classNames.notSelectable)||s.is(":hidden");)if(s=s.next().length?s.next():o.first(),s.is(a))return;n.$selected&&f.itemMouseleave.call(n.$selected.get(0),e),f.itemMouseenter.call(s.get(0),e);var u=s.find("input, textarea, select");u.length&&u.focus()},focusInput:function(){var e=t(this).closest(".context-menu-item"),n=e.data(),i=n.contextMenu,r=n.contextMenuRoot;r.$selected=i.$selected=e,r.isInput=i.isInput=!0},blurInput:function(){var e=t(this).closest(".context-menu-item"),n=e.data(),i=n.contextMenu;n.contextMenuRoot.isInput=i.isInput=!1},menuMouseenter:function(){t(this).data().contextMenuRoot.hovering=!0},menuMouseleave:function(e){var n=t(this).data().contextMenuRoot;n.$layer&&n.$layer.is(e.relatedTarget)&&(n.hovering=!1)},itemMouseenter:function(e){var n=t(this),i=n.data(),r=i.contextMenu,o=i.contextMenuRoot;if(o.hovering=!0,e&&o.$layer&&o.$layer.is(e.relatedTarget)&&(e.preventDefault(),e.stopImmediatePropagation()),(r.$menu?r:o).$menu.children("."+o.classNames.hover).trigger("contextmenu:blur").children(".hover").trigger("contextmenu:blur"),n.hasClass(o.classNames.disabled)||n.hasClass(o.classNames.notSelectable))return void(r.$selected=null);n.trigger("contextmenu:focus")},itemMouseleave:function(e){var n=t(this),i=n.data(),r=i.contextMenu,o=i.contextMenuRoot;if(o!==r&&o.$layer&&o.$layer.is(e.relatedTarget))return void 0!==o.$selected&&null!==o.$selected&&o.$selected.trigger("contextmenu:blur"),e.preventDefault(),e.stopImmediatePropagation(),void(o.$selected=r.$selected=r.$node);r&&r.$menu&&r.$menu.hasClass("context-menu-visible")||n.trigger("contextmenu:blur")},itemClick:function(e){var n,i=t(this),r=i.data(),o=r.contextMenu,s=r.contextMenuRoot,a=r.contextMenuKey;if(!(!o.items[a]||i.is("."+s.classNames.disabled+", .context-menu-separator, ."+s.classNames.notSelectable)||i.is(".context-menu-submenu")&&s.selectableSubMenu===!1)){if(e.preventDefault(),e.stopImmediatePropagation(),t.isFunction(o.callbacks[a])&&Object.prototype.hasOwnProperty.call(o.callbacks,a))n=o.callbacks[a];else{if(!t.isFunction(s.callback))return;n=s.callback}n.call(s.$trigger,a,s,e)!==!1?s.$menu.trigger("contextmenu:hide"):s.$menu.parent().length&&g.update.call(s.$trigger,s)}},inputClick:function(t){t.stopImmediatePropagation()},hideMenu:function(e,n){var i=t(this).data("contextMenuRoot");g.hide.call(i.$trigger,i,n&&n.force)},focusItem:function(e){e.stopPropagation();var n=t(this),i=n.data(),r=i.contextMenu,o=i.contextMenuRoot;n.hasClass(o.classNames.disabled)||n.hasClass(o.classNames.notSelectable)||(n.addClass([o.classNames.hover,o.classNames.visible].join(" ")).parent().find(".context-menu-item").not(n).removeClass(o.classNames.visible).filter("."+o.classNames.hover).trigger("contextmenu:blur"),r.$selected=o.$selected=n,r&&r.$node&&r.$node.hasClass("context-menu-submenu")&&r.$node.addClass(o.classNames.hover),r.$node&&o.positionSubmenu.call(r.$node,r.$menu))},blurItem:function(e){e.stopPropagation();var n=t(this),i=n.data(),r=i.contextMenu,o=i.contextMenuRoot;r.autoHide&&n.removeClass(o.classNames.visible),n.removeClass(o.classNames.hover),r.$selected=null}},g={show:function(e,n,i){var o=t(this),s={};if(t("#context-menu-layer").trigger("mousedown"),e.$trigger=o,e.events.show.call(o,e)===!1)return void(r=null);if(g.update.call(o,e)===!1)return void(r=null);if(e.position.call(o,e,n,i),e.zIndex){var a=e.zIndex;"function"==typeof e.zIndex&&(a=e.zIndex.call(o,e)),s.zIndex=p(o)+a}g.layer.call(e.$menu,e,s.zIndex),e.$menu.find("ul").css("zIndex",s.zIndex+1),e.$menu.css(s)[e.animation.show](e.animation.duration,function(){o.trigger("contextmenu:visible"),g.activated(e),e.events.activated(e)}),o.data("contextMenu",e).addClass("context-menu-active"),t(document).off("keydown.contextMenu").on("keydown.contextMenu",f.key),e.autoHide&&t(document).on("mousemove.contextMenuAutoHide",function(t){var n=o.offset();n.right=n.left+o.outerWidth(),n.bottom=n.top+o.outerHeight(),!e.$layer||e.hovering||t.pageX>=n.left&&t.pageX<=n.right&&t.pageY>=n.top&&t.pageY<=n.bottom||setTimeout(function(){e.hovering||null===e.$menu||void 0===e.$menu||e.$menu.trigger("contextmenu:hide")},50)})},hide:function(e,n){var i=t(this);if(e||(e=i.data("contextMenu")||{}),n||!e.events||e.events.hide.call(i,e)!==!1){if(i.removeData("contextMenu").removeClass("context-menu-active"),e.$layer){setTimeout(function(t){return function(){t.remove()}}(e.$layer),10);try{delete e.$layer}catch(t){e.$layer=null}}r=null,e.$menu.find("."+e.classNames.hover).trigger("contextmenu:blur"),e.$selected=null,e.$menu.find("."+e.classNames.visible).removeClass(e.classNames.visible),t(document).off(".contextMenuAutoHide").off("keydown.contextMenu"),e.$menu&&e.$menu[e.animation.hide](e.animation.duration,function(){e.build&&(e.$menu.remove(),t.each(e,function(t){switch(t){case"ns":case"selector":case"build":case"trigger":return!0;default:e[t]=void 0;try{delete e[t]}catch(t){}return!0}})),setTimeout(function(){i.trigger("contextmenu:hidden")},10)})}},create:function(n,i){function r(e){var n=t("<span></span>");if(e._accesskey)e._beforeAccesskey&&n.append(document.createTextNode(e._beforeAccesskey)),t("<span></span>").addClass("context-menu-accesskey").text(e._accesskey).appendTo(n),e._afterAccesskey&&n.append(document.createTextNode(e._afterAccesskey));else if(e.isHtmlName){if(void 0!==e.accesskey)throw new Error("accesskeys are not compatible with HTML names and cannot be used together in the same item");n.html(e.name)}else n.text(e.name);return n}void 0===i&&(i=n),n.$menu=t('<ul class="context-menu-list"></ul>').addClass(n.className||"").data({contextMenu:n,contextMenuRoot:i}),t.each(["callbacks","commands","inputs"],function(t,e){n[e]={},i[e]||(i[e]={})}),i.accesskeys||(i.accesskeys={}),t.each(n.items,function(o,s){var a=t('<li class="context-menu-item"></li>').addClass(s.className||""),u=null,l=null;if(a.on("click",t.noop),"string"!=typeof s&&"cm_separator"!==s.type||(s={type:"cm_seperator"}),s.$node=a.data({contextMenu:n,contextMenuRoot:i,contextMenuKey:o}),void 0!==s.accesskey)for(var h,d=e(s.accesskey),p=0;h=d[p];p++)if(!i.accesskeys[h]){i.accesskeys[h]=s;var m=s.name.match(new RegExp("^(.*?)("+h+")(.*)$","i"));m&&(s._beforeAccesskey=m[1],s._accesskey=m[2],s._afterAccesskey=m[3]);break}if(s.type&&c[s.type])c[s.type].call(a,s,n,i),t.each([n,i],function(e,i){i.commands[o]=s,!t.isFunction(s.callback)||void 0!==i.callbacks[o]&&void 0!==n.type||(i.callbacks[o]=s.callback)});else{switch("cm_seperator"===s.type?a.addClass("context-menu-separator "+i.classNames.notSelectable):"html"===s.type?a.addClass("context-menu-html "+i.classNames.notSelectable):"sub"!==s.type&&s.type?(u=t("<label></label>").appendTo(a),r(s).appendTo(u),a.addClass("context-menu-input"),n.hasTypes=!0,t.each([n,i],function(t,e){e.commands[o]=s,e.inputs[o]=s})):s.items&&(s.type="sub"),s.type){case"cm_seperator":break;case"text":l=t('<input type="text" value="1" name="" />').attr("name","context-menu-input-"+o).val(s.value||"").appendTo(u);break;case"textarea":l=t('<textarea name=""></textarea>').attr("name","context-menu-input-"+o).val(s.value||"").appendTo(u),s.height&&l.height(s.height);break;case"checkbox":l=t('<input type="checkbox" value="1" name="" />').attr("name","context-menu-input-"+o).val(s.value||"").prop("checked",!!s.selected).prependTo(u);break;case"radio":l=t('<input type="radio" value="1" name="" />').attr("name","context-menu-input-"+s.radio).val(s.value||"").prop("checked",!!s.selected).prependTo(u);break;case"select":l=t('<select name=""></select>').attr("name","context-menu-input-"+o).appendTo(u),s.options&&(t.each(s.options,function(e,n){t("<option></option>").val(e).text(n).appendTo(l)}),l.val(s.selected));break;case"sub":r(s).appendTo(a),s.appendTo=s.$node,a.data("contextMenu",s).addClass("context-menu-submenu"),s.callback=null,"function"==typeof s.items.then?g.processPromises(s,i,s.items):g.create(s,i);break;case"html":t(s.html).appendTo(a);break;default:t.each([n,i],function(e,i){i.commands[o]=s,!t.isFunction(s.callback)||void 0!==i.callbacks[o]&&void 0!==n.type||(i.callbacks[o]=s.callback)}),r(s).appendTo(a)}s.type&&"sub"!==s.type&&"html"!==s.type&&"cm_seperator"!==s.type&&(l.on("focus",f.focusInput).on("blur",f.blurInput),s.events&&l.on(s.events,n)),s.icon&&(t.isFunction(s.icon)?s._icon=s.icon.call(this,this,a,o,s):"string"!=typeof s.icon||"fab "!==s.icon.substring(0,4)&&"fas "!==s.icon.substring(0,4)&&"far "!==s.icon.substring(0,4)&&"fal "!==s.icon.substring(0,4)?"string"==typeof s.icon&&"fa-"===s.icon.substring(0,3)?s._icon=i.classNames.icon+" "+i.classNames.icon+"--fa fa "+s.icon:s._icon=i.classNames.icon+" "+i.classNames.icon+"-"+s.icon:(a.addClass(i.classNames.icon+" "+i.classNames.icon+"--fa5"),s._icon=t('<i class="'+s.icon+'"></i>')),"string"==typeof s._icon?a.addClass(s._icon):a.prepend(s._icon))}s.$input=l,s.$label=u,a.appendTo(n.$menu),!n.hasTypes&&t.support.eventSelectstart&&a.on("selectstart.disableTextSelect",f.abortevent)}),n.$node||n.$menu.css("display","none").addClass("context-menu-root"),n.$menu.appendTo(n.appendTo||document.body)},resize:function(e,n){var i;e.css({position:"absolute",display:"block"}),e.data("width",(i=e.get(0)).getBoundingClientRect?Math.ceil(i.getBoundingClientRect().width):e.outerWidth()+1),e.css({position:"static",minWidth:"0px",maxWidth:"100000px"}),e.find("> li > ul").each(function(){g.resize(t(this),!0)}),
n||e.find("ul").addBack().css({position:"",display:"",minWidth:"",maxWidth:""}).outerWidth(function(){return t(this).data("width")})},update:function(e,n){var i=this;void 0===n&&(n=e,g.resize(e.$menu));var r=!1;return e.$menu.children().each(function(){var o,s=t(this),a=s.data("contextMenuKey"),u=e.items[a],l=t.isFunction(u.disabled)&&u.disabled.call(i,a,n)||u.disabled===!0;if(o=t.isFunction(u.visible)?u.visible.call(i,a,n):void 0===u.visible||u.visible===!0,o&&(r=!0),s[o?"show":"hide"](),s[l?"addClass":"removeClass"](n.classNames.disabled),t.isFunction(u.icon)){s.removeClass(u._icon);var c=u.icon.call(this,i,s,a,u);"string"==typeof c?s.addClass(c):s.prepend(c)}if(u.type)switch(s.find("input, select, textarea").prop("disabled",l),u.type){case"text":case"textarea":u.$input.val(u.value||"");break;case"checkbox":case"radio":u.$input.val(u.value||"").prop("checked",!!u.selected);break;case"select":u.$input.val((0===u.selected?"0":u.selected)||"")}if(u.$menu){g.update.call(i,u,n)&&(r=!0)}}),r},layer:function(e,n){var i=e.$layer=t('<div id="context-menu-layer"></div>').css({height:s.height(),width:s.width(),display:"block",position:"fixed","z-index":n,top:0,left:0,opacity:0,filter:"alpha(opacity=0)","background-color":"#000"}).data("contextMenuRoot",e).insertBefore(this).on("contextmenu",f.abortevent).on("mousedown",f.layerClick);return void 0===document.body.style.maxWidth&&i.css({position:"absolute",height:t(document).height()}),i},processPromises:function(t,e,n){function i(t,e,n){void 0===n&&r(void 0),o(t,e,n)}function r(t,e,n){void 0===n?(n={error:{name:"No items and no error item",icon:"context-menu-icon context-menu-icon-quit"}},window.console&&(console.error||console.log).call(console,'When you reject a promise, provide an "items" object, equal to normal sub-menu items')):"string"==typeof n&&(n={error:{name:n}}),o(t,e,n)}function o(t,e,n){void 0!==e.$menu&&e.$menu.is(":visible")&&(t.$node.removeClass(e.classNames.iconLoadingClass),t.items=n,g.create(t,e,!0),g.update(t,e),e.positionSubmenu.call(t.$node,t.$menu))}t.$node.addClass(e.classNames.iconLoadingClass),n.then(i.bind(this,t,e),r.bind(this,t,e))},activated:function(e){var n=e.$menu,i=n.offset(),r=t(window).height(),o=t(window).scrollTop(),s=n.height();s>r?n.css({height:r+"px","overflow-x":"hidden","overflow-y":"auto",top:o+"px"}):(i.top<o||i.top+s>o+r)&&n.css({top:o+"px"})}};t.fn.contextMenu=function(e){var n=this,i=e;if(this.length>0)if(void 0===e)this.first().trigger("contextmenu");else if(void 0!==e.x&&void 0!==e.y)this.first().trigger(t.Event("contextmenu",{pageX:e.x,pageY:e.y,mouseButton:e.button}));else if("hide"===e){var r=this.first().data("contextMenu")?this.first().data("contextMenu").$menu:null;r&&r.trigger("contextmenu:hide")}else"destroy"===e?t.contextMenu("destroy",{context:this}):t.isPlainObject(e)?(e.context=this,t.contextMenu("create",e)):e?this.removeClass("context-menu-disabled"):e||this.addClass("context-menu-disabled");else t.each(l,function(){this.selector===n.selector&&(i.data=this,t.extend(i.data,{trigger:"demand"}))}),f.contextmenu.call(i.target,i);return this},t.contextMenu=function(e,n){"string"!=typeof e&&(n=e,e="create"),"string"==typeof n?n={selector:n}:void 0===n&&(n={});var i=t.extend(!0,{},h,n||{}),r=t(document),s=r,c=!1;switch(i.context&&i.context.length?(s=t(i.context).first(),i.context=s.get(0),c=!t(i.context).is(document)):i.context=document,e){case"update":if(c)g.update(s);else for(var d in l)l.hasOwnProperty(d)&&g.update(l[d]);break;case"create":if(!i.selector)throw new Error("No selector specified");if(i.selector.match(/.context-menu-(list|item|input)($|\s)/))throw new Error('Cannot bind to selector "'+i.selector+'" as it contains a reserved className');if(!i.build&&(!i.items||t.isEmptyObject(i.items)))throw new Error("No Items specified");if(a++,i.ns=".contextMenu"+a,c||(u[i.selector]=i.ns),l[i.ns]=i,i.trigger||(i.trigger="right"),!o){var p="click"===i.itemClickEvent?"click.contextMenu":"mouseup.contextMenu",m={"contextmenu:focus.contextMenu":f.focusItem,"contextmenu:blur.contextMenu":f.blurItem,"contextmenu.contextMenu":f.abortevent,"mouseenter.contextMenu":f.itemMouseenter,"mouseleave.contextMenu":f.itemMouseleave};m[p]=f.itemClick,r.on({"contextmenu:hide.contextMenu":f.hideMenu,"prevcommand.contextMenu":f.prevItem,"nextcommand.contextMenu":f.nextItem,"contextmenu.contextMenu":f.abortevent,"mouseenter.contextMenu":f.menuMouseenter,"mouseleave.contextMenu":f.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",f.inputClick).on(m,".context-menu-item"),o=!0}switch(s.on("contextmenu"+i.ns,i.selector,i,f.contextmenu),c&&s.on("remove"+i.ns,function(){t(this).contextMenu("destroy")}),i.trigger){case"hover":s.on("mouseenter"+i.ns,i.selector,i,f.mouseenter).on("mouseleave"+i.ns,i.selector,i,f.mouseleave);break;case"left":s.on("click"+i.ns,i.selector,i,f.click);break;case"touchstart":s.on("touchstart"+i.ns,i.selector,i,f.click)}i.build||g.create(i);break;case"destroy":var x;if(c){var v=i.context;t.each(l,function(e,n){if(!n)return!0;if(!t(v).is(n.selector))return!0;x=t(".context-menu-list").filter(":visible"),x.length&&x.data().contextMenuRoot.$trigger.is(t(n.context).find(n.selector))&&x.trigger("contextmenu:hide",{force:!0});try{l[n.ns].$menu&&l[n.ns].$menu.remove(),delete l[n.ns]}catch(t){l[n.ns]=null}return t(n.context).off(n.ns),!0})}else if(i.selector){if(u[i.selector]){x=t(".context-menu-list").filter(":visible"),x.length&&x.data().contextMenuRoot.$trigger.is(i.selector)&&x.trigger("contextmenu:hide",{force:!0});try{l[u[i.selector]].$menu&&l[u[i.selector]].$menu.remove(),delete l[u[i.selector]]}catch(t){l[u[i.selector]]=null}r.off(u[i.selector])}}else r.off(".contextMenu .contextMenuAutoHide"),t.each(l,function(e,n){t(n.context).off(n.ns)}),u={},l={},a=0,o=!1,t("#context-menu-layer, .context-menu-list").remove();break;case"html5":(!t.support.htmlCommand&&!t.support.htmlMenuitem||"boolean"==typeof n&&n)&&t('menu[type="context"]').each(function(){this.id&&t.contextMenu({selector:"[contextmenu="+this.id+"]",items:t.contextMenu.fromMenu(this)})}).css("display","none");break;default:throw new Error('Unknown operation "'+e+'"')}return this},t.contextMenu.setInputValues=function(e,n){void 0===n&&(n={}),t.each(e.inputs,function(t,e){switch(e.type){case"text":case"textarea":e.value=n[t]||"";break;case"checkbox":e.selected=!!n[t];break;case"radio":e.selected=(n[e.radio]||"")===e.value;break;case"select":e.selected=n[t]||""}})},t.contextMenu.getInputValues=function(e,n){return void 0===n&&(n={}),t.each(e.inputs,function(t,e){switch(e.type){case"text":case"textarea":case"select":n[t]=e.$input.val();break;case"checkbox":n[t]=e.$input.prop("checked");break;case"radio":e.$input.prop("checked")&&(n[e.radio]=e.value)}}),n},t.contextMenu.fromMenu=function(e){var n=t(e),r={};return i(r,n.children()),r},t.contextMenu.defaults=h,t.contextMenu.types=c,t.contextMenu.handle=f,t.contextMenu.op=g,t.contextMenu.menus=l}),define("contextMenu",["contextMenu/dist/jquery.contextMenu"],function(t){return t}),define("lib/jquery.fullscreen-min",["jquery"],function(t){function e(t){var e,n;return this.length?(e=this[0],e.ownerDocument?n=e.ownerDocument:(n=e,e=n.documentElement),null==t?n.exitFullscreen||n.webkitExitFullscreen||n.webkitCancelFullScreen||n.msExitFullscreen||n.mozCancelFullScreen?(t=!!(n.fullscreenElement||n.msFullscreenElement||n.webkitIsFullScreen||n.mozFullScreen),t?n.fullscreenElement||n.webkitFullscreenElement||n.webkitCurrentFullScreenElement||n.msFullscreenElement||n.mozFullScreenElement||t:t):null:(t?(t=e.requestFullscreen||e.webkitRequestFullscreen||e.webkitRequestFullScreen||e.msRequestFullscreen||e.mozRequestFullScreen)&&t.call(e):(t=n.exitFullscreen||n.webkitExitFullscreen||n.webkitCancelFullScreen||n.msExitFullscreen||n.mozCancelFullScreen)&&t.call(n),this)):this}t.fn.fullScreen=e,t.fn.toggleFullScreen=function(){return e.call(this,!e.call(this))};var n,i,r;n=document,n.webkitCancelFullScreen?(i="webkitfullscreenchange",r="webkitfullscreenerror"):n.msExitFullscreen?(i="MSFullscreenChange",r="MSFullscreenError"):n.mozCancelFullScreen?(i="mozfullscreenchange",r="mozfullscreenerror"):(i="fullscreenchange",r="fullscreenerror"),t(document).bind(i,function(){t(document).trigger(new t.Event("fullscreenchange"))}),t(document).bind(r,function(){t(document).trigger(new t.Event("fullscreenerror"))})}),define("x_ite/Browser/Core/ContextMenu",["jquery","contextMenu","x_ite/Basic/X3DBaseNode","locale/gettext","lib/jquery.fullscreen-min"],function(t,e,n,i){"use strict";function r(t){n.call(this,t)}return t("head").append('<style>.x_ite-private-menu-title:before { content: "'+i("X_ITE Browser")+'" }</style>'),r.prototype=Object.assign(Object.create(n.prototype),{constructor:r,getTypeName:function(){return"ContextMenu"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"contextMenu"},initialize:function(){n.prototype.initialize.call(this);var e=this.getBrowser();e.getBrowserOptions().getContextMenu()&&t.contextMenu({selector:".x_ite-private-surface-"+e.getId(),build:this.build.bind(this)})},build:function(e,n){var r=this.getBrowser(),o=r.getActiveLayer(),s=o?o.getViewpoint():null,a=r.viewer_.getValue(),u=r.getElement().fullScreen(),l={className:"x_ite-private-menu x_ite-private-menu-title",items:{separator0:"--------",viewpoints:{name:i("Viewpoints"),className:"context-menu-icon x_ite-private-icon-viewpoint",items:this.getViewpoints(),callback:function(e){t("body > ul.context-menu-list").fadeOut(500),e&&(r.bindViewpoint(e),r.getElement().focus())}.bind(this,s)},separator1:"--------",viewer:{name:i(this.getViewerName(a)),className:"context-menu-icon x_ite-private-icon-"+a.toLowerCase()+"-viewer",callback:function(e){t("body > ul.context-menu-list").fadeOut(500),r.viewer_=e,r.getNotification().string_=i(this.getViewerName(e)),r.getElement().focus()}.bind(this,a)},"available-viewers":{name:i("Available Viewers"),items:this.getAvailableViewers()},"straighten-horizon":{name:i("Straighten Horizon"),type:"checkbox",selected:r.getBrowserOption("StraightenHorizon"),events:{click:function(){t("body > ul.context-menu-list").fadeOut(500);var e=!r.getBrowserOption("StraightenHorizon");if(r.setBrowserOption("StraightenHorizon",e),e){r.getNotification().string_=i("Straighten Horizon")+": "+i("on");var n=r.getActiveViewpoint();n&&n.straighten(!0)}else r.getNotification().string_=i("Straighten Horizon")+": "+i("off")}.bind(this)}},separator2:"--------","primitive-quality":{name:i("Primitive Quality"),className:"context-menu-icon x_ite-private-icon-primitive-quality",items:{high:{name:i("High"),type:"radio",radio:"primitive-quality",selected:"HIGH"===r.getBrowserOption("PrimitiveQuality"),events:{click:function(){t("body > ul.context-menu-list").fadeOut(500),r.setBrowserOption("PrimitiveQuality","HIGH"),r.getNotification().string_=i("Primitive Quality")+": "+i("high")}.bind(this)}},medium:{name:i("Medium"),type:"radio",radio:"primitive-quality",selected:"MEDIUM"===r.getBrowserOption("PrimitiveQuality"),events:{click:function(){t("body > ul.context-menu-list").fadeOut(500),r.setBrowserOption("PrimitiveQuality","MEDIUM"),r.getNotification().string_=i("Primitive Quality")+": "+i("medium")}.bind(this)}},low:{name:i("Low"),type:"radio",radio:"primitive-quality",selected:"LOW"===r.getBrowserOption("PrimitiveQuality"),events:{click:function(){t("body > ul.context-menu-list").fadeOut(500),r.setBrowserOption("PrimitiveQuality","LOW"),r.getNotification().string_=i("Primitive Quality")+": "+i("low")}.bind(this)}}}},"texture-quality":{name:i("Texture Quality"),className:"context-menu-icon x_ite-private-icon-texture-quality",items:{high:{name:i("High"),type:"radio",radio:"texture-quality",selected:"HIGH"===r.getBrowserOption("TextureQuality"),events:{click:function(){t("body > ul.context-menu-list").fadeOut(500),r.setBrowserOption("TextureQuality","HIGH"),r.getNotification().string_=i("Texture Quality")+": "+i("high")}.bind(this)}},medium:{name:i("Medium"),type:"radio",radio:"texture-quality",selected:"MEDIUM"===r.getBrowserOption("TextureQuality"),events:{click:function(){t("body > ul.context-menu-list").fadeOut(500),r.setBrowserOption("TextureQuality","MEDIUM"),r.getNotification().string_=i("Texture Quality")+": "+i("medium")}.bind(this)}},low:{name:i("Low"),type:"radio",radio:"texture-quality",selected:"LOW"===r.getBrowserOption("TextureQuality"),events:{click:function(){t("body > ul.context-menu-list").fadeOut(500),r.setBrowserOption("TextureQuality","LOW"),r.getNotification().string_=i("Texture Quality")+": "+i("low")}.bind(this)}}}},"display-rubberband":{name:i("Display Rubberband"),type:"checkbox",selected:r.getBrowserOption("Rubberband"),events:{click:function(){t("body > ul.context-menu-list").fadeOut(500);var e=!r.getBrowserOption("Rubberband");r.setBrowserOption("Rubberband",e),r.getNotification().string_=e?i("Rubberband")+": "+i("on"):i("Rubberband")+": "+i("off")}.bind(this)}},"browser-timings":r.getBrowserOptions().getTimings()?{name:i("Browser Timings"),type:"checkbox",selected:r.getBrowserTimings().getEnabled(),events:{click:function(){t("body > ul.context-menu-list").fadeOut(500),r.getBrowserTimings().setEnabled(!r.getBrowserTimings().getEnabled()),r.getElement().focus()}.bind(this)}}:void 0,fullscreen:{name:i(u?"Leave Fullscreen":"Fullscreen"),className:"context-menu-icon "+(u?"x_ite-private-icon-leave-fullscreen":"x_ite-private-icon-fullscreen"),callback:function(){t("body > ul.context-menu-list").fadeOut(500),r.getElement().toggleFullScreen()}.bind(this)},separator3:"--------",about:{name:i("About X_ITE"),className:"context-menu-icon x_ite-private-icon-help-about",callback:function(){t("body > ul.context-menu-list").fadeOut(500),window.open("http://create3000.de/x_ite/")}}}};return t.isEmptyObject(l.items.viewpoints.items)&&(delete l.items.separator0,delete l.items.viewpoints),Object.keys(l.items["available-viewers"].items).length<2&&delete l.items["available-viewers"],"EXAMINE"==r.getCurrentViewer()&&"GeoViewpoint"!==r.getActiveViewpoint().getTypeName()||delete l.items["straighten-horizon"],l},getViewpoints:function(){var e=this.getBrowser(),n=e.getActiveLayer();if(!n)return{};for(var i=e.getBrowserOption("EnableInlineViewpoints"),r=e.currentScene,o=n.getViewpoints().get(),s=n.getViewpoint(),a={},u=0;u<o.length;++u){var l=o[u],c=l.description_.getValue();if(""!==c&&(i||l.getScene()===r)){var h={name:c,callback:function(n){t("body > ul.context-menu-list").fadeOut(500),e.bindViewpoint(n),e.getElement().focus()}.bind(this,l)};l===s&&(h.className="context-menu-selected"),a["Viewpoint"+l.getId()]=h}}return a},getAvailableViewers:function(){for(var e=this.getBrowser(),n=e.viewer_.getValue(),r=e.availableViewers_,o={},s=0;s<r.length;++s){var a=r[s];o[a]={name:i(this.getViewerName(a)),className:"context-menu-icon x_ite-private-icon-"+a.toLowerCase()+"-viewer",callback:function(n){t("body > ul.context-menu-list").fadeOut(500),e.viewer_=n,e.getNotification().string_=i(this.getViewerName(n)),e.getElement().focus()}.bind(this,a)},a===n&&(o[a].className+=" context-menu-selected")}return o},getViewerName:function(t){switch(t){case"EXAMINE":return i("Examine Viewer");case"WALK":return i("Walk Viewer");case"FLY":return i("Fly Viewer");case"PLANE":return i("Plane Viewer");case"LOOKAT":return i("Look At Viewer");case"NONE":return i("None Viewer")}}}),r}),define("x_ite/Execution/ImportedNode",["x_ite/Fields","x_ite/Basic/X3DBaseNode","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(t,e,n,i){"use strict";function r(t,n,i,r){e.call(this,t),this.inlineNode=n,this.exportedName=i,this.importedName=r,this.routes=new Map,this.inlineNode.loadState_.addInterest("set_loadState__",this)}return r.prototype=Object.assign(Object.create(e.prototype),{constructor:r,getTypeName:function(){return"ImportedNode"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"importedNodes"},getInlineNode:function(){return this.inlineNode},getExportedName:function(){return this.exportedName},getExportedNode:function(){return this.inlineNode.getInternalScene().getExportedNode(this.exportedName)},setImportedName:function(t){this.importedName=t},getImportedName:function(){return this.importedName},addRoute:function(t,e,i,r){var o=t.getId()+"."+e+" "+i.getId()+"."+r;this.routes.set(o,{sourceNode:t,sourceField:e,destinationNode:i,destinationField:r}),this.inlineNode.checkLoadState()===n.COMPLETE_STATE&&this.resolveRoute(o)},resolveRoute:function(t){try{var e=this.routes.get(t),n=e.sourceNode,i=e.sourceField,o=e.destinationNode,s=e.destinationField;e._route&&e._route.dispose(),n instanceof r&&(n=n.getExportedNode().getValue()),o instanceof r&&(o=o.getExportedNode().getValue()),e._route=this.getExecutionContext().addSimpleRoute(n,i,o,s)}catch(t){console.error(t.message)}},deleteRoutes:function(){this.routes.forEach(function(t){t._route&&(this.getExecutionContext().deleteRoute(t._route),delete t._route)},this)},set_loadState__:function(){switch(this.inlineNode.checkLoadState()){case n.NOT_STARTED_STATE:case n.FAILED_STATE:this.deleteRoutes();break;case n.COMPLETE_STATE:this.deleteRoutes(),this.routes.forEach(function(t,e){this.resolveRoute(e)},this)}},toVRMLStream:function(t){var e=i.Get(t);if(!e.ExistsNode(this.getInlineNode()))throw new Error("ImportedNode.toXMLStream: Inline node does not exist.");t.string+=e.Indent(),t.string+="IMPORT",t.string+=" ",t.string+=e.Name(this.getInlineNode()),t.string+=".",t.string+=this.getExportedName(),this.getImportedName()!==this.getExportedName()&&(t.string+=" ",t.string+="AS",t.string+=" ",t.string+=this.getImportedName());try{e.AddRouteNode(this),e.AddImportedNode(this.getExportedNode().getValue(),this.getImportedName())}catch(n){this.routes.forEach(function(n){var i=n.sourceNode,o=n.sourceField,s=n.destinationNode,a=n.destinationField;if(e.ExistsRouteNode(i)&&e.ExistsRouteNode(s)){if(i instanceof r)var u=i.getImportedName();else var u=e.Name(i);if(s instanceof r)var l=s.getImportedName();else var l=e.Name(s);t.string+="\n",t.string+="\n",t.string+=e.Indent(),t.string+="ROUTE",t.string+=" ",t.string+=u,t.string+=".",t.string+=o,t.string+=" ",t.string+="TO",t.string+=" ",t.string+=l,t.string+=".",t.string+=a}})}},toXMLStream:function(t){var e=i.Get(t);if(!e.ExistsNode(this.getInlineNode()))throw new Error("ImportedNode.toXMLStream: Inline node does not exist.");t.string+=e.Indent(),t.string+="<IMPORT",t.string+=" ",t.string+="inlineDEF='",t.string+=e.XMLEncode(e.Name(this.getInlineNode())),t.string+="'",t.string+=" ",t.string+="importedDEF='",t.string+=e.XMLEncode(this.getExportedName()),t.string+="'",this.getImportedName()!==this.getExportedName()&&(t.string+=" ",t.string+="AS='",t.string+=e.XMLEncode(this.getImportedName()),t.string+="'"),t.string+="/>";try{e.AddRouteNode(this),e.AddImportedNode(this.getExportedNode().getValue(),this.getImportedName())}catch(n){this.routes.forEach(function(n){var i=n.sourceNode,o=n.sourceField,s=n.destinationNode,a=n.destinationField;if(e.ExistsRouteNode(i)&&e.ExistsRouteNode(s)){if(i instanceof r)var u=i.getImportedName();else var u=e.Name(i);if(s instanceof r)var l=s.getImportedName();else var l=e.Name(s);t.string+="\n",t.string+="\n",t.string+=e.Indent(),t.string+="<ROUTE",t.string+=" ",t.string+="fromNode='",t.string+=e.XMLEncode(u),t.string+="'",t.string+=" ",t.string+="fromField='",t.string+=e.XMLEncode(o),t.string+="'",t.string+=" ",t.string+="toNode='",t.string+=e.XMLEncode(l),t.string+="'",t.string+=" ",t.string+="toField='",t.string+=e.XMLEncode(a),t.string+="'",t.string+="/>"}})}},dispose:function(){this.inlineNode.loadState_.removeInterest("set_loadState__",this),this.deleteRoutes(),e.prototype.dispose.call(this)}}),r}),define("x_ite/Configuration/X3DInfoArray",[],function(){"use strict";function t(){return this.array=[],this.index=new Map,new Proxy(this,e)}var e={get:function(t,e){var n=t[e];return void 0!==n?n:(n=t.array[e],void 0!==n?n:t.index.get(e))},set:function(t,e,n){return!1},has:function(t,e){return Number.isInteger(+e)?e<t.array.length:e in t},enumerate:function(t){for(var e=[],n=0,i=t.array.length;n<i;++n)array.push(n);return e[Symbol.iterator]()}};return Object.assign(t.prototype,{constructor:t,add:function(t,e){this.array.push(e),this.index.set(t,e)},get:function(t){return this.index.get(t)},getValue:function(){return this.array},toVRMLStream:function(t){this.array.forEach(function(e){try{e.toVRMLStream(t),t.string+="\n"}catch(t){console.log(t)}})},toXMLStream:function(t){this.array.forEach(function(e){try{e.toXMLStream(t),t.string+="\n"}catch(t){console.log(t)}})}}),t}),define("x_ite/Prototype/ExternProtoDeclarationArray",["x_ite/Configuration/X3DInfoArray"],function(t){"use strict";function e(e){return t.call(this)}return e.prototype=Object.assign(Object.create(t.prototype),{constructor:e,toVRMLStream:function(t){this.array.forEach(function(e){try{e.toVRMLStream(t),t.string+="\n",t.string+="\n"}catch(t){console.log(t)}})}}),e}),define("x_ite/Prototype/ProtoDeclarationArray",["x_ite/Configuration/X3DInfoArray"],function(t){"use strict";function e(e){return t.call(this)}return e.prototype=Object.assign(Object.create(t.prototype),{constructor:e,toVRMLStream:function(t){this.array.forEach(function(e){try{e.toVRMLStream(t),t.string+="\n",t.string+="\n"}catch(t){console.log(t)}})}}),e}),define("x_ite/Routing/RouteArray",[],function(){"use strict";function t(){return this.array=[],new Proxy(this,e)}var e={get:function(t,e){var n=t[e];return void 0!==n?n:t.array[e]},set:function(t,e,n){return!1},has:function(t,e){return Number.isInteger(+e)?e<t.array.length:e in t},enumerate:function(t){for(var e=[],n=0,i=t.array.length;n<i;++n)array.push(n);return e[Symbol.iterator]()}};return Object.assign(t.prototype,{constructor:t,getValue:function(){return this.array},toVRMLStream:function(t){this.array.forEach(function(e){try{e.toVRMLStream(t),t.string+="\n"}catch(t){console.log(t)}})},toXMLStream:function(t){this.array.forEach(function(e){try{e.toXMLStream(t),t.string+="\n"}catch(t){console.log(t)}})}}),t}),define("x_ite/Routing/X3DRoute",["x_ite/Fields","x_ite/Base/X3DObject","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(t,e,n,i){"use strict";function r(n,i,r,o,s){e.call(this,n),this._executionContext=n,this._sourceNode=new t.SFNode(i),this._sourceField=r,this._destinationNode=new t.SFNode(o),this._destinationField=s,r.addFieldInterest(s),r.addOutputRoute(this),s.addInputRoute(this)}return r.prototype=Object.assign(Object.create(e.prototype),{getTypeName:function(){return"X3DRoute"},getExecutionContext:function(){return this._executionContext},getSourceNode:function(){return this._sourceNode.valueOf()},getSourceField:function(){return this._sourceField.getName()},getDestinationNode:function(){return this._destinationNode.valueOf()},getDestinationField:function(){return this._destinationField.getName()},disconnect:function(){this._sourceField.removeFieldInterest(this._destinationField),this._sourceField.removeOutputRoute(this),this._destinationField.removeInputRoute(this)},toStream:function(t){t.string+=Object.prototype.toString.call(this)},toVRMLStream:function(t){var e=i.Get(t),r=e.LocalName(this._sourceNode.getValue()),o=e.LocalName(this._destinationNode.getValue());t.string+=e.Indent(),t.string+="ROUTE",t.string+=" ",t.string+=r,t.string+=".",t.string+=this._sourceField.getName(),this._sourceField.getAccessType()===n.inputOutput&&(t.string+="_changed"),t.string+=" ",t.string+="TO",t.string+=" ",t.string+=o,t.string+=".",this._destinationField.getAccessType()===n.inputOutput&&(t.string+="set_"),t.string+=this._destinationField.getName()},toXMLStream:function(t){var e=i.Get(t),r=e.LocalName(this._sourceNode.getValue()),o=e.LocalName(this._destinationNode.getValue());t.string+=e.Indent(),t.string+="<ROUTE",t.string+=" ",t.string+="fromNode='",t.string+=e.XMLEncode(r),t.string+="'",t.string+=" ",t.string+="fromField='",t.string+=e.XMLEncode(this._sourceField.getName()),this._sourceField.getAccessType()===n.inputOutput&&(t.string+="_changed"),t.string+="'",t.string+=" ",t.string+="toNode='",t.string+=e.XMLEncode(o),t.string+="'",t.string+=" ",t.string+="toField='",this._destinationField.getAccessType()===n.inputOutput&&(t.string+="set_"),t.string+=e.XMLEncode(this._destinationField.getName()),t.string+="'",t.string+="/>"},dispose:function(){this.disconnect(),this._executionContext.deleteRoute(this),e.prototype.dispose.call(this)}}),Object.defineProperty(r.prototype,"sourceNode",{get:function(){return this._sourceNode.valueOf()},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"sourceField",{get:function(){return this._sourceField.getName()},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"destinationNode",{get:function(){return this._destinationNode.valueOf()},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"destinationField",{get:function(){return this._destinationField.getName()},enumerable:!0,configurable:!1}),r}),define("x_ite/Bits/X3DCast",["x_ite/Fields"],function(t){"use strict";return function(e,n){try{if(n&&(n instanceof t.SFNode&&(n=n.getValue()),n&&(n=n.getInnerNode(),n.getType().indexOf(e)!==-1)))return n}catch(t){}return null}}),define("x_ite/Execution/X3DExecutionContext",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Basic/X3DBaseNode","x_ite/Execution/ImportedNode","x_ite/Prototype/ExternProtoDeclarationArray","x_ite/Prototype/ProtoDeclarationArray","x_ite/Routing/RouteArray","x_ite/Routing/X3DRoute","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator","x_ite/Fields/SFNodeCache","standard/Math/Algorithm"],function(t,e,n,i,r,o,s,a,u,l,c,h,d,p){"use strict";function f(e){i.call(this,e),this.addChildObjects("rootNodes",new t.MFNode),this.rootNodes_.addClones(1),this._uninitializedNodes=[],this._uninitializedNodes2=[],this._namedNodes=new Map,this._importedNodes=new Map,this._protos=new s,this._externprotos=new o,this._routes=new a,this._routeIndex=new Map}return f.prototype=Object.assign(Object.create(i.prototype),{constructor:f,setup:function(){i.prototype.setup.call(this);var t=require("x_ite/Prototype/X3DProtoDeclaration");if(this.constructor!==t)for(;this._uninitializedNodes.length;){var e=this._uninitializedNodes;this._uninitializedNodes=this._uninitializedNodes2,this._uninitializedNodes2=e;for(var n=0,r=e.length;n<r;++n)e[n].setup();e.length=0}},isMasterContext:function(){return!1},isRootContext:function(){return!1},getSpecificationVersion:function(){return this.getExecutionContext().getSpecificationVersion()},getEncoding:function(){return this.getExecutionContext().getEncoding()},getWorldURL:function(){return this.getURL().location},getURL:function(){return this.getExecutionContext().getURL()},getProfile:function(){return this.getExecutionContext().getProfile()},getComponents:function(){return this.getExecutionContext().getComponents()},fromUnit:function(t,e){return this.getExecutionContext().fromUnit(t,e)},toUnit:function(t,e){return this.getExecutionContext().toUnit(t,e)},getUnits:function(){return this.getExecutionContext().getUnits()},createNode:function(t,e){if(e===!1){var n=this.getBrowser().getSupportedNode(t);if(!n)return null;var i=new n(this);return i}var n=this.getBrowser().getSupportedNode(t);if(!n)throw new Error("Unknown node type '"+t+"'.");var i=new n(this);return i.setup(),d.add(i)},createProto:function(t,e){for(var n=this;;){var i=n.protos.get(t);if(i)return i.createInstance(this,e);var r=n.externprotos.get(t);if(r)return r.createInstance(this,e);if(n.isRootContext())break;n=n.getExecutionContext()}if(e===!1)return null;throw new Error("Unknown proto or externproto type '"+t+"'.")},addUninitializedNode:function(t){this._uninitializedNodes.push(t)},addNamedNode:function(t,e){if(this._namedNodes.has(t))throw new Error("Couldn't add named node: node named '"+t+"' is already in use.");this.updateNamedNode(t,e)},updateNamedNode:function(e,n){if(!(n instanceof t.SFNode||n instanceof i))throw new Error("Couldn't update named node: node must be of type SFNode.");e=String(e);var r=n instanceof t.SFNode?n.getValue():n;if(!r)throw new Error("Couldn't update named node: node IS NULL.");if(r.getExecutionContext()!==this)throw new Error("Couldn't update named node: node does not belong to this execution context.");if(0===e.length)throw new Error("Couldn't update named node: node name is empty.");this.removeNamedNode(r.getName()),this.removeNamedNode(e),r.setName(e),this._namedNodes.set(e,r)},removeNamedNode:function(t){this._namedNodes.delete(t)},getNamedNode:function(t){var e=this._namedNodes.get(t);if(e)return d.get(e);throw new Error("Named node '"+t+"' not found.")},getNamedNodes:function(){return this._namedNodes},getUniqueName:function(t){t=t.replace(/(_\d+$)/,"");for(var e=t,n=64;n&&(this._namedNodes.has(e)||0===e.length);){var i=n,r=n<<=1;e=t,e+="_",e+=Math.round(p.random(i,r))}return e},addImportedNode:function(t,e,n){if(void 0===n&&(n=e),this._importedNodes.has(n))throw new Error("Couldn't add imported node: imported name '"+n+"' already in use.");this.updateImportedNode(t,e,n)},updateImportedNode:function(t,e,n){if(t=l(c.Inline,t),e=String(e),n=void 0===n?e:String(n),!t)throw new Error("Node named is not an Inline node.");if(t.getExecutionContext()!==this)throw new Error("Couldn't update imported node: Inline node does not belong to this execution context.");if(0===e.length)throw new Error("Couldn't update imported node: exported name is empty.");if(0===n.length)throw new Error("Couldn't update imported node: imported name is empty.");for(var i of this._importedNodes){var o=i[0],s=i[1];if(s.getInlineNode()===t&&s.getExportedName()===e)return this._importedNodes.delete(o),this._importedNodes.set(n,s),void s.setImportedName(n)}this.removeImportedNode(n);var s=new r(this,t,e,n);this._importedNodes.set(n,s),s.setup()},removeImportedNode:function(t){var e=this._importedNodes.get(t);e&&(e.dispose(),this._importedNodes.delete(t))},getImportedNode:function(t){var e=this._importedNodes.get(t);if(e)return e.getExportedNode().valueOf();throw new Error("Imported node '"+t+"' not found.")},getImportedNodes:function(){return this._importedNodes},getLocalNode:function(t){try{return this.getNamedNode(t)}catch(n){var e=this._importedNodes.get(t);if(e)return d.get(e);throw new Error("Unknown named or imported node '"+t+"'.")}},getLocalName:function(e){if(!(e instanceof t.SFNode))throw new Error("Couldn't get local name: node is NULL.");if(e.getValue().getExecutionContext()===this)return e.getValue().getName();for(var n of this._importedNodes.values())try{if(n.getExportedNode()===e)return key}catch(t){}throw new Error("Couldn't get local name: node is shared.")},setRootNodes:function(){},getRootNodes:function(){return this.rootNodes_},getProtoDeclaration:function(t){var e=this._protos.get(t);if(e)return e;throw new Error("Proto declaration '"+t+"' not found.")},getProtoDeclarations:function(){return this._protos},getExternProtoDeclaration:function(t){var e=this._externprotos.get(t);if(e)return e;throw new Error("Extern proto declaration '"+t+"' not found.")},getExternProtoDeclarations:function(){return this._externprotos},addRoute:function(e,n,i,o){if(n=String(n),o=String(o),!(e instanceof t.SFNode))throw new Error("Bad ROUTE specification: source node must be of type SFNode.");if(!(i instanceof t.SFNode))throw new Error("Bad ROUTE specification: destination node must be of type SFNode.");if(e=e.getValue(),i=i.getValue(),!e)throw new Error("Bad ROUTE specification: source node is NULL.");if(!i)throw new Error("Bad ROUTE specification: destination node is NULL.");var s=e instanceof r?e:null,a=i instanceof r?i:null;try{e.getExecutionContext()!==this&&(s=this.getLocalNode(this.getLocalName(e)))}catch(t){}try{i.getExecutionContext()!==this&&(a=this.getLocalNode(this.getLocalName(i)))}catch(t){}if(s instanceof r&&s.addRoute(s,n,i,o),a instanceof r&&a.addRoute(e,n,a,o),s!==e&&a!==i)return this.addSimpleRoute(e,n,i,o)},
addSimpleRoute:function(t,e,n,i){try{if(e=t.getField(e),i=n.getField(i),!e.isOutput())throw new Error("Field named '"+e.getName()+"' in node named '"+t.getName()+"' of type "+t.getTypeName()+" is not an output field.");if(!i.isInput())throw new Error("Field named '"+i.getName()+"' in node named '"+n.getName()+"' of type "+n.getTypeName()+" is not an input field.");if(e.getType()!==i.getType())throw new Error("ROUTE types "+e.getTypeName()+" and "+i.getTypeName()+" do not match.");var r=e.getId()+"."+i.getId(),o=this._routeIndex.get(r);if(o)return o;var o=new u(this,t,e,n,i);return this._routes.getValue().push(o),this._routeIndex.set(r,o),o}catch(t){throw new Error("Bad ROUTE specification: "+t.message)}},deleteRoute:function(t){try{if(4===arguments.length&&!(t=this.getRoute.apply(this,arguments)))return;var e=t._sourceField,n=t._destinationField,i=e.getId()+"."+n.getId(),r=this._routes.getValue().indexOf(t);t.disconnect(),r!==-1&&this._routes.getValue().splice(r,1),this._routeIndex.delete(i)}catch(t){console.log(t)}},getRoute:function(t,e,n,i){if(!t.getValue())throw new Error("Bad ROUTE specification: sourceNode is NULL.");if(!n.getValue())throw new Error("Bad ROUTE specification: destinationNode is NULL.");var e=t.getValue().getField(e),i=n.getValue().getField(i),r=e.getId()+"."+i.getId();return this._routeIndex.get(r)},getRoutes:function(){return this._routes},changeViewpoint:function(t){try{var e=this.getNamedNode(t),n=l(c.X3DViewpointNode,e);if(!n)throw 1;n.setAnimate(!0),n.isBound_.getValue()?n.transitionStart(n):n.set_bind_=!0}catch(e){if(this.isRootContext())throw new Error("Viewpoint named '"+t+"' not found.");this.getExecutionContext().changeViewpoint(t)}},toVRMLStream:function(t){var e=h.Get(t);e.PushExecutionContext(this),e.EnterScope(),e.ImportedNodes(this.getImportedNodes()),this.getExternProtoDeclarations().toVRMLStream(t),this.getProtoDeclarations().toVRMLStream(t);for(var n=this.getRootNodes(),i=0,r=n.length;i<r;++i)t.string+=e.Indent(),n[i].toVRMLStream(t),t.string+="\n",i!==r-1&&(t.string+="\n");var o=this.getImportedNodes();o.size&&(t.string+="\n",o.forEach(function(e){try{e.toVRMLStream(t),t.string+="\n"}catch(t){}}));var s=this.getRoutes();s.length&&(t.string+="\n",s.toVRMLStream(t)),e.LeaveScope(),e.PopExecutionContext()},toXMLStream:function(t){var e=h.Get(t);e.PushExecutionContext(this),e.EnterScope(),e.ImportedNodes(this.getImportedNodes()),this.getExternProtoDeclarations().toXMLStream(t),this.getProtoDeclarations().toXMLStream(t);var n=this.getRootNodes();n.length&&(n.toXMLStream(t),t.string+="\n"),this.getImportedNodes().forEach(function(e){try{e.toXMLStream(t),t.string+="\n"}catch(t){}}),this.getRoutes().toXMLStream(t),e.LeaveScope(),e.PopExecutionContext()}}),Object.defineProperty(f.prototype,"specificationVersion",{get:function(){return this.getSpecificationVersion()},enumerable:!0,configurable:!1}),Object.defineProperty(f.prototype,"encoding",{get:function(){return this.getEncoding()},enumerable:!0,configurable:!1}),Object.defineProperty(f.prototype,"profile",{get:function(){return this.getProfile()},enumerable:!0,configurable:!1}),Object.defineProperty(f.prototype,"components",{get:function(){return this.getComponents()},enumerable:!0,configurable:!1}),Object.defineProperty(f.prototype,"worldURL",{get:function(){return this.getWorldURL()},enumerable:!0,configurable:!1}),Object.defineProperty(f.prototype,"units",{get:function(){return this.getUnits()},enumerable:!0,configurable:!1}),Object.defineProperty(f.prototype,"rootNodes",{get:function(){return this.getRootNodes()},set:function(t){this.setRootNodes(t)},enumerable:!0,configurable:!1}),Object.defineProperty(f.prototype,"protos",{get:function(){return this.getProtoDeclarations()},enumerable:!0,configurable:!1}),Object.defineProperty(f.prototype,"externprotos",{get:function(){return this.getExternProtoDeclarations()},enumerable:!0,configurable:!1}),Object.defineProperty(f.prototype,"routes",{get:function(){return this.getRoutes()},enumerable:!0,configurable:!1}),f}),define("x_ite/Configuration/ComponentInfo",["x_ite/Fields","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(t,e,n){"use strict";function i(t,e,n,i){this.name=t,this.level=e,this.title=n,this.providerUrl=i,Object.preventExtensions(this),Object.freeze(this),Object.seal(this)}return Object.assign(i.prototype,{constructor:i,toVRMLStream:function(t){n.Get(t);t.string+="COMPONENT",t.string+=" ",t.string+=this.name,t.string+=" ",t.string+=":",t.string+=" ",t.string+=this.level},toXMLStream:function(t){var e=n.Get(t);t.string+=e.Indent(),t.string+="<component",t.string+=" ",t.string+="name='",t.string+=this.name,t.string+="'",t.string+=" ",t.string+="level='",t.string+=this.level,t.string+="'",t.string+="/>"}}),i}),define("x_ite/Configuration/ComponentInfoArray",["x_ite/Configuration/ComponentInfo","x_ite/Configuration/X3DInfoArray"],function(t,e){"use strict";function n(t){var n=e.call(this);if(t)for(var i=0,r=t.length;i<r;++i)this.add(t[i].name,t[i]);return n}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,addBaseComponent:function(e){this.add(e.name,new t(e.name,e.level,e.title,e.providerUrl))}}),n}),define("x_ite/Configuration/UnitInfo",["x_ite/InputOutput/Generator"],function(t){"use strict";function e(t,e,n){Object.defineProperty(this,"category",{value:t,writable:!1}),this.name=e,this.conversionFactor=n}return Object.assign(e.prototype,{constructor:e,toVRMLStream:function(e){t.Get(e);e.string+="UNIT",e.string+=" ",e.string+=this.category,e.string+=" ",e.string+=this.name,e.string+=" ",e.string+=this.conversionFactor},toXMLStream:function(e){var n=t.Get(e);e.string+=n.Indent(),e.string+="<unit",e.string+=" ",e.string+="category='",e.string+=this.category,e.string+="'",e.string+=" ",e.string+="name='",e.string+=n.XMLEncode(this.name),e.string+="'",e.string+=" ",e.string+="conversionFactor='",e.string+=this.conversionFactor,e.string+="'",e.string+="/>"}}),Object.defineProperty(e.prototype,"conversion_factor",{get:function(){return this.conversionFactor},enumerable:!0,configurable:!1}),e}),define("x_ite/Configuration/UnitInfoArray",["x_ite/Configuration/X3DInfoArray"],function(t){"use strict";function e(){return t.call(this)}return e.prototype=Object.assign(Object.create(t.prototype),{constructor:e}),e}),define("x_ite/Execution/ExportedNode",["x_ite/Fields","x_ite/Base/X3DObject","x_ite/InputOutput/Generator"],function(t,e,n){"use strict";function i(t,n){e.call(this),this.exportedName=t,this.localNode=n}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,getTypeName:function(){return"ExportedNode"},getExportedName:function(){return this.exportedName},getLocalNode:function(){return this.localNode},toVRMLStream:function(t){var e=n.Get(t),i=e.LocalName(this.localNode);t.string+=e.Indent(),t.string+="EXPORT",t.string+=" ",t.string+=i,this.exportedName!==i&&(t.string+=" ",t.string+="AS",t.string+=" ",t.string+=this.exportedName)},toXMLStream:function(t){var e=n.Get(t),i=e.LocalName(this.localNode);t.string+=e.Indent(),t.string+="<EXPORT",t.string+=" ",t.string+="localDEF='",t.string+=e.XMLEncode(i),t.string+="'",this.exportedName!==i&&(t.string+=" ",t.string+="AS='",t.string+=e.XMLEncode(this.exportedName),t.string+="'"),t.string+="/>"}}),i}),define("standard/Networking/URI",[],function(){"use strict";function t(t,e){switch(arguments.length){case 2:var n=this.value=t?t.split(e):[];n.separator=e,n.leadingSeparator=!1,n.trailingSeparator=!1,n.length&&0===n[0].length&&(n.shift(),n.leadingSeparator=!0),n.length&&0===n[n.length-1].length&&(n.pop(),n.trailingSeparator=!0);break;case 4:var n=this.value=arguments[0];n.separator=arguments[1],n.leadingSeparator=arguments[2],n.trailingSeparator=arguments[3]}}function e(e,n){var i=o.exec(n);if(i){e.scheme=i[1]||"",e.slashs=i[2]||"",e.path=new t(unescape(i[4]||""),"/"),e.query=i[5]||"",e.fragment=unescape(i[6]||"");var i=s.exec(i[3]||"");i&&(e.host=unescape(i[1]||""),e.port=i[2]?parseInt(i[2]):0),e.absolute=!!e.slashs.length||"/"===e.path[0],e.local=/^(?:file|data)$/.test(e.scheme)||!e.scheme&&!(e.host||e.port)}else e.path=new t("","/");e.string=n}function n(e){return new t(e,"/").removeDotSegments()}function i(n){var i=this.value={local:!0,absolute:!0,scheme:"",slashs:"",host:"",port:0,path:null,query:"",fragment:"",string:""};switch(arguments.length){case 0:i.path=new t("","/");break;case 1:e(i,n);break;case 9:i.local=arguments[0],i.absolute=arguments[1],i.scheme=arguments[2],i.slashs=arguments[3],i.host=arguments[4],i.port=arguments[5],i.path=arguments[6],i.query=arguments[7],i.fragment=arguments[8],i.string=this.createString()}}t.prototype={copy:function(){var e=this.value;return new t(e.slice(0,e.length),e.separator,e.leadingSeparator,e.trailingSeparator)},get length(){return this.value.length},get leadingSeparator(){return this.value.leadingSeparator},get trailingSeparator(){return this.value.trailingSeparator},get root(){return new t([],this.value.separator,!0,!0)},get base(){return this.value.trailingSeparator?this.copy():this.parent},get parent(){var e=this.value;switch(e.length){case 0:case 1:return e.leadingSeparator?this.root:new t([".."],e.separator,!1,!1);default:return new t(e.slice(0,e.length-1),e.separator,e.leadingSeparator,!0)}},get basename(){var t=this.value,e=t.length;return e?t[e-1]:""},get stem(){var t=this.basename;if(this.trailingSeparator&&t.length){var e=this.extension;if(e.length)return t.substr(0,t.length-e.length)}return t},get extension(){var t=this.basename,e=t.lastIndexOf(".");return e>0?t.substr(e):""},getRelativePath:function(e){if(!e.leadingSeparator)return e;var n,i,r,o=new t([],"/",!1,e.value.trailingSeparator),s=this.removeDotSegments().base,a=e.removeDotSegments();for(n=0,r=Math.min(s.value.length,a.value.length);n<r&&s.value[n]===a.value[n];++n);for(i=n,r=s.value.length;i<r;++i)o.value.push("..");for(i=n,r=a.value.length;i<r;++i)o.value.push(a.value[i]);return 0===o.value.length&&o.value.push("."),o},removeDotSegments:function(){var e=this.value,n=new t([],e.separator,e.leadingSeparator,e.trailingSeparator);if(e.length){for(var i=0;i<e.length;++i){var r=e[i];switch(r){case"":break;case".":n.value.trailingSeparator=!0;break;case"..":n.value.trailingSeparator=!0,n.value.length&&n.value.pop();break;default:n.value.trailingSeparator=!1,n.value.push(r)}}n.value.trailingSeparator=n.value.trailingSeparator||e.trailingSeparator}return n},escape:function(){for(var t=this.copy(),e=t.value,n=0,i=e.length;n<i;++n)e[n]=encodeURI(e[n]);return t},unescape:function(){for(var t=this.copy(),e=t.value,n=0,i=e.length;n<i;++n)e[n]=unescape(e[n]);return t},toString:function(){var t=this.value,e="";return t.leadingSeparator&&(e+=t.separator),e+=t.join(t.separator),t.leadingSeparator&&0===t.length?e:(t.trailingSeparator&&(e+=t.separator),e)}};var r={ftp:21,http:80,https:443,ftps:990},o=/^(?:([^:\/?#]*?):)?(?:(\/\/)([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?$/,s=/^(.*?)(?:\:([^:]*))?$/;return i.prototype={copy:function(){var t=this.value;return new i(t.local,t.absolute,t.scheme,t.slashs,t.host,t.port,t.path.copy(),t.query,t.fragment)},get length(){return this.value.string.length},isRelative:function(){return!this.value.absolute},isAbsolute:function(){return!this.value.absolute},isLocal:function(){return this.value.local},isNetwork:function(){return!this.value.local},isDirectory:function(){var t=this.value;return t.path.length?t.path.trailingSeparator:this.isNetwork()},isFile:function(){return!this.isDirectory()},get hierarchy(){var t=this.value,e="";return e+=t.slashs,e+=this.authority,e+=this.path},get authority(){var t=this.value,e=t.host;return t.port&&(e+=":",e+=t.port),e},get scheme(){return this.value.scheme},get host(){return this.value.host},get port(){return this.value.port},get wellKnownPort(){var t=r[this.value.scheme];return void 0!==t?t:0},get path(){return this.value.path.toString()},set query(t){this.value.query=t},get query(){return this.value.query},set fragment(t){this.value.fragment=t},get fragment(){return this.value.fragment},get location(){return this.toString()},get root(){var e=this.value;return new i(e.local,e.absolute,e.scheme,e.slashs,e.host,e.port,new t("/","/"),"","")},get base(){var t=this.value;return this.isDirectory()?new i(t.local,t.absolute,t.scheme,t.slashs,t.host,t.port,t.path.copy(),"",""):this.parent},get parent(){var t=this.value;return new i(t.local,t.absolute,t.scheme,t.slashs,t.host,t.port,t.path.parent,"","")},get filename(){var t=this.value;return new i(t.local,t.absolute,t.scheme,t.slashs,t.host,t.port,t.path.copy(),"","")},get basename(){return this.value.path.basename},get stem(){return this.value.path.stem},get extension(){return this.value.path.extension},transform:function(t){if(t instanceof i||(t=new i(t.toString())),"data"==t.scheme)return new i(t.toString());var e=this.value,r=!1,o=!1,s="",a="",u="",l=0,c="",h="",d="";if(t.scheme)r=t.isLocal(),o=t.isAbsolute(),s=t.scheme,a=t.value.slashs,u=t.host,l=t.port,c=t.path,h=t.query;else{if(t.authority)r=t.isLocal(),o=t.isAbsolute(),u=t.host,l=t.port,c=t.path,h=t.query;else{if(0===t.path.length)c=this.path,h=t.query?t.query:e.query;else{if("/"===t.path[0])c=t.path;else{var p=this.base;p.path?c+=p.path:c="/",c+=t.path}h=t.query}r=this.isLocal(),o=this.isAbsolute()||t.isAbsolute(),u=e.host,l=e.port}s=e.scheme,a=e.slashs}return d=t.fragment,new i(r,o,s,a,u,l,n(c),h,d)},removeDotSegments:function(){var t=this.value;return new i(t.local,t.absolute,t.scheme,t.slashs,t.host,t.port,t.path.removeDotSegments(),t.query,t.fragment)},getRelativePath:function(t){t instanceof i||(t=new i(t.toString()));var e=this.value;return e.scheme!==t.scheme?t:this.authority!==t.authority?t:new i(!0,!1,"","","",0,e.path.getRelativePath(t.value.path),t.query,t.fragment)},escape:function(){var t=this.value;return new i(t.local,t.absolute,t.scheme,t.slashs,t.host,t.port,t.path.escape(),t.query,escape(t.fragment))},unescape:function(){var t=this.value;return new i(t.local,t.absolute,t.scheme,t.slashs,t.host,t.port,t.path.unescape(),t.query,unescape(t.fragment))},toString:function(){return this.value.string},createString:function(){var t=this.value,e=this.value.scheme;return t.scheme&&(e+=":"),e+=this.hierarchy,t.query&&(e+="?"+t.query),t.fragment&&(e+="#"+t.fragment),e}},i}),define("x_ite/Execution/X3DScene",["x_ite/Fields","x_ite/Execution/X3DExecutionContext","x_ite/Configuration/ComponentInfoArray","x_ite/Configuration/UnitInfo","x_ite/Configuration/UnitInfoArray","x_ite/Execution/ExportedNode","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator","x_ite/Fields/SFNodeCache","standard/Networking/URI"],function(t,e,n,i,r,o,s,a,u,l){"use strict";function c(t){e.call(this,t),this.getRootNodes().setAccessType(s.inputOutput),this._specificationVersion="3.3",this._encoding="SCRIPTED",this._profile=null,this._components=new n(this.getBrowser()),this._url=new l(window.location),this._units=new r,this._units.add("angle",new i("angle","radian",1)),this._units.add("force",new i("force","newton",1)),this._units.add("length",new i("length","metre",1)),this._units.add("mass",new i("mass","kilogram",1)),this._metadata=new Map,this._exportedNodes=new Map,this.setLive(!1)}return c.prototype=Object.assign(Object.create(e.prototype),{constructor:c,isMasterContext:function(){return this===this.getExecutionContext()},isRootContext:function(){return!0},getScene:function(){return this.isMasterContext()?this:this.getExecutionContext().getScene()},setSpecificationVersion:function(t){this._specificationVersion=t},getSpecificationVersion:function(){return this._specificationVersion},setEncoding:function(t){this._encoding=t},getEncoding:function(){return this._encoding},setURL:function(t){this._url=t},getURL:function(){return this._url},setProfile:function(t){this._profile=t},getProfile:function(){return this._profile},addComponent:function(t){this._components.add(t.name,t)},getComponents:function(){return this._components},updateUnit:function(t,e,n){var i=this._units.get(t);i&&(i.name=e,i.conversionFactor=n)},getUnits:function(){return this._units},fromUnit:function(t,e){switch(t){case"angle":case"force":case"length":case"mass":return e*this.getUnits().get(t).conversionFactor;case"acceleration:":return e*this.getUnits().get("length").conversionFactor;case"angularRate":return e*this.getUnits().get("angle").conversionFactor;case"area":return e*Math.pow(this.getUnits().get("length").conversionFactor,2);case"speed":return e*this.getUnits().get("length").conversionFactor;case"volume":return e*Math.pow(this.getUnits().get("length").conversionFactor,3)}return e},toUnit:function(t,e){switch(t){case"angle":case"force":case"length":case"mass":return e/this.getUnits().get(t).conversionFactor;case"acceleration:":return e/this.getUnits().get("length").conversionFactor;case"angularRate":return e/this.getUnits().get("angle").conversionFactor;case"area":return e/Math.pow(this.getUnits().get("length").conversionFactor,2);case"speed":return e/this.getUnits().get("length").conversionFactor;case"volume":return e/Math.pow(this.getUnits().get("length").conversionFactor,3)}return e},setMetaData:function(t,e){t.length&&this._metadata.set(t,String(e))},removeMetaData:function(t){this._metadata.delete(t)},getMetaData:function(t){return this._metadata.get(t)},getMetaDatas:function(){return this._metadata},addExportedNode:function(t,e){if(this._exportedNodes.has(t))throw new Error("Couldn't add exported node: exported name '"+t+"' already in use.");this.updateExportedNode(t,e)},updateExportedNode:function(e,n){if(e=String(e),0===e.length)throw new Error("Couldn't update exported node: node exported name is empty.");if(!(n instanceof t.SFNode))throw new Error("Couldn't update exported node: node must be of type SFNode.");if(!n.getValue())throw new Error("Couldn't update exported node: node IS NULL.");var i=new o(e,n.getValue());this._exportedNodes.set(e,i)},removeExportedNode:function(t){this._exportedNodes.delete(t)},getExportedNode:function(t){var e=this._exportedNodes.get(t);if(e)return u.get(e.getLocalNode());throw new Error("Exported node '"+t+"' not found.")},getExportedNodes:function(){return this._exportedNodes},addRootNode:function(e){if(null===e&&(e=new t.SFNode),!(e instanceof t.SFNode))throw new Error("Couldn't add root node: node must be of type SFNode.");for(var n=this.getRootNodes(),i=0,r=n.length;i<r;++i)if(n[i].equals(e))return;n.push(e)},removeRootNode:function(e){if(null===e&&(e=new t.SFNode),!(e instanceof t.SFNode))throw new Error("Couldn't remove root node: node must be of type SFNode.");var n=this.getRootNodes(),i=n.length;n.erase(n.remove(0,i,e),i)},setRootNodes:function(t){this.getRootNodes().setValue(t)},toStream:function(t){t.string+=Object.prototype.toString.call(this)},toVRMLStream:function(n){var i=a.Get(n),r=this.getSpecificationVersion();"2.0"===r&&(r="3.3"),n.string+="#X3D V",n.string+=r,n.string+=" ",n.string+="utf8",n.string+=" ",n.string+=this.getBrowser().name,n.string+=" ",n.string+="V",n.string+=this.getBrowser().version,n.string+="\n",n.string+="\n";var o=this.getProfile();o&&(o.toVRMLStream(n),n.string+="\n",n.string+="\n");var s=this.getComponents();s.length&&(s.toVRMLStream(n),n.string+="\n");for(var u=!0,l=this.getUnits(),c=0,h=l.length;c<h;++c){var d=l[c];1!==d.conversionFactor&&(u=!1,d.toVRMLStream(n),n.string+="\n")}u||(n.string+="\n");var p=this.getMetaDatas();p.size&&(p.forEach(function(e,i){n.string+="META",n.string+=" ",n.string+=new t.SFString(i).toString(),n.string+=" ",n.string+=new t.SFString(e).toString(),n.string+="\n"}),n.string+="\n");var f=this.getExportedNodes();i.PushExecutionContext(this),i.EnterScope(),i.ExportedNodes(f),e.prototype.toVRMLStream.call(this,n),f.size&&(n.string+="\n",f.forEach(function(t){try{t.toVRMLStream(n),n.string+="\n"}catch(t){console.log(t)}})),i.LeaveScope(),i.PopExecutionContext()},toXMLStream:function(t){var n=a.Get(t),i=this.getSpecificationVersion();"2.0"===i&&(i="3.3"),t.string+='<?xml version="1.0" encoding="UTF-8"?>\n',t.string+='<!DOCTYPE X3D PUBLIC "ISO//Web3D//DTD X3D ',t.string+=i,t.string+='//EN" "http://www.web3d.org/specifications/x3d-',t.string+=i,t.string+='.dtd">\n',t.string+="<X3D",t.string+=" ",t.string+="profile='",t.string+=this.getProfile()?this.getProfile().name:"Full",t.string+="'",t.string+=" ",t.string+="version='",t.string+=i,t.string+="'",t.string+=" ",t.string+="xmlns:xsd='http://www.w3.org/2001/XMLSchema-instance'",t.string+=" ",t.string+="xsd:noNamespaceSchemaLocation='http://www.web3d.org/specifications/x3d-",t.string+=i,t.string+=".xsd'>\n",n.IncIndent(),t.string+=n.Indent(),t.string+="<head>\n",n.IncIndent(),this.getComponents().toXMLStream(t);for(var r=this.getUnits(),o=0,s=r.length;o<s;++o){var u=r[o];1!==u.conversionFactor&&(u.toXMLStream(t),t.string+="\n")}this.getMetaDatas().forEach(function(e,i){t.string+=n.Indent(),t.string+="<meta",t.string+=" ",t.string+="name='",t.string+=n.XMLEncode(i),t.string+="'",t.string+=" ",t.string+="content='",t.string+=n.XMLEncode(e),t.string+="'",t.string+="/>\n"}),n.DecIndent(),t.string+=n.Indent(),t.string+="</head>\n",t.string+=n.Indent(),t.string+="<Scene>\n",n.IncIndent();var l=this.getExportedNodes();n.PushExecutionContext(this),n.EnterScope(),n.ExportedNodes(l),e.prototype.toXMLStream.call(this,t),l.forEach(function(e){try{e.toXMLStream(t),t.string+="\n"}catch(t){console.log(t)}}),n.LeaveScope(),n.PopExecutionContext(),n.DecIndent(),t.string+=n.Indent(),t.string+="</Scene>\n",n.DecIndent(),t.string+="</X3D>\n"}}),c}),define("x_ite/Execution/Scene",["x_ite/Fields","x_ite/Execution/X3DScene"],function(t,e){"use strict";function n(n){this._browser=n,e.call(this,this),this.addChildObjects("initLoadCount",new t.SFInt32,"loadCount",new t.SFInt32),this.loadingObjects=new Set}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,getTypeName:function(){return"Scene"},setExecutionContext:function(t){if(!this.isMasterContext()){var n=this.getScene();this.loadingObjects.forEach(function(t){n.removeLoadCount(t)})}if(e.prototype.setExecutionContext.call(this,t),!this.isMasterContext()){var n=this.getScene();for(var i in this.loadingObjects)n.addLoadCount(i)}},addInitLoadCount:function(t){this.initLoadCount_=this.initLoadCount_.getValue()+1},removeInitLoadCount:function(t){this.initLoadCount_=this.initLoadCount_.getValue()-1},addLoadCount:function(t){this.loadingObjects.has(t)||(this.loadingObjects.add(t),this.loadCount_=this.loadingObjects.size,this===this.getBrowser().getExecutionContext()&&this.getBrowser().addLoadCount(t),this.isMasterContext()||this.getScene().addLoadCount(t))},removeLoadCount:function(t){this.loadingObjects.has(t)&&(this.loadingObjects.delete(t),this.loadCount_=this.loadingObjects.size,this===this.getBrowser().getExecutionContext()&&this.getBrowser().removeLoadCount(t),this.isMasterContext()||this.getScene().removeLoadCount(t))},getLoadingObjects:function(){return this.loadingObjects}}),n}),define("x_ite/Parser/X3DParser",[],function(){"use strict";function t(t){this.scene=t,this.executionContexts=[t],this.units=!0}return t.prototype={constructor:t,getScene:function(){return this.scene},getBrowser:function(){return this.scene.getBrowser()},getExecutionContext:function(){return this.executionContexts[this.executionContexts.length-1]},pushExecutionContext:function(t){return this.executionContexts.push(t)},popExecutionContext:function(){this.executionContexts.pop()},isInsideProtoDefinition:function(){return this.executionContexts.length>1},addRootNode:function(t){this.getExecutionContext().rootNodes.push(t)},getProviderUrls:function(){return function(){for(var t=this.getScene(),e=t.getProfile()?t.getProfile():t.getBrowser().getProfile("Full"),n=e.components,i=t.getComponents(),r=new Set,o=0,s=n.length;o<s;++o){var a=n[o].providerUrl;a.match(/\.js$/)&&r.add(a)}for(var o=0,s=i.length;o<s;++o){var a=i[o].providerUrl;a.match(/\.js$/)&&r.add(a)}return Array.from(r)}}(),setUnits:function(t){if("boolean"==typeof arguments[0])return void(this.units=arguments[0]);var e=t.match(/Titania\s+V(\d+).*/);if(e){if(parseInt(e[1])<4)return void(this.units=!1)}this.units=!0},getUnits:function(){return this.units},fromUnit:function(t,e){return this.units?this.getExecutionContext().fromUnit(t,e):e}},t}),define("x_ite/Components/Networking/X3DUrlObject",["x_ite/Fields","x_ite/Bits/X3DConstants"],function(t,e){"use strict";function n(n){this.addType(e.X3DUrlObject),this.addChildObjects("loadState",new t.SFInt32(e.NOT_STARTED_STATE))}return n.prototype={constructor:n,initialize:function(){},setLoadState:function(t,n){this.loadState_=t,this.getScene().removeLoadCount(this),n!==!1&&t===e.IN_PROGRESS_STATE&&this.getScene().addLoadCount(this)},checkLoadState:function(){return this.loadState_.getValue()},getLoadState:function(){return this.loadState_}},n}),define("x_ite/Components/Core/X3DNode",["x_ite/Basic/X3DBaseNode","x_ite/Bits/X3DConstants"],function(t,e){"use strict";function n(n){t.call(this,n),this.addType(e.X3DNode)}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,getLayers:function(){return this.findParents(e.X3DLayerNode,this)},findParents:function(t,e){var n=[],i=new Set;return e.getParents().forEach(function(e){this.findParentsImpl(t,e,n,i)},this),n},findParentsImpl:function(n,i,r,o){if(!o.has(i.getId())){if(o.add(i.getId()),i instanceof t){for(var s=i.getType(),a=s.length-1;a>=0;--a){switch(s[a]){case e.X3DProtoDeclarationNode:case e.X3DNode:break;case e.LayerSet:case e.X3DBaseNode:case e.X3DMetadataObject:case e.X3DProgrammableShaderObject:case e.X3DScriptNode:return;default:continue}break}if(i.getType().indexOf(n)!==-1)return void r.push(i)}i.getParents().forEach(function(t){this.findParentsImpl(n,t,r,o)},this)}}}),n}),define("x_ite/Components/Core/X3DPrototypeInstance",["x_ite/Fields","x_ite/Base/X3DChildObject","x_ite/Components/Core/X3DNode","x_ite/Execution/X3DExecutionContext","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(t,e,n,i,r,o){"use strict";function s(t,e){this.protoNode=e,this.fieldDefinitions=e.getFieldDefinitions(),n.call(this,t),i.call(this,t),this.addType(r.X3DPrototypeInstance),this.getRootNodes().setAccessType(r.initializeOnly);var o=require("x_ite/Prototype/X3DProtoDeclaration");this.getExecutionContext().constructor!==o&&(this.getScene().addInitLoadCount(this),e.isExternProto?e.requestAsyncLoad(this.construct.bind(this)):this.construct())}return s.prototype=Object.assign(Object.create(i.prototype),n.prototype,{constructor:s,create:function(t){return new s(t,this.protoNode)},getTypeName:function(){return this.protoNode.getName()},getComponentName:function(){return"Core"},getContainerField:function(){return"children"},construct:function(){this.getScene().removeInitLoadCount(this);var t=this.protoNode.getProtoDeclaration();if(t){if(this.metadata_.getSet()||(this.metadata_=t.metadata_),this.protoNode.isExternProto)for(var n=t.getFieldDefinitions(),i=0,o=n.length;i<o;++i)try{var s=n[i],a=this.getField(s.name),u=t.getField(s.name);if(a.getAccessType()!==u.getAccessType())continue;if(a.getType()!==u.getType())continue;if(!(a.getAccessType()&r.initializeOnly))continue;if(a.getSet())continue;if(a.hasReferences())continue;if(a.equals(u))continue;a.setValue(u)}catch(t){this.addField(s)}this.importExternProtos(t.externprotos),this.importProtos(t.protos),this.copyRootNodes(t.rootNodes),this.isInitialized()&&(this.setInitialized(!1),this.setup(),this.setTainted(!1),e.prototype.addEvent.call(this))}},setup:function(){n.prototype.setup.call(this),i.prototype.setup.call(this)},initialize:function(){try{var t=this.protoNode.getProtoDeclaration();t&&(this.copyImportedNodes(t,t.getImportedNodes()),this.copyRoutes(t,t.routes)),n.prototype.initialize.call(this),i.prototype.initialize.call(this)}catch(t){console.error(t.message)}},getExtendedEventHandling:function(){return!1},getSpecificationVersion:function(){return this.protoNode.getProtoDeclaration().getSpecificationVersion()},getEncoding:function(){return this.protoNode.getProtoDeclaration().getEncoding()},getURL:function(){return this.protoNode.getProtoDeclaration().getURL()},getProfile:function(){return this.protoNode.getProtoDeclaration().getProfile()},getComponents:function(){return this.protoNode.getProtoDeclaration().getComponents()},fromUnit:function(t,e){return this.protoNode.getProtoDeclaration().fromUnit(t,e)},toUnit:function(t,e){return this.protoNode.getProtoDeclaration().toUnit(t,e)},getUnits:function(){return this.protoNode.getProtoDeclaration().getUnits()},getInnerNode:function(){var t=this.getRootNodes().getValue();if(t.length){var e=t[0];if(e)return e.getValue().getInnerNode()}throw new Error("Root node not available.")},importExternProtos:function(t){for(var e=0,n=t.length;e<n;++e)this.externprotos.add(t[e].getName(),t[e])},importProtos:function(t){for(var e=0,n=t.length;e<n;++e)this.protos.add(t[e].getName(),t[e])},copyRootNodes:function(t){for(var e=this.getRootNodes(),n=0,i=t.length;n<i;++n)e.push(t[n].copy(this))},copyImportedNodes:function(t,e){e.forEach(function(t,e){try{var n=this.getNamedNode(t.getInlineNode().getName()),i=t.getExportedName();this.addImportedNode(n,i,e)}catch(t){console.error("Bad IMPORT specification in copy: ",t)}},this)},copyRoutes:function(t,e){for(var n=0,i=e.length;n<i;++n)try{var r=e[n],o=this.getLocalNode(t.getLocalName(r.sourceNode)),s=this.getLocalNode(t.getLocalName(r.destinationNode));this.addRoute(o,r.sourceField,s,r.destinationField)}catch(t){console.log(t)}},toVRMLStream:function(t){n.prototype.toVRMLStream.call(this,t)},toXMLStream:function(t){var e=o.Get(t);if(e.IsSharedNode(this))return t.string+=e.Indent(),void(t.string+="<!-- NULL -->");e.EnterScope();var n=e.Name(this);if(n.length&&e.ExistsNode(this)){t.string+=e.Indent(),t.string+="<ProtoInstance",t.string+=" ",t.string+="name='",t.string+=e.XMLEncode(this.getTypeName()),t.string+="'",t.string+=" ",t.string+="USE='",t.string+=e.XMLEncode(n),t.string+="'";var i=e.ContainerField();return i&&i.getName()!==this.getContainerField()&&(t.string+=" ",t.string+="containerField='",t.string+=e.XMLEncode(i.getName()),t.string+="'"),t.string+="/>",void e.LeaveScope()}t.string+=e.Indent(),t.string+="<ProtoInstance",t.string+=" ",t.string+="name='",t.string+=e.XMLEncode(this.getTypeName()),t.string+="'",n.length&&(e.AddNode(this),t.string+=" ",t.string+="DEF='",t.string+=e.XMLEncode(n),t.string+="'");var i=e.ContainerField();i&&i.getName()!==this.getContainerField()&&(t.string+=" ",t.string+="containerField='",t.string+=e.XMLEncode(i.getName()),t.string+="'");var s=this.getChangedFields();if(0===s.length)t.string+="/>";else{t.string+=">\n",e.IncIndent();for(var a=[],u=0,l=s.length;u<l;++u){var c=s[u],h=!1;if(e.ExecutionContext()&&c.getAccessType()===r.inputOutput&&0!==c.getReferences().size){var d=!1;c.getReferences().forEach(function(t){d|=t.isInitializable()}),d||(h=!0)}if(0===c.getReferences().size||!e.ExecutionContext()||h)switch(h&&a.push(c),c.getType()){case r.MFNode:t.string+=e.Indent(),t.string+="<fieldValue",t.string+=" ",t.string+="name='",t.string+=e.XMLEncode(c.getName()),t.string+="'",0===c.length?t.string+="/>\n":(e.PushContainerField(c),t.string+=">\n",e.IncIndent(),c.toXMLStream(t),t.string+="\n",e.DecIndent(),t.string+=e.Indent(),t.string+="</fieldValue>\n",e.PopContainerField());break;case r.SFNode:if(null!==c.getValue()){e.PushContainerField(c),t.string+=e.Indent(),t.string+="<fieldValue",t.string+=" ",t.string+="name='",t.string+=e.XMLEncode(c.getName()),t.string+="'",t.string+=">\n",e.IncIndent(),c.toXMLStream(t),t.string+="\n",e.DecIndent(),t.string+=e.Indent(),t.string+="</fieldValue>\n",e.PopContainerField();break}default:t.string+=e.Indent(),t.string+="<fieldValue",t.string+=" ",t.string+="name='",t.string+=e.XMLEncode(c.getName()),t.string+="'",t.string+=" ",t.string+="value='",c.toXMLStream(t),t.string+="'",t.string+="/>\n"}else a.push(c)}if(a.length){t.string+=e.Indent(),t.string+="<IS>",t.string+="\n",e.IncIndent();for(var u=0,l=a.length;u<l;++u){var c=a[u];c.getReferences().forEach(function(n){
t.string+=e.Indent(),t.string+="<connect",t.string+=" ",t.string+="nodeField='",t.string+=e.XMLEncode(c.getName()),t.string+="'",t.string+=" ",t.string+="protoField='",t.string+=e.XMLEncode(n.getName()),t.string+="'",t.string+="/>\n"})}e.DecIndent(),t.string+=e.Indent(),t.string+="</IS>\n"}e.DecIndent(),t.string+=e.Indent(),t.string+="</ProtoInstance>"}e.LeaveScope()}}),s}),define("x_ite/Prototype/X3DProtoDeclarationNode",["x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DPrototypeInstance","x_ite/Bits/X3DConstants","x_ite/Fields/SFNodeCache"],function(t,e,n,i){"use strict";function r(e){t.call(this,e)}return r.prototype=Object.assign(Object.create(t.prototype),{constructor:r,hasUserDefinedFields:function(){return!0},createInstance:function(t,n){if(n===!1)return new e(t,this);var r=new e(t,this);return r.setup(),i.add(r)},newInstance:function(){return this.createInstance(this.getExecutionContext())}}),r}),define("x_ite/Prototype/X3DExternProtoDeclaration",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Networking/X3DUrlObject","x_ite/Prototype/X3DProtoDeclarationNode","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(t,e,n,i,r,o,s,a){"use strict";function u(){}function l(n){o.call(this,n),r.call(this,n),this.addChildObjects("url",new e.MFString),this.deferred=t.Deferred()}return l.prototype=Object.assign(Object.create(o.prototype),r.prototype,{constructor:l,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new e.SFNode)]),getTypeName:function(){return"EXTERNPROTO"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"externprotos"},initialize:function(){o.prototype.initialize.call(this),r.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this)},set_live__:function(){this.checkLoadState()===s.COMPLETE_STATE&&this.scene.setLive(this.isLive().getValue())},hasUserDefinedFields:function(){return!0},setProtoDeclaration:function(t){if(this.proto=t,this.proto)for(var e=this.getFieldDefinitions(),n=t.getFieldDefinitions(),i=0,r=n.length;i<r;++i){var o=n[i],s=e.get(o.name);s&&s.value.setValue(o.value)}},getProtoDeclaration:function(){return this.proto},loadNow:function(t){this.requestAsyncLoad(t||u)},requestAsyncLoad:function(t){if(this.deferred.done(t),this.checkLoadState()!==s.COMPLETE_STATE&&this.checkLoadState()!==s.IN_PROGRESS_STATE){this.setLoadState(s.IN_PROGRESS_STATE);new(require("x_ite/InputOutput/FileLoader"))(this).createX3DFromURL(this.url_,null,this.setInternalSceneAsync.bind(this))}},setInternalSceneAsync:function(t){t?this.setInternalScene(t):this.setError()},setInternalScene:function(t){this.scene=t;var e=this.scene.getURL().fragment||0,n=this.scene.protos[e];if(!n)throw new Error("PROTO not found");this.scene.setLive(this.isLive().getValue()),this.scene.setPrivate(this.getScene().getPrivate()),this.scene.setExecutionContext(this.getExecutionContext()),this.scene.setup(),this.setLoadState(s.COMPLETE_STATE),this.setProtoDeclaration(n),this.deferred.resolve()},getInternalScene:function(){return this.scene},setError:function(e){console.error("Error loading extern prototype:",e),this.setLoadState(s.FAILED_STATE),this.scene=this.getBrowser().getPrivateScene(),this.setProtoDeclaration(null),this.deferred.resolve(),this.deferred=t.Deferred()},toStream:function(t){t.string+=Object.prototype.toString.call(this)},toVRMLStream:function(t){var e=a.Get(t);t.string+=e.Indent(),t.string+="EXTERNPROTO",t.string+=" ",t.string+=this.getName(),t.string+=" ",t.string+="[";var n=0,i=0,r=this.getUserDefinedFields();0===r.size?t.string+=" ":(r.forEach(function(t){n=Math.max(n,t.getTypeName().length),i=Math.max(i,e.AccessType(t.getAccessType()).length)}),t.string+="\n",e.IncIndent(),r.forEach(function(e){this.toVRMLStreamUserDefinedField(t,e,n,i),t.string+="\n"},this),e.DecIndent(),t.string+=e.Indent()),t.string+="]",t.string+="\n",t.string+=e.Indent(),this.url_.toVRMLStream(t)},toVRMLStreamUserDefinedField:function(t,e,n,i){var r=a.Get(t);t.string+=r.Indent(),t.string+=r.PadRight(r.AccessType(e.getAccessType()),i),t.string+=" ",t.string+=r.PadRight(e.getTypeName(),n),t.string+=" ",t.string+=e.getName()},toXMLStream:function(t){var e=a.Get(t);t.string+=e.Indent(),t.string+="<ExternProtoDeclare",t.string+=" ",t.string+="name='",t.string+=e.XMLEncode(this.getName()),t.string+="'",t.string+=" ",t.string+="url='",this.url_.toXMLStream(t),t.string+="'",t.string+=">\n",e.IncIndent(),this.getUserDefinedFields().forEach(function(n){t.string+=e.Indent(),t.string+="<field",t.string+=" ",t.string+="accessType='",t.string+=e.AccessType(n.getAccessType()),t.string+="'",t.string+=" ",t.string+="type='",t.string+=n.getTypeName(),t.string+="'",t.string+=" ",t.string+="name='",t.string+=e.XMLEncode(n.getName()),t.string+="'",t.string+="/>\n"}),e.DecIndent(),t.string+=e.Indent(),t.string+="</ExternProtoDeclare>"}}),Object.defineProperty(l.prototype,"name",{get:function(){return this.getName()},enumerable:!0,configurable:!1}),Object.defineProperty(l.prototype,"fields",{get:function(){return this.getFieldDefinitions()},enumerable:!0,configurable:!1}),Object.defineProperty(l.prototype,"isExternProto",{get:function(){return!0},enumerable:!0,configurable:!1}),Object.defineProperty(l.prototype,"urls",{get:function(){return this.url_.copy()},enumerable:!0,configurable:!1}),Object.defineProperty(l.prototype,"loadState",{get:function(){return this.checkLoadState()},enumerable:!0,configurable:!1}),l}),define("x_ite/Prototype/X3DProtoDeclaration",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Execution/X3DExecutionContext","x_ite/Prototype/X3DProtoDeclarationNode","x_ite/Bits/X3DConstants","x_ite/InputOutput/Generator"],function(t,e,n,i,r,o,s,a){"use strict";function u(t){o.call(this,t),r.call(this,t),this.addChildObjects("loadState",new e.SFInt32(s.NOT_STARTED_STATE)),this.setLive(!1)}return u.prototype=Object.assign(Object.create(r.prototype),o.prototype,{constructor:u,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new e.SFNode)]),getTypeName:function(){return"PROTO"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"protos"},initialize:function(){o.prototype.initialize.call(this),this.loadState_=s.COMPLETE_STATE},getProtoDeclaration:function(){return arguments.length?r.prototype.getProtoDeclaration.apply(this,arguments):this},checkLoadState:function(){return this.loadState_.getValue()},hasUserDefinedFields:function(){return!0},toStream:function(t){t.string+=Object.prototype.toString.call(this)},toVRMLStream:function(t){var e=a.Get(t);t.string+=e.Indent(),t.string+="PROTO",t.string+=" ",t.string+=this.getName(),t.string+=" ",t.string+="[",e.EnterScope();var n=0,i=0,o=this.getUserDefinedFields();0===o.size?t.string+=" ":(o.forEach(function(t){n=Math.max(n,t.getTypeName().length),i=Math.max(i,e.AccessType(t.getAccessType()).length)}),t.string+="\n",e.IncIndent(),o.forEach(function(e){this.toVRMLStreamUserDefinedField(t,e,n,i),t.string+="\n"},this),e.DecIndent(),t.string+=e.Indent()),e.LeaveScope(),t.string+="]",t.string+="\n",t.string+=e.Indent(),t.string+="{",t.string+="\n",e.IncIndent(),r.prototype.toVRMLStream.call(this,t),e.DecIndent(),t.string+=e.Indent(),t.string+="}"},toVRMLStreamUserDefinedField:function(t,e,n,i){var r=a.Get(t);t.string+=r.Indent(),t.string+=r.PadRight(r.AccessType(e.getAccessType()),i),t.string+=" ",t.string+=r.PadRight(e.getTypeName(),n),t.string+=" ",t.string+=e.getName(),e.isInitializable()&&(t.string+=" ",e.toVRMLStream(t))},toXMLStream:function(t){var e=a.Get(t);t.string+=e.Indent(),t.string+="<ProtoDeclare",t.string+=" ",t.string+="name='",t.string+=e.XMLEncode(this.getName()),t.string+="'",t.string+=">",t.string+="\n",e.EnterScope();var n=this.getUserDefinedFields();0!==n.size&&(e.IncIndent(),t.string+=e.Indent(),t.string+="<ProtoInterface>\n",e.IncIndent(),n.forEach(function(n){if(t.string+=e.Indent(),t.string+="<field",t.string+=" ",t.string+="accessType='",t.string+=e.AccessType(n.getAccessType()),t.string+="'",t.string+=" ",t.string+="type='",t.string+=n.getTypeName(),t.string+="'",t.string+=" ",t.string+="name='",t.string+=e.XMLEncode(n.getName()),t.string+="'",n.isDefaultValue())t.string+="/>\n";else switch(n.getType()){case s.SFNode:case s.MFNode:e.PushContainerField(n),t.string+=">\n",e.IncIndent(),n.toXMLStream(t),t.string+="\n",e.DecIndent(),t.string+=e.Indent(),t.string+="</field>\n",e.PopContainerField();break;default:t.string+=" ",t.string+="value='",n.toXMLStream(t),t.string+="'",t.string+="/>\n"}}),e.DecIndent(),t.string+=e.Indent(),t.string+="</ProtoInterface>\n",e.DecIndent()),e.LeaveScope(),e.IncIndent(),t.string+=e.Indent(),t.string+="<ProtoBody>\n",e.IncIndent(),r.prototype.toXMLStream.call(this,t),e.DecIndent(),t.string+=e.Indent(),t.string+="</ProtoBody>\n",e.DecIndent(),t.string+=e.Indent(),t.string+="</ProtoDeclare>"}}),Object.defineProperty(u.prototype,"name",{get:function(){return this.getName()},enumerable:!0,configurable:!1}),Object.defineProperty(u.prototype,"fields",{get:function(){return this.getFieldDefinitions()},enumerable:!0,configurable:!1}),Object.defineProperty(u.prototype,"isExternProto",{get:function(){return!1},enumerable:!0,configurable:!1}),u}),define("x_ite/Parser/Parser",["x_ite/Fields","x_ite/Parser/X3DParser","x_ite/Prototype/X3DExternProtoDeclaration","x_ite/Prototype/X3DProtoDeclaration","x_ite/Bits/X3DConstants"],function(t,e,n,i,r){"use strict";function o(t){switch(t){case r.inializeOnly:return"initializeOnly";case r.inputOnly:return"inputOnly";case r.outputOnly:return"outputOnly";case r.inputOutput:return"inputOutput"}}function s(t){return this.lastIndex=t.lastIndex,t.result=this.exec(t.input),!!t.result&&(t.lastIndex=this.lastIndex,!0)}function a(t){e.call(this,t)}var u={Whitespaces:new RegExp("([\\x20\\n,\\t\\r]+)","gy"),Comment:new RegExp("#(.*?)(?=[\\n\\r])","gy"),Header:new RegExp("^#(VRML|X3D) V(.*?) (utf8)(?: (.*?))?[\\n\\r]","gy"),AS:new RegExp("AS","gy"),COMPONENT:new RegExp("COMPONENT","gy"),DEF:new RegExp("DEF","gy"),EXPORT:new RegExp("EXPORT","gy"),EXTERNPROTO:new RegExp("EXTERNPROTO","gy"),FALSE:new RegExp("FALSE|false","gy"),IMPORT:new RegExp("IMPORT","gy"),IS:new RegExp("IS","gy"),META:new RegExp("META","gy"),NULL:new RegExp("NULL","gy"),TRUE:new RegExp("TRUE|true","gy"),PROFILE:new RegExp("PROFILE","gy"),PROTO:new RegExp("PROTO","gy"),ROUTE:new RegExp("ROUTE","gy"),TO:new RegExp("TO","gy"),UNIT:new RegExp("UNIT","gy"),USE:new RegExp("USE","gy"),OpenBrace:new RegExp("\\{","gy"),CloseBrace:new RegExp("\\}","gy"),OpenBracket:new RegExp("\\[","gy"),CloseBracket:new RegExp("\\]","gy"),Period:new RegExp("\\.","gy"),Colon:new RegExp("\\:","gy"),Id:new RegExp("([^\\x30-\\x39\\x00-\\x20\\x22\\x23\\x27\\x2b\\x2c\\x2d\\x2e\\x5b\\x5c\\x5d\\x7b\\x7d\\x7f]{1}[^\\x00-\\x20\\x22\\x23\\x27\\x2c\\x2e\\x5b\\x5c\\x5d\\x7b\\x7d\\x7f]*)","gy"),ComponentNameId:new RegExp("([^\\x30-\\x39\\x00-\\x20\\x22\\x23\\x27\\x2b\\x2c\\x2d\\x2e\\x5b\\x5c\\x5d\\x7b\\x7d\\x7f\\x3a]{1}[^\\x00-\\x20\\x22\\x23\\x27\\x2c\\x2e\\x5b\\x5c\\x5d\\x7b\\x7d\\x7f\\x3a]*)","gy"),initializeOnly:new RegExp("initializeOnly","gy"),inputOnly:new RegExp("inputOnly","gy"),outputOnly:new RegExp("outputOnly","gy"),inputOutput:new RegExp("inputOutput","gy"),field:new RegExp("field","gy"),eventIn:new RegExp("eventIn","gy"),eventOut:new RegExp("eventOut","gy"),exposedField:new RegExp("exposedField","gy"),FieldType:new RegExp("(MFBool|MFColorRGBA|MFColor|MFDouble|MFFloat|MFImage|MFInt32|MFMatrix3d|MFMatrix3f|MFMatrix4d|MFMatrix4f|MFNode|MFRotation|MFString|MFTime|MFVec2d|MFVec2f|MFVec3d|MFVec3f|MFVec4d|MFVec4f|SFBool|SFColorRGBA|SFColor|SFDouble|SFFloat|SFImage|SFInt32|SFMatrix3d|SFMatrix3f|SFMatrix4d|SFMatrix4f|SFNode|SFRotation|SFString|SFTime|SFVec2d|SFVec2f|SFVec3d|SFVec3f|SFVec4d|SFVec4f)","gy"),int32:new RegExp("((?:0[xX][\\da-fA-F]+)|(?:[+-]?\\d+))","gy"),double:new RegExp("([+-]?(?:(?:(?:\\d*\\.\\d+)|(?:\\d+(?:\\.)?))(?:[eE][+-]?\\d+)?))","gy"),string:new RegExp('"((?:[^\\\\"]|\\\\\\\\|\\\\\\")*)"',"gy"),Inf:new RegExp("[+]?(?:inf|Infinity)","gy"),NegativeInf:new RegExp("-(?:inf|Infinity)","gy"),NaN:new RegExp("[+-]?(nan|NaN)","gy"),Break:new RegExp("\\r?\\n","g")};for(var l in u)u[l].parse=s;return Object.preventExtensions(u),Object.freeze(u),Object.seal(u),a.prototype=Object.assign(Object.create(e.prototype),{accessTypes:{field:r.initializeOnly,eventIn:r.inputOnly,eventOut:r.outputOnly,exposedField:r.inputOutput,initializeOnly:r.initializeOnly,inputOnly:r.inputOnly,outputOnly:r.outputOnly,inputOutput:r.inputOutput},SFBool:new t.SFBool,SFColor:new t.SFColor,SFColorRGBA:new t.SFColorRGBA,SFDouble:new t.SFDouble,SFFloat:new t.SFFloat,SFImage:new t.SFImage,SFInt32:new t.SFInt32,SFMatrix3f:new t.SFMatrix3f,SFMatrix3d:new t.SFMatrix3d,SFMatrix4f:new t.SFMatrix4f,SFMatrix4d:new t.SFMatrix4d,SFNode:new t.SFNode,SFRotation:new t.SFRotation,SFString:new t.SFString,SFTime:new t.SFTime,SFVec2d:new t.SFVec2d,SFVec2f:new t.SFVec2f,SFVec3d:new t.SFVec3d,SFVec3f:new t.SFVec3f,SFVec4d:new t.SFVec4d,SFVec4f:new t.SFVec4f,MFBool:new t.MFBool,MFColor:new t.MFColor,MFColorRGBA:new t.MFColorRGBA,MFDouble:new t.MFDouble,MFFloat:new t.MFFloat,MFImage:new t.MFImage,MFInt32:new t.MFInt32,MFMatrix3d:new t.MFMatrix3d,MFMatrix3f:new t.MFMatrix3f,MFMatrix4d:new t.MFMatrix4d,MFMatrix4f:new t.MFMatrix4f,MFNode:new t.MFNode,MFRotation:new t.MFRotation,MFString:new t.MFString,MFTime:new t.MFTime,MFVec2d:new t.MFVec2d,MFVec2f:new t.MFVec2f,MFVec3d:new t.MFVec3d,MFVec3f:new t.MFVec3f,MFVec4d:new t.MFVec4d,MFVec4f:new t.MFVec4f,setInput:function(t){this.input=t,this.lineNumber=1,this.lastIndex=0},getInput:function(){return this.input},exception:function(t){if(this.getBrowser().isStrict())throw new Error(t);this.getBrowser().println(t)},parseIntoScene:function(t,e,n){try{return this.success=e,this.error=n,this.getScene().setEncoding("VRML"),this.getScene().setProfile(this.getBrowser().getProfile("Full")),this.setInput(t),void this.x3dScene()}catch(t){throw new Error(this.getError(t))}},getError:function(t){var e=t.message,n=this.getLine(),i=this.getLastLine(),r=this.getLastLine(),o=i.length-n.length+1;return i.length>80&&(i=i.substr(o-40,80),r="",o=40),"\n********************************************************************************\nParser error at line "+this.lineNumber+":"+o+"\nin '"+this.getScene().getURL()+"'\n\n"+r+"\n"+i+"\n"+Array(o).join(" ")+"^\n"+e+"\n********************************************************************************\n"},getLine:function(){for(var t=this.input,e=this.lastIndex,n="";e<t.length&&"\n"!==t[e]&&"\r"!==t[e];)n+=t[e++];return this.lastIndex=e,n},getLastLine:function(){var t=this.input,e=this.lastIndex,n="";for(e<t.length&&("\n"!==t[e]||"\r"!==t[e])&&--e;e>=0&&"\n"!==t[e]&&"\r"!==t[e];)n=t[e--]+n;return this.lastIndex=e,n},comments:function(){for(;this.comment(););},comment:function(){return!!this.whitespaces()||u.Comment.parse(this)},whitespaces:function(){return!!u.Whitespaces.parse(this)&&(this.xml||this.lines(this.result[1]),!0)},lines:function(t){var e=t.match(u.Break);e&&(this.lineNumber+=e.length)},x3dScene:function(){this.pushExecutionContext(this.getScene()),this.headerStatement(),this.profileStatement(),this.componentStatements(),this.unitStatements(),this.metaStatements();try{this.setUnits(this.getScene().getMetaData("generator"))}catch(t){}if(this.success)require(this.getProviderUrls(),function(){try{if(this.statements(),this.popExecutionContext(),this.lastIndex<this.input.length)throw new Error("Unknown statement.");this.success(this)}catch(t){this.error(new Error(this.getError(t)))}}.bind(this),function(t){this.error(t)}.bind(this));else if(this.statements(),this.popExecutionContext(),this.lastIndex<this.input.length)throw new Error("Unknown statement.")},headerStatement:function(){u.Header.lastIndex=0;var t=u.Header.exec(this.input);return!!t&&(this.getScene().setSpecificationVersion(t[2]),this.getScene().setEncoding("VRML"),!0)},profileStatement:function(){if(this.comments(),u.PROFILE.parse(this)){if(this.profileNameId()){var t=this.getBrowser().getProfile(this.result[1]);return void this.getScene().setProfile(t)}throw new Error("Expected a profile name.")}},componentStatements:function(){for(var t=this.componentStatement();t;)this.getScene().addComponent(t),t=this.componentStatement()},componentStatement:function(){if(this.comments(),u.COMPONENT.parse(this)){if(this.componentNameId()){var t=this.result[1];if(this.comments(),u.Colon.parse(this)){if(this.componentSupportLevel()){var e=this.value;return this.getBrowser().getComponent(t,e)}throw new Error("Expected a component support level.")}throw new Error("Expected a ':' after component name.")}throw new Error("Expected a component name.")}return null},componentSupportLevel:function(){return this.int32()},unitStatements:function(){for(;this.unitStatement(););},unitStatement:function(){if(this.comments(),u.UNIT.parse(this)){if(this.categoryNameId()){var t=this.result[1];if(this.unitNameId()){var e=this.result[1];if(this.unitConversionFactor()){var n=this.value;try{return this.getScene().updateUnit(t,e,n),!0}catch(t){return console.log(t.message),!0}}throw new Error("Expected unit conversion factor.")}throw new Error("Expected unit name identificator.")}throw new Error("Expected category name identificator after UNIT statement.")}return!1},unitConversionFactor:function(){return this.double()},metaStatements:function(){for(;this.metaStatement(););},metaStatement:function(){if(this.comments(),u.META.parse(this)){if(this.metakey()){var t=this.value;if(this.metavalue()){var e=this.value;return this.getScene().setMetaData(t,e),!0}throw new Error("Expected metadata value.")}throw new Error("Expected metadata key.")}return!1},metakey:function(){return this.string()},metavalue:function(){return this.string()},exportStatement:function(){if(this.comments(),u.EXPORT.parse(this)){if(this.nodeNameId()){var t=this.result[1],e="";this.comments();var n=this.getScene().getLocalNode(t);if(u.AS.parse(this)){if(!this.exportedNodeNameId())throw new Error("No name given after AS.");e=this.result[1]}else e=t;return this.getScene().updateExportedNode(e,n),!0}throw new Error("No name given after EXPORT.")}return!1},importStatement:function(){if(this.comments(),u.IMPORT.parse(this)){if(this.nodeNameId()){var t=this.result[1],e=this.getExecutionContext().getNamedNode(t);if(this.comments(),u.Period.parse(this)){if(this.exportedNodeNameId()){var n=this.result[1],i=n;if(this.comments(),u.AS.parse(this)){if(!this.nodeNameId())throw new Error("No name given after AS.");i=this.result[1]}return this.getExecutionContext().updateImportedNode(e,n,i),!0}throw new Error("Expected exported node name.")}throw new Error("Expected a '.' after exported node name.")}throw new Error("No name given after IMPORT statement.")}return!1},statements:function(){for(;this.statement(););},statement:function(){if(this.protoStatement())return!0;if(this.routeStatement())return!0;if(this.importStatement())return!0;if(this.exportStatement())return!0;var t=this.nodeStatement();return t!==!1&&(this.addRootNode(t),!0)},nodeStatement:function(){if(this.comments(),u.DEF.parse(this)){if(this.nodeNameId())return this.node(this.result[1]);throw new Error("No name given after DEF.")}if(u.USE.parse(this)){if(this.nodeNameId())return this.getExecutionContext().getNamedNode(this.result[1]).getValue();throw new Error("No name given after USE.")}return u.NULL.parse(this)?null:this.node("")},protoStatement:function(){return!!this.proto()||!!this.externproto()},protoStatements:function(){for(;this.protoStatement(););},proto:function(){if(this.comments(),u.PROTO.parse(this)){if(this.nodeTypeId()){var t=this.result[1];if(this.comments(),u.OpenBracket.parse(this)){var e=this.interfaceDeclarations();if(this.comments(),u.CloseBracket.parse(this)){if(this.comments(),u.OpenBrace.parse(this)){for(var n=new i(this.getExecutionContext()),r=0,o=e.length;r<o;++r){var s=e[r];n.addUserDefinedField(s.getAccessType(),s.getName(),s)}if(this.pushExecutionContext(n),this.protoBody(),this.popExecutionContext(),this.comments(),u.CloseBrace.parse(this))return n.setName(t),n.setup(),this.getExecutionContext().protos.add(t,n),!0;throw new Error("Expected a '}' at the end of PROTO body.")}throw new Error("Expected a '{' at the beginning of PROTO body.")}throw new Error("Expected a ']' at the end of PROTO interface declaration.")}throw new Error("Expected a '[' at the beginning of PROTO interface declaration.")}throw new Error("Invalid PROTO definition name.")}return!1},protoBody:function(){this.protoStatements();var t=this.rootNodeStatement();t!==!1&&this.addRootNode(t),this.statements()},rootNodeStatement:function(){if(this.comments(),u.DEF.parse(this)){if(this.nodeNameId()){var t=this.result[0],e=this.node(t);if(e!==!1)return e;throw new Error("Expected node type name after DEF.")}throw new Error("No name given after DEF.")}var e=this.node("");return e!==!1&&e},interfaceDeclarations:function(){for(var t=[],e=this.interfaceDeclaration();e;)t.push(e),e=this.interfaceDeclaration();return t},restrictedInterfaceDeclaration:function(){if(this.comments(),u.inputOnly.parse(this)||u.eventIn.parse(this)){if(this.fieldType()){var t=this.result[1];if(this.inputOnlyId()){var e=this.result[1],n=new this[t].constructor;return n.setAccessType(r.inputOnly),n.setName(e),n}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(u.outputOnly.parse(this)||u.eventOut.parse(this)){if(this.fieldType()){var t=this.result[1];if(this.outputOnlyId()){var e=this.result[1],n=new this[t].constructor;return n.setAccessType(r.outputOnly),n.setName(e),n}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(u.initializeOnly.parse(this)||u.field.parse(this)){if(this.fieldType()){var t=this.result[1];if(this.initializeOnlyId()){var e=this.result[1],n=new this[t].constructor;if(this.fieldValue(n))return n.setAccessType(r.initializeOnly),n.setName(e),n;throw new Error("Couldn't read value for field '"+e+"'.")}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}return null},interfaceDeclaration:function(){var t=this.restrictedInterfaceDeclaration();if(t)return t;if(this.comments(),u.inputOutput.parse(this)||u.exposedField.parse(this)){if(this.fieldType()){var e=this.result[1];if(this.inputOutputId()){var n=this.result[1],t=new this[e].constructor;if(this.fieldValue(t))return t.setAccessType(r.inputOutput),t.setName(n),t;throw new Error("Couldn't read value for field '"+n+"'.")}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}return null},externproto:function(){if(this.comments(),u.EXTERNPROTO.parse(this)){if(this.nodeTypeId()){var t=this.result[1];if(this.comments(),u.OpenBracket.parse(this)){var e=this.externInterfaceDeclarations();if(this.comments(),u.CloseBracket.parse(this)){if(this.URLList(this.MFString)){for(var i=new n(this.getExecutionContext()),r=0,o=e.length;r<o;++r){var s=e[r];i.addUserDefinedField(s.getAccessType(),s.getName(),s)}return i.setName(t),i.url_=this.MFString,i.setup(),this.getExecutionContext().externprotos.add(t,i),!0}throw new Error("Expected a URL list after EXTERNPROTO interface declaration '"+t+"'.")}throw new Error("Expected a ']' at the end of EXTERNPROTO interface declaration.")}throw new Error("Expected a '[' at the beginning of EXTERNPROTO interface declaration.")}throw new Error("Invalid EXTERNPROTO definition name.")}return!1},externInterfaceDeclarations:function(){for(var t=[],e=this.externInterfaceDeclaration();e;)t.push(e),e=this.externInterfaceDeclaration();return t},externInterfaceDeclaration:function(){if(this.comments(),u.inputOnly.parse(this)||u.eventIn.parse(this)){if(this.fieldType()){var t=this.result[1];if(this.inputOnlyId()){var e=this.result[1],n=new this[t].constructor;return n.setAccessType(r.inputOnly),n.setName(e),n}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(u.outputOnly.parse(this)||u.eventOut.parse(this)){if(this.fieldType()){var t=this.result[1];if(this.outputOnlyId()){var e=this.result[1],n=new this[t].constructor;return n.setAccessType(r.outputOnly),n.setName(e),n}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(u.initializeOnly.parse(this)||u.field.parse(this)){if(this.fieldType()){var t=this.result[1];if(this.initializeOnlyId()){var e=this.result[1],n=new this[t].constructor;return n.setAccessType(r.initializeOnly),n.setName(e),n}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(u.inputOutput.parse(this)||u.exposedField.parse(this)){if(this.fieldType()){var t=this.result[1];if(this.inputOutputId()){var e=this.result[1],n=new this[t].constructor;return n.setAccessType(r.inputOutput),n.setName(e),n}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}return null},URLList:function(t){return this.mfstringValue(t)},routeStatement:function(){if(this.comments(),u.ROUTE.parse(this)){if(this.nodeNameId()){var t=this.result[1],e=this.getExecutionContext().getLocalNode(t);if(this.comments(),u.Period.parse(this)){if(this.outputOnlyId()){var n=this.result[1];if(this.comments(),u.TO.parse(this)){if(this.nodeNameId()){var i=this.result[1],r=this.getExecutionContext().getLocalNode(i);if(this.comments(),u.Period.parse(this)){if(this.inputOnlyId())try{var o=this.result[1];return this.getExecutionContext().addRoute(e,n,r,o),!0}catch(t){return this.exception(t.message),!0}throw new Error("Bad ROUTE specification: Expected a field name.")}throw new Error("Bad ROUTE specification: Expected a '.' after node name.")}throw new Error("Bad ROUTE specification: Expected a node name.")}throw new Error("Bad ROUTE specification: Expected a 'TO'.")}throw new Error("Bad ROUTE specification: Expected a field name.")}throw new Error("Bad ROUTE specification: Expected a '.' after node name.")}throw new Error("Bad ROUTE specification: Expected a node name.")}return!1},node:function(t){if(this.nodeTypeId()){var e=this.result[1],n=this.getExecutionContext().createNode(e,!1);if(!n&&!(n=this.getExecutionContext().createProto(e,!1)))throw new Error("Unkown node type or proto '"+e+"'.");if(t.length){try{var i=this.getExecutionContext().getNamedNode(t);this.getExecutionContext().updateNamedNode(this.getExecutionContext().getUniqueName(t),i)}catch(t){}this.getExecutionContext().updateNamedNode(t,n)}if(this.comments(),u.OpenBrace.parse(this)){if(n.hasUserDefinedFields()?this.scriptBody(n):this.nodeBody(n),this.comments(),u.CloseBrace.parse(this))return this.getExecutionContext().addUninitializedNode(n),n;throw new Error("Expected '}' at the end of node body.")}throw new Error("Expected '{' at the beginning of node body.")}return!1},scriptBody:function(t){for(;this.scriptBodyElement(t););},scriptBodyElement:function(t){var e=this.lastIndex,n=this.lineNumber;if(this.Id()){var i=this.accessTypes[this.result[1]];if(i&&this.fieldType()){var s=this.result[1];if(this.Id()){var a=this.result[1];if(this.comments(),u.IS.parse(this)){if(this.isInsideProtoDefinition()){if(this.Id()){var l=this.result[1];try{var c=this.getExecutionContext().getField(l)}catch(t){return this.exception("No such event or field '"+l+"' inside PROTO "+this.getExecutionContext().getName()+" interface declaration."),!0}var h=this[s];if(h.getType()===c.getType()){if(c.isReference(i)){try{var d=t.getField(a);if(c.getType()===d.getType())if(i===d.getAccessType());else{if(d.getAccessType()!==r.inputOutput)return this.exception("Field '"+a+"' must have access type "+o(d.getAccessType())+"."),!0;i!==d.getAccessType()&&(d=this.createUserDefinedField(t,i,a,h))}else d=this.createUserDefinedField(t,i,a,h)}catch(e){var d=this.createUserDefinedField(t,i,a,h)}return d.addReference(c),!0}throw new Error("Field '"+a+"' and '"+c.getName()+"' in PROTO '"+this.getExecutionContext().getName()+"' are incompatible as an IS mapping.")}throw new Error("Field '"+a+"' and '"+c.getName()+"' in PROTO '"+this.getExecutionContext().getName()+"' have different types.")}throw new Error("No name give after IS statement.")}throw new Error("IS statement outside PROTO definition.")}}}}this.lastIndex=e,this.lineNumber=n;var d=this.interfaceDeclaration();if(d){try{if(d.getAccessType()===r.inputOutput){var p=t.getField(d.getName());if(p.getAccessType()===r.inputOutput&&d.getType()===p.getType())return p.set(d.getValue()),p.setSet(!0),!0}}catch(t){}return t.addUserDefinedField(d.getAccessType(),d.getName(),d),!0}return this.nodeBodyElement(t)},createUserDefinedField:function(t,e,n,i){var r=new i.constructor;return t.addUserDefinedField(e,n,r),r},nodeBody:function(t){for(;this.nodeBodyElement(t););},nodeBodyElement:function(t){if(this.protoStatement())return!0;if(this.routeStatement())return!0;if(this.Id()){var e=this.result[1];try{var n=t.getField(e)}catch(n){throw new Error("Unknown field '"+e+"' in class '"+t.getTypeName()+"'.")}if(this.comments(),u.IS.parse(this)){if(this.isInsideProtoDefinition()){if(this.Id()){var i=this.result[1];try{var r=this.getExecutionContext().getField(i)}catch(t){return this.exception("No such event or field '"+i+"' inside PROTO "+this.getExecutionContext().getName()),!0}if(n.getType()===r.getType()){if(r.isReference(n.getAccessType()))return n.addReference(r),!0;throw new Error("Field '"+n.getName()+"' and '"+r.getName()+"' in PROTO "+this.getExecutionContext().getName()+" are incompatible as an IS mapping.")}throw new Error("Field '"+n.getName()+"' and '"+r.getName()+"' in PROTO "+this.getExecutionContext().getName()+" have different types.")}throw new Error("No name give after IS statement.")}throw new Error("IS statement outside PROTO definition.")}if(n.isInitializable()){if(this.fieldValue(n))return!0;throw new Error("Couldn't read value for field '"+e+"'.")}throw new Error("Couldn't assign value to "+o(n.getAccessType())+" field '"+e+"'.")}return!1},profileNameId:function(){return this.Id()},componentNameId:function(){return this.comments(),u.ComponentNameId.parse(this)},categoryNameId:function(){return this.Id()},unitNameId:function(){return this.Id()},exportedNodeNameId:function(){return this.Id()},nodeNameId:function(){return this.Id()},nodeTypeId:function(){return this.Id()},initializeOnlyId:function(){return this.Id()},inputOnlyId:function(){return this.Id()},outputOnlyId:function(){return this.Id()},inputOutputId:function(){return this.Id()},Id:function(){return this.comments(),u.Id.parse(this)},fieldType:function(){return this.comments(),u.FieldType.parse(this)},fieldValue:function(t){return t.setSet(!0),this.fieldTypes[t.getType()].call(this,t)},double:function(){return this.comments(),u.double.parse(this)?(this.value=parseFloat(this.result[1]),!0):u.Inf.parse(this)?(this.value=Number.POSITIVE_INFINITY,!0):u.NegativeInf.parse(this)?(this.value=Number.NEGATIVE_INFINITY,!0):!!u.NaN.parse(this)&&(this.value=Number.NaN,!0)},int32:function(){return this.comments(),!!u.int32.parse(this)&&(this.value=parseInt(this.result[1]),!0)},string:function(){return this.comments(),!!u.string.parse(this)&&(this.value=t.SFString.unescape(this.result[1]),this.lines(this.value),!0)},sfboolValue:function(t){return this.comments(),u.TRUE.parse(this)?(t.set(!0),!0):!!u.FALSE.parse(this)&&(t.set(!1),!0)},mfboolValue:function(t){if(t.length=0,this.sfboolValue(this.SFBool))return t.push(this.SFBool),!0;if(u.OpenBracket.parse(this)){if(this.sfboolValues(t),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfboolValues:function(t){for(t.length=0,t=t.getTarget();this.sfboolValue(this.SFBool);)t.push(this.SFBool)},
sfcolorValue:function(t){if(this.double()){var e=this.value;if(this.double()){var n=this.value;if(this.double()){var i=this.value;return t.getValue().set(e,n,i),!0}}}return!1},mfcolorValue:function(t){if(t.length=0,this.sfcolorValue(this.SFColor))return t.push(this.SFColor),!0;if(u.OpenBracket.parse(this)){if(this.sfcolorValues(t),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfcolorValues:function(t){for(t.length=0,t=t.getTarget();this.sfcolorValue(this.SFColor);)t.push(this.SFColor)},sfcolorrgbaValue:function(t){if(this.double()){var e=this.value;if(this.double()){var n=this.value;if(this.double()){var i=this.value;if(this.double()){var r=this.value;return t.getValue().set(e,n,i,r),!0}}}}return!1},mfcolorrgbaValue:function(t){if(t.length=0,this.sfcolorrgbaValue(this.SFColorRGBA))return t.push(this.SFColorRGBA),!0;if(u.OpenBracket.parse(this)){if(this.sfcolorrgbaValues(t),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfcolorrgbaValues:function(t){for(t.length=0,t=t.getTarget();this.sfcolorrgbaValue(this.SFColorRGBA);)t.push(this.SFColorRGBA)},sfdoubleValue:function(t){return!!this.double()&&(t.set(this.fromUnit(t.getUnit(),this.value)),!0)},mfdoubleValue:function(t){if(t.length=0,this.SFDouble.setUnit(t.getUnit()),this.sfdoubleValue(this.SFDouble))return t.push(this.SFDouble),!0;if(u.OpenBracket.parse(this)){if(this.sfdoubleValues(t),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfdoubleValues:function(t){for(t.length=0,t=t.getTarget(),this.SFDouble.setUnit(t.getUnit());this.sfdoubleValue(this.SFDouble);)t.push(this.SFDouble)},sffloatValue:function(t){return this.sfdoubleValue(t)},mffloatValue:function(t){if(t.length=0,this.SFFloat.setUnit(t.getUnit()),this.sffloatValue(this.SFFloat))return t.push(this.SFFloat),!0;if(u.OpenBracket.parse(this)){if(this.sffloatValues(t),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sffloatValues:function(t){for(t.length=0,t=t.getTarget(),this.SFFloat.setUnit(t.getUnit());this.sffloatValue(this.SFFloat);)t.push(this.SFFloat)},sfimageValue:function(t){if(this.int32()){var e=this.value;if(this.int32()){var n=this.value;if(this.int32()){var i=this.value,r=e*n;t.width=e,t.height=n,t.comp=i;for(var o=t.array,s=0;s<r;++s){if(!this.int32())return!1;o[s]=this.value}return!0}}}return!1},mfimageValue:function(t){if(t.length=0,this.sfimageValue(this.SFImage))return t.push(this.SFImage),!0;if(u.OpenBracket.parse(this)){if(this.sfimageValues(t),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfimageValues:function(t){for(t.length=0,t=t.getTarget();this.sfimageValue(this.SFImage);)t.push(this.SFImage)},sfint32Value:function(t){return!!this.int32()&&(t.set(this.value),!0)},mfint32Value:function(t){if(t.length=0,this.sfint32Value(this.SFInt32))return t.push(this.SFInt32),!0;if(u.OpenBracket.parse(this)){if(this.sfint32Values(t),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfint32Values:function(t){for(t.length=0,t=t.getTarget();this.sfint32Value(this.SFInt32);)t.push(this.SFInt32)},sfmatrix3dValue:function(t){if(this.double()){var e=this.value;if(this.double()){var n=this.value;if(this.double()){var i=this.value;if(this.double()){var r=this.value;if(this.double()){var o=this.value;if(this.double()){var s=this.value;if(this.double()){var a=this.value;if(this.double()){var u=this.value;if(this.double()){var l=this.value;return t.getValue().set(e,n,i,r,o,s,a,u,l),!0}}}}}}}}}return!1},mfmatrix3dValue:function(t){if(t.length=0,this.sfmatrix3dValue(this.SFMatrix3d))return t.push(this.SFMatrix3d),!0;if(u.OpenBracket.parse(this)){if(this.sfmatrix3dValues(t),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfmatrix3dValues:function(t){for(t.length=0,t=t.getTarget();this.sfmatrix3dValue(this.SFMatrix3d);)t.push(this.SFMatrix3d)},sfmatrix3fValue:function(t){return this.sfmatrix3dValue(t)},mfmatrix3fValue:function(t){if(t.length=0,this.sfmatrix3fValue(this.SFMatrix3f))return t.push(this.SFMatrix3f),!0;if(u.OpenBracket.parse(this)){if(this.sfmatrix3fValues(t),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfmatrix3fValues:function(t){for(t.length=0,t=t.getTarget();this.sfmatrix3fValue(this.SFMatrix3f);)t.push(this.SFMatrix3f)},sfmatrix4dValue:function(t){if(this.double()){var e=this.value;if(this.double()){var n=this.value;if(this.double()){var i=this.value;if(this.double()){var r=this.value;if(this.double()){var o=this.value;if(this.double()){var s=this.value;if(this.double()){var a=this.value;if(this.double()){var u=this.value;if(this.double()){var l=this.value;if(this.double()){var c=this.value;if(this.double()){var h=this.value;if(this.double()){var d=this.value;if(this.double()){var p=this.value;if(this.double()){var f=this.value;if(this.double()){var g=this.value;if(this.double()){var m=this.value;return t.getValue().set(e,n,i,r,o,s,a,u,l,c,h,d,p,f,g,m),!0}}}}}}}}}}}}}}}}return!1},mfmatrix4dValue:function(t){if(t.length=0,this.sfmatrix4dValue(this.SFMatrix4d))return t.push(this.SFMatrix4d),!0;if(u.OpenBracket.parse(this)){if(this.sfmatrix4dValues(t),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfmatrix4dValues:function(t){for(t.length=0,t=t.getTarget();this.sfmatrix4dValue(this.SFMatrix4d);)t.push(this.SFMatrix4d)},sfmatrix4fValue:function(t){return this.sfmatrix4dValue(t)},mfmatrix4fValue:function(t){if(t.length=0,this.sfmatrix4fValue(this.SFMatrix4f))return t.push(this.SFMatrix4f),!0;if(u.OpenBracket.parse(this)){if(this.sfmatrix4fValues(t),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfmatrix4fValues:function(t){for(t.length=0,t=t.getTarget();this.sfmatrix4fValue(this.SFMatrix4f);)t.push(this.SFMatrix4f)},sfnodeValue:function(t){var e=this.nodeStatement();return e!==!1&&(t.setValue(e),!0)},mfnodeValue:function(t){t.length=0;var e=this.nodeStatement();if(e!==!1)return t.push(e),!0;if(u.OpenBracket.parse(this)){if(this.nodeStatements(t),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},nodeStatements:function(t){for(var e=this.nodeStatement();e!==!1;)t.push(e),e=this.nodeStatement()},sfrotationValue:function(t){if(this.double()){var e=this.value;if(this.double()){var n=this.value;if(this.double()){var i=this.value;if(this.double()){var r=this.value;return t.getValue().set(e,n,i,this.fromUnit("angle",r)),!0}}}}return!1},mfrotationValue:function(t){if(t.length=0,this.sfrotationValue(this.SFRotation))return t.push(this.SFRotation),!0;if(u.OpenBracket.parse(this)){if(this.sfrotationValues(t),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfrotationValues:function(t){for(t.length=0,t=t.getTarget();this.sfrotationValue(this.SFRotation);)t.push(this.SFRotation)},sfstringValue:function(t){return!!this.string()&&(t.set(this.value),!0)},mfstringValue:function(t){if(t.length=0,this.sfstringValue(this.SFString))return t.push(this.SFString),!0;if(u.OpenBracket.parse(this)){if(this.sfstringValues(t),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfstringValues:function(t){for(t.length=0,t=t.getTarget();this.sfstringValue(this.SFString);)t.push(this.SFString)},sftimeValue:function(t){return this.sfdoubleValue(t)},mftimeValue:function(t){if(t.length=0,this.sftimeValue(this.SFTime))return t.push(this.SFTime),!0;if(u.OpenBracket.parse(this)){if(this.sftimeValues(t),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sftimeValues:function(t){for(t.length=0,t=t.getTarget();this.sftimeValue(this.SFTime);)t.push(this.SFTime)},sfvec2dValue:function(t){if(this.double()){var e=this.value;if(this.double()){var n=this.value,i=t.getUnit();return t.getValue().set(this.fromUnit(i,e),this.fromUnit(i,n)),!0}}return!1},mfvec2dValue:function(t){if(t.length=0,this.SFVec2d.setUnit(t.getUnit()),this.sfvec2dValue(this.SFVec2d))return t.push(this.SFVec2d),!0;if(u.OpenBracket.parse(this)){if(this.sfvec2dValues(t),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec2dValues:function(t){for(t.length=0,t=t.getTarget(),this.SFVec2d.setUnit(t.getUnit());this.sfvec2dValue(this.SFVec2d);)t.push(this.SFVec2d)},sfvec2fValue:function(t){return this.sfvec2dValue(t)},mfvec2fValue:function(t){if(t.length=0,this.SFVec2f.setUnit(t.getUnit()),this.sfvec2fValue(this.SFVec2f))return t.push(this.SFVec2f),!0;if(u.OpenBracket.parse(this)){if(this.sfvec2fValues(t),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec2fValues:function(t){for(t.length=0,t=t.getTarget(),this.SFVec2f.setUnit(t.getUnit());this.sfvec2fValue(this.SFVec2f);)t.push(this.SFVec2f)},sfvec3dValue:function(t){if(this.double()){var e=this.value;if(this.double()){var n=this.value;if(this.double()){var i=this.value,r=t.getUnit();return t.getValue().set(this.fromUnit(r,e),this.fromUnit(r,n),this.fromUnit(r,i)),!0}}}return!1},mfvec3dValue:function(t){if(t.length=0,this.SFVec3d.setUnit(t.getUnit()),this.sfvec3dValue(this.SFVec3d))return t.push(this.SFVec3d),!0;if(u.OpenBracket.parse(this)){if(this.sfvec3dValues(t),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec3dValues:function(t){for(t.length=0,t=t.getTarget(),this.SFVec3d.setUnit(t.getUnit());this.sfvec3dValue(this.SFVec3d);)t.push(this.SFVec3d)},sfvec3fValue:function(t){return this.sfvec3dValue(t)},mfvec3fValue:function(t){if(t.length=0,this.SFVec3f.setUnit(t.getUnit()),this.sfvec3fValue(this.SFVec3f))return t.push(this.SFVec3f),!0;if(u.OpenBracket.parse(this)){if(this.sfvec3fValues(t),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec3fValues:function(t){for(t.length=0,t=t.getTarget(),this.SFVec3f.setUnit(t.getUnit());this.sfvec3fValue(this.SFVec3f);)t.push(this.SFVec3f)},sfvec4dValue:function(t){if(this.double()){var e=this.value;if(this.double()){var n=this.value;if(this.double()){var i=this.value;if(this.double()){var r=this.value,o=t.getUnit();return t.getValue().set(this.fromUnit(o,e),this.fromUnit(o,n),this.fromUnit(o,i),this.fromUnit(o,r)),!0}}}}return!1},mfvec4dValue:function(t){if(t.length=0,this.SFVec4d.setUnit(t.getUnit()),this.sfvec4dValue(this.SFVec4d))return t.push(this.SFVec4d),!0;if(u.OpenBracket.parse(this)){if(this.sfvec4dValues(t),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec4dValues:function(t){for(t.length=0,t=t.getTarget(),this.SFVec4d.setUnit(t.getUnit());this.sfvec4dValue(this.SFVec4d);)t.push(this.SFVec4d)},sfvec4fValue:function(t){return this.sfvec4dValue(t)},mfvec4fValue:function(t){if(t.length=0,this.SFVec4f.setUnit(t.getUnit()),this.sfvec4fValue(this.SFVec4f))return t.push(this.SFVec4f),!0;if(u.OpenBracket.parse(this)){if(this.sfvec4fValues(t),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec4fValues:function(t){for(t.length=0,t=t.getTarget(),this.SFVec4f.setUnit(t.getUnit());this.sfvec4fValue(this.SFVec4f);)t.push(this.SFVec4f)}}),a.prototype.fieldTypes=[],a.prototype.fieldTypes[r.SFBool]=a.prototype.sfboolValue,a.prototype.fieldTypes[r.SFColor]=a.prototype.sfcolorValue,a.prototype.fieldTypes[r.SFColorRGBA]=a.prototype.sfcolorrgbaValue,a.prototype.fieldTypes[r.SFDouble]=a.prototype.sfdoubleValue,a.prototype.fieldTypes[r.SFFloat]=a.prototype.sffloatValue,a.prototype.fieldTypes[r.SFImage]=a.prototype.sfimageValue,a.prototype.fieldTypes[r.SFInt32]=a.prototype.sfint32Value,a.prototype.fieldTypes[r.SFMatrix3f]=a.prototype.sfmatrix3dValue,a.prototype.fieldTypes[r.SFMatrix3d]=a.prototype.sfmatrix3fValue,a.prototype.fieldTypes[r.SFMatrix4f]=a.prototype.sfmatrix4dValue,a.prototype.fieldTypes[r.SFMatrix4d]=a.prototype.sfmatrix4fValue,a.prototype.fieldTypes[r.SFNode]=a.prototype.sfnodeValue,a.prototype.fieldTypes[r.SFRotation]=a.prototype.sfrotationValue,a.prototype.fieldTypes[r.SFString]=a.prototype.sfstringValue,a.prototype.fieldTypes[r.SFTime]=a.prototype.sftimeValue,a.prototype.fieldTypes[r.SFVec2d]=a.prototype.sfvec2dValue,a.prototype.fieldTypes[r.SFVec2f]=a.prototype.sfvec2fValue,a.prototype.fieldTypes[r.SFVec3d]=a.prototype.sfvec3dValue,a.prototype.fieldTypes[r.SFVec3f]=a.prototype.sfvec3fValue,a.prototype.fieldTypes[r.SFVec4d]=a.prototype.sfvec4dValue,a.prototype.fieldTypes[r.SFVec4f]=a.prototype.sfvec4fValue,a.prototype.fieldTypes[r.MFBool]=a.prototype.mfboolValue,a.prototype.fieldTypes[r.MFColor]=a.prototype.mfcolorValue,a.prototype.fieldTypes[r.MFColorRGBA]=a.prototype.mfcolorrgbaValue,a.prototype.fieldTypes[r.MFDouble]=a.prototype.mfdoubleValue,a.prototype.fieldTypes[r.MFFloat]=a.prototype.mffloatValue,a.prototype.fieldTypes[r.MFImage]=a.prototype.mfimageValue,a.prototype.fieldTypes[r.MFInt32]=a.prototype.mfint32Value,a.prototype.fieldTypes[r.MFMatrix3d]=a.prototype.mfmatrix3dValue,a.prototype.fieldTypes[r.MFMatrix3f]=a.prototype.mfmatrix3fValue,a.prototype.fieldTypes[r.MFMatrix4d]=a.prototype.mfmatrix4dValue,a.prototype.fieldTypes[r.MFMatrix4f]=a.prototype.mfmatrix4fValue,a.prototype.fieldTypes[r.MFNode]=a.prototype.mfnodeValue,a.prototype.fieldTypes[r.MFRotation]=a.prototype.mfrotationValue,a.prototype.fieldTypes[r.MFString]=a.prototype.mfstringValue,a.prototype.fieldTypes[r.MFTime]=a.prototype.mftimeValue,a.prototype.fieldTypes[r.MFVec2d]=a.prototype.mfvec2dValue,a.prototype.fieldTypes[r.MFVec2f]=a.prototype.mfvec2fValue,a.prototype.fieldTypes[r.MFVec3d]=a.prototype.mfvec3dValue,a.prototype.fieldTypes[r.MFVec3f]=a.prototype.mfvec3fValue,a.prototype.fieldTypes[r.MFVec4d]=a.prototype.mfvec4dValue,a.prototype.fieldTypes[r.MFVec4f]=a.prototype.mfvec4fValue,a}),define("standard/Utility/DataStorage",["jquery"],function(t){"use strict";function e(t,e){return this.target=this,n.set(this,t),i.set(this,e),new Proxy(this,r)}var n=new WeakMap,i=new WeakMap,r={get:function(e,n){var i=e[n];if(void 0!==i)return i;var i=e.getStorage()[e.getNameSpace()+n];if(void 0!==i&&"undefined"!==i)return t.parseJSON(i)},set:function(t,e,n){return void 0===n?t.getStorage().removeItem(t.getNameSpace()+e):t.getStorage()[t.getNameSpace()+e]=JSON.stringify(n),!0}};return e.prototype={constructor:e,getStorage:function(){return n.get(this.target)},getNameSpace:function(){return i.get(this.target)},clear:function(){var e=this.getStorage(),n=this.getNameSpace();t.each(e,function(t){t.substr(0,n.length)===n&&e.removeItem(t)})}},e}),define("x_ite/Browser/Core/X3DCoreContext",["jquery","x_ite/Fields","x_ite/Browser/Core/BrowserOptions","x_ite/Browser/Core/BrowserProperties","x_ite/Browser/Core/RenderingProperties","x_ite/Browser/Core/Notification","x_ite/Browser/Core/BrowserTimings","x_ite/Browser/Core/ContextMenu","x_ite/Execution/Scene","x_ite/Parser/Parser","standard/Utility/DataStorage","x_ite/DEBUG"],function(t,e,n,i,r,o,s,a,u,l,c,h){"use strict";function d(t,e,n){var i={preserveDrawingBuffer:n},r=null;if(e>=2&&!r&&(r=t.getContext("webgl2",i))&&(r.getVersion=function(){return 2}),e>=1&&!r&&(r=t.getContext("webgl",i)||t.getContext("experimental-webgl",i))&&(r.getVersion=function(){return 1}),!r)throw new Error("Couldn't create WebGL context.");var o=r.getParameter(r.ALIASED_LINE_WIDTH_RANGE);return 1===o[0]&&1===o[1]&&(r.lineWidth=Function.prototype),r}function p(u){this.number=++f,this.element=u;var l=t("<div></div>").addClass("x_ite-private-browser").prependTo(this.element),h=t("<div></div>").addClass("x_ite-private-splash-screen").appendTo(l),p=(t("<div></div>").addClass("x_ite-private-spinner").appendTo(h),t("<div></div>").addClass("x_ite-private-progress").appendTo(h)),m=t("<div></div>").addClass("x_ite-private-surface x_ite-private-surface-"+this.getId()).appendTo(l);t("<div></div>").addClass("x_ite-private-spinner-text").appendTo(p).text("Lade 0 Dateien"),t("<div></div>").addClass("x_ite-private-progressbar").appendTo(p).append(t("<div></div>")),this.splashScreen=h,this.surface=m,this.canvas=t("<canvas></canvas>").addClass("x_ite-private-canvas").prependTo(m),this.context=d(this.canvas[0],1,"true"===u.attr("preserveDrawingBuffer")),this.extensions={};var x=this.getContext();g.forEach(function(t){this.extensions[t]=x.getExtension(t)},this),this.browserOptions=new n(this.getPrivateScene()),this.browserProperties=new i(this.getPrivateScene()),this.renderingProperties=new r(this.getPrivateScene()),this.notification=new o(this.getPrivateScene()),this.browserTimings=new s(this.getPrivateScene()),this.contextMenu=new a(this.getPrivateScene()),this.localStorage=new c(localStorage,"X_ITE.X3DBrowser("+this.number+")."),this.mobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),t(".x_ite-console").empty(),this.addChildObjects("controlKey",new e.SFBool,"shiftKey",new e.SFBool,"altKey",new e.SFBool,"altGrKey",new e.SFBool)}var f=0,g=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_frag_depth","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_compressed_texture_s3tc","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_depth_texture","WEBGL_draw_buffers","WEBGL_lose_context","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_sRGB","WEBGL_color_buffer_float","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","EXT_float_blend","OES_fbo_render_mipmap","WEBGL_get_buffer_sub_data_async","WEBGL_multiview","WEBGL_security_sensitive_resources","WEBGL_shared_resources","EXT_clip_cull_distance","WEBGL_debug","WEBGL_dynamic_texture","WEBGL_subarray_uploads","WEBGL_texture_multisample","WEBGL_texture_source_iframe","WEBGL_video_texture","EXT_texture_storage","OES_depth24","WEBGL_debug_shader_precision","WEBGL_draw_elements_no_range_check","WEBGL_subscribe_uniform","WEBGL_texture_from_depth_video"];return p.prototype={initialize:function(){this.browserOptions.setup(),this.browserProperties.setup(),this.renderingProperties.setup(),this.notification.setup(),this.browserTimings.setup(),this.contextMenu.setup(),this.observer=new MutationObserver(this.processMutations.bind(this)),this.observer.observe(this.element[0],{attributes:!0,childList:!1,characterData:!1,subtree:!1}),Object.defineProperty(this.getElement().get(0),"src",{get:function(){return this.getExecutionContext().getWorldURL()}.bind(this),set:function(t){this.loadURL(new e.MFString(t),new e.MFString)}.bind(this),enumerable:!0,configurable:!1}),Object.defineProperty(this.getElement().get(0),"url",{get:function(){var t=this.getExecutionContext().getWorldURL();return t?new e.MFString(t):new e.MFString}.bind(this),set:function(t){this.loadURL(t,new e.MFString)}.bind(this),enumerable:!0,configurable:!1}),this.setBrowserEventHandler("onload"),this.setBrowserEventHandler("onshutdown"),this.setBrowserEventHandler("onerror"),this.getElement().bind("keydown.X3DCoreContext",this.keydown_X3DCoreContext.bind(this)),this.getElement().bind("keyup.X3DCoreContext",this.keyup_X3DCoreContext.bind(this))},getDebug:function(){return this.getBrowserOptions().getDebug()},getNumber:function(){return this.number},isStrict:function(){return!1},getElement:function(){return this.element},getSurface:function(){return this.surface},getSplashScreen:function(){return this.splashScreen},getCanvas:function(){return this.canvas},getContext:function(){return this.context},getExtension:function(t){return this.extensions[t]},getBrowserOptions:function(){return this.browserOptions},getBrowserProperties:function(){return this.browserProperties},getRenderingProperties:function(){return this.renderingProperties},getNotification:function(){return this.notification},getBrowserTimings:function(){return this.browserTimings},getLocalStorage:function(){return this.localStorage},getMobile:function(){return this.mobile},getPrivateScene:function(){return this.privateScene?this.privateScene:(this.privateScene=new u(this),this.privateScene.setPrivate(!0),this.privateScene.setLive(!0),this.privateScene.setup(),this.privateScene)},processMutations:function(t){t.forEach(function(t){this.processMutation(t)},this)},processMutation:function(t){var e=t.target;switch(t.type){case"attributes":this.processAttribute(t,e)}},processAttribute:function(t,e){switch(t.attributeName.toLowerCase()){case"onerror":this.setBrowserEventHandler("onerror");break;case"onload":this.setBrowserEventHandler("onload");break;case"onshutdown":this.setBrowserEventHandler("onshutdown");break;case"splashscreen":this.getBrowserOptions().setAttributeSplashScreen();break;case"src":var n=this.getElement().attr("src");this.load('"'+n+'"');break;case"url":this.load(this.getElement().attr("url"))}},load:function(t){if(t){var n=new l(this.getExecutionContext()),i=new e.MFString,r=new e.MFString;n.setInput(t),n.sfstringValues(i),i.length&&this.loadURL(i,r)}else this.getLoading()||this.getCanvas().fadeIn(0)},setBrowserEventHandler:function(t){var e=this.getElement().get(0),n=this.getElement().attr(t);e[t]=n?new Function(n):Function.prototype},callBrowserEventHandler:function(t){var e=this.getElement().get(0),n=e[t];n&&n.call(e),window.jQuery&&window.jQuery(e).trigger(t.substr(2))},getShiftKey:function(){return this.shiftKey_.getValue()},getControlKey:function(){return this.controlKey_.getValue()},getAltKey:function(){return this.altKey_.getValue()},getAltGrKey:function(){return this.altGrKey_.getValue()},keydown_X3DCoreContext:function(t){switch(t.keyCode){case 16:this.shiftKey_=!0;break;case 17:this.controlKey_=!0;break;case 18:this.altKey_=!0;break;case 49:this.getDebug()&&this.getControlKey()&&(t.preventDefault(),this.setBrowserOption("Shading","POINT"),this.getNotification().string_="Shading: Pointset");break;case 50:this.getDebug()&&this.getControlKey()&&(t.preventDefault(),this.setBrowserOption("Shading","WIREFRAME"),this.getNotification().string_="Shading: Wireframe");break;case 51:this.getDebug()&&this.getControlKey()&&(t.preventDefault(),this.setBrowserOption("Shading","FLAT"),this.getNotification().string_="Shading: Flat");break;case 52:this.getDebug()&&this.getControlKey()&&(t.preventDefault(),this.setBrowserOption("Shading","GOURAUD"),this.getNotification().string_="Shading: Gouraud");break;case 53:this.getDebug()&&this.getControlKey()&&(t.preventDefault(),this.setBrowserOption("Shading","PHONG"),this.getNotification().string_="Shading: Phong");break;case 83:this.getDebug()&&this.getControlKey()&&(t.preventDefault(),this.isLive().getValue()?this.endUpdate():this.beginUpdate(),this.getNotification().string_=this.isLive().getValue()?"Begin Update":"End Update");break;case 225:this.altGrKey_=!0;break;case 171:case 187:this.getControlKey()&&(t.preventDefault(),this.getBrowserTimings().setEnabled(!this.getBrowserTimings().getEnabled()));break;case 36:t.preventDefault(),this.firstViewpoint();break;case 35:t.preventDefault(),this.lastViewpoint();break;case 33:t.preventDefault(),this.previousViewpoint();break;case 34:t.preventDefault(),this.nextViewpoint();break;case 119:if(this.getShiftKey()){t.preventDefault();var e=this.getActiveViewpoint();if(!e)break;var n="";n+="Viewpoint {\n",n+="  position "+e.getUserPosition().toString()+"\n",n+="  orientation "+e.getUserOrientation().toString()+"\n",n+="  centerOfRotation "+e.getUserCenterOfRotation().toString()+"\n",n+="}\n",console.log(n),navigator.clipboard.writeText(n).then(function(){this.getNotification().string_="Copied Viewpoint to clipboard."}.bind(this),function(t){this.getNotification().string_="Couldn't copy viewpoint."}.bind(this))}}},keyup_X3DCoreContext:function(t){switch(t.which){case 16:this.shiftKey_=!1;break;case 17:this.controlKey_=!1;break;case 18:this.altKey_=!1;break;case 225:this.altGrKey_=!1}}},p}),define("x_ite/Routing/X3DRoutingContext",[],function(){"use strict";function t(){this.taintedFields=[],this.taintedFieldsTemp=[],this.taintedNodes=[],this.taintedNodesTemp=[]}return t.prototype={constructor:t,initialize:function(){},addTaintedField:function(t,e){this.taintedFields.push(t,e)},addTaintedNode:function(t){this.taintedNodes.push(t)},processEvents:function(){do{do{var t=this.taintedFields;this.taintedFields=this.taintedFieldsTemp,this.taintedFields.length=0;for(var e=0,n=t.length;e<n;e+=2)t[e].processEvent(t[e+1]);this.taintedFieldsTemp=t}while(this.taintedFields.length)do{var i=this.taintedNodes;this.taintedNodes=this.taintedNodesTemp,this.taintedNodes.length=0;for(var e=0,n=i.length;e<n;++e)i[e].processEvents();this.taintedNodesTemp=i}while(!this.taintedFields.length&&this.taintedNodes.length)}while(this.taintedFields.length)}},t}),define("x_ite/Browser/Scripting/X3DScriptingContext",[],function(){"use strict";function t(){this.scripts=[this]}return t.prototype={initialize:function(){},isExternal:function(){return 1===this.scripts.length},getScriptStack:function(){return this.scripts}},t}),define("x_ite/Browser/Networking/urls",["standard/Networking/URI","x_ite/DEBUG"],function(t,e){"use strict";function n(){this.scriptUrl=new t(getScriptURL()),this.fallbackExpression=new RegExp("^http://cors.create3000.de/")}return n.prototype={getProviderUrl:function(t){return t?(getScriptURL().match(/\.min\.js$/)&&(t+=".min"),this.scriptUrl.transform("components/"+t+".js").toString()):"http://create3000.de/x_ite"},getFontsUrl:function(t){return this.scriptUrl.transform("fonts/"+t).toString()},getLinetypeUrl:function(t){return this.scriptUrl.transform("linetype/"+t+".png").toString()},getHatchingUrl:function(t){return this.scriptUrl.transform("hatching/"+t+".png").toString()},getFallbackUrl:function(t){return"http://cors.create3000.de/?url="+t},getFallbackExpression:function(){return this.fallbackExpression}},new n}),function(){"use strict";function t(e){return function(e,i){var r,o,s,a,u,l,c,h,d,p=1,f=e.length,g="";for(o=0;o<f;o++)if("string"==typeof e[o])g+=e[o];else if("object"==typeof e[o]){if((a=e[o]).keys)for(r=i[p],s=0;s<a.keys.length;s++){if(null==r)throw new Error(t('[sprintf] Cannot access property "%s" of undefined value "%s"',a.keys[s],a.keys[s-1]));r=r[a.keys[s]]}else r=a.param_no?i[a.param_no]:i[p++];if(n.not_type.test(a.type)&&n.not_primitive.test(a.type)&&r instanceof Function&&(r=r()),n.numeric_arg.test(a.type)&&"number"!=typeof r&&isNaN(r))throw new TypeError(t("[sprintf] expecting number but found %T",r));switch(n.number.test(a.type)&&(h=0<=r),a.type){case"b":r=parseInt(r,10).toString(2);break;case"c":r=String.fromCharCode(parseInt(r,10));break;case"d":case"i":r=parseInt(r,10);break;case"j":r=JSON.stringify(r,null,a.width?parseInt(a.width):0);break;case"e":r=a.precision?parseFloat(r).toExponential(a.precision):parseFloat(r).toExponential();break;case"f":r=a.precision?parseFloat(r).toFixed(a.precision):parseFloat(r);break;case"g":r=a.precision?String(Number(r.toPrecision(a.precision))):parseFloat(r);break;case"o":r=(parseInt(r,10)>>>0).toString(8);break;case"s":r=String(r),r=a.precision?r.substring(0,a.precision):r;break;case"t":r=String(!!r),r=a.precision?r.substring(0,a.precision):r;break;case"T":r=Object.prototype.toString.call(r).slice(8,-1).toLowerCase(),r=a.precision?r.substring(0,a.precision):r;break;case"u":r=parseInt(r,10)>>>0;break;case"v":r=r.valueOf(),r=a.precision?r.substring(0,a.precision):r;break;case"x":r=(parseInt(r,10)>>>0).toString(16);break;case"X":r=(parseInt(r,10)>>>0).toString(16).toUpperCase()}n.json.test(a.type)?g+=r:(!n.number.test(a.type)||h&&!a.sign?d="":(d=h?"+":"-",r=r.toString().replace(n.sign,"")),l=a.pad_char?"0"===a.pad_char?"0":a.pad_char.charAt(1):" ",c=a.width-(d+r).length,u=a.width&&0<c?l.repeat(c):"",g+=a.align?d+r+u:"0"===l?d+u+r:u+d+r)}return g}(function(t){if(i[t])return i[t];for(var e,r=t,o=[],s=0;r;){if(null!==(e=n.text.exec(r)))o.push(e[0]);else if(null!==(e=n.modulo.exec(r)))o.push("%");else{if(null===(e=n.placeholder.exec(r)))throw new SyntaxError("[sprintf] unexpected placeholder");if(e[2]){s|=1;var a=[],u=e[2],l=[];if(null===(l=n.key.exec(u)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(a.push(l[1]);""!==(u=u.substring(l[0].length));)if(null!==(l=n.key_access.exec(u)))a.push(l[1]);else{if(null===(l=n.index_access.exec(u)))throw new SyntaxError("[sprintf] failed to parse named argument key");a.push(l[1])}e[2]=a}else s|=2;if(3===s)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");o.push({placeholder:e[0],param_no:e[1],keys:e[2],sign:e[3],pad_char:e[4],align:e[5],width:e[6],precision:e[7],type:e[8]})}r=r.substring(e[0].length)}return i[t]=o}(e),arguments)}function e(e,n){return t.apply(null,[e].concat(n||[]))}var n={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/},i=Object.create(null);"undefined"!=typeof exports&&(exports.sprintf=t,exports.vsprintf=e),"undefined"!=typeof window&&(window.sprintf=t,window.vsprintf=e,"function"==typeof define&&define.amd&&define("sprintf/dist/sprintf.min",[],function(){return{sprintf:t,vsprintf:e}}))}(),define("sprintf",["sprintf/dist/sprintf.min"],function(t){return t}),define("x_ite/Browser/Networking/X3DNetworkingContext",["x_ite/Fields","x_ite/Browser/Networking/urls","standard/Networking/URI","sprintf","locale/gettext"],function(t,e,n,i,r){"use strict";function o(t){var e=t.baseURI;return e.startsWith("about:")&&(e=document.baseURI),new n(e)}function s(){this.addChildObjects("loadCount",new t.SFInt32),this.loadingTotal=0,this.loadingObjects=new Set,this.loading=!1,this.location=o(this.getElement()[0]),this.getCanvas().fadeOut(0),this.getBrowserOptions().getSplashScreen()&&this.getSplashScreen().fadeIn(0)}return s.prototype={initialize:function(){},getProviderUrl:function(){return e.getProviderUrl()},getLocation:function(){return this.location},getDefaultScene:function(){return this.defaultScene?this.defaultScene:(this.defaultScene=this.createScene(),this.defaultScene.setPrivate(!0),this.defaultScene.setLive(!0),this.defaultScene.setup(),this.defaultScene)},setBrowserLoading:function(t){this.loading=t,t?(this.resetLoadCount(),this.getBrowserOptions().getSplashScreen()?(this.getCanvas().stop(!0,!0).animate({delay:1},1).fadeOut(0),this.getSplashScreen().stop(!0,!0).animate({delay:1},1).fadeIn(0)):this.getCanvas().fadeOut(0)):this.getBrowserOptions().getSplashScreen()?(this.getSplashScreen().stop(!0,!0).fadeIn(0).fadeOut(2e3),this.getCanvas().stop(!0,!0).fadeOut(0).fadeIn(2e3)):this.getCanvas().fadeIn(0)},getLoading:function(){return this.loading},addLoadCount:function(t){this.loadingObjects.has(t)||(++this.loadingTotal,this.loadingObjects.add(t),this.setLoadCount(this.loadingObjects.size),this.setCursor("DEFAULT"))},removeLoadCount:function(t){this.loadingObjects.has(t)&&(this.loadingObjects.delete(t),this.setLoadCount(this.loadingObjects.size))},setLoadCount:function(t){if(this.loadCount_=t,t)var e=i.sprintf(r(1==t?"Loading %d file":"Loading %d files"),t);else{var e=r("Loading done");this.setCursor("DEFAULT")}this.loading||(this.getNotification().string_=e),this.getSplashScreen().find(".x_ite-private-spinner-text").text(e),this.getSplashScreen().find(".x_ite-private-progressbar div").css("width",100*(this.loadingTotal-t)/this.loadingTotal+"%")},resetLoadCount:function(){
this.loadCount_=0,this.loadingTotal=0,this.loadingObjects.clear()}},s}),define("x_ite/Components/Shape/X3DAppearanceChildNode",["x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants"],function(t,e){"use strict";function n(n){t.call(this,n),this.addType(e.X3DAppearanceChildNode)}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n}),n}),define("x_ite/Bits/TraverseType",[],function(){"use strict";var t=0,e={POINTER:t++,CAMERA:t++,PICKING:t++,COLLISION:t++,DEPTH:t++,DISPLAY:t++};return Object.preventExtensions(e),Object.freeze(e),Object.seal(e),e}),define("x_ite/Components/Shaders/X3DShaderNode",["x_ite/Browser/Core/Shading","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Bits/X3DConstants","x_ite/Bits/TraverseType"],function(t,e,n,i){"use strict";function r(t){e.call(this,t),this.addType(n.X3DShaderNode),this.valid=!1}return r.prototype=Object.assign(Object.create(e.prototype),{constructor:r,custom:!0,setCustom:function(t){this.custom=t},getCustom:function(){return this.custom},setValid:function(t){this.isValid_=this.valid=t},getValid:function(){return this.valid},setShading:function(e){var n=this.getBrowser().getContext();switch(e){case t.POINT:this.primitiveMode=n.POINTS,this.wireframe=!0;break;case t.WIREFRAME:this.primitiveMode=n.LINE_LOOP,this.wireframe=!0;break;default:this.primitiveMode=n.TRIANGLES,this.wireframe=!1}},traverse:function(t,e){t===i.DISPLAY&&e.getShaders().add(this)}}),r}),define("x_ite/Components/Core/X3DChildNode",["x_ite/Fields","x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants"],function(t,e,n){"use strict";function i(i){this.getExecutionContext()||(e.call(this,i),this.addType(n.X3DChildNode),this.addChildObjects("isCameraObject",new t.SFBool),this.addChildObjects("isPickableObject",new t.SFBool),this.isCameraObject_.setAccessType(n.outputOnly),this.isPickableObject_.setAccessType(n.outputOnly))}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,setCameraObject:function(t){t!==this.isCameraObject_.getValue()&&(this.isCameraObject_=t)},getCameraObject:function(){return this.isCameraObject_.getValue()},setPickableObject:function(t){t!==this.isPickableObject_.getValue()&&(this.isPickableObject_=t)},getPickableObject:function(){return this.isPickableObject_.getValue()}}),i}),define("x_ite/Components/Core/X3DBindableNode",["x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(t,e){"use strict";function n(n){t.call(this,n),this.addType(e.X3DBindableNode),this.layers=[]}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,initialize:function(){t.prototype.initialize.call(this),this.set_bind_.addInterest("set_bind__",this)},getCameraObject:function(){return!0},addLayer:function(t){this.layers.push(t)},transitionStart:function(){},set_bind__:function(){if(this.set_bind_.getValue()){this.layers=this.getLayers();for(var t=0;t<this.layers.length;++t)this.bindToLayer(this.layers[t])}else for(var t=0;t<this.layers.length;++t)this.unbindFromLayer(this.layers[t])}}),n}),define("x_ite/Components/Core/X3DSensorNode",["x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(t,e){"use strict";function n(n){t.call(this,n),this.addType(e.X3DSensorNode)}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n}),n}),define("x_ite/Components/Time/X3DTimeDependentNode",["x_ite/Fields","x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(t,e,n){"use strict";function i(e){this.addType(n.X3DTimeDependentNode),this.addChildObjects("initialized",new t.SFTime,"isEvenLive",new t.SFBool),this.startTimeValue=0,this.pauseTimeValue=0,this.resumeTimeValue=0,this.stopTimeValue=0,this.start=0,this.pause=0,this.pauseInterval=0,this.startTimeout=null,this.pauseTimeout=null,this.resumeTimeout=null,this.stopTimeout=null,this.disabled=!1}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,initialize:function(){e.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this),this.isEvenLive_.addInterest("_set_live__",this),this.initialized_.addInterest("set_loop__",this),this.enabled_.addInterest("set_enabled__",this),this.loop_.addInterest("set_loop__",this),this.startTime_.addInterest("set_startTime__",this),this.pauseTime_.addInterest("set_pauseTime__",this),this.resumeTime_.addInterest("set_resumeTime__",this),this.stopTime_.addInterest("set_stopTime__",this),this.startTimeValue=this.startTime_.getValue(),this.pauseTimeValue=this.pauseTime_.getValue(),this.resumeTimeValue=this.resumeTime_.getValue(),this.stopTimeValue=this.stopTime_.getValue(),this.initialized_=this.getBrowser().getCurrentTime()},getDisabled:function(){return this.disabled},getElapsedTime:function(){return this.getBrowser().getCurrentTime()-this.start-this.pauseInterval},getLiveState:function(){return this.getLive()&&(this.getExecutionContext().isLive().getValue()||this.isEvenLive_.getValue())},set_live__:function(){this.isLive().getValue()?this.disabled&&(this.disabled=!1,this.isActive_.getValue()&&!this.isPaused_.getValue()&&this.real_resume()):this.disabled||!this.isActive_.getValue()||this.isPaused_.getValue()||(this.disabled=!0,this.real_pause())},set_enabled__:function(){this.enabled_.getValue()?this.set_loop__():this.stop()},set_loop__:function(){this.enabled_.getValue()&&this.loop_.getValue()&&this.stopTimeValue<=this.startTimeValue&&this.startTimeValue<=this.getBrowser().getCurrentTime()&&this.do_start()},set_startTime__:function(){this.startTimeValue=this.startTime_.getValue(),this.enabled_.getValue()&&(this.removeTimeout("startTimeout"),this.startTimeValue<=this.getBrowser().getCurrentTime()?this.do_start():this.addTimeout("startTimeout","do_start",this.startTimeValue))},set_pauseTime__:function(){if(this.pauseTimeValue=this.pauseTime_.getValue(),this.enabled_.getValue()){if(this.removeTimeout("pauseTimeout"),this.pauseTimeValue<=this.resumeTimeValue)return;this.pauseTimeValue<=this.getBrowser().getCurrentTime()?this.do_pause():this.addTimeout("pauseTimeout","do_pause",this.pauseTimeValue)}},set_resumeTime__:function(){if(this.resumeTimeValue=this.resumeTime_.getValue(),this.enabled_.getValue()){if(this.removeTimeout("resumeTimeout"),this.resumeTimeValue<=this.pauseTimeValue)return;this.resumeTimeValue<=this.getBrowser().getCurrentTime()?this.do_resume():this.addTimeout("resumeTimeout","do_resume",this.resumeTimeValue)}},set_stopTime__:function(){if(this.stopTimeValue=this.stopTime_.getValue(),this.enabled_.getValue()){if(this.removeTimeout("stopTimeout"),this.stopTimeValue<=this.startTimeValue)return;this.stopTimeValue<=this.getBrowser().getCurrentTime()?this.do_stop():this.addTimeout("stopTimeout","do_stop",this.stopTimeValue)}},do_start:function(){this.isActive_.getValue()||(this.start=this.getBrowser().getCurrentTime(),this.pauseInterval=0,this.isActive_=!0,this.set_start(),this.isLive().getValue()?this.getBrowser().timeEvents().addInterest("set_time",this):(this.disabled=!0,this.real_pause()),this.elapsedTime_=0,this.cycleTime_=this.getBrowser().getCurrentTime())},do_pause:function(){this.isActive_.getValue()&&!this.isPaused_.getValue()&&(this.isPaused_=!0,this.pauseTimeValue!==this.getBrowser().getCurrentTime()&&(this.pauseTimeValue=this.getBrowser().getCurrentTime()),this.isLive().getValue()&&this.real_pause())},real_pause:function(){this.pause=performance.now(),this.set_pause(),this.getBrowser().timeEvents().removeInterest("set_time",this)},do_resume:function(){this.isActive_.getValue()&&this.isPaused_.getValue()&&(this.isPaused_=!1,this.resumeTimeValue!==this.getBrowser().getCurrentTime()&&(this.resumeTimeValue=this.getBrowser().getCurrentTime()),this.isLive().getValue()&&this.real_resume())},real_resume:function(){var t=(performance.now()-this.pause)/1e3;this.pauseInterval+=t,this.set_resume(t),this.getBrowser().timeEvents().addInterest("set_time",this),this.getBrowser().addBrowserEvent()},do_stop:function(){this.stop()},stop:function(){this.isActive_.getValue()&&(this.set_stop(),this.elapsedTime_=this.getElapsedTime(),this.isPaused_.getValue()&&(this.isPaused_=!1),this.isActive_=!1,this.isLive().getValue()&&this.getBrowser().timeEvents().removeInterest("set_time",this))},timeout:function(t){this.enabled_.getValue()&&(this.getBrowser().advanceTime(performance.now()),this[t]())},addTimeout:function(t,e,n){this.removeTimeout(t),this[t]=setTimeout(this.timeout.bind(this,e),1e3*(n-this.getBrowser().getCurrentTime()))},removeTimeout:function(t){clearTimeout(this[t]),this[t]=null},set_start:function(){},set_pause:function(){},set_resume:function(){},set_stop:function(){},set_time:function(){}}),i}),define("x_ite/Components/Time/TimeSensor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DSensorNode","x_ite/Components/Time/X3DTimeDependentNode","x_ite/Bits/X3DConstants"],function(t,e,n,i,r,o){"use strict";function s(e){i.call(this,e),r.call(this,e),this.addType(o.TimeSensor),this.addChildObjects("range",new t.MFFloat(0,0,1)),this.cycle=0,this.interval=0,this.fraction=0,this.first=0,this.last=1,this.scale=1}return s.prototype=Object.assign(Object.create(i.prototype),r.prototype,{constructor:s,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOutput,"enabled",new t.SFBool(!0)),new e(o.inputOutput,"cycleInterval",new t.SFTime(1)),new e(o.inputOutput,"loop",new t.SFBool),new e(o.inputOutput,"startTime",new t.SFTime),new e(o.inputOutput,"resumeTime",new t.SFTime),new e(o.inputOutput,"pauseTime",new t.SFTime),new e(o.inputOutput,"stopTime",new t.SFTime),new e(o.outputOnly,"isPaused",new t.SFBool),new e(o.outputOnly,"isActive",new t.SFBool),new e(o.outputOnly,"cycleTime",new t.SFTime),new e(o.outputOnly,"elapsedTime",new t.SFTime),new e(o.outputOnly,"fraction_changed",new t.SFFloat),new e(o.outputOnly,"time",new t.SFTime)]),getTypeName:function(){return"TimeSensor"},getComponentName:function(){return"Time"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),r.prototype.initialize.call(this),this.cycleInterval_.addInterest("set_cycleInterval__",this),this.range_.addInterest("set_range__",this)},setRange:function(t,e,n){this.fraction=t>=1?0:t,this.first=e,this.last=n,this.scale=this.last-this.first;var i=(this.fraction-this.first)*this.cycleInterval_.getValue();this.interval=this.cycleInterval_.getValue()*this.scale,this.cycle=this.getBrowser().getCurrentTime()-i},set_cycleInterval__:function(){this.isActive_.getValue()&&this.setRange(this.fraction,this.range_[1],this.range_[2])},set_range__:function(){this.isActive_.getValue()&&(this.setRange(this.range_[0],this.range_[1],this.range_[2]),this.isPaused_.getValue()||this.set_fraction(this.getBrowser().getCurrentTime()))},set_start:function(){this.setRange(this.range_[0],this.range_[1],this.range_[2]),this.fraction_changed_=this.range_[0],this.time_=this.getBrowser().getCurrentTime()},set_resume:function(t){this.setRange(this.fraction,this.range_[1],this.range_[2])},set_fraction:function(t){var e=(t-this.cycle)/this.interval;this.fraction_changed_=this.fraction=this.first+(e-Math.floor(e))*this.scale},set_time:function(){var t=this.getBrowser().getCurrentTime();t-this.cycle>=this.interval?this.loop_.getValue()?this.interval&&(this.cycle+=this.interval*Math.floor((t-this.cycle)/this.interval),this.elapsedTime_=this.getElapsedTime(),this.cycleTime_=t,this.set_fraction(t)):(this.fraction_changed_=this.fraction=this.last,this.stop()):(this.elapsedTime_=this.getElapsedTime(),this.set_fraction(t)),this.time_=t}}),s}),define("x_ite/Components/Interpolation/X3DInterpolatorNode",["x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(t,e,n){"use strict";function i(n){t.call(this,n),this.addType(e.X3DInterpolatorNode)}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,setup:function(){this.set_key__(),this.key_.length&&this.interpolate(0,0,0),t.prototype.setup.call(this)},initialize:function(){t.prototype.initialize.call(this),this.set_fraction_.addInterest("set_fraction__",this),this.key_.addInterest("set_key__",this)},set_fraction__:function(){var t=this.key_,e=t.length,i=this.set_fraction_.getValue();switch(e){case 0:return;case 1:return this.interpolate(0,0,0);default:if(i<=t[0])return this.interpolate(0,1,0);var r=n.upperBound(t,0,e,i,n.less);if(r!==e){var o=r-1,s=(i-t[o])/(t[r]-t[o]);this.interpolate(o,r,n.clamp(s,0,1))}else this.interpolate(e-2,e-1,1)}},set_key__:function(){this.set_keyValue__()},set_keyValue__:function(){},interpolate:function(){}}),i}),define("x_ite/Components/Interpolation/EaseInEaseOut",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Bits/X3DConstants"],function(t,e,n,i,r){"use strict";function o(t){i.call(this,t),this.addType(r.EaseInEaseOut)}return o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_fraction",new t.SFFloat),new e(r.inputOutput,"key",new t.MFFloat),new e(r.inputOutput,"easeInEaseOut",new t.MFVec2f),new e(r.outputOnly,"modifiedFraction_changed",new t.SFFloat)]),getTypeName:function(){return"EaseInEaseOut"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.easeInEaseOut_.addInterest("set_keyValue__",this)},set_keyValue__:function(){this.easeInEaseOut_.length<this.key_.length&&this.easeInEaseOut_.resize(this.key_.length,this.easeInEaseOut_.length?this.easeInEaseOut_[this.easeInEaseOut_.length-1]:new t.SFVec2f)},interpolate:function(t,e,n){var i=this.easeInEaseOut_[t].y,r=this.easeInEaseOut_[e].x,o=i+r;if(o<0)this.modifiedFraction_changed_=n;else{o>1&&(r/=o,i/=o);var s=1/(2-i-r);if(n<i)this.modifiedFraction_changed_=s/i*n*n;else if(n<=1-r)this.modifiedFraction_changed_=s*(2*n-i);else{var a=1-n;this.modifiedFraction_changed_=1-s*a*a/r}}}}),o}),define("x_ite/Components/Interpolation/PositionInterpolator",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.PositionInterpolator)}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_fraction",new t.SFFloat),new e(r.inputOutput,"key",new t.MFFloat),new e(r.inputOutput,"keyValue",new t.MFVec3f),new e(r.outputOnly,"value_changed",new t.SFVec3f)]),getTypeName:function(){return"PositionInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){var e=this.key_,n=this.keyValue_;n.length<e.length&&n.resize(e.length,n.length?n[n.length-1]:new t.SFVec3f)},interpolate:function(){var t=new o(0,0,0);return function(e,n,i){this.value_changed_=t.assign(this.keyValue_[e].getValue()).lerp(this.keyValue_[n].getValue(),i)}}()}),s}),define("x_ite/Components/Interpolation/OrientationInterpolator",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Rotation4"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.OrientationInterpolator)}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_fraction",new t.SFFloat),new e(r.inputOutput,"key",new t.MFFloat),new e(r.inputOutput,"keyValue",new t.MFRotation),new e(r.outputOnly,"value_changed",new t.SFRotation)]),getTypeName:function(){return"OrientationInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){var e=this.key_,n=this.keyValue_;n.length<e.length&&n.resize(e.length,n.length?n[n.length-1]:new t.SFRotation)},interpolate:function(){var t=new o(0,0,1,0),e=new o(0,0,1,0);return function(n,i,r){try{t.assign(this.keyValue_[n].getValue()),e.assign(this.keyValue_[i].getValue()),this.value_changed_=t.slerp(e,r)}catch(t){console.log(t)}}}()}),s}),define("x_ite/Components/Navigation/X3DViewpointNode",["x_ite/Fields","x_ite/Components/Core/X3DBindableNode","x_ite/Components/Time/TimeSensor","x_ite/Components/Interpolation/EaseInEaseOut","x_ite/Components/Interpolation/PositionInterpolator","x_ite/Components/Interpolation/OrientationInterpolator","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(t,e,n,i,r,o,s,a,u,l,c,h){"use strict";function d(s){e.call(this,s),this.addType(a.X3DViewpointNode),this.addChildObjects("positionOffset",new t.SFVec3f,"orientationOffset",new t.SFRotation,"scaleOffset",new t.SFVec3f(1,1,1),"scaleOrientationOffset",new t.SFRotation,"centerOfRotationOffset",new t.SFVec3f,"fieldOfViewScale",new t.SFFloat(1)),this.userPosition=new l(0,1,0),this.userOrientation=new c(0,0,1,0),this.userCenterOfRotation=new l(0,0,0),this.modelMatrix=new h,this.cameraSpaceMatrix=new h(1,0,0,0,0,1,0,0,0,0,1,0,0,0,10,1),this.inverseCameraSpaceMatrix=new h(1,0,0,0,0,1,0,0,0,0,1,0,0,0,-10,1);var u=this.getBrowser();this.timeSensor=new n(u.getPrivateScene()),this.easeInEaseOut=new i(u.getPrivateScene()),this.positionInterpolator=new r(u.getPrivateScene()),this.orientationInterpolator=new o(u.getPrivateScene()),this.scaleInterpolator=new r(u.getPrivateScene()),this.scaleOrientationInterpolator=new o(u.getPrivateScene())}return d.prototype=Object.assign(Object.create(e.prototype),{constructor:d,initialize:function(){e.prototype.initialize.call(this),this.timeSensor.stopTime_=1,this.timeSensor.setup(),this.easeInEaseOut.key_=new t.MFFloat(0,1),this.easeInEaseOut.easeInEaseOut_=new t.MFVec2f(new t.SFVec2f(0,0),new t.SFVec2f(0,0)),this.easeInEaseOut.setup(),this.positionInterpolator.key_=new t.MFFloat(0,1),this.orientationInterpolator.key_=new t.MFFloat(0,1),this.scaleInterpolator.key_=new t.MFFloat(0,1),this.scaleOrientationInterpolator.key_=new t.MFFloat(0,1),this.positionInterpolator.setup(),this.orientationInterpolator.setup(),this.scaleInterpolator.setup(),this.scaleOrientationInterpolator.setup(),this.timeSensor.fraction_changed_.addFieldInterest(this.easeInEaseOut.set_fraction_),this.easeInEaseOut.modifiedFraction_changed_.addFieldInterest(this.positionInterpolator.set_fraction_),this.easeInEaseOut.modifiedFraction_changed_.addFieldInterest(this.orientationInterpolator.set_fraction_),this.easeInEaseOut.modifiedFraction_changed_.addFieldInterest(this.scaleInterpolator.set_fraction_),this.easeInEaseOut.modifiedFraction_changed_.addFieldInterest(this.scaleOrientationInterpolator.set_fraction_),this.positionInterpolator.value_changed_.addFieldInterest(this.positionOffset_),this.orientationInterpolator.value_changed_.addFieldInterest(this.orientationOffset_),this.scaleInterpolator.value_changed_.addFieldInterest(this.scaleOffset_),this.scaleOrientationInterpolator.value_changed_.addFieldInterest(this.scaleOrientationOffset_),this.isBound_.addInterest("set_bound__",this)},getEaseInEaseOut:function(){return this.easeInEaseOut},setInterpolators:function(){},bindToLayer:function(t){t.getViewpointStack().push(this)},unbindFromLayer:function(t){t.getViewpointStack().pop(this)},removeFromLayer:function(t){t.getViewpointStack().remove(this)},getPosition:function(){return this.position_.getValue()},getUserPosition:function(){return this.userPosition.assign(this.getPosition()).add(this.positionOffset_.getValue())},getOrientation:function(){return this.orientation_.getValue()},getUserOrientation:function(){return this.userOrientation.assign(this.getOrientation()).multRight(this.orientationOffset_.getValue())},getCenterOfRotation:function(){return this.centerOfRotation_.getValue()},getUserCenterOfRotation:function(){return this.userCenterOfRotation.assign(this.getCenterOfRotation()).add(this.centerOfRotationOffset_.getValue())},getProjectionMatrix:function(t){var e=t.getNavigationInfo();return this.getProjectionMatrixWithLimits(e.getNearValue(),e.getFarValue(this),t.getLayer().getViewport().getRectangle(t.getBrowser()))},getCameraSpaceMatrix:function(){return this.cameraSpaceMatrix},getInverseCameraSpaceMatrix:function(){return this.inverseCameraSpaceMatrix},getModelMatrix:function(){return this.modelMatrix},getMaxFarValue:function(){return this.getBrowser().getRenderingProperty("LogarithmicDepthBuffer")?1e10:1e5},getUpVector:function(){return l.yAxis},getSpeedFactor:function(){return 1},setAnimate:function(t){this.animate=t},getAnimate:function(){return this.animate},transitionStart:function(){var e=new l(0,0,0),n=new c(0,0,1,0),i=new l(0,0,0),r=new c(0,0,1,0);return function(o){try{if(this.jump_.getValue()){var s=this.getLayers();this.retainUserOffsets_.getValue()||this.resetUserOffsets();for(var a=0;a<s.length;++a){var u=s[a].getNavigationInfo();u.transitionStart_=!0;var l=u.getTransitionType(),c=u.transitionTime_.getValue()}switch("2.0"==this.getExecutionContext().getSpecificationVersion()&&(l=this.getAnimate()?"LINEAR":"TELEPORT"),this.setAnimate(!1),l){case"TELEPORT":for(var a=0;a<s.length;++a)s[a].getNavigationInfo().transitionComplete_=!0;return;case"ANIMATE":this.easeInEaseOut.easeInEaseOut_=new t.MFVec2f(new t.SFVec2f(0,1),new t.SFVec2f(1,0));break;default:this.easeInEaseOut.easeInEaseOut_=new t.MFVec2f(new t.SFVec2f(0,0),new t.SFVec2f(0,0))}this.timeSensor.cycleInterval_=c,this.timeSensor.stopTime_=this.getBrowser().getCurrentTime(),this.timeSensor.startTime_=this.getBrowser().getCurrentTime(),this.timeSensor.isActive_.addInterest("set_active__",this),this.getRelativeTransformation(o,e,n,i,r),this.positionInterpolator.keyValue_=new t.MFVec3f(e,this.positionOffset_),this.orientationInterpolator.keyValue_=new t.MFRotation(n,this.orientationOffset_),this.scaleInterpolator.keyValue_=new t.MFVec3f(i,this.scaleOffset_),this.scaleOrientationInterpolator.keyValue_=new t.MFRotation(r,this.scaleOrientationOffset_),this.positionOffset_=e,this.orientationOffset_=n,this.scaleOffset_=i,this.scaleOrientationOffset_=r,this.setInterpolators(o)}else this.getRelativeTransformation(o,e,n,i,r),this.positionOffset_=e,this.orientationOffset_=n,this.scaleOffset_=i,this.scaleOrientationOffset_=r,this.setInterpolators(o)}catch(t){console.log(t)}}}(),transitionStop:function(){this.timeSensor.stopTime_=this.getBrowser().getCurrentTime(),this.timeSensor.isActive_.removeInterest("set_active__",this)},resetUserOffsets:function(){this.positionOffset_=l.Zero,this.orientationOffset_=c.Identity,this.scaleOffset_=l.One,this.scaleOrientationOffset_=c.Identity,this.centerOfRotationOffset_=l.Zero,this.fieldOfViewScale_=1},getRelativeTransformation:function(t,e,n,i,r){this.modelMatrix.copy().multRight(t.getInverseCameraSpaceMatrix()).inverse().get(e,n,i,r),e.subtract(this.getPosition()),n.assign(this.getOrientation().copy().inverse().multRight(n))},lookAtPoint:function(t,e,n){try{if(!this.getBrowser().getActiveLayer())return;this.getCameraSpaceMatrix().multVecMatrix(t),h.inverse(this.getModelMatrix()).multVecMatrix(t);var i=2*this.getBrowser().getActiveLayer().getNavigationInfo().getNearValue();this.lookAt(t,i,e,n)}catch(t){console.error(t)}},lookAtBBox:function(t,e,n){try{if(!this.getBrowser().getActiveLayer())return;t=t.copy().multRight(h.inverse(this.getModelMatrix()));var i=2*this.getBrowser().getActiveLayer().getNavigationInfo().getNearValue();this.lookAt(t.center,i,e,n)}catch(t){}},lookAt:function(e,n,i,r){var o=this.getLayers(),s=e.copy().add(this.getUserOrientation().multVecRot(new l(0,0,n))).subtract(this.getPosition());o.forEach(function(t){t.getNavigationInfo().transitionStart_=!0}),this.timeSensor.cycleInterval_=.2,this.timeSensor.stopTime_=this.getBrowser().getCurrentTime(),this.timeSensor.startTime_=this.getBrowser().getCurrentTime(),this.timeSensor.isActive_.addInterest("set_active__",this),this.easeInEaseOut.easeInEaseOut_=new t.MFVec2f(new t.SFVec2f(0,1),new t.SFVec2f(1,0));var a=l.lerp(this.positionOffset_.getValue(),s,i),u=l.add(this.getPosition(),a).subtract(e),h=c.multRight(this.orientationOffset_.getValue(),new c(this.getUserOrientation().multVecRot(new l(0,0,1)),u));r&&(h=c.inverse(this.getOrientation()).multRight(this.straightenHorizon(c.multRight(this.getOrientation(),h)))),this.positionInterpolator.keyValue_=new t.MFVec3f(this.positionOffset_,a),this.orientationInterpolator.keyValue_=new t.MFRotation(this.orientationOffset_,h),this.scaleInterpolator.keyValue_=new t.MFVec3f(this.scaleOffset_,this.scaleOffset_),this.scaleOrientationInterpolator.keyValue_=new t.MFRotation(this.scaleOrientationOffset_,this.scaleOrientationOffset_),this.setInterpolators(this),this.centerOfRotationOffset_=l.subtract(e,this.getCenterOfRotation()),this.set_bind_=!0},straighten:function(e){this.getLayers().forEach(function(t){t.getNavigationInfo().transitionStart_=!0}),this.timeSensor.cycleInterval_=.4,this.timeSensor.stopTime_=this.getBrowser().getCurrentTime(),this.timeSensor.startTime_=this.getBrowser().getCurrentTime(),this.timeSensor.isActive_.addInterest("set_active__",this),this.easeInEaseOut.easeInEaseOut_=new t.MFVec2f(new t.SFVec2f(0,1),new t.SFVec2f(1,0));var n=c.multRight(c.inverse(this.getOrientation()),this.straightenHorizon(this.getUserOrientation()));this.positionInterpolator.keyValue_=new t.MFVec3f(this.positionOffset_,this.positionOffset_),this.orientationInterpolator.keyValue_=new t.MFRotation(this.orientationOffset_,n),this.scaleInterpolator.keyValue_=new t.MFVec3f(this.scaleOffset_,this.scaleOffset_),this.scaleOrientationInterpolator.keyValue_=new t.MFRotation(this.scaleOrientationOffset_,this.scaleOrientationOffset_),this.setInterpolators(this),this.set_bind_=!0},straightenHorizon:function(){var t=new l(0,0,0),e=new l(0,0,0),n=(new l(0,0,0),new c(0,0,1,0));return function(i){i.multVecRot(t.assign(l.xAxis).negate()),i.multVecRot(e.assign(l.zAxis));var r=e.cross(this.getUpVector());return r.equals(l.Zero)?i:(n.setFromToVec(t,r),i.multRight(n))}}(),set_active__:function(t){if(!t.getValue()&&1===this.timeSensor.fraction_changed_.getValue()){for(var e=this.getLayers(),n=0;n<e.length;++n)e[n].getNavigationInfo().transitionComplete_=!0;this.easeInEaseOut.set_fraction_=1}},set_bound__:function(){this.isBound_.getValue()?this.getBrowser().getNotification().string_=this.description_:this.timeSensor.stopTime_=this.getBrowser().getCurrentTime()},traverse:function(t,e){e.getLayer().getViewpoints().push(this),this.modelMatrix.assign(e.getModelViewMatrix().get())},update:function(){try{this.cameraSpaceMatrix.set(this.getUserPosition(),this.getUserOrientation(),this.scaleOffset_.getValue(),this.scaleOrientationOffset_.getValue()),this.cameraSpaceMatrix.multRight(this.modelMatrix),this.inverseCameraSpaceMatrix.assign(this.cameraSpaceMatrix).inverse()}catch(t){console.log(t)}}}),d}),define("x_ite/Components/Interpolation/ScalarInterpolator",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.ScalarInterpolator)}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_fraction",new t.SFFloat),new e(r.inputOutput,"key",new t.MFFloat),new e(r.inputOutput,"keyValue",new t.MFFloat),new e(r.outputOnly,"value_changed",new t.SFFloat)]),getTypeName:function(){return"ScalarInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){var t=this.key_,e=this.keyValue_;e.length<t.length&&e.resize(t.length,e.length?e[e.length-1]:0)},interpolate:function(t,e,n){this.value_changed_=o.lerp(this.keyValue_[t],this.keyValue_[e],n)}}),s}),define("standard/Math/Geometry/Camera",["standard/Math/Numbers/Vector3"],function(t){"use strict";return{frustum:function(t,e,n,i,r,o,s){var a=e-t,u=i-n,l=o-r,c=2*r,h=(e+t)/a,d=(i+n)/u,p=-(o+r)/l,f=-c*o/l,g=c/a,m=c/u;return s.set(g,0,0,0,0,m,0,0,h,d,p,-1,0,0,f,0)},perspective:function(t,e,n,i,r,o){var s=Math.tan(t/2)*e;if(i>r){var a=i*s/r;return this.frustum(-a,a,-s,s,e,n,o)}var a=r*s/i;return this.frustum(-s,s,-a,a,e,n,o)},perspective2:function(t,e,n,i,r,o){var s=Math.tan(t/2)*e;return this.frustum(-s,s,-s,s,e,n,o)},ortho:function(t,e,n,i,r,o,s){var a=e-t,u=i-n,l=o-r,c=2/a,h=2/u,d=-2/l,p=-(e+t)/a,f=-(i+n)/u,g=-(o+r)/l;return s.set(c,0,0,0,0,h,0,0,0,0,d,0,p,f,g,1)},orthoBox:function(){var e=new t(0,0,0),n=new t(0,0,0);return function(t,i){return t.getExtents(e,n),this.ortho(e.x,n.x,e.y,n.y,-n.z,-e.z,i)}}()}}),define("x_ite/Components/Navigation/OrthoViewpoint",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Navigation/X3DViewpointNode","x_ite/Components/Interpolation/ScalarInterpolator","x_ite/Bits/X3DConstants","standard/Math/Geometry/Camera","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(t,e,n,i,r,o,s,a,u,l){"use strict";function c(t){i.call(this,t),this.addType(o.OrthoViewpoint),this.position_.setUnit("length"),this.centerOfRotation_.setUnit("length"),this.fieldOfView_.setUnit("length"),this.projectionMatrix=new l,this.fieldOfViewInterpolator=new r(this.getBrowser().getPrivateScene())}return c.prototype=Object.assign(Object.create(i.prototype),{constructor:c,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOnly,"set_bind",new t.SFBool),new e(o.inputOutput,"description",new t.SFString),new e(o.inputOutput,"position",new t.SFVec3f(0,0,10)),new e(o.inputOutput,"orientation",new t.SFRotation),new e(o.inputOutput,"centerOfRotation",new t.SFVec3f),new e(o.inputOutput,"fieldOfView",new t.MFFloat(-1,-1,1,1)),new e(o.inputOutput,"jump",new t.SFBool(!0)),new e(o.inputOutput,"retainUserOffsets",new t.SFBool),new e(o.outputOnly,"isBound",new t.SFBool),new e(o.outputOnly,"bindTime",new t.SFTime)]),getTypeName:function(){return"OrthoViewpoint"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.fieldOfView_.addInterest("set_fieldOfView___",this),this.fieldOfViewScale_.addInterest("set_fieldOfView___",this),this.fieldOfViewInterpolator.key_=new t.MFFloat(0,1),this.fieldOfViewInterpolator.setup(),this.getEaseInEaseOut().modifiedFraction_changed_.addFieldInterest(this.fieldOfViewInterpolator.set_fraction_),this.fieldOfViewInterpolator.value_changed_.addFieldInterest(this.fieldOfViewScale_),this.set_fieldOfView___()},set_fieldOfView___:function(){var t=this.fieldOfView_.length,e=this.fieldOfViewScale_.getValue();this.minimumX=(t>0?this.fieldOfView_[0]:-1)*e,this.minimumY=(t>1?this.fieldOfView_[1]:-1)*e,this.maximumX=(t>2?this.fieldOfView_[2]:1)*e,this.maximumY=(t>3?this.fieldOfView_[3]:1)*e,this.sizeX=this.maximumX-this.minimumX,this.sizeY=this.maximumY-this.minimumY},transitionStart:function(t){this.fromFieldOfViewScale=t.fieldOfViewScale_.getValue(),i.prototype.transitionStart.call(this,t)},setInterpolators:function(e){
e.getType().indexOf(o.OrthoViewpoint)<0?this.fieldOfViewInterpolator.keyValue_=new t.MFFloat(this.fieldOfViewScale_.getValue(),this.fieldOfViewScale_.getValue()):(this.fieldOfViewInterpolator.keyValue_=new t.MFFloat(this.fromFieldOfViewScale,this.fieldOfViewScale_.getValue()),this.fieldOfViewScale_=this.fromFieldOfViewScale)},getMinimumX:function(){return this.minimumX},getMinimumY:function(){return this.minimumY},getMaximumX:function(){return this.maximumX},getMaximumY:function(){return this.maximumY},getSizeX:function(){return this.sizeX},getSizeY:function(){return this.sizeY},getMaxFarValue:function(){return 1e5},getScreenScale:function(){var t=new u(0,0,0);return function(e,n){var i=n[2],r=n[3],o=this.sizeX,s=this.sizeY;if(i/r>o/s){var a=s/r;return t.set(a,a,a)}var a=o/i;return t.set(a,a,a)}}(),getViewportSize:function(){var t=new a(0,0);return function(e,n){var i=e[2],r=e[3],o=this.sizeX,s=this.sizeY,a=i/r;return a>o/s?t.set(s*a,s):t.set(o,o/a)}}(),getLookAtDistance:function(t){return t.size.abs()/2+10},getProjectionMatrixWithLimits:function(t,e,n){var i=n[2],r=n[3],o=i/r,a=this.sizeX,u=this.sizeY;if(o>a/u){var l=(this.minimumX+this.maximumX)/2,c=u*o/2;return s.ortho(l-c,l+c,this.minimumY,this.maximumY,t,e,this.projectionMatrix)}var l=(this.minimumY+this.maximumY)/2,c=a/o/2;return s.ortho(this.minimumX,this.maximumX,l-c,l+c,t,e,this.projectionMatrix)}}),c}),define("x_ite/Components/Shaders/X3DProgrammableShaderObject",["x_ite/Fields","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants","x_ite/Components/Navigation/OrthoViewpoint","standard/Math/Numbers/Matrix3"],function(t,e,n,i,r){"use strict";function o(t){this.addType(n.X3DProgrammableShaderObject),this.x3d_ClipPlane=[],this.x3d_LightType=[],this.x3d_LightOn=[],this.x3d_LightColor=[],this.x3d_LightIntensity=[],this.x3d_LightAmbientIntensity=[],this.x3d_LightAttenuation=[],this.x3d_LightLocation=[],this.x3d_LightDirection=[],this.x3d_LightBeamWidth=[],this.x3d_LightCutOffAngle=[],this.x3d_LightRadius=[],this.x3d_LightMatrix=[],this.x3d_ShadowIntensity=[],this.x3d_ShadowColor=[],this.x3d_ShadowBias=[],this.x3d_ShadowMatrix=[],this.x3d_ShadowMapSize=[],this.x3d_ShadowMap=[],this.x3d_TextureType=[],this.x3d_Texture2D=[],this.x3d_CubeMapTexture=[],this.x3d_MultiTextureMode=[],this.x3d_MultiTextureAlphaMode=[],this.x3d_MultiTextureSource=[],this.x3d_MultiTextureFunction=[],this.x3d_TextureCoordinateGeneratorMode=[],this.x3d_TextureCoordinateGeneratorParameter=[],this.x3d_TexCoord=[],this.x3d_TextureMatrix=[],this.numClipPlanes=0,this.fogNode=null,this.numGlobalLights=0,this.numLights=0,this.lightNodes=[],this.textures=new Map}return o.prototype={constructor:o,initialize:function(){var t=this.getBrowser();this.x3d_MaxClipPlanes=t.getMaxClipPlanes(),this.x3d_MaxLights=t.getMaxLights(),this.x3d_MaxTextures=t.getMaxTextures();for(var e=[],n=0,i=this.x3d_MaxClipPlanes;n<i;++n)e.push(0,0,-1,0);this.defaultClipPlanesArray=new Float32Array(e)},hasUserDefinedFields:function(){return!0},bindAttributeLocations:function(t,e){t.bindAttribLocation(e,0,"x3d_Vertex")},getDefaultUniforms:function(){var t=this.getBrowser(),e=t.getContext(),n=this.getProgram();this.x3d_LogarithmicFarFactor1_2=e.getUniformLocation(n,"x3d_LogarithmicFarFactor1_2"),this.x3d_GeometryType=e.getUniformLocation(n,"x3d_GeometryType"),this.x3d_NumClipPlanes=e.getUniformLocation(n,"x3d_NumClipPlanes"),this.x3d_ClipPlanes=e.getUniformLocation(n,"x3d_ClipPlane");for(var i=0;i<this.x3d_MaxClipPlanes;++i)this.x3d_ClipPlane[i]=e.getUniformLocation(n,"x3d_ClipPlane["+i+"]");this.x3d_FogType=this.getUniformLocation(e,n,"x3d_Fog.type","x3d_FogType"),this.x3d_FogColor=this.getUniformLocation(e,n,"x3d_Fog.color","x3d_FogColor"),this.x3d_FogVisibilityRange=this.getUniformLocation(e,n,"x3d_Fog.visibilityRange","x3d_FogVisibilityRange"),this.x3d_FogMatrix=this.getUniformLocation(e,n,"x3d_Fog.matrix","x3d_FogMatrix"),this.x3d_FogCoord=this.getUniformLocation(e,n,"x3d_Fog.fogCoord","x3d_FogCoord"),this.x3d_LinePropertiesApplied=e.getUniformLocation(n,"x3d_LineProperties.applied"),this.x3d_LinePropertiesLinewidthScaleFactor=this.getUniformLocation(e,n,"x3d_LineProperties.linewidthScaleFactor","x3d_LinewidthScaleFactor"),this.x3d_LinePropertiesLinetype=e.getUniformLocation(n,"x3d_LineProperties.linetype"),this.x3d_FillPropertiesFilled=e.getUniformLocation(n,"x3d_FillProperties.filled"),this.x3d_FillPropertiesHatched=e.getUniformLocation(n,"x3d_FillProperties.hatched"),this.x3d_FillPropertiesHatchColor=e.getUniformLocation(n,"x3d_FillProperties.hatchColor"),this.x3d_FillPropertiesHatchStyle=e.getUniformLocation(n,"x3d_FillProperties.hatchStyle"),this.x3d_Lighting=e.getUniformLocation(n,"x3d_Lighting"),this.x3d_ColorMaterial=e.getUniformLocation(n,"x3d_ColorMaterial"),this.x3d_NumLights=e.getUniformLocation(n,"x3d_NumLights");for(var i=0;i<this.x3d_MaxLights;++i)this.x3d_LightType[i]=this.getUniformLocation(e,n,"x3d_LightSource["+i+"].type","x3d_LightType["+i+"]"),this.x3d_LightColor[i]=this.getUniformLocation(e,n,"x3d_LightSource["+i+"].color","x3d_LightColor["+i+"]"),this.x3d_LightAmbientIntensity[i]=this.getUniformLocation(e,n,"x3d_LightSource["+i+"].ambientIntensity","x3d_LightAmbientIntensity["+i+"]"),this.x3d_LightIntensity[i]=this.getUniformLocation(e,n,"x3d_LightSource["+i+"].intensity","x3d_LightIntensity["+i+"]"),this.x3d_LightAttenuation[i]=this.getUniformLocation(e,n,"x3d_LightSource["+i+"].attenuation","x3d_LightAttenuation["+i+"]"),this.x3d_LightLocation[i]=this.getUniformLocation(e,n,"x3d_LightSource["+i+"].location","x3d_LightLocation["+i+"]"),this.x3d_LightDirection[i]=this.getUniformLocation(e,n,"x3d_LightSource["+i+"].direction","x3d_LightDirection["+i+"]"),this.x3d_LightBeamWidth[i]=this.getUniformLocation(e,n,"x3d_LightSource["+i+"].beamWidth","x3d_LightBeamWidth["+i+"]"),this.x3d_LightCutOffAngle[i]=this.getUniformLocation(e,n,"x3d_LightSource["+i+"].cutOffAngle","x3d_LightCutOffAngle["+i+"]"),this.x3d_LightRadius[i]=this.getUniformLocation(e,n,"x3d_LightSource["+i+"].radius","x3d_LightRadius["+i+"]"),this.x3d_LightMatrix[i]=this.getUniformLocation(e,n,"x3d_LightSource["+i+"].matrix","x3d_LightMatrix["+i+"]"),this.x3d_ShadowIntensity[i]=e.getUniformLocation(n,"x3d_LightSource["+i+"].shadowIntensity"),this.x3d_ShadowColor[i]=e.getUniformLocation(n,"x3d_LightSource["+i+"].shadowColor"),this.x3d_ShadowBias[i]=e.getUniformLocation(n,"x3d_LightSource["+i+"].shadowBias"),this.x3d_ShadowMatrix[i]=e.getUniformLocation(n,"x3d_LightSource["+i+"].shadowMatrix"),this.x3d_ShadowMapSize[i]=e.getUniformLocation(n,"x3d_LightSource["+i+"].shadowMapSize"),this.x3d_ShadowMap[i]=e.getUniformLocation(n,"x3d_ShadowMap["+i+"]");this.x3d_SeparateBackColor=e.getUniformLocation(n,"x3d_SeparateBackColor"),this.x3d_AmbientIntensity=this.getUniformLocation(e,n,"x3d_FrontMaterial.ambientIntensity","x3d_AmbientIntensity"),this.x3d_DiffuseColor=this.getUniformLocation(e,n,"x3d_FrontMaterial.diffuseColor","x3d_DiffuseColor"),this.x3d_SpecularColor=this.getUniformLocation(e,n,"x3d_FrontMaterial.specularColor","x3d_SpecularColor"),this.x3d_EmissiveColor=this.getUniformLocation(e,n,"x3d_FrontMaterial.emissiveColor","x3d_EmissiveColor"),this.x3d_Shininess=this.getUniformLocation(e,n,"x3d_FrontMaterial.shininess","x3d_Shininess"),this.x3d_Transparency=this.getUniformLocation(e,n,"x3d_FrontMaterial.transparency","x3d_Transparency"),this.x3d_BackAmbientIntensity=this.getUniformLocation(e,n,"x3d_BackMaterial.ambientIntensity","x3d_BackAmbientIntensity"),this.x3d_BackDiffuseColor=this.getUniformLocation(e,n,"x3d_BackMaterial.diffuseColor","x3d_BackDiffuseColor"),this.x3d_BackSpecularColor=this.getUniformLocation(e,n,"x3d_BackMaterial.specularColor","x3d_BackSpecularColor"),this.x3d_BackEmissiveColor=this.getUniformLocation(e,n,"x3d_BackMaterial.emissiveColor","x3d_BackEmissiveColor"),this.x3d_BackShininess=this.getUniformLocation(e,n,"x3d_BackMaterial.shininess","x3d_BackShininess"),this.x3d_BackTransparency=this.getUniformLocation(e,n,"x3d_BackMaterial.transparency","x3d_BackTransparency"),this.x3d_NumTextures=e.getUniformLocation(n,"x3d_NumTextures"),this.x3d_MultiTextureColor=e.getUniformLocation(n,"x3d_MultiTextureColor");for(var i=0;i<this.x3d_MaxTextures;++i)this.x3d_TextureType[i]=e.getUniformLocation(n,"x3d_TextureType["+i+"]"),this.x3d_Texture2D[i]=e.getUniformLocation(n,"x3d_Texture2D["+i+"]"),this.x3d_CubeMapTexture[i]=e.getUniformLocation(n,"x3d_CubeMapTexture["+i+"]"),this.x3d_MultiTextureMode[i]=e.getUniformLocation(n,"x3d_MultiTexture["+i+"].mode"),this.x3d_MultiTextureAlphaMode[i]=e.getUniformLocation(n,"x3d_MultiTexture["+i+"].alphaMode"),this.x3d_MultiTextureSource[i]=e.getUniformLocation(n,"x3d_MultiTexture["+i+"].source"),this.x3d_MultiTextureFunction[i]=e.getUniformLocation(n,"x3d_MultiTexture["+i+"].function"),this.x3d_TextureCoordinateGeneratorMode[i]=e.getUniformLocation(n,"x3d_TextureCoordinateGenerator["+i+"].mode"),this.x3d_TextureCoordinateGeneratorParameter[i]=e.getUniformLocation(n,"x3d_TextureCoordinateGenerator["+i+"].parameter");this.x3d_Viewport=e.getUniformLocation(n,"x3d_Viewport"),this.x3d_ProjectionMatrix=e.getUniformLocation(n,"x3d_ProjectionMatrix"),this.x3d_ModelViewMatrix=e.getUniformLocation(n,"x3d_ModelViewMatrix"),this.x3d_NormalMatrix=e.getUniformLocation(n,"x3d_NormalMatrix"),this.x3d_CameraSpaceMatrix=e.getUniformLocation(n,"x3d_CameraSpaceMatrix");for(var i=0;i<this.x3d_MaxTextures;++i)this.x3d_TextureMatrix[i]=e.getUniformLocation(n,"x3d_TextureMatrix["+i+"]");this.x3d_FogDepth=e.getAttribLocation(n,"x3d_FogDepth"),this.x3d_Color=e.getAttribLocation(n,"x3d_Color"),this.x3d_Normal=e.getAttribLocation(n,"x3d_Normal"),this.x3d_Vertex=e.getAttribLocation(n,"x3d_Vertex");for(var r=0,o=this.x3d_MaxTextures;r<o;++r)this.x3d_TexCoord[r]=this.getAttribLocation(e,n,"x3d_TexCoord"+r,r?"":"x3d_TexCoord");return this.x3d_ParticleId=e.getUniformLocation(n,"x3d_Particle.id"),this.x3d_ParticleLife=e.getUniformLocation(n,"x3d_Particle.life"),this.x3d_ParticleElapsedTime=e.getUniformLocation(n,"x3d_Particle.elapsedTime"),e.uniform1i(this.x3d_LinePropertiesLinetype,t.getLinetypeUnit()),e.uniform1i(this.x3d_FillPropertiesHatchStyle,t.getHatchStyleUnit()),e.uniform1i(this.x3d_NumTextures,0),e.uniform1iv(this.x3d_Texture2D[0],t.getTexture2DUnits()),e.uniform1iv(this.x3d_CubeMapTexture[0],t.getCubeMapTextureUnits()),e.uniform1iv(this.x3d_ShadowMap[0],new Int32Array(this.x3d_MaxLights).fill(t.getShadowTextureUnit())),this.x3d_FogDepth<0?(this.enableFogDepthAttribute=Function.prototype,this.disableFogDepthAttribute=Function.prototype):(delete this.enableFogDepthAttribute,delete this.disableFogDepthAttribute),this.x3d_Color<0?(this.enableColorAttribute=Function.prototype,this.disableColorAttribute=Function.prototype):(delete this.enableColorAttribute,delete this.disableColorAttribute),this.x3d_TexCoord.some(function(t){return t>=0})?(delete this.enableTexCoordAttribute,delete this.disableTexCoordAttribute):(this.enableTexCoordAttribute=Function.prototype,this.disableTexCoordAttribute=Function.prototype),this.x3d_Normal<0?(this.enableNormalAttribute=Function.prototype,this.disableNormalAttribute=Function.prototype):(delete this.enableNormalAttribute,delete this.disableNormalAttribute),!(this.x3d_Vertex<0)||(console.warn("Missing »attribute vec4 x3d_Vertex;«."),!1)},getUniformLocation:function(t,e,n,i){var r=t.getUniformLocation(e,n);return r?r:i?(r=t.getUniformLocation(e,i),r&&console.error(this.getTypeName(),this.getName(),"Using uniform location name »"+i+"« is depreciated, use »"+n+"«. See http://create3000.de/x_ite/custom-shaders/."),r):0},getAttribLocation:function(t,e,n,i){var r=t.getAttribLocation(e,n);return r>=0?r:i?(r=t.getAttribLocation(e,i),r>=0&&console.error(this.getTypeName(),this.getName(),"Using attribute location name »"+i+"« is depreciated, use »"+n+"«. See http://create3000.de/x_ite/custom-shaders/."),r):-1},addShaderFields:function(){var t=this.getBrowser().getContext(),e=this.getProgram(),i=this.getUserDefinedFields();this.textures.clear(),i.forEach(function(i){var r=t.getUniformLocation(e,i.getName());if(r){switch(i._uniformLocation=r,i.addInterest("set_field__",this),i.getType()){case n.SFImage:r.array=new Int32Array(3+i.array.length);break;case n.SFMatrix3d:case n.SFMatrix3f:case n.SFRotation:r.array=new Float32Array(9);break;case n.SFMatrix4d:case n.SFMatrix4f:r.array=new Float32Array(16);break;case n.SFNode:break;case n.MFBool:case n.MFInt32:r.array=new Int32Array(this.getLocationLength(t,e,i));break;case n.MFFloat:case n.MFDouble:case n.MFTime:r.array=new Float32Array(this.getLocationLength(t,e,i));break;case n.MFImage:r.array=new Int32Array(this.getImagesLength(i));break;case n.MFMatrix3d:case n.MFMatrix3f:case n.MFRotation:r.array=new Float32Array(9*this.getLocationLength(t,e,i));break;case n.MFMatrix4d:case n.MFMatrix4f:r.array=new Float32Array(16*this.getLocationLength(t,e,i));break;case n.MFNode:for(var o=r.locations=[],s=0;;++s){var a=t.getUniformLocation(e,i.getName()+"["+s+"]");if(!a)break;o.push(a)}break;case n.MFVec2d:case n.MFVec2f:r.array=new Float32Array(2*this.getLocationLength(t,e,i));break;case n.MFVec3d:case n.MFVec3f:case n.MFColor:r.array=new Float32Array(3*this.getLocationLength(t,e,i));break;case n.MFVec4d:case n.MFVec4f:case n.MFColorRGBA:r.array=new Float32Array(4*this.getLocationLength(t,e,i))}this.set_field__(i)}},this)},removeShaderFields:function(){this.getUserDefinedFields().forEach(function(t){t.removeInterest("set_field__",this)},this)},set_field__:function(){var t=new r;return function(i){var r=this.getBrowser().getContext(),o=i._uniformLocation;if(o)switch(i.getType()){case n.SFBool:case n.SFInt32:return void r.uniform1i(o,i.getValue());case n.SFColor:var s=i.getValue();return void r.uniform3f(o,s.r,s.g,s.b);case n.SFColorRGBA:var s=i.getValue();return void r.uniform4f(o,s.r,s.g,s.b,s.a);case n.SFDouble:case n.SFFloat:case n.SFTime:return void r.uniform1f(o,i.getValue());case n.SFImage:var a=o.array,u=i.array,l=3+u.length;l!==a.length&&(a=o.array=new Int32Array(l)),a[0]=i.width,a[1]=i.height,a[2]=i.comp;for(var c=3,h=0,l=u.length;h<l;++h,++c)a[c]=u[h];return void r.uniform1iv(o,a);case n.SFMatrix3d:case n.SFMatrix3f:return o.array.set(i.getValue()),void r.uniformMatrix3fv(o,!1,o.array);case n.SFMatrix4d:case n.SFMatrix4f:return o.array.set(i.getValue()),void r.uniformMatrix4fv(o,!1,o.array);case n.SFNode:var d=e(n.X3DTextureNode,i);return d?void this.textures.set(o,{name:i.getName(),texture:d,textureUnit:void 0}):void this.textures.delete(o);case n.SFRotation:return i.getValue().getMatrix(o.array),void r.uniformMatrix3fv(o,!1,o.array);case n.SFString:return;case n.SFVec2d:case n.SFVec2f:var s=i.getValue();return void r.uniform2f(o,s.x,s.y);case n.SFVec3d:case n.SFVec3f:var s=i.getValue();return void r.uniform3f(o,s.x,s.y,s.z);case n.SFVec4d:case n.SFVec4f:var s=i.getValue();return void r.uniform4f(o,s.x,s.y,s.z,s.w);case n.MFBool:case n.MFInt32:for(var a=o.array,p=0,l=i.length;p<l;++p)a[p]=i[p];for(var l=a.length;p<l;++p)a[p]=0;return void r.uniform1iv(o,a);case n.MFColor:for(var a=o.array,p=0,f=0,l=i.length;p<l;++p){var g=i[p];a[f++]=g.r,a[f++]=g.g,a[f++]=g.b}for(var l=a.length;f<l;++f)a[f]=0;return void r.uniform3fv(o,a);case n.MFColorRGBA:for(var a=o.array,p=0,f=0,l=i.length;p<l;++p){var g=i[p];a[f++]=g.r,a[f++]=g.g,a[f++]=g.b,a[f++]=g.a}for(var l=a.length;f<l;++f)a[f]=0;return void r.uniform4fv(o,a);case n.MFDouble:case n.MFFloat:case n.MFTime:for(var a=o.array,p=0,l=i.length;p<l;++p)a[p]=i[p];for(var l=a.length;p<l;++p)a[p]=0;return void r.uniform1fv(o,a);case n.MFImage:var a=o.array,l=this.getImagesLength(i);l!==a.length&&(a=o.array=new Int32Array(l));for(var p=0,c=0,l=i.length;p<l;++p){var s=i[p],u=s.array;a[c++]=s.width,a[c++]=s.height,a[c++]=s.comp;for(var h=0,m=u.length;h<m;++h)a[c++]=u[h]}return void r.uniform1iv(o,a);case n.MFMatrix3d:case n.MFMatrix3f:for(var a=o.array,p=0,f=0,l=i.length;p<l;++p)for(var x=i[p],v=0;v<9;++v)a[f++]=x[v];for(var l=a.length;f<l;++f)a[f]=0;return void r.uniformMatrix3fv(o,!1,a);case n.MFMatrix4d:case n.MFMatrix4f:for(var a=o.array,p=0,f=0,l=i.length;p<l;++p)for(var x=i[p],v=0;v<16;++v)a[f++]=x[v];for(var l=a.length;f<l;++f)a[f]=0;return void r.uniformMatrix4fv(o,!1,a);case n.MFNode:for(var _=o.locations,p=0,l=i.length;p<l;++p){var d=e(n.X3DTextureNode,i[p]);d&&this.textures.set(_[p],{name:i[p].getName(),texture:d,textureUnit:void 0})}return;case n.MFRotation:for(var a=o.array,p=0,f=0,l=i.length;p<l;++p){var x=i[p].getValue().getMatrix(t);a[f++]=x[0],a[f++]=x[1],a[f++]=x[2],a[f++]=x[3],a[f++]=x[4],a[f++]=x[5],a[f++]=x[6],a[f++]=x[7],a[f++]=x[8]}for(var l=a.length;f<l;++f)a[f]=0;return void r.uniformMatrix3fv(o,!1,a);case n.MFString:return;case n.MFVec2d:case n.MFVec2f:for(var a=o.array,p=0,f=0,l=i.length;p<l;++p){var y=i[p];a[f++]=y.x,a[f++]=y.y}for(var l=a.length;f<l;++f)a[f]=0;return void r.uniform2fv(o,a);case n.MFVec3d:case n.MFVec3f:for(var a=o.array,p=0,f=0,l=i.length;p<l;++p){var y=i[p];a[f++]=y.x,a[f++]=y.y,a[f++]=y.z}for(var l=a.length;f<l;++f)a[f]=0;return void r.uniform3fv(o,a);case n.MFVec4d:case n.MFVec4f:for(var a=o.array,p=0,f=0,l=i.length;p<l;++p){var y=i[p];a[f++]=y.x,a[f++]=y.y,a[f++]=y.z,a[f++]=y.w}for(var l=a.length;f<l;++f)a[f]=0;return void r.uniform4fv(o,a)}}}(),getImagesLength:function(t){for(var e=t.getValue(),n=3*e.length,i=0,r=e.length;i<r;++i)n+=e[i].array.length;return n},getLocationLength:function(t,e,n){for(var i=n.getName(),r=0;;++r){if(!t.getUniformLocation(e,i+"["+r+"]"))break}return r},hasFog:function(t){return this.fogNode===t||(this.fogNode=t,!1)},hasLight:function(t,e){return this.lightNodes[t]===e||(this.lightNodes[t]=e,!1)},setShaderObjects:function(t,e){this.numClipPlanes=0,this.numLights=0,this.lightNodes.length=0,t.uniform4fv(this.x3d_ClipPlanes,this.defaultClipPlanesArray);for(var n=0,i=e.length;n<i;++n)e[n].setShaderUniforms(t,this);t.uniform1i(this.x3d_NumClipPlanes,Math.min(this.numClipPlanes,this.x3d_MaxClipPlanes)),t.uniform1i(this.x3d_NumLights,Math.min(this.numLights,this.x3d_MaxLights))},setGlobalUniforms:function(t,e,n,r,o){var s=e.getGlobalLights();t.uniform4iv(this.x3d_Viewport,o),t.uniformMatrix4fv(this.x3d_ProjectionMatrix,!1,r),t.uniformMatrix4fv(this.x3d_CameraSpaceMatrix,!1,n),this.fogNode=null,this.numGlobalLights=s.length,this.numLights=0,this.lightNodes.length=0;for(var a=0,u=s.length;a<u;++a)s[a].setShaderUniforms(t,this);var l=e.getViewpoint(),c=e.getNavigationInfo();l instanceof i?t.uniform1f(this.x3d_LogarithmicFarFactor1_2,-1):t.uniform1f(this.x3d_LogarithmicFarFactor1_2,1/Math.log2(c.getFarValue(l)+1))},setLocalUniforms:function(t,e){var n=e.linePropertiesNode,i=e.fillPropertiesNode,r=e.materialNode,o=e.textureNode,s=e.textureTransformNode,a=e.textureCoordinateNode,u=e.modelViewMatrix,l=e.shaderObjects;t.uniform1i(this.x3d_GeometryType,e.geometryType),this.numClipPlanes=0,this.numLights=this.numGlobalLights,t.uniform4fv(this.x3d_ClipPlanes,this.defaultClipPlanesArray);for(var c=0,h=l.length;c<h;++c)l[c].setShaderUniforms(t,this);t.uniform1i(this.x3d_NumClipPlanes,Math.min(this.numClipPlanes,this.x3d_MaxClipPlanes)),t.uniform1i(this.x3d_NumLights,Math.min(this.numLights,this.x3d_MaxLights)),e.fogNode.setShaderUniforms(t,this),t.uniform1i(this.x3d_FogCoord,e.fogCoords),e.geometryType<2?n.setShaderUniforms(t,this):i.setShaderUniforms(t,this),t.uniform1i(this.x3d_ColorMaterial,e.colorMaterial),r?(t.uniform1i(this.x3d_Lighting,!0),r.setShaderUniforms(t,this),t.uniformMatrix3fv(this.x3d_NormalMatrix,!1,this.getNormalMatrix(u))):(t.uniform1i(this.x3d_Lighting,!1),this.getCustom()&&t.uniformMatrix3fv(this.x3d_NormalMatrix,!1,this.getNormalMatrix(u))),o?(o.setShaderUniforms(t,this),s.setShaderUniforms(t,this),a.setShaderUniforms(t,this)):(t.uniform1i(this.x3d_NumTextures,0),this.getCustom()&&(s.setShaderUniforms(t,this),a.setShaderUniforms(t,this))),t.uniformMatrix4fv(this.x3d_ModelViewMatrix,!1,u)},getNormalMatrix:function(){var t=new Float32Array(9);return function(e){try{return t[0]=e[0],t[3]=e[1],t[6]=e[2],t[1]=e[4],t[4]=e[5],t[7]=e[6],t[2]=e[8],t[5]=e[9],t[8]=e[10],r.prototype.inverse.call(t),t}catch(e){return t.set(r.Identity),t}}}(),enable:function(t){var e=this.getBrowser();this.textures.forEach(function(n,i){var r=n.name,o=n.texture;if(!e.getCombinedTextureUnits().length)return void console.warn("Not enough combined texture units for uniform variable '"+r+"' available.");var s=n.textureUnit=e.getCombinedTextureUnits().pop();t.uniform1i(i,s),t.activeTexture(t.TEXTURE0+s),t.bindTexture(o.getTarget(),o.getTexture())}),t.activeTexture(t.TEXTURE0)},disable:function(t){var e=this.getBrowser();this.textures.forEach(function(t){var n=t.textureUnit;void 0!==n&&e.getCombinedTextureUnits().push(n),t.textureUnit=void 0})},enableFloatAttrib:function(t,e,n,i){var r=t.getAttribLocation(this.getProgram(),e);r!==-1&&(t.enableVertexAttribArray(r),t.bindBuffer(t.ARRAY_BUFFER,n),t.vertexAttribPointer(r,i,t.FLOAT,!1,0,0))},disableFloatAttrib:function(t,e){var n=t.getAttribLocation(this.getProgram(),e);n!==-1&&t.disableVertexAttribArray(n)},enableMatrix3Attrib:function(t,e,n){var i=t.getAttribLocation(this.getProgram(),e);i!==-1&&(t.enableVertexAttribArray(i),t.enableVertexAttribArray(i+1),t.enableVertexAttribArray(i+2),t.bindBuffer(t.ARRAY_BUFFER,n),t.vertexAttribPointer(i,3,t.FLOAT,!1,36,0),t.vertexAttribPointer(i+1,3,t.FLOAT,!1,36,12),t.vertexAttribPointer(i+2,3,t.FLOAT,!1,36,24))},disableMatrix3Attrib:function(t,e){var n=t.getAttribLocation(this.getProgram(),e);n!==-1&&(t.disableVertexAttribArray(n),t.disableVertexAttribArray(n+1),t.disableVertexAttribArray(n+2))},enableMatrix4Attrib:function(t,e,n){var i=t.getAttribLocation(this.getProgram(),e);i!==-1&&(t.enableVertexAttribArray(i),t.enableVertexAttribArray(i+1),t.enableVertexAttribArray(i+2),t.enableVertexAttribArray(i+3),t.bindBuffer(t.ARRAY_BUFFER,n),t.vertexAttribPointer(i,4,t.FLOAT,!1,64,0),t.vertexAttribPointer(i+1,4,t.FLOAT,!1,64,16),t.vertexAttribPointer(i+2,4,t.FLOAT,!1,64,32),t.vertexAttribPointer(i+3,4,t.FLOAT,!1,64,48))},disableMatrix4Attrib:function(t,e){var n=t.getAttribLocation(this.getProgram(),e);n!==-1&&(t.disableVertexAttribArray(n),t.disableVertexAttribArray(n+1),t.disableVertexAttribArray(n+2),t.disableVertexAttribArray(n+3))},enableFogDepthAttribute:function(t,e){t.enableVertexAttribArray(this.x3d_FogDepth),t.bindBuffer(t.ARRAY_BUFFER,e),t.vertexAttribPointer(this.x3d_FogDepth,1,t.FLOAT,!1,0,0)},disableFogDepthAttribute:function(t){t.disableVertexAttribArray(this.x3d_FogDepth)},enableColorAttribute:function(t,e){t.enableVertexAttribArray(this.x3d_Color),t.bindBuffer(t.ARRAY_BUFFER,e),t.vertexAttribPointer(this.x3d_Color,4,t.FLOAT,!1,0,0)},disableColorAttribute:function(t){t.disableVertexAttribArray(this.x3d_Color)},enableTexCoordAttribute:function(t,e,n){for(var i=Math.min(this.x3d_MaxTextures,e.length),r=0;r<i;++r){var o=this.x3d_TexCoord[r];o!==-1&&(t.enableVertexAttribArray(o),t.bindBuffer(t.ARRAY_BUFFER,e[r]),t.vertexAttribPointer(o,4,t.FLOAT,!1,0,0))}},disableTexCoordAttribute:function(t){for(var e=0,n=this.x3d_MaxTextures;e<n;++e){var i=this.x3d_TexCoord[e];i!==-1&&t.disableVertexAttribArray(i)}},enableNormalAttribute:function(t,e){t.enableVertexAttribArray(this.x3d_Normal),t.bindBuffer(t.ARRAY_BUFFER,e),t.vertexAttribPointer(this.x3d_Normal,3,t.FLOAT,!1,0,0)},disableNormalAttribute:function(t){t.disableVertexAttribArray(this.x3d_Normal)},enableVertexAttribute:function(t,e){t.enableVertexAttribArray(this.x3d_Vertex),t.bindBuffer(t.ARRAY_BUFFER,e),t.vertexAttribPointer(this.x3d_Vertex,4,t.FLOAT,!1,0,0)},disableVertexAttribute:function(t){t.disableVertexAttribArray(this.x3d_Vertex)},setParticle:function(t,e,n,i,r){r&&t.uniformMatrix3fv(this.x3d_NormalMatrix,!1,this.getNormalMatrix(i)),t.uniformMatrix4fv(this.x3d_ModelViewMatrix,!1,i),t.uniform1i(this.x3d_ParticleId,e),t.uniform1i(this.x3d_ParticleLife,n.life),t.uniform1f(this.x3d_ParticleElapsedTime,n.elapsedTime/n.lifetime)},getProgramInfo:function(){function t(t,e){return t<e?-1:t>e?1:0}for(var e=this.getBrowser().getContext(),n=this.getProgram(),i={attributes:[],uniforms:[],attributeCount:0,uniformCount:0},r=e.getProgramParameter(n,e.ACTIVE_UNIFORMS),o=e.getProgramParameter(n,e.ACTIVE_ATTRIBUTES),s={35664:"vec2",35665:"vec3",35666:"vec4",35667:"ivec2",35668:"ivec3",35669:"ivec4",35670:"bool",35671:"bvec2",35672:"bvec3",35673:"bvec4",35674:"mat2",35675:"mat3",35676:"mat4",35678:"sampler2D",35680:"samplerCube",5120:"byte",5121:"ubyte",5122:"short",5123:"ushort",5124:"int",5125:"uint",5126:"float"},a=0;a<r;++a){var u=e.getActiveUniform(n,a);u.typeName=s[u.type],i.uniforms.push(Object.assign({},u)),i.uniformCount+=u.size}for(var a=0;a<o;++a){var l=e.getActiveAttrib(n,a);l.typeName=s[l.type],i.attributes.push(Object.assign({},l)),i.attributeCount+=l.size}return i.uniforms.sort(function(e,n){return t(e.name,n.name)}),i.attributes.sort(function(e,n){return t(e.name,n.name)}),i},printProgramInfo:function(){var t=this.getProgramInfo();console.log(this.getName()),console.table(t.attributes),console.log(this.getName(),"attributeCount",t.attributeCount),console.log(this.getName()),console.table(t.uniforms),console.log(this.getName(),"uniformCount",t.uniformCount)}},o}),define("x_ite/Components/Networking/X3DNetworkSensorNode",["x_ite/Components/Core/X3DSensorNode","x_ite/Bits/X3DConstants"],function(t,e){"use strict";function n(n){t.call(this,n),this.addType(e.X3DNetworkSensorNode)}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n}),n}),define("x_ite/Components/Networking/LoadSensor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Networking/X3DNetworkSensorNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(o.LoadSensor),this.urlObjects=[],this.aborted=!1,this.timeOutId=void 0}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOutput,"enabled",new t.SFBool(!0)),new e(o.inputOutput,"timeOut",new t.SFTime),new e(o.outputOnly,"isActive",new t.SFBool),new e(o.outputOnly,"isLoaded",new t.SFBool),new e(o.outputOnly,"progress",new t.SFFloat),new e(o.outputOnly,"loadTime",new t.SFTime),new e(o.inputOutput,"watchList",new t.MFNode)]),getTypeName:function(){return"LoadSensor"},getComponentName:function(){return"Networking"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.enabled_.addInterest("set_enabled__",this),this.timeOut_.addInterest("set_timeOut__",this),this.watchList_.addInterest("set_watchList__",this),this.watchList_.addEvent()},set_enabled__:function(){this.enabled_.getValue()?this.reset():(this.abort(),this.remove())},set_timeOut__:function(){this.isActive_.getValue()&&(this.clearTimeout(),this.aborted=!1,this.timeOut_.getValue()>0&&(this.timeOutId=setTimeout(this.abort.bind(this),1e3*this.timeOut_.getValue())))},set_watchList__:function(){this.reset()},set_loadState__:function(t,e){switch(e.checkLoadState()){case o.NOT_STARTED_STATE:break;case o.IN_PROGRESS_STATE:case o.COMPLETE_STATE:case o.FAILED_STATE:this.count()}},count:function(){for(var t=0,e=0,n=this.urlObjects,i=0,r=n.length;i<r;++i){var s=n[i];t+=s.checkLoadState()==o.COMPLETE_STATE,e+=s.checkLoadState()==o.FAILED_STATE}var a=t==n.length,u=t/n.length;this.aborted||e||a?(this.clearTimeout(),this.isActive_=!1,this.isLoaded_=a,this.progress_=u,a&&(this.loadTime_=this.getBrowser().getCurrentTime())):this.isActive_.getValue()?this.progress_=u:(this.isActive_=!0,this.progress_=u,this.set_timeOut__())},abort:function(){this.clearTimeout(),this.aborted=!0,this.enabled_.getValue()&&this.count()},reset:function(){if(this.remove(),this.enabled_.getValue()){for(var t=this.watchList_.getValue(),e=this.urlObjects,n=0,i=t.length;n<i;++n){var s=r(o.X3DUrlObject,t[n]);s&&(e.push(s),s.loadState_.addInterest("set_loadState__",this,s))}this.count()}},remove:function(){this.clearTimeout();for(var t=this.urlObjects,e=0,n=t.length;e<n;++e)t[e].loadState_.removeInterest("set_loadState__",this);t.length=0},clearTimeout:function(){clearTimeout(this.timeOutId),this.timeOutId=void 0}}),s}),define("x_ite/Components/Shaders/ComposedShader",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shaders/X3DShaderNode","x_ite/Components/Shaders/X3DProgrammableShaderObject","x_ite/Components/Networking/LoadSensor","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(t,e,n,i,r,o,s,a){"use strict";function u(t){i.call(this,t),r.call(this,t),this.addType(a.ComposedShader),this.loadSensor=new o(t)}return u.prototype=Object.assign(Object.create(i.prototype),r.prototype,{constructor:u,fieldDefinitions:new n([new e(a.inputOutput,"metadata",new t.SFNode),new e(a.inputOnly,"activate",new t.SFBool),new e(a.outputOnly,"isSelected",new t.SFBool),new e(a.outputOnly,"isValid",new t.SFBool),new e(a.initializeOnly,"language",new t.SFString),new e(a.inputOutput,"parts",new t.MFNode)]),wireframe:!1,getTypeName:function(){return"ComposedShader"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"shaders"},initialize:function(){i.prototype.initialize.call(this),r.prototype.initialize.call(this);var t=this.getBrowser().getContext();this.primitiveMode=t.TRIANGLES,this.isLive().addInterest("set_live__",this),this.activate_.addInterest("set_activate__",this),this.parts_.addFieldInterest(this.loadSensor.watchList_),this.loadSensor.isLoaded_.addInterest("set_loaded__",this),this.loadSensor.watchList_=this.parts_,this.loadSensor.setPrivate(!0),this.loadSensor.setup()},getProgram:function(){return this.program},set_live__:function(){var t=this.getBrowser().getContext();this.isLive().getValue()?this.getValid()&&(this.enable(t),this.addShaderFields(),this.disable(t)):this.getValid()&&(this.enable(t),this.removeShaderFields(),this.disable(t))},set_activate__:function(){this.activate_.getValue()&&this.set_loaded__()},set_loaded__:function(){if(this.loadSensor.isLoaded_.getValue()){var t=this.getBrowser().getContext(),e=t.createProgram(),n=this.parts_.getValue(),i=0;this.getValid()&&this.removeShaderFields(),this.program=e;for(var r=0,o=n.length;r<o;++r){var u=s(a.ShaderPart,n[r]);u&&(i+=u.isValid(),t.attachShader(e,u.getShader()))}i&&(this.bindAttributeLocations(t,e),t.linkProgram(e),i=i&&t.getProgramParameter(e,t.LINK_STATUS)),i?(t.useProgram(this.program),this.getDefaultUniforms()?this.addShaderFields():i=!1):console.warn("Couldn't initialize "+this.getTypeName()+" '"+this.getName()+"': "+t.getProgramInfoLog(e)),this.setValid(!!i)}else this.setValid(!1)},set_field__:function(t){this.getBrowser().getContext().useProgram(this.program),r.prototype.set_field__.call(this,t)},setGlobalUniforms:function(t,e,n,i,o){t.useProgram(this.program),r.prototype.setGlobalUniforms.call(this,t,e,n,i,o)},enable:function(t){t.useProgram(this.program),r.prototype.enable.call(this,t)}}),u}),define("text!x_ite/Browser/Shaders/WebGL1/Include/ClipPlanes.h",[],function(){return"/* -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-*/\n\nuniform int  x3d_NumClipPlanes;\nuniform vec4 x3d_ClipPlane [x3d_MaxClipPlanes];\n\nvoid\nclip ()\n{\n\tfor (int i = 0; i < x3d_MaxClipPlanes; ++ i)\n\t{\n\t\tif (i == x3d_NumClipPlanes)\n\t\t\tbreak;\n\n\t\tif (dot (vertex, x3d_ClipPlane [i] .xyz) - x3d_ClipPlane [i] .w < 0.0)\n\t\t\tdiscard;\n\t}\n}\n"}),define("text!x_ite/Browser/Shaders/WebGL1/Include/Fog.h",[],function(){
return"/* -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-*/\n\nuniform x3d_FogParameters x3d_Fog;\n\nfloat\ngetFogInterpolant ()\n{\n\t// Returns 0.0 for fog color and 1.0 for material color.\n\n\tif (x3d_Fog .type == x3d_None)\n\t\treturn 1.0;\n\n\tfloat visibilityRange = x3d_Fog .fogCoord ? fogDepth : x3d_Fog .visibilityRange;\n\n\tif (visibilityRange <= 0.0)\n\t\treturn 1.0;\n\n\tfloat dV = length (x3d_Fog .matrix * vertex);\n\n\tif (dV >= visibilityRange)\n\t\treturn 0.0;\n\n\tif (x3d_Fog .type == x3d_LinearFog)\n\t\treturn (visibilityRange - dV) / visibilityRange;\n\n\tif (x3d_Fog .type == x3d_ExponentialFog)\n\t\treturn exp (-dV / (visibilityRange - dV));\n\n\treturn 1.0;\n}\n\nvec3\ngetFogColor (const in vec3 color)\n{\n\treturn mix (x3d_Fog .color, color, getFogInterpolant ());\n}\n"}),define("text!x_ite/Browser/Shaders/WebGL1/Include/Hatch.h",[],function(){return"/* -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-*/\n\nuniform x3d_FillPropertiesParameters x3d_FillProperties;\n\nvec4\ngetHatchColor (vec4 color)\n{\n\tvec4 finalColor = x3d_FillProperties .filled ? color : vec4 (0.0);\n\n\tif (x3d_FillProperties .hatched)\n\t{\n\t\tvec4 hatch = texture2D (x3d_FillProperties .hatchStyle, gl_FragCoord .xy / 32.0);\n\n\t\thatch .rgb *= x3d_FillProperties .hatchColor;\n\t\tfinalColor  = mix (finalColor, hatch, hatch .a);\n\t}\n\n\treturn finalColor;\n}\n"}),define("text!x_ite/Browser/Shaders/WebGL1/Include/Pack.h",[],function(){return"/* -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-*/\n\n#ifdef TITANIA\n\nvec4\npack (const in float value)\n{\n\treturn vec4 (0.0, 0.0, 0.0, 0.0);\n}\n\nfloat\nunpack (const in vec4 color)\n{\n\treturn color .r;\n}\n\n#endif\n\n#ifdef X_ITE\n\nvec4\npack (const in float value)\n{\n\tconst vec3 bitShifts = vec3 (255.0,\n\t                             255.0 * 255.0,\n\t                             255.0 * 255.0 * 255.0);\n\n\treturn vec4 (value, fract (value * bitShifts));\n}\n\n#ifdef X3D_DEPTH_TEXTURE\n\nfloat\nunpack (const in vec4 color)\n{\n\treturn color .r;\n}\n\n#else\n\nfloat\nunpack (const vec4 color)\n{\n\tconst vec3 bitShifts = vec3 (1.0 / 255.0,\n\t                             1.0 / (255.0 * 255.0),\n\t                             1.0 / (255.0 * 255.0 * 255.0));\n\n\treturn color .x + dot (color .gba, bitShifts);\n}\n\n#endif\n#endif\n"}),define("text!x_ite/Browser/Shaders/WebGL1/Include/Perlin.h",[],function(){return"/* -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-*/\n\n//https://gist.github.com/patriciogonzalezvivo/670c22f3966e662d2f83\n\n#define M_PI 3.14159265358979323846\n\nfloat rand (vec2 co) { return fract (sin (dot (co.xy, vec2 (12.9898,78.233))) * 43758.5453); }\nfloat rand (vec2 co, float l) { return rand (vec2 (rand (co), l)); }\nfloat rand (vec2 co, float l, float t) { return rand (vec2 (rand (co, l), t)); }\n\nfloat\nperlin (vec2 p, float dim, float time)\n{\n\tvec2 pos   = floor (p * dim);\n\tvec2 posx  = pos + vec2 (1.0, 0.0);\n\tvec2 posy  = pos + vec2 (0.0, 1.0);\n\tvec2 posxy = pos + vec2 (1.0);\n\t\n\tfloat c   = rand (pos,   dim, time);\n\tfloat cx  = rand (posx,  dim, time);\n\tfloat cy  = rand (posy,  dim, time);\n\tfloat cxy = rand (posxy, dim, time);\n\t\n\tvec2 d = fract (p * dim);\n\n\td = -0.5 * cos (d * M_PI) + 0.5;\n\t\n\tfloat ccx    = mix (c,   cx,    d.x);\n\tfloat cycxy  = mix (cy,  cxy,   d.x);\n\tfloat center = mix (ccx, cycxy, d.y);\n\n\treturn center * 2.0 - 1.0;\n}\n\nvec3\nperlin (vec3 p)\n{\n\treturn vec3 (perlin (p.xy, 1.0, 0.0),\n\t             perlin (p.yz, 1.0, 0.0),\n\t             perlin (p.zx, 1.0, 0.0));\n}\n"}),define("text!x_ite/Browser/Shaders/WebGL1/Include/Shadow.h",[],function(){return'/* -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-*/\n\n#pragma X3D include "Pack.h"\n\n#ifdef X3D_SHADOWS\n\nuniform sampler2D x3d_ShadowMap [x3d_MaxLights];\n\nfloat\ngetShadowDepth (const in int index, const in vec2 shadowCoord)\n{\n\t#if x3d_MaxLights > 0\n\tif (index == 0)\n\t\treturn unpack (texture2D (x3d_ShadowMap [0], shadowCoord));\n\t#endif\n\n\t#if x3d_MaxLights > 1\n\tif (index == 1)\n\t\treturn unpack (texture2D (x3d_ShadowMap [1], shadowCoord));\n\t#endif\n\n\t#if x3d_MaxLights > 2\n\tif (index == 2)\n\t\treturn unpack (texture2D (x3d_ShadowMap [2], shadowCoord));\n\t#endif\n\n\t#if x3d_MaxLights > 3\n\tif (index == 3)\n\t\treturn unpack (texture2D (x3d_ShadowMap [3], shadowCoord));\n\t#endif\n\n\t#if x3d_MaxLights > 4\n\tif (index == 4)\n\t\treturn unpack (texture2D (x3d_ShadowMap [4], shadowCoord));\n\t#endif\n\n\t#if x3d_MaxLights > 5\n\tif (index == 5)\n\t\treturn unpack (texture2D (x3d_ShadowMap [5], shadowCoord));\n\t#endif\n\n\t#if x3d_MaxLights > 6\n\tif (index == 6)\n\t\treturn unpack (texture2D (x3d_ShadowMap [6], shadowCoord));\n\t#endif\n\n\t#if x3d_MaxLights > 7\n\tif (index == 7)\n\t\treturn unpack (texture2D (x3d_ShadowMap [7], shadowCoord));\n\t#endif\n\n\treturn 0.0;\n}\n\nfloat\ntexture2DCompare (const in int index, const in vec2 texCoord, const in float compare)\n{\n\treturn step (getShadowDepth (index, texCoord), compare);\n}\n\nfloat\ntexture2DShadowLerp (const in int index, const in vec2 texelSize, const in float shadowMapSize, const in vec2 texCoord, const in float compare)\n{\n\tconst vec2 offset = vec2 (0.0, 1.0);\n\n\tvec2 centroidTexCoord = floor (texCoord * shadowMapSize + 0.5) / shadowMapSize;\n\n\tfloat lb = texture2DCompare (index, centroidTexCoord + texelSize * offset .xx, compare);\n\tfloat lt = texture2DCompare (index, centroidTexCoord + texelSize * offset .xy, compare);\n\tfloat rb = texture2DCompare (index, centroidTexCoord + texelSize * offset .yx, compare);\n\tfloat rt = texture2DCompare (index, centroidTexCoord + texelSize * offset .yy, compare);\n\n\tvec2 f = fract (texCoord * shadowMapSize + 0.5);\n\n\tfloat a = mix (lb, lt, f.y);\n\tfloat b = mix (rb, rt, f.y);\n\tfloat c = mix (a, b, f.x);\n\n\treturn c;\n}\n\n//https://gist.github.com/tschw/da10c43c467ce8afd0c4\nvec2\ncubeToUVCompact (in vec3 v, const float texelSizeY)\n{\n\t// Compact layout:\n\t//\n\t// xzXZ\t\tChar: Axis\n\t// yyYY\t\tCase: Sign\n\n\t// Number of texels to avoid at the edge of each square\n\n\tvec3 absV = abs (v);\n\n\t// Intersect unit cube\n\n\tfloat scaleToCube = 1.0 / max (absV .x, max (absV .y, absV .z));\n\n\tabsV *= scaleToCube;\n\n\t// Apply scale to avoid seams\n\n\t// one texel less per square (half a texel on each side)\n\tv *= scaleToCube * (1.0 - 2.0 * texelSizeY);\n\n\t// Unwrap\n\n\t// space: -1 ... 1 range for each square\n\t//\n\t// #X##\t\tdim    := ( 4 , 2 )\n\t//  # #\t\tcenter := ( 1 , 1 )\n\n\tvec2 planar = v .xy;\n\n\tfloat almostATexel = 1.5 * texelSizeY;\n\tfloat almostOne    = 1.0 - almostATexel;\n\n\tif (absV .z >= almostOne)\n\t{\n\t\t// zZ\n\n\t\tif (v .z > 0.0)\n\t\t\tplanar .x = 4.0 - v .x;\n\t}\n\telse if (absV .x >= almostOne)\n\t{\n\t\t// xX\n\n\t\tfloat signX = sign (v .x);\n\n\t\tplanar .x = v .z * signX + 2.0 * signX;\n\t}\n\telse if (absV .y >= almostOne)\n\t{\n\t\t// yY\n\n\t\tfloat signY = sign (v .y);\n\n\t\tplanar .x = (v .x + 0.5 + signY) * 2.0;\n\t\tplanar .y = v .z * signY - 2.0;\n\t}\n\n\t// Transform to UV space\n\n\t// scale := 0.5 / dim\n\t// translate := ( center + 0.5 ) / dim\n\treturn vec2 (0.125, 0.25) * planar + vec2 (0.375, 0.75);\n}\n\nmat4\ngetPointLightRotations (const in vec3 vector)\n{\n\tmat4 rotations [6];\n\trotations [0] = mat4 ( 0, 0 , 1, 0,   0, 1,  0, 0,  -1,  0,  0, 0,   0, 0, 0, 1);  // left\n\trotations [1] = mat4 ( 0, 0, -1, 0,   0, 1,  0, 0,   1,  0,  0, 0,   0, 0, 0, 1);  // right\n\trotations [2] = mat4 (-1, 0,  0, 0,   0, 1,  0, 0,   0,  0, -1, 0,   0, 0, 0, 1);  // front\n\trotations [3] = mat4 ( 1, 0,  0, 0,   0, 1,  0, 0,   0,  0,  1, 0,   0, 0, 0, 1);  // back\n\trotations [4] = mat4 ( 1, 0,  0, 0,   0, 0,  1, 0,   0, -1,  0, 0,   0, 0, 0, 1);  // bottom\n\trotations [5] = mat4 ( 1, 0,  0, 0,   0, 0, -1, 0,   0,  1,  0, 0,   0, 0, 0, 1);  // top\n\n\tvec3 a = abs (vector .xyz);\n\n\tif (a .x > a .y)\n\t{\n\t\tif (a .x > a .z)\n\t\t\treturn vector .x > 0.0 ? rotations [1] : rotations [0];\n\t\telse\n\t\t\treturn vector .z > 0.0 ? rotations [2] : rotations [3];\n\t}\n\telse\n\t{\n\t\tif (a .y > a .z)\n\t\t\treturn vector .y > 0.0 ? rotations [5] : rotations [4];\n\t\telse\n\t\t\treturn vector .z > 0.0 ? rotations [2] : rotations [3];\n\t}\n\n\treturn rotations [3];\n}\n\n// DEBUG\n//vec4 tex;\n\nfloat\ngetShadowIntensity (const in int index, const in x3d_LightSourceParameters light)\n{\n\tif (light .type == x3d_PointLight)\n\t{\n\t\tconst mat4 biasMatrix = mat4 (0.5, 0.0, 0.0, 0.0,\n\t\t\t                           0.0, 0.5, 0.0, 0.0,\n\t\t\t                           0.0, 0.0, 0.5, 0.0,\n\t\t\t                           0.5, 0.5, 0.5, 1.0);\n\n\t\tconst mat4 projectionMatrix = mat4 (1.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, -1.000025000312504, -1.0, 0, 0.0, -0.25000312503906297, 0.0);\n\n\t\tvec2 texelSize = vec2 (1.0) / (float (light .shadowMapSize) * vec2 (4.0, 2.0));\n\n\t\t// for point lights, the uniform @vShadowCoord is re-purposed to hold\n\t\t// the vector from the light to the world-space position of the fragment.\n\t\tvec4 shadowCoord     = light .shadowMatrix * vec4 (vertex, 1.0);\n\t\tvec3 lightToPosition = shadowCoord .xyz;\n\n\t\tshadowCoord       = biasMatrix * (projectionMatrix * (getPointLightRotations (lightToPosition) * shadowCoord));\n\t\tshadowCoord .z   -= light .shadowBias;\n\t\tshadowCoord .xyz /= shadowCoord .w;\n\n\t\t// DEBUG\n\t\t//tex = texture2D (x3d_ShadowMap [0], cubeToUVCompact (lightToPosition, texelSize .y));\n\n\t\t#if defined (X3D_PCF_FILTERING) || defined (X3D_PCF_SOFT_FILTERING)\n\t\n\t\t\tvec2 offset = vec2 (-1, 1) * (texelSize .y * 42.0);\n\t\n\t\t\tfloat value = (\n\t\t\t\ttexture2DCompare (index, cubeToUVCompact (lightToPosition + offset .xyy, texelSize .y), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, cubeToUVCompact (lightToPosition + offset .yyy, texelSize .y), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, cubeToUVCompact (lightToPosition + offset .xyx, texelSize .y), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, cubeToUVCompact (lightToPosition + offset .yyx, texelSize .y), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, cubeToUVCompact (lightToPosition, texelSize .y), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, cubeToUVCompact (lightToPosition + offset .xxy, texelSize .y), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, cubeToUVCompact (lightToPosition + offset .yxy, texelSize .y), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, cubeToUVCompact (lightToPosition + offset .xxx, texelSize .y), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, cubeToUVCompact (lightToPosition + offset .yxx, texelSize .y), shadowCoord .z)\n\t\t\t) * (1.0 / 9.0);\n\t\n\t\t\treturn light .shadowIntensity * value;\n\n\t\t#else // no percentage-closer filtering\n\n\t\t\tfloat value = texture2DCompare (index, cubeToUVCompact (lightToPosition, texelSize .y), shadowCoord .z);\n\n\t\t\treturn light .shadowIntensity * value;\n\t\n\t\t#endif\n\t}\n\telse\n\t{\n\t\t#if defined (X3D_PCF_FILTERING)\n\n\t\t\tvec2 texelSize   = vec2 (1.0) / vec2 (light .shadowMapSize);\n\t\t\tvec4 shadowCoord = light .shadowMatrix * vec4 (vertex, 1.0);\n\t\n\t\t\tshadowCoord .z   -= light .shadowBias;\n\t\t\tshadowCoord .xyz /= shadowCoord .w;\n\t\n\t\t\tfloat dx0 = - texelSize .x;\n\t\t\tfloat dy0 = - texelSize .y;\n\t\t\tfloat dx1 = + texelSize .x;\n\t\t\tfloat dy1 = + texelSize .y;\n\t\n\t\t\tfloat value = (\n\t\t\t\ttexture2DCompare (index, shadowCoord .xy + vec2 (dx0, dy0), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, shadowCoord .xy + vec2 (0.0, dy0), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, shadowCoord .xy + vec2 (dx1, dy0), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, shadowCoord .xy + vec2 (dx0, 0.0), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, shadowCoord .xy, shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, shadowCoord .xy + vec2 (dx1, 0.0), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, shadowCoord .xy + vec2 (dx0, dy1), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, shadowCoord .xy + vec2 (0.0, dy1), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, shadowCoord .xy + vec2 (dx1, dy1), shadowCoord .z)\n\t\t\t) * (1.0 / 9.0);\n\t\n\t\t\treturn light .shadowIntensity * value;\n\n\t\t#elif defined (X3D_PCF_SOFT_FILTERING)\n\n\t\t\tvec2 texelSize   = vec2 (1.0) / vec2 (light .shadowMapSize);\n\t\t\tvec4 shadowCoord = light .shadowMatrix * vec4 (vertex, 1.0);\n\t\n\t\t\tshadowCoord .z   -= light .shadowBias;\n\t\t\tshadowCoord .xyz /= shadowCoord .w;\n\t\n\t\t\tfloat dx0 = - texelSize.x;\n\t\t\tfloat dy0 = - texelSize.y;\n\t\t\tfloat dx1 = + texelSize.x;\n\t\t\tfloat dy1 = + texelSize.y;\n\t\t\t\n\t\t\tfloat value = (\n\t\t\t\ttexture2DShadowLerp (index, texelSize, float (shadowMapSize), shadowCoord .xy + vec2 (dx0, dy0), shadowCoord .z) +\n\t\t\t\ttexture2DShadowLerp (index, texelSize, float (shadowMapSize), shadowCoord .xy + vec2 (0.0, dy0), shadowCoord .z) +\n\t\t\t\ttexture2DShadowLerp (index, texelSize, float (shadowMapSize), shadowCoord .xy + vec2 (dx1, dy0), shadowCoord .z) +\n\t\t\t\ttexture2DShadowLerp (index, texelSize, float (shadowMapSize), shadowCoord .xy + vec2 (dx0, 0.0), shadowCoord .z) +\n\t\t\t\ttexture2DShadowLerp (index, texelSize, float (shadowMapSize), shadowCoord .xy, shadowCoord .z) +\n\t\t\t\ttexture2DShadowLerp (index, texelSize, float (shadowMapSize), shadowCoord .xy + vec2 (dx1, 0.0), shadowCoord .z) +\n\t\t\t\ttexture2DShadowLerp (index, texelSize, float (shadowMapSize), shadowCoord .xy + vec2 (dx0, dy1), shadowCoord .z) +\n\t\t\t\ttexture2DShadowLerp (index, texelSize, float (shadowMapSize), shadowCoord .xy + vec2 (0.0, dy1), shadowCoord .z) +\n\t\t\t\ttexture2DShadowLerp (index, texelSize, float (shadowMapSize), shadowCoord .xy + vec2 (dx1, dy1), shadowCoord .z)\n\t\t\t) * ( 1.0 / 9.0 );\n\t\n\t\t\treturn light .shadowIntensity * value;\n\n\t\t#else // no percentage-closer filtering\n\n\t\t\tvec4 shadowCoord = shadowMatrix * vec4 (vertex, 1.0);\n\t\n\t\t\tshadowCoord .z   -= shadowBias;\n\t\t\tshadowCoord .xyz /= shadowCoord .w;\n\t\n\t\t\tfloat value = texture2DCompare (index, shadowCoord .xy, shadowCoord .z);\n\t\n\t\t\treturn light .shadowIntensity * value;\n\n\t\t#endif\n\t}\n\n\treturn 0.0;\n}\n\n#endif'}),define("text!x_ite/Browser/Shaders/WebGL1/Include/Texture.h",[],function(){return'/* -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-*/\n\n#pragma X3D include "Perlin.h"\n\nuniform int         x3d_NumTextures;\nuniform int         x3d_TextureType [x3d_MaxTextures]; // x3d_None, x3d_TextureType2D or x3d_TextureTypeCubeMapTexture\nuniform sampler2D   x3d_Texture2D [x3d_MaxTextures];\nuniform samplerCube x3d_CubeMapTexture [x3d_MaxTextures];\n\nuniform vec4 x3d_MultiTextureColor;\nuniform x3d_MultiTextureParameters x3d_MultiTexture [x3d_MaxTextures];\n\nuniform x3d_TextureCoordinateGeneratorParameters x3d_TextureCoordinateGenerator [x3d_MaxTextures];  \n\n#ifdef X3D_MULTI_TEXTURING\nvec4\ngetTexCoord (const in int i)\n{\n\tif (i == 0)\n\t{\n\t\treturn texCoord0;\n\t}\n\telse if (i == 1)\n\t{\n\t\treturn texCoord1;\n\t}\n\n\treturn texCoord1;\n}\n\nvec4\ngetTextureCoordinate (const in x3d_TextureCoordinateGeneratorParameters textureCoordinateGenerator, const in int i)\n{\n\tint mode = textureCoordinateGenerator .mode;\n\n\tif (mode == x3d_None)\n\t{\n\t\treturn getTexCoord (i);\n\t}\n\telse if (mode == x3d_Sphere)\n\t{\n\t\treturn vec4 (normal .x / 2.0 + 0.5, normal .y / 2.0 + 0.5, 0.0, 1.0);\n\t}\n\telse if (mode == x3d_CameraSpaceNormal)\n\t{\n\t\treturn vec4 (normal, 1.0);\n\t}\n\telse if (mode == x3d_CameraSpacePosition)\n\t{\n\t\treturn vec4 (vertex, 1.0);\n\t}\n\telse if (mode == x3d_CameraSpaceReflectionVector)\n\t{\n\t\treturn vec4 (reflect (normalize (vertex), -normal), 1.0);\n\t}\n\telse if (mode == x3d_SphereLocal)\n\t{\n\t\treturn vec4 (localNormal .x / 2.0 + 0.5, localNormal .y / 2.0 + 0.5, 0.0, 1.0);\n\t}\n\telse if (mode == x3d_Coord)\n\t{\n\t\treturn vec4 (localVertex, 1.0);\n\t}\n\telse if (mode == x3d_CoordEye)\n\t{\n\t\treturn vec4 (vertex, 1.0);\n\t}\n\telse if (mode == x3d_Noise)\n\t{\n\t\tvec3 scale       = vec3 (textureCoordinateGenerator .parameter [0], textureCoordinateGenerator .parameter [1], textureCoordinateGenerator .parameter [2]);\n\t\tvec3 translation = vec3 (textureCoordinateGenerator .parameter [3], textureCoordinateGenerator .parameter [4], textureCoordinateGenerator .parameter [5]);\n\n\t\treturn vec4 (perlin (localVertex * scale + translation), 1.0);\n\t}\n\telse if (mode == x3d_NoiseEye)\n\t{\n\t\tvec3 scale       = vec3 (textureCoordinateGenerator .parameter [0], textureCoordinateGenerator .parameter [1], textureCoordinateGenerator .parameter [2]);\n\t\tvec3 translation = vec3 (textureCoordinateGenerator .parameter [3], textureCoordinateGenerator .parameter [4], textureCoordinateGenerator .parameter [5]);\n\n\t\treturn vec4 (perlin (vertex * scale + translation), 1.0);\n\t}\n\telse if (mode == x3d_SphereReflect)\n\t{\n\t\tfloat eta = textureCoordinateGenerator .parameter [0];\n\n\t\treturn vec4 (refract (normalize (vertex), -normal, eta), 1.0);\n\t}\n\telse if (mode == x3d_SphereReflectLocal)\n\t{\n\t\tfloat eta = textureCoordinateGenerator .parameter [0];\n\t\tvec3  eye = vec3 (textureCoordinateGenerator .parameter [1], textureCoordinateGenerator .parameter [2], textureCoordinateGenerator .parameter [3]);\n\n\t\treturn vec4 (refract (normalize (localVertex - eye), -localNormal, eta), 1.0);\n\t}\n\n\treturn getTexCoord (i);\n}\n\nvec4\ngetTexture2D (in int i, in vec2 texCoord)\n{\n\tif (i == 0)\n\t\treturn texture2D (x3d_Texture2D [0], texCoord);\n\n\treturn texture2D (x3d_Texture2D [1], texCoord);\n}\n\nvec4\ngetTextureCube (in int i, in vec3 texCoord)\n{\n\tif (i == 0)\n\t\treturn textureCube (x3d_CubeMapTexture [0], texCoord);\n\n\treturn textureCube (x3d_CubeMapTexture [1], texCoord);\n}\n\nvec4\ngetTextureColor (const in vec4 diffuseColor, const in vec4 specularColor)\n{\n\tvec4 currentColor = diffuseColor;\n\n\tfor (int i = 0; i < x3d_MaxTextures; ++ i)\n\t{\n\t\tif (i == x3d_NumTextures)\n\t\t\tbreak;\n\n\t\t// Get texture color.\n\n\t\tvec4 texCoord     = getTextureCoordinate (x3d_TextureCoordinateGenerator [i], i);\n\t\tvec4 textureColor = vec4 (1.0);\n\n\t\tif (x3d_GeometryType == x3d_Geometry2D && ! gl_FrontFacing)\n\t\t\ttexCoord .s = 1.0 - texCoord .s;\n\n\t\tif (x3d_TextureType [i] == x3d_TextureType2D)\n\t\t{\n\t\t\ttextureColor = getTexture2D (i, vec2 (texCoord));\n\t\t}\n\t \telse if (x3d_TextureType [i] == x3d_TextureTypeCubeMapTexture)\n\t\t{\n\t\t\ttextureColor = getTextureCube (i, vec3 (texCoord));\n\t\t}\n\n\t\t// Multi texturing\n\n\t\tx3d_MultiTextureParameters multiTexture = x3d_MultiTexture [i];\n\n\t\tvec4 arg1 = textureColor;\n\t\tvec4 arg2 = currentColor;\n\n\t\t// Source\n\n\t\tint source = multiTexture .source;\n\n\t\tif (source == x3d_Diffuse)\n\t\t{\n\t\t\targ1 = diffuseColor;\n\t\t}\n\t\telse if (source == x3d_Specular)\n\t\t{\n\t\t\targ1 = specularColor;\n\t\t}\n\t\telse if (source == x3d_Factor)\n\t\t{\n\t\t\targ1 = x3d_MultiTextureColor;\n\t\t}\n\n\t\t// Function\n\n\t\tint function = multiTexture .function;\n\n\t\tif (function == x3d_Complement)\n\t\t{\n\t\t\targ1 = 1.0 - arg1;\n\t\t}\n\t\telse if (function == x3d_AlphaReplicate)\n\t\t{\n\t\t\targ1 .a = arg2 .a;\n\t\t}\n\n\t\t// Mode\n\n\t\tint mode      = multiTexture .mode;\n\t\tint alphaMode = multiTexture .alphaMode;\n\n\t\t// RGB\n\n\t\tif (mode == x3d_Replace)\n\t\t{\n\t\t\tcurrentColor .rgb = arg1 .rgb;\n\t\t}\n\t\telse if (mode == x3d_Modulate)\n\t\t{\n\t\t\tcurrentColor .rgb = arg1 .rgb * arg2 .rgb;\n\t\t}\n\t\telse if (mode == x3d_Modulate2X)\n\t\t{\n\t\t\tcurrentColor .rgb = (arg1 .rgb * arg2 .rgb) * 2.0;\n\t\t}\n\t\telse if (mode == x3d_Modulate4X)\n\t\t{\n\t\t\tcurrentColor .rgb = (arg1 .rgb * arg2 .rgb) * 4.0;\n\t\t}\n\t\telse if (mode == x3d_Add)\n\t\t{\n\t\t\tcurrentColor .rgb = arg1 .rgb + arg2 .rgb;\n\t\t}\n\t\telse if (mode == x3d_AddSigned)\n\t\t{\n\t\t\tcurrentColor .rgb = arg1 .rgb + arg2 .rgb - 0.5;\n\t\t}\n\t\telse if (mode == x3d_AddSigned2X)\n\t\t{\n\t\t\tcurrentColor .rgb = (arg1 .rgb + arg2 .rgb - 0.5) * 2.0;\n\t\t}\n\t\telse if (mode == x3d_AddSmooth)\n\t\t{\n\t\t\tcurrentColor .rgb = arg1 .rgb + (1.0 - arg1 .rgb) * arg2 .rgb;\n\t\t}\n\t\telse if (mode == x3d_Subtract)\n\t\t{\n\t\t\tcurrentColor .rgb = arg1 .rgb - arg2 .rgb;\n\t\t}\n\t\telse if (mode == x3d_BlendDiffuseAlpha)\n\t\t{\n\t\t\tcurrentColor .rgb = arg1 .rgb * diffuseColor .a + arg2 .rgb * (1.0 - diffuseColor .a);\n\t\t}\n\t\telse if (mode == x3d_BlendTextureAlpha)\n\t\t{\n\t\t\tcurrentColor .rgb = arg1 .rgb * arg1 .a + arg2 .rgb * (1.0 - arg1 .a);\n\t\t}\n\t\telse if (mode == x3d_BlendFactorAlpha)\n\t\t{\n\t\t\tcurrentColor .rgb = arg1 .rgb * x3d_MultiTextureColor .a + arg2 .rgb * (1.0 - x3d_MultiTextureColor .a);\n\t\t}\n\t\telse if (mode == x3d_BlendCurrentAlpha)\n\t\t{\n\t\t\tcurrentColor .rgb = arg1 .rgb * arg2 .a + arg2 .rgb * (1.0 - arg2 .a);\n\t\t}\n\t\telse if (mode == x3d_ModulateAlphaAddColor)\n\t\t{\n\t\t\tcurrentColor .rgb = arg1 .rgb + arg1 .a * arg2 .rgb;\n\t\t}\n\t\telse if (mode == x3d_ModulateInvAlphaAddColor)\n\t\t{\n\t\t\tcurrentColor .rgb = (1.0 - arg1 .a) * arg2 .rgb + arg1 .rgb;\n\t\t}\n\t\telse if (mode == x3d_ModulateInvColorAddAlpha)\n\t\t{\n\t\t\tcurrentColor .rgb = (1.0 - arg1 .rgb) * arg2 .rgb + arg1 .a;\n\t\t}\n\t\telse if (mode == x3d_DotProduct3)\n\t\t{\n\t\t\tcurrentColor .rgb = vec3 (dot (arg1 .rgb * 2.0 - 1.0, arg2 .rgb * 2.0 - 1.0));\n\t\t}\n\t\telse if (mode == x3d_SelectArg1)\n\t\t{\n\t\t\tcurrentColor .rgb = arg1 .rgb;\n\t\t}\n\t\telse if (mode == x3d_SelectArg2)\n\t\t{\n\t\t\tcurrentColor .rgb = arg2 .rgb;\n\t\t}\n\t\telse if (mode == x3d_Off)\n\t\t\t;\n\n\t\t// Alpha\n\n\t\tif (alphaMode == x3d_Replace)\n\t\t{\n\t\t\tcurrentColor .a = arg1 .a;\n\t\t}\n\t\telse if (alphaMode == x3d_Modulate)\n\t\t{\n\t\t\tcurrentColor .a = arg1 .a * arg2 .a;\n\t\t}\n\t\telse if (mode == x3d_Modulate2X)\n\t\t{\n\t\t\tcurrentColor .a = (arg1 .a * arg2 .a) * 2.0;\n\t\t}\n\t\telse if (mode == x3d_Modulate4X)\n\t\t{\n\t\t\tcurrentColor .a = (arg1 .a * arg2 .a) * 4.0;\n\t\t}\n\t\telse if (mode == x3d_Add)\n\t\t{\n\t\t\tcurrentColor .a = arg1 .a + arg2 .a;\n\t\t}\n\t\telse if (mode == x3d_AddSigned)\n\t\t{\n\t\t\tcurrentColor .a = arg1 .a + arg2 .a - 0.5;\n\t\t}\n\t\telse if (mode == x3d_AddSigned2X)\n\t\t{\n\t\t\tcurrentColor .a = (arg1 .a + arg2 .a - 0.5) * 2.0;\n\t\t}\n\t\telse if (mode == x3d_AddSmooth)\n\t\t{\n\t\t\tcurrentColor .a = arg1 .a + (1.0 - arg1 .a) * arg2 .a;\n\t\t}\n\t\telse if (mode == x3d_Subtract)\n\t\t{\n\t\t\tcurrentColor .a = arg1 .a - arg2 .a;\n\t\t}\n\t\telse if (mode == x3d_BlendDiffuseAlpha)\n\t\t{\n\t\t\tcurrentColor .a = arg1 .a * diffuseColor .a + arg2 .a * (1.0 - diffuseColor .a);\n\t\t}\n\t\telse if (mode == x3d_BlendTextureAlpha)\n\t\t{\n\t\t\tcurrentColor .a = arg1 .a * arg1 .a + arg2 .a * (1.0 - arg1 .a);\n\t\t}\n\t\telse if (mode == x3d_BlendFactorAlpha)\n\t\t{\n\t\t\tcurrentColor .a = arg1 .a * x3d_MultiTextureColor .a + arg2 .a * (1.0 - x3d_MultiTextureColor .a);\n\t\t}\n\t\telse if (mode == x3d_BlendCurrentAlpha)\n\t\t{\n\t\t\tcurrentColor .a = arg1 .a * arg2 .a + arg2 .a * (1.0 - arg2 .a);\n\t\t}\n\t\telse if (mode == x3d_ModulateAlphaAddColor)\n\t\t{\n\t\t\tcurrentColor .a = arg1 .a + arg1 .a * arg2 .a;\n\t\t}\n\t\telse if (mode == x3d_ModulateInvAlphaAddColor)\n\t\t{\n\t\t\tcurrentColor .a = (1.0 - arg1 .a) * arg2 .a + arg1 .a;\n\t\t}\n\t\telse if (mode == x3d_ModulateInvColorAddAlpha)\n\t\t{\n\t\t\tcurrentColor .a = (1.0 - arg1 .a) * arg2 .a + arg1 .a;\n\t\t}\n\t\telse if (mode == x3d_DotProduct3)\n\t\t{\n\t\t\tcurrentColor .a = dot (arg1 .rgb * 2.0 - 1.0, arg2 .rgb * 2.0 - 1.0);\n\t\t}\n\t\telse if (mode == x3d_SelectArg1)\n\t\t{\n\t\t\tcurrentColor .a = arg1 .a;\n\t\t}\n\t\telse if (mode == x3d_SelectArg2)\n\t\t{\n\t\t\tcurrentColor .a = arg2 .a;\n\t\t}\n\t\telse if (mode == x3d_Off)\n\t\t\t;\n\t}\n\n\treturn currentColor;\n}\n#else\nvec4\ngetTextureColor (const in vec4 diffuseColor, const in vec4 specularColor)\n{\n\t// Get texture color.\n\n\tvec4 texCoord     = texCoord0;\n\tvec4 textureColor = vec4 (1.0);\n\n\tif (x3d_TextureType [0] == x3d_TextureType2D)\n\t{\n\t\tif (x3d_GeometryType == x3d_Geometry3D || gl_FrontFacing)\n\t\t\ttextureColor = texture2D (x3d_Texture2D [0], vec2 (texCoord));\n\t\telse\n\t\t\t// If dimension is x3d_Geometry2D the texCoord must be flipped.\n\t\t\ttextureColor = texture2D (x3d_Texture2D [0], vec2 (1.0 - texCoord .s, texCoord .t));\n\t}\n \telse if (x3d_TextureType [0] == x3d_TextureTypeCubeMapTexture)\n\t{\n\t\tif (x3d_GeometryType == x3d_Geometry3D || gl_FrontFacing)\n\t\t\ttextureColor = textureCube (x3d_CubeMapTexture [0], vec3 (texCoord));\n\t\telse\n\t\t\t// If dimension is x3d_Geometry2D the texCoord must be flipped.\n\t\t\ttextureColor = textureCube (x3d_CubeMapTexture [0], vec3 (1.0 - texCoord .s, texCoord .t, texCoord .z));\n\t}\n\n\treturn diffuseColor * textureColor;\n}\n#endif\n'}),define("text!x_ite/Browser/Shaders/WebGL2/Include/ClipPlanes.h",[],function(){return"/* -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-*/\n\nuniform int  x3d_NumClipPlanes;\nuniform vec4 x3d_ClipPlane [x3d_MaxClipPlanes];\n\nvoid\nclip ()\n{\n\tfor (int i = 0; i < x3d_MaxClipPlanes; ++ i)\n\t{\n\t\tif (i == x3d_NumClipPlanes)\n\t\t\tbreak;\n\n\t\tif (dot (vertex, x3d_ClipPlane [i] .xyz) - x3d_ClipPlane [i] .w < 0.0)\n\t\t\tdiscard;\n\t}\n}\n"}),define("text!x_ite/Browser/Shaders/WebGL2/Include/Fog.h",[],function(){return"/* -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-*/\n\nuniform x3d_FogParameters x3d_Fog;\n\nfloat\ngetFogInterpolant ()\n{\n\t// Returns 0.0 for fog color and 1.0 for material color.\n\n\tif (x3d_Fog .type == x3d_None)\n\t\treturn 1.0;\n\n\tfloat visibilityRange = x3d_Fog .fogCoord ? fogDepth : x3d_Fog .visibilityRange;\n\n\tif (visibilityRange <= 0.0)\n\t\treturn 1.0;\n\n\tfloat dV = length (x3d_Fog .matrix * vertex);\n\n\tif (dV >= visibilityRange)\n\t\treturn 0.0;\n\n\tif (x3d_Fog .type == x3d_LinearFog)\n\t\treturn (visibilityRange - dV) / visibilityRange;\n\n\tif (x3d_Fog .type == x3d_ExponentialFog)\n\t\treturn exp (-dV / (visibilityRange - dV));\n\n\treturn 1.0;\n}\n\nvec3\ngetFogColor (const in vec3 color)\n{\n\treturn mix (x3d_Fog .color, color, getFogInterpolant ());\n}\n"}),define("text!x_ite/Browser/Shaders/WebGL2/Include/Hatch.h",[],function(){return"/* -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-*/\n\nuniform x3d_FillPropertiesParameters x3d_FillProperties;\n\nvec4\ngetHatchColor (vec4 color)\n{\n\tvec4 finalColor = x3d_FillProperties .filled ? color : vec4 (0.0);\n\n\tif (x3d_FillProperties .hatched)\n\t{\n\t\tvec4 hatch = texture (x3d_FillProperties .hatchStyle, gl_FragCoord .xy / 32.0);\n\n\t\thatch .rgb *= x3d_FillProperties .hatchColor;\n\t\tfinalColor  = mix (finalColor, hatch, hatch .a);\n\t}\n\n\treturn finalColor;\n}\n"}),define("text!x_ite/Browser/Shaders/WebGL2/Include/Pack.h",[],function(){return"/* -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-*/\n\n#ifdef TITANIA\n\nvec4\npack (const in float value)\n{\n\treturn vec4 (0.0, 0.0, 0.0, 0.0);\n}\n\nfloat\nunpack (const in vec4 color)\n{\n\treturn color .r;\n}\n\n#endif\n\n#ifdef X_ITE\n\nvec4\npack (const in float value)\n{\n\tconst vec3 bitShifts = vec3 (255.0,\n\t                             255.0 * 255.0,\n\t                             255.0 * 255.0 * 255.0);\n\n\treturn vec4 (value, fract (value * bitShifts));\n}\n\n#ifdef X3D_DEPTH_TEXTURE\n\nfloat\nunpack (const in vec4 color)\n{\n\treturn color .r;\n}\n\n#else\n\nfloat\nunpack (const vec4 color)\n{\n\tconst vec3 bitShifts = vec3 (1.0 / 255.0,\n\t                             1.0 / (255.0 * 255.0),\n\t                             1.0 / (255.0 * 255.0 * 255.0));\n\n\treturn color .x + dot (color .gba, bitShifts);\n}\n\n#endif\n#endif\n"}),define("text!x_ite/Browser/Shaders/WebGL2/Include/Perlin.h",[],function(){return"/* -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-*/\n\n//https://gist.github.com/patriciogonzalezvivo/670c22f3966e662d2f83\n\n#define M_PI 3.14159265358979323846\n\nfloat rand (vec2 co) { return fract (sin (dot (co.xy, vec2 (12.9898,78.233))) * 43758.5453); }\nfloat rand (vec2 co, float l) { return rand (vec2 (rand (co), l)); }\nfloat rand (vec2 co, float l, float t) { return rand (vec2 (rand (co, l), t)); }\n\nfloat\nperlin (vec2 p, float dim, float time)\n{\n\tvec2 pos   = floor (p * dim);\n\tvec2 posx  = pos + vec2 (1.0, 0.0);\n\tvec2 posy  = pos + vec2 (0.0, 1.0);\n\tvec2 posxy = pos + vec2 (1.0);\n\t\n\tfloat c   = rand (pos,   dim, time);\n\tfloat cx  = rand (posx,  dim, time);\n\tfloat cy  = rand (posy,  dim, time);\n\tfloat cxy = rand (posxy, dim, time);\n\t\n\tvec2 d = fract (p * dim);\n\n\td = -0.5 * cos (d * M_PI) + 0.5;\n\t\n\tfloat ccx    = mix (c,   cx,    d.x);\n\tfloat cycxy  = mix (cy,  cxy,   d.x);\n\tfloat center = mix (ccx, cycxy, d.y);\n\n\treturn center * 2.0 - 1.0;\n}\n\nvec3\nperlin (vec3 p)\n{\n\treturn vec3 (perlin (p.xy, 1.0, 0.0),\n\t             perlin (p.yz, 1.0, 0.0),\n\t             perlin (p.zx, 1.0, 0.0));\n}\n"}),define("text!x_ite/Browser/Shaders/WebGL2/Include/Shadow.h",[],function(){
return'/* -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-*/\n\n#pragma X3D include "Pack.h"\n\n#ifdef X3D_SHADOWS\n\nuniform sampler2D x3d_ShadowMap [x3d_MaxLights];\n\nfloat\ngetShadowDepth (const in int index, const in vec2 shadowCoord)\n{\n\t#if x3d_MaxLights > 0\n\tif (index == 0)\n\t\treturn unpack (texture (x3d_ShadowMap [0], shadowCoord));\n\t#endif\n\n\t#if x3d_MaxLights > 1\n\tif (index == 1)\n\t\treturn unpack (texture (x3d_ShadowMap [1], shadowCoord));\n\t#endif\n\n\t#if x3d_MaxLights > 2\n\tif (index == 2)\n\t\treturn unpack (texture (x3d_ShadowMap [2], shadowCoord));\n\t#endif\n\n\t#if x3d_MaxLights > 3\n\tif (index == 3)\n\t\treturn unpack (texture (x3d_ShadowMap [3], shadowCoord));\n\t#endif\n\n\t#if x3d_MaxLights > 4\n\tif (index == 4)\n\t\treturn unpack (texture (x3d_ShadowMap [4], shadowCoord));\n\t#endif\n\n\t#if x3d_MaxLights > 5\n\tif (index == 5)\n\t\treturn unpack (texture (x3d_ShadowMap [5], shadowCoord));\n\t#endif\n\n\t#if x3d_MaxLights > 6\n\tif (index == 6)\n\t\treturn unpack (texture (x3d_ShadowMap [6], shadowCoord));\n\t#endif\n\n\t#if x3d_MaxLights > 7\n\tif (index == 7)\n\t\treturn unpack (texture (x3d_ShadowMap [7], shadowCoord));\n\t#endif\n\n\treturn 0.0;\n}\n\nfloat\ntexture2DCompare (const in int index, const in vec2 texCoord, const in float compare)\n{\n\treturn step (getShadowDepth (index, texCoord), compare);\n}\n\nfloat\ntexture2DShadowLerp (const in int index, const in vec2 texelSize, const in float shadowMapSize, const in vec2 texCoord, const in float compare)\n{\n\tconst vec2 offset = vec2 (0.0, 1.0);\n\n\tvec2 centroidTexCoord = floor (texCoord * shadowMapSize + 0.5) / shadowMapSize;\n\n\tfloat lb = texture2DCompare (index, centroidTexCoord + texelSize * offset .xx, compare);\n\tfloat lt = texture2DCompare (index, centroidTexCoord + texelSize * offset .xy, compare);\n\tfloat rb = texture2DCompare (index, centroidTexCoord + texelSize * offset .yx, compare);\n\tfloat rt = texture2DCompare (index, centroidTexCoord + texelSize * offset .yy, compare);\n\n\tvec2 f = fract (texCoord * shadowMapSize + 0.5);\n\n\tfloat a = mix (lb, lt, f.y);\n\tfloat b = mix (rb, rt, f.y);\n\tfloat c = mix (a, b, f.x);\n\n\treturn c;\n}\n\n//https://gist.github.com/tschw/da10c43c467ce8afd0c4\nvec2\ncubeToUVCompact (in vec3 v, const float texelSizeY)\n{\n\t// Compact layout:\n\t//\n\t// xzXZ\t\tChar: Axis\n\t// yyYY\t\tCase: Sign\n\n\t// Number of texels to avoid at the edge of each square\n\n\tvec3 absV = abs (v);\n\n\t// Intersect unit cube\n\n\tfloat scaleToCube = 1.0 / max (absV .x, max (absV .y, absV .z));\n\n\tabsV *= scaleToCube;\n\n\t// Apply scale to avoid seams\n\n\t// one texel less per square (half a texel on each side)\n\tv *= scaleToCube * (1.0 - 2.0 * texelSizeY);\n\n\t// Unwrap\n\n\t// space: -1 ... 1 range for each square\n\t//\n\t// #X##\t\tdim    := ( 4 , 2 )\n\t//  # #\t\tcenter := ( 1 , 1 )\n\n\tvec2 planar = v .xy;\n\n\tfloat almostATexel = 1.5 * texelSizeY;\n\tfloat almostOne    = 1.0 - almostATexel;\n\n\tif (absV .z >= almostOne)\n\t{\n\t\t// zZ\n\n\t\tif (v .z > 0.0)\n\t\t\tplanar .x = 4.0 - v .x;\n\t}\n\telse if (absV .x >= almostOne)\n\t{\n\t\t// xX\n\n\t\tfloat signX = sign (v .x);\n\n\t\tplanar .x = v .z * signX + 2.0 * signX;\n\t}\n\telse if (absV .y >= almostOne)\n\t{\n\t\t// yY\n\n\t\tfloat signY = sign (v .y);\n\n\t\tplanar .x = (v .x + 0.5 + signY) * 2.0;\n\t\tplanar .y = v .z * signY - 2.0;\n\t}\n\n\t// Transform to UV space\n\n\t// scale := 0.5 / dim\n\t// translate := ( center + 0.5 ) / dim\n\treturn vec2 (0.125, 0.25) * planar + vec2 (0.375, 0.75);\n}\n\nmat4\ngetPointLightRotations (const in vec3 vector)\n{\n\tmat4 rotations [6];\n\trotations [0] = mat4 ( 0, 0 , 1, 0,   0, 1,  0, 0,  -1,  0,  0, 0,   0, 0, 0, 1);  // left\n\trotations [1] = mat4 ( 0, 0, -1, 0,   0, 1,  0, 0,   1,  0,  0, 0,   0, 0, 0, 1);  // right\n\trotations [2] = mat4 (-1, 0,  0, 0,   0, 1,  0, 0,   0,  0, -1, 0,   0, 0, 0, 1);  // front\n\trotations [3] = mat4 ( 1, 0,  0, 0,   0, 1,  0, 0,   0,  0,  1, 0,   0, 0, 0, 1);  // back\n\trotations [4] = mat4 ( 1, 0,  0, 0,   0, 0,  1, 0,   0, -1,  0, 0,   0, 0, 0, 1);  // bottom\n\trotations [5] = mat4 ( 1, 0,  0, 0,   0, 0, -1, 0,   0,  1,  0, 0,   0, 0, 0, 1);  // top\n\n\tvec3 a = abs (vector .xyz);\n\n\tif (a .x > a .y)\n\t{\n\t\tif (a .x > a .z)\n\t\t\treturn vector .x > 0.0 ? rotations [1] : rotations [0];\n\t\telse\n\t\t\treturn vector .z > 0.0 ? rotations [2] : rotations [3];\n\t}\n\telse\n\t{\n\t\tif (a .y > a .z)\n\t\t\treturn vector .y > 0.0 ? rotations [5] : rotations [4];\n\t\telse\n\t\t\treturn vector .z > 0.0 ? rotations [2] : rotations [3];\n\t}\n\n\treturn rotations [3];\n}\n\n// DEBUG\n//vec4 tex;\n\nfloat\ngetShadowIntensity (const in int index, const in x3d_LightSourceParameters light)\n{\n\tif (light .type == x3d_PointLight)\n\t{\n\t\tconst mat4 biasMatrix = mat4 (0.5, 0.0, 0.0, 0.0,\n\t\t\t                           0.0, 0.5, 0.0, 0.0,\n\t\t\t                           0.0, 0.0, 0.5, 0.0,\n\t\t\t                           0.5, 0.5, 0.5, 1.0);\n\n\t\tconst mat4 projectionMatrix = mat4 (1.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, -1.000025000312504, -1.0, 0, 0.0, -0.25000312503906297, 0.0);\n\n\t\tvec2 texelSize = vec2 (1.0) / (float (light .shadowMapSize) * vec2 (4.0, 2.0));\n\n\t\t// for point lights, the uniform @vShadowCoord is re-purposed to hold\n\t\t// the vector from the light to the world-space position of the fragment.\n\t\tvec4 shadowCoord     = light .shadowMatrix * vec4 (vertex, 1.0);\n\t\tvec3 lightToPosition = shadowCoord .xyz;\n\n\t\tshadowCoord       = biasMatrix * (projectionMatrix * (getPointLightRotations (lightToPosition) * shadowCoord));\n\t\tshadowCoord .z   -= light .shadowBias;\n\t\tshadowCoord .xyz /= shadowCoord .w;\n\n\t\t// DEBUG\n\t\t//tex = texture2D (x3d_ShadowMap [0], cubeToUVCompact (lightToPosition, texelSize .y));\n\n\t\t#if defined (X3D_PCF_FILTERING) || defined (X3D_PCF_SOFT_FILTERING)\n\t\n\t\t\tvec2 offset = vec2 (-1, 1) * (texelSize .y * 42.0);\n\t\n\t\t\tfloat value = (\n\t\t\t\ttexture2DCompare (index, cubeToUVCompact (lightToPosition + offset .xyy, texelSize .y), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, cubeToUVCompact (lightToPosition + offset .yyy, texelSize .y), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, cubeToUVCompact (lightToPosition + offset .xyx, texelSize .y), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, cubeToUVCompact (lightToPosition + offset .yyx, texelSize .y), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, cubeToUVCompact (lightToPosition, texelSize .y), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, cubeToUVCompact (lightToPosition + offset .xxy, texelSize .y), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, cubeToUVCompact (lightToPosition + offset .yxy, texelSize .y), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, cubeToUVCompact (lightToPosition + offset .xxx, texelSize .y), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, cubeToUVCompact (lightToPosition + offset .yxx, texelSize .y), shadowCoord .z)\n\t\t\t) * (1.0 / 9.0);\n\t\n\t\t\treturn light .shadowIntensity * value;\n\n\t\t#else // no percentage-closer filtering\n\n\t\t\tfloat value = texture2DCompare (index, cubeToUVCompact (lightToPosition, texelSize .y), shadowCoord .z);\n\n\t\t\treturn light .shadowIntensity * value;\n\t\n\t\t#endif\n\t}\n\telse\n\t{\n\t\t#if defined (X3D_PCF_FILTERING)\n\n\t\t\tvec2 texelSize   = vec2 (1.0) / vec2 (light .shadowMapSize);\n\t\t\tvec4 shadowCoord = light .shadowMatrix * vec4 (vertex, 1.0);\n\t\n\t\t\tshadowCoord .z   -= light .shadowBias;\n\t\t\tshadowCoord .xyz /= shadowCoord .w;\n\t\n\t\t\tfloat dx0 = - texelSize .x;\n\t\t\tfloat dy0 = - texelSize .y;\n\t\t\tfloat dx1 = + texelSize .x;\n\t\t\tfloat dy1 = + texelSize .y;\n\t\n\t\t\tfloat value = (\n\t\t\t\ttexture2DCompare (index, shadowCoord .xy + vec2 (dx0, dy0), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, shadowCoord .xy + vec2 (0.0, dy0), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, shadowCoord .xy + vec2 (dx1, dy0), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, shadowCoord .xy + vec2 (dx0, 0.0), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, shadowCoord .xy, shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, shadowCoord .xy + vec2 (dx1, 0.0), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, shadowCoord .xy + vec2 (dx0, dy1), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, shadowCoord .xy + vec2 (0.0, dy1), shadowCoord .z) +\n\t\t\t\ttexture2DCompare (index, shadowCoord .xy + vec2 (dx1, dy1), shadowCoord .z)\n\t\t\t) * (1.0 / 9.0);\n\t\n\t\t\treturn light .shadowIntensity * value;\n\n\t\t#elif defined (X3D_PCF_SOFT_FILTERING)\n\n\t\t\tvec2 texelSize   = vec2 (1.0) / vec2 (light .shadowMapSize);\n\t\t\tvec4 shadowCoord = light .shadowMatrix * vec4 (vertex, 1.0);\n\t\n\t\t\tshadowCoord .z   -= light .shadowBias;\n\t\t\tshadowCoord .xyz /= shadowCoord .w;\n\t\n\t\t\tfloat dx0 = - texelSize.x;\n\t\t\tfloat dy0 = - texelSize.y;\n\t\t\tfloat dx1 = + texelSize.x;\n\t\t\tfloat dy1 = + texelSize.y;\n\t\t\t\n\t\t\tfloat value = (\n\t\t\t\ttexture2DShadowLerp (index, texelSize, float (shadowMapSize), shadowCoord .xy + vec2 (dx0, dy0), shadowCoord .z) +\n\t\t\t\ttexture2DShadowLerp (index, texelSize, float (shadowMapSize), shadowCoord .xy + vec2 (0.0, dy0), shadowCoord .z) +\n\t\t\t\ttexture2DShadowLerp (index, texelSize, float (shadowMapSize), shadowCoord .xy + vec2 (dx1, dy0), shadowCoord .z) +\n\t\t\t\ttexture2DShadowLerp (index, texelSize, float (shadowMapSize), shadowCoord .xy + vec2 (dx0, 0.0), shadowCoord .z) +\n\t\t\t\ttexture2DShadowLerp (index, texelSize, float (shadowMapSize), shadowCoord .xy, shadowCoord .z) +\n\t\t\t\ttexture2DShadowLerp (index, texelSize, float (shadowMapSize), shadowCoord .xy + vec2 (dx1, 0.0), shadowCoord .z) +\n\t\t\t\ttexture2DShadowLerp (index, texelSize, float (shadowMapSize), shadowCoord .xy + vec2 (dx0, dy1), shadowCoord .z) +\n\t\t\t\ttexture2DShadowLerp (index, texelSize, float (shadowMapSize), shadowCoord .xy + vec2 (0.0, dy1), shadowCoord .z) +\n\t\t\t\ttexture2DShadowLerp (index, texelSize, float (shadowMapSize), shadowCoord .xy + vec2 (dx1, dy1), shadowCoord .z)\n\t\t\t) * ( 1.0 / 9.0 );\n\t\n\t\t\treturn light .shadowIntensity * value;\n\n\t\t#else // no percentage-closer filtering\n\n\t\t\tvec4 shadowCoord = shadowMatrix * vec4 (vertex, 1.0);\n\t\n\t\t\tshadowCoord .z   -= shadowBias;\n\t\t\tshadowCoord .xyz /= shadowCoord .w;\n\t\n\t\t\tfloat value = texture2DCompare (index, shadowCoord .xy, shadowCoord .z);\n\t\n\t\t\treturn light .shadowIntensity * value;\n\n\t\t#endif\n\t}\n\n\treturn 0.0;\n}\n\n#endif'}),define("text!x_ite/Browser/Shaders/WebGL2/Include/Texture.h",[],function(){return'/* -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-*/\n\n#pragma X3D include "Perlin.h"\n\nuniform int         x3d_NumTextures;\nuniform int         x3d_TextureType [x3d_MaxTextures]; // x3d_None, x3d_TextureType2D or x3d_TextureTypeCubeMapTexture\nuniform sampler2D   x3d_Texture2D [x3d_MaxTextures];\nuniform samplerCube x3d_CubeMapTexture [x3d_MaxTextures];\n\nuniform vec4 x3d_MultiTextureColor;\nuniform x3d_MultiTextureParameters x3d_MultiTexture [x3d_MaxTextures];\n\nuniform x3d_TextureCoordinateGeneratorParameters x3d_TextureCoordinateGenerator [x3d_MaxTextures];  \n\n#ifdef X3D_MULTI_TEXTURING\nvec4\ngetTexCoord (const in int i)\n{\n\tif (i == 0)\n\t{\n\t\treturn texCoord0;\n\t}\n\n\treturn texCoord1;\n}\n\nvec4\ngetTextureCoordinate (const in x3d_TextureCoordinateGeneratorParameters textureCoordinateGenerator, const in int i)\n{\n\tint mode = textureCoordinateGenerator .mode;\n\n\tif (mode == x3d_None)\n\t{\n\t\treturn getTexCoord (i);\n\t}\n\telse if (mode == x3d_Sphere)\n\t{\n\t\treturn vec4 (normal .x / 2.0 + 0.5, normal .y / 2.0 + 0.5, 0.0, 1.0);\n\t}\n\telse if (mode == x3d_CameraSpaceNormal)\n\t{\n\t\treturn vec4 (normal, 1.0);\n\t}\n\telse if (mode == x3d_CameraSpacePosition)\n\t{\n\t\treturn vec4 (vertex, 1.0);\n\t}\n\telse if (mode == x3d_CameraSpaceReflectionVector)\n\t{\n\t\treturn vec4 (reflect (normalize (vertex), -normal), 1.0);\n\t}\n\telse if (mode == x3d_SphereLocal)\n\t{\n\t\treturn vec4 (localNormal .x / 2.0 + 0.5, localNormal .y / 2.0 + 0.5, 0.0, 1.0);\n\t}\n\telse if (mode == x3d_Coord)\n\t{\n\t\treturn vec4 (localVertex, 1.0);\n\t}\n\telse if (mode == x3d_CoordEye)\n\t{\n\t\treturn vec4 (vertex, 1.0);\n\t}\n\telse if (mode == x3d_Noise)\n\t{\n\t\tvec3 scale       = vec3 (textureCoordinateGenerator .parameter [0], textureCoordinateGenerator .parameter [1], textureCoordinateGenerator .parameter [2]);\n\t\tvec3 translation = vec3 (textureCoordinateGenerator .parameter [3], textureCoordinateGenerator .parameter [4], textureCoordinateGenerator .parameter [5]);\n\n\t\treturn vec4 (perlin (localVertex * scale + translation), 1.0);\n\t}\n\telse if (mode == x3d_NoiseEye)\n\t{\n\t\tvec3 scale       = vec3 (textureCoordinateGenerator .parameter [0], textureCoordinateGenerator .parameter [1], textureCoordinateGenerator .parameter [2]);\n\t\tvec3 translation = vec3 (textureCoordinateGenerator .parameter [3], textureCoordinateGenerator .parameter [4], textureCoordinateGenerator .parameter [5]);\n\n\t\treturn vec4 (perlin (vertex * scale + translation), 1.0);\n\t}\n\telse if (mode == x3d_SphereReflect)\n\t{\n\t\tfloat eta = textureCoordinateGenerator .parameter [0];\n\n\t\treturn vec4 (refract (normalize (vertex), -normal, eta), 1.0);\n\t}\n\telse if (mode == x3d_SphereReflectLocal)\n\t{\n\t\tfloat eta = textureCoordinateGenerator .parameter [0];\n\t\tvec3  eye = vec3 (textureCoordinateGenerator .parameter [1], textureCoordinateGenerator .parameter [2], textureCoordinateGenerator .parameter [3]);\n\n\t\treturn vec4 (refract (normalize (localVertex - eye), -localNormal, eta), 1.0);\n\t}\n\n\treturn getTexCoord (i);\n}\n\nvec4\ngetTexture2D (in int i, in vec2 texCoord)\n{\n\tif (i == 0)\n\t\treturn texture (x3d_Texture2D [0], texCoord);\n\n\treturn texture (x3d_Texture2D [1], texCoord);\n}\n\nvec4\ngetTextureCube (in int i, in vec3 texCoord)\n{\n\tif (i == 0)\n\t\treturn texture (x3d_CubeMapTexture [0], texCoord);\n\n\treturn texture (x3d_CubeMapTexture [1], texCoord);\n}\n\nvec4\ngetTextureColor (const in vec4 diffuseColor, const in vec4 specularColor)\n{\n\tvec4 currentColor = diffuseColor;\n\n\tfor (int i = 0; i < x3d_MaxTextures; ++ i)\n\t{\n\t\tif (i == x3d_NumTextures)\n\t\t\tbreak;\n\n\t\t// Get texture color.\n\n\t\tvec4 texCoord     = getTextureCoordinate (x3d_TextureCoordinateGenerator [i], i);\n\t\tvec4 textureColor = vec4 (1.0);\n\t\n\t\tif (x3d_GeometryType == x3d_Geometry2D && ! gl_FrontFacing)\n\t\t\ttexCoord .s = 1.0 - texCoord .s;\n\n\t\tif (x3d_TextureType [i] == x3d_TextureType2D)\n\t\t{\n\t\t\ttextureColor = getTexture2D (i, vec2 (texCoord));\n\t\t}\n\t \telse if (x3d_TextureType [i] == x3d_TextureTypeCubeMapTexture)\n\t\t{\n\t\t\ttextureColor = getTextureCube (i, vec3 (texCoord));\n\t\t}\n\n\t\t// Multi texturing\n\n\t\tx3d_MultiTextureParameters multiTexture = x3d_MultiTexture [i];\n\n\t\tvec4 arg1 = textureColor;\n\t\tvec4 arg2 = currentColor;\n\n\t\t// Source\n\n\t\tint source = multiTexture .source;\n\n\t\tif (source == x3d_Diffuse)\n\t\t{\n\t\t\targ1 = diffuseColor;\n\t\t}\n\t\telse if (source == x3d_Specular)\n\t\t{\n\t\t\targ1 = specularColor;\n\t\t}\n\t\telse if (source == x3d_Factor)\n\t\t{\n\t\t\targ1 = x3d_MultiTextureColor;\n\t\t}\n\n\t\t// Function\n\n\t\tint function = multiTexture .function;\n\n\t\tif (function == x3d_Complement)\n\t\t{\n\t\t\targ1 = 1.0 - arg1;\n\t\t}\n\t\telse if (function == x3d_AlphaReplicate)\n\t\t{\n\t\t\targ1 .a = arg2 .a;\n\t\t}\n\n\t\t// Mode\n\n\t\tint mode      = multiTexture .mode;\n\t\tint alphaMode = multiTexture .alphaMode;\n\n\t\t// RGB\n\n\t\tif (mode == x3d_Replace)\n\t\t{\n\t\t\tcurrentColor .rgb = arg1 .rgb;\n\t\t}\n\t\telse if (mode == x3d_Modulate)\n\t\t{\n\t\t\tcurrentColor .rgb = arg1 .rgb * arg2 .rgb;\n\t\t}\n\t\telse if (mode == x3d_Modulate2X)\n\t\t{\n\t\t\tcurrentColor .rgb = (arg1 .rgb * arg2 .rgb) * 2.0;\n\t\t}\n\t\telse if (mode == x3d_Modulate4X)\n\t\t{\n\t\t\tcurrentColor .rgb = (arg1 .rgb * arg2 .rgb) * 4.0;\n\t\t}\n\t\telse if (mode == x3d_Add)\n\t\t{\n\t\t\tcurrentColor .rgb = arg1 .rgb + arg2 .rgb;\n\t\t}\n\t\telse if (mode == x3d_AddSigned)\n\t\t{\n\t\t\tcurrentColor .rgb = arg1 .rgb + arg2 .rgb - 0.5;\n\t\t}\n\t\telse if (mode == x3d_AddSigned2X)\n\t\t{\n\t\t\tcurrentColor .rgb = (arg1 .rgb + arg2 .rgb - 0.5) * 2.0;\n\t\t}\n\t\telse if (mode == x3d_AddSmooth)\n\t\t{\n\t\t\tcurrentColor .rgb = arg1 .rgb + (1.0 - arg1 .rgb) * arg2 .rgb;\n\t\t}\n\t\telse if (mode == x3d_Subtract)\n\t\t{\n\t\t\tcurrentColor .rgb = arg1 .rgb - arg2 .rgb;\n\t\t}\n\t\telse if (mode == x3d_BlendDiffuseAlpha)\n\t\t{\n\t\t\tcurrentColor .rgb = arg1 .rgb * diffuseColor .a + arg2 .rgb * (1.0 - diffuseColor .a);\n\t\t}\n\t\telse if (mode == x3d_BlendTextureAlpha)\n\t\t{\n\t\t\tcurrentColor .rgb = arg1 .rgb * arg1 .a + arg2 .rgb * (1.0 - arg1 .a);\n\t\t}\n\t\telse if (mode == x3d_BlendFactorAlpha)\n\t\t{\n\t\t\tcurrentColor .rgb = arg1 .rgb * x3d_MultiTextureColor .a + arg2 .rgb * (1.0 - x3d_MultiTextureColor .a);\n\t\t}\n\t\telse if (mode == x3d_BlendCurrentAlpha)\n\t\t{\n\t\t\tcurrentColor .rgb = arg1 .rgb * arg2 .a + arg2 .rgb * (1.0 - arg2 .a);\n\t\t}\n\t\telse if (mode == x3d_ModulateAlphaAddColor)\n\t\t{\n\t\t\tcurrentColor .rgb = arg1 .rgb + arg1 .a * arg2 .rgb;\n\t\t}\n\t\telse if (mode == x3d_ModulateInvAlphaAddColor)\n\t\t{\n\t\t\tcurrentColor .rgb = (1.0 - arg1 .a) * arg2 .rgb + arg1 .rgb;\n\t\t}\n\t\telse if (mode == x3d_ModulateInvColorAddAlpha)\n\t\t{\n\t\t\tcurrentColor .rgb = (1.0 - arg1 .rgb) * arg2 .rgb + arg1 .a;\n\t\t}\n\t\telse if (mode == x3d_DotProduct3)\n\t\t{\n\t\t\tcurrentColor .rgb = vec3 (dot (arg1 .rgb * 2.0 - 1.0, arg2 .rgb * 2.0 - 1.0));\n\t\t}\n\t\telse if (mode == x3d_SelectArg1)\n\t\t{\n\t\t\tcurrentColor .rgb = arg1 .rgb;\n\t\t}\n\t\telse if (mode == x3d_SelectArg2)\n\t\t{\n\t\t\tcurrentColor .rgb = arg2 .rgb;\n\t\t}\n\t\telse if (mode == x3d_Off)\n\t\t\t;\n\n\t\t// Alpha\n\n\t\tif (alphaMode == x3d_Replace)\n\t\t{\n\t\t\tcurrentColor .a = arg1 .a;\n\t\t}\n\t\telse if (alphaMode == x3d_Modulate)\n\t\t{\n\t\t\tcurrentColor .a = arg1 .a * arg2 .a;\n\t\t}\n\t\telse if (mode == x3d_Modulate2X)\n\t\t{\n\t\t\tcurrentColor .a = (arg1 .a * arg2 .a) * 2.0;\n\t\t}\n\t\telse if (mode == x3d_Modulate4X)\n\t\t{\n\t\t\tcurrentColor .a = (arg1 .a * arg2 .a) * 4.0;\n\t\t}\n\t\telse if (mode == x3d_Add)\n\t\t{\n\t\t\tcurrentColor .a = arg1 .a + arg2 .a;\n\t\t}\n\t\telse if (mode == x3d_AddSigned)\n\t\t{\n\t\t\tcurrentColor .a = arg1 .a + arg2 .a - 0.5;\n\t\t}\n\t\telse if (mode == x3d_AddSigned2X)\n\t\t{\n\t\t\tcurrentColor .a = (arg1 .a + arg2 .a - 0.5) * 2.0;\n\t\t}\n\t\telse if (mode == x3d_AddSmooth)\n\t\t{\n\t\t\tcurrentColor .a = arg1 .a + (1.0 - arg1 .a) * arg2 .a;\n\t\t}\n\t\telse if (mode == x3d_Subtract)\n\t\t{\n\t\t\tcurrentColor .a = arg1 .a - arg2 .a;\n\t\t}\n\t\telse if (mode == x3d_BlendDiffuseAlpha)\n\t\t{\n\t\t\tcurrentColor .a = arg1 .a * diffuseColor .a + arg2 .a * (1.0 - diffuseColor .a);\n\t\t}\n\t\telse if (mode == x3d_BlendTextureAlpha)\n\t\t{\n\t\t\tcurrentColor .a = arg1 .a * arg1 .a + arg2 .a * (1.0 - arg1 .a);\n\t\t}\n\t\telse if (mode == x3d_BlendFactorAlpha)\n\t\t{\n\t\t\tcurrentColor .a = arg1 .a * x3d_MultiTextureColor .a + arg2 .a * (1.0 - x3d_MultiTextureColor .a);\n\t\t}\n\t\telse if (mode == x3d_BlendCurrentAlpha)\n\t\t{\n\t\t\tcurrentColor .a = arg1 .a * arg2 .a + arg2 .a * (1.0 - arg2 .a);\n\t\t}\n\t\telse if (mode == x3d_ModulateAlphaAddColor)\n\t\t{\n\t\t\tcurrentColor .a = arg1 .a + arg1 .a * arg2 .a;\n\t\t}\n\t\telse if (mode == x3d_ModulateInvAlphaAddColor)\n\t\t{\n\t\t\tcurrentColor .a = (1.0 - arg1 .a) * arg2 .a + arg1 .a;\n\t\t}\n\t\telse if (mode == x3d_ModulateInvColorAddAlpha)\n\t\t{\n\t\t\tcurrentColor .a = (1.0 - arg1 .a) * arg2 .a + arg1 .a;\n\t\t}\n\t\telse if (mode == x3d_DotProduct3)\n\t\t{\n\t\t\tcurrentColor .a = dot (arg1 .rgb * 2.0 - 1.0, arg2 .rgb * 2.0 - 1.0);\n\t\t}\n\t\telse if (mode == x3d_SelectArg1)\n\t\t{\n\t\t\tcurrentColor .a = arg1 .a;\n\t\t}\n\t\telse if (mode == x3d_SelectArg2)\n\t\t{\n\t\t\tcurrentColor .a = arg2 .a;\n\t\t}\n\t\telse if (mode == x3d_Off)\n\t\t\t;\n\t}\n\n\treturn currentColor;\n}\n#else\nvec4\ngetTextureColor (const in vec4 diffuseColor, const in vec4 specularColor)\n{\n\t// Get texture color.\n\n\tvec4 texCoord     = texCoord0;\n\tvec4 textureColor = vec4 (1.0);\n\n\tif (x3d_TextureType [0] == x3d_TextureType2D)\n\t{\n\t\tif (x3d_GeometryType == x3d_Geometry3D || gl_FrontFacing)\n\t\t\ttextureColor = texture (x3d_Texture2D [0], vec2 (texCoord));\n\t\telse\n\t\t\t// If dimension is x3d_Geometry2D the texCoord must be flipped.\n\t\t\ttextureColor = texture (x3d_Texture2D [0], vec2 (1.0 - texCoord .s, texCoord .t));\n\t}\n \telse if (x3d_TextureType [0] == x3d_TextureTypeCubeMapTexture)\n\t{\n\t\tif (x3d_GeometryType == x3d_Geometry3D || gl_FrontFacing)\n\t\t\ttextureColor = texture (x3d_CubeMapTexture [0], vec3 (texCoord));\n\t\telse\n\t\t\t// If dimension is x3d_Geometry2D the texCoord must be flipped.\n\t\t\ttextureColor = texture (x3d_CubeMapTexture [0], vec3 (1.0 - texCoord .s, texCoord .t, texCoord .z));\n\t}\n\n\treturn diffuseColor * textureColor;\n}\n#endif\n'}),define("text!x_ite/Browser/Shaders/Types.h",[],function(){return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nstruct x3d_FogParameters {\n\tmediump int   type;\n\tmediump vec3  color;\n\tmediump float visibilityRange;\n\tmediump mat3  matrix;\n\tbool          fogCoord;\n};\n\n//uniform x3d_FogParameters x3d_Fog;\n\nstruct x3d_LightSourceParameters {\n\tmediump int   type;\n\tmediump vec3  color;\n\tmediump float intensity;\n\tmediump float ambientIntensity;\n\tmediump vec3  attenuation;\n\tmediump vec3  location;\n\tmediump vec3  direction;\n\tmediump float radius;\n\tmediump float beamWidth;\n\tmediump float cutOffAngle;\n\tmediump mat3  matrix;\n\t#ifdef X3D_SHADOWS\n\tmediump vec3  shadowColor;\n\tmediump float shadowIntensity;\n\tmediump float shadowBias;\n\tmediump mat4  shadowMatrix;\n\tmediump int   shadowMapSize;\n\t#endif\n};\n\n//uniform x3d_LightSourceParameters x3d_LightSource [x3d_MaxLights];\n\nstruct x3d_LinePropertiesParameters  \n{   \n\tbool          applied;\n\tmediump float linewidthScaleFactor;\n\tsampler2D     linetype;\n};\n\n//uniform x3d_LinePropertiesParameters x3d_LineProperties;\n\nstruct x3d_FillPropertiesParameters  \n{   \n\tbool         filled;\n\tbool         hatched;\n\tmediump vec3 hatchColor;\n\tsampler2D    hatchStyle;\n};\n\n//uniform x3d_FillPropertiesParameters x3d_FillProperties;\n\nstruct x3d_MaterialParameters  \n{   \n\tmediump float ambientIntensity;\n\tmediump vec3  diffuseColor;\n\tmediump vec3  specularColor;\n\tmediump vec3  emissiveColor;\n\tmediump float shininess;\n\tmediump float transparency;\n};\n\n//uniform x3d_MaterialParameters x3d_FrontMaterial;\n//uniform x3d_MaterialParameters x3d_BackMaterial;\n\nstruct x3d_MultiTextureParameters  \n{   \n\tmediump int mode;\n\tmediump int alphaMode;\n\tmediump int source;\n\tmediump int function;\n};\n\n//uniform x3d_MultiTextureParameters x3d_MultiTexture [x3d_MaxTextures];\n\nstruct x3d_TextureCoordinateGeneratorParameters  \n{   \n\tmediump int   mode;\n\tmediump float parameter [6];\n};\n\n//uniform x3d_TextureCoordinateGeneratorParameters x3d_TextureCoordinateGenerator [x3d_MaxTextures];\n\nstruct x3d_ParticleParameters  \n{   \n\tmediump int   id;\n\tmediump int   life;\n\tmediump float elapsedTime;\n};\n\n//uniform x3d_ParticleParameters x3d_Particle;\n"}),define("x_ite/Browser/Texturing/MultiTextureModeType",[],function(){"use strict";var t=0;return{REPLACE:t++,MODULATE:t++,MODULATE2X:t++,MODULATE4X:t++,ADD:t++,ADDSIGNED:t++,ADDSIGNED2X:t++,ADDSMOOTH:t++,SUBTRACT:t++,BLENDDIFFUSEALPHA:t++,BLENDTEXTUREALPHA:t++,BLENDFACTORALPHA:t++,BLENDCURRENTALPHA:t++,MODULATEALPHA_ADDCOLOR:t++,MODULATEINVALPHA_ADDCOLOR:t++,MODULATEINVCOLOR_ADDALPHA:t++,DOTPRODUCT3:t++,SELECTARG1:t++,SELECTARG2:t++,OFF:t++}}),define("x_ite/Browser/Texturing/MultiTextureSourceType",[],function(){"use strict";var t=0;return{DEFAULT:t++,DIFFUSE:t++,SPECULAR:t++,FACTOR:t++}}),define("x_ite/Browser/Texturing/MultiTextureFunctionType",[],function(){"use strict";var t=0;return{DEFAULT:t++,COMPLEMENT:t++,ALPHAREPLICATE:t++}}),define("x_ite/Browser/Texturing/TextureCoordinateGeneratorModeType",[],function(){"use strict";var t=0;return{NONE:t++,SPHERE:t++,CAMERASPACENORMAL:t++,CAMERASPACEPOSITION:t++,CAMERASPACEREFLECTIONVECTOR:t++,SPHERE_LOCAL:t++,COORD:t++,COORD_EYE:t++,NOISE:t++,NOISE_EYE:t++,SPHERE_REFLECT:t++,SPHERE_REFLECT_LOCAL:t++}}),define("x_ite/Browser/Shaders/Shader",["text!x_ite/Browser/Shaders/WebGL1/Include/ClipPlanes.h","text!x_ite/Browser/Shaders/WebGL1/Include/Fog.h","text!x_ite/Browser/Shaders/WebGL1/Include/Hatch.h","text!x_ite/Browser/Shaders/WebGL1/Include/Pack.h","text!x_ite/Browser/Shaders/WebGL1/Include/Perlin.h","text!x_ite/Browser/Shaders/WebGL1/Include/Shadow.h","text!x_ite/Browser/Shaders/WebGL1/Include/Texture.h","text!x_ite/Browser/Shaders/WebGL2/Include/ClipPlanes.h","text!x_ite/Browser/Shaders/WebGL2/Include/Fog.h","text!x_ite/Browser/Shaders/WebGL2/Include/Hatch.h","text!x_ite/Browser/Shaders/WebGL2/Include/Pack.h","text!x_ite/Browser/Shaders/WebGL2/Include/Perlin.h","text!x_ite/Browser/Shaders/WebGL2/Include/Shadow.h","text!x_ite/Browser/Shaders/WebGL2/Include/Texture.h","text!x_ite/Browser/Shaders/Types.h","x_ite/Browser/Texturing/MultiTextureModeType","x_ite/Browser/Texturing/MultiTextureSourceType","x_ite/Browser/Texturing/MultiTextureFunctionType","x_ite/Browser/Texturing/TextureCoordinateGeneratorModeType","x_ite/DEBUG"],function(t,e,n,i,r,o,s,a,u,l,c,h,d,p,f,g,m,x,v,_){"use strict";function y(t,e,n){t.indexOf(e)!==-1&&console.warn("Use of '"+e+"' is depreciated, use '"+n+"' instead. See http://create3000.de/x_ite/custom-shaders/.")}return{getSource:function(t,e){var n=e.split("\n"),i=null;e="";for(var r=0,o=n.length;r<o;++r){var s=n[r];(i=s.match(/^#pragma\s+X3D\s+include\s+".*?([^\/]+).h"\s*$/))?(e+="#line 1\n",e+=this.getSource(t,t[i[1]]),e+="\n",e+="#line "+(r+1)+"\n"):(e+=s,e+="\n")}return e},getShaderSource:function(_,w,b,S){var C=_.getContext();if(C.getVersion()<=1)var T={ClipPlanes:t,Fog:e,Hatch:n,Pack:i,Perlin:r,Shadow:o,Texture:s};else var T={ClipPlanes:a,Fog:u,Hatch:l,Pack:c,Perlin:h,Shadow:d,Texture:p};b=this.getSource(T,b);var F=new RegExp("^((?:#version\\s+.*?\\n)?)((?:\\s+|/\\*[^]*?\\*/|//.*?\\n|#line\\s+.*?\\n|#if\\s+.*?\\n|#elif\\s+.*?\\n|#ifdef\\s+.*?\\n|#ifndef\\s+.*?\\n|#else.*?\\n|#endif.*?\\n|#define\\s+(?:[^\\n\\\\]|\\\\[^\\r\\n]|\\\\\\r?\\n)*\\n|#undef\\s+.*?\\n|#pragma\\s+.*?\\n|#extension\\s+.*?\\n)*)([^]*)$"),O=b.match(F);if(!O)return b;var N="";N+="#define X_ITE\n",_.getRenderingProperty("LogarithmicDepthBuffer")&&(N+="#define X3D_LOGARITHMIC_DEPTH_BUFFER\n"),(C.getVersion()>=2||_.getExtension("WEBGL_depth_texture"))&&(N+="#define X3D_DEPTH_TEXTURE\n"),_.getMultiTexturing()&&(N+="#define X3D_MULTI_TEXTURING\n"),S&&(N+="#define X3D_SHADOWS\n");var E="";E+="#define x3d_None 0\n",E+="#define x3d_Points      0\n",E+="#define x3d_Lines       1\n",E+="#define x3d_Geometry2D  2\n",E+="#define x3d_Geometry3D  3\n",E+="#define x3d_MaxClipPlanes  "+_.getMaxClipPlanes()+"\n",E+="#define x3d_LinearFog        1\n",E+="#define x3d_ExponentialFog   2\n",E+="#define x3d_Exponential2Fog  3\n",E+="#define x3d_MaxLights         "+_.getMaxLights()+"\n",E+="#define x3d_DirectionalLight  1\n",E+="#define x3d_PointLight        2\n",E+="#define x3d_SpotLight         3\n",E+="#define X3D_PCF_FILTERING\n",E+="#define x3d_MaxTextures                "+_.getMaxTextures()+"\n",E+="#define x3d_TextureType2D              2\n",E+="#define x3d_TextureType3D              3\n",E+="#define x3d_TextureTypeCubeMapTexture  4\n",E+="#define x3d_Replace                   "+g.REPLACE+"\n",E+="#define x3d_Modulate                  "+g.MODULATE+"\n",E+="#define x3d_Modulate2X                "+g.MODULATE2X+"\n",E+="#define x3d_Modulate4X                "+g.MODULATE4X+"\n",E+="#define x3d_Add                       "+g.ADD+"\n",E+="#define x3d_AddSigned                 "+g.ADDSIGNED+"\n",E+="#define x3d_AddSigned2X               "+g.ADDSIGNED2X+"\n",E+="#define x3d_AddSmooth                 "+g.ADDSMOOTH+"\n",E+="#define x3d_Subtract                  "+g.SUBTRACT+"\n",E+="#define x3d_BlendDiffuseAlpha         "+g.BLENDDIFFUSEALPHA+"\n",E+="#define x3d_BlendTextureAlpha         "+g.BLENDTEXTUREALPHA+"\n",E+="#define x3d_BlendFactorAlpha          "+g.BLENDFACTORALPHA+"\n",E+="#define x3d_BlendCurrentAlpha         "+g.BLENDCURRENTALPHA+"\n",E+="#define x3d_ModulateAlphaAddColor     "+g.MODULATEALPHA_ADDCOLOR+"\n",E+="#define x3d_ModulateInvAlphaAddColor  "+g.MODULATEINVALPHA_ADDCOLOR+"\n",E+="#define x3d_ModulateInvColorAddAlpha  "+g.MODULATEINVCOLOR_ADDALPHA+"\n",E+="#define x3d_DotProduct3               "+g.DOTPRODUCT3+"\n",E+="#define x3d_SelectArg1                "+g.SELECTARG1+"\n",E+="#define x3d_SelectArg2                "+g.SELECTARG2+"\n",E+="#define x3d_Off                       "+g.OFF+"\n",E+="#define x3d_Diffuse  "+m.DIFFUSE+"\n",E+="#define x3d_Specular "+m.SPECULAR+"\n",E+="#define x3d_Factor   "+m.FACTOR+"\n",E+="#define x3d_Complement     "+x.COMPLEMENT+"\n",E+="#define x3d_AlphaReplicate "+x.ALPHAREPLICATE+"\n",E+="#define x3d_Sphere                      "+v.SPHERE+"\n",E+="#define x3d_CameraSpaceNormal           "+v.CAMERASPACENORMAL+"\n",E+="#define x3d_CameraSpacePosition         "+v.CAMERASPACEPOSITION+"\n",E+="#define x3d_CameraSpaceReflectionVector "+v.CAMERASPACEREFLECTIONVECTOR+"\n",E+="#define x3d_SphereLocal                 "+v.SPHERE_LOCAL+"\n",E+="#define x3d_Coord                       "+v.COORD+"\n",E+="#define x3d_CoordEye                    "+v.COORD_EYE+"\n",E+="#define x3d_Noise                       "+v.NOISE+"\n",E+="#define x3d_NoiseEye                    "+v.NOISE_EYE+"\n",E+="#define x3d_SphereReflect               "+v.SPHERE_REFLECT+"\n",E+="#define x3d_SphereReflectLocal          "+v.SPHERE_REFLECT_LOCAL+"\n",E+="#define x3d_GeometryPoints  0\n",E+="#define x3d_GeometryLines   1\n",E+="#define x3d_NoneClipPlane   vec4 (88.0, 51.0, 68.0, 33.0)\n",E+="#define x3d_NoneFog         0\n",E+="#define x3d_NoneLight       0\n",E+="#define x3d_NoneTexture     0\n",y(b,"x3d_GeometryPoints","x3d_Points"),y(b,"x3d_GeometryLines","x3d_Lines"),y(b,"x3d_NoneClipPlane","x3d_NumClipPlanes"),y(b,"x3d_NoneFog","x3d_None"),y(b,"x3d_NoneLight","x3d_NumLights"),y(b,"x3d_NoneTexture","x3d_NumTextures");var M=b.replace(/\/\*[\s\S]*?\*\/|\/\/.*?\n/g,""),D=f,V=M.match(/\s*precision\s+(lowp|mediump|highp)\s+float\s*;/),I=M.match(/\s*precision\s+(lowp|mediump|highp)\s+int\s*;/),B=V?V[1]:"mediump",L=I?I[1]:"mediump";return D=D.replace(/mediump\s+(float|vec2|vec3|mat3|mat4)/g,B+" $1"),D=D.replace(/mediump\s+(int)/g,L+" $1"),O[1]+N+O[2]+E+D+O[3]}}}),define("x_ite/Parser/HTMLSupport",[],function(){"use strict";var t={attributeLowerCaseToCamelCase:{accesstype:"accessType",actionkeypress:"actionKeyPress",actionkeyrelease:"actionKeyRelease",activate:"activate",activelayer:"activeLayer",additionalinterface:"additionalInterface",address:"address",align:"align",alpha:"alpha",altkey:"altKey",ambientintensity:"ambientIntensity",anchorpoint:"anchorPoint",angle:"angle",anglerate:"angleRate",angulardampingfactor:"angularDampingFactor",angularvelocity:"angularVelocity",anisotropicdegree:"anisotropicDegree",antennalocation:"antennaLocation",antennapatternlength:"antennaPatternLength",antennapatterntype:"antennaPatternType",appinfo:"appinfo",applicationid:"applicationID",applied:"applied",appliedparameters:"appliedParameters",articulationparameterarray:"articulationParameterArray",articulationparameterchangeindicatorarray:"articulationParameterChangeIndicatorArray",
articulationparametercount:"articulationParameterCount",articulationparameterdesignatorarray:"articulationParameterDesignatorArray",articulationparameteridpartattachedtoarray:"articulationParameterIdPartAttachedToArray",articulationparametertypearray:"articulationParameterTypeArray",articulationparametervalue0_changed:"articulationParameterValue0_changed",articulationparametervalue1_changed:"articulationParameterValue1_changed",articulationparametervalue2_changed:"articulationParameterValue2_changed",articulationparametervalue3_changed:"articulationParameterValue3_changed",articulationparametervalue4_changed:"articulationParameterValue4_changed",articulationparametervalue5_changed:"articulationParameterValue5_changed",articulationparametervalue6_changed:"articulationParameterValue6_changed",articulationparametervalue7_changed:"articulationParameterValue7_changed",as:"AS",attenuation:"attenuation",autocalc:"autoCalc",autodamp:"autoDamp",autodisable:"autoDisable",autooffset:"autoOffset",avatarsize:"avatarSize",axis:"axis",axis1:"axis1",axis1angle:"axis1Angle",axis1torque:"axis1Torque",axis2:"axis2",axis2angle:"axis2Angle",axis2torque:"axis2Torque",axis3angle:"axis3Angle",axis3torque:"axis3Torque",axisofrotation:"axisOfRotation",axisrotation:"axisRotation",backambientintensity:"backAmbientIntensity",backdiffusecolor:"backDiffuseColor",backemissivecolor:"backEmissiveColor",backshininess:"backShininess",backspecularcolor:"backSpecularColor",backtransparency:"backTransparency",backurl:"backUrl",bboxcenter:"bboxCenter",bboxsize:"bboxSize",beamwidth:"beamWidth",begincap:"beginCap",bindtime:"bindTime",body1anchorpoint:"body1AnchorPoint",body1axis:"body1Axis",body2anchorpoint:"body2AnchorPoint",body2axis:"body2Axis",bordercolor:"borderColor",borderwidth:"borderWidth",bottom:"bottom",bottomradius:"bottomRadius",bottomurl:"bottomUrl",bounce:"bounce",boundarymoder:"boundaryModeR",boundarymodes:"boundaryModeS",boundarymodet:"boundaryModeT",boundaryopacity:"boundaryOpacity",category:"category",ccw:"ccw",center:"center",centerofmass:"centerOfMass",centerofrotation:"centerOfRotation",centerofrotation_changed:"centerOfRotation_changed",child1url:"child1Url",child2url:"child2Url",child3url:"child3Url",child4url:"child4Url",class:"class",clipboundary:"clipBoundary",closed:"closed",closuretype:"closureType",collidetime:"collideTime",collisiontype:"collisionType",color:"color",colorindex:"colorIndex",colorkey:"colorKey",colorpervertex:"colorPerVertex",colorsteps:"colorSteps",constantforcemix:"constantForceMix",contactnormal:"contactNormal",contactsurfacethickness:"contactSurfaceThickness",containerfield:"containerField",content:"content",contourstepsize:"contourStepSize",controlkey:"controlKey",controlpoint:"controlPoint",conversionfactor:"conversionFactor",convex:"convex",coolcolor:"coolColor",coordindex:"coordIndex",country:"country",creaseangle:"creaseAngle",createparticles:"createParticles",crosssection:"crossSection",cryptokeyid:"cryptoKeyID",cryptosystem:"cryptoSystem",cutoffangle:"cutOffAngle",cycleinterval:"cycleInterval",cycletime:"cycleTime",data:"data",datalength:"dataLength",deadreckoning:"deadReckoning",def:"DEF",deletionallowed:"deletionAllowed",depth:"depth",description:"description",desiredangularvelocity1:"desiredAngularVelocity1",desiredangularvelocity2:"desiredAngularVelocity2",detonatetime:"detonateTime",detonationlocation:"detonationLocation",detonationrelativelocation:"detonationRelativeLocation",detonationresult:"detonationResult",diffusecolor:"diffuseColor",dimensions:"dimensions",dir:"dir",direction:"direction",directoutput:"directOutput",disableangularspeed:"disableAngularSpeed",disablelinearspeed:"disableLinearSpeed",disabletime:"disableTime",diskangle:"diskAngle",displacements:"displacements",displayed:"displayed",documentation:"documentation",domain:"domain",duration:"duration",duration_changed:"duration_changed",easeineaseout:"easeInEaseOut",edgecolor:"edgeColor",elapsedtime:"elapsedTime",emissivecolor:"emissiveColor",enabled:"enabled",enabledaxes:"enabledAxes",encodingscheme:"encodingScheme",endangle:"endAngle",endcap:"endCap",enteredtext:"enteredText",entertime:"enterTime",entitycategory:"entityCategory",entitycountry:"entityCountry",entitydomain:"entityDomain",entityextra:"entityExtra",entityid:"entityID",entitykind:"entityKind",entityspecific:"entitySpecific",entitysubcategory:"entitySubcategory",errorcorrection:"errorCorrection",eventapplicationid:"eventApplicationID",evententityid:"eventEntityID",eventnumber:"eventNumber",eventsiteid:"eventSiteID",exittime:"exitTime",extra:"extra",family:"family",fancount:"fanCount",fieldofview:"fieldOfView",filled:"filled",finaltext:"finalText",finiterotationaxis:"finiteRotationAxis",fired1:"fired1",fired2:"fired2",firedtime:"firedTime",firemissionindex:"fireMissionIndex",firingrange:"firingRange",firingrate:"firingRate",fixed:"fixed",fogtype:"fogType",force:"force",forceid:"forceID",forceoutput:"forceOutput",forces:"forces",forcetransitions:"forceTransitions",fraction_changed:"fraction_changed",frequency:"frequency",frictioncoefficients:"frictionCoefficients",frictiondirection:"frictionDirection",fromfield:"fromField",fromnode:"fromNode",fronturl:"frontUrl",function:"function",fuse:"fuse",generatemipmaps:"generateMipMaps",geocenter:"geoCenter",geocoord_changed:"geoCoord_changed",geocoords:"geoCoords",geogridorigin:"geoGridOrigin",geometrytype:"geometryType",geosystem:"geoSystem",geovalue_changed:"geovalue_changed",global:"global",gradientthreshold:"gradientThreshold",gravity:"gravity",groundangle:"groundAngle",groundcolor:"groundColor",gustiness:"gustiness",hatchcolor:"hatchColor",hatched:"hatched",hatchstyle:"hatchStyle",headlight:"headlight",height:"height",hinge1angle:"hinge1Angle",hinge1anglerate:"hinge1AngleRate",hinge2angle:"hinge2Angle",hinge2anglerate:"hinge2AngleRate",hitgeocoord_changed:"hitGeoCoord_changed",hitnormal_changed:"hitNormal_changed",hitpoint_changed:"hitPoint_changed",hittexcoord_changed:"hitTexCoord_changed",horizontal:"horizontal","http-equiv":"http-equiv",image:"image",importeddef:"importedDEF",index:"index",inertia:"inertia",info:"info",initialdestination:"initialDestination",initialvalue:"initialValue",inlinedef:"inlineDEF",innerradius:"innerRadius",inputfalse:"inputFalse",inputnegate:"inputNegate",inputsource:"inputSource",inputtrue:"inputTrue",integerkey:"integerKey",intensity:"intensity",intensitythreshold:"intensityThreshold",internal:"internal",intersectiontype:"intersectionType",isactive:"isActive",isbound:"isBound",iscollided:"isCollided",isdetonated:"isDetonated",isloaded:"isLoaded",isnetworkreader:"isNetworkReader",isnetworkwriter:"isNetworkWriter",isover:"isOver",ispaused:"isPaused",ispickable:"isPickable",isrtpheaderheard:"isRtpHeaderHeard",isselected:"isSelected",isstandalone:"isStandAlone",isvalid:"isValid",iterations:"iterations",jump:"jump",justify:"justify",key:"key",keypress:"keyPress",keyrelease:"keyRelease",keyvalue:"keyValue",keyvelocity:"keyVelocity",kind:"kind",knot:"knot",lang:"lang",language:"language",lefttoright:"leftToRight",lefturl:"leftUrl",length:"length",lengthofmodulationparameters:"lengthOfModulationParameters",level:"level",level_changed:"level_changed",lifetimevariation:"lifetimeVariation",lighting:"lighting",limitorientation:"limitOrientation",linearacceleration:"linearAcceleration",lineardampingfactor:"linearDampingFactor",linearvelocity:"linearVelocity",linebounds:"lineBounds",linesegments:"lineSegments",linetype:"linetype",linewidthscalefactor:"linewidthScaleFactor",llimit:"llimit",load:"load",loadtime:"loadTime",localdef:"localDEF",location:"location",loop:"loop",magnificationfilter:"magnificationFilter",marking:"marking",mass:"mass",matrix:"matrix",maxangle:"maxAngle",maxangle1:"maxAngle1",maxback:"maxBack",maxcorrectionspeed:"maxCorrectionSpeed",maxextent:"maxExtent",maxfront:"maxFront",maxparticles:"maxParticles",maxposition:"maxPosition",maxseparation:"maxSeparation",maxtorque1:"maxTorque1",maxtorque2:"maxTorque2",minangle:"minAngle",minangle1:"minAngle1",minback:"minBack",minbouncespeed:"minBounceSpeed",minfront:"minFront",minificationfilter:"minificationFilter",minposition:"minPosition",minseparation:"minSeparation",mode:"mode",modifiedfraction_changed:"modifiedFraction_changed",modulationtypedetail:"modulationTypeDetail",modulationtypemajor:"modulationTypeMajor",modulationtypespreadspectrum:"modulationTypeSpreadSpectrum",modulationtypesystem:"modulationTypeSystem",momentsofinertia:"momentsOfInertia",motor1angle:"motor1Angle",motor1anglerate:"motor1AngleRate",motor1axis:"motor1Axis",motor2angle:"motor2Angle",motor2anglerate:"motor2AngleRate",motor2axis:"motor2Axis",motor3angle:"motor3Angle",motor3anglerate:"motor3AngleRate",motor3axis:"motor3Axis",multicastrelayhost:"multicastRelayHost",multicastrelayport:"multicastRelayPort",munitionapplicationid:"munitionApplicationID",munitionendpoint:"munitionEndPoint",munitionentityid:"munitionEntityID",munitionquantity:"munitionQuantity",munitionsiteid:"munitionSiteID",munitionstartpoint:"munitionStartPoint",mustevaluate:"mustEvaluate",name:"name",networkmode:"networkMode",next:"next",nodefield:"nodeField",normal_changed:"normal_changed",normalindex:"normalIndex",normalizevelocity:"normalizeVelocity",normalpervertex:"normalPerVertex",numcomponents:"numComponents",objecttype:"objectType",offset:"offset",offsetunits:"offsetUnits",on:"on",opacityfactor:"opacityFactor",order:"order",orientation:"orientation",orientation_changed:"orientation_changed",origin:"origin",orthogonalcolor:"orthogonalColor",outerradius:"outerRadius",parallelcolor:"parallelColor",parameter:"parameter",particlelifetime:"particleLifetime",particlesize:"particleSize",pausetime:"pauseTime",phasefunction:"phaseFunction",pickable:"pickable",pickednormal:"pickedNormal",pickedpoint:"pickedPoint",pickedtexturecoordinate:"pickedTextureCoordinate",pitch:"pitch",plane:"plane",point:"point",pointsize:"pointSize",port:"port",position:"position",position_changed:"position_changed",power:"power",preferaccuracy:"preferAccuracy",previous:"previous",priority:"priority",profile:"profile",progress:"progress",protofield:"protoField",radioentitytypecategory:"radioEntityTypeCategory",radioentitytypecountry:"radioEntityTypeCountry",radioentitytypedomain:"radioEntityTypeDomain",radioentitytypekind:"radioEntityTypeKind",radioentitytypenomenclature:"radioEntityTypeNomenclature",radioentitytypenomenclatureversion:"radioEntityTypeNomenclatureVersion",radioid:"radioID",radius:"radius",range:"range",readinterval:"readInterval",receivedpower:"receivedPower",receiverstate:"receiverState",reference:"reference",relativeantennalocation:"relativeAntennaLocation",repeatr:"repeatR",repeats:"repeatS",repeatt:"repeatT",resumetime:"resumeTime",retainedopacity:"retainedOpacity",retainuseroffsets:"retainUserOffsets",righturl:"rightUrl",rooturl:"rootUrl",rotateyup:"rotateYUp",rotation:"rotation",rotation_changed:"rotation_changed",rtpheaderexpected:"rtpHeaderExpected",samplerate:"sampleRate",samples:"samples",scale:"scale",scalemode:"scaleMode",scaleorientation:"scaleOrientation",scheme:"scheme",segmentenabled:"segmentEnabled",separatebackcolor:"separateBackColor",separation:"separation",separationrate:"separationRate",set_articulationparametervalue0:"set_articulationParameterValue0",set_articulationparametervalue1:"set_articulationParameterValue1",set_articulationparametervalue2:"set_articulationParameterValue2",set_articulationparametervalue3:"set_articulationParameterValue3",set_articulationparametervalue4:"set_articulationParameterValue4",set_articulationparametervalue5:"set_articulationParameterValue5",set_articulationparametervalue6:"set_articulationParameterValue6",set_articulationparametervalue7:"set_articulationParameterValue7",set_bind:"set_bind",set_boolean:"set_boolean",set_colorindex:"set_colorIndex",set_coordindex:"set_coordIndex",set_crosssection:"set_crossSection",set_destination:"set_destination",set_fraction:"set_fraction",set_height:"set_height",set_index:"set_index",set_normalindex:"set_normalIndex",set_orientation:"set_orientation",set_scale:"set_scale",set_spine:"set_spine",set_texcoordindex:"set_texCoordIndex",set_triggertime:"set_triggerTime",set_value:"set_value",shadows:"shadows",shiftkey:"shiftKey",shininess:"shininess",side:"side",silhouetteboundaryopacity:"silhouetteBoundaryOpacity",silhouetteretainedopacity:"silhouetteRetainedOpacity",silhouettesharpness:"silhouetteSharpness",siteid:"siteID",size:"size",sizeunits:"sizeUnits",skincoordindex:"skinCoordIndex",skincoordweight:"skinCoordWeight",skyangle:"skyAngle",skycolor:"skyColor",sliderforce:"sliderForce",slipcoefficients:"slipCoefficients",slipfactors:"slipFactors",softnessconstantforcemix:"softnessConstantForceMix",softnesserrorcorrection:"softnessErrorCorrection",solid:"solid",sortorder:"sortOrder",source:"source",spacing:"spacing",spatialize:"spatialize",specific:"specific",specularcolor:"specularColor",speed:"speed",speedfactor:"speedFactor",spine:"spine",startangle:"startAngle",starttime:"startTime",stiffness:"stiffness",stop1bounce:"stop1Bounce",stop1constantforcemix:"stop1ConstantForceMix",stop1errorcorrection:"stop1ErrorCorrection",stop2bounce:"stop2Bounce",stop2errorcorrection:"stop2ErrorCorrection",stop3bounce:"stop3Bounce",stop3errorcorrection:"stop3ErrorCorrection",stopbounce:"stopBounce",stoperrorcorrection:"stopErrorCorrection",stoptime:"stopTime",string:"string",stripcount:"stripCount",style:"style",subcategory:"subcategory",summary:"summary",surfacearea:"surfaceArea",surfacespeed:"surfaceSpeed",surfacetolerance:"surfaceTolerance",surfacevalues:"surfaceValues",suspensionerrorcorrection:"suspensionErrorCorrection",suspensionforce:"suspensionForce",tau:"tau",tdltype:"tdlType",tessellation:"tessellation",tessellationscale:"tessellationScale",texcoordindex:"texCoordIndex",texcoordkey:"texCoordKey",textbounds:"textBounds",texturecompression:"textureCompression",texturepriority:"texturePriority",time:"time",timeout:"timeOut",timestamp:"timestamp",title:"title",tofield:"toField",toggle:"toggle",tolerance:"tolerance",tonode:"toNode",top:"top",toptobottom:"topToBottom",topurl:"topUrl",torques:"torques",touchtime:"touchTime",trackpoint_changed:"trackPoint_changed",transitioncomplete:"transitionComplete",transitiontime:"transitionTime",transitiontype:"transitionType",translation:"translation",translation_changed:"translation_changed",transmitfrequencybandwidth:"transmitFrequencyBandwidth",transmitstate:"transmitState",transmitterapplicationid:"transmitterApplicationID",transmitterentityid:"transmitterEntityID",transmitterradioid:"transmitterRadioID",transmittersiteid:"transmitterSiteID",transparency:"transparency",triggertime:"triggerTime",triggertrue:"triggerTrue",triggervalue:"triggerValue",turbulence:"turbulence",type:"type",uclosed:"uClosed",udimension:"uDimension",uknot:"uKnot",ulimit:"ulimit",uorder:"uOrder",update:"update",url:"url",use:"USE",usefiniterotation:"useFiniteRotation",usegeometry:"useGeometry",useglobalgravity:"useGlobalGravity",utessellation:"uTessellation",value:"value",value_changed:"value_changed",variation:"variation",vclosed:"vClosed",vdimension:"vDimension",vector:"vector",version:"version",vertexcount:"vertexCount",vertices:"vertices",visibilitylimit:"visibilityLimit",visibilityrange:"visibilityRange",visible:"visible",vknot:"vKnot",vorder:"vOrder",vtessellation:"vTessellation",warhead:"warhead",warmcolor:"warmColor",weight:"weight",weightconstant1:"weightConstant1",weightconstant2:"weightConstant2",weightfunction1:"weightFunction1",weightfunction2:"weightFunction2",whichchoice:"whichChoice",whichgeometry:"whichGeometry",writeinterval:"writeInterval",xdimension:"xDimension",xspacing:"xSpacing",yscale:"yScale",zdimension:"zDimension",zspacing:"zSpacing"}};return Object.preventExtensions(t),Object.freeze(t),Object.seal(t),t}),define("x_ite/Parser/XMLParser",["jquery","x_ite/Basic/X3DField","x_ite/Basic/X3DBaseNode","x_ite/Components/Core/X3DPrototypeInstance","x_ite/Fields","x_ite/Parser/Parser","x_ite/Parser/X3DParser","x_ite/Parser/HTMLSupport","x_ite/Prototype/X3DExternProtoDeclaration","x_ite/Prototype/X3DProtoDeclaration","x_ite/Bits/X3DConstants"],function(t,e,n,i,r,o,s,a,u,l,c){"use strict";function h(t){s.call(this,t),this.protoDeclarations=[],this.parents=[],this.parser=new o(t),this.url=new r.MFString;try{this.setUnits(this.getScene().getMetaData("generator")),this.parser.setUnits(this.getUnits())}catch(t){}}function d(t){return t.replace(_,"").split(y)}function p(t){return t.replace(x,"Infinity").replace(v,"NaN").replace(_,"").split(y)}function f(t){return t.replace(_,"").split(y)}function g(t){for(var e=null,n=[];e=w.exec(t);)n.push(e[1]);return n.map(r.SFString.unescape)}var m={initializeOnly:c.initializeOnly,inputOnly:c.inputOnly,outputOnly:c.outputOnly,inputOutput:c.inputOutput};h.prototype=Object.assign(Object.create(s.prototype),{constructor:h,parseIntoScene:function(t,e,n){this.success=e,this.error=n,this.getScene().setEncoding("XML"),this.getScene().setProfile(this.getBrowser().getProfile("Full")),this.xmlElement(t)},parseIntoNode:function(t,e){this.pushExecutionContext(t.getExecutionContext()),this.pushParent(t),this.childElement(e),this.popParent(),this.popExecutionContext()},xmlElement:function(e){switch(e.nodeName){case"#document":var n=t(e).children("X3D");if(n.length)for(var i=0;i<n.length;++i)this.x3dElement(n[i]);else this.success?require(this.getProviderUrls(),function(){try{this.childrenElements(e),this.success(this)}catch(t){this.error&&this.error(t)}}.bind(this),function(t){this.error&&this.error(t)}.bind(this)):this.childrenElements(e);break;case"X3D":this.x3dElement(e);break;case"Scene":case"SCENE":this.success?require(this.getProviderUrls(),function(){try{this.sceneElement(e),this.success(this)}catch(t){this.error&&this.error(t)}}.bind(this),function(t){this.error&&this.error(t)}.bind(this)):this.sceneElement(e);break;default:this.success?require(this.getProviderUrls(),function(){try{this.childrenElements(e),this.success(this)}catch(t){this.error&&this.error(t)}}.bind(this),function(t){this.error&&this.error(t)}.bind(this)):this.childrenElements(e)}},x3dElement:function(t){try{var e=t.getAttribute("profile"),n=this.getBrowser().getProfile(e||"Full");this.getScene().setProfile(n)}catch(t){console.log(t)}var i=t.getAttribute("version");i&&this.getScene().setSpecificationVersion(i);for(var r=t.childNodes,o=0;o<r.length;++o)this.x3dElementChildHead(r[o]);if(this.success)require(this.getProviderUrls(),function(){try{for(var t=0;t<r.length;++t)this.x3dElementChildScene(r[t]);this.success(this)}catch(t){this.error&&this.error(t)}}.bind(this),function(t){this.error&&this.error(t)}.bind(this));else for(var o=0;o<r.length;++o)this.x3dElementChildScene(r[o])},x3dElementChildHead:function(t){switch(t.nodeName){case"head":case"HEAD":return void this.headElement(t)}},x3dElementChildScene:function(t){switch(t.nodeName){case"Scene":case"SCENE":return void this.sceneElement(t)}},headElement:function(t){for(var e=t.childNodes,n=0;n<e.length;++n)this.headElementChild(e[n]);try{this.setUnits(this.getScene().getMetaData("generator")),this.parser.setUnits(this.getUnits())}catch(t){}},headElementChild:function(t){switch(t.nodeName){case"component":case"COMPONENT":return void this.componentElement(t);case"unit":case"UNIT":return void this.unitElement(t);case"meta":case"META":return void this.metaElement(t)}},componentElement:function(t){try{var e=t.getAttribute("name"),n=parseInt(t.getAttribute("level"));if(null===e)return console.warn("XML Parser Error: Bad component statement: Expected name attribute.");if(null===n)return console.warn("XML Parser Error: Bad component statement: Expected level attribute.");var i=this.getBrowser().getComponent(e,n);this.getScene().addComponent(i)}catch(t){console.log(t.message)}},unitElement:function(t){var e=t.getAttribute("category"),n=t.getAttribute("name"),i=t.getAttribute("conversionFactor");return null===e?console.warn("XML Parser Error: Bad unit statement: Expected category attribute."):null===n?console.warn("XML Parser Error: Bad unit statement: Expected name attribute."):null===i?console.warn("XML Parser Error: Bad unit statement: Expected conversionFactor attribute."):void this.getScene().updateUnit(e,n,parseFloat(i))},metaElement:function(t){var e=t.getAttribute("name"),n=t.getAttribute("content");return null===e?console.warn("XML Parser Error: Bad meta statement: Expected name attribute."):null===n?console.warn("XML Parser Error: Bad meta statement: Expected content attribute."):void this.getScene().setMetaData(e,n)},sceneElement:function(t){this.childrenElements(t)},childrenElements:function(t){for(var e=t.childNodes,n=0;n<e.length;++n)this.childElement(e[n])},childElement:function(t){switch(t.nodeName){case"#comment":case"#text":return;case"#cdata-section":return void this.cdataNode(t);case"ExternProtoDeclare":case"EXTERNPROTODECLARE":return void this.externProtoDeclareElement(t);case"ProtoDeclare":case"PROTODECLARE":return void this.protoDeclareElement(t);case"IS":return void this.isElement(t);case"ProtoInstance":case"PROTOINSTANCE":return void this.protoInstanceElement(t);case"fieldValue":case"FIELDVALUE":return void this.fieldValueElement(t);case"field":case"FIELD":return void this.fieldElement(t);case"ROUTE":return void this.routeElement(t);case"IMPORT":return void this.importElement(t);case"EXPORT":return void this.exportElement(t);default:return void this.nodeElement(t)}},externProtoDeclareElement:function(t){var e=t.getAttribute("name");if(this.id(e)){var n=t.getAttribute("url");if(null===n)return console.warn("XML Parser Error: Bad ExternProtoDeclare statement: Expected url attribute.");this.parser.setInput(n),o.prototype.sfstringValues.call(this.parser,this.url);var i=new u(this.getExecutionContext());this.pushParent(i),this.protoInterfaceElement(t),this.popParent(),i.setName(e),i.url_=this.url,i.setup(),this.getExecutionContext().externprotos.add(e,i)}},protoDeclareElement:function(t){var e=t.getAttribute("name");if(this.id(e)){for(var n=new l(this.getExecutionContext()),i=t.childNodes,r=0;r<i.length;++r){var o=i[r];switch(o.nodeName){case"ProtoInterface":case"PROTOINTERFACE":this.pushParent(n),this.protoInterfaceElement(o),this.popParent();break;default:continue}break}for(var r=0;r<i.length;++r){var o=i[r];switch(o.nodeName){case"ProtoBody":case"PROTOBODY":this.pushExecutionContext(n),this.pushParent(n),this.protoBodyElement(o),this.popParent(),this.popExecutionContext();break;default:continue}break}n.setName(e),n.setup(),this.getExecutionContext().protos.add(e,n)}},protoInterfaceElement:function(t){for(var e=t.childNodes,n=0;n<e.length;++n)this.protoInterfaceElementChild(e[n])},protoInterfaceElementChild:function(t){switch(t.nodeName){case"field":case"FIELD":return void this.fieldElement(t)}},fieldElement:function(t){try{if(0===this.getParents().length)return;var e=this.getParent();if(!(e instanceof n))return;if(!e.hasUserDefinedFields())return;var i=m[t.getAttribute("accessType")];void 0===i&&(i=c.initializeOnly);var o=r[t.getAttribute("type")];if(void 0===o)return;var s=t.getAttribute("name");if(!this.id(s))return;var a=new o;i&c.initializeOnly&&(this.fieldValue(a,t.getAttribute("value")),this.pushParent(a),this.childrenElements(t),this.popParent()),e.addUserDefinedField(i,s,a)}catch(t){}},protoBodyElement:function(t){this.childrenElements(t)},isElement:function(t){if(this.getExecutionContext()instanceof l)for(var e=t.childNodes,n=0;n<e.length;++n)this.isElementChild(e[n])},isElementChild:function(t){switch(t.nodeName){case"connect":case"CONNECT":return void this.connectElement(t)}},connectElement:function(t){var e=t.getAttribute("nodeField"),i=t.getAttribute("protoField");if(null===e)return console.warn("XML Parser Error: Bad connect statement: Expected nodeField attribute.");if(null===i)return console.warn("XML Parser Error: Bad connect statement: Expected protoField attribute.");try{if(0===this.getParents().length)return;var r=this.getParent(),o=this.getExecutionContext();if(!(r instanceof n))return;var s=r.getField(e),a=o.getField(i);if(s.getType()!==a.getType())throw new Error("Field '"+s.getName()+"' and '"+a.getName()+"' in PROTO "+this.getExecutionContext().getName()+" have different types.");if(!a.isReference(s.getAccessType()))throw new Error("Field '"+s.getName()+"' and '"+a.getName()+"' in PROTO "+this.getExecutionContext().getName()+" are incompatible as an IS mapping.");s.addReference(a)}catch(t){console.warn("XML Parser Error: Couldn't create IS reference: "+t.message)}},protoInstanceElement:function(t){try{if(this.useAttribute(t))return;var e=t.getAttribute("name");if(this.id(e)){var n=this.getExecutionContext().createProto(e,!1);if(!n)throw new Error("Unkown proto or externproto type '"+e+"'.");t.x3d=n,this.defAttribute(t,n),this.addNode(t,n),this.pushParent(n),this.childrenElements(t),this.getExecutionContext().addUninitializedNode(n),this.popParent()}}catch(t){console.warn("XML Parser Error: ",t.message)}},fieldValueElement:function(t){try{if(0===this.getParents().length)return;var e=this.getParent(),n=t.getAttribute("name");if(!(e instanceof i))return;if(!this.id(n))return;var r=e.getField(n);r.getAccessType()&c.initializeOnly&&(this.fieldValue(r,t.getAttribute("value")),this.pushParent(r),this.childrenElements(t),this.popParent())}catch(t){console.warn("XML Parser Error: Couldn't assign field value: "+t.message)}},nodeElement:function(t){try{if(this.useAttribute(t))return;var e=this.getExecutionContext().createNode(t.nodeName,!1);if(!e)throw new Error("Unkown node type '"+t.nodeName+"'.");t.x3d=e,this.defAttribute(t,e),this.addNode(t,e),this.pushParent(e),this.nodeAttributes(t,e),this.childrenElements(t),this.getExecutionContext().addUninitializedNode(e),this.popParent()}catch(t){console.error("XML Parser Error: "+t.message)}},routeElement:function(t){try{var e=t.getAttribute("fromNode"),n=t.getAttribute("fromField"),i=t.getAttribute("toNode"),r=t.getAttribute("toField");if(null===e)throw new Error("Bad ROUTE statement: Expected fromNode attribute.");if(null===n)throw new Error("Bad ROUTE statement: Expected fromField attribute.");if(null===i)throw new Error("Bad ROUTE statement: Expected toNode attribute.");if(null===r)throw new Error("Bad ROUTE statement: Expected toField attribute.");var o=this.getExecutionContext(),s=o.getLocalNode(e),a=o.getLocalNode(i),u=o.addRoute(s,n,a,r);t.x3d=u}catch(t){console.log(t),console.warn("XML Parser Error: "+t.message)}},importElement:function(t){try{var e=t.getAttribute("inlineDEF"),n=t.getAttribute("importedDEF")||t.getAttribute("exportedDEF"),i=t.getAttribute("AS");if(null===e)throw new Error("Bad IMPORT statement: Expected inlineDEF attribute.");if(null===n)throw new Error("Bad IMPORT statement: Expected importedDEF attribute.");i||(i=n);var r=this.getExecutionContext().getNamedNode(e);this.getExecutionContext().updateImportedNode(r,n,i)}catch(t){console.warn("XML Parser Error: "+t.message)}},exportElement:function(t){try{if(this.getScene()!==this.getExecutionContext())return;var e=t.getAttribute("localDEF"),n=t.getAttribute("AS");if(null===e)throw new Error("Bad EXPORT statement: Expected localDEF attribute.");n||(n=e);var i=this.getExecutionContext().getLocalNode(e);this.getScene().updateExportedNode(n,i)}catch(t){console.warn("XML Parser Error: "+t.message)}},cdataNode:function(t){if(0!==this.getParents().length){var e=this.getParent();if(e instanceof n){var i=e.getSourceText();i&&(i.push(t.data),i.setSet(!0))}}},useAttribute:function(t){try{var e=t.getAttribute("USE");if(this.id(e)){var n=this.getExecutionContext().getNamedNode(e);return this.addNode(t,n.getValue()),!0}}catch(t){console.warn("Invalid USE name: "+t.message)}return!1},defAttribute:function(t,e){try{var n=t.getAttribute("DEF");if(n){try{var i=this.getExecutionContext().getNamedNode(n);this.getExecutionContext().updateNamedNode(this.getExecutionContext().getUniqueName(n),i)}catch(t){}this.getExecutionContext().updateNamedNode(n,e)}}catch(t){console.warn("Invalid DEF name: "+t.message)}},nodeAttributes:function(t,e){for(var n=t.attributes,i=0;i<n.length;++i)this.nodeAttribute(n[i],e)},nodeAttribute:function(t,e){try{var n=e.getField(this.attributeToCamelCase(t.name));n.getAccessType()&c.initializeOnly&&this.fieldValue(n,t.value)}catch(t){}},fieldValue:function(t,e){null!==e&&(t.setSet(!0),this.parser.pushExecutionContext(this.getExecutionContext()),this.parser.setInput(e),this.fieldTypes[t.getType()].call(this.parser,t),this.parser.popExecutionContext())},addNode:function(t,n){if(0===this.parents.length||this.getParent()instanceof l)return void this.getExecutionContext().rootNodes.push(n);var i=this.getParent();if(i instanceof e)switch(i.getType()){case c.SFNode:return i.setValue(n),void i.setSet(!0);case c.MFNode:return i.push(n),void i.setSet(!0)}else try{var r=t.getAttribute("containerField");r||(r=n.getContainerField());var o=i.getField(r);switch(o.getType()){case c.SFNode:return o.setValue(n),void o.setSet(!0);case c.MFNode:return o.push(n),void o.setSet(!0)}}catch(t){}},getParents:function(){return this.parents},getParent:function(){return this.parents[this.parents.length-1]},pushParent:function(t){return this.parents.push(t)},popParent:function(){this.parents.pop()},id:function(t){return null!==t&&0!==t.length},attributeToCamelCase:function(t){return t!==t.toLowerCase()?t:a.attributeLowerCaseToCamelCase[t]}}),h.prototype.fieldTypes=[],h.prototype.fieldTypes[c.SFBool]=o.prototype.sfboolValue,h.prototype.fieldTypes[c.SFColor]=o.prototype.sfcolorValue,h.prototype.fieldTypes[c.SFColorRGBA]=o.prototype.sfcolorrgbaValue,h.prototype.fieldTypes[c.SFDouble]=o.prototype.sfdoubleValue,h.prototype.fieldTypes[c.SFFloat]=o.prototype.sffloatValue,h.prototype.fieldTypes[c.SFImage]=o.prototype.sfimageValue,h.prototype.fieldTypes[c.SFInt32]=o.prototype.sfint32Value,h.prototype.fieldTypes[c.SFMatrix3f]=o.prototype.sfmatrix3dValue,h.prototype.fieldTypes[c.SFMatrix3d]=o.prototype.sfmatrix3fValue,h.prototype.fieldTypes[c.SFMatrix4f]=o.prototype.sfmatrix4dValue,h.prototype.fieldTypes[c.SFMatrix4d]=o.prototype.sfmatrix4fValue,h.prototype.fieldTypes[c.SFNode]=function(t){t.set(null)},h.prototype.fieldTypes[c.SFRotation]=o.prototype.sfrotationValue,h.prototype.fieldTypes[c.SFString]=function(t){t.set(this.input)},h.prototype.fieldTypes[c.SFTime]=o.prototype.sftimeValue,h.prototype.fieldTypes[c.SFVec2d]=o.prototype.sfvec2dValue,h.prototype.fieldTypes[c.SFVec2f]=o.prototype.sfvec2fValue,h.prototype.fieldTypes[c.SFVec3d]=o.prototype.sfvec3dValue,h.prototype.fieldTypes[c.SFVec3f]=o.prototype.sfvec3fValue,h.prototype.fieldTypes[c.SFVec4d]=o.prototype.sfvec4dValue,h.prototype.fieldTypes[c.SFVec4f]=o.prototype.sfvec4fValue,h.prototype.fieldTypes[c.MFBool]=o.prototype.sfboolValues,h.prototype.fieldTypes[c.MFColor]=o.prototype.sfcolorValues,h.prototype.fieldTypes[c.MFColorRGBA]=o.prototype.sfcolorrgbaValues,h.prototype.fieldTypes[c.MFDouble]=o.prototype.sfdoubleValues,h.prototype.fieldTypes[c.MFFloat]=o.prototype.sffloatValues,h.prototype.fieldTypes[c.MFImage]=o.prototype.sfimageValues,h.prototype.fieldTypes[c.MFInt32]=o.prototype.sfint32Values,h.prototype.fieldTypes[c.MFMatrix3d]=o.prototype.sfmatrix3dValues,h.prototype.fieldTypes[c.MFMatrix3f]=o.prototype.sfmatrix3fValues,h.prototype.fieldTypes[c.MFMatrix4d]=o.prototype.sfmatrix4dValues,h.prototype.fieldTypes[c.MFMatrix4f]=o.prototype.sfmatrix4fValues,h.prototype.fieldTypes[c.MFNode]=function(){},h.prototype.fieldTypes[c.MFRotation]=o.prototype.sfrotationValues,h.prototype.fieldTypes[c.MFString]=o.prototype.sfstringValues,h.prototype.fieldTypes[c.MFTime]=o.prototype.sftimeValues,h.prototype.fieldTypes[c.MFVec2d]=o.prototype.sfvec2dValues,h.prototype.fieldTypes[c.MFVec2f]=o.prototype.sfvec2fValues,h.prototype.fieldTypes[c.MFVec3d]=o.prototype.sfvec3dValues,h.prototype.fieldTypes[c.MFVec3f]=o.prototype.sfvec3fValues,h.prototype.fieldTypes[c.MFVec4d]=o.prototype.sfvec4dValues,h.prototype.fieldTypes[c.MFVec4f]=o.prototype.sfvec4fValues
;var x=/\binf\b/g,v=/\bnan\b/g,_=/^[\x20\n,\t\r"]+|[\x20\n,\t\r"]+$/g,y=/[\x20\n,\t\r"]+/,w=new RegExp('"((?:[^\\\\"]|\\\\\\\\|\\\\\\")*)"',"g");return h.prototype.fieldTypes[c.MFColor]=h.prototype.fieldTypes[c.MFColorRGBA]=h.prototype.fieldTypes[c.MFMatrix3d]=h.prototype.fieldTypes[c.MFMatrix3f]=h.prototype.fieldTypes[c.MFMatrix4d]=h.prototype.fieldTypes[c.MFMatrix4f]=h.prototype.fieldTypes[c.MFVec4d]=h.prototype.fieldTypes[c.MFVec4f]=function(t){t.setValue(p(this.getInput()).map(function(t){return parseFloat(t)}))},h.prototype.fieldTypes[c.MFBool]=function(t){t.setValue(d(this.getInput()).map(function(t){return"true"===t||"TRUE"===t}))},h.prototype.fieldTypes[c.MFInt32]=function(t){t.setValue(f(this.getInput()).map(function(t){return parseInt(t)}))},h.prototype.fieldTypes[c.MFDouble]=h.prototype.fieldTypes[c.MFFloat]=h.prototype.fieldTypes[c.MFVec2d]=h.prototype.fieldTypes[c.MFVec2f]=h.prototype.fieldTypes[c.MFVec3d]=h.prototype.fieldTypes[c.MFVec3f]=function(t){var e=t.getUnit();t.setValue(p(this.getInput()).map(function(t){return this.fromUnit(e,parseFloat(t))},this))},h.prototype.fieldTypes[c.MFString]=function(t){t.setValue(g(this.getInput()))},h}),define("x_ite/Parser/JSONParser",["x_ite/Fields","x_ite/Parser/Parser","x_ite/Parser/XMLParser"],function(t,e,n){"use strict";function i(n){this.scene=n,this.executionContexts=[n],this.protoDeclarations=[],this.parents=[],this.parser=new e(this.scene),this.url=new t.MFString,this.x3djsonNS="http://www.web3d.org/specifications/x3d-namespace"}return i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.parseJavaScript=function(t,e,n){var i=this.CreateElement("X3D");return this.ConvertToX3DOM(t,"",i),this.parseIntoScene(i,e,n),i},i.prototype.elementSetAttribute=function(t,e,n){"SON schema"===e||"ncoding"===e||"function"==typeof t.setAttribute&&t.setAttribute(e,n)},i.prototype.ConvertChildren=function(t,e,n){var i;for(i in e)"object"==typeof e[i]&&(isNaN(parseInt(i))?this.ConvertObject(i,e,n,t.substr(1)):this.ConvertToX3DOM(e[i],i,n,t.substr(1)))},i.prototype.CreateElement=function(t,e){var n=null;return void 0===this.x3djsonNS?n=document.createElement(t):null!==(n=document.createElementNS(this.x3djsonNS,t))&&void 0!==n||(console.error("Trouble creating element for",t),n=document.createElement(t)),void 0!==e&&this.elementSetAttribute(n,"containerField",e),n},i.prototype.CDATACreateFunction=function(t,e,n){var i=n.trim().replace(/\\"/g,'\\"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&");do n=i,i=n.replace(/'([^'\r\n]*)\n([^']*)'/g,"'$1\\n$2'"),n!==i&&console.log("CDATA Replacing",n,"with",i);while(i!=n)var r=new DOMParser,o="<script> <![CDATA[ "+i+" ]]> </script>",s=r.parseFromString(o,"application/xml"),a=s.children[0].childNodes[1];e.appendChild(a)},i.prototype.ConvertObject=function(t,e,n,i){var r;if(null!==e&&"object"==typeof e[t])if("@"===t.substr(0,1))this.ConvertToX3DOM(e[t],t,n);else if("-"===t.substr(0,1))this.ConvertChildren(t,e[t],n);else if("#comment"===t)for(var o in e[t])r=document.createComment(this.CommentStringToXML(e[t][o])),n.appendChild(r);else if("#sourceText"===t)this.CDATACreateFunction(document,n,e[t].join("\r\n")+"\r\n");else if("connect"===t||"fieldValue"===t||"field"===t||"meta"===t||"component"===t)for(var s in e[t])"object"==typeof e[t][s]&&(r=this.CreateElement(t,i),this.ConvertToX3DOM(e[t][s],s,r),n.appendChild(r),n.appendChild(document.createTextNode("\n")));else r=this.CreateElement(t,i),this.ConvertToX3DOM(e[t],t,r),n.appendChild(r),n.appendChild(document.createTextNode("\n"))},i.prototype.CommentStringToXML=function(t){var e=t;return t=t.replace(/\\\\/g,"\\"),e!==t&&console.log("X3DJSONLD <!-> replacing",e,"with",t),t},i.prototype.SFStringToXML=function(t){var e=t;return t=t.replace(/\\/g,"\\\\"),t=t.replace(/"/g,'\\"'),e!==t&&console.log("X3DJSONLD [] replacing",e,"with",t),t},i.prototype.JSONStringToXML=function(t){var e=t;return t=t.replace(/\\/g,"\\\\"),t=t.replace(/\n/g,"\\n"),e!==t&&console.log("X3DJSONLD replacing",e,"with",t),t},i.prototype.ConvertToX3DOM=function(t,e,n,i){var r,o=[],s=!1,a=!1;for(r in t)if(s=!isNaN(parseInt(r)))"number"==typeof t[r]?o.push(t[r]):"string"==typeof t[r]?(o.push(t[r]),a=!0):"boolean"==typeof t[r]?o.push(t[r]):"object"==typeof t[r]?this.ConvertToX3DOM(t[r],r,n):void 0===t[r]||console.error("Unknown type found in array "+typeof t[r]);else if("object"==typeof t[r])"X3D"===r?this.ConvertToX3DOM(t[r],r,n):this.ConvertObject(r,t,n,i);else if("number"==typeof t[r])this.elementSetAttribute(n,r.substr(1),t[r]);else if("string"==typeof t[r])if("#comment"!==r)this.elementSetAttribute(n,r.substr(1),this.JSONStringToXML(t[r]));else{var u=document.createComment(this.CommentStringToXML(t[r]));n.appendChild(u)}else"boolean"==typeof t[r]?this.elementSetAttribute(n,r.substr(1),t[r]):void 0===t[r]||(console.error("Unknown type found in object "+typeof t[r]),console.error(t));if(s){if("@"===e.substr(0,1))if(a){a=!1;for(var l in o)o[l]=this.SFStringToXML(o[l]);this.elementSetAttribute(n,e.substr(1),'"'+o.join('" "')+'"')}else this.elementSetAttribute(n,e.substr(1),o.join(" "));s=!1}return n},i}),define("standard/Networking/BinaryTransport",[],function(){"use strict";return function(t){t.ajaxTransport("+binary",function(t,e,n){if(t.dataType&&"binary"==t.dataType)return{send:function(e,n){var i=t.xhr();if(i.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(var r in t.xhrFields)i[r]=t.xhrFields[r];t.mimeType&&i.overrideMimeType&&i.overrideMimeType(t.mimeType);for(var r in e)i.setRequestHeader(r,e[r]);i.onload=function(){i.onload=i.onerror=null;var e={};e[t.dataType]=i.response,n(i.status,i.statusText,e,i.getAllResponseHeaders())},i.onerror=function(){i.onload=i.onerror=null,n(i.status||404,i.statusText)},i.responseType=t.responseType||"blob",i.send(t.hasContent&&t.data||null)},abort:function(){var e=t.xhr();e.onload=e.onerror=null,e.abort()}}})}}),function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define("pako_inflate/dist/pako_inflate",[],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.pako=t()}}(function(){return function(){function t(e,n,i){function r(s,a){if(!n[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[s]={exports:{}};e[s][0].call(c.exports,function(t){return r(e[s][1][t]||t)},c,c.exports,t,e,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}return t}()({1:[function(t,e,n){"use strict";function i(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var n=e.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)i(n,r)&&(t[r]=n[r])}}return t},n.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var o={arraySet:function(t,e,n,i,r){if(e.subarray&&t.subarray)return void t.set(e.subarray(n,n+i),r);for(var o=0;o<i;o++)t[r+o]=e[n+o]},flattenChunks:function(t){var e,n,i,r,o,s;for(i=0,e=0,n=t.length;e<n;e++)i+=t[e].length;for(s=new Uint8Array(i),r=0,e=0,n=t.length;e<n;e++)o=t[e],s.set(o,r),r+=o.length;return s}},s={arraySet:function(t,e,n,i,r){for(var o=0;o<i;o++)t[r+o]=e[n+o]},flattenChunks:function(t){return[].concat.apply([],t)}};n.setTyped=function(t){t?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,o)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,s))},n.setTyped(r)},{}],2:[function(t,e,n){function i(t,e){if(e<65534&&(t.subarray&&s||!t.subarray&&o))return String.fromCharCode.apply(null,r.shrinkBuf(t,e));for(var n="",i=0;i<e;i++)n+=String.fromCharCode(t[i]);return n}var r=t("./common"),o=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(t){o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){s=!1}for(var a=new r.Buf8(256),u=0;u<256;u++)a[u]=u>=252?6:u>=248?5:u>=240?4:u>=224?3:u>=192?2:1;a[254]=a[254]=1,n.string2buf=function(t){var e,n,i,o,s,a=t.length,u=0;for(o=0;o<a;o++)n=t.charCodeAt(o),55296==(64512&n)&&o+1<a&&56320==(64512&(i=t.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),u+=n<128?1:n<2048?2:n<65536?3:4;for(e=new r.Buf8(u),s=0,o=0;s<u;o++)n=t.charCodeAt(o),55296==(64512&n)&&o+1<a&&56320==(64512&(i=t.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),n<128?e[s++]=n:n<2048?(e[s++]=192|n>>>6,e[s++]=128|63&n):n<65536?(e[s++]=224|n>>>12,e[s++]=128|n>>>6&63,e[s++]=128|63&n):(e[s++]=240|n>>>18,e[s++]=128|n>>>12&63,e[s++]=128|n>>>6&63,e[s++]=128|63&n);return e},n.buf2binstring=function(t){return i(t,t.length)},n.binstring2buf=function(t){for(var e=new r.Buf8(t.length),n=0,i=e.length;n<i;n++)e[n]=t.charCodeAt(n);return e},n.buf2string=function(t,e){var n,r,o,s,u=e||t.length,l=new Array(2*u);for(r=0,n=0;n<u;)if((o=t[n++])<128)l[r++]=o;else if((s=a[o])>4)l[r++]=65533,n+=s-1;else{for(o&=2===s?31:3===s?15:7;s>1&&n<u;)o=o<<6|63&t[n++],s--;s>1?l[r++]=65533:o<65536?l[r++]=o:(o-=65536,l[r++]=55296|o>>10&1023,l[r++]=56320|1023&o)}return i(l,r)},n.utf8border=function(t,e){var n;for(e=e||t.length,e>t.length&&(e=t.length),n=e-1;n>=0&&128==(192&t[n]);)n--;return n<0?e:0===n?e:n+a[t[n]]>e?n:e}},{"./common":1}],3:[function(t,e,n){"use strict";function i(t,e,n,i){for(var r=65535&t|0,o=t>>>16&65535|0,s=0;0!==n;){s=n>2e3?2e3:n,n-=s;do r=r+e[i++]|0,o=o+r|0;while(--s)r%=65521,o%=65521}return r|o<<16|0}e.exports=i},{}],4:[function(t,e,n){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],5:[function(t,e,n){"use strict";function i(t,e,n,i){var o=r,s=i+n;t^=-1;for(var a=i;a<s;a++)t=t>>>8^o[255&(t^e[a])];return t^-1}var r=function(){for(var t,e=[],n=0;n<256;n++){t=n;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e}();e.exports=i},{}],6:[function(t,e,n){"use strict";function i(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}e.exports=i},{}],7:[function(t,e,n){"use strict";e.exports=function(t,e){var n,i,r,o,s,a,u,l,c,h,d,p,f,g,m,x,v,_,y,w,b,S,C,T,F;n=t.state,i=t.next_in,T=t.input,r=i+(t.avail_in-5),o=t.next_out,F=t.output,s=o-(e-t.avail_out),a=o+(t.avail_out-257),u=n.dmax,l=n.wsize,c=n.whave,h=n.wnext,d=n.window,p=n.hold,f=n.bits,g=n.lencode,m=n.distcode,x=(1<<n.lenbits)-1,v=(1<<n.distbits)-1;t:do{f<15&&(p+=T[i++]<<f,f+=8,p+=T[i++]<<f,f+=8),_=g[p&x];e:for(;;){if(y=_>>>24,p>>>=y,f-=y,0===(y=_>>>16&255))F[o++]=65535&_;else{if(!(16&y)){if(0==(64&y)){_=g[(65535&_)+(p&(1<<y)-1)];continue e}if(32&y){n.mode=12;break t}t.msg="invalid literal/length code",n.mode=30;break t}w=65535&_,y&=15,y&&(f<y&&(p+=T[i++]<<f,f+=8),w+=p&(1<<y)-1,p>>>=y,f-=y),f<15&&(p+=T[i++]<<f,f+=8,p+=T[i++]<<f,f+=8),_=m[p&v];n:for(;;){if(y=_>>>24,p>>>=y,f-=y,!(16&(y=_>>>16&255))){if(0==(64&y)){_=m[(65535&_)+(p&(1<<y)-1)];continue n}t.msg="invalid distance code",n.mode=30;break t}if(b=65535&_,y&=15,f<y&&(p+=T[i++]<<f,(f+=8)<y&&(p+=T[i++]<<f,f+=8)),(b+=p&(1<<y)-1)>u){t.msg="invalid distance too far back",n.mode=30;break t}if(p>>>=y,f-=y,y=o-s,b>y){if((y=b-y)>c&&n.sane){t.msg="invalid distance too far back",n.mode=30;break t}if(S=0,C=d,0===h){if(S+=l-y,y<w){w-=y;do F[o++]=d[S++];while(--y)S=o-b,C=F}}else if(h<y){if(S+=l+h-y,(y-=h)<w){w-=y;do F[o++]=d[S++];while(--y)if(S=0,h<w){y=h,w-=y;do F[o++]=d[S++];while(--y)S=o-b,C=F}}}else if(S+=h-y,y<w){w-=y;do F[o++]=d[S++];while(--y)S=o-b,C=F}for(;w>2;)F[o++]=C[S++],F[o++]=C[S++],F[o++]=C[S++],w-=3;w&&(F[o++]=C[S++],w>1&&(F[o++]=C[S++]))}else{S=o-b;do F[o++]=F[S++],F[o++]=F[S++],F[o++]=F[S++],w-=3;while(w>2)w&&(F[o++]=F[S++],w>1&&(F[o++]=F[S++]))}break}}break}}while(i<r&&o<a)w=f>>3,i-=w,f-=w<<3,p&=(1<<f)-1,t.next_in=i,t.next_out=o,t.avail_in=i<r?r-i+5:5-(i-r),t.avail_out=o<a?a-o+257:257-(o-a),n.hold=p,n.bits=f}},{}],8:[function(t,e,n){"use strict";function i(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function r(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new v.Buf16(320),this.work=new v.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function o(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=P,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new v.Buf32(gt),e.distcode=e.distdyn=new v.Buf32(mt),e.sane=1,e.back=-1,E):V}function s(t){var e;return t&&t.state?(e=t.state,e.wsize=0,e.whave=0,e.wnext=0,o(t)):V}function a(t,e){var n,i;return t&&t.state?(i=t.state,e<0?(n=0,e=-e):(n=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?V:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=n,i.wbits=e,s(t))):V}function u(t,e){var n,i;return t?(i=new r,t.state=i,i.window=null,n=a(t,e),n!==E&&(t.state=null),n):V}function l(t){return u(t,xt)}function c(t){if(vt){var e;for(m=new v.Buf32(512),x=new v.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(b(C,t.lens,0,288,m,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;b(T,t.lens,0,32,x,0,t.work,{bits:5}),vt=!1}t.lencode=m,t.lenbits=9,t.distcode=x,t.distbits=5}function h(t,e,n,i){var r,o=t.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new v.Buf8(o.wsize)),i>=o.wsize?(v.arraySet(o.window,e,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(r=o.wsize-o.wnext,r>i&&(r=i),v.arraySet(o.window,e,n-i,r,o.wnext),i-=r,i?(v.arraySet(o.window,e,n-i,i,0),o.wnext=i,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0}function d(t,e){var n,r,o,s,a,u,l,d,p,f,g,m,x,gt,mt,xt,vt,_t,yt,wt,bt,St,Ct,Tt,Ft=0,Ot=new v.Buf8(4),Nt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return V;n=t.state,n.mode===Y&&(n.mode=$),a=t.next_out,o=t.output,l=t.avail_out,s=t.next_in,r=t.input,u=t.avail_in,d=n.hold,p=n.bits,f=u,g=l,St=E;t:for(;;)switch(n.mode){case P:if(0===n.wrap){n.mode=$;break}for(;p<16;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}if(2&n.wrap&&35615===d){n.check=0,Ot[0]=255&d,Ot[1]=d>>>8&255,n.check=y(n.check,Ot,2,0),d=0,p=0,n.mode=R;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&d)<<8)+(d>>8))%31){t.msg="incorrect header check",n.mode=dt;break}if((15&d)!==A){t.msg="unknown compression method",n.mode=dt;break}if(d>>>=4,p-=4,bt=8+(15&d),0===n.wbits)n.wbits=bt;else if(bt>n.wbits){t.msg="invalid window size",n.mode=dt;break}n.dmax=1<<bt,t.adler=n.check=1,n.mode=512&d?q:Y,d=0,p=0;break;case R:for(;p<16;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}if(n.flags=d,(255&n.flags)!==A){t.msg="unknown compression method",n.mode=dt;break}if(57344&n.flags){t.msg="unknown header flags set",n.mode=dt;break}n.head&&(n.head.text=d>>8&1),512&n.flags&&(Ot[0]=255&d,Ot[1]=d>>>8&255,n.check=y(n.check,Ot,2,0)),d=0,p=0,n.mode=k;case k:for(;p<32;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}n.head&&(n.head.time=d),512&n.flags&&(Ot[0]=255&d,Ot[1]=d>>>8&255,Ot[2]=d>>>16&255,Ot[3]=d>>>24&255,n.check=y(n.check,Ot,4,0)),d=0,p=0,n.mode=U;case U:for(;p<16;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}n.head&&(n.head.xflags=255&d,n.head.os=d>>8),512&n.flags&&(Ot[0]=255&d,Ot[1]=d>>>8&255,n.check=y(n.check,Ot,2,0)),d=0,p=0,n.mode=z;case z:if(1024&n.flags){for(;p<16;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}n.length=d,n.head&&(n.head.extra_len=d),512&n.flags&&(Ot[0]=255&d,Ot[1]=d>>>8&255,n.check=y(n.check,Ot,2,0)),d=0,p=0}else n.head&&(n.head.extra=null);n.mode=X;case X:if(1024&n.flags&&(m=n.length,m>u&&(m=u),m&&(n.head&&(bt=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),v.arraySet(n.head.extra,r,s,m,bt)),512&n.flags&&(n.check=y(n.check,r,m,s)),u-=m,s+=m,n.length-=m),n.length))break t;n.length=0,n.mode=j;case j:if(2048&n.flags){if(0===u)break t;m=0;do bt=r[s+m++],n.head&&bt&&n.length<65536&&(n.head.name+=String.fromCharCode(bt));while(bt&&m<u)if(512&n.flags&&(n.check=y(n.check,r,m,s)),u-=m,s+=m,bt)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=G;case G:if(4096&n.flags){if(0===u)break t;m=0;do bt=r[s+m++],n.head&&bt&&n.length<65536&&(n.head.comment+=String.fromCharCode(bt));while(bt&&m<u)if(512&n.flags&&(n.check=y(n.check,r,m,s)),u-=m,s+=m,bt)break t}else n.head&&(n.head.comment=null);n.mode=H;case H:if(512&n.flags){for(;p<16;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}if(d!==(65535&n.check)){t.msg="header crc mismatch",n.mode=dt;break}d=0,p=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=Y;break;case q:for(;p<32;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}t.adler=n.check=i(d),d=0,p=0,n.mode=W;case W:if(0===n.havedict)return t.next_out=a,t.avail_out=l,t.next_in=s,t.avail_in=u,n.hold=d,n.bits=p,D;t.adler=n.check=1,n.mode=Y;case Y:if(e===O||e===N)break t;case $:if(n.last){d>>>=7&p,p-=7&p,n.mode=lt;break}for(;p<3;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}switch(n.last=1&d,d>>>=1,p-=1,3&d){case 0:n.mode=Z;break;case 1:if(c(n),n.mode=nt,e===N){d>>>=2,p-=2;break t}break;case 2:n.mode=J;break;case 3:t.msg="invalid block type",n.mode=dt}d>>>=2,p-=2;break;case Z:for(d>>>=7&p,p-=7&p;p<32;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}if((65535&d)!=(d>>>16^65535)){t.msg="invalid stored block lengths",n.mode=dt;break}if(n.length=65535&d,d=0,p=0,n.mode=Q,e===N)break t;case Q:n.mode=K;case K:if(m=n.length){if(m>u&&(m=u),m>l&&(m=l),0===m)break t;v.arraySet(o,r,s,m,a),u-=m,s+=m,l-=m,a+=m,n.length-=m;break}n.mode=Y;break;case J:for(;p<14;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}if(n.nlen=257+(31&d),d>>>=5,p-=5,n.ndist=1+(31&d),d>>>=5,p-=5,n.ncode=4+(15&d),d>>>=4,p-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=dt;break}n.have=0,n.mode=tt;case tt:for(;n.have<n.ncode;){for(;p<3;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}n.lens[Nt[n.have++]]=7&d,d>>>=3,p-=3}for(;n.have<19;)n.lens[Nt[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,Ct={bits:n.lenbits},St=b(S,n.lens,0,19,n.lencode,0,n.work,Ct),n.lenbits=Ct.bits,St){t.msg="invalid code lengths set",n.mode=dt;break}n.have=0,n.mode=et;case et:for(;n.have<n.nlen+n.ndist;){for(;Ft=n.lencode[d&(1<<n.lenbits)-1],mt=Ft>>>24,xt=Ft>>>16&255,vt=65535&Ft,!(mt<=p);){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}if(vt<16)d>>>=mt,p-=mt,n.lens[n.have++]=vt;else{if(16===vt){for(Tt=mt+2;p<Tt;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}if(d>>>=mt,p-=mt,0===n.have){t.msg="invalid bit length repeat",n.mode=dt;break}bt=n.lens[n.have-1],m=3+(3&d),d>>>=2,p-=2}else if(17===vt){for(Tt=mt+3;p<Tt;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}d>>>=mt,p-=mt,bt=0,m=3+(7&d),d>>>=3,p-=3}else{for(Tt=mt+7;p<Tt;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}d>>>=mt,p-=mt,bt=0,m=11+(127&d),d>>>=7,p-=7}if(n.have+m>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=dt;break}for(;m--;)n.lens[n.have++]=bt}}if(n.mode===dt)break;if(0===n.lens[256]){t.msg="invalid code -- missing end-of-block",n.mode=dt;break}if(n.lenbits=9,Ct={bits:n.lenbits},St=b(C,n.lens,0,n.nlen,n.lencode,0,n.work,Ct),n.lenbits=Ct.bits,St){t.msg="invalid literal/lengths set",n.mode=dt;break}if(n.distbits=6,n.distcode=n.distdyn,Ct={bits:n.distbits},St=b(T,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,Ct),n.distbits=Ct.bits,St){t.msg="invalid distances set",n.mode=dt;break}if(n.mode=nt,e===N)break t;case nt:n.mode=it;case it:if(u>=6&&l>=258){t.next_out=a,t.avail_out=l,t.next_in=s,t.avail_in=u,n.hold=d,n.bits=p,w(t,g),a=t.next_out,o=t.output,l=t.avail_out,s=t.next_in,r=t.input,u=t.avail_in,d=n.hold,p=n.bits,n.mode===Y&&(n.back=-1);break}for(n.back=0;Ft=n.lencode[d&(1<<n.lenbits)-1],mt=Ft>>>24,xt=Ft>>>16&255,vt=65535&Ft,!(mt<=p);){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}if(xt&&0==(240&xt)){for(_t=mt,yt=xt,wt=vt;Ft=n.lencode[wt+((d&(1<<_t+yt)-1)>>_t)],mt=Ft>>>24,xt=Ft>>>16&255,vt=65535&Ft,!(_t+mt<=p);){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}d>>>=_t,p-=_t,n.back+=_t}if(d>>>=mt,p-=mt,n.back+=mt,n.length=vt,0===xt){n.mode=ut;break}if(32&xt){n.back=-1,n.mode=Y;break}if(64&xt){t.msg="invalid literal/length code",n.mode=dt;break}n.extra=15&xt,n.mode=rt;case rt:if(n.extra){for(Tt=n.extra;p<Tt;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}n.length+=d&(1<<n.extra)-1,d>>>=n.extra,p-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=ot;case ot:for(;Ft=n.distcode[d&(1<<n.distbits)-1],mt=Ft>>>24,xt=Ft>>>16&255,vt=65535&Ft,!(mt<=p);){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}if(0==(240&xt)){for(_t=mt,yt=xt,wt=vt;Ft=n.distcode[wt+((d&(1<<_t+yt)-1)>>_t)],mt=Ft>>>24,xt=Ft>>>16&255,vt=65535&Ft,!(_t+mt<=p);){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}d>>>=_t,p-=_t,n.back+=_t}if(d>>>=mt,p-=mt,n.back+=mt,64&xt){t.msg="invalid distance code",n.mode=dt;break}n.offset=vt,n.extra=15&xt,n.mode=st;case st:if(n.extra){for(Tt=n.extra;p<Tt;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}n.offset+=d&(1<<n.extra)-1,d>>>=n.extra,p-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=dt;break}n.mode=at;case at:if(0===l)break t;if(m=g-l,n.offset>m){if((m=n.offset-m)>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=dt;break}m>n.wnext?(m-=n.wnext,x=n.wsize-m):x=n.wnext-m,m>n.length&&(m=n.length),gt=n.window}else gt=o,x=a-n.offset,m=n.length;m>l&&(m=l),l-=m,n.length-=m;do o[a++]=gt[x++];while(--m)0===n.length&&(n.mode=it);break;case ut:if(0===l)break t;o[a++]=n.length,l--,n.mode=it;break;case lt:if(n.wrap){for(;p<32;){if(0===u)break t;u--,d|=r[s++]<<p,p+=8}if(g-=l,t.total_out+=g,n.total+=g,g&&(t.adler=n.check=n.flags?y(n.check,o,g,a-g):_(n.check,o,g,a-g)),g=l,(n.flags?d:i(d))!==n.check){t.msg="incorrect data check",n.mode=dt;break}d=0,p=0}n.mode=ct;case ct:if(n.wrap&&n.flags){for(;p<32;){if(0===u)break t;u--,d+=r[s++]<<p,p+=8}if(d!==(4294967295&n.total)){t.msg="incorrect length check",n.mode=dt;break}d=0,p=0}n.mode=ht;case ht:St=M;break t;case dt:St=I;break t;case pt:return B;case ft:default:return V}return t.next_out=a,t.avail_out=l,t.next_in=s,t.avail_in=u,n.hold=d,n.bits=p,(n.wsize||g!==t.avail_out&&n.mode<dt&&(n.mode<lt||e!==F))&&h(t,t.output,t.next_out,g-t.avail_out)?(n.mode=pt,B):(f-=t.avail_in,g-=t.avail_out,t.total_in+=f,t.total_out+=g,n.total+=g,n.wrap&&g&&(t.adler=n.check=n.flags?y(n.check,o,g,t.next_out-g):_(n.check,o,g,t.next_out-g)),t.data_type=n.bits+(n.last?64:0)+(n.mode===Y?128:0)+(n.mode===nt||n.mode===Q?256:0),(0===f&&0===g||e===F)&&St===E&&(St=L),St)}function p(t){if(!t||!t.state)return V;var e=t.state;return e.window&&(e.window=null),t.state=null,E}function f(t,e){var n;return t&&t.state?(n=t.state,0==(2&n.wrap)?V:(n.head=e,e.done=!1,E)):V}function g(t,e){var n,i,r=e.length;return t&&t.state?(n=t.state,0!==n.wrap&&n.mode!==W?V:n.mode===W&&(i=1,(i=_(i,e,r,0))!==n.check)?I:h(t,e,r,r)?(n.mode=pt,B):(n.havedict=1,E)):V}var m,x,v=t("../utils/common"),_=t("./adler32"),y=t("./crc32"),w=t("./inffast"),b=t("./inftrees"),S=0,C=1,T=2,F=4,O=5,N=6,E=0,M=1,D=2,V=-2,I=-3,B=-4,L=-5,A=8,P=1,R=2,k=3,U=4,z=5,X=6,j=7,G=8,H=9,q=10,W=11,Y=12,$=13,Z=14,Q=15,K=16,J=17,tt=18,et=19,nt=20,it=21,rt=22,ot=23,st=24,at=25,ut=26,lt=27,ct=28,ht=29,dt=30,pt=31,ft=32,gt=852,mt=592,xt=15,vt=!0;n.inflateReset=s,n.inflateReset2=a,n.inflateResetKeep=o,n.inflateInit=l,n.inflateInit2=u,n.inflate=d,n.inflateEnd=p,n.inflateGetHeader=f,n.inflateSetDictionary=g,n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":1,"./adler32":3,"./crc32":5,"./inffast":7,"./inftrees":9}],9:[function(t,e,n){"use strict";var i=t("../utils/common"),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(t,e,n,u,l,c,h,d){var p,f,g,m,x,v,_,y,w,b=d.bits,S=0,C=0,T=0,F=0,O=0,N=0,E=0,M=0,D=0,V=0,I=null,B=0,L=new i.Buf16(16),A=new i.Buf16(16),P=null,R=0;for(S=0;S<=15;S++)L[S]=0;for(C=0;C<u;C++)L[e[n+C]]++;for(O=b,F=15;F>=1&&0===L[F];F--);if(O>F&&(O=F),0===F)return l[c++]=20971520,l[c++]=20971520,d.bits=1,0;for(T=1;T<F&&0===L[T];T++);for(O<T&&(O=T),M=1,S=1;S<=15;S++)if(M<<=1,(M-=L[S])<0)return-1;if(M>0&&(0===t||1!==F))return-1;for(A[1]=0,S=1;S<15;S++)A[S+1]=A[S]+L[S];for(C=0;C<u;C++)0!==e[n+C]&&(h[A[e[n+C]]++]=C);if(0===t?(I=P=h,v=19):1===t?(I=r,B-=257,P=o,R-=257,v=256):(I=s,P=a,v=-1),V=0,C=0,S=T,x=c,N=O,E=0,g=-1,D=1<<O,m=D-1,1===t&&D>852||2===t&&D>592)return 1;for(;;){_=S-E,h[C]<v?(y=0,w=h[C]):h[C]>v?(y=P[R+h[C]],w=I[B+h[C]]):(y=96,w=0),p=1<<S-E,f=1<<N,T=f;do f-=p,l[x+(V>>E)+f]=_<<24|y<<16|w|0;while(0!==f)for(p=1<<S-1;V&p;)p>>=1;if(0!==p?(V&=p-1,V+=p):V=0,C++,0==--L[S]){if(S===F)break;S=e[n+h[C]]}if(S>O&&(V&m)!==g){for(0===E&&(E=O),x+=T,N=S-E,M=1<<N;N+E<F&&!((M-=L[N+E])<=0);)N++,M<<=1;if(D+=1<<N,1===t&&D>852||2===t&&D>592)return 1;g=V&m,l[g]=O<<24|N<<16|x-c|0}}return 0!==V&&(l[x+V]=S-E<<24|64<<16|0),d.bits=O,0}},{"../utils/common":1}],10:[function(t,e,n){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],11:[function(t,e,n){"use strict";function i(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}e.exports=i},{}],"/lib/inflate.js":[function(t,e,n){"use strict";function i(t){if(!(this instanceof i))return new i(t);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var n=s.inflateInit2(this.strm,e.windowBits);if(n!==l.Z_OK)throw new Error(c[n]);if(this.header=new d,s.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=u.string2buf(e.dictionary):"[object ArrayBuffer]"===p.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=s.inflateSetDictionary(this.strm,e.dictionary))!==l.Z_OK))throw new Error(c[n])}function r(t,e){var n=new i(e);if(n.push(t,!0),n.err)throw n.msg||c[n.err];return n.result}function o(t,e){return e=e||{},e.raw=!0,r(t,e)}var s=t("./zlib/inflate"),a=t("./utils/common"),u=t("./utils/strings"),l=t("./zlib/constants"),c=t("./zlib/messages"),h=t("./zlib/zstream"),d=t("./zlib/gzheader"),p=Object.prototype.toString;i.prototype.push=function(t,e){var n,i,r,o,c,h=this.strm,d=this.options.chunkSize,f=this.options.dictionary,g=!1;if(this.ended)return!1;i=e===~~e?e:e===!0?l.Z_FINISH:l.Z_NO_FLUSH,"string"==typeof t?h.input=u.binstring2buf(t):"[object ArrayBuffer]"===p.call(t)?h.input=new Uint8Array(t):h.input=t,h.next_in=0,h.avail_in=h.input.length;do{if(0===h.avail_out&&(h.output=new a.Buf8(d),h.next_out=0,h.avail_out=d),n=s.inflate(h,l.Z_NO_FLUSH),n===l.Z_NEED_DICT&&f&&(n=s.inflateSetDictionary(this.strm,f)),n===l.Z_BUF_ERROR&&g===!0&&(n=l.Z_OK,g=!1),n!==l.Z_STREAM_END&&n!==l.Z_OK)return this.onEnd(n),this.ended=!0,!1;h.next_out&&(0!==h.avail_out&&n!==l.Z_STREAM_END&&(0!==h.avail_in||i!==l.Z_FINISH&&i!==l.Z_SYNC_FLUSH)||("string"===this.options.to?(r=u.utf8border(h.output,h.next_out),o=h.next_out-r,c=u.buf2string(h.output,r),h.next_out=o,h.avail_out=d-o,o&&a.arraySet(h.output,h.output,r,o,0),this.onData(c)):this.onData(a.shrinkBuf(h.output,h.next_out)))),0===h.avail_in&&0===h.avail_out&&(g=!0)}while((h.avail_in>0||0===h.avail_out)&&n!==l.Z_STREAM_END)return n===l.Z_STREAM_END&&(i=l.Z_FINISH),i===l.Z_FINISH?(n=s.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===l.Z_OK):i!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),h.avail_out=0,!0)},i.prototype.onData=function(t){this.chunks.push(t)},i.prototype.onEnd=function(t){t===l.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},n.Inflate=i,n.inflate=r,n.inflateRaw=o,n.ungzip=r},{"./utils/common":1,"./utils/strings":2,"./zlib/constants":4,"./zlib/gzheader":6,"./zlib/inflate":8,"./zlib/messages":10,"./zlib/zstream":11}]},{},[])("/lib/inflate.js")}),define("pako_inflate",["pako_inflate/dist/pako_inflate"],function(t){return t}),define("x_ite/InputOutput/FileLoader",["jquery","x_ite/Base/X3DObject","x_ite/Fields","x_ite/Browser/Networking/urls","x_ite/Parser/Parser","x_ite/Parser/XMLParser","x_ite/Parser/JSONParser","standard/Networking/URI","standard/Networking/BinaryTransport","pako_inflate","x_ite/DEBUG"],function(t,e,n,i,r,o,s,a,u,l,c){"use strict";function h(t,n){e.call(this),this.node=t,this.browser=t.getBrowser(),this.external=void 0===n?this.browser.isExternal():n,this.executionContext=this.external?t.getExecutionContext():this.browser.currentScene,this.userAgent=this.browser.getName()+"/"+this.browser.getVersion()+" (X3D Browser; +"+this.browser.getProviderUrl()+")",this.url=[],this.URL=new a,this.fileReader=new FileReader}u(t);var d=/^\s*(?:vrmlscript|javascript|ecmascript)\:([^]*)$/,p=/^data:(.*?)(?:;charset=(.*?))?(?:;(base64))?,([^]*)$/,f=/^(?:(.*?);(.*?)$)/,g=new RegExp(".(?:html|xhtml)$"),m={"text/html":!0,"application/xhtml+xml":!0},x=new n.MFString;return h.prototype=Object.assign(Object.create(e.prototype),{constructor:h,abort:function(){this.callback=Function.prototype,this.bindViewpoint=Function.prototype,this.foreign=Function.prototype},getWorldURL:function(){return this.URL},createX3DFromString:function(e,n,i,o){var s=this.browser.createScene();if(s.setURL(this.browser.getLocation().transform(e)),i){for(var a=[function(e,n,i,r){setTimeout(this.importDocument.bind(this,e,t.parseXML(n),i,r),17)},function(t,e,n,i){setTimeout(this.importJS.bind(this,t,JSON.parse(e),n,i),17)},function(t,e,n,i){n&&(n=function(t,e,n){this.setScene(t,e,n)}.bind(this,t,n,i)),new r(t).parseIntoScene(e,n,i)}],u=[],l=0,c=a.length;l<c;++l)try{return void a[l].call(this,s,n,i,o)}catch(t){u.push(t)}throw console.error(u),new Error("Couldn't parse X3D. No suitable file handler found for '"+e+"'.")}for(var a=[function(e,n){this.importDocument(e,t.parseXML(n))},function(t,e){this.importJS(t,JSON.parse(e))},function(t,e){new r(t).parseIntoScene(e)}],u=[],l=0,c=a.length;l<c;++l)try{return a[l].call(this,s,n),s}catch(t){u.push(t)}throw console.error(u),new Error("Couldn't parse x3d syntax.")},importDocument:function(t,e,n,i){try{n&&(n=function(t,e,n){this.setScene(t,e,n)}.bind(this,t,n,i)),new o(t).parseIntoScene(e,n,i),this.node.dom=e}catch(t){if(!i)throw t;i(t)}},importJS:function(t,e,n,i){try{n&&(n=function(t,e,n){this.setScene(t,e,n)}.bind(this,t,n,i)),this.node.dom=new s(t).parseJavaScript(e,n,i)}catch(t){if(!i)throw t;i(t)}},setScene:function(t,e,n){t.initLoadCount_.addInterest("set_initLoadCount__",this,t,e,n),t.initLoadCount_.addEvent()},set_initLoadCount__:function(t,e,n,i){if(!t.getValue()){e.initLoadCount_.removeInterest("set_initLoadCount__",this);try{n(e)}catch(t){if(!i)throw t;i(t)}
c&&this.URL.length&&"data"!==this.URL.scheme&&console.info("Done loading scene "+this.URL)}},createX3DFromURL:function(t,e,n,i,r){return this.bindViewpoint=i,this.foreign=r,n?this.loadDocument(t,e,this.createX3DFromURLAsync.bind(this,n)):this.createX3DFromURLSync(t)},createX3DFromURLAsync:function(t,e){null===e?t(null):this.createX3DFromString(this.URL,e,t,this.loadDocumentError.bind(this))},createX3DFromURLSync:function(e){if(0===e.length)throw new Error("No URL given.");for(var n=null,i=!1,r=0;r<e.length&&(this.URL=this.transform(e[r]),t.ajax({url:this.URL.escape(),dataType:"text",async:!1,cache:this.browser.getBrowserOptions().getCache(),global:!1,context:this,success:function(t){try{n=this.createX3DFromString(this.URL,t),i=!0}catch(t){this.error(t)}},error:function(t,e,n){}}),!i);++r);if(i)return n;throw new Error("Couldn't load any url of '"+e.getValue().join(", ")+"'.")},loadScript:function(t,e){this.script=!0,this.loadDocument(t,null,e)},loadDocument:function(t,e,n){if(this.url=t.copy(),this.callback=n,0===t.length)return this.loadDocumentError(new Error("No URL given."));this.target=this.getTarget(e||x),this.loadDocumentAsync(this.url.shift())},getTarget:function(t){for(var e=0,n=t.length;e<n;++e){var i=t[e].split("=");if(2===i.length&&"target"===i[0])return i[1]}return""},loadDocumentAsync:function(e){var n=new a(e);if(0==e.length)return void this.loadDocumentError(new Error("URL is empty."));try{if(this.bindViewpoint&&0===n.filename.toString().length&&0===n.query.length)return void this.bindViewpoint(n.fragment)}catch(t){return void this.loadDocumentError(t)}if(this.script)try{var r=d.exec(e);if(r)return void this.callback(r[1])}catch(t){return void this.loadDocumentError(t)}this.URL=this.transform(e);try{var r=p.exec(e);if(r){var o=r[4];return o="base64"===r[3]?atob(o):unescape(o),this.target.length&&"_self"!==this.target&&this.foreign?this.foreign(this.URL.toString().replace(i.getFallbackExpression(),""),this.target):void this.callback(o)}}catch(t){return void this.loadDocumentError(t)}return this.target.length&&"_self"!==this.target&&this.foreign?this.foreign(this.URL.toString().replace(i.getFallbackExpression(),""),this.target):this.foreign&&this.URL.extension.match(g)?this.foreign(this.URL.toString().replace(i.getFallbackExpression(),""),this.target):void t.ajax({url:this.URL.escape(),dataType:"binary",async:!0,cache:this.browser.getBrowserOptions().getCache(),global:!1,context:this,success:function(t,e,n){if(this.foreign&&m[this.getContentType(n)])return this.foreign(this.URL.toString().replace(i.getFallbackExpression(),""),this.target);this.fileReader.onload=this.readAsArrayBuffer.bind(this,t),this.fileReader.readAsArrayBuffer(t)},error:function(t,e,n){this.loadDocumentError(new Error(n))}})},readAsArrayBuffer:function(t){try{this.callback(l.ungzip(this.fileReader.result,{to:"string"}))}catch(e){this.fileReader.onload=this.readAsText.bind(this,t),this.fileReader.readAsText(t)}},readAsText:function(t){try{this.callback(this.fileReader.result)}catch(t){this.loadDocumentError(t)}},loadDocumentError:function(t){this.error(t),this.url.length?this.loadDocumentAsync(this.url.shift()):this.callback(null)},error:function(t){"data"!==this.URL.scheme&&(console.warn("Couldn't load URL '"+this.URL+"':",t.message),c&&console.log(t))},transform:function(t){var e=this.getReferer().transform(new a(t));return e.isLocal()||"localhost"===e.host?e=this.browser.getLocation().getRelativePath(e):c&&(t.match(i.getFallbackExpression())||this.url.unshift(i.getFallbackUrl(e))),e},getReferer:function(){return"World"===this.node.getTypeName()&&this.external?this.browser.getLocation():this.executionContext.getURL()},getContentType:function(t){var e=t.getResponseHeader("Content-Type"),n=f.exec(e);return n?n[1]:""}}),h}),define("x_ite/Components/Shaders/ShaderPart",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Browser/Shaders/Shader","x_ite/Components/Core/X3DNode","x_ite/Components/Networking/X3DUrlObject","x_ite/InputOutput/FileLoader","x_ite/Bits/X3DConstants","x_ite/DEBUG"],function(t,e,n,i,r,o,s,a,u){"use strict";function l(e){r.call(this,e),o.call(this,e),this.addType(a.ShaderPart),this.addChildObjects("buffer",new t.SFTime),this.valid=!1}var c={VERTEX:"VERTEX_SHADER",TESS_CONTROL:"TESS_CONTROL_SHADER",TESS_EVALUATION:"TESS_EVALUATION_SHADER",GEOMETRY:"GEOMETRY_SHADER",FRAGMENT:"FRAGMENT_SHADER",COMPUTE:"COMPUTE_SHADER"};return l.prototype=Object.assign(Object.create(r.prototype),o.prototype,{constructor:l,fieldDefinitions:new n([new e(a.inputOutput,"metadata",new t.SFNode),new e(a.initializeOnly,"type",new t.SFString("VERTEX")),new e(a.inputOutput,"url",new t.MFString)]),getTypeName:function(){return"ShaderPart"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"parts"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this);var t=this.getBrowser().getContext();this.shader=t.createShader(t[this.getShaderType()]),this.url_.addInterest("set_url__",this),this.buffer_.addInterest("set_buffer__",this),this.set_url__()},set_url__:function(){this.setLoadState(a.NOT_STARTED_STATE),this.requestAsyncLoad()},isValid:function(){return this.valid},getShader:function(){return this.shader},getShaderType:function(){var t=c[this.type_.getValue()];return t?t:"VERTEX_SHADER"},getSourceText:function(){return this.url_},setShadow:function(t){this.shadow=t},getShadow:function(){return this.shadow},requestAsyncLoad:function(){this.checkLoadState()!=a.COMPLETE_STATE&&this.checkLoadState()!=a.IN_PROGRESS_STATE&&(this.setLoadState(a.IN_PROGRESS_STATE),this.buffer_.addEvent())},set_buffer__:function(){this.valid=!1,new s(this).loadDocument(this.url_,null,function(t,e){if(null===t)this.setLoadState(a.FAILED_STATE);else{var n=this.getBrowser().getContext();if(n.shaderSource(this.shader,i.getShaderSource(this.getBrowser(),this.getName(),t,this.shadow)),n.compileShader(this.shader),this.valid=n.getShaderParameter(this.shader,n.COMPILE_STATUS),!this.valid)throw new Error(this.getTypeName()+" '"+this.getName()+"': "+n.getShaderInfoLog(this.shader));this.setLoadState(a.COMPLETE_STATE)}}.bind(this))}}),l}),define("text!x_ite/Browser/Shaders/WebGL1/PointSet.vs",[],function(){return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nuniform x3d_LinePropertiesParameters x3d_LineProperties;\n\nuniform bool  x3d_ColorMaterial;   // true if a X3DColorNode is attached, otherwise false\nuniform bool  x3d_Lighting;        // true if a X3DMaterialNode is attached, otherwise false\nuniform x3d_MaterialParameters x3d_FrontMaterial;  \n\nuniform mat4 x3d_ProjectionMatrix;\nuniform mat4 x3d_ModelViewMatrix;\n\nattribute float x3d_FogDepth;\nattribute vec4  x3d_Color;\nattribute vec4  x3d_Vertex;\n\nvarying float fogDepth; // fog depth\nvarying vec4  color;    // color\nvarying vec3  vertex;   // point on geometry\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\nvarying float depth;\n#endif\n\nvoid\nmain ()\n{\n\t// If we are points, make the gl_PointSize one pixel larger.\n\tgl_PointSize = x3d_LineProperties .linewidthScaleFactor + 1.0;\n\n\tvec4 position = x3d_ModelViewMatrix * x3d_Vertex;\n\n\tfogDepth = x3d_FogDepth;\n\tvertex   = position .xyz;\n\n\tgl_Position = x3d_ProjectionMatrix * position;\n\n\t#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n\tdepth = 1.0 + gl_Position .w;\n\t#endif\n\n\tif (x3d_Lighting)\n\t{\n\t\tfloat alpha = 1.0 - x3d_FrontMaterial .transparency;\n\n\t\tif (x3d_ColorMaterial)\n\t\t{\n\t\t\tcolor .rgb = x3d_Color .rgb;\n\t\t\tcolor .a   = x3d_Color .a * alpha;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcolor .rgb = x3d_FrontMaterial .emissiveColor;\n\t\t\tcolor .a   = alpha;\n\t\t}\n\t}\n\telse\n\t{\n\t\tif (x3d_ColorMaterial)\n\t\t\tcolor = x3d_Color;\n\t\telse\n\t\t\tcolor = vec4 (1.0);\n\t}\n}\n"}),define("text!x_ite/Browser/Shaders/WebGL1/PointSet.fs",[],function(){return'// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n#extension GL_EXT_frag_depth : enable\n#endif\n\nprecision mediump float;\nprecision mediump int;\n\nuniform x3d_LinePropertiesParameters x3d_LineProperties;\n\nvarying float fogDepth; // fog depth\nvarying vec4  color;    // color\nvarying vec3  vertex;   // point on geometry\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\nuniform float x3d_LogarithmicFarFactor1_2;\nvarying float depth;\n#endif\n\n#pragma X3D include "Include/Fog.h"\n#pragma X3D include "Include/ClipPlanes.h"\n\nvoid\nmain ()\n{\n\tclip ();\n\n\tfloat lw = (x3d_LineProperties .linewidthScaleFactor + 1.0) / 2.0;\n\tfloat t  = distance (vec2 (0.5, 0.5), gl_PointCoord) * 2.0 * lw - lw + 1.0;\n\n\tgl_FragColor .rgb = getFogColor (color .rgb);\n\tgl_FragColor .a   = mix (color .a, 0.0, clamp (t, 0.0, 1.0));\n\n\t#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n\t//http://outerra.blogspot.com/2013/07/logarithmic-depth-buffer-optimizations.html\n\tif (x3d_LogarithmicFarFactor1_2 > 0.0)\n\t\tgl_FragDepthEXT = log2 (depth) * x3d_LogarithmicFarFactor1_2;\n\telse\n\t\tgl_FragDepthEXT = gl_FragCoord .z;\n\t#endif\n}\n'}),define("text!x_ite/Browser/Shaders/WebGL1/Wireframe.vs",[],function(){return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nuniform bool  x3d_ColorMaterial;   // true if a X3DColorNode is attached, otherwise false\nuniform bool  x3d_Lighting;        // true if a X3DMaterialNode is attached, otherwise false\nuniform x3d_MaterialParameters x3d_FrontMaterial;  \n\nuniform mat4 x3d_ProjectionMatrix;\nuniform mat4 x3d_ModelViewMatrix;\n\nattribute float x3d_FogDepth;\nattribute vec4  x3d_Color;\nattribute vec4  x3d_Vertex;\n\nvarying float fogDepth; // fog depth\nvarying vec4  color;    // color\nvarying vec3  vertex;   // point on geometry\n\n#ifdef X_ITE\nattribute vec4 x3d_TexCoord0;\nvarying   vec3 startPosition;  // line stipple start\nvarying   vec3 vertexPosition; // current line stipple position\n#endif\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\nvarying float depth;\n#endif\n\nvoid\nmain ()\n{\n\tvec4 position = x3d_ModelViewMatrix * x3d_Vertex;\n\n\tfogDepth = x3d_FogDepth;\n\tvertex   = position .xyz;\n\n\tgl_Position = x3d_ProjectionMatrix * position;\n\n\t#ifdef X_ITE\n\t// Line Stipple\n\tvec4 start = x3d_ProjectionMatrix * x3d_ModelViewMatrix * x3d_TexCoord0;\n\n\tstartPosition  = start .xyz / start .w;\n\tvertexPosition = gl_Position .xyz / gl_Position .w;\n\t#endif\n\n\t#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n\tdepth = 1.0 + gl_Position .w;\n\t#endif\n\n\tif (x3d_Lighting)\n\t{\n\t\tfloat alpha = 1.0 - x3d_FrontMaterial .transparency;\n\n\t\tif (x3d_ColorMaterial)\n\t\t{\n\t\t\tcolor .rgb = x3d_Color .rgb;\n\t\t\tcolor .a   = x3d_Color .a * alpha;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcolor .rgb = x3d_FrontMaterial .emissiveColor;\n\t\t\tcolor .a   = alpha;\n\t\t}\n\t}\n\telse\n\t{\n\t\tif (x3d_ColorMaterial)\n\t\t\tcolor = x3d_Color;\n\t\telse\n\t\t\tcolor = vec4 (1.0);\n\t}\n}\n"}),define("text!x_ite/Browser/Shaders/WebGL1/Wireframe.fs",[],function(){return'// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n#extension GL_EXT_frag_depth : enable\n#endif\n\nprecision mediump float;\nprecision mediump int;\n\nuniform x3d_LinePropertiesParameters x3d_LineProperties;\nuniform ivec4 x3d_Viewport;\n\nvarying float fogDepth; // fog depth\nvarying vec4  color;    // color\nvarying vec3  vertex;   // point on geometry\n\n#ifdef X_ITE\nvarying vec3 startPosition;  // line stipple start\nvarying vec3 vertexPosition; // current line stipple position\n#endif\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\nuniform float x3d_LogarithmicFarFactor1_2;\nvarying float depth;\n#endif\n\n#pragma X3D include "Include/Fog.h"\n#pragma X3D include "Include/ClipPlanes.h"\n\n#ifdef X_ITE\nvoid\nstipple ()\n{\n\tif (x3d_LineProperties .applied)\n\t{\n\t\tvec2  direction = (vertexPosition .xy - startPosition .xy) * vec2 (x3d_Viewport .zw) * 0.5;\n\t\tfloat distance  = length (direction) / 16.0;\n\t\tfloat color     = texture2D (x3d_LineProperties .linetype, vec2 (distance, distance)) .a;\n\n\t\tif (color == 0.0)\n\t\t\tdiscard;\n\t}\n}\n#endif\n\nvoid\nmain ()\n{\n\tclip ();\n\n\t#ifdef X_ITE\n\tstipple ();\n\t#endif\n\n\tgl_FragColor .rgb = getFogColor (color .rgb);\n\tgl_FragColor .a   = color .a;\n\n\t#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n\t//http://outerra.blogspot.com/2013/07/logarithmic-depth-buffer-optimizations.html\n\tif (x3d_LogarithmicFarFactor1_2 > 0.0)\n\t\tgl_FragDepthEXT = log2 (depth) * x3d_LogarithmicFarFactor1_2;\n\telse\n\t\tgl_FragDepthEXT = gl_FragCoord .z;\n\t#endif\n}\n'}),define("text!x_ite/Browser/Shaders/WebGL1/Gouraud.vs",[],function(){return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nuniform mat4 x3d_TextureMatrix [x3d_MaxTextures];\nuniform mat3 x3d_NormalMatrix;\nuniform mat4 x3d_ProjectionMatrix;\nuniform mat4 x3d_ModelViewMatrix;\n\nuniform bool x3d_Lighting;      // true if a X3DMaterialNode is attached, otherwise false\nuniform bool x3d_ColorMaterial; // true if a X3DColorNode is attached, otherwise false\n\nuniform int x3d_NumLights;\nuniform x3d_LightSourceParameters x3d_LightSource [x3d_MaxLights];\nuniform bool x3d_SeparateBackColor;\nuniform x3d_MaterialParameters x3d_FrontMaterial;  \nuniform x3d_MaterialParameters x3d_BackMaterial;\n\nattribute float x3d_FogDepth;\nattribute vec4  x3d_Color;\nattribute vec4  x3d_TexCoord0;\nattribute vec4  x3d_TexCoord1;\nattribute vec3  x3d_Normal;\nattribute vec4  x3d_Vertex;\n\nvarying float fogDepth;    // fog depth\nvarying vec4  frontColor;  // color\nvarying vec4  backColor;   // color\nvarying vec4  texCoord0;   // texCoord0\nvarying vec4  texCoord1;   // texCoord1\nvarying vec3  normal;      // normal vector at this point on geometry\nvarying vec3  vertex;      // point on geometry\nvarying vec3  localNormal; // normal vector at this point on geometry in local coordinates\nvarying vec3  localVertex; // point on geometry in local coordinates\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\nvarying float depth;\n#endif\n\nfloat\ngetSpotFactor (const in float cutOffAngle, const in float beamWidth, const in vec3 L, const in vec3 d)\n{\n\tfloat spotAngle = acos (clamp (dot (-L, d), -1.0, 1.0));\n\t\n\tif (spotAngle >= cutOffAngle)\n\t\treturn 0.0;\n\telse if (spotAngle <= beamWidth)\n\t\treturn 1.0;\n\n\treturn (spotAngle - cutOffAngle) / (beamWidth - cutOffAngle);\n}\n\nvec4\ngetMaterialColor (const in vec3 N,\n                  const in vec3 vertex,\n                  const in x3d_MaterialParameters material)\n{\n\tvec3 V = normalize (-vertex); // normalized vector from point on geometry to viewer's position\n\n\t// Calculate diffuseFactor & alpha\n\n\tvec3  diffuseFactor = vec3 (0.0);\n\tfloat alpha         = 1.0 - material .transparency;\n\n\tif (x3d_ColorMaterial)\n\t{\n\t\tdiffuseFactor  = x3d_Color .rgb;\n\t\talpha         *= x3d_Color .a;\n\t}\n\telse\n\t\tdiffuseFactor = material .diffuseColor;\n\n\tvec3 ambientTerm = diffuseFactor * material .ambientIntensity;\n\n\t// Apply light sources\n\n\tvec3 finalColor = vec3 (0.0);\n\n\tfor (int i = 0; i < x3d_MaxLights; ++ i)\n\t{\n\t\tif (i == x3d_NumLights)\n\t\t\tbreak;\n\n\t\tx3d_LightSourceParameters light = x3d_LightSource [i];\n\n\t\tvec3  vL = light .location - vertex;\n\t\tfloat dL = length (light .matrix * vL);\n\t\tbool  di = light .type == x3d_DirectionalLight;\n\n\t\tif (di || dL <= light .radius)\n\t\t{\n\t\t\tvec3 d = light .direction;\n\t\t\tvec3 c = light .attenuation;\n\t\t\tvec3 L = di ? -d : normalize (vL);      // Normalized vector from point on geometry to light source i position.\n\t\t\tvec3 H = normalize (L + V);             // Specular term\n\n\t\t\tfloat lightAngle     = dot (N, L);      // Angle between normal and light ray.\n\t\t\tvec3  diffuseTerm    = diffuseFactor * clamp (lightAngle, 0.0, 1.0);\n\t\t\tfloat specularFactor = material .shininess > 0.0 ? pow (max (dot (N, H), 0.0), material .shininess * 128.0) : 1.0;\n\t\t\tvec3  specularTerm   = material .specularColor * specularFactor;\n\n\t\t\tfloat attenuationFactor           = di ? 1.0 : 1.0 / max (c [0] + c [1] * dL + c [2] * (dL * dL), 1.0);\n\t\t\tfloat spotFactor                  = light .type == x3d_SpotLight ? getSpotFactor (light .cutOffAngle, light .beamWidth, L, d) : 1.0;\n\t\t\tfloat attenuationSpotFactor       = attenuationFactor * spotFactor;\n\t\t\tvec3  ambientColor                = light .ambientIntensity * ambientTerm;\n\t\t\tvec3  ambientDiffuseSpecularColor = ambientColor + light .intensity * (diffuseTerm + specularTerm);\n\n\t\t\tfinalColor += attenuationSpotFactor * (light .color * ambientDiffuseSpecularColor);\n\t\t}\n\t}\n\n\tfinalColor += material .emissiveColor;\n\n\treturn vec4 (clamp (finalColor, 0.0, 1.0), alpha);\n}\n\nvoid\nmain ()\n{\n\tvec4 position = x3d_ModelViewMatrix * x3d_Vertex;\n\n\tfogDepth    = x3d_FogDepth;\n\ttexCoord0   = x3d_TextureMatrix [0] * x3d_TexCoord0;\n\ttexCoord1   = x3d_TextureMatrix [1] * x3d_TexCoord1;\n\tvertex      = position .xyz;\n\tnormal      = normalize (x3d_NormalMatrix * x3d_Normal);\n\tlocalNormal = x3d_Normal;\n\tlocalVertex = x3d_Vertex .xyz;\n\n\tgl_Position = x3d_ProjectionMatrix * position;\n\n\t#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n\tdepth = 1.0 + gl_Position .w;\n\t#endif\n\n\tif (x3d_Lighting)\n\t{\n\n\t\tfrontColor = getMaterialColor (normal, vertex, x3d_FrontMaterial);\n\n\t\tx3d_MaterialParameters backMaterial = x3d_FrontMaterial;\n\n\t\tif (x3d_SeparateBackColor)\n\t\t\tbackMaterial = x3d_BackMaterial;\n\n\t\tbackColor = getMaterialColor (-normal, vertex, backMaterial);\n\t}\n\telse\n\t{\n\t   frontColor = backColor = x3d_ColorMaterial ? x3d_Color : vec4 (1.0);\n\t}\n}\n"}),define("text!x_ite/Browser/Shaders/WebGL1/Gouraud.fs",[],function(){return'// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n#extension GL_EXT_frag_depth : enable\n#endif\n\nprecision mediump float;\nprecision mediump int;\n\nuniform int x3d_GeometryType;\n\nuniform bool  x3d_Lighting;      // true if a X3DMaterialNode is attached, otherwise false\nuniform bool  x3d_ColorMaterial; // true if a X3DColorNode is attached, otherwise false\n\nvarying float fogDepth;    // fog depth\nvarying vec4  frontColor;  // color\nvarying vec4  backColor;   // color\nvarying vec4  texCoord0;   // texCoord0\nvarying vec4  texCoord1;   // texCoord1\nvarying vec3  normal;      // normal vector at this point on geometry\nvarying vec3  vertex;      // point on geometry\nvarying vec3  localNormal; // normal vector at this point on geometry in local coordinates\nvarying vec3  localVertex; // point on geometry in local coordinates\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\nuniform float x3d_LogarithmicFarFactor1_2;\nvarying float depth;\n#endif\n\n#pragma X3D include "Include/Texture.h"\n#pragma X3D include "Include/Hatch.h"\n#pragma X3D include "Include/Fog.h"\n#pragma X3D include "Include/ClipPlanes.h"\n\nvoid\nmain ()\n{\n \tclip ();\n\n\tvec4 finalColor = gl_FrontFacing ? frontColor : backColor;\n\n\tif (x3d_NumTextures > 0)\n\t{\n\t\tif (x3d_Lighting)\n\t\t{\n\t\t\tfinalColor = getTextureColor (finalColor, vec4 (1.0));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (x3d_ColorMaterial)\n\t\t\t{\n\t\t\t\tfinalColor = getTextureColor (finalColor, vec4 (1.0));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfinalColor = getTextureColor (vec4 (1.0), vec4 (1.0));\n\t\t\t}\n\t\t}\n\t}\n\n\tfinalColor        = getHatchColor (finalColor);\n\tgl_FragColor .rgb = getFogColor (finalColor .rgb);\n\tgl_FragColor .a   = finalColor .a;\n\n\t#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n\t//http://outerra.blogspot.com/2013/07/logarithmic-depth-buffer-optimizations.html\n\tif (x3d_LogarithmicFarFactor1_2 > 0.0)\n\t\tgl_FragDepthEXT = log2 (depth) * x3d_LogarithmicFarFactor1_2;\n\telse\n\t\tgl_FragDepthEXT = gl_FragCoord .z;\n\t#endif\n}\n'}),define("text!x_ite/Browser/Shaders/WebGL1/Phong.vs",[],function(){return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nuniform mat4 x3d_TextureMatrix [x3d_MaxTextures];\nuniform mat3 x3d_NormalMatrix;\nuniform mat4 x3d_ProjectionMatrix;\nuniform mat4 x3d_ModelViewMatrix;\n\nuniform bool x3d_Lighting;  // true if a X3DMaterialNode is attached, otherwise false\n\nattribute float x3d_FogDepth;\nattribute vec4  x3d_Color;\nattribute vec4  x3d_TexCoord0;\nattribute vec4  x3d_TexCoord1;\nattribute vec3  x3d_Normal;\nattribute vec4  x3d_Vertex;\n\nvarying float fogDepth;    // fog depth\nvarying vec4  color;       // color\nvarying vec4  texCoord0;   // texCoord0\nvarying vec4  texCoord1;   // texCoord1\nvarying vec3  normal;      // normalized normal vector at this point on geometry\nvarying vec3  vertex;      // point on geometry\nvarying vec3  localNormal; // normal vector at this point on geometry in local coordinates\nvarying vec3  localVertex; // point on geometry in local coordinates\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\nvarying float depth;\n#endif\n\nvoid\nmain ()\n{\n\tvec4 position = x3d_ModelViewMatrix * x3d_Vertex;\n\n\tfogDepth    = x3d_FogDepth;\n\tcolor       = x3d_Color;\n\ttexCoord0   = x3d_TextureMatrix [0] * x3d_TexCoord0;\n\ttexCoord1   = x3d_TextureMatrix [1] * x3d_TexCoord1;\n\tnormal      = x3d_NormalMatrix * x3d_Normal;\n\tvertex      = position .xyz;\n\tlocalNormal = x3d_Normal;\n\tlocalVertex = x3d_Vertex .xyz;\n\n\tgl_Position = x3d_ProjectionMatrix * position;\n\n\t#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n\tdepth = 1.0 + gl_Position .w;\n\t#endif\n}\n"}),define("text!x_ite/Browser/Shaders/WebGL1/Phong.fs",[],function(){return'// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n#extension GL_EXT_frag_depth : enable\n#endif\n\nprecision mediump float;\nprecision mediump int;\n\nuniform int  x3d_GeometryType;\nuniform bool x3d_Lighting;      // true if a X3DMaterialNode is attached, otherwise false\nuniform bool x3d_ColorMaterial; // true if a X3DColorNode is attached, otherwise false\n\nuniform int x3d_NumLights;\nuniform x3d_LightSourceParameters x3d_LightSource [x3d_MaxLights];\nuniform bool x3d_SeparateBackColor;\nuniform x3d_MaterialParameters x3d_FrontMaterial;  \nuniform x3d_MaterialParameters x3d_BackMaterial;        \n\nvarying float fogDepth;    // fog depth\nvarying vec4  color;       // color\nvarying vec4  texCoord0;   // texCoord0\nvarying vec4  texCoord1;   // texCoord1\nvarying vec3  normal;      // normal vector at this point on geometry\nvarying vec3  vertex;      // point on geometry\nvarying vec3  localNormal; // normal vector at this point on geometry in local coordinates\nvarying vec3  localVertex; // point on geometry in local coordinates\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\nuniform float x3d_LogarithmicFarFactor1_2;\nvarying float depth;\n#endif\n\n#pragma X3D include "Include/Shadow.h"\n#pragma X3D include "Include/Texture.h"\n#pragma X3D include "Include/Hatch.h"\n#pragma X3D include "Include/Fog.h"\n#pragma X3D include "Include/ClipPlanes.h"\n\nfloat\ngetSpotFactor (const in float cutOffAngle, const in float beamWidth, const in vec3 L, const in vec3 d)\n{\n\tfloat spotAngle = acos (clamp (dot (-L, d), -1.0, 1.0));\n\t\n\tif (spotAngle >= cutOffAngle)\n\t\treturn 0.0;\n\telse if (spotAngle <= beamWidth)\n\t\treturn 1.0;\n\n\treturn (spotAngle - cutOffAngle) / (beamWidth - cutOffAngle);\n}\n\nvec4\ngetMaterialColor (const in x3d_MaterialParameters material)\n{\n\tif (x3d_Lighting)\n\t{\n\t\tvec3  N  = normalize (gl_FrontFacing ? normal : -normal);\n\t\tvec3  V  = normalize (-vertex); // normalized vector from point on geometry to viewer\'s position\n\t\tfloat dV = length (vertex);\n\n\t\t// Calculate diffuseFactor & alpha\n\n\t\tvec3  diffuseFactor = vec3 (1.0);\n\t\tfloat alpha         = 1.0 - material .transparency;\n\n\t\tif (x3d_ColorMaterial)\n\t\t{\n\t\t\tif (x3d_NumTextures > 0)\n\t\t\t{\n\t\t\t\tvec4 T = getTextureColor (vec4 (color .rgb, color .a * alpha), vec4 (material .specularColor, alpha));\n\n\t\t\t\tdiffuseFactor = T .rgb;\n\t\t\t\talpha         = T .a;\n\t\t\t}\n\t\t\telse\n\t\t\t\tdiffuseFactor = color .rgb;\n\n\t\t\talpha *= color .a;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (x3d_NumTextures > 0)\n\t\t\t{\n\t\t\t\tvec4 T = getTextureColor (vec4 (material .diffuseColor, alpha), vec4 (material .specularColor, alpha));\n\n\t\t\t\tdiffuseFactor = T .rgb;\n\t\t\t\talpha         = T .a;\n\t\t\t}\n\t\t\telse\n\t\t\t\tdiffuseFactor = material .diffuseColor;\n\t\t}\n\n\t\tvec3 ambientTerm = diffuseFactor * material .ambientIntensity;\n\n\t\t// Apply light sources\n\n\t\tvec3 finalColor = vec3 (0.0);\n\n\t\tfor (int i = 0; i < x3d_MaxLights; i ++)\n\t\t{\n\t\t\tif (i == x3d_NumLights)\n\t\t\t\tbreak;\n\n\t\t\tx3d_LightSourceParameters light = x3d_LightSource [i];\n\n\t\t\tvec3  vL = light .location - vertex; // Light to fragment\n\t\t\tfloat dL = length (light .matrix * vL);\n\t\t\tbool  di = light .type == x3d_DirectionalLight;\n\n\t\t\tif (di || dL <= light .radius)\n\t\t\t{\n\t\t\t\tvec3 d = light .direction;\n\t\t\t\tvec3 c = light .attenuation;\n\t\t\t\tvec3 L = di ? -d : normalize (vL);      // Normalized vector from point on geometry to light source i position.\n\t\t\t\tvec3 H = normalize (L + V);             // Specular term\n\n\t\t\t\tfloat lightAngle     = dot (N, L);      // Angle between normal and light ray.\n\t\t\t\tvec3  diffuseTerm    = diffuseFactor * clamp (lightAngle, 0.0, 1.0);\n\t\t\t\tfloat specularFactor = material .shininess > 0.0 ? pow (max (dot (N, H), 0.0), material .shininess * 128.0) : 1.0;\n\t\t\t\tvec3  specularTerm   = material .specularColor * specularFactor;\n\n\t\t\t\tfloat attenuationFactor     = di ? 1.0 : 1.0 / max (c [0] + c [1] * dL + c [2] * (dL * dL), 1.0);\n\t\t\t\tfloat spotFactor            = light .type == x3d_SpotLight ? getSpotFactor (light .cutOffAngle, light .beamWidth, L, d) : 1.0;\n\t\t\t\tfloat attenuationSpotFactor = attenuationFactor * spotFactor;\n\t\t\t\tvec3  ambientColor          = light .color * light .ambientIntensity * ambientTerm;\n\t\t\t\tvec3  diffuseSpecularColor  = light .color * light .intensity * (diffuseTerm + specularTerm);\n\n\t\t\t\t#ifdef X3D_SHADOWS\n\t\t\t\t\tif (lightAngle > 0.0)\n\t\t\t\t\t\tdiffuseSpecularColor = mix (diffuseSpecularColor, light .shadowColor, getShadowIntensity (i, light));\n\t\t\t\t#endif\n\n\t\t\t\tfinalColor += attenuationSpotFactor * (ambientColor + diffuseSpecularColor);\n\t\t\t}\n\t\t}\n\n\t\tfinalColor += material .emissiveColor;\n\n\t\treturn vec4 (finalColor, alpha);\n\t}\n\telse\n\t{\n\t\tvec4 finalColor = vec4 (1.0);\n\t\n\t\tif (x3d_ColorMaterial)\n\t\t{\n\t\t\tif (x3d_NumTextures > 0)\n\t\t\t{\n\t\t\t\tfinalColor = getTextureColor (color, vec4 (1.0));\n\t\t\t}\n\t\t\telse\n\t\t\t\tfinalColor = color;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (x3d_NumTextures > 0)\n\t\t\t\tfinalColor = getTextureColor (vec4 (1.0), vec4 (1.0));\n\t\t}\n\n\t\treturn finalColor;\n\t}\n}\n\n// DEBUG\n//uniform ivec4 x3d_Viewport;\n\nvoid\nmain ()\n{\n\tclip ();\n\n\tbool frontColor = gl_FrontFacing || ! x3d_SeparateBackColor;\n\n\tgl_FragColor      = frontColor ? getMaterialColor (x3d_FrontMaterial) : getMaterialColor (x3d_BackMaterial);\n\tgl_FragColor      = getHatchColor (gl_FragColor);\n\tgl_FragColor .rgb = getFogColor (gl_FragColor .rgb);\n\n\t#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n\t//http://outerra.blogspot.com/2013/07/logarithmic-depth-buffer-optimizations.html\n\tif (x3d_LogarithmicFarFactor1_2 > 0.0)\n\t\tgl_FragDepthEXT = log2 (depth) * x3d_LogarithmicFarFactor1_2;\n\telse\n\t\tgl_FragDepthEXT = gl_FragCoord .z;\n\t#endif\n\n\t// DEBUG\n\t#ifdef X3D_SHADOWS\n\t//gl_FragColor .rgb = texture2D (x3d_ShadowMap [0], gl_FragCoord .xy / vec2 (x3d_Viewport .zw)) .rgb;\n\t//gl_FragColor .rgb = mix (tex .rgb, gl_FragColor .rgb, 0.5);\n\t#endif\n\n\t#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n\t//gl_FragColor .rgb = mix (vec3 (1.0, 0.0, 0.0), gl_FragColor .rgb, 0.5);\n\t#endif\n}\n'}),define("text!x_ite/Browser/Shaders/WebGL1/Depth.vs",[],function(){return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nuniform mat4 x3d_ProjectionMatrix;\nuniform mat4 x3d_ModelViewMatrix;\n\nattribute vec4 x3d_Vertex;\n\nvarying vec3 vertex; // point on geometry\n\nvoid\nmain ()\n{\n\tvec4 position = x3d_ModelViewMatrix * x3d_Vertex;\n\n\tvertex = position .xyz;\n\n\tgl_Position = x3d_ProjectionMatrix * position;\n}\n"}),define("text!x_ite/Browser/Shaders/WebGL1/Depth.fs",[],function(){return'// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nvarying vec3 vertex; // point on geometry\n\n#pragma X3D include "Include/Pack.h"\n#pragma X3D include "Include/ClipPlanes.h"\n\nvoid\nmain ()\n{\n\tclip ();\n\n\tgl_FragColor = pack (gl_FragCoord .z);\n}\n'}),define("text!x_ite/Browser/Shaders/WebGL2/PointSet.vs",[],function(){return"#version 300 es\n// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nuniform x3d_LinePropertiesParameters x3d_LineProperties;\n\nuniform bool  x3d_ColorMaterial;   // true if a X3DColorNode is attached, otherwise false\nuniform bool  x3d_Lighting;        // true if a X3DMaterialNode is attached, otherwise false\nuniform x3d_MaterialParameters x3d_FrontMaterial;  \n\nuniform mat4 x3d_ProjectionMatrix;\nuniform mat4 x3d_ModelViewMatrix;\n\nin float x3d_FogDepth;\nin vec4  x3d_Color;\nin vec4  x3d_Vertex;\n\nout float fogDepth; // fog depth\nout vec4  color;    // color\nout vec3  vertex;   // point on geometry\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\nout float depth;\n#endif\n\nvoid\nmain ()\n{\n\t// If we are points, make the gl_PointSize one pixel larger.\n\tgl_PointSize = x3d_LineProperties .linewidthScaleFactor + 1.0;\n\n\tvec4 position = x3d_ModelViewMatrix * x3d_Vertex;\n\n\tfogDepth = x3d_FogDepth;\n\tvertex   = position .xyz;\n\n\tgl_Position = x3d_ProjectionMatrix * position;\n\n\t#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n\tdepth = 1.0 + gl_Position .w;\n\t#endif\n\n\tif (x3d_Lighting)\n\t{\n\t\tfloat alpha = 1.0 - x3d_FrontMaterial .transparency;\n\n\t\tif (x3d_ColorMaterial)\n\t\t{\n\t\t\tcolor .rgb = x3d_Color .rgb;\n\t\t\tcolor .a   = x3d_Color .a * alpha;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcolor .rgb = x3d_FrontMaterial .emissiveColor;\n\t\t\tcolor .a   = alpha;\n\t\t}\n\t}\n\telse\n\t{\n\t\tif (x3d_ColorMaterial)\n\t\t\tcolor = x3d_Color;\n\t\telse\n\t\t\tcolor = vec4 (1.0);\n\t}\n}\n"}),define("text!x_ite/Browser/Shaders/WebGL2/PointSet.fs",[],function(){
return'#version 300 es\n// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nuniform x3d_LinePropertiesParameters x3d_LineProperties;\n\nin float fogDepth; // fog depth\nin vec4  color;    // color\nin vec3  vertex;   // point on geometry\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\nuniform float x3d_LogarithmicFarFactor1_2;\nin float depth;\n#endif\n\nout vec4 x3d_FragColor;\n\n#pragma X3D include "Include/Fog.h"\n#pragma X3D include "Include/ClipPlanes.h"\n\nvoid\nmain ()\n{\n\tclip ();\n\n\tfloat lw = (x3d_LineProperties .linewidthScaleFactor + 1.0) / 2.0;\n\tfloat t  = distance (vec2 (0.5, 0.5), gl_PointCoord) * 2.0 * lw - lw + 1.0;\n\n\tx3d_FragColor .rgb = getFogColor (color .rgb);\n\tx3d_FragColor .a   = mix (color .a, 0.0, clamp (t, 0.0, 1.0));\n\n\t#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n\t//http://outerra.blogspot.com/2013/07/logarithmic-depth-buffer-optimizations.html\n\tif (x3d_LogarithmicFarFactor1_2 > 0.0)\n\t\tgl_FragDepth = log2 (depth) * x3d_LogarithmicFarFactor1_2;\n\telse\n\t\tgl_FragDepth = gl_FragCoord .z;\n\t#endif\n}\n'}),define("text!x_ite/Browser/Shaders/WebGL2/Wireframe.vs",[],function(){return"#version 300 es\n// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nuniform bool  x3d_ColorMaterial;   // true if a X3DColorNode is attached, otherwise false\nuniform bool  x3d_Lighting;        // true if a X3DMaterialNode is attached, otherwise false\nuniform x3d_MaterialParameters x3d_FrontMaterial;  \n\nuniform mat4 x3d_ProjectionMatrix;\nuniform mat4 x3d_ModelViewMatrix;\n\nin float x3d_FogDepth;\nin vec4  x3d_Color;\nin vec4  x3d_Vertex;\n\nout float fogDepth; // fog depth\nout vec4  color;    // color\nout vec3  vertex;   // point on geometry\n\n#ifdef X_ITE\nin  vec4 x3d_TexCoord0;\nout vec3 startPosition;  // line stipple start\nout vec3 vertexPosition; // current line stipple position\n#endif\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\nout float depth;\n#endif\n\nvoid\nmain ()\n{\n\tvec4 position = x3d_ModelViewMatrix * x3d_Vertex;\n\n\tfogDepth = x3d_FogDepth;\n\tvertex   = position .xyz;\n\n\tgl_Position = x3d_ProjectionMatrix * position;\n\n\t#ifdef X_ITE\n\t// Line Stipple\n\tvec4 start = x3d_ProjectionMatrix * x3d_ModelViewMatrix * x3d_TexCoord0;\n\n\tstartPosition  = start .xyz / start .w;\n\tvertexPosition = gl_Position .xyz / gl_Position .w;\n\t#endif\n\n\t#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n\tdepth = 1.0 + gl_Position .w;\n\t#endif\n\n\tif (x3d_Lighting)\n\t{\n\t\tfloat alpha = 1.0 - x3d_FrontMaterial .transparency;\n\n\t\tif (x3d_ColorMaterial)\n\t\t{\n\t\t\tcolor .rgb = x3d_Color .rgb;\n\t\t\tcolor .a   = x3d_Color .a * alpha;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcolor .rgb = x3d_FrontMaterial .emissiveColor;\n\t\t\tcolor .a   = alpha;\n\t\t}\n\t}\n\telse\n\t{\n\t\tif (x3d_ColorMaterial)\n\t\t\tcolor = x3d_Color;\n\t\telse\n\t\t\tcolor = vec4 (1.0);\n\t}\n}\n"}),define("text!x_ite/Browser/Shaders/WebGL2/Wireframe.fs",[],function(){return'#version 300 es\n// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nuniform x3d_LinePropertiesParameters x3d_LineProperties;\nuniform ivec4 x3d_Viewport;\n\nin float fogDepth; // fog depth\nin vec4  color;    // color\nin vec3  vertex;   // point on geometry\n\n#ifdef X_ITE\nin vec3 startPosition;  // line stipple start\nin vec3 vertexPosition; // current line stipple position\n#endif\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\nuniform float x3d_LogarithmicFarFactor1_2;\nin float depth;\n#endif\n\nout vec4 x3d_FragColor;\n\n#pragma X3D include "Include/Fog.h"\n#pragma X3D include "Include/ClipPlanes.h"\n\n#ifdef X_ITE\nvoid\nstipple ()\n{\n\tif (x3d_LineProperties .applied)\n\t{\n\t\tvec2  direction = (vertexPosition .xy - startPosition .xy) * vec2 (x3d_Viewport .zw) * 0.5;\n\t\tfloat distance  = length (direction) / 16.0;\n\t\tfloat color     = texture (x3d_LineProperties .linetype, vec2 (distance, distance)) .a;\n\n\t\tif (color == 0.0)\n\t\t\tdiscard;\n\t}\n}\n#endif\n\nvoid\nmain ()\n{\n\tclip ();\n\n\t#ifdef X_ITE\n\tstipple ();\n\t#endif\n\n\tx3d_FragColor .rgb = getFogColor (color .rgb);\n\tx3d_FragColor .a   = color .a;\n\n\t#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n\t//http://outerra.blogspot.com/2013/07/logarithmic-depth-buffer-optimizations.html\n\tif (x3d_LogarithmicFarFactor1_2 > 0.0)\n\t\tgl_FragDepth = log2 (depth) * x3d_LogarithmicFarFactor1_2;\n\telse\n\t\tgl_FragDepth = gl_FragCoord .z;\n\t#endif\n}\n'}),define("text!x_ite/Browser/Shaders/WebGL2/Gouraud.vs",[],function(){return"#version 300 es\n// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nuniform mat4 x3d_TextureMatrix [x3d_MaxTextures];\nuniform mat3 x3d_NormalMatrix;\nuniform mat4 x3d_ProjectionMatrix;\nuniform mat4 x3d_ModelViewMatrix;\n\nuniform bool x3d_Lighting;      // true if a X3DMaterialNode is attached, otherwise false\nuniform bool x3d_ColorMaterial; // true if a X3DColorNode is attached, otherwise false\n\nuniform int x3d_NumLights;\nuniform x3d_LightSourceParameters x3d_LightSource [x3d_MaxLights];\nuniform bool x3d_SeparateBackColor;\nuniform x3d_MaterialParameters x3d_FrontMaterial;  \nuniform x3d_MaterialParameters x3d_BackMaterial;\n\nin float x3d_FogDepth;\nin vec4  x3d_Color;\nin vec4  x3d_TexCoord0;\nin vec4  x3d_TexCoord1;\nin vec3  x3d_Normal;\nin vec4  x3d_Vertex;\n\nout float fogDepth;    // fog depth\nout vec4  frontColor;  // color\nout vec4  backColor;   // color\nout vec4  texCoord0;   // texCoord0\nout vec4  texCoord1;   // texCoord1\nout vec3  normal;      // normal vector at this point on geometry\nout vec3  vertex;      // point on geometry\nout vec3  localNormal; // normal vector at this point on geometry in local coordinates\nout vec3  localVertex; // point on geometry in local coordinates\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\nout float depth;\n#endif\n\nfloat\ngetSpotFactor (const in float cutOffAngle, const in float beamWidth, const in vec3 L, const in vec3 d)\n{\n\tfloat spotAngle = acos (clamp (dot (-L, d), -1.0, 1.0));\n\t\n\tif (spotAngle >= cutOffAngle)\n\t\treturn 0.0;\n\telse if (spotAngle <= beamWidth)\n\t\treturn 1.0;\n\n\treturn (spotAngle - cutOffAngle) / (beamWidth - cutOffAngle);\n}\n\nvec4\ngetMaterialColor (const in vec3 N,\n                  const in vec3 vertex,\n                  const in x3d_MaterialParameters material)\n{\n\tvec3 V = normalize (-vertex); // normalized vector from point on geometry to viewer's position\n\n\t// Calculate diffuseFactor & alpha\n\n\tvec3  diffuseFactor = vec3 (0.0);\n\tfloat alpha         = 1.0 - material .transparency;\n\n\tif (x3d_ColorMaterial)\n\t{\n\t\tdiffuseFactor  = x3d_Color .rgb;\n\t\talpha         *= x3d_Color .a;\n\t}\n\telse\n\t\tdiffuseFactor = material .diffuseColor;\n\n\tvec3 ambientTerm = diffuseFactor * material .ambientIntensity;\n\n\t// Apply light sources\n\n\tvec3 finalColor = vec3 (0.0);\n\n\tfor (int i = 0; i < x3d_MaxLights; ++ i)\n\t{\n\t\tif (i == x3d_NumLights)\n\t\t\tbreak;\n\n\t\tx3d_LightSourceParameters light = x3d_LightSource [i];\n\n\t\tvec3  vL = light .location - vertex;\n\t\tfloat dL = length (light .matrix * vL);\n\t\tbool  di = light .type == x3d_DirectionalLight;\n\n\t\tif (di || dL <= light .radius)\n\t\t{\n\t\t\tvec3 d = light .direction;\n\t\t\tvec3 c = light .attenuation;\n\t\t\tvec3 L = di ? -d : normalize (vL);      // Normalized vector from point on geometry to light source i position.\n\t\t\tvec3 H = normalize (L + V);             // Specular term\n\n\t\t\tfloat lightAngle     = dot (N, L);      // Angle between normal and light ray.\n\t\t\tvec3  diffuseTerm    = diffuseFactor * clamp (lightAngle, 0.0, 1.0);\n\t\t\tfloat specularFactor = material .shininess > 0.0 ? pow (max (dot (N, H), 0.0), material .shininess * 128.0) : 1.0;\n\t\t\tvec3  specularTerm   = material .specularColor * specularFactor;\n\n\t\t\tfloat attenuationFactor           = di ? 1.0 : 1.0 / max (c [0] + c [1] * dL + c [2] * (dL * dL), 1.0);\n\t\t\tfloat spotFactor                  = light .type == x3d_SpotLight ? getSpotFactor (light .cutOffAngle, light .beamWidth, L, d) : 1.0;\n\t\t\tfloat attenuationSpotFactor       = attenuationFactor * spotFactor;\n\t\t\tvec3  ambientColor                = light .ambientIntensity * ambientTerm;\n\t\t\tvec3  ambientDiffuseSpecularColor = ambientColor + light .intensity * (diffuseTerm + specularTerm);\n\n\t\t\tfinalColor += attenuationSpotFactor * (light .color * ambientDiffuseSpecularColor);\n\t\t}\n\t}\n\n\tfinalColor += material .emissiveColor;\n\n\treturn vec4 (clamp (finalColor, 0.0, 1.0), alpha);\n}\n\nvoid\nmain ()\n{\n\tvec4 position = x3d_ModelViewMatrix * x3d_Vertex;\n\n\tfogDepth    = x3d_FogDepth;\n\ttexCoord0   = x3d_TextureMatrix [0] * x3d_TexCoord0;\n\ttexCoord1   = x3d_TextureMatrix [1] * x3d_TexCoord1;\n\tvertex      = position .xyz;\n\tnormal      = normalize (x3d_NormalMatrix * x3d_Normal);\n\tlocalNormal = x3d_Normal;\n\tlocalVertex = x3d_Vertex .xyz;\n\n\tgl_Position = x3d_ProjectionMatrix * position;\n\n\t#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n\tdepth = 1.0 + gl_Position .w;\n\t#endif\n\n\tif (x3d_Lighting)\n\t{\n\n\t\tfrontColor = getMaterialColor (normal, vertex, x3d_FrontMaterial);\n\n\t\tx3d_MaterialParameters backMaterial = x3d_FrontMaterial;\n\n\t\tif (x3d_SeparateBackColor)\n\t\t\tbackMaterial = x3d_BackMaterial;\n\n\t\tbackColor = getMaterialColor (-normal, vertex, backMaterial);\n\t}\n\telse\n\t{\n\t   frontColor = backColor = x3d_ColorMaterial ? x3d_Color : vec4 (1.0);\n\t}\n}\n"}),define("text!x_ite/Browser/Shaders/WebGL2/Gouraud.fs",[],function(){return'#version 300 es\n// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nuniform int  x3d_GeometryType;\nuniform bool x3d_Lighting;      // true if a X3DMaterialNode is attached, otherwise false\nuniform bool x3d_ColorMaterial; // true if a X3DColorNode is attached, otherwise false\n\nin float fogDepth;    // fog depth\nin vec4  frontColor;  // color\nin vec4  backColor;   // color\nin vec4  texCoord0;   // texCoord0\nin vec4  texCoord1;   // texCoord1\nin vec3  normal;      // normal vector at this point on geometry\nin vec3  vertex;      // point on geometry\nin vec3  localNormal; // normal vector at this point on geometry in local coordinates\nin vec3  localVertex; // point on geometry in local coordinates\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\nuniform float x3d_LogarithmicFarFactor1_2;\nin float depth;\n#endif\n\nout vec4 x3d_FragColor;\n\n#pragma X3D include "Include/Texture.h"\n#pragma X3D include "Include/Hatch.h"\n#pragma X3D include "Include/Fog.h"\n#pragma X3D include "Include/ClipPlanes.h"\n\nvoid\nmain ()\n{\n \tclip ();\n\n\tvec4 finalColor = gl_FrontFacing ? frontColor : backColor;\n\n\tif (x3d_NumTextures > 0)\n\t{\n\t\tif (x3d_Lighting)\n\t\t{\n\t\t\tfinalColor = getTextureColor (finalColor, vec4 (1.0));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (x3d_ColorMaterial)\n\t\t\t{\n\t\t\t\tfinalColor = getTextureColor (finalColor, vec4 (1.0));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfinalColor = getTextureColor (vec4 (1.0), vec4 (1.0));\n\t\t\t}\n\t\t}\n\t}\n\n\tfinalColor        = getHatchColor (finalColor);\n\tx3d_FragColor .rgb = getFogColor (finalColor .rgb);\n\tx3d_FragColor .a   = finalColor .a;\n\n\t#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n\t//http://outerra.blogspot.com/2013/07/logarithmic-depth-buffer-optimizations.html\n\tif (x3d_LogarithmicFarFactor1_2 > 0.0)\n\t\tgl_FragDepth = log2 (depth) * x3d_LogarithmicFarFactor1_2;\n\telse\n\t\tgl_FragDepth = gl_FragCoord .z;\n\t#endif\n}\n'}),define("text!x_ite/Browser/Shaders/WebGL2/Phong.vs",[],function(){return"#version 300 es\n// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nuniform mat4 x3d_TextureMatrix [x3d_MaxTextures];\nuniform mat3 x3d_NormalMatrix;\nuniform mat4 x3d_ProjectionMatrix;\nuniform mat4 x3d_ModelViewMatrix;\n\nuniform bool x3d_Lighting;  // true if a X3DMaterialNode is attached, otherwise false\n\nin float x3d_FogDepth;\nin vec4  x3d_Color;\nin vec4  x3d_TexCoord0;\nin vec4  x3d_TexCoord1;\nin vec3  x3d_Normal;\nin vec4  x3d_Vertex;\n\nout float fogDepth;    // fog depth\nout vec4  color;       // color\nout vec4  texCoord0;   // texCoord0\nout vec4  texCoord1;   // texCoord1\nout vec3  normal;      // normalized normal vector at this point on geometry\nout vec3  vertex;      // point on geometry\nout vec3  localNormal; // normal vector at this point on geometry in local coordinates\nout vec3  localVertex; // point on geometry in local coordinates\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\nout float depth;\n#endif\n\nvoid\nmain ()\n{\n\tvec4 position = x3d_ModelViewMatrix * x3d_Vertex;\n\n\tfogDepth    = x3d_FogDepth;\n\tcolor       = x3d_Color;\n\ttexCoord0   = x3d_TextureMatrix [0] * x3d_TexCoord0;\n\ttexCoord1   = x3d_TextureMatrix [1] * x3d_TexCoord1;\n\tnormal      = x3d_NormalMatrix * x3d_Normal;\n\tvertex      = position .xyz;\n\tlocalNormal = x3d_Normal;\n\tlocalVertex = x3d_Vertex .xyz;\n\n\tgl_Position = x3d_ProjectionMatrix * position;\n\n\t#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n\tdepth = 1.0 + gl_Position .w;\n\t#endif\n}\n"}),define("text!x_ite/Browser/Shaders/WebGL2/Phong.fs",[],function(){return'#version 300 es\n// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nuniform int x3d_GeometryType;\n\nuniform bool  x3d_Lighting;      // true if a X3DMaterialNode is attached, otherwise false\nuniform bool  x3d_ColorMaterial; // true if a X3DColorNode is attached, otherwise false\n\nuniform int x3d_NumLights;\nuniform x3d_LightSourceParameters x3d_LightSource [x3d_MaxLights];\nuniform bool x3d_SeparateBackColor;\nuniform x3d_MaterialParameters x3d_FrontMaterial;  \nuniform x3d_MaterialParameters x3d_BackMaterial;        \n\nin float fogDepth;    // fog depth\nin vec4  color;       // color\nin vec4  texCoord0;   // texCoord0\nin vec4  texCoord1;   // texCoord1\nin vec3  normal;      // normal vector at this point on geometry\nin vec3  vertex;      // point on geometry\nin vec3  localNormal; // normal vector at this point on geometry in local coordinates\nin vec3  localVertex; // point on geometry in local coordinates\n\n#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\nuniform float x3d_LogarithmicFarFactor1_2;\nin float depth;\n#endif\n\nout vec4 x3d_FragColor;\n\n#pragma X3D include "Include/Shadow.h"\n#pragma X3D include "Include/Texture.h"\n#pragma X3D include "Include/Hatch.h"\n#pragma X3D include "Include/Fog.h"\n#pragma X3D include "Include/ClipPlanes.h"\n\nfloat\ngetSpotFactor (const in float cutOffAngle, const in float beamWidth, const in vec3 L, const in vec3 d)\n{\n\tfloat spotAngle = acos (clamp (dot (-L, d), -1.0, 1.0));\n\t\n\tif (spotAngle >= cutOffAngle)\n\t\treturn 0.0;\n\telse if (spotAngle <= beamWidth)\n\t\treturn 1.0;\n\n\treturn (spotAngle - cutOffAngle) / (beamWidth - cutOffAngle);\n}\n\nvec4\ngetMaterialColor (const in x3d_MaterialParameters material)\n{\n\tif (x3d_Lighting)\n\t{\n\t\tvec3  N  = normalize (gl_FrontFacing ? normal : -normal);\n\t\tvec3  V  = normalize (-vertex); // normalized vector from point on geometry to viewer\'s position\n\t\tfloat dV = length (vertex);\n\n\t\t// Calculate diffuseFactor & alpha\n\n\t\tvec3  diffuseFactor = vec3 (1.0);\n\t\tfloat alpha         = 1.0 - material .transparency;\n\n\t\tif (x3d_ColorMaterial)\n\t\t{\n\t\t\tif (x3d_NumTextures > 0)\n\t\t\t{\n\t\t\t\tvec4 T = getTextureColor (vec4 (color .rgb, color .a * alpha), vec4 (material .specularColor, alpha));\n\n\t\t\t\tdiffuseFactor = T .rgb;\n\t\t\t\talpha         = T .a;\n\t\t\t}\n\t\t\telse\n\t\t\t\tdiffuseFactor = color .rgb;\n\n\t\t\talpha *= color .a;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (x3d_NumTextures > 0)\n\t\t\t{\n\t\t\t\tvec4 T = getTextureColor (vec4 (material .diffuseColor, alpha), vec4 (material .specularColor, alpha));\n\n\t\t\t\tdiffuseFactor = T .rgb;\n\t\t\t\talpha         = T .a;\n\t\t\t}\n\t\t\telse\n\t\t\t\tdiffuseFactor = material .diffuseColor;\n\t\t}\n\n\t\tvec3 ambientTerm = diffuseFactor * material .ambientIntensity;\n\n\t\t// Apply light sources\n\n\t\tvec3 finalColor = vec3 (0.0);\n\n\t\tfor (int i = 0; i < x3d_MaxLights; i ++)\n\t\t{\n\t\t\tif (i == x3d_NumLights)\n\t\t\t\tbreak;\n\n\t\t\tx3d_LightSourceParameters light = x3d_LightSource [i];\n\n\t\t\tvec3  vL = light .location - vertex; // Light to fragment\n\t\t\tfloat dL = length (light .matrix * vL);\n\t\t\tbool  di = light .type == x3d_DirectionalLight;\n\n\t\t\tif (di || dL <= light .radius)\n\t\t\t{\n\t\t\t\tvec3 d = light .direction;\n\t\t\t\tvec3 c = light .attenuation;\n\t\t\t\tvec3 L = di ? -d : normalize (vL);      // Normalized vector from point on geometry to light source i position.\n\t\t\t\tvec3 H = normalize (L + V);             // Specular term\n\n\t\t\t\tfloat lightAngle     = dot (N, L);      // Angle between normal and light ray.\n\t\t\t\tvec3  diffuseTerm    = diffuseFactor * clamp (lightAngle, 0.0, 1.0);\n\t\t\t\tfloat specularFactor = material .shininess > 0.0 ? pow (max (dot (N, H), 0.0), material .shininess * 128.0) : 1.0;\n\t\t\t\tvec3  specularTerm   = material .specularColor * specularFactor;\n\n\t\t\t\tfloat attenuationFactor     = di ? 1.0 : 1.0 / max (c [0] + c [1] * dL + c [2] * (dL * dL), 1.0);\n\t\t\t\tfloat spotFactor            = light .type == x3d_SpotLight ? getSpotFactor (light .cutOffAngle, light .beamWidth, L, d) : 1.0;\n\t\t\t\tfloat attenuationSpotFactor = attenuationFactor * spotFactor;\n\t\t\t\tvec3  ambientColor          = light .color * light .ambientIntensity * ambientTerm;\n\t\t\t\tvec3  diffuseSpecularColor  = light .color * light .intensity * (diffuseTerm + specularTerm);\n\n\t\t\t\t#ifdef X3D_SHADOWS\n\t\t\t\t\tif (lightAngle > 0.0)\n\t\t\t\t\t\tdiffuseSpecularColor = mix (diffuseSpecularColor, light .shadowColor, getShadowIntensity (i, light));\n\t\t\t\t#endif\n\n\t\t\t\tfinalColor += attenuationSpotFactor * (ambientColor + diffuseSpecularColor);\n\t\t\t}\n\t\t}\n\n\t\tfinalColor += material .emissiveColor;\n\n\t\treturn vec4 (finalColor, alpha);\n\t}\n\telse\n\t{\n\t\tvec4 finalColor = vec4 (1.0);\n\t\n\t\tif (x3d_ColorMaterial)\n\t\t{\n\t\t\tif (x3d_NumTextures > 0)\n\t\t\t{\n\t\t\t\tfinalColor = getTextureColor (color, vec4 (1.0));\n\t\t\t}\n\t\t\telse\n\t\t\t\tfinalColor = color;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (x3d_NumTextures > 0)\n\t\t\t\tfinalColor = getTextureColor (vec4 (1.0), vec4 (1.0));\n\t\t}\n\n\t\treturn finalColor;\n\t}\n}\n\n// DEBUG\n//uniform ivec4 x3d_Viewport;\n\nvoid\nmain ()\n{\n\tclip ();\n\n\tbool frontColor = gl_FrontFacing || ! x3d_SeparateBackColor;\n\n\tx3d_FragColor      = frontColor ? getMaterialColor (x3d_FrontMaterial) : getMaterialColor (x3d_BackMaterial);\n\tx3d_FragColor      = getHatchColor (x3d_FragColor);\n\tx3d_FragColor .rgb = getFogColor (x3d_FragColor .rgb);\n\n\t#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n\t//http://outerra.blogspot.com/2013/07/logarithmic-depth-buffer-optimizations.html\n\tif (x3d_LogarithmicFarFactor1_2 > 0.0)\n\t\tgl_FragDepth = log2 (depth) * x3d_LogarithmicFarFactor1_2;\n\telse\n\t\tgl_FragDepth = gl_FragCoord .z;\n\t#endif\n\n\t// DEBUG\n\t#ifdef X3D_SHADOWS\n\t//x3d_FragColor .rgb = texture2D (x3d_ShadowMap [0], gl_FragCoord .xy / vec2 (x3d_Viewport .zw)) .rgb;\n\t//x3d_FragColor .rgb = mix (tex .rgb, x3d_FragColor .rgb, 0.5);\n\t#endif\n\n\t#ifdef X3D_LOGARITHMIC_DEPTH_BUFFER\n\t//x3d_FragColor .rgb = mix (vec3 (1.0, 0.0, 0.0), x3d_FragColor .rgb, 0.5);\n\t#endif\n}\n'}),define("text!x_ite/Browser/Shaders/WebGL2/Depth.vs",[],function(){return"#version 300 es\n// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nuniform mat4 x3d_ProjectionMatrix;\nuniform mat4 x3d_ModelViewMatrix;\n\nin vec4 x3d_Vertex;\n\nout vec3 vertex; // point on geometry\n\nvoid\nmain ()\n{\n\tvec4 position = x3d_ModelViewMatrix * x3d_Vertex;\n\n\tvertex = position .xyz;\n\n\tgl_Position = x3d_ProjectionMatrix * position;\n}\n"}),define("text!x_ite/Browser/Shaders/WebGL2/Depth.fs",[],function(){return'#version 300 es\n// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nin vec3 vertex; // point on geometry\n\nout vec4 x3d_FragColor;\n\n#pragma X3D include "Include/Pack.h"\n#pragma X3D include "Include/ClipPlanes.h"\n\nvoid\nmain ()\n{\n\tclip ();\n\n\tx3d_FragColor = pack (gl_FragCoord .z);\n}\n'}),define("text!x_ite/Browser/Shaders/WebGL1/Tests/SamplerTest.fs",[],function(){return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nuniform sampler2D texture [2];\n\nvec4\ngetColor ()\n{\n\tvec4 textureColor = vec4 (0.0);\n\n\tfor (int i = 0; i < 2; ++ i)\n\t\ttextureColor += texture2D (texture [i], vec2 (0.0));\n\n\treturn textureColor;\n}\n\nvoid\nmain ()\n{\n\tgl_FragColor = getColor ();\n}\n"}),define("text!x_ite/Browser/Shaders/WebGL2/Tests/SamplerTest.fs",[],function(){return"#version 300 es\n// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nuniform sampler2D tex [2];\n\nout vec4 x3d_FragColor;\n\nvec4\ngetColor ()\n{\n\tvec4 textureColor = vec4 (0.0);\n\n\tfor (int i = 0; i < 2; ++ i)\n\t\ttextureColor += texture (tex [i], vec2 (0.0));\n\n\treturn textureColor;\n}\n\nvoid\nmain ()\n{\n\tx3d_FragColor = getColor ();\n}\n"}),define("standard/Math/Geometry/Plane3",["standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(t,e){"use strict";function n(t,e){this.normal=e.copy(),this.distanceFromOrigin=e.dot(t)}var i=new t(0,0,0),r=new t(0,0,0),o=new e;return n.prototype={constructor:n,copy:function(){var t=Object.create(n.prototype);return t.normal=this.normal.copy(),t.distanceFromOrigin=this.distanceFromOrigin,t},assign:function(t){return this.normal.assign(t.normal),this.distanceFromOrigin=t.distanceFromOrigin,this},set:function(t,e){return this.normal.assign(e),this.distanceFromOrigin=e.dot(t),this},multRight:function(t){return r.assign(this.normal).multiply(this.distanceFromOrigin),o.assign(t).inverse(),o.multMatrixDir(i.assign(this.normal)).normalize(),t.multVecMatrix(r),this.normal.assign(i),this.distanceFromOrigin=i.dot(r),this},multLeft:function(t){return r.assign(this.normal).multiply(this.distanceFromOrigin),o.assign(t).inverse(),o.multDirMatrix(i.assign(this.normal)).normalize(),t.multMatrixVec(r),this.normal.assign(i),this.distanceFromOrigin=i.dot(r),this},getDistanceToPoint:function(e){return t.dot(e,this.normal)-this.distanceFromOrigin},intersectsLine:function(t,e){var n=t.point,i=t.direction,r=i.dot(this.normal);if(0===r)return!1;var o=(this.distanceFromOrigin-this.normal.dot(n))/r;return e.x=n.x+i.x*o,e.y=n.y+i.y*o,e.z=n.z+i.z*o,!0},toString:function(){return this.normal.toString()+" "+this.distanceFromOrigin}},n});var libtess={};libtess.DEBUG=!1,libtess.assert=function(t,e){if(libtess.DEBUG&&!t)throw new Error("Assertion failed"+(e?": "+e:""))},libtess.GLU_TESS_MAX_COORD=1e150,libtess.TRUE_PROJECT=!1,libtess.GLU_TESS_DEFAULT_TOLERANCE=0,libtess.windingRule={GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},libtess.primitiveType={GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},libtess.errorType={GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},libtess.gluEnum={GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111,GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901},libtess.PQHandle,libtess.geom={},libtess.geom.vertEq=function(t,e){return t.s===e.s&&t.t===e.t},libtess.geom.vertLeq=function(t,e){return t.s<e.s||t.s===e.s&&t.t<=e.t},libtess.geom.edgeEval=function(t,e,n){var i=e.s-t.s,r=n.s-e.s;return i+r>0?i<r?e.t-t.t+(t.t-n.t)*(i/(i+r)):e.t-n.t+(n.t-t.t)*(r/(i+r)):0},libtess.geom.edgeSign=function(t,e,n){var i=e.s-t.s,r=n.s-e.s;return i+r>0?(e.t-n.t)*i+(e.t-t.t)*r:0},libtess.geom.transLeq=function(t,e){return t.t<e.t||t.t===e.t&&t.s<=e.s},libtess.geom.transEval=function(t,e,n){var i=e.t-t.t,r=n.t-e.t;return i+r>0?i<r?e.s-t.s+(t.s-n.s)*(i/(i+r)):e.s-n.s+(n.s-t.s)*(r/(i+r)):0},libtess.geom.transSign=function(t,e,n){var i=e.t-t.t,r=n.t-e.t;return i+r>0?(e.s-n.s)*i+(e.s-t.s)*r:0},libtess.geom.edgeGoesLeft=function(t){return libtess.geom.vertLeq(t.dst(),t.org)},libtess.geom.edgeGoesRight=function(t){return libtess.geom.vertLeq(t.org,t.dst())},libtess.geom.vertL1dist=function(t,e){return Math.abs(t.s-e.s)+Math.abs(t.t-e.t)},libtess.geom.vertCCW=function(t,e,n){return t.s*(e.t-n.t)+e.s*(n.t-t.t)+n.s*(t.t-e.t)>=0},libtess.geom.interpolate_=function(t,e,n,i){return t=t<0?0:t,n=n<0?0:n,t<=n?0===n?(e+i)/2:e+t/(t+n)*(i-e):i+n/(t+n)*(e-i)},libtess.geom.edgeIntersect=function(t,e,n,i,r){var o,s,a;libtess.geom.vertLeq(t,e)||(a=t,t=e,e=a),libtess.geom.vertLeq(n,i)||(a=n,n=i,i=a),libtess.geom.vertLeq(t,n)||(a=t,t=n,n=a,a=e,e=i,i=a),libtess.geom.vertLeq(n,e)?libtess.geom.vertLeq(e,i)?(o=libtess.geom.edgeEval(t,n,e),s=libtess.geom.edgeEval(n,e,i),o+s<0&&(o=-o,s=-s),r.s=libtess.geom.interpolate_(o,n.s,s,e.s)):(o=libtess.geom.edgeSign(t,n,e),s=-libtess.geom.edgeSign(t,i,e),o+s<0&&(o=-o,s=-s),r.s=libtess.geom.interpolate_(o,n.s,s,i.s)):r.s=(n.s+e.s)/2,libtess.geom.transLeq(t,e)||(a=t,t=e,e=a),libtess.geom.transLeq(n,i)||(a=n,n=i,i=a),libtess.geom.transLeq(t,n)||(a=t,t=n,n=a,a=e,e=i,i=a),libtess.geom.transLeq(n,e)?libtess.geom.transLeq(e,i)?(o=libtess.geom.transEval(t,n,e),s=libtess.geom.transEval(n,e,i),o+s<0&&(o=-o,s=-s),r.t=libtess.geom.interpolate_(o,n.t,s,e.t)):(o=libtess.geom.transSign(t,n,e),s=-libtess.geom.transSign(t,i,e),o+s<0&&(o=-o,s=-s),r.t=libtess.geom.interpolate_(o,n.t,s,i.t)):r.t=(n.t+e.t)/2},libtess.mesh={},libtess.mesh.makeEdge=function(t){var e=libtess.mesh.makeEdgePair_(t.eHead);return libtess.mesh.makeVertex_(e,t.vHead),libtess.mesh.makeVertex_(e.sym,t.vHead),libtess.mesh.makeFace_(e,t.fHead),e},libtess.mesh.meshSplice=function(t,e){var n=!1,i=!1;t!==e&&(e.org!==t.org&&(i=!0,libtess.mesh.killVertex_(e.org,t.org)),e.lFace!==t.lFace&&(n=!0,libtess.mesh.killFace_(e.lFace,t.lFace)),libtess.mesh.splice_(e,t),i||(libtess.mesh.makeVertex_(e,t.org),t.org.anEdge=t),n||(libtess.mesh.makeFace_(e,t.lFace),t.lFace.anEdge=t))},libtess.mesh.deleteEdge=function(t){var e=t.sym,n=!1;t.lFace!==t.rFace()&&(n=!0,libtess.mesh.killFace_(t.lFace,t.rFace())),t.oNext===t?libtess.mesh.killVertex_(t.org,null):(t.rFace().anEdge=t.oPrev(),t.org.anEdge=t.oNext,libtess.mesh.splice_(t,t.oPrev()),n||libtess.mesh.makeFace_(t,t.lFace)),e.oNext===e?(libtess.mesh.killVertex_(e.org,null),libtess.mesh.killFace_(e.lFace,null)):(t.lFace.anEdge=e.oPrev(),e.org.anEdge=e.oNext,libtess.mesh.splice_(e,e.oPrev())),libtess.mesh.killEdge_(t)},libtess.mesh.addEdgeVertex=function(t){var e=libtess.mesh.makeEdgePair_(t),n=e.sym;return libtess.mesh.splice_(e,t.lNext),e.org=t.dst(),libtess.mesh.makeVertex_(n,e.org),e.lFace=n.lFace=t.lFace,e},libtess.mesh.splitEdge=function(t){var e=libtess.mesh.addEdgeVertex(t),n=e.sym;return libtess.mesh.splice_(t.sym,t.sym.oPrev()),libtess.mesh.splice_(t.sym,n),t.sym.org=n.org,n.dst().anEdge=n.sym,n.sym.lFace=t.rFace(),n.winding=t.winding,n.sym.winding=t.sym.winding,n},libtess.mesh.connect=function(t,e){var n=!1,i=libtess.mesh.makeEdgePair_(t),r=i.sym;return e.lFace!==t.lFace&&(n=!0,libtess.mesh.killFace_(e.lFace,t.lFace)),libtess.mesh.splice_(i,t.lNext),libtess.mesh.splice_(r,e),i.org=t.dst(),r.org=e.org,i.lFace=r.lFace=t.lFace,t.lFace.anEdge=r,n||libtess.mesh.makeFace_(i,t.lFace),i},libtess.mesh.zapFace=function(t){var e,n=t.anEdge,i=n.lNext;do if(e=i,i=e.lNext,e.lFace=null,null===e.rFace()){e.oNext===e?libtess.mesh.killVertex_(e.org,null):(e.org.anEdge=e.oNext,libtess.mesh.splice_(e,e.oPrev()));var r=e.sym;r.oNext===r?libtess.mesh.killVertex_(r.org,null):(r.org.anEdge=r.oNext,libtess.mesh.splice_(r,r.oPrev())),libtess.mesh.killEdge_(e)}while(e!==n)var o=t.prev,s=t.next;s.prev=o,o.next=s},libtess.mesh.meshUnion=function(t,e){var n=t.fHead,i=t.vHead,r=t.eHead,o=e.fHead,s=e.vHead,a=e.eHead;return o.next!==o&&(n.prev.next=o.next,o.next.prev=n.prev,o.prev.next=n,n.prev=o.prev),s.next!==s&&(i.prev.next=s.next,s.next.prev=i.prev,s.prev.next=i,i.prev=s.prev),a.next!==a&&(r.sym.next.sym.next=a.next,a.next.sym.next=r.sym.next,a.sym.next.sym.next=r,r.sym.next=a.sym.next),t},libtess.mesh.deleteMesh=function(t){},libtess.mesh.makeEdgePair_=function(t){var e=new libtess.GluHalfEdge,n=new libtess.GluHalfEdge,i=t.sym.next;return n.next=i,i.sym.next=e,e.next=t,t.sym.next=n,e.sym=n,e.oNext=e,e.lNext=n,n.sym=e,n.oNext=n,n.lNext=e,e},libtess.mesh.splice_=function(t,e){var n=t.oNext,i=e.oNext;n.sym.lNext=e,i.sym.lNext=t,t.oNext=i,e.oNext=n},libtess.mesh.makeVertex_=function(t,e){var n=e.prev,i=new libtess.GluVertex(e,n);n.next=i,e.prev=i,i.anEdge=t;var r=t;do r.org=i,r=r.oNext;while(r!==t)},libtess.mesh.makeFace_=function(t,e){var n=e.prev,i=new libtess.GluFace(e,n);n.next=i,e.prev=i,i.anEdge=t,i.inside=e.inside;var r=t;do r.lFace=i,r=r.lNext;while(r!==t)},libtess.mesh.killEdge_=function(t){var e=t.next,n=t.sym.next;e.sym.next=n,n.sym.next=e},libtess.mesh.killVertex_=function(t,e){var n=t.anEdge,i=n;do i.org=e,i=i.oNext;while(i!==n)var r=t.prev,o=t.next;o.prev=r,r.next=o},libtess.mesh.killFace_=function(t,e){var n=t.anEdge,i=n;do i.lFace=e,i=i.lNext;while(i!==n)var r=t.prev,o=t.next;o.prev=r,r.next=o},libtess.normal={},libtess.normal.S_UNIT_X_=1,libtess.normal.S_UNIT_Y_=0,libtess.normal.projectPolygon=function(t,e,n,i){var r=!1,o=[e,n,i];0===e&&0===n&&0===i&&(libtess.normal.computeNormal_(t,o),r=!0);var s,a=libtess.normal.longAxis_(o),u=t.mesh.vHead;if(libtess.TRUE_PROJECT){libtess.normal.normalize_(o);var l=[0,0,0],c=[0,0,0];l[a]=0,l[(a+1)%3]=libtess.normal.S_UNIT_X_,l[(a+2)%3]=libtess.normal.S_UNIT_Y_;var h=libtess.normal.dot_(l,o);for(l[0]-=h*o[0],l[1]-=h*o[1],l[2]-=h*o[2],libtess.normal.normalize_(l),c[0]=o[1]*l[2]-o[2]*l[1],c[1]=o[2]*l[0]-o[0]*l[2],c[2]=o[0]*l[1]-o[1]*l[0],libtess.normal.normalize_(c),s=u.next;s!==u;s=s.next)s.s=libtess.normal.dot_(s.coords,l),s.t=libtess.normal.dot_(s.coords,c)}else{var d=(a+1)%3,p=(a+2)%3,f=o[a]>0?1:-1;for(s=u.next;s!==u;s=s.next)s.s=s.coords[d],s.t=f*s.coords[p]}r&&libtess.normal.checkOrientation_(t)},libtess.normal.dot_=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},libtess.normal.normalize_=function(t){var e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];e=Math.sqrt(e),t[0]/=e,t[1]/=e,t[2]/=e},libtess.normal.longAxis_=function(t){var e=0;return Math.abs(t[1])>Math.abs(t[0])&&(e=1),Math.abs(t[2])>Math.abs(t[e])&&(e=2),e},libtess.normal.computeNormal_=function(t,e){var n,i=[-2*libtess.GLU_TESS_MAX_COORD,-2*libtess.GLU_TESS_MAX_COORD,-2*libtess.GLU_TESS_MAX_COORD],r=[2*libtess.GLU_TESS_MAX_COORD,2*libtess.GLU_TESS_MAX_COORD,2*libtess.GLU_TESS_MAX_COORD],o=[],s=[],a=t.mesh.vHead;for(n=a.next;n!==a;n=n.next)for(var u=0;u<3;++u){var l=n.coords[u];l<r[u]&&(r[u]=l,s[u]=n),l>i[u]&&(i[u]=l,o[u]=n)}var c=0;if(i[1]-r[1]>i[0]-r[0]&&(c=1),i[2]-r[2]>i[c]-r[c]&&(c=2),
r[c]>=i[c])return e[0]=0,e[1]=0,void(e[2]=1);var h=0,d=s[c],p=o[c],f=[0,0,0],g=[d.coords[0]-p.coords[0],d.coords[1]-p.coords[1],d.coords[2]-p.coords[2]],m=[0,0,0];for(n=a.next;n!==a;n=n.next){m[0]=n.coords[0]-p.coords[0],m[1]=n.coords[1]-p.coords[1],m[2]=n.coords[2]-p.coords[2],f[0]=g[1]*m[2]-g[2]*m[1],f[1]=g[2]*m[0]-g[0]*m[2],f[2]=g[0]*m[1]-g[1]*m[0];var x=f[0]*f[0]+f[1]*f[1]+f[2]*f[2];x>h&&(h=x,e[0]=f[0],e[1]=f[1],e[2]=f[2])}h<=0&&(e[0]=e[1]=e[2]=0,e[libtess.normal.longAxis_(g)]=1)},libtess.normal.checkOrientation_=function(t){for(var e=0,n=t.mesh.fHead,i=n.next;i!==n;i=i.next){var r=i.anEdge;if(!(r.winding<=0))do e+=(r.org.s-r.dst().s)*(r.org.t+r.dst().t),r=r.lNext;while(r!==i.anEdge)}if(e<0)for(var o=t.mesh.vHead,s=o.next;s!==o;s=s.next)s.t=-s.t},libtess.render={},libtess.render.renderMesh=function(t,e,n){for(var i=!1,r=-1,o=e.fHead.prev;o!==e.fHead;o=o.prev)if(o.inside){i||(t.callBeginCallback(libtess.primitiveType.GL_TRIANGLES),i=!0);var s=o.anEdge;do{if(n){var a=s.rFace().inside?0:1;r!==a&&(r=a,t.callEdgeFlagCallback(!!r))}t.callVertexCallback(s.org.data),s=s.lNext}while(s!==o.anEdge)}i&&t.callEndCallback()},libtess.render.renderBoundary=function(t,e){for(var n=e.fHead.next;n!==e.fHead;n=n.next)if(n.inside){t.callBeginCallback(libtess.primitiveType.GL_LINE_LOOP);var i=n.anEdge;do t.callVertexCallback(i.org.data),i=i.lNext;while(i!==n.anEdge)t.callEndCallback()}},libtess.sweep={},libtess.sweep.SENTINEL_COORD_=4*libtess.GLU_TESS_MAX_COORD,libtess.sweep.TOLERANCE_NONZERO_=!1,libtess.sweep.computeInterior=function(t){t.fatalError=!1,libtess.sweep.removeDegenerateEdges_(t),libtess.sweep.initPriorityQ_(t),libtess.sweep.initEdgeDict_(t);for(var e;null!==(e=t.pq.extractMin());){for(;;){var n=t.pq.minimum();if(null===n||!libtess.geom.vertEq(n,e))break;n=t.pq.extractMin(),libtess.sweep.spliceMergeVertices_(t,e.anEdge,n.anEdge)}libtess.sweep.sweepEvent_(t,e)}var i=t.dict.getMin().getKey();t.event=i.eUp.org,libtess.sweep.doneEdgeDict_(t),libtess.sweep.donePriorityQ_(t),libtess.sweep.removeDegenerateFaces_(t.mesh),t.mesh.checkMesh()},libtess.sweep.addWinding_=function(t,e){t.winding+=e.winding,t.sym.winding+=e.sym.winding},libtess.sweep.edgeLeq_=function(t,e,n){var i=t.event,r=e.eUp,o=n.eUp;return r.dst()===i?o.dst()===i?libtess.geom.vertLeq(r.org,o.org)?libtess.geom.edgeSign(o.dst(),r.org,o.org)<=0:libtess.geom.edgeSign(r.dst(),o.org,r.org)>=0:libtess.geom.edgeSign(o.dst(),i,o.org)<=0:o.dst()===i?libtess.geom.edgeSign(r.dst(),i,r.org)>=0:libtess.geom.edgeEval(r.dst(),i,r.org)>=libtess.geom.edgeEval(o.dst(),i,o.org)},libtess.sweep.deleteRegion_=function(t,e){e.fixUpperEdge,e.eUp.activeRegion=null,t.dict.deleteNode(e.nodeUp),e.nodeUp=null},libtess.sweep.fixUpperEdge_=function(t,e){libtess.mesh.deleteEdge(t.eUp),t.fixUpperEdge=!1,t.eUp=e,e.activeRegion=t},libtess.sweep.topLeftRegion_=function(t){var e=t.eUp.org;do t=t.regionAbove();while(t.eUp.org===e)if(t.fixUpperEdge){var n=libtess.mesh.connect(t.regionBelow().eUp.sym,t.eUp.lNext);libtess.sweep.fixUpperEdge_(t,n),t=t.regionAbove()}return t},libtess.sweep.topRightRegion_=function(t){var e=t.eUp.dst();do t=t.regionAbove();while(t.eUp.dst()===e)return t},libtess.sweep.addRegionBelow_=function(t,e,n){var i=new libtess.ActiveRegion;return i.eUp=n,i.nodeUp=t.dict.insertBefore(e.nodeUp,i),n.activeRegion=i,i},libtess.sweep.isWindingInside_=function(t,e){switch(t.windingRule){case libtess.windingRule.GLU_TESS_WINDING_ODD:return 0!=(1&e);case libtess.windingRule.GLU_TESS_WINDING_NONZERO:return 0!==e;case libtess.windingRule.GLU_TESS_WINDING_POSITIVE:return e>0;case libtess.windingRule.GLU_TESS_WINDING_NEGATIVE:return e<0;case libtess.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return e>=2||e<=-2}return!1},libtess.sweep.computeWinding_=function(t,e){e.windingNumber=e.regionAbove().windingNumber+e.eUp.winding,e.inside=libtess.sweep.isWindingInside_(t,e.windingNumber)},libtess.sweep.finishRegion_=function(t,e){var n=e.eUp,i=n.lFace;i.inside=e.inside,i.anEdge=n,libtess.sweep.deleteRegion_(t,e)},libtess.sweep.finishLeftRegions_=function(t,e,n){for(var i=e,r=e.eUp;i!==n;){i.fixUpperEdge=!1;var o=i.regionBelow(),s=o.eUp;if(s.org!==r.org){if(!o.fixUpperEdge){libtess.sweep.finishRegion_(t,i);break}s=libtess.mesh.connect(r.lPrev(),s.sym),libtess.sweep.fixUpperEdge_(o,s)}r.oNext!==s&&(libtess.mesh.meshSplice(s.oPrev(),s),libtess.mesh.meshSplice(r,s)),libtess.sweep.finishRegion_(t,i),r=o.eUp,i=o}return r},libtess.sweep.addRightEdges_=function(t,e,n,i,r,o){var s=!0,a=n;do libtess.sweep.addRegionBelow_(t,e,a.sym),a=a.oNext;while(a!==i)null===r&&(r=e.regionBelow().eUp.rPrev());for(var u,l=e,c=r;u=l.regionBelow(),a=u.eUp.sym,a.org===c.org;)a.oNext!==c&&(libtess.mesh.meshSplice(a.oPrev(),a),libtess.mesh.meshSplice(c.oPrev(),a)),u.windingNumber=l.windingNumber-a.winding,u.inside=libtess.sweep.isWindingInside_(t,u.windingNumber),l.dirty=!0,!s&&libtess.sweep.checkForRightSplice_(t,l)&&(libtess.sweep.addWinding_(a,c),libtess.sweep.deleteRegion_(t,l),libtess.mesh.deleteEdge(c)),s=!1,l=u,c=a;l.dirty=!0,o&&libtess.sweep.walkDirtyRegions_(t,l)},libtess.sweep.callCombine_=function(t,e,n,i,r){var o=[e.coords[0],e.coords[1],e.coords[2]];e.data=null,e.data=t.callCombineCallback(o,n,i),null===e.data&&(r?t.fatalError||(t.callErrorCallback(libtess.errorType.GLU_TESS_NEED_COMBINE_CALLBACK),t.fatalError=!0):e.data=n[0])},libtess.sweep.spliceMergeVertices_=function(t,e,n){var i=[null,null,null,null],r=[.5,.5,0,0];i[0]=e.org.data,i[1]=n.org.data,libtess.sweep.callCombine_(t,e.org,i,r,!1),libtess.mesh.meshSplice(e,n)},libtess.sweep.vertexWeights_=function(t,e,n,i,r){var o=libtess.geom.vertL1dist(e,t),s=libtess.geom.vertL1dist(n,t),a=r,u=r+1;i[a]=.5*s/(o+s),i[u]=.5*o/(o+s),t.coords[0]+=i[a]*e.coords[0]+i[u]*n.coords[0],t.coords[1]+=i[a]*e.coords[1]+i[u]*n.coords[1],t.coords[2]+=i[a]*e.coords[2]+i[u]*n.coords[2]},libtess.sweep.getIntersectData_=function(t,e,n,i,r,o){var s=[0,0,0,0],a=[n.data,i.data,r.data,o.data];e.coords[0]=e.coords[1]=e.coords[2]=0,libtess.sweep.vertexWeights_(e,n,i,s,0),libtess.sweep.vertexWeights_(e,r,o,s,2),libtess.sweep.callCombine_(t,e,a,s,!0)},libtess.sweep.checkForRightSplice_=function(t,e){var n=e.regionBelow(),i=e.eUp,r=n.eUp;if(libtess.geom.vertLeq(i.org,r.org)){if(libtess.geom.edgeSign(r.dst(),i.org,r.org)>0)return!1;libtess.geom.vertEq(i.org,r.org)?i.org!==r.org&&(t.pq.remove(i.org.pqHandle),libtess.sweep.spliceMergeVertices_(t,r.oPrev(),i)):(libtess.mesh.splitEdge(r.sym),libtess.mesh.meshSplice(i,r.oPrev()),e.dirty=n.dirty=!0)}else{if(libtess.geom.edgeSign(i.dst(),r.org,i.org)<0)return!1;e.regionAbove().dirty=e.dirty=!0,libtess.mesh.splitEdge(i.sym),libtess.mesh.meshSplice(r.oPrev(),i)}return!0},libtess.sweep.checkForLeftSplice_=function(t,e){var n,i=e.regionBelow(),r=e.eUp,o=i.eUp;if(libtess.geom.vertLeq(r.dst(),o.dst())){if(libtess.geom.edgeSign(r.dst(),o.dst(),r.org)<0)return!1;e.regionAbove().dirty=e.dirty=!0,n=libtess.mesh.splitEdge(r),libtess.mesh.meshSplice(o.sym,n),n.lFace.inside=e.inside}else{if(libtess.geom.edgeSign(o.dst(),r.dst(),o.org)>0)return!1;e.dirty=i.dirty=!0,n=libtess.mesh.splitEdge(o),libtess.mesh.meshSplice(r.lNext,o.sym),n.rFace().inside=e.inside}return!0},libtess.sweep.checkForIntersect_=function(t,e){var n=e.regionBelow(),i=e.eUp,r=n.eUp,o=i.org,s=r.org,a=i.dst(),u=r.dst(),l=new libtess.GluVertex;if(o===s)return!1;if(Math.min(o.t,a.t)>Math.max(s.t,u.t))return!1;if(libtess.geom.vertLeq(o,s)){if(libtess.geom.edgeSign(u,o,s)>0)return!1}else if(libtess.geom.edgeSign(a,s,o)<0)return!1;libtess.geom.edgeIntersect(a,o,u,s,l),libtess.geom.vertLeq(l,t.event)&&(l.s=t.event.s,l.t=t.event.t);var c=libtess.geom.vertLeq(o,s)?o:s;if(libtess.geom.vertLeq(c,l)&&(l.s=c.s,l.t=c.t),libtess.geom.vertEq(l,o)||libtess.geom.vertEq(l,s))return libtess.sweep.checkForRightSplice_(t,e),!1;if(!libtess.geom.vertEq(a,t.event)&&libtess.geom.edgeSign(a,t.event,l)>=0||!libtess.geom.vertEq(u,t.event)&&libtess.geom.edgeSign(u,t.event,l)<=0){if(u===t.event)return libtess.mesh.splitEdge(i.sym),libtess.mesh.meshSplice(r.sym,i),e=libtess.sweep.topLeftRegion_(e),i=e.regionBelow().eUp,libtess.sweep.finishLeftRegions_(t,e.regionBelow(),n),libtess.sweep.addRightEdges_(t,e,i.oPrev(),i,i,!0),!0;if(a===t.event){libtess.mesh.splitEdge(r.sym),libtess.mesh.meshSplice(i.lNext,r.oPrev()),n=e,e=libtess.sweep.topRightRegion_(e);var h=e.regionBelow().eUp.rPrev();return n.eUp=r.oPrev(),r=libtess.sweep.finishLeftRegions_(t,n,null),libtess.sweep.addRightEdges_(t,e,r.oNext,i.rPrev(),h,!0),!0}return libtess.geom.edgeSign(a,t.event,l)>=0&&(e.regionAbove().dirty=e.dirty=!0,libtess.mesh.splitEdge(i.sym),i.org.s=t.event.s,i.org.t=t.event.t),libtess.geom.edgeSign(u,t.event,l)<=0&&(e.dirty=n.dirty=!0,libtess.mesh.splitEdge(r.sym),r.org.s=t.event.s,r.org.t=t.event.t),!1}return libtess.mesh.splitEdge(i.sym),libtess.mesh.splitEdge(r.sym),libtess.mesh.meshSplice(r.oPrev(),i),i.org.s=l.s,i.org.t=l.t,i.org.pqHandle=t.pq.insert(i.org),libtess.sweep.getIntersectData_(t,i.org,o,a,s,u),e.regionAbove().dirty=e.dirty=n.dirty=!0,!1},libtess.sweep.walkDirtyRegions_=function(t,e){for(var n=e.regionBelow();;){for(;n.dirty;)e=n,n=n.regionBelow();if(!e.dirty&&(n=e,null===(e=e.regionAbove())||!e.dirty))return;e.dirty=!1;var i=e.eUp,r=n.eUp;if(i.dst()!==r.dst()&&libtess.sweep.checkForLeftSplice_(t,e)&&(n.fixUpperEdge?(libtess.sweep.deleteRegion_(t,n),libtess.mesh.deleteEdge(r),n=e.regionBelow(),r=n.eUp):e.fixUpperEdge&&(libtess.sweep.deleteRegion_(t,e),libtess.mesh.deleteEdge(i),e=n.regionAbove(),i=e.eUp)),i.org!==r.org)if(i.dst()===r.dst()||e.fixUpperEdge||n.fixUpperEdge||i.dst()!==t.event&&r.dst()!==t.event)libtess.sweep.checkForRightSplice_(t,e);else if(libtess.sweep.checkForIntersect_(t,e))return;i.org===r.org&&i.dst()===r.dst()&&(libtess.sweep.addWinding_(r,i),libtess.sweep.deleteRegion_(t,e),libtess.mesh.deleteEdge(i),e=n.regionAbove())}},libtess.sweep.connectRightVertex_=function(t,e,n){var i=n.oNext,r=e.regionBelow(),o=e.eUp,s=r.eUp,a=!1;if(o.dst()!==s.dst()&&libtess.sweep.checkForIntersect_(t,e),libtess.geom.vertEq(o.org,t.event)&&(libtess.mesh.meshSplice(i.oPrev(),o),e=libtess.sweep.topLeftRegion_(e),i=e.regionBelow().eUp,libtess.sweep.finishLeftRegions_(t,e.regionBelow(),r),a=!0),libtess.geom.vertEq(s.org,t.event)&&(libtess.mesh.meshSplice(n,s.oPrev()),n=libtess.sweep.finishLeftRegions_(t,r,null),a=!0),a)return void libtess.sweep.addRightEdges_(t,e,n.oNext,i,i,!0);var u;u=libtess.geom.vertLeq(s.org,o.org)?s.oPrev():o,u=libtess.mesh.connect(n.lPrev(),u),libtess.sweep.addRightEdges_(t,e,u,u.oNext,u.oNext,!1),u.sym.activeRegion.fixUpperEdge=!0,libtess.sweep.walkDirtyRegions_(t,e)},libtess.sweep.connectLeftDegenerate_=function(t,e,n){var i=e.eUp;if(libtess.geom.vertEq(i.org,n))return void(libtess.sweep.TOLERANCE_NONZERO_&&libtess.sweep.spliceMergeVertices_(t,i,n.anEdge));if(!libtess.geom.vertEq(i.dst(),n))return libtess.mesh.splitEdge(i.sym),e.fixUpperEdge&&(libtess.mesh.deleteEdge(i.oNext),e.fixUpperEdge=!1),libtess.mesh.meshSplice(n.anEdge,i),void libtess.sweep.sweepEvent_(t,n);if(libtess.sweep.TOLERANCE_NONZERO_){e=libtess.sweep.topRightRegion_(e);var r=e.regionBelow(),o=r.eUp.sym,s=o.oNext,a=s;r.fixUpperEdge&&(libtess.sweep.deleteRegion_(t,r),libtess.mesh.deleteEdge(o),o=s.oPrev()),libtess.mesh.meshSplice(n.anEdge,o),libtess.geom.edgeGoesLeft(s)||(s=null),libtess.sweep.addRightEdges_(t,e,o.oNext,a,s,!0)}},libtess.sweep.connectLeftVertex_=function(t,e){var n=new libtess.ActiveRegion;n.eUp=e.anEdge.sym;var i=t.dict.search(n).getKey(),r=i.regionBelow(),o=i.eUp,s=r.eUp;if(0===libtess.geom.edgeSign(o.dst(),e,o.org))return void libtess.sweep.connectLeftDegenerate_(t,i,e);var a,u=libtess.geom.vertLeq(s.dst(),o.dst())?i:r;if(i.inside||u.fixUpperEdge){if(u===i)a=libtess.mesh.connect(e.anEdge.sym,o.lNext);else{a=libtess.mesh.connect(s.dNext(),e.anEdge).sym}u.fixUpperEdge?libtess.sweep.fixUpperEdge_(u,a):libtess.sweep.computeWinding_(t,libtess.sweep.addRegionBelow_(t,i,a)),libtess.sweep.sweepEvent_(t,e)}else libtess.sweep.addRightEdges_(t,i,e.anEdge,e.anEdge,null,!0)},libtess.sweep.sweepEvent_=function(t,e){t.event=e;for(var n=e.anEdge;null===n.activeRegion;)if((n=n.oNext)===e.anEdge)return void libtess.sweep.connectLeftVertex_(t,e);var i=libtess.sweep.topLeftRegion_(n.activeRegion),r=i.regionBelow(),o=r.eUp,s=libtess.sweep.finishLeftRegions_(t,r,null);s.oNext===o?libtess.sweep.connectRightVertex_(t,i,s):libtess.sweep.addRightEdges_(t,i,s.oNext,o,o,!0)},libtess.sweep.addSentinel_=function(t,e){var n=new libtess.ActiveRegion,i=libtess.mesh.makeEdge(t.mesh);i.org.s=libtess.sweep.SENTINEL_COORD_,i.org.t=e,i.dst().s=-libtess.sweep.SENTINEL_COORD_,i.dst().t=e,t.event=i.dst(),n.eUp=i,n.windingNumber=0,n.inside=!1,n.fixUpperEdge=!1,n.sentinel=!0,n.dirty=!1,n.nodeUp=t.dict.insert(n)},libtess.sweep.initEdgeDict_=function(t){t.dict=new libtess.Dict(t,libtess.sweep.edgeLeq_),libtess.sweep.addSentinel_(t,-libtess.sweep.SENTINEL_COORD_),libtess.sweep.addSentinel_(t,libtess.sweep.SENTINEL_COORD_)},libtess.sweep.doneEdgeDict_=function(t){for(var e;null!==(e=t.dict.getMin().getKey());)e.sentinel,libtess.sweep.deleteRegion_(t,e);t.dict=null},libtess.sweep.removeDegenerateEdges_=function(t){for(var e,n=t.mesh.eHead,i=n.next;i!==n;i=e){e=i.next;var r=i.lNext;libtess.geom.vertEq(i.org,i.dst())&&i.lNext.lNext!==i&&(libtess.sweep.spliceMergeVertices_(t,r,i),libtess.mesh.deleteEdge(i),i=r,r=i.lNext),r.lNext===i&&(r!==i&&(r!==e&&r!==e.sym||(e=e.next),libtess.mesh.deleteEdge(r)),i!==e&&i!==e.sym||(e=e.next),libtess.mesh.deleteEdge(i))}},libtess.sweep.initPriorityQ_=function(t){var e=new libtess.PriorityQ;t.pq=e;var n,i=t.mesh.vHead;for(n=i.next;n!==i;n=n.next)n.pqHandle=e.insert(n);e.init()},libtess.sweep.donePriorityQ_=function(t){t.pq.deleteQ(),t.pq=null},libtess.sweep.removeDegenerateFaces_=function(t){for(var e,n=t.fHead.next;n!==t.fHead;n=e){e=n.next;var i=n.anEdge;i.lNext.lNext===i&&(libtess.sweep.addWinding_(i.oNext,i),libtess.mesh.deleteEdge(i))}},libtess.tessmono={},libtess.tessmono.tessellateMonoRegion_=function(t){for(var e=t.anEdge;libtess.geom.vertLeq(e.dst(),e.org);e=e.lPrev());for(;libtess.geom.vertLeq(e.org,e.dst());e=e.lNext);for(var n,i=e.lPrev();e.lNext!==i;)if(libtess.geom.vertLeq(e.dst(),i.org)){for(;i.lNext!==e&&(libtess.geom.edgeGoesLeft(i.lNext)||libtess.geom.edgeSign(i.org,i.dst(),i.lNext.dst())<=0);)n=libtess.mesh.connect(i.lNext,i),i=n.sym;i=i.lPrev()}else{for(;i.lNext!==e&&(libtess.geom.edgeGoesRight(e.lPrev())||libtess.geom.edgeSign(e.dst(),e.org,e.lPrev().org)>=0);)n=libtess.mesh.connect(e,e.lPrev()),e=n.sym;e=e.lNext}for(;i.lNext.lNext!==e;)n=libtess.mesh.connect(i.lNext,i),i=n.sym},libtess.tessmono.tessellateInterior=function(t){for(var e,n=t.fHead.next;n!==t.fHead;n=e)e=n.next,n.inside&&libtess.tessmono.tessellateMonoRegion_(n)},libtess.tessmono.discardExterior=function(t){for(var e,n=t.fHead.next;n!==t.fHead;n=e)e=n.next,n.inside||libtess.mesh.zapFace(n)},libtess.tessmono.setWindingNumber=function(t,e,n){for(var i,r=t.eHead.next;r!==t.eHead;r=i)i=r.next,r.rFace().inside!==r.lFace.inside?r.winding=r.lFace.inside?e:-e:n?libtess.mesh.deleteEdge(r):r.winding=0},libtess.Dict=function(t,e){this.head_=new libtess.DictNode,this.frame_=t,this.leq_=e},libtess.Dict.prototype.deleteDict_=function(){},libtess.Dict.prototype.insertBefore=function(t,e){do t=t.prev;while(null!==t.key&&!this.leq_(this.frame_,t.key,e))var n=new libtess.DictNode(e,t.next,t);return t.next.prev=n,t.next=n,n},libtess.Dict.prototype.insert=function(t){return this.insertBefore(this.head_,t)},libtess.Dict.prototype.deleteNode=function(t){t.next.prev=t.prev,t.prev.next=t.next},libtess.Dict.prototype.search=function(t){var e=this.head_;do e=e.next;while(null!==e.key&&!this.leq_(this.frame_,t,e.key))return e},libtess.Dict.prototype.getMin=function(){return this.head_.next},libtess.Dict.prototype.getMax=function(){return this.head_.prev},libtess.DictNode=function(t,e,n){this.key=t||null,this.next=e||this,this.prev=n||this},libtess.DictNode.prototype.getKey=function(){return this.key},libtess.DictNode.prototype.getSuccessor=function(){return this.next},libtess.DictNode.prototype.getPredecessor=function(){return this.prev},libtess.GluTesselator=function(){this.state_=libtess.GluTesselator.tessState_.T_DORMANT,this.lastEdge_=null,this.mesh=null,this.errorCallback_=null,this.normal_=[0,0,0],this.windingRule=libtess.windingRule.GLU_TESS_WINDING_ODD,this.fatalError=!1,this.dict=null,this.pq=null,this.event=null,this.combineCallback_=null,this.boundaryOnly_=!1,this.beginCallback_=null,this.edgeFlagCallback_=null,this.vertexCallback_=null,this.endCallback_=null,this.meshCallback_=null,this.polygonData_=null},libtess.GluTesselator.tessState_={T_DORMANT:0,T_IN_POLYGON:1,T_IN_CONTOUR:2},libtess.GluTesselator.prototype.gluDeleteTess=function(){this.requireState_(libtess.GluTesselator.tessState_.T_DORMANT)},libtess.GluTesselator.prototype.gluTessProperty=function(t,e){switch(t){case libtess.gluEnum.GLU_TESS_TOLERANCE:return;case libtess.gluEnum.GLU_TESS_WINDING_RULE:var n=e;switch(n){case libtess.windingRule.GLU_TESS_WINDING_ODD:case libtess.windingRule.GLU_TESS_WINDING_NONZERO:case libtess.windingRule.GLU_TESS_WINDING_POSITIVE:case libtess.windingRule.GLU_TESS_WINDING_NEGATIVE:case libtess.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return void(this.windingRule=n)}break;case libtess.gluEnum.GLU_TESS_BOUNDARY_ONLY:return void(this.boundaryOnly_=!!e);default:return void this.callErrorCallback(libtess.gluEnum.GLU_INVALID_ENUM)}this.callErrorCallback(libtess.gluEnum.GLU_INVALID_VALUE)},libtess.GluTesselator.prototype.gluGetTessProperty=function(t){switch(t){case libtess.gluEnum.GLU_TESS_TOLERANCE:return 0;case libtess.gluEnum.GLU_TESS_WINDING_RULE:return this.windingRule;case libtess.gluEnum.GLU_TESS_BOUNDARY_ONLY:return this.boundaryOnly_;default:this.callErrorCallback(libtess.gluEnum.GLU_INVALID_ENUM)}return!1},libtess.GluTesselator.prototype.gluTessNormal=function(t,e,n){this.normal_[0]=t,this.normal_[1]=e,this.normal_[2]=n},libtess.GluTesselator.prototype.gluTessCallback=function(t,e){var n=e?e:null;switch(t){case libtess.gluEnum.GLU_TESS_BEGIN:case libtess.gluEnum.GLU_TESS_BEGIN_DATA:return void(this.beginCallback_=n);case libtess.gluEnum.GLU_TESS_EDGE_FLAG:case libtess.gluEnum.GLU_TESS_EDGE_FLAG_DATA:return void(this.edgeFlagCallback_=n);case libtess.gluEnum.GLU_TESS_VERTEX:case libtess.gluEnum.GLU_TESS_VERTEX_DATA:return void(this.vertexCallback_=n);case libtess.gluEnum.GLU_TESS_END:case libtess.gluEnum.GLU_TESS_END_DATA:return void(this.endCallback_=n);case libtess.gluEnum.GLU_TESS_ERROR:case libtess.gluEnum.GLU_TESS_ERROR_DATA:return void(this.errorCallback_=n);case libtess.gluEnum.GLU_TESS_COMBINE:case libtess.gluEnum.GLU_TESS_COMBINE_DATA:return void(this.combineCallback_=n);case libtess.gluEnum.GLU_TESS_MESH:return void(this.meshCallback_=n);default:return void this.callErrorCallback(libtess.gluEnum.GLU_INVALID_ENUM)}},libtess.GluTesselator.prototype.gluTessVertex=function(t,e){var n=!1,i=[0,0,0];this.requireState_(libtess.GluTesselator.tessState_.T_IN_CONTOUR);for(var r=0;r<3;++r){var o=t[r];o<-libtess.GLU_TESS_MAX_COORD&&(o=-libtess.GLU_TESS_MAX_COORD,n=!0),o>libtess.GLU_TESS_MAX_COORD&&(o=libtess.GLU_TESS_MAX_COORD,n=!0),i[r]=o}n&&this.callErrorCallback(libtess.errorType.GLU_TESS_COORD_TOO_LARGE),this.addVertex_(i,e)},libtess.GluTesselator.prototype.gluTessBeginPolygon=function(t){this.requireState_(libtess.GluTesselator.tessState_.T_DORMANT),this.state_=libtess.GluTesselator.tessState_.T_IN_POLYGON,this.mesh=new libtess.GluMesh,this.polygonData_=t},libtess.GluTesselator.prototype.gluTessBeginContour=function(){this.requireState_(libtess.GluTesselator.tessState_.T_IN_POLYGON),this.state_=libtess.GluTesselator.tessState_.T_IN_CONTOUR,this.lastEdge_=null},libtess.GluTesselator.prototype.gluTessEndContour=function(){this.requireState_(libtess.GluTesselator.tessState_.T_IN_CONTOUR),this.state_=libtess.GluTesselator.tessState_.T_IN_POLYGON},libtess.GluTesselator.prototype.gluTessEndPolygon=function(){if(this.requireState_(libtess.GluTesselator.tessState_.T_IN_POLYGON),this.state_=libtess.GluTesselator.tessState_.T_DORMANT,libtess.normal.projectPolygon(this,this.normal_[0],this.normal_[1],this.normal_[2]),libtess.sweep.computeInterior(this),!this.fatalError){var t=this.mesh;if(this.boundaryOnly_?libtess.tessmono.setWindingNumber(t,1,!0):libtess.tessmono.tessellateInterior(t),this.mesh.checkMesh(),this.beginCallback_||this.endCallback_||this.vertexCallback_||this.edgeFlagCallback_)if(this.boundaryOnly_)libtess.render.renderBoundary(this,this.mesh);else{var e=!!this.edgeFlagCallback_;libtess.render.renderMesh(this,this.mesh,e)}if(this.meshCallback_)return libtess.tessmono.discardExterior(this.mesh),this.meshCallback_(this.mesh),this.mesh=null,void(this.polygonData_=null)}libtess.mesh.deleteMesh(this.mesh),this.polygonData_=null,this.mesh=null},libtess.GluTesselator.prototype.requireState_=function(t){this.state_!==t&&this.gotoState_(t)},libtess.GluTesselator.prototype.gotoState_=function(t){for(;this.state_!==t;)if(this.state_<t)switch(this.state_){case libtess.GluTesselator.tessState_.T_DORMANT:this.callErrorCallback(libtess.errorType.GLU_TESS_MISSING_BEGIN_POLYGON),this.gluTessBeginPolygon(null);break;case libtess.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(libtess.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR),this.gluTessBeginContour()}else switch(this.state_){case libtess.GluTesselator.tessState_.T_IN_CONTOUR:this.callErrorCallback(libtess.errorType.GLU_TESS_MISSING_END_CONTOUR),this.gluTessEndContour();break;case libtess.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(libtess.errorType.GLU_TESS_MISSING_END_POLYGON),this.gluTessEndPolygon()}},libtess.GluTesselator.prototype.addVertex_=function(t,e){var n=this.lastEdge_;null===n?(n=libtess.mesh.makeEdge(this.mesh),libtess.mesh.meshSplice(n,n.sym)):(libtess.mesh.splitEdge(n),n=n.lNext),n.org.data=e,n.org.coords[0]=t[0],n.org.coords[1]=t[1],n.org.coords[2]=t[2],n.winding=1,n.sym.winding=-1,this.lastEdge_=n},libtess.GluTesselator.prototype.callBeginCallback=function(t){this.beginCallback_&&this.beginCallback_(t,this.polygonData_)},libtess.GluTesselator.prototype.callVertexCallback=function(t){this.vertexCallback_&&this.vertexCallback_(t,this.polygonData_)},libtess.GluTesselator.prototype.callEdgeFlagCallback=function(t){this.edgeFlagCallback_&&this.edgeFlagCallback_(t,this.polygonData_)},libtess.GluTesselator.prototype.callEndCallback=function(){this.endCallback_&&this.endCallback_(this.polygonData_)},libtess.GluTesselator.prototype.callCombineCallback=function(t,e,n){return this.combineCallback_?this.combineCallback_(t,e,n,this.polygonData_)||null:null},libtess.GluTesselator.prototype.callErrorCallback=function(t){this.errorCallback_&&this.errorCallback_(t,this.polygonData_)},libtess.GluFace=function(t,e){this.next=t||this,this.prev=e||this,this.anEdge=null,this.data=null,this.inside=!1},libtess.GluHalfEdge=function(t){this.next=t||this,this.sym=null,this.oNext=null,this.lNext=null,this.org=null,this.lFace=null,this.activeRegion=null,this.winding=0},libtess.GluHalfEdge.prototype.rFace=function(){return this.sym.lFace},libtess.GluHalfEdge.prototype.dst=function(){return this.sym.org},libtess.GluHalfEdge.prototype.oPrev=function(){return this.sym.lNext},libtess.GluHalfEdge.prototype.lPrev=function(){return this.oNext.sym},libtess.GluHalfEdge.prototype.dPrev=function(){return this.lNext.sym},libtess.GluHalfEdge.prototype.rPrev=function(){return this.sym.oNext},libtess.GluHalfEdge.prototype.dNext=function(){return this.rPrev().sym},libtess.GluHalfEdge.prototype.rNext=function(){return this.oPrev().sym},libtess.GluMesh=function(){this.vHead=new libtess.GluVertex,this.fHead=new libtess.GluFace,this.eHead=new libtess.GluHalfEdge,this.eHeadSym=new libtess.GluHalfEdge,this.eHead.sym=this.eHeadSym,this.eHeadSym.sym=this.eHead},libtess.GluMesh.prototype.checkMesh=function(){if(libtess.DEBUG){var t,e,n=this.fHead,i=this.vHead,r=this.eHead,o=n;for(o=n;(e=o.next)!==n;o=e){t=e.anEdge;do t=t.lNext;while(t!==e.anEdge)}var s,a=i;for(a=i;(s=a.next)!==i;a=s){t=s.anEdge;do t=t.oNext;while(t!==s.anEdge)}var u=r;for(u=r;(t=u.next)!==r;u=t);}},libtess.GluVertex=function(t,e){this.next=t||this,this.prev=e||this,this.anEdge=null,this.data=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0},libtess.PriorityQ=function(){this.verts_=[],this.order_=null,this.size_=0,this.initialized_=!1,this.heap_=new libtess.PriorityQHeap},libtess.PriorityQ.prototype.deleteQ=function(){this.heap_=null,this.order_=null,this.verts_=null},libtess.PriorityQ.prototype.init=function(){this.order_=[];for(var t=0;t<this.size_;t++)this.order_[t]=t;var e=function(t){return function(e,n){return libtess.geom.vertLeq(t[e],t[n])?1:-1}}(this.verts_);if(this.order_.sort(e),this.initialized_=!0,this.heap_.init(),libtess.DEBUG){var n=0+this.size_-1;for(t=0;t<n;++t);}},libtess.PriorityQ.prototype.insert=function(t){if(this.initialized_)return this.heap_.insert(t);var e=this.size_++;return this.verts_[e]=t,-(e+1)},libtess.PriorityQ.prototype.extractMin=function(){if(0===this.size_)return this.heap_.extractMin();var t=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var e=this.heap_.minimum();if(libtess.geom.vertLeq(e,t))return this.heap_.extractMin()}do--this.size_;while(this.size_>0&&null===this.verts_[this.order_[this.size_-1]])return t},libtess.PriorityQ.prototype.minimum=function(){if(0===this.size_)return this.heap_.minimum();var t=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var e=this.heap_.minimum();if(libtess.geom.vertLeq(e,t))return e}return t},libtess.PriorityQ.prototype.remove=function(t){if(t>=0)return void this.heap_.remove(t);for(t=-(t+1),this.verts_[t]=null;this.size_>0&&null===this.verts_[this.order_[this.size_-1]];)--this.size_},libtess.PriorityQHeap=function(){this.heap_=libtess.PriorityQHeap.reallocNumeric_([0],libtess.PriorityQHeap.INIT_SIZE_+1),this.verts_=[null,null],this.handles_=[0,0],this.size_=0,this.max_=libtess.PriorityQHeap.INIT_SIZE_,this.freeList_=0,this.initialized_=!1,this.heap_[1]=1},libtess.PriorityQHeap.INIT_SIZE_=32,libtess.PriorityQHeap.reallocNumeric_=function(t,e){for(var n=new Array(e),i=0;i<t.length;i++)n[i]=t[i];for(;i<e;i++)n[i]=0;return n},libtess.PriorityQHeap.prototype.init=function(){for(var t=this.size_;t>=1;--t)this.floatDown_(t);this.initialized_=!0},libtess.PriorityQHeap.prototype.insert=function(t){var e=++this.size_;2*e>this.max_&&(this.max_*=2,this.handles_=libtess.PriorityQHeap.reallocNumeric_(this.handles_,this.max_+1));var n;return 0===this.freeList_?n=e:(n=this.freeList_,this.freeList_=this.handles_[this.freeList_]),this.verts_[n]=t,this.handles_[n]=e,this.heap_[e]=n,this.initialized_&&this.floatUp_(e),n},libtess.PriorityQHeap.prototype.isEmpty=function(){return 0===this.size_},libtess.PriorityQHeap.prototype.minimum=function(){return this.verts_[this.heap_[1]]},libtess.PriorityQHeap.prototype.extractMin=function(){var t=this.heap_,e=this.verts_,n=this.handles_,i=t[1],r=e[i];return this.size_>0&&(t[1]=t[this.size_],n[t[1]]=1,e[i]=null,n[i]=this.freeList_,this.freeList_=i,--this.size_>0&&this.floatDown_(1)),r},libtess.PriorityQHeap.prototype.remove=function(t){var e=this.heap_,n=this.verts_,i=this.handles_,r=i[t];if(e[r]=e[this.size_],i[e[r]]=r,r<=--this.size_)if(r<=1)this.floatDown_(r);else{var o=n[e[r]],s=n[e[r>>1]];libtess.geom.vertLeq(s,o)?this.floatDown_(r):this.floatUp_(r)}n[t]=null,i[t]=this.freeList_,this.freeList_=t},libtess.PriorityQHeap.prototype.floatDown_=function(t){for(var e=this.heap_,n=this.verts_,i=this.handles_,r=t,o=e[r];;){var s=r<<1;s<this.size_&&libtess.geom.vertLeq(n[e[s+1]],n[e[s]])&&(s+=1);var a=e[s];if(s>this.size_||libtess.geom.vertLeq(n[o],n[a]))return e[r]=o,void(i[o]=r);e[r]=a,i[a]=r,r=s}},libtess.PriorityQHeap.prototype.floatUp_=function(t){for(var e=this.heap_,n=this.verts_,i=this.handles_,r=t,o=e[r];;){var s=r>>1,a=e[s];if(0===s||libtess.geom.vertLeq(n[a],n[o]))return e[r]=o,void(i[o]=r);e[r]=a,i[a]=r,r=s}},libtess.ActiveRegion=function(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1},libtess.ActiveRegion.prototype.regionBelow=function(){return this.nodeUp.getPredecessor().getKey()},libtess.ActiveRegion.prototype.regionAbove=function(){return this.nodeUp.getSuccessor().getKey()},"undefined"!=typeof module&&(module.exports=libtess),define("libtess",["libtess/libtess.cat"],function(t){return t}),define("libtess/libtess.cat",function(){}),define("standard/Math/Geometry/Triangle3",["standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","libtess"],function(t,e){"use strict";return{area:function(){var e=new t(0,0,0),n=new t(0,0,0);return function(t,i,r){return e.assign(i).subtract(t).cross(n.assign(r).subtract(t)).abs()/2}}(),normal:function(t,e,n,i){var r=n.x-e.x,o=n.y-e.y,s=n.z-e.z,a=t.x-e.x,u=t.y-e.y,l=t.z-e.z;return i.set(o*l-s*u,s*a-r*l,r*u-o*a),i.normalize()},quadNormal:function(t,e,n,i,r){var o=n.x-t.x,s=n.y-t.y,a=n.z-t.z,u=i.x-e.x,l=i.y-e.y,c=i.z-e.z;return r.set(s*c-a*l,a*u-o*c,o*l-s*u),r.normalize()},triangulatePolygon:function(){var t=function(){function t(t,e){e[e.length]=t}function e(t){t!==libtess.primitiveType.GL_TRIANGLES&&console.log("expected TRIANGLES but got type: "+t)}function n(t){console.log("error callback"),console.log("error number: "+t)}function i(t,e,n){return e[0]}function r(t){}var o=new libtess.GluTesselator;return o.gluTessCallback(libtess.gluEnum.GLU_TESS_VERTEX_DATA,t),o.gluTessCallback(libtess.gluEnum.GLU_TESS_BEGIN,e),o.gluTessCallback(libtess.gluEnum.GLU_TESS_ERROR,n),o.gluTessCallback(libtess.gluEnum.GLU_TESS_COMBINE,i),o.gluTessCallback(libtess.gluEnum.GLU_TESS_EDGE_FLAG,r),o.gluTessProperty(libtess.gluEnum.GLU_TESS_TOLERANCE,0),o.gluTessProperty(libtess.gluEnum.GLU_TESS_WINDING_RULE,libtess.windingRule.GLU_TESS_WINDING_ODD),o}();return function(){var e=arguments[arguments.length-1];t.gluTessBeginPolygon(e);for(var n=0,i=arguments.length-1;n<i;++n){t.gluTessBeginContour();for(var r=arguments[n],o=0;o<r.length;++o)t.gluTessVertex(r[o],r[o]);t.gluTessEndContour()}return t.gluTessEndPolygon(),e}}(),triangulateConvexPolygon:function(t,e){for(var n=1,i=t.length-1;n<i;++n)e.push(t[0],t[n],t[n+1])},getPolygonNormal:function(t,e){e.set(0,0,0);for(var n=t[0],i=0,r=t.length;i<r;++i){var o=n,n=t[(i+1)%r];e.x+=(o.y-n.y)*(o.z+n.z),e.y+=(o.z-n.z)*(o.x+n.x),e.z+=(o.x-n.x)*(o.y+n.y)}return e.normalize()}}}),define("standard/Math/Algorithms/SAT",[],function(){"use strict";function t(){}function e(t,e,n){n.min=Number.POSITIVE_INFINITY,n.max=Number.NEGATIVE_INFINITY;for(var i=0,r=t.length;i<r;++i){var o=t[i],s=o.dot(e);s<n.min&&(n.min=s),s>n.max&&(n.max=s)}}function n(t,e,n,r){return i(n,t,e)||i(t,n,r)}function i(t,e,n){return e<=t&&t<=n}var r={min:0,max:0},o={min:0,max:0};return t.isSeparated=function(t,i,s){for(var a=0,u=t.length;a<u;++a){var l=t[a];if(e(i,l,r),e(s,l,o),!n(r.min,r.max,o.min,o.max))return!0}return!1},t}),define("standard/Math/Geometry/ViewVolume",["standard/Math/Geometry/Plane3","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4","standard/Math/Algorithms/SAT"],function(t,e,n,i,r,o){"use strict";function s(e,r,o){this.viewport=new i(0,0,0,0),this.scissor=new i(0,0,0,0),this.points=[new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0)],this.normals=[new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0)],this.edges=[new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0)],this.planes=[new t(n.Zero,n.Zero),new t(n.Zero,n.Zero),new t(n.Zero,n.Zero),new t(n.Zero,n.Zero),new t(n.Zero,n.Zero),new t(n.Zero,n.Zero)],arguments.length&&this.set(e,r,o)}return s.prototype={constructor:s,set:function(){var t=new r;return function(n,i,r){try{this.viewport.assign(i),this.scissor.assign(r);var o=this.points,a=o[0],u=o[1],l=o[2],c=o[3],h=o[4],d=o[5],p=o[6],f=o[7],g=r[0],m=g+r[2],x=r[1],v=x+r[3];t.assign(n).inverse(),
s.unProjectPointMatrix(g,x,0,t,i,a),s.unProjectPointMatrix(m,x,0,t,i,u),s.unProjectPointMatrix(m,v,0,t,i,l),s.unProjectPointMatrix(g,v,0,t,i,c),s.unProjectPointMatrix(g,x,1,t,i,h),s.unProjectPointMatrix(m,x,1,t,i,d),s.unProjectPointMatrix(m,v,1,t,i,p),s.unProjectPointMatrix(g,v,1,t,i,f);var _=this.normals;e.normal(a,u,l,_[0]),e.normal(f,h,a,_[1]),e.normal(p,l,u,_[2]),e.normal(l,p,f,_[3]),e.normal(u,a,h,_[4]),e.normal(h,f,p,_[5]);var y=this.planes;y[0].set(u,_[0]),y[1].set(h,_[1]),y[2].set(l,_[2]),y[3].set(p,_[3]),y[4].set(a,_[4]),y[5].set(f,_[5]),this.edges.tainted=!0,this.valid=!0}catch(t){this.valid=!1}return this}}(),getViewport:function(){return this.viewport},getScissor:function(){return this.scissor},getEdges:function(){var t=this.edges;if(t.tainted){var e=this.points;t[0].assign(e[0]).subtract(e[1]),t[1].assign(e[1]).subtract(e[2]),t[2].assign(e[2]).subtract(e[3]),t[3].assign(e[3]).subtract(e[0]),t[4].assign(e[0]).subtract(e[4]),t[5].assign(e[1]).subtract(e[5]),t[6].assign(e[2]).subtract(e[6]),t[7].assign(e[3]).subtract(e[7]),t.tainted=!1}return t},intersectsSphere:function(t,e){if(this.valid){var n=this.planes;if(n[0].getDistanceToPoint(e)>t)return!1;if(n[1].getDistanceToPoint(e)>t)return!1;if(n[2].getDistanceToPoint(e)>t)return!1;if(n[3].getDistanceToPoint(e)>t)return!1;if(n[4].getDistanceToPoint(e)>t)return!1;if(n[5].getDistanceToPoint(e)>t)return!1}return!0},intersectsBox:function(){for(var t=[new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0)],e=[new n(0,0,0),new n(0,0,0),new n(0,0,0)],i=[new n(0,0,0),new n(0,0,0),new n(0,0,0)],r=[],s=0;s<24;++s)r.push(new n(0,0,0));return function(n){n.getPoints(t);var s=this.points;if(o.isSeparated(n.getNormals(e),t,s))return!1;if(o.isSeparated(this.normals,t,s))return!1;n.getAxes(i);for(var a=this.getEdges(),u=0;u<3;++u)for(var l=0;l<8;++l)r[3*u+l].assign(i[u]).cross(a[l]);return!o.isSeparated(r,t,s)}}()},Object.assign(s,{unProjectPoint:function(){var t=new r;return function(e,n,i,r,o,s,a){return t.assign(r).multRight(o).inverse(),this.unProjectPointMatrix(e,n,i,t,s,a)}}(),unProjectPointMatrix:function(){var t=new i(0,0,0,0);return function(e,n,i,r,o,s){if(t.set((e-o[0])/o[2]*2-1,(n-o[1])/o[3]*2-1,2*i-1,1),r.multVecMatrix(t),0===t.w)throw new Error("Couldn't unproject point: divisor is 0.");var a=1/t.w;return s.set(t.x*a,t.y*a,t.z*a)}}(),unProjectRay:function(){var t=new n(0,0,0),e=new n(0,0,0),i=new r;return function(n,r,o,a,u,l){return i.assign(o).multRight(a).inverse(),s.unProjectPointMatrix(n,r,0,i,u,t),s.unProjectPointMatrix(n,r,.9,i,u,e),l.setPoints(t,e)}}(),projectPoint:function(){var t=new i(0,0,0,0);return function(e,n,i,r,o){if(t.set(e.x,e.y,e.z,1),i.multVecMatrix(n.multVecMatrix(t)),0===t.w)throw new Error("Couldn't project point: divisor is 0.");var s=1/(2*t.w);return o.set((t.x*s+.5)*r[2]+r[0],(t.y*s+.5)*r[3]+r[1],t.z*s+.5)}}(),projectLine:function(){var t=new n(0,0,0),e=new n(0,0,0);return function(i,r,o,a,u){return s.projectPoint(i.point,r,o,a,t),s.projectPoint(n.multiply(i.direction,1e9).add(i.point),r,o,a,e),t.z=0,e.z=0,u.setPoints(t,e)}}()}),s}),define("x_ite/Rendering/TextureBuffer",["standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(t,e,n){"use strict";function i(t,e,n){var i=t.getContext();if(this.browser=t,this.width=e,this.height=n,this.array=new Uint8Array(e*n*4),this.lastBuffer=i.getParameter(i.FRAMEBUFFER_BINDING),this.buffer=i.createFramebuffer(),i.bindFramebuffer(i.FRAMEBUFFER,this.buffer),this.colorTexture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,this.colorTexture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,e,n,0,i.RGBA,i.UNSIGNED_BYTE,null),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,this.colorTexture,0),i.getVersion()>=2||t.getExtension("WEBGL_depth_texture")){this.depthTexture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,this.depthTexture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST);var r=i.getVersion()>=2?i.DEPTH_COMPONENT24:i.DEPTH_COMPONENT;i.texImage2D(i.TEXTURE_2D,0,r,e,n,0,i.DEPTH_COMPONENT,i.UNSIGNED_INT,null),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,this.depthTexture,0)}else this.depthBuffer=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,this.depthBuffer),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_COMPONENT16,e,n),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,this.depthBuffer);var o=i.checkFramebufferStatus(i.FRAMEBUFFER)===i.FRAMEBUFFER_COMPLETE;if(i.bindFramebuffer(i.FRAMEBUFFER,this.lastBuffer),!o)throw new Error("Couldn't create frame buffer.")}return i.prototype={constructor:i,getWidth:function(){return this.width},getHeight:function(){return this.height},getColorTexture:function(){return this.colorTexture},getDepthTexture:function(){return this.depthTexture},readPixels:function(){var t=this.browser.getContext(),e=this.array,n=this.width,i=this.height;return t.readPixels(0,0,n,i,t.RGBA,t.UNSIGNED_BYTE,e),e},getDepth:function(){var i=new n,r=new e(0,0,0);return function(e,n){try{var o=this.browser.getContext(),s=this.array,a=this.width,u=this.height,l=0,c=0,h=Number.POSITIVE_INFINITY;i.assign(e).inverse(),o.readPixels(0,0,a,u,o.RGBA,o.UNSIGNED_BYTE,s);for(var d=0,p=0;d<u;++d)for(var f=0;f<a;++f,p+=4){var g=s[p]/255+s[p+1]/65025+s[p+2]/16581375+s[p+3]/4228250625;g<h&&(l=f,c=d,h=g)}return t.unProjectPointMatrix(l,c,h,i,n,r),r.z}catch(t){return 0}}}(),bind:function(){var t=this.browser.getContext();this.lastBuffer=t.getParameter(t.FRAMEBUFFER_BINDING),t.bindFramebuffer(t.FRAMEBUFFER,this.buffer)},unbind:function(){var t=this.browser.getContext();t.bindFramebuffer(t.FRAMEBUFFER,this.lastBuffer)}},i}),define("x_ite/Browser/Shaders/ShaderTest",["x_ite/Rendering/TextureBuffer","standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Camera"],function(t,e,n,i,r){"use strict";return{compile:function(t,e,n){var i=t.createShader(t[n]);return t.shaderSource(i,e),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)},verify:function(){var e=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1],o=[2,2,0,1,-2,2,0,1,-2,-2,0,1,2,2,0,1,-2,-2,0,1,2,-2,0,1];return function(s,a){var u=s.getContext(),l=new t(s,16,16),c=u.createBuffer(),h=u.createBuffer();l.bind(),a.enable(u),u.viewport(0,0,16,16),u.bindBuffer(u.ARRAY_BUFFER,h),u.bufferData(u.ARRAY_BUFFER,new Float32Array(o),u.STATIC_DRAW),u.bindBuffer(u.ARRAY_BUFFER,c),u.bufferData(u.ARRAY_BUFFER,new Float32Array(e),u.STATIC_DRAW),a.setShaderObjects(u,[]),u.uniform1i(a.x3d_FogType,0),u.uniform1i(a.x3d_ColorMaterial,!1),u.uniform1i(a.x3d_Lighting,!0),u.uniform1i(a.x3d_SeparateBackColor,!1),u.uniform1f(a.x3d_AmbientIntensity,0),u.uniform3f(a.x3d_DiffuseColor,1,0,0),u.uniform3f(a.x3d_SpecularColor,1,0,0),u.uniform3f(a.x3d_EmissiveColor,1,0,0),u.uniform1f(a.x3d_Shininess,0),u.uniform1f(a.x3d_Transparency,0),u.uniform1i(a.x3d_NumTextures,0),u.uniform1i(a.x3d_FillPropertiesFilled,!0),u.uniform1i(a.x3d_FillPropertiesHatched,!1),u.uniformMatrix4fv(a.x3d_ProjectionMatrix,!1,new Float32Array(r.ortho(-1,1,-1,1,-1,1,new i))),u.uniformMatrix4fv(a.x3d_ModelViewMatrix,!1,new Float32Array(new i)),u.uniformMatrix3fv(a.x3d_NormalMatrix,!1,new Float32Array(new n)),u.disable(u.BLEND),u.frontFace(u.CCW),u.enable(u.CULL_FACE),u.cullFace(u.BACK),a.enableNormalAttribute(u,c),a.enableVertexAttribute(u,h),u.drawArrays(u.TRIANGLES,0,6);var d=l.readPixels();return l.unbind(),a.disableNormalAttribute(u,c),a.disable(u),255==d[0]&&0==d[1]&&0==d[2]&&255==d[3]}}()}}),define("x_ite/Browser/Shaders/X3DShadersContext",["x_ite/Browser/Core/Shading","x_ite/Components/Shaders/ComposedShader","x_ite/Components/Shaders/ShaderPart","text!x_ite/Browser/Shaders/WebGL1/PointSet.vs","text!x_ite/Browser/Shaders/WebGL1/PointSet.fs","text!x_ite/Browser/Shaders/WebGL1/Wireframe.vs","text!x_ite/Browser/Shaders/WebGL1/Wireframe.fs","text!x_ite/Browser/Shaders/WebGL1/Gouraud.vs","text!x_ite/Browser/Shaders/WebGL1/Gouraud.fs","text!x_ite/Browser/Shaders/WebGL1/Phong.vs","text!x_ite/Browser/Shaders/WebGL1/Phong.fs","text!x_ite/Browser/Shaders/WebGL1/Depth.vs","text!x_ite/Browser/Shaders/WebGL1/Depth.fs","text!x_ite/Browser/Shaders/WebGL2/PointSet.vs","text!x_ite/Browser/Shaders/WebGL2/PointSet.fs","text!x_ite/Browser/Shaders/WebGL2/Wireframe.vs","text!x_ite/Browser/Shaders/WebGL2/Wireframe.fs","text!x_ite/Browser/Shaders/WebGL2/Gouraud.vs","text!x_ite/Browser/Shaders/WebGL2/Gouraud.fs","text!x_ite/Browser/Shaders/WebGL2/Phong.vs","text!x_ite/Browser/Shaders/WebGL2/Phong.fs","text!x_ite/Browser/Shaders/WebGL2/Depth.vs","text!x_ite/Browser/Shaders/WebGL2/Depth.fs","text!x_ite/Browser/Shaders/WebGL1/Tests/SamplerTest.fs","text!x_ite/Browser/Shaders/WebGL2/Tests/SamplerTest.fs","x_ite/Browser/Shaders/ShaderTest"],function(t,e,n,i,r,o,s,a,u,l,c,h,d,p,f,g,m,x,v,_,y,w,b,S,C,T){"use strict";function F(){this.shaders=new Set}return F.prototype={initialize:function(){this.multiTexturing=T.compile(this.getContext(),this.selectShaderSource(S,C),"FRAGMENT_SHADER"),this.multiTexturing||this.getDebug()&&console.warn("Disabling multi-texturing."),this.setShading(t.GOURAUD)},getShadingLanguageVersion:function(){return this.getContext().getParameter(this.getContext().SHADING_LANGUAGE_VERSION)},getMaxVertexUniformVectors:function(){return this.getContext().getParameter(this.getContext().MAX_VERTEX_UNIFORM_VECTORS)},getMaxFragmentUniformVectors:function(){return this.getContext().getParameter(this.getContext().MAX_FRAGMENT_UNIFORM_VECTORS)},getMaxVertexAttribs:function(){return this.getContext().getParameter(this.getContext().MAX_VERTEX_ATTRIBS)},getMultiTexturing:function(){return this.multiTexturing},addShader:function(t){this.shaders.add(t),t.setShading(this.getBrowserOptions().getShading())},removeShader:function(t){this.shaders.delete(t)},getShaders:function(){return this.shaders},getDefaultShader:function(){},getDefaultShadowShader:function(){return this.getDefaultShader().getShadowShader()},hasPointShader:function(){return!!this.pointShader},getPointShader:function(){return this.pointShader?this.pointShader:(this.pointShader=this.createShader("PointShader",i,r,p,f,!1),this.pointShader.getShadowShader=this.getPointShader.bind(this),this.pointShader)},hasLineShader:function(){return!!this.lineShader},getLineShader:function(){return this.lineShader?this.lineShader:(this.lineShader=this.createShader("WireframeShader",o,s,g,m,!1),this.lineShader.getShadowShader=this.getLineShader.bind(this),this.lineShader)},hasGouraudShader:function(){return!!this.gouraudShader},getGouraudShader:function(){return this.gouraudShader?this.gouraudShader:(this.gouraudShader=this.createShader("GouraudShader",a,u,x,v,!1),this.gouraudShader.getShadowShader=this.getShadowShader.bind(this),this.gouraudShader)},hasPhongShader:function(){return!!this.phongShader},getPhongShader:function(){return this.phongShader?this.phongShader:(this.phongShader=this.createShader("PhongShader",l,c,_,y,!1),this.phongShader.getShadowShader=this.getShadowShader.bind(this),this.phongShader.isValid_.addInterest("set_phong_shader_valid__",this),this.phongShader)},hasShadowShader:function(){return!!this.shadowShader},getShadowShader:function(){return this.shadowShader?this.shadowShader:(this.shadowShader=this.createShader("ShadowShader",l,c,_,y,!0),this.shadowShader.isValid_.addInterest("set_shadow_shader_valid__",this),this.shadowShader)},hasDepthShader:function(){return!!this.depthShader},getDepthShader:function(){return this.depthShader?this.depthShader:(this.depthShader=this.createShader("DepthShader",h,d,w,b,!1),this.depthShader)},setShading:function(e){switch(e){case t.PHONG:this.getDefaultShader=this.getPhongShader;break;default:this.getDefaultShader=this.getGouraudShader}for(var n of this.getShaders())n.setShading(e)},createShader:function(t,i,r,o,s,a){this.getDebug()&&console.log("Initializing "+t);var u=new n(this.getPrivateScene());u.setName(t+"Vertex"),u.url_.push("data:text/plain;charset=utf-8,"+this.selectShaderSource(i,o)),u.setShadow(a),u.setup();var l=new n(this.getPrivateScene());l.setName(t+"Fragment"),l.type_="FRAGMENT",l.url_.push("data:text/plain;charset=utf-8,"+this.selectShaderSource(r,s)),l.setShadow(a),l.setup();var c=new e(this.getPrivateScene());return c.setName(t),c.language_="GLSL",c.parts_.push(u),c.parts_.push(l),c.setCustom(!1),c.setShading(this.getBrowserOptions().getShading()),c.setup(),this.addShader(c),c},selectShaderSource:function(t,e){return this.getContext().getVersion()<=1?t:e},set_phong_shader_valid__:function(t){t.getValue()&&T.verify(this,this.phongShader)||(console.warn("X_ITE: Phong shading is not available, using Gouraud shading."),this.phongShader=this.getGouraudShader())},set_shadow_shader_valid__:function(t){t.getValue()&&T.verify(this,this.shadowShader)||console.warn("X_ITE: Shadow shading is not available, using Gouraud shading.")}},F}),function(t,e){"function"==typeof define&&define.amd?define("ResizeSensor/src/ResizeSensor",e):"object"==typeof exports?module.exports=e():t.ResizeSensor=e()}("undefined"!=typeof window?window:this,function(){function t(t,e){var n=Object.prototype.toString.call(t),i="[object Array]"===n||"[object NodeList]"===n||"[object HTMLCollection]"===n||"[object Object]"===n||"undefined"!=typeof jQuery&&t instanceof jQuery||"undefined"!=typeof Elements&&t instanceof Elements,r=0,o=t.length;if(i)for(;r<o;r++)e(t[r]);else e(t)}function e(t){if(!t.getBoundingClientRect)return{width:t.offsetWidth,height:t.offsetHeight};var e=t.getBoundingClientRect();return{width:Math.round(e.width),height:Math.round(e.height)}}if("undefined"==typeof window)return null;var n=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(t){return window.setTimeout(t,20)},i=function(r,o){function s(){var t=[];this.add=function(e){t.push(e)};var e,n;this.call=function(i){for(e=0,n=t.length;e<n;e++)t[e].call(this,i)},this.remove=function(i){var r=[];for(e=0,n=t.length;e<n;e++)t[e]!==i&&r.push(t[e]);t=r},this.length=function(){return t.length}}function a(t,i){if(t){if(t.resizedAttached)return void t.resizedAttached.add(i);t.resizedAttached=new s,t.resizedAttached.add(i),t.resizeSensor=document.createElement("div"),t.resizeSensor.dir="ltr",t.resizeSensor.className="resize-sensor";var r="pointer-events: none; position: absolute; left: 0px; top: 0px; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;",o="position: absolute; left: 0; top: 0; transition: 0s;";t.resizeSensor.style.cssText=r,t.resizeSensor.innerHTML='<div class="resize-sensor-expand" style="'+r+'"><div style="'+o+'"></div></div><div class="resize-sensor-shrink" style="'+r+'"><div style="'+o+' width: 200%; height: 200%"></div></div>',t.appendChild(t.resizeSensor);var a=window.getComputedStyle(t),u=a?a.getPropertyValue("position"):null;"absolute"!==u&&"relative"!==u&&"fixed"!==u&&(t.style.position="relative");var l,c,h=t.resizeSensor.childNodes[0],d=h.childNodes[0],p=t.resizeSensor.childNodes[1],f=e(t),g=f.width,m=f.height,x=!0,v=0,_=function(){var e=t.offsetWidth,n=t.offsetHeight;d.style.width=e+10+"px",d.style.height=n+10+"px",h.scrollLeft=e+10,h.scrollTop=n+10,p.scrollLeft=e+10,p.scrollTop=n+10},y=function(){if(x){if(0===t.offsetWidth&&0===t.offsetHeight)return void(v||(v=n(function(){v=0,y()})));x=!1}_()};t.resizeSensor.resetSensor=y;var w=function(){c=0,l&&(g=f.width,m=f.height,t.resizedAttached&&t.resizedAttached.call(f))},b=function(){f=e(t),l=f.width!==g||f.height!==m,l&&!c&&(c=n(w)),y()},S=function(t,e,n){t.attachEvent?t.attachEvent("on"+e,n):t.addEventListener(e,n)};S(h,"scroll",b),S(p,"scroll",b),n(y)}}t(r,function(t){a(t,o)}),this.detach=function(t){i.detach(r,t)},this.reset=function(){r.resizeSensor.resetSensor()}};if(i.reset=function(e){t(e,function(t){t.resizeSensor.resetSensor()})},i.detach=function(e,n){t(e,function(t){t&&(t.resizedAttached&&"function"==typeof n&&(t.resizedAttached.remove(n),t.resizedAttached.length())||t.resizeSensor&&(t.contains(t.resizeSensor)&&t.removeChild(t.resizeSensor),delete t.resizeSensor,delete t.resizedAttached))})},"undefined"!=typeof MutationObserver){var r=new MutationObserver(function(t){for(var e in t)if(t.hasOwnProperty(e))for(var n=t[e].addedNodes,r=0;r<n.length;r++)n[r].resizeSensor&&i.reset(n[r])});document.addEventListener("DOMContentLoaded",function(t){r.observe(document.body,{childList:!0,subtree:!0})})}return i}),define("ResizeSensor",["ResizeSensor/src/ResizeSensor"],function(t){return t}),define("x_ite/Browser/Rendering/X3DRenderingContext",["jquery","x_ite/Fields","ResizeSensor"],function(t,e,n){"use strict";function i(){this.addChildObjects("viewport",new e.MFInt32(0,0,300,150)),this.clipPlanes=[]}return i.prototype={initialize:function(){var e=this.getContext();e.enable(e.SCISSOR_TEST),e.cullFace(e.BACK),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.clearDepth(1),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.enable(e.BLEND),t(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",this.onfullscreen.bind(this)),this.resizer=new n(this.getSurface(),this.reshape.bind(this)),this.reshape()},getRenderer:function(){var t=this.getExtension("WEBGL_debug_renderer_info");return t?this.getContext().getParameter(t.UNMASKED_RENDERER_WEBGL):this.getContext().getParameter(this.getContext().RENDERER)},getVendor:function(){var t=this.getExtension("WEBGL_debug_renderer_info");return t?this.getContext().getParameter(t.UNMASKED_VENDOR_WEBGL):this.getContext().getParameter(this.getContext().VENDOR)},getWebGLVersion:function(){return this.getContext().getParameter(this.getContext().VERSION)},getAntialiased:function(){return this.getContext().getParameter(this.getContext().SAMPLES)>0},getMaxClipPlanes:function(){return 6},getDepthSize:function(){var t=this.context;return t.getParameter(t.DEPTH_BITS)},getColorDepth:function(){var t=this.context,e=0;return e+=t.getParameter(t.RED_BITS),e+=t.getParameter(t.BLUE_BITS),e+=t.getParameter(t.GREEN_BITS),e+=t.getParameter(t.ALPHA_BITS)},getViewport:function(){return this.viewport_},getClipPlanes:function(){return this.clipPlanes},reshape:function(){var t=this.getCanvas(),e=t.width(),n=t.height();t=t[0],t.width=e,t.height=n,this.viewport_[2]=e,this.viewport_[3]=n,this.context.viewport(0,0,e,n),this.context.scissor(0,0,e,n),this.addBrowserEvent()},onfullscreen:function(){this.getElement().fullScreen()?this.getElement().addClass("x_ite-fullscreen"):this.getElement().removeClass("x_ite-fullscreen")}},i}),define("x_ite/Components/Shape/X3DAppearanceNode",["x_ite/Fields","x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants"],function(t,e,n){"use strict";function i(i){e.call(this,i),this.addType(n.X3DAppearanceNode),this.addChildObjects("transparent",new t.SFBool),this.transparent_.setAccessType(n.outputOnly)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,initialize:function(){e.prototype.initialize.call(this)},setTransparent:function(t){t!==this.transparent_.getValue()&&(this.transparent_=t)},getTransparent:function(){return this.transparent_.getValue()}}),i}),define("x_ite/Components/Shape/Appearance",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shape/X3DAppearanceNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(o.Appearance),this.linePropertiesNode=null,this.fillPropertiesNode=null,this.materialNode=null,this.textureNode=null,this.textureTransformNode=null,this.shaderNodes=[],this.shaderNode=null,this.blendModeNode=null}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOutput,"lineProperties",new t.SFNode),new e(o.inputOutput,"fillProperties",new t.SFNode),new e(o.inputOutput,"material",new t.SFNode),new e(o.inputOutput,"texture",new t.SFNode),new e(o.inputOutput,"textureTransform",new t.SFNode),new e(o.inputOutput,"shaders",new t.MFNode),new e(o.inputOutput,"blendMode",new t.SFNode)]),getTypeName:function(){return"Appearance"},getComponentName:function(){return"Shape"},getContainerField:function(){return"appearance"},initialize:function(){i.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this),this.lineProperties_.addInterest("set_lineProperties__",this),this.fillProperties_.addInterest("set_fillProperties__",this),this.material_.addInterest("set_material__",this),this.texture_.addInterest("set_texture__",this),this.textureTransform_.addInterest("set_textureTransform__",this),this.shaders_.addInterest("set_shaders__",this),this.blendMode_.addInterest("set_blendMode__",this),this.set_live__(),this.set_lineProperties__(),this.set_fillProperties__(),this.set_material__(),this.set_texture__(),this.set_textureTransform__(),this.set_shaders__(),this.set_blendMode__()},set_live__:function(){this.isLive().getValue()?(this.getBrowser().getBrowserOptions().Shading_.addInterest("set_shading__",this),this.shaderNode&&this.getBrowser().addShader(this.shaderNode)):(this.getBrowser().getBrowserOptions().Shading_.removeInterest("set_shading__",this),this.shaderNode&&this.getBrowser().removeShader(this.shaderNode))},set_lineProperties__:function(){this.linePropertiesNode=r(o.LineProperties,this.lineProperties_),this.linePropertiesNode||(this.linePropertiesNode=this.getBrowser().getDefaultLineProperties())},set_fillProperties__:function(){this.fillPropertiesNode&&this.fillPropertiesNode.transparent_.removeInterest("set_transparent__",this),this.fillPropertiesNode=r(o.FillProperties,this.fillProperties_),this.fillPropertiesNode||(this.fillPropertiesNode=this.getBrowser().getDefaultFillProperties()),this.fillPropertiesNode&&this.fillPropertiesNode.transparent_.addInterest("set_transparent__",this),this.set_transparent__()},set_material__:function(){this.materialNode&&this.materialNode.transparent_.removeInterest("set_transparent__",this),this.materialNode=r(o.X3DMaterialNode,this.material_),this.materialNode&&this.materialNode.transparent_.addInterest("set_transparent__",this),this.set_transparent__()},set_texture__:function(){this.textureNode&&this.textureNode.transparent_.removeInterest("set_transparent__",this),this.textureNode=r(o.X3DTextureNode,this.texture_),this.textureNode&&this.textureNode.transparent_.addInterest("set_transparent__",this),this.set_transparent__()},set_textureTransform__:function(){this.textureTransformNode=r(o.X3DTextureTransformNode,this.textureTransform_),this.textureTransformNode||(this.textureTransformNode=this.getBrowser().getDefaultTextureTransform())},set_shaders__:function(){for(var t=this.shaders_.getValue(),e=this.shaderNodes,n=0,i=e.length;n<i;++n)e[n].isValid_.removeInterest("set_shader__",this);e.length=0;for(var n=0,i=t.length;n<i;++n){var s=r(o.X3DShaderNode,t[n]);s&&(e.push(s),s.isValid_.addInterest("set_shader__",this))}this.set_shader__()},set_shader__:function(){var t=this.shaderNodes;this.shaderNode&&this.getBrowser().removeShader(this.shaderNode),this.shaderNode=null;for(var e=0,n=t.length;e<n;++e)if(t[e].isValid_.getValue()){this.shaderNode=t[e];break}this.shaderNode||(this.shaderNode=this.getBrowser().getDefaultShader()),this.isLive().getValue()&&this.shaderNode&&this.getBrowser().addShader(this.shaderNode),this.set_transparent__()},set_shading__:function(){this.set_shader__()},set_blendMode__:function(){this.blendModeNode=r(o.BlendMode,this.blendMode_),this.set_transparent__()},set_transparent__:function(){this.setTransparent(this.fillPropertiesNode.getTransparent()||this.materialNode&&this.materialNode.getTransparent()||this.textureNode&&this.textureNode.getTransparent()||this.blendModeNode)},traverse:function(t,e){this.textureNode&&this.textureNode.traverse(t,e),this.shaderNode.traverse(t,e)},enable:function(t,e){var n=e.browser;e.linePropertiesNode=this.linePropertiesNode,e.fillPropertiesNode=this.fillPropertiesNode,e.materialNode=this.materialNode,e.textureNode=this.textureNode,e.textureTransformNode=this.textureTransformNode,e.shadow?e.shaderNode=n.getDefaultShadowShader():e.shaderNode=this.shaderNode,this.blendModeNode&&this.blendModeNode.enable(t)},disable:function(t,e){this.blendModeNode&&this.blendModeNode.disable(t)}}),s}),define("x_ite/Components/Shape/LineProperties",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Bits/X3DConstants"],function(t,e,n,i,r){"use strict";function o(t){i.call(this,t),this.addType(r.LineProperties)}return o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"applied",new t.SFBool(!0)),new e(r.inputOutput,"linetype",new t.SFInt32(1)),new e(r.inputOutput,"linewidthScaleFactor",new t.SFFloat)]),getTypeName:function(){return"LineProperties"},getComponentName:function(){return"Shape"},getContainerField:function(){return"lineProperties"},initialize:function(){i.prototype.initialize.call(this),this.applied_.addInterest("set_applied__",this),this.linewidthScaleFactor_.addInterest("set_linewidthScaleFactor__",this),this.set_applied__(),this.set_linewidthScaleFactor__()},set_applied__:function(){this.applied=this.applied_.getValue()},set_linewidthScaleFactor__:function(){this.linewidthScaleFactor=Math.max(1,this.linewidthScaleFactor_.getValue())},setShaderUniforms:function(t,e){if(this.applied){var n=e.getBrowser(),i=n.getLinetype(this.linetype_.getValue());t.lineWidth(this.linewidthScaleFactor),t.uniform1i(e.x3d_LinePropertiesApplied,!0),t.uniform1f(e.x3d_LinePropertiesLinewidthScaleFactor,this.linewidthScaleFactor),t.activeTexture(t.TEXTURE0+n.getLinetypeUnit()),t.bindTexture(t.TEXTURE_2D,i.getTexture())}else t.lineWidth(1),t.uniform1i(e.x3d_LinePropertiesApplied,!1),t.uniform1f(e.x3d_LinePropertiesLinewidthScaleFactor,1)}}),o}),define("x_ite/Components/Shape/FillProperties",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Bits/X3DConstants"],function(t,e,n,i,r){"use strict";function o(e){i.call(this,e),this.addType(r.FillProperties),this.addChildObjects("transparent",new t.SFBool),this.transparent_.setAccessType(r.outputOnly),this.hatchColor=new Float32Array(3)}return o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"filled",new t.SFBool(!0)),new e(r.inputOutput,"hatched",new t.SFBool(!0)),new e(r.inputOutput,"hatchColor",new t.SFColor(1,1,1)),new e(r.inputOutput,"hatchStyle",new t.SFInt32(1))]),getTypeName:function(){return"FillProperties"},getComponentName:function(){return"Shape"},getContainerField:function(){return"fillProperties"},initialize:function(){i.prototype.initialize.call(this),this.filled_.addInterest("set_filled__",this),this.hatched_.addInterest("set_hatched__",this),this.hatchColor_.addInterest("set_hatchColor__",this),this.set_filled__(),this.set_hatched__(),this.set_hatchColor__()},set_filled__:function(){this.filled=this.filled_.getValue(),this.setTransparent(!this.filled)},set_hatched__:function(){this.hatched=this.hatched_.getValue()},set_hatchColor__:function(){this.hatchColor[0]=this.hatchColor_[0],this.hatchColor[1]=this.hatchColor_[1],this.hatchColor[2]=this.hatchColor_[2]},setTransparent:function(t){t!==this.transparent_.getValue()&&(this.transparent_=t)},getTransparent:function(){return this.transparent_.getValue()},setShaderUniforms:function(t,e){var n=this.hatched;if(t.uniform1i(e.x3d_FillPropertiesFilled,this.filled),t.uniform1i(e.x3d_FillPropertiesHatched,n),n){var i=e.getBrowser(),r=i.getHatchStyle(this.hatchStyle_.getValue());t.uniform3fv(e.x3d_FillPropertiesHatchColor,this.hatchColor),t.activeTexture(t.TEXTURE0+i.getHatchStyleUnit()),t.bindTexture(t.TEXTURE_2D,r.getTexture())}}}),o}),define("x_ite/Components/Texturing/X3DTextureNode",["x_ite/Fields","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Bits/X3DConstants","x_ite/Browser/Texturing/MultiTextureModeType","x_ite/Browser/Texturing/MultiTextureSourceType","x_ite/Browser/Texturing/MultiTextureFunctionType"],function(t,e,n,i,r,o){"use strict";function s(i){e.call(this,i),this.addType(n.X3DTextureNode),this.addChildObjects("transparent",new t.SFBool),this.transparent_.setAccessType(n.outputOnly)}var a=["EXT_texture_filter_anisotropic","MOZ_EXT_texture_filter_anisotropic","WEBKIT_EXT_texture_filter_anisotropic"];return s.prototype=Object.assign(Object.create(e.prototype),{constructor:s,initialize:function(){e.prototype.initialize.call(this);var t=this.getBrowser().getContext();this.texture=t.createTexture()},setTransparent:function(t){t!==this.transparent_.getValue()&&(this.transparent_=t)},getTransparent:function(){return this.transparent_.getValue()},getTexture:function(){return this.texture},updateTextureProperties:function(t,e,n,i,r,o,s,u){var l=this.getBrowser().getContext();l.bindTexture(t,this.getTexture()),Math.max(i,r)<this.getBrowser().getMinTextureSize()&&!e?(l.texParameteri(t,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(t,l.TEXTURE_MAG_FILTER,l.NEAREST)):(n.generateMipMaps_.getValue()&&l.generateMipmap(t),l.texParameteri(t,l.TEXTURE_MIN_FILTER,l[n.getMinificationFilter()]),l.texParameteri(t,l.TEXTURE_MAG_FILTER,l[n.getMagnificationFilter()])),e?(l.texParameteri(t,l.TEXTURE_WRAP_S,l[n.getBoundaryModeS()]),l.texParameteri(t,l.TEXTURE_WRAP_T,l[n.getBoundaryModeT()]),l.getVersion()>=2&&l.texParameteri(t,l.TEXTURE_WRAP_R,l[n.getBoundaryModeR()])):(l.texParameteri(t,l.TEXTURE_WRAP_S,o?l.REPEAT:l.CLAMP_TO_EDGE),l.texParameteri(t,l.TEXTURE_WRAP_T,s?l.REPEAT:l.CLAMP_TO_EDGE),l.getVersion()>=2&&l.texParameteri(t,l.TEXTURE_WRAP_R,u?l.REPEAT:l.CLAMP_TO_EDGE));for(var c=0;c<a.length;++c){var h=l.getExtension(a[c]);if(h){l.texParameterf(t,h.TEXTURE_MAX_ANISOTROPY_EXT,n.anisotropicDegree_.getValue());break}}},setShaderUniforms:function(t,e){this.setShaderUniformsToChannel(t,e,0),t.uniform1i(e.x3d_NumTextures,1),t.uniform1i(e.x3d_MultiTextureMode[0],i.MODULATE),t.uniform1i(e.x3d_MultiTextureAlphaMode[0],i.MODULATE),t.uniform1i(e.x3d_MultiTextureSource[0],r.DEFAULT),t.uniform1i(e.x3d_MultiTextureFunction[0],o.DEFAULT)}}),s}),define("x_ite/Components/Texturing/X3DTexture2DNode",["x_ite/Fields","x_ite/Components/Texturing/X3DTextureNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(t,e,n,i){"use strict";function r(t){e.call(this,t),this.addType(i.X3DTexture2DNode),this.width=0,this.height=0,this.flipY=!1,this.data=null}var o=new Uint8Array([255,255,255,255]);return r.prototype=Object.assign(Object.create(e.prototype),{constructor:r,initialize:function(){e.prototype.initialize.call(this);var t=this.getBrowser().getContext();this.target=t.TEXTURE_2D,this.repeatS_.addInterest("updateTextureProperties",this),this.repeatT_.addInterest("updateTextureProperties",this),this.textureProperties_.addInterest("set_textureProperties__",this),t.bindTexture(t.TEXTURE_2D,this.getTexture()),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,o),this.set_textureProperties__()},set_textureProperties__:function(){this.texturePropertiesNode&&this.texturePropertiesNode.removeInterest("updateTextureProperties",this),this.texturePropertiesNode=n(i.TextureProperties,this.textureProperties_),
this.texturePropertiesNode||(this.texturePropertiesNode=this.getBrowser().getDefaultTextureProperties()),this.texturePropertiesNode.addInterest("updateTextureProperties",this),this.updateTextureProperties()},getTarget:function(){return this.target},getWidth:function(){return this.width},getHeight:function(){return this.height},getFlipY:function(){return this.flipY},getData:function(){return this.data},setTexture:function(t,e,n,i,r){try{this.width=t,this.height=e,this.flipY=r,this.data=i;var o=this.getBrowser().getContext();o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,r),o.pixelStorei(o.UNPACK_ALIGNMENT,1),o.bindTexture(o.TEXTURE_2D,this.getTexture()),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,t,e,0,o.RGBA,o.UNSIGNED_BYTE,i),this.setTransparent(n),this.updateTextureProperties(),this.addNodeEvent()}catch(t){}},clearTexture:function(){this.setTexture(1,1,!1,o,!1)},updateTexture:function(t,e){try{this.data=t;var n=this.getBrowser().getContext();n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,e),n.bindTexture(n.TEXTURE_2D,this.getTexture()),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,t),this.texturePropertiesNode.generateMipMaps_.getValue()&&n.generateMipmap(n.TEXTURE_2D),this.addNodeEvent()}catch(t){}},updateTextureProperties:function(){var t=this.getBrowser().getContext();e.prototype.updateTextureProperties.call(this,t.TEXTURE_2D,this.textureProperties_.getValue(),this.texturePropertiesNode,this.width,this.height,this.repeatS_.getValue(),this.repeatT_.getValue(),!1)},setShaderUniformsToChannel:function(t,e,n){t.activeTexture(t.TEXTURE0+e.getBrowser().getTexture2DUnits()[n]),t.bindTexture(t.TEXTURE_2D,this.getTexture()),t.uniform1i(e.x3d_TextureType[n],2)}}),r}),define("x_ite/Components/Texturing/ImageTexture",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Texturing/X3DTexture2DNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Bits/X3DConstants","x_ite/Browser/Networking/urls","standard/Networking/URI","standard/Math/Algorithm","x_ite/DEBUG"],function(t,e,n,i,r,o,s,a,u,l,c){"use strict";function h(t){r.call(this,t),o.call(this,t),this.addType(s.ImageTexture),this.addChildObjects("buffer",new e.SFTime),this.urlStack=new e.MFString}return h.prototype=Object.assign(Object.create(r.prototype),o.prototype,{constructor:h,fieldDefinitions:new i([new n(s.inputOutput,"metadata",new e.SFNode),new n(s.inputOutput,"url",new e.MFString),new n(s.initializeOnly,"repeatS",new e.SFBool(!0)),new n(s.initializeOnly,"repeatT",new e.SFBool(!0)),new n(s.initializeOnly,"textureProperties",new e.SFNode)]),getTypeName:function(){return"ImageTexture"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texture"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this),this.url_.addInterest("set_url__",this),this.buffer_.addInterest("set_buffer__",this),this.canvas=t("<canvas></canvas>"),this.image=t("<img></img>"),this.image.on("load",this.setImage.bind(this)),this.image.on("error",this.setError.bind(this)),this.image.bind("abort",this.setError.bind(this)),this.image[0].crossOrigin="Anonymous",this.set_url__()},set_url__:function(){this.setLoadState(s.NOT_STARTED_STATE),this.requestAsyncLoad()},requestAsyncLoad:function(){this.checkLoadState()!==s.COMPLETE_STATE&&this.checkLoadState()!==s.IN_PROGRESS_STATE&&(this.setLoadState(s.IN_PROGRESS_STATE),this.buffer_.addEvent())},set_buffer__:function(){this.urlStack.setValue(this.url_),this.loadNext()},loadNext:function(){if(0===this.urlStack.length)return this.clearTexture(),void this.setLoadState(s.FAILED_STATE);this.URL=new u(this.urlStack.shift()),this.URL=this.getExecutionContext().getURL().transform(this.URL),this.image.attr("src",this.URL.toString())},setError:function(){var t=this.URL.toString();c&&(this.URL.isLocal()||"localhost"===this.URL.host||t.match(a.getFallbackExpression())||this.urlStack.unshift(a.getFallbackUrl(t))),"data"!==this.URL.scheme&&console.warn("Error loading image:",this.URL.toString()),this.loadNext()},setImage:function(){c&&"data"!==this.URL.scheme&&console.info("Done loading image:",this.URL.toString());try{var t=this.getBrowser().getContext(),e=this.image[0],n=e.width,i=e.height,r=this.canvas[0],o=r.getContext("2d");t.getVersion()>=2||l.isPowerOfTwo(n)&&l.isPowerOfTwo(i)?(r.width=n,r.height=i,o.clearRect(0,0,n,i),o.save(),o.translate(0,i),o.scale(1,-1),o.drawImage(e,0,0),o.restore()):(n=l.nextPowerOfTwo(n),i=l.nextPowerOfTwo(i),r.width=n,r.height=i,o.clearRect(0,0,n,i),o.save(),o.translate(0,i),o.scale(1,-1),o.drawImage(e,0,0,e.width,e.height,0,0,n,i),o.restore());for(var a=o.getImageData(0,0,n,i).data,u=!1,h=3;h<a.length;h+=4)if(255!==a[h]){u=!0;break}this.setTexture(n,i,u,new Uint8Array(a),!1),this.setLoadState(s.COMPLETE_STATE)}catch(t){console.log(t.message),this.setError()}}}),h}),define("x_ite/Components/Texturing/TextureProperties",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.TextureProperties)}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"borderColor",new t.SFColorRGBA),new e(r.inputOutput,"borderWidth",new t.SFInt32),new e(r.inputOutput,"anisotropicDegree",new t.SFFloat(1)),new e(r.initializeOnly,"generateMipMaps",new t.SFBool),new e(r.inputOutput,"minificationFilter",new t.SFString("FASTEST")),new e(r.inputOutput,"magnificationFilter",new t.SFString("FASTEST")),new e(r.inputOutput,"boundaryModeS",new t.SFString("REPEAT")),new e(r.inputOutput,"boundaryModeT",new t.SFString("REPEAT")),new e(r.inputOutput,"boundaryModeR",new t.SFString("REPEAT")),new e(r.inputOutput,"textureCompression",new t.SFString("FASTEST")),new e(r.inputOutput,"texturePriority",new t.SFFloat)]),getTypeName:function(){return"TextureProperties"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"textureProperties"},getBorderWidth:function(){return o.clamp(this.borderWidth_.getValue(),0,1)},getBoundaryMode:function(){var t=new Map([["CLAMP","CLAMP_TO_EDGE"],["CLAMP_TO_EDGE","CLAMP_TO_EDGE"],["CLAMP_TO_BOUNDARY","CLAMP_TO_EDGE"],["MIRRORED_REPEAT","MIRRORED_REPEAT"],["REPEAT","REPEAT"]]);return function(e){var n=t.get(e);return void 0!==n?n:"REPEAT"}}(),getBoundaryModeS:function(){return this.getBoundaryMode(this.boundaryModeS_.getValue())},getBoundaryModeT:function(){return this.getBoundaryMode(this.boundaryModeT_.getValue())},getBoundaryModeR:function(){return this.getBoundaryMode(this.boundaryModeR_.getValue())},getMinificationFilter:function(){var t=new Map([["AVG_PIXEL_AVG_MIPMAP","LINEAR_MIPMAP_LINEAR"],["AVG_PIXEL","LINEAR"],["AVG_PIXEL_NEAREST_MIPMAP","LINEAR_MIPMAP_NEAREST"],["NEAREST_PIXEL_AVG_MIPMAP","NEAREST_MIPMAP_LINEAR"],["NEAREST_PIXEL_NEAREST_MIPMAP","NEAREST_MIPMAP_NEAREST"],["NEAREST_PIXEL","NEAREST"],["NICEST","LINEAR_MIPMAP_LINEAR"],["FASTEST","NEAREST"]]);return function(){if(this.generateMipMaps_.getValue()){var e=t.get(this.minificationFilter_.getValue());return void 0!==e?e:this.getBrowser().getDefaultTextureProperties().getMinificationFilter()}return"LINEAR"}}(),getMagnificationFilter:function(){var t=new Map([["AVG_PIXEL","LINEAR"],["NEAREST_PIXEL","NEAREST"],["NICEST","LINEAR"],["FASTEST","NEAREST"]]);return function(){var e=t.get(this.magnificationFilter_.getValue());return void 0!==e?e:this.getBrowser().getDefaultTextureProperties().getMagnificationFilter()}}(),getTextureCompression:function(){var t=new Map([["DEFAULT","RGBA"],["NICEST","RGBA"],["FASTEST","RGBA"],["LOW","RGBA"],["MEDIUM","RGBA"],["HIGH","RGBA"]]);return function(){var e=this.getBrowser(),n=e.getContext(),i=e.getExtension("WEBGL_compressed_texture_etc"),r=i[t.get(this.textureCompression_.getValue())];return void 0!==r?r:n.RGBA}}()}),s}),define("x_ite/Browser/Shape/X3DShapeContext",["x_ite/Components/Shape/Appearance","x_ite/Components/Shape/LineProperties","x_ite/Components/Shape/FillProperties","x_ite/Components/Texturing/ImageTexture","x_ite/Components/Texturing/TextureProperties","x_ite/Browser/Networking/urls"],function(t,e,n,i,r,o){"use strict";function s(){this.linetypeTextures=[],this.hatchStyleTextures=[]}return s.prototype={initialize:function(){},getDefaultAppearance:function(){return this.defaultAppearance?this.defaultAppearance:(this.defaultAppearance=new t(this.getPrivateScene()),this.defaultAppearance.setup(),this.defaultAppearance)},getDefaultLineProperties:function(){return this.defaultLineProperties?this.defaultLineProperties:(this.defaultLineProperties=new e(this.getPrivateScene()),this.defaultLineProperties.applied_=!1,this.defaultLineProperties.setup(),this.defaultLineProperties)},getDefaultFillProperties:function(){return this.defaultFillProperties?this.defaultFillProperties:(this.defaultFillProperties=new n(this.getPrivateScene()),this.defaultFillProperties.hatched_=!1,this.defaultFillProperties.setup(),this.defaultFillProperties)},getLinetype:function(t){(t<1||t>15)&&(t=1);var e=this.linetypeTextures[t];return e?e:(e=this.linetypeTextures[t]=new i(this.getPrivateScene()),e.url_[0]=o.getLinetypeUrl(t),e.textureProperties_=this.getLineFillTextureProperties(),e.setup(),e)},getHatchStyle:function(t){(t<1||t>19)&&(t=1);var e=this.hatchStyleTextures[t];return e?e:(e=this.hatchStyleTextures[t]=new i(this.getPrivateScene()),e.url_[0]=o.getHatchingUrl(t),e.textureProperties_=this.getLineFillTextureProperties(),e.setup(),e)},getLineFillTextureProperties:function(){return this.lineFillTextureProperties?this.lineFillTextureProperties:(this.lineFillTextureProperties=new r(this.getPrivateScene()),this.lineFillTextureProperties.setup(),this.lineFillTextureProperties)}},s}),define("standard/Math/Geometry/Box3",["standard/Math/Geometry/Triangle3","standard/Math/Numbers/Matrix4","standard/Math/Numbers/Vector3","standard/Math/Algorithms/SAT"],function(t,e,n,i){"use strict";function r(t,n){switch(arguments.length){case 0:return void(this.matrix=new e(.5,0,0,0,0,.5,0,0,0,0,.5,0,0,0,0,0));case 2:return void(this.matrix=new e(t.x/2,0,0,0,0,t.y/2,0,0,0,0,t.z/2,0,n.x,n.y,n.z,1));case 3:var i=arguments[0],r=arguments[1],o=(r.x-i.x)/2,s=(r.y-i.y)/2,a=(r.z-i.z)/2,u=(r.x+i.x)/2,l=(r.y+i.y)/2,c=(r.z+i.z)/2;return void(this.matrix=new e(o,0,0,0,0,s,0,0,0,0,a,0,u,l,c,1))}}return r.prototype={constructor:r,copy:function(){var t=Object.create(r.prototype);return t.matrix=this.matrix.copy(),t},assign:function(t){return this.matrix.assign(t.matrix),this},equals:function(t){return this.matrix.equals(t.matrix)},getMatrix:function(){return this.matrix},set:function(t,e){var n=this.matrix;switch(arguments.length){case 0:return n[0]=.5,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=.5,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=.5,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=0,this;case 2:return n[0]=t.x/2,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=t.y/2,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=t.z/2,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this;case 3:var i=arguments[0],r=arguments[1],o=(r.x-i.x)/2,s=(r.y-i.y)/2,a=(r.z-i.z)/2,u=(r.x+i.x)/2,l=(r.y+i.y)/2,c=(r.z+i.z)/2;return this.matrix.set(o,0,0,0,0,s,0,0,0,0,a,0,u,l,c,1),this}},setExtents:function(t,e){var n=this.matrix,i=(e.x-t.x)/2,r=(e.y-t.y)/2,o=(e.z-t.z)/2,s=(e.x+t.x)/2,a=(e.y+t.y)/2,u=(e.z+t.z)/2;return n[0]=i,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=r,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=o,n[11]=0,n[12]=s,n[13]=a,n[14]=u,n[15]=1,this},getExtents:function(t,e){this.getAbsoluteExtents(t,e),t.add(this.center),e.add(this.center)},getAbsoluteExtents:function(){var t=new n(0,0,0),e=new n(0,0,0),i=new n(0,0,0);return function(n,r){var o=this.matrix,s=o.xAxis,a=o.yAxis,u=o.zAxis;t.assign(a).add(u);var l=u.subtract(a);e.assign(s).add(t),i.assign(s).add(l);var c=t.subtract(s),h=l.subtract(s);n.assign(e),r.assign(e),n.min(c,h,i),r.max(c,h,i),e.negate(),c.negate(),h.negate(),i.negate(),n.min(e,c,h,i),r.max(e,c,h,i)}}(),getPoints:function(){var t=new n(0,0,0),e=new n(0,0,0),i=new n(0,0,0),r=new n(0,0,0);return function(n){var o=this.matrix;t.assign(o.xAxis),e.assign(o.yAxis),i.assign(o.zAxis),r.assign(e).add(i);var s=i.subtract(e);n[0].assign(t).add(r),n[1].assign(r).subtract(t),n[2].assign(s).subtract(t),n[3].assign(t).add(s),n[4].assign(n[2]).negate(),n[5].assign(n[3]).negate(),n[6].assign(n[0]).negate(),n[7].assign(n[1]).negate();var a=this.center;return n[0].add(a),n[1].add(a),n[2].add(a),n[3].add(a),n[4].add(a),n[5].add(a),n[6].add(a),n[7].add(a),n}}(),getAxes:function(t){var e=this.matrix;return t[0].assign(e.xAxis),t[1].assign(e.yAxis),t[2].assign(e.zAxis),t},getNormals:function(){var t=new n(0,0,0),e=new n(0,0,0),i=new n(0,0,0),r=[n.xAxis,n.yAxis,n.zAxis];return function(o){var s=this.matrix;if(t.assign(s.xAxis),e.assign(s.yAxis),i.assign(s.zAxis),0==t.norm()&&0==e.norm()&&0==i.norm())t.assign(n.xAxis),e.assign(n.yAxis),i.assign(n.zAxis);else{if(0==t.norm()){if(t.assign(e).cross(i),0==t.norm())for(var a=0;a<3&&(t.assign(r[a]).cross(e),0==t.norm());++a);if(0==t.norm())for(var a=0;a<3&&(t.assign(r[a]).cross(i),0==t.norm());++a);0==t.norm()?t.assign(n.xAxis):t.normalize()}if(0==e.norm()){if(e.assign(i).cross(t),0==e.norm())for(var a=0;a<3&&(e.assign(r[a]).cross(i),0==e.norm());++a);if(0==e.norm())for(var a=0;a<3&&(e.assign(r[a]).cross(t),0==e.norm());++a);0==e.norm()?e.assign(n.yAxis):e.normalize()}if(0==i.norm()){if(i.assign(t).cross(e),0==i.norm())for(var a=0;a<3&&(i.assign(r[a]).cross(t),0==i.norm());++a);if(0==i.norm())for(var a=0;a<3&&(i.assign(r[a]).cross(e),0==i.norm());++a);0==i.norm()?i.assign(n.zAxis):i.normalize()}}return o[0].assign(e).cross(i).normalize(),o[1].assign(i).cross(t).normalize(),o[2].assign(t).cross(e).normalize(),o}}(),isEmpty:function(){return 0===this.matrix[15]},add:function(){var t=new n(0,0,0),e=new n(0,0,0),i=new n(0,0,0),r=new n(0,0,0);return function(n){return this.isEmpty()?this.assign(n):n.isEmpty()?this:(this.getExtents(t,e),n.getExtents(i,r),this.set(t.min(i),e.max(r),!0))}}(),multLeft:function(t){return this.matrix.multLeft(t),this},multRight:function(t){return this.matrix.multRight(t),this},intersectsPoint:function(){var t=new n(0,0,0),e=new n(0,0,0);return function(n){return this.getExtents(t,e),t.x<=n.x&&e.x>=n.x&&t.y<=n.y&&e.y>=n.y&&t.z<=n.z&&e.z>=n.z}}(),intersectsBox:function(){var t=[new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0)],e=[new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0)],r=[new n(0,0,0),new n(0,0,0),new n(0,0,0)],o=[new n(0,0,0),new n(0,0,0),new n(0,0,0)],s=[new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0)],a=[new n(0,0,0),new n(0,0,0),new n(0,0,0)];return function(n){if(this.isEmpty())return!1;if(n.isEmpty())return!1;if(this.getPoints(t),n.getPoints(e),i.isSeparated(this.getNormals(a),t,e))return!1;if(i.isSeparated(n.getNormals(a),t,e))return!1;this.getAxes(r),n.getAxes(o);for(var u=0;u<3;++u)for(var l=0;l<3;++l)s[3*u+l].assign(r[u]).cross(o[l]);return!i.isSeparated(s,t,e)}}(),intersectsTriangle:function(){var e=[new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0)],r=[new n(0,0,0),new n(0,0,0),new n(0,0,0)],o=[new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0)],s=[new n(0,0,0),new n(0,0,0),new n(0,0,0)],a=[],u=[new n(0,0,0)],l=[new n(0,0,0),new n(0,0,0),new n(0,0,0)];return function(n,c,h){if(this.isEmpty())return!1;if(this.getPoints(e),a[0]=n,a[1]=c,a[2]=h,i.isSeparated(this.getNormals(s),e,a))return!1;if(t.normal(n,c,h,u[0]),i.isSeparated(u,e,a))return!1;this.getAxes(r),l[0].assign(n).subtract(c),l[1].assign(c).subtract(h),l[2].assign(h).subtract(n);for(var d=0;d<3;++d)for(var p=0;p<3;++p)o[3*d+p].assign(r[d]).cross(l[p]);return!i.isSeparated(o,e,a)}}(),toString:function(){return this.size+", "+this.center}},Object.defineProperty(r.prototype,"size",{get:function(){var t=new n(0,0,0),e=new n(0,0,0);return function(){return this.getAbsoluteExtents(t,e),e.subtract(t)}}(),enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"center",{get:function(){return this.matrix.origin},enumerable:!0,configurable:!1}),r}),define("x_ite/Components/Rendering/X3DGeometryNode",["x_ite/Fields","x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants","x_ite/Browser/Core/Shading","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Box3","standard/Math/Geometry/Plane3","standard/Math/Geometry/Triangle3","standard/Math/Algorithm"],function(t,e,n,i,r,o,s,a,u,l,c){"use strict";function h(i){e.call(this,i),this.addType(n.X3DGeometryNode),this.addChildObjects("transparent",new t.SFBool,"bbox_changed",new t.SFTime,"rebuild",new t.SFTime),this.transparent_.setAccessType(n.outputOnly),this.bbox_changed_.setAccessType(n.outputOnly),this.rebuild_.setAccessType(n.outputOnly),this.min=new o(0,0,0),this.max=new o(0,0,0),this.bbox=new a(this.min,this.max,!0),this.solid=!0,this.geometryType=3,this.flatShading=void 0,this.colorMaterial=!1,this.attribNodes=[],this.attribs=[],this.textureCoordinateNode=this.getBrowser().getDefaultTextureCoordinate(),this.multiTexCoords=[],this.texCoords=h.createArray(),this.fogDepths=h.createArray(),this.colors=h.createArray(),this.normals=h.createArray(),this.flatNormals=h.createArray(),this.vertices=h.createArray(),this.vertexCount=0,this.depth=Function.prototype,this.display=Function.prototype,this.displayParticles=Function.prototype}var d=[new o(0,0,1),new o(0,0,-1),new o(0,1,0),new o(0,-1,0),new o(1,0,0)];return h.createArray=function(){var t=[];return t.typedArray=new Float32Array,t.assign=function(t){for(var e=0,n=t.length;e<n;++e)this[e]=t[e];this.length=n},t.getValue=function(){return this.typedArray},t.shrinkToFit=function(){this.length!==this.typedArray.length?this.typedArray=new Float32Array(this):this.typedArray.set(this)},t},h.prototype=Object.assign(Object.create(e.prototype),{constructor:h,setup:function(){e.prototype.setup.call(this),this.rebuild()},initialize:function(){e.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this),this.addInterest("requestRebuild",this),this.rebuild_.addInterest("rebuild",this);var t=this.getBrowser().getContext();if(this.primitiveMode=t.TRIANGLES,this.frontFace=t.CCW,this.attribBuffers=[],this.texCoordBuffers=[],this.fogDepthBuffer=t.createBuffer(),this.colorBuffer=t.createBuffer(),this.normalBuffer=t.createBuffer(),this.vertexBuffer=t.createBuffer(),this.planes=[],this.geometryType>1)for(var n=0;n<5;++n)this.planes[n]=new u(o.Zero,d[0]);this.set_live__()},setGeometryType:function(t){this.geometryType=t},getGeometryType:function(){return this.geometryType},setTransparent:function(t){t!==this.transparent_.getValue()&&(this.transparent_=t)},getTransparent:function(){return this.transparent_.getValue()},getBBox:function(){return this.bbox},setBBox:function(t){if(!t.equals(this.bbox)){t.getExtents(this.min,this.max),this.bbox.assign(t);for(var e=0;e<5;++e)this.planes[e].set(e%2?this.min:this.max,d[e]);this.bbox_changed_.addEvent()}},getMin:function(){return this.min},getMax:function(){return this.max},getMatrix:function(){return s.Identity},setPrimitiveMode:function(t){this.primitiveMode=t},getPrimitiveMode:function(){return this.primitiveMode},setSolid:function(t){this.solid=t},setCCW:function(t){this.frontFace=t?this.getBrowser().getContext().CCW:this.getBrowser().getContext().CW},getAttrib:function(){return this.attribNodes},getAttribs:function(){return this.attribs},setFogDepths:function(t){this.fogDepths.assign(t)},getFogDepths:function(){return this.fogDepths},setColors:function(t){this.colors.assign(t)},getColors:function(){return this.colors},setMultiTexCoords:function(t){for(var e=this.multiTexCoords,n=0,i=t.length;n<i;++n)e[n]=t[n];e.length=i},getMultiTexCoords:function(){return this.multiTexCoords},getTexCoords:function(){return this.texCoords},setTextureCoordinate:function(t){this.textureCoordinateNode=t?t:this.getBrowser().getDefaultTextureCoordinate()},setNormals:function(t){this.normals.assign(t)},getNormals:function(){return this.normals},setVertices:function(t){this.vertices.assign(t)},getVertices:function(){return this.vertices},buildTexCoords:function(){var t=this.texCoords;if(0===t.length){for(var e=this.getTexCoordParams(),n=e.min,i=e.Sindex,r=e.Tindex,o=e.Ssize,s=n[i],a=n[r],u=this.vertices.getValue(),l=0,c=u.length;l<c;l+=4)t.push((u[l+i]-s)/o,(u[l+r]-a)/o,0,1);t.shrinkToFit()}return t},getTexCoordParams:function(){var t={min:new o(0,0,0)};return function(){var e=this.getBBox(),n=e.size,i=n.x,r=n.y,o=n.z;return t.min.assign(e.center).subtract(n.divide(2)),i>=r&&i>=o?(t.Ssize=i,t.Sindex=0,t.Tindex=r>=o?1:2):r>=i&&r>=o?(t.Ssize=r,t.Sindex=1,t.Tindex=i>=o?0:2):(t.Ssize=o,t.Sindex=2,t.Tindex=i>=r?0:1),t}}(),refineNormals:function(t,e,n){if(0===n)return e;var i=Math.cos(c.clamp(n,0,Math.PI)),r=[];for(var s in t)for(var a=t[s],u=0,l=a.length;u<l;++u){for(var h=a[u],d=e[h],p=new o(0,0,0),f=0;f<l;++f){var g=e[a[f]];g.dot(d)>=i&&p.add(g)}r[h]=p.normalize()}return r},isClipped:function(t,e){return e.some(function(e){return e.isClipped(t)})},transformLine:function(t){},transformMatrix:function(t){},intersectsLine:function(){var t=new s,e={u:0,v:0,t:0},n=new o(0,0,0),i=new o(0,0,0),a=new o(0,0,0),u=new o(0,0,0);return function(s,l,c,h){try{var d=!1;if(this.intersectsBBox(s)){this.transformLine(s),this.transformMatrix(t.assign(c));for(var p=this.multiTexCoords[0].getValue(),f=this.normals.getValue(),g=this.vertices.getValue(),m=0,x=this.vertexCount;m<x;m+=3){var v=4*m;if(n.x=g[v],n.y=g[v+1],n.z=g[v+2],i.x=g[v+4],i.y=g[v+5],i.z=g[v+6],a.x=g[v+8],a.y=g[v+9],a.z=g[v+10],s.intersectsTriangle(n,i,a,e)){var _=e.u,y=e.v,w=e.t,b=new o(w*g[v]+_*g[v+4]+y*g[v+8],w*g[v+1]+_*g[v+5]+y*g[v+9],w*g[v+2]+_*g[v+6]+y*g[v+10]);if(this.isClipped(t.multVecMatrix(u.assign(b)),l))continue;var S=new r(w*p[v]+_*p[v+4]+y*p[v+8],w*p[v+1]+_*p[v+5]+y*p[v+9]),C=3*m,T=new o(w*f[C]+_*f[C+3]+y*f[C+6],w*f[C+1]+_*f[C+4]+y*f[C+7],w*f[C+2]+_*f[C+5]+y*f[C+8]);h.push({texCoord:S,normal:T,point:this.getMatrix().multVecMatrix(b)}),d=!0}}}return d}catch(t){return console.log(t),!1}}}(),intersectsBBox:function(){var t=new o(0,0,0);return function(e){var n=this.planes,i=this.min,r=this.max,o=i.x,s=r.x,a=i.y,u=r.y,l=i.z,c=r.z;return!!(n[0].intersectsLine(e,t)&&t.x>=o&&t.x<=s&&t.y>=a&&t.y<=u)||(!!(n[1].intersectsLine(e,t)&&t.x>=o&&t.x<=s&&t.y>=a&&t.y<=u)||(!!(n[2].intersectsLine(e,t)&&t.x>=o&&t.x<=s&&t.z>=l&&t.z<=c)||(!!(n[3].intersectsLine(e,t)&&t.x>=o&&t.x<=s&&t.z>=l&&t.z<=c)||!!(n[4].intersectsLine(e,t)&&t.y>=a&&t.y<=u&&t.z>=l&&t.z<=c))))}}(),intersectsBox:function(){var t=new o(0,0,0),e=new o(0,0,0),n=new o(0,0,0),i=new s,r=new o(0,0,0);return function(o,s,a){try{if(o.intersectsBox(this.bbox)){o.multRight(i.assign(this.getMatrix()).inverse()),this.transformMatrix(a);for(var u=this.vertices.getValue(),l=0,c=this.vertexCount;l<c;l+=3){var h=4*l;if(t.x=u[h],t.y=u[h+1],t.z=u[h+2],e.x=u[h+4],e.y=u[h+5],e.z=u[h+6],n.x=u[h+8],n.y=u[h+9],n.z=u[h+10],o.intersectsTriangle(t,e,n)){if(s.length){if(this.isClipped(a.multVecMatrix(r.assign(t)),s))continue;if(this.isClipped(a.multVecMatrix(r.assign(e)),s))continue;if(this.isClipped(a.multVecMatrix(r.assign(n)),s))continue}return!0}}}return!1}catch(t){return console.log(t),!1}}}(),set_live__:function(){this.isLive().getValue()?this.getBrowser().getBrowserOptions().Shading_.addInterest("set_shading__",this):this.getBrowser().getBrowserOptions().Shading_.removeInterest("set_shading__",this)},set_shading__:function(){var t=new o(0,0,0),e=new o(0,0,0),n=new o(0,0,0),r=new o(0,0,0);return function(o){if(!(this.geometryType<2)){var s=this.getBrowser().getBrowserOptions().getShading()===i.FLAT;if(s!==this.flatShading){this.flatShading=s;var a=this.getBrowser().getContext();if(s&&!this.flatNormals.length){for(var u=this.frontFace===a.CW,c=this.flatNormals,h=this.vertices.getValue(),d=0,p=h.length;d<p;d+=12)l.normal(t.set(h[d],h[d+1],h[d+2]),e.set(h[d+4],h[d+5],h[d+6]),n.set(h[d+8],h[d+9],h[d+10]),r),u&&r.negate(),c.push(r.x,r.y,r.z,r.x,r.y,r.z,r.x,r.y,r.z);c.shrinkToFit()}a.bindBuffer(a.ARRAY_BUFFER,this.normalBuffer),a.bufferData(a.ARRAY_BUFFER,s?this.flatNormals.getValue():this.normals.getValue(),a.STATIC_DRAW)}}}}(),requestRebuild:function(){this.rebuild_.addEvent()},rebuild:function(){var t=new o(0,0,0);return function(){this.clear(),this.build();for(var e=0,n=this.attribs.length;e<n;++e)this.attribs[e].shrinkToFit();for(var e=0,n=this.multiTexCoords.length;e<n;++e)this.multiTexCoords[e].shrinkToFit();this.fogDepths.shrinkToFit(),this.colors.shrinkToFit(),this.normals.shrinkToFit(),this.vertices.shrinkToFit();var i=this.min,r=this.max,o=this.vertices.getValue();if(o.length){if(i.x===Number.POSITIVE_INFINITY)for(var e=0,n=o.length;e<n;e+=4)t.set(o[e],o[e+1],o[e+2]),i.min(t),r.max(t);this.bbox.setExtents(i,r)}else this.bbox.setExtents(i.set(0,0,0),r.set(0,0,0));if(this.bbox_changed_.addEvent(),this.geometryType>1){for(var e=0;e<5;++e)this.planes[e].set(e%2?i:r,d[e]);0===this.multiTexCoords.length&&this.multiTexCoords.push(this.buildTexCoords());for(var s=this.multiTexCoords.length-1,e=this.multiTexCoords.length,n=this.getBrowser().getMaxTextures();e<n;++e)this.multiTexCoords[e]=this.multiTexCoords[s];this.multiTexCoords.length=n}this.set_shading__(this.getBrowser().getBrowserOptions().Shading_),this.transfer()}}(),clear:function(){this.min.set(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),this.max.set(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(var t=this.attribs,e=0,n=t.length;e<n;++e)t[e].length=0;for(var e=t.length,n=this.attribNodes.length;e<n;++e)t[e]=h.createArray();t.length=n,this.flatShading=void 0,this.fogDepths.length=0,this.colors.length=0,this.multiTexCoords.length=0,this.texCoords.length=0,this.normals.length=0,this.flatNormals.length=0,this.vertices.length=0},transfer:function(){for(var t=this.getBrowser().getContext(),e=this.vertices.length/4,n=this.attribBuffers.length,i=this.attribs.length;n<i;++n)this.attribBuffers.push(t.createBuffer());for(var n=0,i=this.attribs.length;n<i;++n)t.bindBuffer(t.ARRAY_BUFFER,this.attribBuffers[n]),t.bufferData(t.ARRAY_BUFFER,this.attribs[n].getValue(),t.STATIC_DRAW);t.bindBuffer(t.ARRAY_BUFFER,this.fogDepthBuffer),t.bufferData(t.ARRAY_BUFFER,this.fogDepths.getValue(),t.STATIC_DRAW),this.fogCoords=!!this.fogDepths.length,t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,this.colors.getValue(),t.STATIC_DRAW),this.colorMaterial=!!this.colors.length;for(var n=this.texCoordBuffers.length,i=this.multiTexCoords.length;n<i;++n)this.texCoordBuffers.push(t.createBuffer());for(var n=0,i=this.multiTexCoords.length;n<i;++n)t.bindBuffer(t.ARRAY_BUFFER,this.texCoordBuffers[n]),t.bufferData(t.ARRAY_BUFFER,this.multiTexCoords[n].getValue(),t.STATIC_DRAW);t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices.getValue(),t.STATIC_DRAW),this.vertexCount=e,this.vertexCount?(delete this.depth,delete this.display,delete this.displayParticles):(this.depth=Function.prototype,this.display=Function.prototype,this.displayParticles=Function.prototype)},traverse:function(t,e){},depth:function(t,e,n){n.getValid()&&(n.enableVertexAttribute(t,this.vertexBuffer),t.drawArrays(this.primitiveMode,0,this.vertexCount))},display:function(t,e){try{var n=e.shaderNode;if(n.getValid()){var i=this.attribNodes,r=this.attribBuffers;e.geometryType=this.geometryType,e.fogCoords=this.fogCoords,e.colorMaterial=this.colorMaterial,e.textureCoordinateNode=this.textureCoordinateNode,n.enable(t),n.setLocalUniforms(t,e);for(var o=0,a=i.length;o<a;++o)i[o].enable(t,n,r[o]);if(this.fogCoords&&n.enableFogDepthAttribute(t,this.fogDepthBuffer),this.colorMaterial&&n.enableColorAttribute(t,this.colorBuffer),n.enableTexCoordAttribute(t,this.texCoordBuffers),n.enableNormalAttribute(t,this.normalBuffer),n.enableVertexAttribute(t,this.vertexBuffer),n.wireframe)for(var o=0,a=this.vertexCount;o<a;o+=3)t.drawArrays(n.primitiveMode,o,3);else{var u=s.prototype.determinant3.call(e.modelViewMatrix)>0;t.frontFace(u?this.frontFace:this.frontFace===t.CCW?t.CW:t.CCW),e.transparent&&!this.solid?(t.enable(t.CULL_FACE),t.cullFace(t.FRONT),t.drawArrays(n.primitiveMode,0,this.vertexCount),t.cullFace(t.BACK),t.drawArrays(n.primitiveMode,0,this.vertexCount)):(this.solid?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),t.drawArrays(n.primitiveMode,0,this.vertexCount))}for(var o=0,a=i.length;o<a;++o)i[o].disable(t,n);this.fogCoords&&n.disableFogDepthAttribute(t),this.colorMaterial&&n.disableColorAttribute(t),n.disableTexCoordAttribute(t),n.disableNormalAttribute(t),n.disable(t)}}catch(t){console.log(t)}},displayParticlesDepth:function(t,e,n,i,r){if(n.getValid()){var t=e.browser.getContext();n.enableVertexAttribute(t,this.vertexBuffer);for(var o=e.modelViewMatrix,a=o[12],u=o[13],l=o[14],c=0;c<r;++c){var h=i[c];o[12]=a,o[13]=u,o[14]=l,s.prototype.translate.call(o,h.position),n.setParticle(t,c,h,o,!1),t.drawArrays(n.primitiveMode,0,this.vertexCount)}}},displayParticles:function(t,e,n,i){try{var r=e.shaderNode;if(r.getValid()){var o=this.attribNodes,a=this.attribBuffers;e.geometryType=this.geometryType,e.fogCoords=this.fogCoords,e.colorMaterial=this.colorMaterial,e.textureCoordinateNode=this.textureCoordinateNode,r.enable(t),r.setLocalUniforms(t,e);for(var u=0,l=o.length;u<l;++u)o[u].enable(t,r,a[u]);this.fogCoords&&r.enableFogDepthAttribute(t,this.fogDepthBuffer),this.colorMaterial&&r.enableColorAttribute(t,this.colorBuffer),r.enableTexCoordAttribute(t,this.texCoordBuffers),r.enableNormalAttribute(t,this.normalBuffer),r.enableVertexAttribute(t,this.vertexBuffer);var c=e.materialNode,h=c||r.getCustom(),d=e.modelViewMatrix,p=d[12],f=d[13],g=d[14];if(r.wireframe)for(var m=0;m<i;++m){var x=n[m];d[12]=p,d[13]=f,d[14]=g,s.prototype.translate.call(d,x.position),r.setParticle(t,m,x,d,h);for(var u=0,l=this.vertexCount;u<l;u+=3)t.drawArrays(r.primitiveMode,u,3)}else{var v=s.prototype.determinant3.call(e.modelViewMatrix)>0;if(t.frontFace(v?this.frontFace:this.frontFace===t.CCW?t.CW:t.CCW),e.transparent&&!this.solid)for(var m=0;m<i;++m){var x=n[m];d[12]=p,d[13]=f,d[14]=g,s.prototype.translate.call(d,x.position),r.setParticle(t,m,x,d,h),t.enable(t.CULL_FACE),t.cullFace(t.FRONT),t.drawArrays(r.primitiveMode,0,this.vertexCount),t.cullFace(t.BACK),t.drawArrays(r.primitiveMode,0,this.vertexCount)}else{this.solid?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE);for(var m=0;m<i;++m){var x=n[m];d[12]=p,d[13]=f,d[14]=g,s.prototype.translate.call(d,x.position),r.setParticle(t,m,x,d,h),t.drawArrays(r.primitiveMode,0,this.vertexCount)}}}for(var u=0,l=o.length;u<l;++u)o[u].disable(t,r);this.fogCoords&&r.disableFogDepthAttribute(t),this.colorMaterial&&r.disableColorAttribute(t),r.disableTexCoordAttribute(t),r.disableNormalAttribute(t),r.disable(t)}}catch(t){console.log(t)}}}),h}),define("x_ite/Components/Rendering/X3DComposedGeometryNode",["x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,n,i){"use strict";function r(e){t.call(this,e),this.addType(n.X3DComposedGeometryNode),this.fogCoordNode=null,this.colorNode=null,this.texCoordNode=null,this.normalNode=null,this.coordNode=null}return r.prototype=Object.assign(Object.create(t.prototype),{constructor:r,initialize:function(){t.prototype.initialize.call(this),this.attrib_.addInterest("set_attrib__",this),this.fogCoord_.addInterest("set_fogCoord__",this),this.color_.addInterest("set_color__",this),this.texCoord_.addInterest("set_texCoord__",this),this.normal_.addInterest("set_normal__",this),this.coord_.addInterest("set_coord__",this),this.set_attrib__(),this.set_fogCoord__(),this.set_color__(),this.set_texCoord__(),this.set_normal__(),
this.set_coord__()},getFogCoord:function(){return this.fogCoordNode},getColor:function(){return this.colorNode},getTexCoord:function(){return this.texCoordNode},getNormal:function(){return this.normalNode},getCoord:function(){return this.coordNode},set_attrib__:function(){for(var t=this.getAttrib(),i=0,r=t.length;i<r;++i)t[i].removeInterest("requestRebuild",this);t.length=0;for(var i=0,r=this.attrib_.length;i<r;++i){var o=e(n.X3DVertexAttributeNode,this.attrib_[i]);o&&t.push(o)}for(var i=0;i<this.attribNodes.length;++i)t[i].addInterest("requestRebuild",this)},set_fogCoord__:function(){this.fogCoordNode&&this.fogCoordNode.removeInterest("requestRebuild",this),this.fogCoordNode=e(n.FogCoordinate,this.fogCoord_),this.fogCoordNode&&this.fogCoordNode.addInterest("requestRebuild",this)},set_color__:function(){this.colorNode&&(this.colorNode.removeInterest("requestRebuild",this),this.colorNode.transparent_.removeInterest("set_transparent__",this)),this.colorNode=e(n.X3DColorNode,this.color_),this.colorNode?(this.colorNode.addInterest("requestRebuild",this),this.colorNode.transparent_.addInterest("set_transparent__",this),this.set_transparent__()):this.setTransparent(!1)},set_transparent__:function(){this.setTransparent(this.colorNode.getTransparent())},set_texCoord__:function(){this.texCoordNode&&this.texCoordNode.removeInterest("requestRebuild",this),this.texCoordNode=e(n.X3DTextureCoordinateNode,this.texCoord_),this.texCoordNode&&this.texCoordNode.addInterest("requestRebuild",this),this.setTextureCoordinate(this.texCoordNode)},set_normal__:function(){this.normalNode&&this.normalNode.removeInterest("requestRebuild",this),this.normalNode=e(n.X3DNormalNode,this.normal_),this.normalNode&&this.normalNode.addInterest("requestRebuild",this)},set_coord__:function(){this.coordNode&&this.coordNode.removeInterest("requestRebuild",this),this.coordNode=e(n.X3DCoordinateNode,this.coord_),this.coordNode&&this.coordNode.addInterest("requestRebuild",this)},getPolygonIndex:function(t){return t},getTriangleIndex:function(t){return t},build:function(t,e,n,i){if(this.coordNode&&!this.coordNode.isEmpty()){e-=e%t,i-=i%n;var r=this.colorPerVertex_.getValue(),o=this.normalPerVertex_.getValue(),s=this.getAttrib(),a=s.length,u=this.getAttribs(),l=this.getFogCoord(),c=this.getColor(),h=this.getTexCoord(),d=this.getNormal(),p=this.getCoord(),f=this.getFogDepths(),g=this.getColors(),m=this.getMultiTexCoords(),x=this.getNormals(),v=this.getVertices(),_=0;h&&h.init(m);for(var y=0;y<i;++y){_=Math.floor(y/n);for(var w=this.getPolygonIndex(this.getTriangleIndex(y)),b=0;b<a;++b)s[b].addValue(w,u[b]);l&&l.addDepth(w,f),c&&(r?c.addColor(w,g):c.addColor(_,g)),h&&h.addTexCoord(w,m),d&&(o?d.addVector(w,x):d.addVector(_,x)),p.addPoint(w,v)}this.getNormal()||this.buildNormals(t,e,i),this.setSolid(this.solid_.getValue()),this.setCCW(this.ccw_.getValue())}},buildNormals:function(t,e,n){for(var i=this.createNormals(t,e),r=this.getNormals(),o=0;o<n;++o){var s=i[this.getTriangleIndex(o)];r.push(s.x,s.y,s.z)}},createNormals:function(t,e){var n=this.createFaceNormals(t,e);if(this.normalPerVertex_.getValue()){for(var i=[],r=0;r<e;++r){var o=this.getPolygonIndex(r),s=i[o];s||(s=i[o]=[]),s.push(r)}return this.refineNormals(i,n,Math.PI)}return n},createFaceNormals:function(t,e){for(var n=!this.ccw_.getValue(),i=this.coordNode,r=[],o=0;o<e;o+=t){var s=this.getPolygonNormal(o,t,i);n&&s.negate();for(var a=0;a<t;++a)r.push(s)}return r},getPolygonNormal:function(){var t=new i(0,0,0),e=new i(0,0,0);return function(n,r,o){var s=new i(0,0,0);o.get1Point(this.getPolygonIndex(n),e);for(var a=0;a<r;++a){var u=t;t=e,e=u,o.get1Point(this.getPolygonIndex(n+(a+1)%r),e),s.x+=(t.y-e.y)*(t.z+e.z),s.y+=(t.z-e.z)*(t.x+e.x),s.z+=(t.x-e.x)*(t.y+e.y)}return s.normalize()}}()}),r}),define("x_ite/Components/Geometry3D/IndexedFaceSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Triangle3"],function(t,e,n,i,r,o,s,a){"use strict";function u(t){i.call(this,t),this.addType(r.IndexedFaceSet),this.creaseAngle_.setUnit("angle")}return u.prototype=Object.assign(Object.create(i.prototype),{constructor:u,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.initializeOnly,"solid",new t.SFBool(!0)),new e(r.initializeOnly,"ccw",new t.SFBool(!0)),new e(r.initializeOnly,"convex",new t.SFBool(!0)),new e(r.initializeOnly,"creaseAngle",new t.SFFloat),new e(r.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new e(r.initializeOnly,"normalPerVertex",new t.SFBool(!0)),new e(r.inputOutput,"colorIndex",new t.MFInt32),new e(r.inputOutput,"texCoordIndex",new t.MFInt32),new e(r.inputOutput,"normalIndex",new t.MFInt32),new e(r.inputOutput,"coordIndex",new t.MFInt32),new e(r.inputOutput,"attrib",new t.MFNode),new e(r.inputOutput,"fogCoord",new t.SFNode),new e(r.inputOutput,"color",new t.SFNode),new e(r.inputOutput,"texCoord",new t.SFNode),new e(r.inputOutput,"normal",new t.SFNode),new e(r.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"IndexedFaceSet"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},getTexCoordPerVertexIndex:function(t){return t<this.texCoordIndex_.length?this.texCoordIndex_[t]:this.coordIndex_[t]},getColorPerVertexIndex:function(t){return t<this.colorIndex_.length?this.colorIndex_[t]:this.coordIndex_[t]},getColorIndex:function(t){return t<this.colorIndex_.length?this.colorIndex_[t]:t},getNormalPerVertexIndex:function(t){return t<this.normalIndex_.length?this.normalIndex_[t]:this.coordIndex_[t]},getNormalIndex:function(t){return t<this.normalIndex_.length?this.normalIndex_[t]:t},build:function(){var t=this.triangulate();if(0!==t.length){var e=this.colorPerVertex_.getValue(),n=this.normalPerVertex_.getValue(),i=this.coordIndex_.getValue(),r=this.getAttrib(),o=r.length,s=this.getAttribs(),a=this.getFogCoord(),u=this.getColor(),l=this.getTexCoord(),c=this.getNormal(),h=this.getCoord(),d=this.getFogDepths(),p=this.getColors(),f=this.getMultiTexCoords(),g=this.getNormals(),m=this.getVertices();l&&l.init(f);for(var x=0,v=t.length;x<v;++x){for(var _=t[x],y=(_.vertices,_.triangles),w=_.face,b=0,S=y.length;b<S;++b){for(var C=y[b],T=i[C],F=0;F<o;++F)r[F].addValue(T,s[F]);a&&a.addDepth(T,d),u&&(e?u.addColor(this.getColorPerVertexIndex(C),p):u.addColor(this.getColorIndex(w),p)),l&&l.addTexCoord(this.getTexCoordPerVertexIndex(C),f),c&&(n?c.addVector(this.getNormalPerVertexIndex(C),g):c.addVector(this.getNormalIndex(w),g)),h.addPoint(T,m)}++w}this.getNormal()||this.buildNormals(t),this.setSolid(this.solid_.getValue()),this.setCCW(this.ccw_.getValue())}},triangulate:function(){var t=this.convex_.getValue(),e=this.coordIndex_.length,n=[];if(!this.getCoord())return n;if(e){this.coordIndex_[e-1]>-1&&this.coordIndex_.push(-1);for(var i=this.coordIndex_.getValue(),e=this.coordIndex_.length,r=[],o=0,s=0;s<e;++s){if(i[s]>-1)r.push(s);else{if(r.length)switch(r.length){case 0:case 1:case 2:r.length=0;break;case 3:n.push({vertices:r,triangles:r,face:o}),r=[];break;default:var a=[],u={vertices:r,triangles:a,face:o};t?this.triangulateConvexPolygon(r,a):this.triangulatePolygon(r,a),a.length<3?r.length=0:(n.push(u),r=[])}++o}}}return n},triangulatePolygon:function(){var t=[];return function(e,n){for(var i=this.coordIndex_.getValue(),r=this.getCoord(),s=0,u=e.length;s<u;++s){var l=t[s],c=e[s];l||(l=t[s]=new o(0,0,0)),l.index=c,r.get1Point(i[c],l)}t.length=u,a.triangulatePolygon(t,n);for(var c=0,u=n.length;c<u;++c)n[c]=n[c].index}}(),triangulateConvexPolygon:function(t,e){for(var n=1,i=t.length-1;n<i;++n)e.push(t[0],t[n],t[n+1])},buildNormals:function(t){for(var e=this.createNormals(t),n=this.getNormals(),i=0,r=t.length;i<r;++i)for(var o=t[i].triangles,s=0,a=o.length;s<a;++s){var u=e[o[s]];n.push(u.x,u.y,u.z)}},createNormals:function(){var t=[],e=[];return function(n){var i=!this.ccw_.getValue(),r=this.coordIndex_.getValue(),o=this.getCoord(),s=null;t.length=0,e.length=0;for(var a=0,u=n.length;a<u;++a){var l=n[a],c=l.vertices,h=c.length;switch(h){case 3:s=o.getNormal(r[c[0]],r[c[1]],r[c[2]]);break;case 4:s=o.getQuadNormal(r[c[0]],r[c[1]],r[c[2]],r[c[3]]);break;default:s=this.getPolygonNormal(c,r,o)}for(var d=0;d<h;++d){var p=c[d],f=r[p],g=e[f];g||(g=e[f]=[]),g.push(p)}i&&s.negate();for(var d=0;d<h;++d)t[c[d]]=s}return this.refineNormals(e,t,this.creaseAngle_.getValue())}}(),getPolygonNormal:function(){var t=new o(0,0,0),e=new o(0,0,0);return function(n,i,r){var s=new o(0,0,0);r.get1Point(i[n[0]],e);for(var a=0,u=n.length;a<u;++a){var l=t;t=e,e=l,r.get1Point(i[n[(a+1)%u]],e),s.x+=(t.y-e.y)*(t.z+e.z),s.y+=(t.z-e.z)*(t.x+e.x),s.z+=(t.x-e.x)*(t.y+e.y)}return s.normalize()}}()}),u}),define("x_ite/Components/Rendering/X3DGeometricPropertyNode",["x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants"],function(t,e){"use strict";function n(n){t.call(this,n),this.addType(e.X3DGeometricPropertyNode)}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n}),n}),define("x_ite/Components/Rendering/X3DCoordinateNode",["x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Bits/X3DConstants","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector3"],function(t,e,n,i){"use strict";function r(n){t.call(this,n),this.addType(e.X3DCoordinateNode)}return r.prototype=Object.assign(Object.create(t.prototype),{constructor:r,initialize:function(){t.prototype.initialize.call(this),this.point_.addInterest("set_point__",this),this.set_point__()},set_point__:function(){this.point=this.point_.getValue(),this.length=this.point_.length},isEmpty:function(){return 0===this.length},getSize:function(){return this.length},set1Point:function(t,e){this.point_[t]=e},get1Point:function(t,e){if(t<this.length){const n=this.point;return t*=3,e.set(n[t],n[t+1],n[t+2])}return e.set(0,0,0)},addPoint:function(t,e){if(t<this.length){const n=this.point;t*=3,e.push(n[t],n[t+1],n[t+2],1)}else e.push(0,0,0,1)},addPoints:function(t,e){const n=this.point;for(var i=0,r=3*this.length;i<r;i+=3)t.push(n[i],n[i+1],n[i+2],1);for(var i=r,r=3*e;i<r;i+=3)t.push(0,0,0,1)},getNormal:function(){var t=new i(0,0,0),e=new i(0,0,0),r=new i(0,0,0);return function(o,s,a){var u=this.length;return o<u&&s<u&&a<u?n.normal(this.get1Point(o,t),this.get1Point(s,e),this.get1Point(a,r),new i(0,0,0)):new i(0,0,0)}}(),getQuadNormal:function(){var t=new i(0,0,0),e=new i(0,0,0),r=new i(0,0,0),o=new i(0,0,0);return function(s,a,u,l){var c=this.length;return s<c&&a<c&&u<c&&l<c?n.quadNormal(this.get1Point(s,t),this.get1Point(a,e),this.get1Point(u,r),this.get1Point(l,o),new i(0,0,0)):new i(0,0,0)}}()}),r}),define("x_ite/Components/Rendering/Coordinate",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DCoordinateNode","x_ite/Bits/X3DConstants"],function(t,e,n,i,r){"use strict";function o(t){i.call(this,t),this.addType(r.Coordinate),this.point_.setUnit("length")}return o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"point",new t.MFVec3f)]),getTypeName:function(){return"Coordinate"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"coord"}}),o}),define("x_ite/Components/Texturing/X3DTextureCoordinateNode",["x_ite/Fields","x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DConstants"],function(t,e,n,i){"use strict";function r(t){e.call(this,t),this.addType(i.X3DTextureCoordinateNode),this.texCoordArray=n.createArray()}return r.prototype=Object.assign(Object.create(e.prototype),{constructor:r,init:function(t){this.texCoordArray.length=0,t.push(this.texCoordArray)},addTexCoord:function(t,e){this.addTexCoordToChannel(t,e[0])},setShaderUniforms:function(t,e){for(var n=0,i=e.x3d_MaxTextures;n<i;++n)this.setShaderUniformsToChannel(t,e,n)},setShaderUniformsToChannel:function(t,e,n){t.uniform1i(e.x3d_TextureCoordinateGeneratorMode[n],0)}}),r}),define("x_ite/Components/Texturing/TextureCoordinate",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Texturing/X3DTextureCoordinateNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector4"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.TextureCoordinate)}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"point",new t.MFVec2f)]),getTypeName:function(){return"TextureCoordinate"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texCoord"},initialize:function(){i.prototype.initialize.call(this),this.point_.addInterest("set_point__",this),this.set_point__()},set_point__:function(){this.point=this.point_.getValue(),this.length=this.point_.length},isEmpty:function(){return 0===this.length},getSize:function(){return this.length},get1Point:function(t,e){if(t<this.length){const n=this.point;return t*=2,e.set(n[t],n[t+1],0,1)}return e.set(0,0,0,1)},addTexCoordToChannel:function(t,e){if(t>=0&&t<this.length){var n=this.point;t*=2,e.push(n[t],n[t+1],0,1)}else e.push(0,0,0,1)},getTexCoord:function(t){for(var e=this.point_,n=0,i=e.length;n<i;++n){var r=e[n];t[n]=new o(r.x,r.y,0,1)}return t.length=i,t}}),s}),define("x_ite/Browser/Geometry3D/BoxOptions",["x_ite/Fields","x_ite/Basic/X3DBaseNode","x_ite/Components/Geometry3D/IndexedFaceSet","x_ite/Components/Rendering/Coordinate","x_ite/Components/Texturing/TextureCoordinate"],function(t,e,n,i,r){"use strict";function o(t){e.call(this,t)}return o.prototype=Object.assign(Object.create(e.prototype),{constructor:o,getTypeName:function(){return"BoxOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"boxOptions"},initialize:function(){e.prototype.initialize.call(this)},getGeometry:function(){if(this.geometry)return this.geometry;this.geometry=new n(this.getExecutionContext()),this.geometry.texCoord_=new r(this.getExecutionContext()),this.geometry.coord_=new i(this.getExecutionContext());var e=this.geometry,o=this.geometry.texCoord_.getValue(),s=this.geometry.coord_.getValue();return e.texCoordIndex_=new t.MFInt32(0,1,2,3,-1,0,1,2,3,-1,0,1,2,3,-1,0,1,2,3,-1,0,1,2,3,-1,0,1,2,3,-1),e.coordIndex_=new t.MFInt32(0,1,2,3,-1,5,4,7,6,-1,1,5,6,2,-1,4,0,3,7,-1,4,5,1,0,-1,3,2,6,7,-1),o.point_=new t.MFVec2f(new t.SFVec2f(1,1),new t.SFVec2f(0,1),new t.SFVec2f(0,0),new t.SFVec2f(1,0)),s.point_=new t.MFVec3f(new t.SFVec3f(1,1,1),new t.SFVec3f(-1,1,1),new t.SFVec3f(-1,-1,1),new t.SFVec3f(1,-1,1),new t.SFVec3f(1,1,-1),new t.SFVec3f(-1,1,-1),new t.SFVec3f(-1,-1,-1),new t.SFVec3f(1,-1,-1)),o.setup(),s.setup(),e.setup(),this.geometry}}),o}),define("x_ite/Browser/Geometry3D/ConeOptions",["x_ite/Fields","x_ite/Basic/X3DBaseNode"],function(t,e){"use strict";function n(n){e.call(this,n),this.addChildObjects("xDimension",new t.SFInt32(20),"yDimension",new t.SFInt32(1))}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,getTypeName:function(){return"ConeOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"coneOptions"}}),n}),define("x_ite/Browser/Geometry3D/CylinderOptions",["x_ite/Fields","x_ite/Basic/X3DBaseNode"],function(t,e){"use strict";function n(n){e.call(this,n),this.addChildObjects("xDimension",new t.SFInt32(20),"yDimension",new t.SFInt32(1))}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,getTypeName:function(){return"CylinderOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"cylinderOptions"}}),n}),define("standard/Math/Numbers/Complex",[],function(){"use strict";function t(t,e){this.real=t,this.imag=e}return t.prototype={constructor:t,copy:function(){var e=Object.create(t.prototype);return e.real=this.real,e.imag=this.imag,e},assign:function(t){return this.real=t.real,this.imag=t.imag,this},equals:function(t){return this.real===t.real&&this.imag===t.imag},setRadius:function(t){return this.setPolar(t,this.getAngle())},getRadius:function(){return this.real?this.imag?Math.sqrt(this.real*this.real+this.imag*this.imag):Math.abs(this.real):Math.abs(this.imag)},setAngle:function(t){return this.setPolar(this.getRadius(),t)},getAngle:function(){return Math.atan2(this.imag,this.real)},setPolar:function(t,e){return this.real=t*Math.cos(e),this.imag=t*Math.sin(e),this},conjugate:function(){return this.imag=-this.imag,this},negate:function(){return this.real=-this.real,this.imag=-this.imag,this},inverse:function(){var t=this.real*this.real+this.imag*this.imag;return this.real/=t,this.imag/=-t,this},add:function(t){return this.real+=t.real,this.imag+=t.imag,this},subtract:function(t){return this.real-=t.real,this.imag-=t.imag,this},multiply:function(t){return this.real*=t,this.imag*=t,this},multComp:function(){var t=this.real,e=this.imag;return this.real=t*value.real-e*value.imag,this.imag=t*value.imag+e*value.real,this},divComp:function(t){var e=this.real,n=this.imag,i=t.real,r=t.imag,o=i*i+r*r;return this.real=(e*i+n*r)/o,this.imag=(n*i-e*r)/o,this},toString:function(){return this.imag?this.real+" "+this.imag+"i":""+this.real}},Object.assign(t,{Polar:function(e,n){var i=Object.create(t.prototype);return i.real=e*Math.cos(n),i.imag=e*Math.sin(n),i},multiply:function(t,e){var n=Object.create(this.prototype);return n.real=t.real*e,n.imag=t.imag*e,n},multComp:function(t,e){var n=Object.create(this.prototype);return n.real=t.real*e.real-lsh.imag*e.imag,n.imag=t.real*e.imag+lsh.imag*e.real,n}}),t}),define("x_ite/Browser/Geometry3D/QuadSphereOptions",["x_ite/Fields","x_ite/Basic/X3DBaseNode","x_ite/Components/Geometry3D/IndexedFaceSet","x_ite/Components/Rendering/Coordinate","x_ite/Components/Texturing/TextureCoordinate","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(t,e,n,i,r,o,s,a){"use strict";function u(n){e.call(this,n),this.addChildObjects("xDimension",new t.SFInt32(32),"yDimension",new t.SFInt32(15))}return u.prototype=Object.assign(Object.create(e.prototype),{constructor:u,getTypeName:function(){return"QuadSphereOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"quadSphereOptions"},initialize:function(){e.prototype.initialize.call(this),this.addInterest("eventsProcessed",this)},getGeometry:function(){return this.geometry||this.eventsProcessed(),this.geometry},createTexCoordIndex:function(){for(var t=this.xDimension_.getValue()+1,e=this.yDimension_.getValue(),n=this.geometry.texCoordIndex_,i=0,r=t-1;i<r;++i)n.push(i),n.push(i+t-1),n.push(i+t),n.push(-1);for(var o=t-1,s=0,a=e-3;s<a;++s,++o)for(var i=0,r=t-1;i<r;++i,++o)n.push(o),n.push(o+t),n.push(o+t+1),n.push(o+1),n.push(-1);for(var o=(e-2)*t-1,i=0,r=t-1;i<r;++i,++o)n.push(o+t),n.push(o+1),n.push(o),n.push(-1)},createTexCoord:function(){for(var t=this.xDimension_.getValue()+1,e=this.yDimension_.getValue(),n=this.geometry.texCoord_.getValue().point_,i=-.5/(t-1),r=1;r<t;++r){var o=r/(t-1)+i;n.push(new s(o,1))}for(var a=1,u=e-1;a<u;++a)for(var l=1-a/(e-1),r=0;r<t;++r){var o=r/(t-1);n.push(new s(o,l))}for(var r=1;r<t;++r){var o=r/(t-1)+i;n.push(new s(o,0))}},createCoordIndex:function(){for(var t=this.xDimension_.getValue()+1,e=this.yDimension_.getValue(),n=this.geometry.coordIndex_,i=1,r=t-1;i<r;++i)n.push(0),n.push(i),n.push(i+1),n.push(-1);n.push(0),n.push(i),n.push(1),n.push(-1);for(var o=1,s=0,a=e-3;s<a;++s,++o){for(var i=0,r=t-2;i<r;++i,++o)n.push(o),n.push(o+t-1),n.push(o+t),n.push(o+1),n.push(-1);n.push(o),n.push(o+t-1),n.push(o+1),n.push(o-t+2),n.push(-1)}for(var u=o+t-1,i=0,r=t-2;i<r;++i,++o)n.push(u),n.push(o+1),n.push(o),n.push(-1);n.push(u),n.push(u-t+1),n.push(o),n.push(-1)},createPoints:function(){var t=this.xDimension_.getValue()+1,e=this.yDimension_.getValue(),n=this.geometry.coord_.getValue().point_;n.push(new a(0,1,0));for(var i=1,r=e-1;i<r;++i)for(var s=o.Polar(1,-Math.PI*i/r),u=0,l=t-1;u<l;++u){var c=o.Polar(s.imag,2*Math.PI*u/l);n.push(new a(c.imag,s.real,c.real))}n.push(new a(0,-1,0))},eventsProcessed:function(){this.geometry=new n(this.getExecutionContext()),this.geometry.texCoord_=new r(this.getExecutionContext()),this.geometry.coord_=new i(this.getExecutionContext()),this.createTexCoordIndex(),this.createTexCoord(),this.createCoordIndex(),this.createPoints();var t=this.geometry,e=this.geometry.texCoord_.getValue(),o=this.geometry.coord_.getValue();t.creaseAngle_=Math.PI,e.setup(),o.setup(),t.setup()}}),u}),define("x_ite/Browser/Geometry3D/X3DGeometry3DContext",["x_ite/Browser/Geometry3D/BoxOptions","x_ite/Browser/Geometry3D/ConeOptions","x_ite/Browser/Geometry3D/CylinderOptions","x_ite/Browser/Geometry3D/QuadSphereOptions"],function(t,e,n,i){"use strict";function r(t,e){return this[t]?this[t]:(this[t]=new e(this.getPrivateScene()),this[t].setup(),this[t])}function o(){}return o.prototype={initialize:function(){},getBoxOptions:function(){return r.call(this,"boxOptions",t)},getConeOptions:function(){return r.call(this,"coneOptions",e)},getCylinderOptions:function(){return r.call(this,"cylinderOptions",n)},getSphereOptions:function(){return r.call(this,"sphereOptions",i)}},o}),define("x_ite/Browser/PointingDeviceSensor/PointingDevice",["jquery","x_ite/Basic/X3DBaseNode"],function(t,e){"use strict";function n(t){e.call(this,t),this.cursor="DEFAULT",this.isOver=!1,this.motionTime=0}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,getTypeName:function(){return"PointingDevice"},initialize:function(){var t=this.getBrowser().getElement();t.bind("mousedown.PointingDevice"+this.getId(),this.mousedown.bind(this)),t.bind("mouseup.PointingDevice"+this.getId(),this.mouseup.bind(this)),t.bind("dblclick.PointingDevice"+this.getId(),this.dblclick.bind(this)),t.bind("mousemove.PointingDevice"+this.getId(),this.mousemove.bind(this)),t.bind("mouseout.PointingDevice"+this.getId(),this.onmouseout.bind(this)),t.bind("touchstart.PointingDevice"+this.getId(),this.touchstart.bind(this)),t.bind("touchend.PointingDevice"+this.getId(),this.touchend.bind(this))},mousewheel:function(t){},mousedown:function(e){var n=this.getBrowser();if(n.getElement().focus(),!(n.getShiftKey()&&n.getControlKey()||0!==e.button)){var i=n.getElement(),r=i.offset(),o=e.pageX-r.left,s=i.height()-(e.pageY-r.top);i.unbind("mousemove.PointingDevice"+this.getId()),t(document).bind("mouseup.PointingDevice"+this.getId(),this.mouseup.bind(this)),t(document).bind("mousemove.PointingDevice"+this.getId(),this.mousemove.bind(this)),t(document).bind("touchend.PointingDevice"+this.getId(),this.touchend.bind(this)),t(document).bind("touchmove.PointingDevice"+this.getId(),this.touchmove.bind(this)),n.buttonPressEvent(o,s)&&(e.preventDefault(),e.stopImmediatePropagation(),n.setCursor("HAND"),n.finished().addInterest("onverifymotion",this,o,s))}},mouseup:function(e){if(e.preventDefault(),0===e.button){var n=this.getBrowser(),i=n.getElement(),r=i.offset(),o=e.pageX-r.left,s=i.height()-(e.pageY-r.top);t(document).unbind(".PointingDevice"+this.getId()),i.bind("mousemove.PointingDevice"+this.getId(),this.mousemove.bind(this)),n.buttonReleaseEvent(),n.setCursor(this.isOver?"HAND":"DEFAULT"),n.finished().addInterest("onverifymotion",this,o,s),n.addBrowserEvent(),this.cursor="DEFAULT"}},dblclick:function(t){this.isOver&&t.stopImmediatePropagation()},mousemove:function(t){t.preventDefault();var e=this.getBrowser();if(this.motionTime!==e.getCurrentTime()){this.motionTime=e.getCurrentTime();var n=e.getElement(),i=n.offset(),r=t.pageX-i.left,o=n.height()-(t.pageY-i.top);this.onmotion(r,o)}},touchstart:function(t){var e=t.originalEvent.touches;switch(e.length){case 1:t.button=0,t.pageX=e[0].pageX,t.pageY=e[0].pageY,this.mousedown(t);break;case 2:this.touchend(t)}},touchend:function(t){this.getBrowser();t.button=0,this.mouseup(t)},touchmove:function(t){var e=t.originalEvent.touches;switch(e.length){case 1:t.button=0,t.pageX=e[0].pageX,t.pageY=e[0].pageY,this.mousemove(t)}},onmotion:function(t,e){var n=this.getBrowser();n.motionNotifyEvent(t,e)?this.isOver||(this.isOver=!0,this.cursor=n.getCursor(),n.setCursor("HAND")):this.isOver&&(this.isOver=!1,n.setCursor(this.cursor))},onmouseout:function(t){this.getBrowser().leaveNotifyEvent()},onverifymotion:function(t,e,n){this.getBrowser().finished().removeInterest("onverifymotion",this),this.onmotion(e,n)}}),n}),define("standard/Math/Geometry/Line3",["standard/Math/Numbers/Vector3"],function(t){"use strict";function e(t,e){this.point=t.copy(),this.direction=e.copy()}return e.prototype={constructor:e,copy:function(){var t=Object.create(e.prototype);return t.point=this.point.copy(),t.direction=this.direction.copy(),t},assign:function(t){return this.point.assign(t.point),this.direction.assign(t.direction),this},set:function(t,e){return this.point.assign(t),this.direction.assign(e),this},setPoints:function(t,e){return this.point.assign(t),this.direction.assign(e).subtract(t).normalize(),this},multMatrixLine:function(t){return t.multMatrixVec(this.point),t.multMatrixDir(this.direction).normalize(),this},multLineMatrix:function(t){return t.multVecMatrix(this.point),t.multDirMatrix(this.direction).normalize(),this},getClosestPointToPoint:function(t,e){var n=e.assign(t).subtract(this.point),i=n.dot(this.direction);return e.assign(this.direction).multiply(i).add(this.point)},getClosestPointToLine:function(){var e=new t(0,0,0);return function(n,i){var r=this.point,o=n.point,s=this.direction,a=n.direction,u=t.dot(s,a);return!(Math.abs(u)>=1)&&(e.assign(o).subtract(r),u=(e.dot(s)-u*e.dot(a))/(1-u*u),i.assign(s).multiply(u).add(r),!0)}}(),getPerpendicularVector:function(e){var n=t.subtract(this.point,e);return n.subtract(this.direction.copy().multiply(t.dot(n,this.direction)))},intersectsTriangle:function(){var e=new t(0,0,0),n=new t(0,0,0);return function(t,i,r,o){var s=i.subtract(t),a=r.subtract(t);e.assign(this.direction).cross(a);var u=s.dot(e);if(0===u)return!1;var l=1/u;n.assign(this.point).subtract(t);var c=n.dot(e)*l;if(c<0||c>1)return!1;var h=n.cross(s),d=this.direction.dot(h)*l;return!(d<0||c+d>1)&&(o.u=c,o.v=d,o.t=1-c-d,!0)}}(),toString:function(){return this.point+", "+this.direction}},e.Points=function(n,i){var r=Object.create(e.prototype);return r.point=n.copy(),r.direction=t.subtract(i,n).normalize(),r},e}),define("standard/Math/Algorithms/MergeSort",[],function(){"use strict";function t(t,e){this.array=t,this.auxiliary=[],e&&(this.compare=e)}return t.prototype={compare:function(t,e){return t<e},sort:function(t,e){this.mergeSort(t,e-1)},mergeSort:function(t,e){if(t<e){var n=t+e>>>1;this.mergeSort(t,n),this.mergeSort(n+1,e),this.merge(t,n,e)}},merge:function(t,e,n){var i,r,o;for(i=0,r=t;r<=e;)this.auxiliary[i++]=this.array[r++];for(i=0,o=t;o<r&&r<=n;)this.compare(this.array[r],this.auxiliary[i])?this.array[o++]=this.array[r++]:this.array[o++]=this.auxiliary[i++];for(;o<r;)this.array[o++]=this.auxiliary[i++]}},t}),define("x_ite/Browser/PointingDeviceSensor/X3DPointingDeviceSensorContext",["jquery","x_ite/Browser/PointingDeviceSensor/PointingDevice","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Geometry/Line3","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Algorithms/MergeSort","standard/Math/Algorithm"],function(t,e,n,i,r,o,s,a,u,l,c){"use strict";function h(){this.pointingDevice=new e(this),this.pointer=new s(0,0),this.hitRay=new r(a.Zero,a.Zero),this.hits=[],this.enabledSensors=[{}],this.selectedLayer=null,this.overSensors={},this.activeSensors={},this.hitPointSorter=new l(this.hits,function(t,e){return t.intersection.point.z<e.intersection.point.z}),this.layerSorter=new l(this.hits,function(t,e){return t.layerNumber<e.layerNumber}),this.pointerTime=0}var d=new r(a.Zero,a.Zero);return h.prototype={initialize:function(){this.getElement().attr("tabindex",this.getElement().attr("tabindex")||0),this.setCursor("DEFAULT"),this.pointingDevice.setup()},setCursor:function(t){this.cursorType=t;var e=this.getElement().find(".x_ite-private-surface");switch(t){case"HAND":e.css("cursor","pointer");break;case"MOVE":e.css("cursor","move");break;case"CROSSHAIR":e.css("cursor","crosshair");break;default:this.loadCount_.getValue()?e.css("cursor","wait"):this.pointingDevice&&this.pointingDevice.isOver?e.css("cursor","pointer"):e.css("cursor","default")}},getCursor:function(){return this.cursorType},isPointerInRectangle:function(t){return this.pointer.x>t.x&&this.pointer.x<t.x+t.z&&this.pointer.y>t.y&&this.pointer.y<t.y+t.w},setLayerNumber:function(t){this.layerNumber=t},getSelectedLayer:function(){return this.selectedLayer},setHitRay:function(t,e){try{o.unProjectRay(this.pointer.x,this.pointer.y,u.Identity,t,e,this.hitRay)}catch(t){this.hitRay.set(a.Zero,a.Zero)}},getHitRay:function(){return this.hitRay},getSensors:function(){return this.enabledSensors},addHit:function(t,e,n,i){this.hits.push({pointer:this.pointer,hitRay:this.hitRay.copy(),intersection:t,sensors:this.enabledSensors[this.enabledSensors.length-1],layer:e,layerNumber:this.layerNumber,shape:n,modelViewMatrix:i.copy()})},getHits:function(){return this.hits},getNearestHit:function(){return this.hits[this.hits.length-1]},buttonPressEvent:function(e,n){if(this.touch(e,n),0===this.hits.length)return!1;var i=this.getNearestHit();this.selectedLayer=i.layer,this.activeSensors=i.sensors;for(var r in this.activeSensors)this.activeSensors[r].set_active__(!0,i);return!t.isEmptyObject(i.sensors)},buttonReleaseEvent:function(){this.selectedLayer=null;for(var t in this.activeSensors)this.activeSensors[t].set_active__(!1,null);return this.activeSensors={},!0},motionNotifyEvent:function(e,n){return this.touch(e,n),this.motion(),this.hits.length&&!t.isEmptyObject(this.hits[this.hits.length-1].sensors)},leaveNotifyEvent:function(){},touch:function(t,e){if(this.getViewer().isActive_.getValue())return void(this.pointerTime=0);var i=performance.now();this.pointer.set(t,e),this.hits.length=0,this.getWorld().traverse(n.POINTER,null),this.hitPointSorter.sort(0,this.hits.length),this.layerSorter.sort(0,this.hits.length),this.addBrowserEvent(),this.pointerTime=performance.now()-i},motion:function(){if(this.hits.length)var t=this.hits[this.hits.length-1];else var e=this.selectedLayer?this.hitRay:d,t={pointer:this.pointer,modelViewMatrix:new u,hitRay:e,intersection:null,sensors:{},shape:null,layer:null,layerNumber:0};if(this.hits.length)var n=c.set_difference(this.overSensors,t.sensors,{},function(t,e){return t.getNode()<e.getNode()});else var n=Object.assign({},this.overSensors);for(var i in n)n[i].set_over__(!1,t);if(this.hits.length){this.overSensors=t.sensors;for(var i in this.overSensors)this.overSensors[i].set_over__(!0,t)}else this.overSensors={};for(var i in this.activeSensors)this.activeSensors[i].set_motion__(t)}},h});define("x_ite/Browser/Navigation/X3DViewer",["x_ite/Basic/X3DBaseNode","x_ite/Components/Navigation/OrthoViewpoint","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Box3","standard/Math/Geometry/ViewVolume"],function(t,e,n,i,r,o){"use strict";function s(e){t.call(this,e)}function a(t,e,n){var i=Math.sqrt(e*e+n*n);if(i<t*Math.sqrt(.5))return Math.sqrt(t*t-i*i);var r=t/Math.sqrt(2);return r*r/i}var u=new n(0,0,0),l=new n(0,0,0),c=new n(0,0,0);return s.prototype=Object.assign(Object.create(t.prototype),{constructor:s,getTypeName:function(){return"X3DViewer"},initialize:function(){},getActiveLayer:function(){return this.getBrowser().getActiveLayer()},getViewport:function(){return this.getBrowser().getActiveLayer().getViewport()},getNavigationInfo:function(){return this.getBrowser().getActiveLayer().getNavigationInfo()},getActiveViewpoint:function(){return this.getBrowser().getActiveLayer().getViewpoint()},
getPointOnCenterPlane:function(t,n,r){try{var s=this.getNavigationInfo(),a=this.getActiveViewpoint(),h=this.getViewport().getRectangle(this.getBrowser()),d=a.getProjectionMatrixWithLimits(s.getNearValue(),s.getFarValue(a),h);if(o.unProjectPoint(t,this.getBrowser().getViewport()[3]-n,.9,i.Identity,d,h,c),a instanceof e)return r.set(c.x,c.y,-this.getDistanceToCenter(l).abs());var p=c.normalize();return r.assign(p).multiply(this.getDistanceToCenter(l).abs()/p.dot(u.set(0,0,-1)))}catch(t){return console.log(t),r.set(0,0,0)}},getDistanceToCenter:function(t,e){var n=this.getActiveViewpoint();return t.assign(n.getPosition()).add(e||n.positionOffset_.getValue()).subtract(n.getUserCenterOfRotation())},trackballProjectToSphere:function(t,e,n){return t=t/this.getBrowser().getViewport()[2]-.5,e=-e/this.getBrowser().getViewport()[3]+.5,n.set(t,e,a(.5,t,e))},lookAtPoint:function(){new r;return function(t,e,n){if(this.touch(t,e)){var i=this.getBrowser().getNearestHit();this.getActiveViewpoint().lookAtPoint(i.intersection.point,.381966,n)}}}(),lookAtBBox:function(){var t=new r;return function(e,n,i){if(this.touch(e,n)){var r=this.getBrowser().getNearestHit();r.shape.getBBox(t).multRight(r.modelViewMatrix),this.getActiveViewpoint().lookAtBBox(t,.381966,i)}}}(),touch:function(t,e){return this.getBrowser().touch(t,e),this.getBrowser().getHits().length},dispose:function(){}}),s}),define("x_ite/Components/Followers/X3DFollowerNode",["x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(t,e){"use strict";function n(n){t.call(this,n),this.addType(e.X3DFollowerNode),this.buffer=[],this.a=this.getVector(),this.vector=this.getVector()}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,initialize:function(){t.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this)},duplicate:function(t){return t.copy()},getBuffer:function(){return this.buffer},getValue:function(){return this.set_value_.getValue()},getDestination:function(){return this.set_destination_.getValue()},getInitialValue:function(){return this.initialValue_.getValue()},getInitialDestination:function(){return this.initialDestination_.getValue()},setValue:function(t){this.value_changed_=t},setDestination:function(t){this.destination.assign(t)},assign:function(t,e,n){t[e].assign(n)},equals:function(t,e,n){return this.a.assign(t).subtract(e).abs()<n},interpolate:function(t,e,n){return this.vector.assign(t).lerp(e,n)},set_live__:function(){(this.isLive().getValue()||this.getPrivate())&&this.isActive_.getValue()?(this.getBrowser().prepareEvents().addInterest("prepareEvents",this),this.getBrowser().addBrowserEvent()):this.getBrowser().prepareEvents().removeInterest("prepareEvents",this)},set_active:function(t){t!==this.isActive_.getValue()&&(this.isActive_=t,this.set_live__())}}),n}),define("x_ite/Components/Followers/X3DChaserNode",["x_ite/Components/Followers/X3DFollowerNode","x_ite/Bits/X3DConstants"],function(t,e){"use strict";function n(n){t.call(this,n),this.addType(e.X3DChaserNode),this.destination=null,this.previousValue=null,this.bufferEndTime=0,this.stepTime=0,this.deltaOut=this.getArray()}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,initialize:function(){t.prototype.initialize.call(this),this.set_value_.addInterest("set_value__",this),this.set_destination_.addInterest("set_destination__",this),this.duration_.addInterest("set_duration__",this),this.set_duration__();var e=this.getBuffer(),n=this.getInitialValue(),i=this.getInitialDestination(),r=this.getNumBuffers();this.bufferEndTime=this.getBrowser().getCurrentTime(),this.previousValue=this.duplicate(n),e[0]=this.duplicate(i);for(var o=1;o<r;++o)e[o]=this.duplicate(n);this.destination=this.duplicate(i),this.equals(i,n,this.getTolerance())?this.setValue(i):this.set_active(!0)},getNumBuffers:function(){return 60},getTolerance:function(){return 1e-8},getArray:function(){return this.getVector()},setPreviousValue:function(t){this.previousValue.assign(t)},step:function(t,e,n){this.output.add(this.deltaOut.assign(t).subtract(e).multiply(n))},stepResponse:function(t){if(t<=0)return 0;var e=this.duration_.getValue();return t>=e?1:.5-.5*Math.cos(t/e*Math.PI)},set_value__:function(){this.isActive_.getValue()||(this.bufferEndTime=this.getBrowser().getCurrentTime());for(var t=this.getBuffer(),e=this.getValue(),n=0,i=t.length;n<i;++n)this.assign(t,n,e);this.setPreviousValue(e),this.setValue(e),this.set_active(!0)},set_destination__:function(){this.setDestination(this.getDestination()),this.isActive_.getValue()||(this.bufferEndTime=this.getBrowser().getCurrentTime()),this.set_active(!0)},set_duration__:function(){this.stepTime=this.duration_.getValue()/this.getNumBuffers()},prepareEvents:function(){try{var t=this.getBuffer(),e=t.length,n=this.updateBuffer();this.output=this.interpolate(this.previousValue,t[e-1],this.stepResponse((e-1+n)*this.stepTime));for(var i=e-2;i>=0;--i)this.step(t[i],t[i+1],this.stepResponse((i+n)*this.stepTime));this.setValue(this.output),this.equals(this.output,this.destination,this.getTolerance())&&this.set_active(!1)}catch(t){}},updateBuffer:function(){var t=this.getBuffer(),e=t.length,n=(this.getBrowser().getCurrentTime()-this.bufferEndTime)/this.stepTime;if(n>=1){var i=Math.floor(n);if(n-=i,i<e){this.setPreviousValue(t[e-i]);for(var r=e-1;r>=i;--r)this.assign(t,r,t[r-i]);for(var r=0;r<i;++r)try{var o=r/i;this.assign(t,r,this.interpolate(this.destination,t[i],o))}catch(t){}}else{this.setPreviousValue(i==e?t[0]:this.destination);for(var r=0;r<e;++r)this.assign(t,r,this.destination)}this.bufferEndTime+=i*this.stepTime}return n}}),n}),define("x_ite/Components/Followers/PositionChaser",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.PositionChaser)}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_value",new t.SFVec3f),new e(r.inputOnly,"set_destination",new t.SFVec3f),new e(r.initializeOnly,"initialValue",new t.SFVec3f),new e(r.initializeOnly,"initialDestination",new t.SFVec3f),new e(r.initializeOnly,"duration",new t.SFTime(1)),new e(r.outputOnly,"isActive",new t.SFBool),new e(r.outputOnly,"value_changed",new t.SFVec3f)]),getTypeName:function(){return"PositionChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new o(0,0,0)}}),s}),define("x_ite/Components/Followers/OrientationChaser",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Rotation4"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.OrientationChaser)}var a=new o(0,0,1,0),u=new o(0,0,1,0);return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_value",new t.SFRotation),new e(r.inputOnly,"set_destination",new t.SFRotation),new e(r.initializeOnly,"initialValue",new t.SFRotation),new e(r.initializeOnly,"initialDestination",new t.SFRotation),new e(r.initializeOnly,"duration",new t.SFTime(1)),new e(r.outputOnly,"isActive",new t.SFBool),new e(r.outputOnly,"value_changed",new t.SFRotation)]),getTypeName:function(){return"OrientationChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new o(0,0,1,0)},equals:function(t,e,n){return a.assign(t).inverse().multRight(e),Math.abs(a.angle)<n},interpolate:function(t,e,n){return u.assign(t).slerp(e,n)},step:function(t,e,n){this.deltaOut.assign(e).inverse().multRight(t).multLeft(this.output),this.output.slerp(this.deltaOut,n)}}),s}),function(t){"function"==typeof define&&define.amd?define("jquery-mousewheel/jquery.mousewheel",["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}(function(t){function e(e){var s=e||window.event,a=u.call(arguments,1),l=0,h=0,d=0,p=0,f=0,g=0;if(e=t.event.fix(s),e.type="mousewheel","detail"in s&&(d=s.detail*-1),"wheelDelta"in s&&(d=s.wheelDelta),"wheelDeltaY"in s&&(d=s.wheelDeltaY),"wheelDeltaX"in s&&(h=s.wheelDeltaX*-1),"axis"in s&&s.axis===s.HORIZONTAL_AXIS&&(h=d*-1,d=0),l=0===d?h:d,"deltaY"in s&&(d=s.deltaY*-1,l=d),"deltaX"in s&&(h=s.deltaX,0===d&&(l=h*-1)),0!==d||0!==h){if(1===s.deltaMode){var m=t.data(this,"mousewheel-line-height");l*=m,d*=m,h*=m}else if(2===s.deltaMode){var x=t.data(this,"mousewheel-page-height");l*=x,d*=x,h*=x}if(p=Math.max(Math.abs(d),Math.abs(h)),(!o||p<o)&&(o=p,i(s,p)&&(o/=40)),i(s,p)&&(l/=40,h/=40,d/=40),l=Math[l>=1?"floor":"ceil"](l/o),h=Math[h>=1?"floor":"ceil"](h/o),d=Math[d>=1?"floor":"ceil"](d/o),c.settings.normalizeOffset&&this.getBoundingClientRect){var v=this.getBoundingClientRect();f=e.clientX-v.left,g=e.clientY-v.top}return e.deltaX=h,e.deltaY=d,e.deltaFactor=o,e.offsetX=f,e.offsetY=g,e.deltaMode=0,a.unshift(e,l,h,d),r&&clearTimeout(r),r=setTimeout(n,200),(t.event.dispatch||t.event.handle).apply(this,a)}}function n(){o=null}function i(t,e){return c.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120==0}var r,o,s=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],a="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],u=Array.prototype.slice;if(t.event.fixHooks)for(var l=s.length;l;)t.event.fixHooks[s[--l]]=t.event.mouseHooks;var c=t.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var n=a.length;n;)this.addEventListener(a[--n],e,!1);else this.onmousewheel=e;t.data(this,"mousewheel-line-height",c.getLineHeight(this)),t.data(this,"mousewheel-page-height",c.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var n=a.length;n;)this.removeEventListener(a[--n],e,!1);else this.onmousewheel=null;t.removeData(this,"mousewheel-line-height"),t.removeData(this,"mousewheel-page-height")},getLineHeight:function(e){var n=t(e),i=n["offsetParent"in t.fn?"offsetParent":"parent"]();return i.length||(i=t("body")),parseInt(i.css("fontSize"),10)||parseInt(n.css("fontSize"),10)||16},getPageHeight:function(e){return t(e).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})}),define("jquery-mousewheel",["jquery-mousewheel/jquery.mousewheel"],function(t){return t}),define("x_ite/Browser/Navigation/ExamineViewer",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Bits/X3DConstants","x_ite/Browser/Navigation/X3DViewer","x_ite/Components/Followers/PositionChaser","x_ite/Components/Followers/OrientationChaser","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","jquery-mousewheel"],function(t,e,n,i,r,o,s,a,u,l,c){"use strict";function h(t){o.call(this,t),this.button=-1,this.orientationOffset=new c(0,0,1,0),this.fromVector=new l(0,0,0),this.toVector=new l(0,0,0),this.fromPoint=new l(0,0,0),this.toPoint=new l(0,0,0),this.rotation=new c(0,0,1,0),this.pressTime=0,this.motionTime=0,this.touch1=new u(0,0),this.touch2=new u(0,0),this.tapStart=0,this.dblTapInterval=.4,this.initialPositionOffset=new l(0,0,0),this.initialOrientationOffset=new c(0,0,1,0),this.positionChaser=new s(t),this.centerOfRotationChaser=new s(t),this.rotationChaser=new a(t)}return h.prototype=Object.assign(Object.create(o.prototype),{constructor:h,fieldDefinitions:new i([new n(r.outputOnly,"isActive",new e.SFBool)]),initialize:function(){o.prototype.initialize.call(this);var t=this.getBrowser(),e=t.getElement();this.getNavigationInfo().transitionStart_.addInterest("disconnect",this),t.activeViewpoint_.addInterest("set_activeViewpoint__",this),e.bind("mousedown.ExamineViewer",this.mousedown.bind(this)),e.bind("mouseup.ExamineViewer",this.mouseup.bind(this)),e.bind("dblclick.ExamineViewer",this.dblclick.bind(this)),e.bind("mousewheel.ExamineViewer",this.mousewheel.bind(this)),e.bind("touchstart.ExamineViewer",this.touchstart.bind(this)),e.bind("touchend.ExamineViewer",this.touchend.bind(this)),this.positionChaser.duration_=.2,this.positionChaser.setPrivate(!0),this.positionChaser.setup(),this.centerOfRotationChaser.duration_=.2,this.centerOfRotationChaser.setPrivate(!0),this.centerOfRotationChaser.setup(),this.rotationChaser.duration_=.2,this.rotationChaser.setPrivate(!0),this.rotationChaser.setup(),this.set_activeViewpoint__()},set_activeViewpoint__:function(){if(this.getBrowser().getBrowserOption("StraightenHorizon")){var t=this.getActiveViewpoint();t&&(t.orientationOffset_=this.getOrientationOffset(c.Identity,t.orientationOffset_.getValue(),!1))}this.disconnect()},mousedown:function(e){if(!(this.button>=0)){this.pressTime=performance.now();var n=this.getBrowser().getElement().offset(),i=e.pageX-n.left,r=e.pageY-n.top;switch(e.button){case 0:e.preventDefault(),e.stopImmediatePropagation(),this.button=e.button,t(document).bind("mouseup.ExamineViewer"+this.getId(),this.mouseup.bind(this)),t(document).bind("mousemove.ExamineViewer"+this.getId(),this.mousemove.bind(this)),t(document).bind("touchend.ExamineViewer"+this.getId(),this.touchend.bind(this)),t(document).bind("touchmove.ExamineViewer"+this.getId(),this.touchmove.bind(this)),this.disconnect(),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.trackballProjectToSphere(i,r,this.fromVector),this.rotation.assign(c.Identity),this.motionTime=0,this.isActive_=!0;break;case 1:e.preventDefault(),e.stopImmediatePropagation(),this.button=e.button,t(document).bind("mouseup.ExamineViewer"+this.getId(),this.mouseup.bind(this)),t(document).bind("mousemove.ExamineViewer"+this.getId(),this.mousemove.bind(this)),t(document).bind("touchend.ExamineViewer"+this.getId(),this.touchend.bind(this)),t(document).bind("touchmove.ExamineViewer"+this.getId(),this.touchmove.bind(this)),this.disconnect(),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.getPointOnCenterPlane(i,r,this.fromPoint),this.isActive_=!0}}},mouseup:function(e){if(e.button===this.button)switch(this.button=-1,t(document).unbind(".ExamineViewer"+this.getId()),e.button){case 0:e.preventDefault(),e.stopImmediatePropagation();var n=this.getActiveViewpoint();this.getBrowser().setCursor("DEFAULT"),Math.abs(this.rotation.angle)>.003&&performance.now()-this.motionTime<40&&(this.getBrowser().getBrowserOption("StraightenHorizon")&&"GeoViewpoint"!==n.getTypeName()&&(this.rotation=this.getHorizonRotation(this.rotation)),this.addSpinning(this.rotation)),this.isActive_=!1;break;case 1:e.preventDefault(),e.stopImmediatePropagation(),this.getBrowser().setCursor("DEFAULT"),this.isActive_=!1}},dblclick:function(t){t.preventDefault(),t.stopImmediatePropagation();var e=this.getBrowser().getElement().offset(),n=t.pageX-e.left,i=this.getBrowser().getElement().height()-(t.pageY-e.top);this.disconnect(),this.lookAtBBox(n,i,this.getBrowser().getBrowserOption("StraightenHorizon"))},mousemove:function(){var t=new l(0,0,0);return function(e){var n=this.getBrowser().getElement().offset(),i=e.pageX-n.left,r=e.pageY-n.top;switch(this.button){case 0:e.preventDefault(),e.stopImmediatePropagation();var o=this.trackballProjectToSphere(i,r,this.toVector);if(this.rotation.setFromToVec(o,this.fromVector),Math.abs(this.rotation.angle)<.003&&performance.now()-this.pressTime<50)return;this.addRotate(this.rotation),this.fromVector.assign(o),this.motionTime=performance.now();break;case 1:e.preventDefault(),e.stopImmediatePropagation();var s=this.getActiveViewpoint(),a=this.getPointOnCenterPlane(i,r,this.toPoint),u=s.getUserOrientation().multVecRot(t.assign(this.fromPoint).subtract(a));this.addMove(u,u),this.fromPoint.assign(a)}}}(),mousewheel:function(){var t=new l(0,0,0),e=new l(0,0,0);return function(n){n.preventDefault(),n.stopImmediatePropagation();var i=this.getBrowser(),r=this.getActiveViewpoint();i.prepareEvents().removeInterest("spin",this),r.transitionStop(),t=this.getDistanceToCenter(t).multiply(n.zoomFactor||.05),e=r.getUserOrientation().multVecRot(e.set(0,0,t.abs())),n.deltaY>0?this.addMove(e.negate(),l.Zero):n.deltaY<0&&this.addMove(e,l.Zero)}}(),touchstart:function(t){var e=t.originalEvent.touches;switch(e.length){case 1:t.button=0,t.pageX=e[0].pageX,t.pageY=e[0].pageY,this.mousedown(t),this.touch1.set(e[0].pageX,e[0].pageY);break;case 2:this.touchend(t),t.button=1,t.pageX=(e[0].pageX+e[1].pageX)/2,t.pageY=(e[0].pageY+e[1].pageY)/2,this.mousedown(t),this.touch1.set(e[0].pageX,e[0].pageY),this.touch2.set(e[1].pageX,e[1].pageY);break;case 3:this.touchend(t)}},touchend:function(t){switch(this.button){case 0:t.button=0,this.mouseup(t),this.getBrowser().getCurrentTime()-this.tapStart<this.dblTapInterval&&(t.button=0,t.pageX=this.touch1.x,t.pageY=this.touch1.y,this.dblclick(t)),this.tapStart=this.getBrowser().getCurrentTime();break;case 1:t.button=1,this.mouseup(t)}},touchmove:function(){var e=new u(0,0),n=new u(0,0);return function(i){var r=i.originalEvent.touches;switch(r.length){case 1:i.pageX=r[0].pageX,i.pageY=r[0].pageY,this.mousemove(i);break;case 2:e.set(r[0].pageX,r[0].pageY).subtract(this.touch1).normalize(),n.set(r[1].pageX,r[1].pageY).subtract(this.touch2).normalize();var o=e.dot(n)>.7,s=e.dot(n)<-.7;if(o)i.pageX=(r[0].pageX+r[1].pageX)/2,i.pageY=(r[0].pageY+r[1].pageY)/2,this.mousemove(i);else if(s){var a=this.touch1.distance(this.touch2);this.touch1.set(r[0].pageX,r[0].pageY),this.touch2.set(r[1].pageX,r[1].pageY);var u=this.touch1.distance(this.touch2),l=u-a;i.deltaY=l,i.zoomFactor=Math.abs(l)/t(window).width(),this.mousewheel(i)}this.touch1.set(r[0].pageX,r[0].pageY),this.touch2.set(r[1].pageX,r[1].pageY)}}}(),spin:function(){var t=this.getActiveViewpoint();this.orientationOffset.assign(t.orientationOffset_.getValue()),t.orientationOffset_=this.getOrientationOffset(this.rotation,this.orientationOffset),t.positionOffset_=this.getPositionOffset(t.positionOffset_.getValue(),this.orientationOffset,t.orientationOffset_.getValue())},set_positionOffset__:function(t){this.getActiveViewpoint().positionOffset_=t},set_centerOfRotationOffset__:function(t){this.getActiveViewpoint().centerOfRotationOffset_=t},set_rotation__:function(t){var e=this.getActiveViewpoint();e.orientationOffset_=this.getOrientationOffset(t.getValue(),this.initialOrientationOffset,!1),e.positionOffset_=this.getPositionOffset(this.initialPositionOffset,this.initialOrientationOffset,e.orientationOffset_.getValue())},addRotate:function(){var t=new c;return function(e){var n=this.getActiveViewpoint();if(this.rotationChaser.isActive_.getValue()&&this.rotationChaser.value_changed_.hasInterest("set_rotation__",this))try{t.assign(this.rotationChaser.set_destination_.getValue()).multLeft(e),this.getOrientationOffset(t,this.initialOrientationOffset,!0),this.rotationChaser.set_destination_=t}catch(n){e=this.getHorizonRotation(e),t.assign(this.rotationChaser.set_destination_.getValue()).multLeft(e),this.rotationChaser.set_destination_=t}else try{this.initialOrientationOffset.assign(n.orientationOffset_.getValue()),this.initialPositionOffset.assign(n.positionOffset_.getValue()),this.getOrientationOffset(e,this.initialOrientationOffset,!0),this.rotationChaser.set_value_=c.Identity,this.rotationChaser.set_destination_=e}catch(t){this.rotationChaser.set_value_=c.Identity,this.rotationChaser.set_destination_=this.getHorizonRotation(e)}this.disconnect(),this.rotationChaser.value_changed_.addInterest("set_rotation__",this)}}(),addSpinning:function(){var t=new c(0,0,1,0);return function(e){try{this.disconnect(),this.getBrowser().prepareEvents().addInterest("spin",this),this.rotation.assign(t.assign(c.Identity).slerp(e,.6))}catch(t){console.log(t)}}}(),addMove:function(){var t=new l(0,0,0),e=new l(0,0,0);return function(n,i){var r=this.getActiveViewpoint();this.positionChaser.isActive_.getValue()&&this.positionChaser.value_changed_.hasInterest("set_positionOffset__",this)?(t.assign(this.positionChaser.set_destination_.getValue()).add(n),this.positionChaser.set_destination_=t):(t.assign(r.positionOffset_.getValue()).add(n),this.positionChaser.set_value_=r.positionOffset_,this.positionChaser.set_destination_=t),this.centerOfRotationChaser.isActive_.getValue()&&this.centerOfRotationChaser.value_changed_.hasInterest("set_centerOfRotationOffset__",this)?(e.assign(this.centerOfRotationChaser.set_destination_.getValue()).add(i),this.centerOfRotationChaser.set_destination_=e):(e.assign(r.centerOfRotationOffset_.getValue()).add(i),this.centerOfRotationChaser.set_value_=r.centerOfRotationOffset_,this.centerOfRotationChaser.set_destination_=e),this.disconnect(),this.positionChaser.value_changed_.addInterest("set_positionOffset__",this),this.centerOfRotationChaser.value_changed_.addInterest("set_centerOfRotationOffset__",this)}}(),getPositionOffset:function(){var t=new l(0,0,0),e=new l(0,0,0),n=new c(0,0,1,0);return function(i,r,o){return this.getDistanceToCenter(t,i),n.assign(r).inverse().multRight(o).multVecRot(e.assign(t)).subtract(t).add(i)}}(),getOrientationOffset:function(){var t=new c(0,0,1,0),e=new c(0,0,1,0),n=new l(0,0,0);return function(i,r,o){var s=this.getActiveViewpoint(),a=this.getBrowser().getBrowserOption("StraightenHorizon");t.assign(i).multRight(s.getOrientation()).multRight(r),a&&"GeoViewpoint"!==s.getTypeName()&&s.straightenHorizon(t);var u=e.assign(s.getOrientation()).inverse().multRight(t);if(a&&"GeoViewpoint"!==s.getTypeName()){if(!o)return u;var c=t.multVecRot(n.assign(l.zAxis));if(Math.abs(s.getUpVector().dot(c))<.97)return u;throw new Error("Critical angle")}return u}}(),getHorizonRotation:function(){var t=new l(0,0,0);return function(e){var n=this.getActiveViewpoint(),i=e.multVecRot(t.assign(l.zAxis)).normalize(),r=l.cross(n.getUpVector(),i).normalize(),o=l.cross(r,n.getUpVector()).normalize();return new c(l.zAxis,o)}}(),disconnect:function(){var t=this.getBrowser();this.positionChaser.value_changed_.removeInterest("set_positionOffset__",this),this.centerOfRotationChaser.value_changed_.removeInterest("set_centerOfRotationOffset__",this),this.rotationChaser.value_changed_.removeInterest("set_rotation__",this),t.prepareEvents().removeInterest("spin",this)},dispose:function(){var e=this.getBrowser();this.disconnect(),e.activeViewpoint_.removeInterest("set_activeViewpoint__",this),e.getElement().unbind(".ExamineViewer"),t(document).unbind(".ExamineViewer"+this.getId())}}),h}),define("x_ite/Browser/Navigation/X3DFlyViewer",["jquery","x_ite/Browser/Navigation/X3DViewer","x_ite/Components/Followers/OrientationChaser","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Camera","jquery-mousewheel"],function(t,e,n,i,r,o,s){"use strict";function a(t){e.call(this,t);var r=this.getBrowser().getContext();this.button=-1,this.fromVector=new i(0,0,0),this.toVector=new i(0,0,0),this.direction=new i(0,0,0),this.startTime=0,this.lineBuffer=r.createBuffer(),this.lineCount=2,this.lineVertices=new Array(4*this.lineCount),this.lineArray=new Float32Array(this.lineVertices),this.event=null,this.lookAround=!1,this.orientationChaser=new n(t)}var u=Math.PI/32;return a.prototype=Object.assign(Object.create(e.prototype),{constructor:a,initialize:function(){e.prototype.initialize.call(this);var t=this.getBrowser(),n=t.getElement();n.bind("mousedown.X3DFlyViewer",this.mousedown.bind(this)),n.bind("mouseup.X3DFlyViewer",this.mouseup.bind(this)),n.bind("mousewheel.X3DFlyViewer",this.mousewheel.bind(this)),n.bind("touchstart.X3DFlyViewer",this.touchstart.bind(this)),n.bind("touchend.X3DFlyViewer",this.touchend.bind(this)),t.controlKey_.addInterest("set_controlKey_",this),this.orientationChaser.duration_=.3,this.orientationChaser.setPrivate(!0),this.orientationChaser.setup()},addCollision:function(){},removeCollision:function(){},set_controlKey_:function(){this.event&&0===this.event.button&&(this.button=-1,this.mousedown(this.event))},mousedown:function(e){if(!(this.button>=0)){this.event=e;var n=this.getBrowser().getElement().offset(),i=e.pageX-n.left,r=e.pageY-n.top;switch(e.button){case 0:e.preventDefault(),e.stopImmediatePropagation(),this.button=e.button,t(document).bind("mouseup.X3DFlyViewer"+this.getId(),this.mouseup.bind(this)),t(document).bind("mousemove.X3DFlyViewer"+this.getId(),this.mousemove.bind(this)),t(document).bind("touchend.X3DFlyViewer"+this.getId(),this.touchend.bind(this)),t(document).bind("touchmove.X3DFlyViewer"+this.getId(),this.touchmove.bind(this)),this.disconnect(),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.addCollision(),this.getBrowser().getControlKey()||this.lookAround?this.trackballProjectToSphere(i,r,this.fromVector):(this.fromVector.set(i,0,r),this.toVector.assign(this.fromVector),this.getFlyDirection(this.fromVector,this.toVector,this.direction),this.addFly(),this.getBrowser().getBrowserOption("Rubberband")&&this.getBrowser().finished().addInterest("display",this,0)),this.isActive_=!0;break;case 1:e.preventDefault(),e.stopImmediatePropagation(),this.button=e.button,t(document).bind("mouseup.X3DFlyViewer"+this.getId(),this.mouseup.bind(this)),t(document).bind("mousemove.X3DFlyViewer"+this.getId(),this.mousemove.bind(this)),this.disconnect(),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.addCollision(),this.fromVector.set(i,-r,0),this.toVector.assign(this.fromVector),this.direction.set(0,0,0),this.addPan(),this.getBrowser().getBrowserOption("Rubberband")&&this.getBrowser().finished().addInterest("display",this,1),this.isActive_=!0}}},mouseup:function(e){e.preventDefault(),e.button===this.button&&(this.event=null,this.button=-1,t(document).unbind(".X3DFlyViewer"+this.getId()),this.disconnect(),this.getBrowser().setCursor("DEFAULT"),this.removeCollision(),this.isActive_=!1)},mousemove:function(t){this.getBrowser().addBrowserEvent(),this.event=t;var e=this.getBrowser().getElement().offset(),n=t.pageX-e.left,i=t.pageY-e.top;switch(this.button){case 0:if(this.getBrowser().getControlKey()||this.lookAround){t.preventDefault(),t.stopImmediatePropagation();var r=this.trackballProjectToSphere(n,i,this.toVector);this.addRotation(this.fromVector,r),this.fromVector.assign(r);break}this.toVector.set(n,0,i),this.getFlyDirection(this.fromVector,this.toVector,this.direction);break;case 1:t.preventDefault(),t.stopImmediatePropagation(),this.toVector.set(n,-i,0),this.direction.assign(this.toVector).subtract(this.fromVector)}},mousewheel:function(t){t.preventDefault(),t.stopImmediatePropagation(),this.getActiveViewpoint().transitionStop(),t.deltaY>0?this.addRoll(-u):t.deltaY<0&&this.addRoll(u)},touchstart:function(t){var e=t.originalEvent.touches;switch(e.length){case 1:t.button=0,t.pageX=e[0].pageX,t.pageY=e[0].pageY,this.mousedown(t);break;case 2:this.touchend(t),this.lookAround=!0,t.button=0,t.pageX=(e[0].pageX+e[1].pageX)/2,t.pageY=(e[0].pageY+e[1].pageY)/2,this.mousedown(t);break;case 3:this.touchend(t)}},touchend:function(t){switch(this.button){case 0:this.lookAround=!1,t.button=0,this.mouseup(t)}},touchmove:function(t){var e=t.originalEvent.touches;switch(e.length){case 1:t.button=0,t.pageX=e[0].pageX,t.pageY=e[0].pageY,this.mousemove(t);break;case 2:t.button=0,t.pageX=(e[0].pageX+e[1].pageX)/2,t.pageY=(e[0].pageY+e[1].pageY)/2,this.mousemove(t)}},fly:function(){var t=new i(0,0,0),e=new i(0,0,0),n=new i(0,0,0),o=new r(0,0,1,0),s=new r(0,0,1,0),a=new r(0,0,1,0),u=new r(0,0,1,0),l=new r(0,0,1,0);return function(){var c=this.getNavigationInfo(),h=this.getActiveViewpoint(),d=performance.now(),p=(d-this.startTime)/1e3;t.assign(h.getUpVector()),u.setFromToVec(i.yAxis,t),this.direction.z>0?a.setFromToVec(u.multVecRot(e.assign(this.direction)),u.multVecRot(n.set(0,0,1))):a.setFromToVec(u.multVecRot(n.set(0,0,-1)),u.multVecRot(e.assign(this.direction)));var f=this.direction.abs(),g=1-a.angle/(Math.PI/2);g*=c.speed_.getValue(),g*=h.getSpeedFactor(),g*=this.getBrowser().getShiftKey()?.028:.007,g*=p;var m=this.getTranslationOffset(e.assign(this.direction).multiply(g));this.getActiveLayer().constrainTranslation(m,!0),h.positionOffset_=m.add(h.positionOffset_.getValue());var x=1.4*p*Math.pow(f/(f+40),2);o.assign(r.Identity).slerp(a,x).multRight(h.getUserOrientation()),"GeoViewpoint"!==h.getTypeName()&&h.straightenHorizon(o),s.assign(h.getOrientation()).inverse().multRight(o),h.orientationOffset_=s,l.setFromToVec(t,h.getUpVector()),h.orientationOffset_=l.multLeft(h.orientationOffset_.getValue()),this.startTime=d}}(),pan:function(){var t=new i(0,0,0),e=new i(0,0,0);return function(){var n=this.getNavigationInfo(),o=this.getActiveViewpoint(),s=performance.now(),a=(s-this.startTime)/1e3,u=o.getUpVector();this.constrainPanDirection(t.assign(this.direction));var l=1;l*=n.speed_.getValue(),l*=o.getSpeedFactor(),l*=this.getBrowser().getShiftKey()?.0098:.007,l*=a;var c=o.getUserOrientation().multRight(new r(o.getUserOrientation().multVecRot(e.assign(i.yAxis)),u)),h=c.multVecRot(t.multiply(l));this.getActiveLayer().constrainTranslation(h,!0),o.positionOffset_=h.add(o.positionOffset_.getValue()),this.startTime=s}}(),set_orientationOffset__:function(t){this.getActiveViewpoint().orientationOffset_=t},addFly:function(){this.startTime||(this.getBrowser().prepareEvents().addInterest("fly",this),this.getBrowser().addBrowserEvent(),this.startTime=performance.now())},addPan:function(){this.startTime||(this.disconnect(),this.getBrowser().prepareEvents().addInterest("pan",this),this.getBrowser().addBrowserEvent(),this.startTime=performance.now())},addRoll:function(){var t=new r(0,0,1,0),e=new r(0,0,1,0);return function(n){var i=this.getActiveViewpoint();this.orientationChaser.isActive_.getValue()&&this.orientationChaser.value_changed_.hasInterest("set_orientationOffset__",this)?(t.assign(i.getOrientation()).inverse().multRight(e.set(1,0,0,n)).multRight(i.getOrientation()).multRight(this.orientationChaser.set_destination_.getValue()),this.orientationChaser.set_destination_=t):(t.assign(i.getOrientation()).inverse().multRight(e.set(1,0,0,n)).multRight(i.getUserOrientation()),this.orientationChaser.set_value_=i.orientationOffset_,this.orientationChaser.set_destination_=t),this.disconnect(),this.orientationChaser.value_changed_.addInterest("set_orientationOffset__",this)}}(),addRotation:function(){var t=new r(0,0,1,0),e=new r(0,0,1,0);return function(n,i){var r=this.getActiveViewpoint();this.orientationChaser.isActive_.getValue()&&this.orientationChaser.value_changed_.hasInterest("set_orientationOffset__",this)?(t.setFromToVec(i,n).multRight(r.getOrientation()).multRight(this.orientationChaser.set_destination_.getValue()),"GeoViewpoint"!==r.getTypeName()&&r.straightenHorizon(t),e.assign(r.getOrientation()).inverse().multRight(t),this.orientationChaser.set_destination_=e):(t.setFromToVec(i,n).multRight(r.getUserOrientation()),"GeoViewpoint"!==r.getTypeName()&&r.straightenHorizon(t),e.assign(r.getOrientation()).inverse().multRight(t),this.orientationChaser.set_value_=r.orientationOffset_,this.orientationChaser.set_destination_=e),this.disconnect(),this.orientationChaser.value_changed_.addInterest("set_orientationOffset__",this)}}(),display:function(){var t=new i(0,0,0),e=new i(0,0,0),n=new o,r=new Float32Array(o.Identity),a=new Float32Array(o.Identity);return function(i,o){var u=this.getBrowser(),l=u.getViewport(),c=l[2],h=l[3];s.ortho(0,c,0,h,-1,1,n),r.set(n),0===o?(t.set(this.fromVector.x,h-this.fromVector.z,0),e.set(this.toVector.x,h-this.toVector.z,0)):(t.set(this.fromVector.x,h+this.fromVector.y,0),e.set(this.toVector.x,h+this.toVector.y,0)),this.transfer(t,e);var d=u.getContext(),p=u.getLineShader(),f=d.getParameter(d.LINE_WIDTH);p.getValid()&&(p.enable(d),
p.enableVertexAttribute(d,this.lineBuffer),d.uniform1i(p.x3d_NumClipPlanes,0),d.uniform1i(p.x3d_FogType,0),d.uniform1i(p.x3d_ColorMaterial,!1),d.uniformMatrix4fv(p.x3d_ProjectionMatrix,!1,r),d.uniformMatrix4fv(p.x3d_ModelViewMatrix,!1,a),d.disable(d.DEPTH_TEST),d.lineWidth(2),d.uniform3f(p.x3d_EmissiveColor,0,0,0),d.uniform1f(p.x3d_Transparency,0),d.drawArrays(d.LINES,0,this.lineCount),d.lineWidth(1),d.uniform3f(p.x3d_EmissiveColor,1,1,1),d.drawArrays(d.LINES,0,this.lineCount),d.enable(d.DEPTH_TEST),d.lineWidth(f),p.disable(d))}}(),transfer:function(t,e){var n=this.getBrowser().getContext(),i=this.lineVertices;i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=1,i[4]=e.x,i[5]=e.y,i[6]=e.z,i[7]=1,this.lineArray.set(i),n.bindBuffer(n.ARRAY_BUFFER,this.lineBuffer),n.bufferData(n.ARRAY_BUFFER,this.lineArray,n.STATIC_DRAW)},disconnect:function(){var t=this.getBrowser();t.addBrowserEvent(),t.prepareEvents().removeInterest("fly",this),t.prepareEvents().removeInterest("pan",this),t.finished().removeInterest("display",this),this.orientationChaser.value_changed_.removeInterest("set_orientationOffset__",this),this.startTime=0},dispose:function(){this.disconnect(),this.getBrowser().controlKey_.removeInterest("set_controlKey_",this),this.getBrowser().getElement().unbind(".X3DFlyViewer"),t(document).unbind(".X3DFlyViewer"+this.getId())}}),a}),define("x_ite/Browser/Navigation/WalkViewer",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Browser/Navigation/X3DFlyViewer","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4"],function(t,e,n,i,r,o,s){"use strict";function a(t){i.call(this,t)}return a.prototype=Object.assign(Object.create(i.prototype),{constructor:a,fieldDefinitions:new n([new e(r.outputOnly,"isActive",new t.SFBool)]),initialize:function(){i.prototype.initialize.call(this),this.getBrowser().addCollision(this)},getFlyDirection:function(t,e,n){return n.assign(e).subtract(t)},getTranslationOffset:function(){var t=new o(0,0,0),e=new s(0,0,1,0),n=new s(0,0,1,0);return function(i){var r=this.getActiveViewpoint(),s=r.getUpVector();return e.assign(r.getUserOrientation()),e.multVecRot(t.assign(o.yAxis)),n.setFromToVec(t,s),e.multRight(n).multVecRot(i)}}(),constrainPanDirection:function(t){return t.y<0&&(t.y=0),t},dispose:function(){this.getBrowser().removeCollision(this),i.prototype.dispose.call(this)}}),a}),define("x_ite/Browser/Navigation/FlyViewer",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Bits/X3DConstants","x_ite/Browser/Navigation/X3DFlyViewer","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4"],function(t,e,n,i,r,o,s){"use strict";function a(t){r.call(this,t)}return a.prototype=Object.assign(Object.create(r.prototype),{constructor:a,fieldDefinitions:new n([new e(i.outputOnly,"isActive",new t.SFBool)]),addCollision:function(){this.getBrowser().addCollision(this)},removeCollision:function(){this.getBrowser().removeCollision(this)},getFlyDirection:function(t,e,n){return n.assign(e).subtract(t),n.x=n.x/20,n.y=-n.z/20,n.z=-50,n},getTranslationOffset:function(t){return this.getActiveViewpoint().getUserOrientation().multVecRot(t)},constrainPanDirection:function(t){return t}}),a}),define("x_ite/Components/Navigation/Viewpoint",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Navigation/X3DViewpointNode","x_ite/Components/Interpolation/ScalarInterpolator","x_ite/Bits/X3DConstants","standard/Math/Geometry/Camera","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(t,e,n,i,r,o,s,a,u,l){"use strict";function c(t){i.call(this,t),this.addType(o.Viewpoint),this.position_.setUnit("length"),this.centerOfRotation_.setUnit("length"),this.fieldOfView_.setUnit("angle"),this.projectionMatrix=new l,this.fieldOfViewInterpolator=new r(this.getBrowser().getPrivateScene())}return c.prototype=Object.assign(Object.create(i.prototype),{constructor:c,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOnly,"set_bind",new t.SFBool),new e(o.inputOutput,"description",new t.SFString),new e(o.inputOutput,"position",new t.SFVec3f(0,0,10)),new e(o.inputOutput,"orientation",new t.SFRotation),new e(o.inputOutput,"centerOfRotation",new t.SFVec3f),new e(o.inputOutput,"fieldOfView",new t.SFFloat(.7854)),new e(o.inputOutput,"jump",new t.SFBool(!0)),new e(o.inputOutput,"retainUserOffsets",new t.SFBool),new e(o.outputOnly,"isBound",new t.SFBool),new e(o.outputOnly,"bindTime",new t.SFTime)]),getTypeName:function(){return"Viewpoint"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.fieldOfViewInterpolator.key_=new t.MFFloat(0,1),this.fieldOfViewInterpolator.setup(),this.getEaseInEaseOut().modifiedFraction_changed_.addFieldInterest(this.fieldOfViewInterpolator.set_fraction_),this.fieldOfViewInterpolator.value_changed_.addFieldInterest(this.fieldOfViewScale_)},setInterpolators:function(e){if(e.getType().indexOf(o.Viewpoint)<0)this.fieldOfViewInterpolator.keyValue_=new t.MFFloat(this.fieldOfViewScale_.getValue(),this.fieldOfViewScale_.getValue());else{var n=e.getFieldOfView()/this.fieldOfView_.getValue();this.fieldOfViewInterpolator.keyValue_=new t.MFFloat(n,this.fieldOfViewScale_.getValue()),this.fieldOfViewScale_=n}},getFieldOfView:function(){var t=this.fieldOfView_.getValue()*this.fieldOfViewScale_.getValue();return t>0&&t<Math.PI?t:Math.PI/4},getScreenScale:function(){var t=new u(0,0,0);return function(e,n){var i=n[2],r=n[3],o=Math.abs(e.z)*Math.tan(this.getFieldOfView()/2)*2;return o/=i>r?r:i,t.set(o,o,o)}}(),getViewportSize:function(){var t=new a(0,0);return function(e,n){var i=e[2],r=e[3],o=n*Math.tan(this.getFieldOfView()/2)*2,s=i/r;return s>1?t.set(o*s,o):t.set(o,o/s)}}(),getLookAtDistance:function(t){return t.size.abs()/2/Math.tan(this.getFieldOfView()/2)},getProjectionMatrixWithLimits:function(t,e,n){return s.perspective(this.getFieldOfView(),t,e,n[2],n[3],this.projectionMatrix)}}),c}),define("x_ite/Browser/Navigation/PlaneViewer",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Bits/X3DConstants","x_ite/Browser/Navigation/X3DViewer","x_ite/Components/Navigation/Viewpoint","standard/Math/Numbers/Vector3","jquery-mousewheel"],function(t,e,n,i,r,o,s,a){"use strict";function u(t){o.call(this,t),this.button=-1,this.fromPoint=new a(0,0,0),this.toPoint=new a(0,0,0)}var l=new a(0,0,0),c=new a(0,0,0),h=new a(0,0,0);return u.prototype=Object.assign(Object.create(o.prototype),{constructor:u,fieldDefinitions:new i([new n(r.outputOnly,"isActive",new e.SFBool)]),initialize:function(){o.prototype.initialize.call(this);var t=this.getBrowser(),e=t.getElement();e.bind("mousedown.PlaneViewer",this.mousedown.bind(this)),e.bind("mouseup.PlaneViewer",this.mouseup.bind(this)),e.bind("mousemove.PlaneViewer",this.mousemove.bind(this)),e.bind("mousewheel.PlaneViewer",this.mousewheel.bind(this))},mousedown:function(e){if(!(this.button>=0)){this.pressTime=performance.now();var n=this.getBrowser().getElement().offset(),i=e.pageX-n.left,r=e.pageY-n.top;switch(e.button){case 1:e.preventDefault(),e.stopImmediatePropagation(),this.button=e.button,this.getBrowser().getElement().unbind("mousemove.PlaneViewer"),t(document).bind("mouseup.PlaneViewer"+this.getId(),this.mouseup.bind(this)),t(document).bind("mousemove.PlaneViewer"+this.getId(),this.mousemove.bind(this)),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.getPointOnCenterPlane(i,r,this.fromPoint),this.isActive_=!0}}},mouseup:function(e){e.preventDefault(),e.stopImmediatePropagation(),e.button===this.button&&(this.button=-1,t(document).unbind(".PlaneViewer"+this.getId()),this.getBrowser().getElement().bind("mousemove.PlaneViewer",this.mousemove.bind(this)),this.getBrowser().setCursor("DEFAULT"),this.isActive_=!1)},mousemove:function(t){var e=this.getBrowser().getElement().offset(),n=t.pageX-e.left,i=t.pageY-e.top;switch(this.button){case 1:t.preventDefault(),t.stopImmediatePropagation();var r=this.getActiveViewpoint(),o=this.getPointOnCenterPlane(n,i,this.toPoint),s=r.getUserOrientation().multVecRot(this.fromPoint.subtract(o));r.positionOffset_=c.assign(r.positionOffset_.getValue()).add(s),r.centerOfRotationOffset_=h.assign(r.centerOfRotationOffset_.getValue()).add(s),this.fromPoint.assign(o)}},mousewheel:function(t){t.preventDefault(),t.stopImmediatePropagation();var e=this.getBrowser().getElement().offset(),n=t.pageX-e.left,i=t.pageY-e.top,r=this.getActiveViewpoint(),o=this.getPointOnCenterPlane(n,i,this.fromPoint);r.transitionStop(),t.deltaY>0?r.fieldOfViewScale_=Math.max(1e-5,.95*r.fieldOfViewScale_.getValue()):t.deltaY<0&&(r.fieldOfViewScale_=1.05*r.fieldOfViewScale_.getValue(),this.constrainFieldOfViewScale()),r.set_fieldOfView___&&r.set_fieldOfView___();var s=this.getPointOnCenterPlane(n,i,this.toPoint),a=r.getUserOrientation().multVecRot(l.assign(o).subtract(s));r.positionOffset_=c.assign(r.positionOffset_.getValue()).add(a),r.centerOfRotationOffset_=h.assign(r.centerOfRotationOffset_.getValue()).add(a)},constrainFieldOfViewScale:function(){var t=this.getActiveViewpoint();(t instanceof s||"GeoViewpoint"===t.getTypeName())&&t.fieldOfView_.getValue()*t.fieldOfViewScale_.getValue()>=Math.PI&&(t.fieldOfViewScale_=(Math.PI-.001)/t.fieldOfView_.getValue())},dispose:function(){this.getBrowser().getElement().unbind(".PlaneViewer"),t(document).unbind(".PlaneViewer"+this.getId())}}),u}),define("x_ite/Browser/Navigation/NoneViewer",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Bits/X3DConstants","x_ite/Browser/Navigation/X3DViewer"],function(t,e,n,i,r){"use strict";function o(t){r.call(this,t)}return o.prototype=Object.assign(Object.create(r.prototype),{constructor:o,fieldDefinitions:new n([new e(i.outputOnly,"isActive",new t.SFBool)])}),o}),define("x_ite/Browser/Navigation/LookAtViewer",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Bits/X3DConstants","x_ite/Browser/Navigation/X3DViewer","x_ite/Components/Followers/PositionChaser","x_ite/Components/Followers/OrientationChaser","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4"],function(t,e,n,i,r,o,s,a,u,l,c){"use strict";function h(t){o.call(this,t),this.button=-1,this.fromVector=new l(0,0,0),this.toVector=new l(0,0,0),this.touch1=new u(0,0),this.touch2=new u(0,0),this.tapStart=0,this.dblTapInterval=.4,this.positionChaser=new s(t),this.centerOfRotationChaser=new s(t),this.orientationChaser=new a(t)}return h.prototype=Object.assign(Object.create(o.prototype),{constructor:h,fieldDefinitions:new i([new n(r.outputOnly,"isActive",new e.SFBool)]),initialize:function(){o.prototype.initialize.call(this);var t=this.getBrowser(),e=t.getElement();e.bind("mousedown.LookAtViewer",this.mousedown.bind(this)),e.bind("mouseup.LookAtViewer",this.mouseup.bind(this)),e.bind("dblclick.LookAtViewer",this.dblclick.bind(this)),e.bind("mousewheel.LookAtViewer",this.mousewheel.bind(this)),e.bind("touchstart.LookAtViewer",this.touchstart.bind(this)),e.bind("touchend.LookAtViewer",this.touchend.bind(this)),this.positionChaser.duration_=.3,this.positionChaser.setPrivate(!0),this.positionChaser.setup(),this.centerOfRotationChaser.duration_=.3,this.centerOfRotationChaser.setPrivate(!0),this.centerOfRotationChaser.setup(),this.orientationChaser.duration_=.3,this.orientationChaser.setPrivate(!0),this.orientationChaser.setup()},mousedown:function(e){if(!(this.button>=0)){this.pressTime=performance.now();var n=this.getBrowser().getElement().offset(),i=e.pageX-n.left,r=e.pageY-n.top;switch(e.button){case 0:e.preventDefault(),e.stopImmediatePropagation(),this.button=e.button,t(document).bind("mouseup.LookAtViewer"+this.getId(),this.mouseup.bind(this)),t(document).bind("mousemove.LookAtViewer"+this.getId(),this.mousemove.bind(this)),t(document).bind("touchend.LookAtViewer"+this.getId(),this.mouseup.bind(this)),t(document).bind("touchmove.LookAtViewer"+this.getId(),this.touchmove.bind(this)),this.getActiveViewpoint().transitionStop(),this.trackballProjectToSphere(i,r,this.fromVector),this.isActive_=!0}}},mouseup:function(e){if(e.button===this.button)switch(this.button=-1,t(document).unbind(".LookAtViewer"+this.getId()),e.button){case 0:e.preventDefault(),e.stopImmediatePropagation(),this.isActive_=!1}},dblclick:function(t){t.preventDefault(),t.stopImmediatePropagation();var e=this.getBrowser().getElement().offset(),n=t.pageX-e.left,i=this.getBrowser().getElement().height()-(t.pageY-e.top);this.disconnect(),this.lookAtPoint(n,i,this.getBrowser().getBrowserOption("StraightenHorizon"))},mousemove:function(t){this.getBrowser().addBrowserEvent(),this.event=t;var e=this.getBrowser().getElement().offset(),n=t.pageX-e.left,i=t.pageY-e.top;switch(this.button){case 0:t.preventDefault(),t.stopImmediatePropagation();var r=this.trackballProjectToSphere(n,i,this.toVector);this.addRotation(this.fromVector,r),this.fromVector.assign(r)}},mousewheel:function(){var t=new l(0,0,0),e=new l(0,0,0);return function(n){n.preventDefault(),n.stopImmediatePropagation();var i=this.getActiveViewpoint();i.transitionStop(),t=this.getDistanceToCenter(t).multiply(n.zoomFactor||.05),e=i.getUserOrientation().multVecRot(e.set(0,0,t.abs())),n.deltaY>0?this.addMove(e.negate(),l.Zero):n.deltaY<0&&this.addMove(e,l.Zero)}}(),touchstart:function(t){var e=t.originalEvent.touches;switch(e.length){case 1:this.touch1.set(e[0].pageX,e[0].pageY);break;case 2:this.touchend(t),t.button=0,t.pageX=(e[0].pageX+e[1].pageX)/2,t.pageY=(e[0].pageY+e[1].pageY)/2,this.mousedown(t),this.touch1.set(e[0].pageX,e[0].pageY),this.touch2.set(e[1].pageX,e[1].pageY);break;case 3:this.touchend(t)}},touchend:function(t){switch(this.button){case 0:this.mouseup(t)}this.getBrowser().getCurrentTime()-this.tapStart<this.dblTapInterval&&(t.button=1,t.pageX=this.touch1.x,t.pageY=this.touch1.y,this.dblclick(t)),this.tapStart=this.getBrowser().getCurrentTime()},touchmove:function(){var e=new u(0,0),n=new u(0,0);return function(i){var r=i.originalEvent.touches;switch(r.length){case 1:break;case 2:e.set(r[0].pageX,r[0].pageY).subtract(this.touch1).normalize(),n.set(r[1].pageX,r[1].pageY).subtract(this.touch2).normalize();var o=e.dot(n)>.7,s=e.dot(n)<-.7;if(o)i.button=0,i.pageX=(r[0].pageX+r[1].pageX)/2,i.pageY=(r[0].pageY+r[1].pageY)/2,this.mousemove(i);else if(s){var a=this.touch1.distance(this.touch2);this.touch1.set(r[0].pageX,r[0].pageY),this.touch2.set(r[1].pageX,r[1].pageY);var u=this.touch1.distance(this.touch2),l=u-a;i.deltaY=l,i.zoomFactor=Math.abs(l)/t(window).width(),this.mousewheel(i)}this.touch1.set(r[0].pageX,r[0].pageY),this.touch2.set(r[1].pageX,r[1].pageY)}}}(),set_positionOffset__:function(t){this.getActiveViewpoint().positionOffset_=t},set_centerOfRotationOffset__:function(t){this.getActiveViewpoint().centerOfRotationOffset_=t},set_orientationOffset__:function(t){this.getActiveViewpoint().orientationOffset_=t},addMove:function(){var t=new l(0,0,0),e=new l(0,0,0);return function(n,i){var r=this.getActiveViewpoint();this.positionChaser.isActive_.getValue()&&this.positionChaser.value_changed_.hasInterest("set_positionOffset__",this)?(t.assign(this.positionChaser.set_destination_.getValue()).add(n),this.positionChaser.set_destination_=t):(t.assign(r.positionOffset_.getValue()).add(n),this.positionChaser.set_value_=r.positionOffset_,this.positionChaser.set_destination_=t),this.centerOfRotationChaser.isActive_.getValue()&&this.centerOfRotationChaser.value_changed_.hasInterest("set_centerOfRotationOffset__",this)?(e.assign(this.centerOfRotationChaser.set_destination_.getValue()).add(i),this.centerOfRotationChaser.set_destination_=e):(e.assign(r.centerOfRotationOffset_.getValue()).add(i),this.centerOfRotationChaser.set_value_=r.centerOfRotationOffset_,this.centerOfRotationChaser.set_destination_=e),this.disconnect(),this.positionChaser.value_changed_.addInterest("set_positionOffset__",this),this.centerOfRotationChaser.value_changed_.addInterest("set_centerOfRotationOffset__",this)}}(),addRotation:function(){var t=new c(0,0,1,0),e=new c(0,0,1,0);return function(n,i){var r=this.getActiveViewpoint();this.orientationChaser.isActive_.getValue()&&this.orientationChaser.value_changed_.hasInterest("set_orientationOffset__",this)?(t.setFromToVec(i,n).multRight(r.getOrientation()).multRight(this.orientationChaser.set_destination_.getValue()),r.straightenHorizon(t),e.assign(r.getOrientation()).inverse().multRight(t),this.orientationChaser.set_destination_=e):(t.setFromToVec(i,n).multRight(r.getUserOrientation()),r.straightenHorizon(t),e.assign(r.getOrientation()).inverse().multRight(t),this.orientationChaser.set_value_=r.orientationOffset_,this.orientationChaser.set_destination_=e),this.disconnect(),this.orientationChaser.value_changed_.addInterest("set_orientationOffset__",this)}}(),disconnect:function(){this.orientationChaser.value_changed_.removeInterest("set_orientationOffset__",this),this.positionChaser.value_changed_.removeInterest("set_positionOffset__",this),this.centerOfRotationChaser.value_changed_.removeInterest("set_centerOfRotationOffset__",this)},dispose:function(){this.getBrowser().getElement().unbind(".LookAtViewer"),t(document).unbind(".LookAtViewer"+this.getId())}}),h}),define("x_ite/Components/Lighting/X3DLightNode",["x_ite/Components/Core/X3DChildNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4","standard/Math/Algorithm"],function(t,e,n,i,r){"use strict";function o(e){t.call(this,e),this.addType(n.X3DLightNode)}var s=new i(.5,0,0,0,0,.5,0,0,0,0,.5,0,.5,.5,.5,1);return o.prototype=Object.assign(Object.create(t.prototype),{constructor:o,getGlobal:function(){return this.global_.getValue()},getColor:function(){return this.color_.getValue()},getIntensity:function(){return r.clamp(this.intensity_.getValue(),0,1)},getAmbientIntensity:function(){return r.clamp(this.ambientIntensity_.getValue(),0,1)},getDirection:function(){return this.direction_.getValue()},getShadowColor:function(){return this.shadowColor_.getValue()},getShadowIntensity:function(){return r.clamp(this.shadowIntensity_.getValue(),0,1)},getShadowBias:function(){return r.clamp(this.shadowBias_.getValue(),0,1)},getShadowMapSize:function(){return Math.min(this.shadowMapSize_.getValue(),this.getBrowser().getMaxTextureSize())},getBiasMatrix:function(){return s},push:function(t,e){if(this.on_.getValue()){if(t.isIndependent()){var n=this.getLights().pop();this.global_.getValue()?(n.set(t.getBrowser(),this,t.getLayer().getGroup(),t.getModelViewMatrix().get()),t.getGlobalLights().push(n),t.getLights().push(n)):(n.set(t.getBrowser(),this,e,t.getModelViewMatrix().get()),t.getShaderObjects().push(n),t.getLights().push(n))}else{var n=t.getLightContainer();this.global_.getValue()?(n.getModelViewMatrix().pushMatrix(t.getModelViewMatrix().get()),t.getGlobalLights().push(n),t.getLights().push(n)):(n.getModelViewMatrix().pushMatrix(t.getModelViewMatrix().get()),t.getShaderObjects().push(n),t.getLights().push(n))}t.pushShadow(this.shadowIntensity_.getValue()>0)}},pop:function(t){if(this.on_.getValue()){if(this.global_.getValue())return;t.isIndependent()?t.getBrowser().getLocalLights().push(t.getShaderObjects().pop()):t.getShaderObjects().pop(),t.popShadow()}}}),o}),define("x_ite/Components/Grouping/X3DBoundedObject",["x_ite/Fields","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Geometry/Box3"],function(t,e,n,i,r){"use strict";function o(e){this.addType(n.X3DBoundedObject),this.addChildObjects("transformSensors_changed",new t.SFTime),this.bboxSize_.setUnit("length"),this.bboxCenter_.setUnit("length"),this.childBBox=new r,this.transformSensorNodes=new Set}return o.prototype={constructor:o,initialize:function(){},getDefaultBBoxSize:function(){var t=new i(-1,-1,-1);return function(){return t}}(),getBBox:function(t,i){i.set();for(var r=0,o=t.length;r<o;++r){var s=e(n.X3DBoundedObject,t[r]);s&&i.add(s.getBBox(this.childBBox))}return i},addTransformSensor:function(t){this.transformSensorNodes.add(t),this.transformSensors_changed_=this.getBrowser().getCurrentTime()},removeTransformSensor:function(t){this.transformSensorNodes.delete(t),this.transformSensors_changed_=this.getBrowser().getCurrentTime()},getTransformSensors:function(){return this.transformSensorNodes}},o}),define("x_ite/Components/Grouping/X3DGroupingNode",["x_ite/Fields","x_ite/Components/Core/X3DChildNode","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Geometry/Box3"],function(t,e,n,i,r,o){"use strict";function s(t){return t?t.getValue().getId():-1}function a(t,e,n,i,r,o){function a(t){return u[s(t)]}for(var u={},l=r;l<o;++l)u[s(i[l])]=!0;return t.remove(e,n,a)}function u(t){e.call(this,t),n.call(this,t),this.addType(r.X3DGroupingNode),this.hidden=!1,this.allowedTypes=new Set,this.pointingDeviceSensorNodes=[],this.maybeCameraObjects=[],this.cameraObjects=[],this.maybePickableSensorNodes=[],this.pickableSensorNodes=[],this.pickableObjects=[],this.clipPlaneNodes=[],this.localFogNodes=[],this.lightNodes=[],this.displayNodes=[],this.childNodes=[]}var l=new t.MFBool;return u.prototype=Object.assign(Object.create(e.prototype),n.prototype,{constructor:u,initialize:function(){e.prototype.initialize.call(this),n.prototype.initialize.call(this),this.transformSensors_changed_.addInterest("set_pickableObjects__",this),this.addChildren_.addInterest("set_addChildren__",this),this.removeChildren_.addInterest("set_removeChildren__",this),this.children_.addInterest("set_children__",this),this.set_children__()},getBBox:function(t){return this.bboxSize_.getValue().equals(this.getDefaultBBoxSize())?n.prototype.getBBox.call(this,this.childNodes,t):t.set(this.bboxSize_.getValue(),this.bboxCenter_.getValue())},getSubBBox:function(t){return u.prototype.getBBox.call(this,t)},setHidden:function(t){t!==this.hidden&&(this.hidden=t,this.set_children__())},getVisible:function(){return l},setAllowedTypes:function(t){var e=this.allowedTypes;e.clear();for(var n=0,i=arguments.length;n<i;++n)e.add(arguments[n])},getChild:function(t){try{if(t>=0&&t<this.children_.length){var e=this.children_[t];if(e)return e.getValue().getInnerNode()}}catch(t){}return null},set_addChildren__:function(){if(0!==this.addChildren_.length){this.addChildren_.setTainted(!0),this.addChildren_.erase(a(this.addChildren_,0,this.addChildren_.length,this.children_,0,this.children_.length),this.addChildren_.length),this.children_.getTainted()||(this.children_.removeInterest("set_children__",this),this.children_.addInterest("connectChildren",this));var t=this.children_.length;this.children_.insert(this.children_.length,this.addChildren_,0,this.addChildren_.length),this.add(t,this.addChildren_),this.addChildren_.set([]),this.addChildren_.setTainted(!1)}},set_removeChildren__:function(){0!==this.removeChildren_.length&&0!==this.children_.length&&(this.children_.getTainted()||(this.children_.removeInterest("set_children__",this),this.children_.addInterest("connectChildren",this)),this.children_.erase(a(this.children_,0,this.children_.length,this.removeChildren_,0,this.removeChildren_.length),this.children_.length),this.remove(this.removeChildren_),this.removeChildren_.set([]))},set_children__:function(){this.clear(),this.add(0,this.children_)},connectChildren:function(){this.children_.removeInterest("connectChildren",this),this.children_.addInterest("set_children__",this)},add:function(t,e){if(!this.hidden){for(var n=this.getVisible(),i=n.length,o=0,s=t,a=e.length;o<a;++o,++s){var u=e[o];if(u&&(s>=i||n[s]))try{for(var l=u.getValue().getInnerNode(),c=l.getType(),h=c.length-1;h>=0;--h){switch(c[h]){case r.X3DPointingDeviceSensorNode:this.pointingDeviceSensorNodes.push(l);break;case r.ClipPlane:this.clipPlaneNodes.push(l);break;case r.LocalFog:this.localFogNodes.push(l);break;case r.X3DLightNode:this.lightNodes.push(l);break;case r.X3DBindableNode:this.maybeCameraObjects.push(l);break;case r.TransformSensor:case r.X3DPickSensorNode:l.isPickableObject_.addInterest("set_pickableObjects__",this),this.maybePickableSensorNodes.push(l);break;case r.X3DBackgroundNode:case r.X3DChildNode:l.isCameraObject_.addInterest("set_cameraObjects__",this),l.isPickableObject_.addInterest("set_pickableObjects__",this),this.maybeCameraObjects.push(l),this.childNodes.push(l);break;case r.BooleanFilter:case r.BooleanToggle:case r.NurbsOrientationInterpolator:case r.NurbsPositionInterpolator:case r.NurbsSurfaceInterpolator:case r.TimeSensor:case r.X3DFollowerNode:case r.X3DInfoNode:case r.X3DInterpolatorNode:case r.X3DKeyDeviceSensorNode:case r.X3DLayoutNode:case r.X3DScriptNode:case r.X3DSequencerNode:case r.X3DTriggerNode:break;default:continue}break}}catch(t){}}this.set_cameraObjects__(),this.set_pickableObjects__(),this.set_display_nodes()}},remove:function(t){for(var e=0,n=t.length;e<n;++e){var i=t[e];if(i)try{for(var o=i.getValue().getInnerNode(),s=o.getType(),a=s.length-1;a>=0;--a){switch(s[a]){case r.X3DPointingDeviceSensorNode:var u=this.pointingDeviceSensorNodes.indexOf(o);u>=0&&this.pointingDeviceSensorNodes.splice(u,1);break;case r.ClipPlane:var u=this.clipPlaneNodes.indexOf(o);u>=0&&this.clipPlaneNodes.splice(u,1);break;case r.LocalFog:var u=this.localFogNodes.indexOf(o);u>=0&&this.localFogNodes.splice(u,1);break;case r.X3DLightNode:var u=this.lightNodes.indexOf(o);u>=0&&this.lightNodes.splice(u,1);break;case r.X3DBindableNode:var u=this.maybeCameraObjects.indexOf(o);u>=0&&this.maybeCameraObjects.splice(u,1);break;case r.TransformSensor:case r.X3DPickSensorNode:o.isPickableObject_.removeInterest("set_pickableObjects__",this);var u=this.maybePickableSensorNodes.indexOf(o);u>=0&&this.maybePickableSensorNodes.splice(u,1);break;case r.X3DBackgroundNode:case r.X3DChildNode:o.isCameraObject_.removeInterest("set_cameraObjects__",this),o.isPickableObject_.removeInterest("set_pickableObjects__",this);var u=this.maybeCameraObjects.indexOf(o);u>=0&&this.maybeCameraObjects.splice(u,1);var u=this.childNodes.indexOf(o);u>=0&&this.childNodes.splice(u,1);break;case r.BooleanFilter:case r.BooleanToggle:case r.NurbsOrientationInterpolator:case r.NurbsPositionInterpolator:case r.NurbsSurfaceInterpolator:case r.TimeSensor:case r.X3DFollowerNode:case r.X3DInfoNode:case r.X3DInterpolatorNode:case r.X3DKeyDeviceSensorNode:case r.X3DLayoutNode:case r.X3DScriptNode:case r.X3DSequencerNode:case r.X3DTriggerNode:break;default:continue}break}}catch(t){}}this.set_cameraObjects__(),this.set_pickableObjects__(),this.set_display_nodes()},clear:function(){for(var t=this.maybePickableSensorNodes,e=this.childNodes,n=0,i=t.length;n<i;++n)t[n].isPickableObject_.removeInterest("set_pickableObjects__",this);for(var n=0,i=e.length;n<i;++n){var r=e[n];r.isCameraObject_.removeInterest("set_cameraObjects__",this),r.isPickableObject_.removeInterest("set_pickableObjects__",this)}this.pointingDeviceSensorNodes.length=0,this.maybeCameraObjects.length=0,this.clipPlaneNodes.length=0,this.localFogNodes.length=0,this.lightNodes.length=0,this.maybePickableSensorNodes.length=0,this.childNodes.length=0},set_cameraObjects__:function(){var t=this.maybeCameraObjects,e=this.cameraObjects;e.length=0;for(var n=0,i=t.length;n<i;++n){var r=t[n];r.getCameraObject()&&e.push(r)}this.setCameraObject(Boolean(e.length))},set_pickableObjects__:function(){var t=this.maybePickableSensorNodes,e=this.pickableSensorNodes,n=this.pickableObjects,i=this.childNodes;e.length=0,n.length=0;for(var r=0,o=t.length;r<o;++r){var s=t[r];s.getPickableObject()&&e.push(s)}for(var r=0,o=i.length;r<o;++r){var a=i[r];a.getPickableObject()&&n.push(a)}this.setPickableObject(Boolean(this.getTransformSensors().size||e.length||n.length))},set_display_nodes:function(){var t=this.clipPlaneNodes,e=this.localFogNodes,n=this.lightNodes,i=this.displayNodes;i.length=0;for(var r=0,o=t.length;r<o;++r)i.push(t[r]);for(var r=0,o=e.length;r<o;++r)i.push(e[r]);for(var r=0,o=n.length;r<o;++r)i.push(n[r])},traverse:function(){var t=new o;return function(e,n){switch(e){case i.POINTER:var r=this.pointingDeviceSensorNodes,o=this.clipPlaneNodes,s=this.childNodes;if(r.length){var a={};n.getBrowser().getSensors().push(a);for(var u=0,l=r.length;u<l;++u)r[u].push(n,a)}for(var u=0,l=o.length;u<l;++u)o[u].push(n);for(var u=0,l=s.length;u<l;++u)s[u].traverse(e,n);for(var u=o.length-1;u>=0;--u)o[u].pop(n);return void(r.length&&n.getBrowser().getSensors().pop());case i.CAMERA:for(var c=this.cameraObjects,u=0,l=c.length;u<l;++u)c[u].traverse(e,n);return;case i.PICKING:this.getTransformSensors().size&&(this.getSubBBox(t).multRight(n.getModelViewMatrix().get()),this.getTransformSensors().forEach(function(e){e.collect(t)}));for(var h=this.pickableSensorNodes,u=0,l=h.length;u<l;++u)h[u].traverse(e,n);var d=n.getBrowser(),p=d.getPickingHierarchy(),f=d.getPickable();if(p.push(this),f[f.length-1])for(var s=this.childNodes,u=0,l=s.length;u<l;++u)s[u].traverse(e,n);else for(var g=this.pickableObjects,u=0,l=g.length;u<l;++u)g[u].traverse(e,n);return void p.pop();case i.COLLISION:case i.DEPTH:for(var o=this.clipPlaneNodes,s=this.childNodes,u=0,l=o.length;u<l;++u)o[u].push(n);for(var u=0,l=s.length;u<l;++u)s[u].traverse(e,n);for(var u=o.length-1;u>=0;--u)o[u].pop(n);return;case i.DISPLAY:for(var m=this.displayNodes,s=this.childNodes,u=0,l=m.length;u<l;++u)m[u].push(n,this);for(var u=0,l=s.length;u<l;++u)s[u].traverse(e,n);for(var u=m.length-1;u>=0;--u)m[u].pop(n);return}}}()}),u}),define("standard/Math/Utility/MatrixStack",[],function(){"use strict";function t(t){return Object.assign([new t],{top:0,set:function(t){this[this.top].assign(t)},get:function(t){return this[this.top]},push:function(){var t=++this.top;t<this.length?this[t].assign(this[t-1]):this[t]=this[t-1].copy()},pushMatrix:function(t){var e=++this.top;e<this.length?this[e].assign(t):this[e]=t.copy()},pop:function(){--this.top},clear:function(){this.top=0},size:function(){return this.top+1},identity:function(){this[this.top].identity()},multLeft:function(t){this[this.top].multLeft(t)},translate:function(t){this[this.top].translate(t)},rotate:function(t){this[this.top].rotate(t)},scale:function(t){this[this.top].scale(t)}})}return t}),define("standard/Utility/ObjectCache",[],function(){"use strict";return function(t){return{stack:[],last:-1,pop:function(){if(this.last>-1){var e=this.stack[this.last];return this.last--,e}return new t},push:function(t){return this.last++,this.stack[this.last]=t},clear:function(){this.stack.length=0,this.last=-1}}}}),define("x_ite/Components/Lighting/DirectionalLight",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Lighting/X3DLightNode","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Geometry/Box3","standard/Math/Geometry/Camera","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Utility/MatrixStack","standard/Utility/ObjectCache"],function(t,e,n,i,r,o,s,a,u,l,c,h,d,p,f,g){"use strict";function m(){this.direction=new c(0,0,0),this.shadowBuffer=null,this.bbox=new a,this.viewVolume=new l,this.viewport=new h(0,0,0,0),this.projectionMatrix=new p,this.modelViewMatrix=new f(p),this.modelMatrix=new p,this.invLightSpaceMatrix=new p,this.invLightSpaceProjectionMatrix=new p,this.shadowMatrix=new p,this.shadowMatrixArray=new Float32Array(16),this.rotation=new d,this.textureUnit=0}function x(t){i.call(this,t),this.addType(s.DirectionalLight),this.global_=!1}var v=g(m);return m.prototype={constructor:m,getModelViewMatrix:function(){return this.modelViewMatrix},set:function(t,e,n,i){var r=t.getContext(),o=e.getShadowMapSize();this.browser=t,this.lightNode=e,this.groupNode=n,this.modelViewMatrix.pushMatrix(i),
e.getShadowIntensity()>0&&o>0&&(this.shadowBuffer=t.popShadowBuffer(o),this.shadowBuffer?t.getCombinedTextureUnits().length?(this.textureUnit=t.getCombinedTextureUnits().pop(),r.activeTexture(r.TEXTURE0+this.textureUnit),r.getVersion()>=2||t.getExtension("WEBGL_depth_texture")?r.bindTexture(r.TEXTURE_2D,this.shadowBuffer.getDepthTexture()):r.bindTexture(r.TEXTURE_2D,this.shadowBuffer.getColorTexture()),r.activeTexture(r.TEXTURE0)):console.warn("Not enough combined texture units for shadow map available."):console.warn("Couldn't create shadow buffer."))},renderShadowMap:function(t){try{if(!this.shadowBuffer)return;var e=this.lightNode,n=t.getCameraSpaceMatrix().get(),i=this.modelMatrix.assign(this.modelViewMatrix.get()).multRight(n),s=this.invLightSpaceMatrix.assign(e.getGlobal()?i:p.Identity);s.rotate(this.rotation.setFromToVec(c.zAxis,this.direction.assign(e.getDirection()).negate())),s.inverse();var a=r.prototype.getBBox.call(this.groupNode,this.bbox),l=a.multRight(s),h=e.getShadowMapSize(),d=this.viewport.set(0,0,h,h),f=u.orthoBox(l,this.projectionMatrix);this.shadowBuffer.bind(),t.getViewVolumes().push(this.viewVolume.set(f,d,d)),t.getProjectionMatrix().pushMatrix(f),t.getModelViewMatrix().pushMatrix(s),t.render(o.DEPTH,r.prototype.traverse,this.groupNode),t.getModelViewMatrix().pop(),t.getProjectionMatrix().pop(),t.getViewVolumes().pop(),this.shadowBuffer.unbind(),e.getGlobal()||s.multLeft(i.inverse()),this.invLightSpaceProjectionMatrix.assign(s).multRight(f).multRight(e.getBiasMatrix())}catch(t){console.log(t)}},setGlobalVariables:function(t){this.modelViewMatrix.get().multDirMatrix(this.direction.assign(this.lightNode.getDirection())).normalize(),this.shadowMatrix.assign(t.getCameraSpaceMatrix().get()).multRight(this.invLightSpaceProjectionMatrix),this.shadowMatrixArray.set(this.shadowMatrix)},setShaderUniforms:function(t,e){var n=e.numLights++;if(!e.hasLight(n,this)){var i=this.lightNode,r=i.getColor(),o=this.direction;if(t.uniform1i(e.x3d_LightType[n],1),t.uniform3f(e.x3d_LightColor[n],r.r,r.g,r.b),t.uniform1f(e.x3d_LightIntensity[n],i.getIntensity()),t.uniform1f(e.x3d_LightAmbientIntensity[n],i.getAmbientIntensity()),t.uniform3f(e.x3d_LightDirection[n],o.x,o.y,o.z),this.textureUnit){var s=i.getShadowColor();t.uniform3f(e.x3d_ShadowColor[n],s.r,s.g,s.b),t.uniform1f(e.x3d_ShadowIntensity[n],i.getShadowIntensity()),t.uniform1f(e.x3d_ShadowBias[n],i.getShadowBias()),t.uniformMatrix4fv(e.x3d_ShadowMatrix[n],!1,this.shadowMatrixArray),t.uniform1i(e.x3d_ShadowMapSize[n],i.getShadowMapSize()),t.uniform1i(e.x3d_ShadowMap[n],this.textureUnit)}else t.uniform1f(e.x3d_ShadowIntensity[n],0)}},dispose:function(){this.textureUnit&&this.browser.getCombinedTextureUnits().push(this.textureUnit),this.browser.pushShadowBuffer(this.shadowBuffer),this.modelViewMatrix.clear(),this.browser=null,this.lightNode=null,this.groupNode=null,this.shadowBuffer=null,this.textureUnit=0,v.push(this)}},x.prototype=Object.assign(Object.create(i.prototype),{constructor:x,fieldDefinitions:new n([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"global",new t.SFBool(!0)),new e(s.inputOutput,"on",new t.SFBool(!0)),new e(s.inputOutput,"color",new t.SFColor(1,1,1)),new e(s.inputOutput,"intensity",new t.SFFloat(1)),new e(s.inputOutput,"ambientIntensity",new t.SFFloat),new e(s.inputOutput,"direction",new t.SFVec3f(0,0,-1)),new e(s.inputOutput,"shadowColor",new t.SFColor),new e(s.inputOutput,"shadowIntensity",new t.SFFloat),new e(s.inputOutput,"shadowBias",new t.SFFloat(.005)),new e(s.initializeOnly,"shadowMapSize",new t.SFInt32(1024))]),getTypeName:function(){return"DirectionalLight"},getComponentName:function(){return"Lighting"},getContainerField:function(){return"children"},getLights:function(){return v}}),x}),define("x_ite/Browser/Navigation/X3DNavigationContext",["x_ite/Fields","x_ite/Browser/Navigation/ExamineViewer","x_ite/Browser/Navigation/WalkViewer","x_ite/Browser/Navigation/FlyViewer","x_ite/Browser/Navigation/PlaneViewer","x_ite/Browser/Navigation/NoneViewer","x_ite/Browser/Navigation/LookAtViewer","x_ite/Components/Lighting/DirectionalLight","standard/Math/Numbers/Matrix4"],function(t,e,n,i,r,o,s,a,u){"use strict";function l(t){var e=new a(t.getPrivateScene());e.setup();var n=e.getLights().pop();return n.set(t,e,null,u.Identity),n.dispose=function(){},n}function c(){this.addChildObjects("activeLayer",new t.SFNode,"activeNavigationInfo",new t.SFNode,"activeViewpoint",new t.SFNode,"availableViewers",new t.MFString,"viewer",new t.SFString("EXAMINE")),this.activeCollisions=new Set,this.viewerNode=new o(this)}return c.prototype={initialize:function(){this.viewer_.addInterest("set_viewer__",this),this.initialized().addInterest("set_world__",this),this.shutdown().addInterest("remove_world__",this),this.headlightContainer=l(this),this.viewerNode.setup()},getHeadlight:function(){return this.headlightContainer},getActiveLayer:function(){return this.activeLayer_.getValue()},getActiveNavigationInfo:function(){return this.activeNavigationInfo_.getValue()},getActiveViewpoint:function(){return this.activeViewpoint_.getValue()},getCurrentViewer:function(){return this.viewer_.getValue()},getViewer:function(){return this.viewerNode},addCollision:function(t){this.activeCollisions.add(t)},removeCollision:function(t){this.activeCollisions.delete(t)},getCollisionCount:function(){return this.activeCollisions.size},remove_world__:function(){this.getWorld().activeLayer_.removeInterest("set_activeLayer__",this)},set_world__:function(){this.getWorld().activeLayer_.addInterest("set_activeLayer__",this),this.set_activeLayer__()},set_activeLayer__:function(){this.activeLayer_.getValue()&&(this.activeLayer_.getValue().getNavigationInfoStack().removeInterest("set_activeNavigationInfo__",this),this.activeLayer_.getValue().getViewpointStack().removeInterest("set_activeViewpoint__",this)),this.activeLayer_=this.getWorld().getActiveLayer(),this.activeLayer_.getValue()&&(this.activeLayer_.getValue().getNavigationInfoStack().addInterest("set_activeNavigationInfo__",this),this.activeLayer_.getValue().getViewpointStack().addInterest("set_activeViewpoint__",this)),this.set_activeNavigationInfo__(),this.set_activeViewpoint__()},set_activeNavigationInfo__:function(){this.activeNavigationInfo_.getValue()&&this.activeNavigationInfo_.getValue().viewer_.removeFieldInterest(this.viewer_),this.activeLayer_.getValue()?(this.activeNavigationInfo_=this.activeLayer_.getValue().getNavigationInfo(),this.activeNavigationInfo_.getValue().viewer_.addFieldInterest(this.viewer_),this.viewer_=this.activeNavigationInfo_.getValue().viewer_):(this.activeNavigationInfo_=null,this.viewer_="NONE")},set_activeViewpoint__:function(){this.activeLayer_.getValue()?this.activeViewpoint_=this.activeLayer_.getValue().getViewpoint():this.activeViewpoint_=null},set_viewer__:function(t){switch(this.activeNavigationInfo_.getValue()?this.availableViewers_=this.activeNavigationInfo_.getValue().availableViewers_:this.availableViewers_.length=0,this.viewerNode&&this.viewerNode.dispose(),t.getValue()){case"EXAMINE":this.viewerNode=new e(this);break;case"WALK":this.viewerNode=new n(this);break;case"FLY":this.viewerNode=new i(this);break;case"PLANE":case"PLANE_create3000.de":this.viewerNode=new r(this);break;case"NONE":this.viewerNode=new o(this);break;case"LOOKAT":this.viewerNode=new s(this);break;default:this.viewerNode=new e(this)}this.viewerNode.setup()}},c}),define("x_ite/Components/Layering/X3DViewportNode",["x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/X3DConstants"],function(t,e){"use strict";function n(n){t.call(this,n),this.addType(e.X3DViewportNode)}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n}),n}),define("x_ite/Components/Layering/Viewport",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Layering/X3DViewportNode","x_ite/Bits/X3DConstants","x_ite/Bits/TraverseType","standard/Utility/ObjectCache","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector4"],function(t,e,n,i,r,o,s,a,u){"use strict";function l(t){i.call(this,t),this.addType(r.Viewport),this.rectangle=new u(0,0,0,0)}var c=s(a);return l.prototype=Object.assign(Object.create(i.prototype),{constructor:l,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"clipBoundary",new t.MFFloat(0,1,0,1)),new e(r.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new e(r.initializeOnly,"bboxCenter",new t.SFVec3f),new e(r.inputOnly,"addChildren",new t.MFNode),new e(r.inputOnly,"removeChildren",new t.MFNode),new e(r.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"Viewport"},getComponentName:function(){return"Layering"},getContainerField:function(){return"viewport"},getRectangle:function(t){var e=t.getViewport(),n=Math.floor(e[2]*this.getLeft()),i=Math.floor(e[2]*this.getRight()),r=Math.floor(e[3]*this.getBottom()),o=Math.floor(e[3]*this.getTop());return this.rectangle.set(n,r,Math.max(0,i-n),Math.max(0,o-r)),this.rectangle},getLeft:function(){return this.clipBoundary_.length>0?this.clipBoundary_[0]:0},getRight:function(){return this.clipBoundary_.length>1?this.clipBoundary_[1]:1},getBottom:function(){return this.clipBoundary_.length>2?this.clipBoundary_[2]:0},getTop:function(){return this.clipBoundary_.length>3?this.clipBoundary_[3]:1},traverse:function(t,e){switch(this.push(e),t){case o.POINTER:e.getBrowser().isPointerInRectangle(this.rectangle)&&i.prototype.traverse.call(this,t,e);break;default:i.prototype.traverse.call(this,t,e)}this.pop(e)},push:function(t){var e=t.getViewVolumes(),n=this.getRectangle(t.getBrowser()),i=e.length?e[e.length-1].getViewport():n,r=c.pop();r.set(t.getProjectionMatrix().get(),i,n),e.push(r)},pop:function(t){c.push(t.getViewVolumes().pop())}}),l}),define("x_ite/Browser/Layering/X3DLayeringContext",["x_ite/Components/Layering/Viewport"],function(t){"use strict";function e(){this.defaultViewport=new t(this.getPrivateScene())}return e.prototype={initialize:function(){this.defaultViewport.setup()},getDefaultViewport:function(){return this.defaultViewport}},e}),define("text!x_ite/Browser/Shaders/WebGL1/Background.vs",[],function(){return"// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nuniform mat4 x3d_ProjectionMatrix;\nuniform mat4 x3d_ModelViewMatrix;\n\nattribute vec4 x3d_Color;\nattribute vec4 x3d_Vertex;\n\nvarying vec4 color;  // color\nvarying vec3 vertex; // point on geometry\n\nvoid\nmain ()\n{\n\tvec4 position = x3d_ModelViewMatrix * x3d_Vertex;\n\n\tcolor       = x3d_Color;\n\tvertex      = position .xyz;\n\tgl_Position = x3d_ProjectionMatrix * position;\n}\n"}),define("text!x_ite/Browser/Shaders/WebGL1/Background.fs",[],function(){return'// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nvarying vec4 color;  // color\nvarying vec3 vertex; // point on geometry\n\n#pragma X3D include "Include/ClipPlanes.h"\n\nvoid\nmain ()\n{\n\tclip ();\n\n\tgl_FragColor = color;\n}\n'}),define("text!x_ite/Browser/Shaders/WebGL2/Background.vs",[],function(){return"#version 300 es\n// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nuniform mat4 x3d_ProjectionMatrix;\nuniform mat4 x3d_ModelViewMatrix;\n\nin vec4 x3d_Color;\nin vec4 x3d_Vertex;\n\nout vec4 color;  // color\nout vec3 vertex; // point on geometry\n\nvoid\nmain ()\n{\n\tvec4 position = x3d_ModelViewMatrix * x3d_Vertex;\n\n\tcolor       = x3d_Color;\n\tvertex      = position .xyz;\n\tgl_Position = x3d_ProjectionMatrix * position;\n}\n"}),define("text!x_ite/Browser/Shaders/WebGL2/Background.fs",[],function(){return'#version 300 es\n// -*- Mode: C++; coding: utf-8; tab-width: 3; indent-tabs-mode: tab; c-basic-offset: 3 -*-\n\nprecision mediump float;\nprecision mediump int;\n\nin vec4 color;  // color\nin vec3 vertex; // point on geometry\n\nout vec4 x3d_FragColor;\n\n#pragma X3D include "Include/ClipPlanes.h"\n\nvoid\nmain ()\n{\n\tclip ();\n\n\tx3d_FragColor = color;\n}\n'}),define("x_ite/Browser/EnvironmentalEffects/X3DEnvironmentalEffectsContext",["x_ite/Components/Shaders/ComposedShader","x_ite/Components/Shaders/ShaderPart","x_ite/Components/Texturing/TextureProperties","text!x_ite/Browser/Shaders/WebGL1/Background.vs","text!x_ite/Browser/Shaders/WebGL1/Background.fs","text!x_ite/Browser/Shaders/WebGL2/Background.vs","text!x_ite/Browser/Shaders/WebGL2/Background.fs"],function(t,e,n,i,r,o,s){"use strict";function a(){this.localFogs=[]}return a.prototype={initialize:function(){},getBackgroundSphereShader:function(){return this.backgroundSphereShader?this.backgroundSphereShader:(this.backgroundSphereShader=this.createShader("BackgroundSphereShader",i,r,o,s,!1),this.backgroundSphereShader)},getBackgroundTextureProperties:function(){return this.backgroundTextureProperties?this.backgroundTextureProperties:(this.backgroundTextureProperties=new n(this.getPrivateScene()),this.backgroundTextureProperties.boundaryModeS_="CLAMP_TO_EDGE",this.backgroundTextureProperties.boundaryModeT_="CLAMP_TO_EDGE",this.backgroundTextureProperties.boundaryModeR_="CLAMP_TO_EDGE",this.backgroundTextureProperties.minificationFilter_="NICEST",this.backgroundTextureProperties.magnificationFilter_="NICEST",this.backgroundTextureProperties.setup(),this.backgroundTextureProperties)},getLocalFogs:function(){return this.localFogs}},a}),define("x_ite/Browser/Lighting/X3DLightingContext",["x_ite/Rendering/TextureBuffer"],function(t){"use strict";function e(){this.localLights=[],this.shadowBuffers=[]}return e.prototype={initialize:function(){},getMaxLights:function(){return 8},getLocalLights:function(){return this.localLights},popShadowBuffer:function(e){try{var n=this.shadowBuffers[e];if(n){if(n.length)return n.pop()}else this.shadowBuffers[e]=[];return new t(this,e,e)}catch(t){return console.log(t),null}},pushShadowBuffer:function(t){t&&this.shadowBuffers[t.getWidth()].push(t)}},e}),define("x_ite/Browser/Picking/X3DPickingContext",["x_ite/Bits/TraverseType"],function(t){"use strict";function e(){this.transformSensorNodes=new Set,this.pickSensorNodes=[new Set],this.pickingHierarchy=[],this.pickable=[!1],this.pickingTime=0}return e.prototype={initialize:function(){},addTransformSensor:function(t){this.transformSensorNodes.add(t),this.enablePicking()},removeTransformSensor:function(t){this.transformSensorNodes.delete(t),this.enablePicking()},addPickSensor:function(t){this.pickSensorNodes[0].add(t),this.enablePicking()},removePickSensor:function(t){this.pickSensorNodes[0].delete(t),this.enablePicking()},getPickSensors:function(){return this.pickSensorNodes},getPickingHierarchy:function(){return this.pickingHierarchy},getPickable:function(){return this.pickable},enablePicking:function(){this.transformSensorNodes.size||this.pickSensorNodes[0].size?this.sensorEvents_.addInterest("picking",this):this.sensorEvents_.removeInterest("picking",this)},picking:function(){var e=performance.now();this.getWorld().traverse(t.PICKING,null),this.transformSensorNodes.forEach(function(t){t.process()}),this.pickSensorNodes[0].forEach(function(t){t.process()}),this.pickingTime=performance.now()-e}},e}),define("x_ite/Browser/Sound/X3DSoundContext",["x_ite/Fields"],function(t){"use strict";function e(){this.addChildObjects("volume",new t.SFFloat(1),"mute",new t.SFBool)}return e.prototype={initialize:function(){}},e}),define("x_ite/Browser/Text/TextAlignment",[],function(){"use strict";var t=0,e={BEGIN:++t,FIRST:++t,MIDDLE:++t,END:++t};return Object.preventExtensions(e),Object.freeze(e),Object.seal(e),e}),define("x_ite/Components/Text/X3DFontStyleNode",["x_ite/Fields","x_ite/Components/Core/X3DNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Browser/Text/TextAlignment","x_ite/InputOutput/FileLoader","x_ite/Bits/X3DConstants","x_ite/Browser/Networking/urls"],function(t,e,n,i,r,o,s){"use strict";function a(n){e.call(this,n),this.addType(o.X3DFontStyleNode),this.addChildObjects("loadState",new t.SFInt32(o.NOT_STARTED_STATE)),this.familyStack=[],this.alignments=[],this.loader=new r(this)}var u={SERIF:{PLAIN:s.getFontsUrl("DroidSerif-Regular.ttf"),ITALIC:s.getFontsUrl("DroidSerif-Italic.ttf"),BOLD:s.getFontsUrl("DroidSerif-Bold.ttf"),BOLDITALIC:s.getFontsUrl("DroidSerif-BoldItalic.ttf")},SANS:{PLAIN:s.getFontsUrl("Ubuntu-R.ttf"),ITALIC:s.getFontsUrl("Ubuntu-RI.ttf"),BOLD:s.getFontsUrl("Ubuntu-B.ttf"),BOLDITALIC:s.getFontsUrl("Ubuntu-BI.ttf")},TYPEWRITER:{PLAIN:s.getFontsUrl("UbuntuMono-R.ttf"),ITALIC:s.getFontsUrl("UbuntuMono-RI.ttf"),BOLD:s.getFontsUrl("UbuntuMono-B.ttf"),BOLDITALIC:s.getFontsUrl("UbuntuMono-BI.ttf")}};return a.prototype=Object.assign(Object.create(e.prototype),{constructor:a,initialize:function(){e.prototype.initialize.call(this),this.style_.addInterest("set_style__",this),this.justify_.addInterest("set_justify__",this),this.font=null,this.familyIndex=0,this.set_justify__(),this.set_style__(),this.requestAsyncLoad()},setLoadState:n.prototype.setLoadState,checkLoadState:n.prototype.checkLoadState,getMajorAlignment:function(){return this.alignments[0]},getMinorAlignment:function(){return this.alignments[1]},set_style__:function(){this.setLoadState(o.NOT_STARTED_STATE),this.requestAsyncLoad()},set_justify__:function(){var t=this.horizontal_.getValue()?this.leftToRight_.getValue():this.topToBottom_.getValue();this.alignments[0]=this.justify_.length>0?this.getAlignment(0,t):t?i.BEGIN:i.END;var e=this.horizontal_.getValue()?this.topToBottom_.getValue():this.leftToRight_.getValue();this.alignments[1]=this.justify_.length>1?this.getAlignment(1,e):e?i.FIRST:i.END},getAlignment:function(t,e){if(e)switch(this.justify_[t]){case"FIRST":return i.FIRST;case"BEGIN":return i.BEGIN;case"MIDDLE":return i.MIDDLE;case"END":return i.END}else switch(this.justify_[t]){case"FIRST":return i.END;case"BEGIN":return i.END;case"MIDDLE":return i.MIDDLE;case"END":return i.BEGIN}return t?i.FIRST:i.BEGIN},requestAsyncLoad:function(){if(this.checkLoadState()!==o.COMPLETE_STATE&&this.checkLoadState()!==o.IN_PROGRESS_STATE){this.setLoadState(o.IN_PROGRESS_STATE);var t=this.family_.copy();t.push("SERIF"),this.familyStack.length=0;for(var e=0,n=t.length;e<n;++e){var i=t[e],r=this.getDefaultFont(i);r?this.familyStack.push(r):this.familyStack.push(i)}this.loadNext()}},getDefaultFont:function(t){var e=u[t];if(e){var n=e[this.style_.getValue()];return n?n:e.PLAIN}},loadNext:function(){try{if(0===this.familyStack.length)return this.setLoadState(o.FAILED_STATE),void(this.font=null);this.family=this.familyStack.shift(),this.URL=this.loader.transform(this.family),this.getBrowser().getFont(this.URL).done(this.setFont.bind(this)).fail(this.setError.bind(this))}catch(t){this.setError(t.message)}},setError:function(t){"data"!==this.URL.scheme&&console.warn("Error loading font '"+this.URL.toString()+"':",t),this.loadNext()},setFont:function(t){this.font=t,this.setLoadState(o.COMPLETE_STATE),this.addNodeEvent()},getFont:function(){return this.font}}),a}),define("standard/Math/Geometry/Box2",["standard/Math/Numbers/Matrix3","standard/Math/Numbers/Vector2"],function(t,e){"use strict";function n(e,n){switch(arguments.length){case 0:return void(this.matrix=new t(.5,0,0,0,.5,0,0,0,0));case 2:return void(this.matrix=new t(e.x/2,0,0,0,e.y/2,0,n.x,n.y,1));case 3:var i=arguments[0],r=arguments[1],o=(r.x-i.x)/2,s=(r.y-i.y)/2,a=(r.x+i.x)/2,u=(r.y+i.y)/2;return void(this.matrix=new t(o,0,0,0,s,0,a,u,1))}}return n.prototype={constructor:n,copy:function(){var t=Object.create(n.prototype);return t.matrix=this.matrix.copy(),t},assign:function(t){return this.matrix.assign(t.matrix),this},equals:function(t){return this.matrix.equals(t.matrix)},set:function(t,e){var n=this.matrix;switch(arguments.length){case 0:return n[0]=.5,n[1]=0,n[2]=0,n[3]=0,n[4]=.5,n[5]=0,n[6]=0,n[7]=0,n[8]=0,this;case 2:return n[0]=t.x/2,n[1]=0,n[2]=0,n[3]=0,n[4]=t.y/2,n[5]=0,n[6]=e.x,n[7]=e.y,n[8]=1,this;case 3:var i=arguments[0],r=arguments[1],o=(r.x-i.x)/2,s=(r.y-i.y)/2,a=(r.x+i.x)/2,u=(r.y+i.y)/2;return this.matrix.set(o,0,0,0,s,0,a,u,1),this}},setExtents:function(t,e){var n=this.matrix,i=(e.x-t.x)/2,r=(e.y-t.y)/2,o=(e.x+t.x)/2,s=(e.y+t.y)/2;return n[0]=i,n[1]=0,n[2]=0,n[3]=0,n[4]=r,n[5]=0,n[6]=o,n[7]=s,n[8]=1,this},isEmpty:function(){return 0===this.matrix[8]},add:function(){var t=new e(0,0),n=new e(0,0),i=new e(0,0),r=new e(0,0);return function(e){return this.isEmpty()?this.assign(e):e.isEmpty()?this:(this.getExtents(t,n),e.getExtents(i,r),this.set(t.min(i),n.max(r),!0))}}(),multLeft:function(t){return this.matrix.multLeft(t),this},multRight:function(t){return this.matrix.multRight(t),this},getExtents:function(t,e){this.getAbsoluteExtents(t,e),t.add(this.center),e.add(this.center)},getAbsoluteExtents:function(){var t=new e(0,0);return function(e,n){var i=this.matrix,r=i.xAxis,o=i.yAxis;t.assign(r).add(o);var s=o.subtract(r);e.assign(t).min(s),n.assign(t).max(s),t.negate(),s.negate(),e.min(t,s),n.max(t,s)}}(),intersectsPoint:function(){var t=new e(0,0),n=new e(0,0);return function(e){return this.getExtents(t,n),t.x<=e.x&&n.x>=e.x&&t.y<=e.y&&n.y>=e.y}}(),toString:function(){return this.size+", "+this.center}},Object.defineProperty(n.prototype,"size",{get:function(){var t=new e(0,0),n=new e(0,0);return function(){return this.getAbsoluteExtents(t,n),n.subtract(t)}}(),enumerable:!0,configurable:!1}),Object.defineProperty(n.prototype,"center",{get:function(){return this.matrix.origin},enumerable:!0,configurable:!1}),n}),define("x_ite/Browser/Text/X3DTextGeometry",["x_ite/Browser/Text/TextAlignment","standard/Math/Geometry/Box2","standard/Math/Geometry/Box3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(t,e,n,i,r){"use strict";function o(t,e){this.text=t,this.fontStyle=e,this.glyphs=[],this.minorAlignment=new i(0,0),this.translations=[],this.charSpacings=[],this.bearing=new i(0,0),this.yPad=[],this.bbox=new n}var s=new e,a=new e,u=new i(0,0),l=new i(0,0),c=new i(0,0),h=new i(0,0),d=new r(0,0,0),p=new r(0,0,0),f=new i(0,0),g=new i(0,0),m=new i(0,0),x=new i(0,0),v=new i(0,0),_=new r(0,0,0),y=new i(0,0),w=new e,b=new i(0,0),S=new r(0,0,0);return o.prototype={constructor:o,getBrowser:function(){return this.text.getBrowser()},getText:function(){return this.text},getFontStyle:function(){return this.fontStyle},getGlyphs:function(){return this.glyphs},getMinorAlignment:function(){return this.minorAlignment},getTranslations:function(){return this.translations},getCharSpacings:function(){return this.charSpacings},getBearing:function(){return this.bearing},getBBox:function(){return this.bbox},update:function(){var t=this.text,e=this.fontStyle,n=t.string_.length;if(t.lineBounds_.length=n,this.glyphs.length=0,0===n||!e.getFont())return t.origin_.setValue(S),t.textBounds_.setValue(b),void this.bbox.set();if(e.horizontal_.getValue())this.resizeArray(this.translations,n),this.resizeArray(this.charSpacings,n),this.horizontal(t,e);else{for(var i=t.string_,r=0,o=0,s=i.length;o<s;++o)r+=i[o].length;this.resizeArray(this.translations,r),this.resizeArray(this.charSpacings,r),this.vertical(t,e)}},resizeArray:function(t,e){for(var n=t.length;n<e;++n)t.push(new i(0,0));t.length=e},horizontal:function(e,n){var i=n.getFont(),r=e.string_,o=r.length,a=Math.max(0,e.maxExtent_.getValue()),c=n.topToBottom_.getValue(),h=n.getScale(),x=n.spacing_.getValue();s.set();for(var y=c?0:o-1,b=c?o:-1,S=c?1:-1,C=y,T=0;C!==b;C+=S,++T){var F=r[C],O=this.getHorizontalLineExtents(n,F,u,l,T);f.assign(l).subtract(u);var N=c?C:o-C-1,E=0,M=e.getLength(C);switch(v.set(f.x,0==N?l.y-i.descender/i.unitsPerEm:x).multiply(h),a&&(M=M?Math.min(a,M):Math.min(a,f.x*h)),M&&(E=(M-v.x)/(O.length-1),v.x=M,f.x=M/h),this.charSpacings[T]=E,e.lineBounds_[C]=v,n.getMajorAlignment()){case t.BEGIN:case t.FIRST:this.translations[T].set(0,-T*x);break;case t.MIDDLE:this.translations[T].set(-u.x-f.x/2,-T*x);break;case t.END:this.translations[T].set(-u.x-f.x,-T*x)}this.translations[T].multiply(h),g.assign(u).add(m.assign(f).divide(2)),s.add(w.set(f.multiply(h),g.multiply(h).add(this.translations[T])))}switch(s.getExtents(u,l),f.assign(l).subtract(u),e.textBounds_=f,this.bearing.set(0,-l.y),n.getMinorAlignment()){case t.BEGIN:this.minorAlignment.assign(this.bearing);break;case t.FIRST:this.minorAlignment.set(0,0);break;case t.MIDDLE:this.minorAlignment.set(0,f.y/2-l.y);break;case t.END:this.minorAlignment.set(0,(o-1)*x*h)}u.add(this.minorAlignment),l.add(this.minorAlignment),e.origin_.setValue(_.set(u.x,l.y,0)),this.bbox.setExtents(d.set(u.x,u.y,0),p.set(l.x,l.y,0))},vertical:function(e,n){var r=n.getFont(),o=e.string_,h=o.length,b=Math.max(0,e.maxExtent_.getValue()),S=n.leftToRight_.getValue(),C=n.topToBottom_.getValue(),T=n.getScale(),F=n.spacing_.getValue(),O=this.yPad,N=this.getBrowser().getBrowserOptions().getPrimitiveQuality();s.set();for(var E=S?0:h-1,M=S?h:-1,D=S?1:-1,V=0,I=E;I!==M;I+=D){var B=this.stringToGlyphs(r,o[I],!0,I),L=V,A=B.length;a.set();for(var P=C?0:A-1,R=C?A:-1,k=C?1:-1,U=P;U!==R;U+=k,++V){var z=B[U];this.getGlyphExtents(r,z,N,u,l),f.assign(l).subtract(u);var X=C?U:A-U-1;this.translations[V].set((F-f.x-u.x)/2,-X),g.assign(u).add(m.assign(f).divide(2)).add(this.translations[V]),a.add(w.set(f,g))}a.getExtents(u,l),f.assign(l).subtract(u);var j=S?I:h-I-1,G=(F-f.x)/2,H=0,q=e.getLength(I);switch(v.set(0===I?F-G:F,A?f.y:0).multiply(T),b&&(q=q?Math.min(b,q):Math.min(b,f.y*T)),q&&(H=(q-v.y)/(B.length-1)/T,v.y=q,f.y=q/T,u.y=l.y-f.y),e.lineBounds_[I]=v,n.getMajorAlignment()){case t.BEGIN:case t.FIRST:x.set(j*F,-1);break;case t.MIDDLE:x.set(j*F,f.y/2-l.y);break;case t.END:A&&this.getGlyphExtents(r,B[C?A-1:0],N,c.assign(i.Zero),y),x.set(j*F,f.y-l.y+c.y)}for(var W=0,Y=L;Y<V;++Y)this.translations[Y].add(x),this.translations[Y].y-=W,this.translations[Y].multiply(T),W+=H;switch(n.getMajorAlignment()){case t.BEGIN:case t.FIRST:O[I]=l.y+x.y;break;case t.MIDDLE:O[I]=0;break;case t.END:O[I]=u.y+x.y}g.assign(u).add(m.assign(f).divide(2)),s.add(w.set(f.multiply(T),g.add(x).multiply(T)))}switch(s.getExtents(u,l),f.assign(l).subtract(u),n.getMajorAlignment()){case t.BEGIN:case t.FIRST:for(var $=e.lineBounds_,Z=0,q=$.length;Z<q;++Z)$[Z].y+=l.y-O[Z]*T;break;case t.MIDDLE:break;case t.END:for(var $=e.lineBounds_,Z=0,q=$.length;Z<q;++Z)$[Z].y+=O[Z]*T-u.y}switch(e.textBounds_=f,n.getMajorAlignment()){case t.BEGIN:case t.FIRST:this.bearing.set(-u.x,l.y);break;case t.MIDDLE:this.bearing.set(-u.x,0);break;case t.END:this.bearing.set(-u.x,u.y)}switch(n.getMinorAlignment()){case t.BEGIN:case t.FIRST:this.minorAlignment.set(-u.x,0);break;case t.MIDDLE:this.minorAlignment.set(-u.x-f.x/2,0);break;case t.END:this.minorAlignment.set(-u.x-f.x,0)}u.add(this.minorAlignment),l.add(this.minorAlignment),e.origin_.setValue(_.set(u.x,l.y,0)),this.bbox.set(d.set(u.x,u.y,0),p.set(l.x,l.y,0),!0)},stringToGlyphs:function(t,e,n,i){var r=this.glyphs[i];r||(r=this.glyphs[i]=[]),r.length=e.length;for(var o=n?0:e.length-1,s=n?e.length:-1,a=n?1:-1,u=o,l=0;u!==s;u+=a,++l)r[l]=t.charToGlyph(e[u]);return r},getHorizontalLineExtents:function(e,n,i,r,o){for(var s=e.getFont(),a=e.horizontal_.getValue()?e.leftToRight_.getValue():e.topToBottom_.getValue(),u=this.stringToGlyphs(s,n,a,o),l=this.getBrowser().getBrowserOptions().getPrimitiveQuality(),d=0,p=0,f=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,m=0,x=u.length;m<x;++m){var v=u[m],_=m+1<x?s.getKerningValue(v,u[m+1]):0;this.getGlyphExtents(s,v,l,c,h),p+=v.advanceWidth+_,f=Math.min(f,c.y),g=Math.max(g,h.y)}switch(u.length?(this.getGlyphExtents(s,u[0],l,c,h),d=c.x):(f=0,g=0),i.set(d,f),r.set(p/s.unitsPerEm,g),e.getMajorAlignment()){case t.BEGIN:case t.FIRST:i.x=0}return u},traverse:function(t,e){}},o});var Bezier=function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";t.exports=n(1)},function(t,e,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};!function(){function e(t,e,n,i,r){void 0===r&&(r=.5);var o=p.projectionratio(r,t),s=1-o,a={x:o*e.x+s*i.x,y:o*e.y+s*i.y},u=p.abcratio(r,t);return{A:{x:n.x+(n.x-a.x)/u,y:n.y+(n.y-a.y)/u},B:n,C:a}}var r=Math.abs,o=Math.min,s=Math.max,a=Math.cos,u=Math.sin,l=Math.acos,c=Math.sqrt,h=Math.PI,d={x:0,y:0,z:0},p=n(2),f=n(3),g=function(t){var e=t&&t.forEach?t:[].slice.call(arguments),n=!1;if("object"===i(e[0])){n=e.length;var o=[];e.forEach(function(t){["x","y","z"].forEach(function(e){void 0!==t[e]&&o.push(t[e])})}),e=o}var s=!1,a=e.length;if(n){if(n>4){if(1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");s=!0}}else if(6!==a&&8!==a&&9!==a&&12!==a&&1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");var u=!s&&(9===a||12===a)||t&&t[0]&&void 0!==t[0].z;this._3d=u;for(var l=[],c=0,h=u?3:2;a>c;c+=h){var d={x:e[c],y:e[c+1]};u&&(d.z=e[c+2]),l.push(d)}this.order=l.length-1,this.points=l;var f=["x","y"];u&&f.push("z"),this.dims=f,this.dimlen=f.length,function(t){for(var e=t.order,n=t.points,i=p.align(n,{p1:n[0],p2:n[e]}),o=0;o<i.length;o++)if(r(i[o].y)>1e-4)return void(t._linear=!1);t._linear=!0}(this),this._t1=0,this._t2=1,this.update()},m=n(4);g.SVGtoBeziers=function(t){return m(g,t)},g.quadraticFromPoints=function(t,n,i,r){return void 0===r&&(r=.5),0===r?new g(n,n,i):1===r?new g(t,n,n):new g(t,e(2,t,n,i,r).A,i)},g.cubicFromPoints=function(t,n,i,r,o){void 0===r&&(r=.5);var s=e(3,t,n,i,r);void 0===o&&(o=p.dist(n,s.C));var a=o*(1-r)/r,u=p.dist(t,i),l=(i.x-t.x)/u,c=(i.y-t.y)/u,h=o*l,d=o*c,f=a*l,m=a*c,x={x:n.x-h,y:n.y-d},v={x:n.x+f,y:n.y+m},_=s.A,y={x:_.x+(x.x-_.x)/(1-r),y:_.y+(x.y-_.y)/(1-r)},w={x:_.x+(v.x-_.x)/r,y:_.y+(v.y-_.y)/r};return new g(t,{x:t.x+(y.x-t.x)/r,y:t.y+(y.y-t.y)/r},{x:i.x+(w.x-i.x)/(1-r),y:i.y+(w.y-i.y)/(1-r)},i)};var x=function(){return p};g.getUtils=x,g.PolyBezier=f,g.prototype={getUtils:x,valueOf:function(){return this.toString()},toString:function(){return p.pointsToString(this.points)},toSVG:function(t){if(this._3d)return!1;for(var e=this.points,n=e[0].x,i=e[0].y,r=["M",n,i,2===this.order?"Q":"C"],o=1,s=e.length;s>o;o++)r.push(e[o].x),r.push(e[o].y);return r.join(" ")},update:function(){this._lut=[],this.dpoints=p.derive(this.points,this._3d),this.computedirection()},computedirection:function(){var t=this.points,e=p.angle(t[0],t[this.order],t[1]);this.clockwise=e>0},length:function(){return p.length(this.derivative.bind(this))},_lut:[],getLUT:function(t){if(t=t||100,this._lut.length===t)return this._lut;this._lut=[],t--;for(var e=0;t>=e;e++)this._lut.push(this.compute(e/t));return this._lut},on:function(t,e){e=e||5;for(var n,i=this.getLUT(),r=[],o=0,s=0;s<i.length;s++)n=i[s],p.dist(n,t)<e&&(r.push(n),o+=s/i.length);return!!r.length&&(o/=r.length)},project:function(t){var e=this.getLUT(),n=e.length-1,i=p.closest(e,t),r=i.mdist,o=i.mpos;if(0===o||o===n){var s=o/n,a=this.compute(s);return a.t=s,a.d=r,a}var u,s,l,c,h=(o-1)/n,d=(o+1)/n,f=.1/n;for(r+=1,s=h,u=s;d+f>s;s+=f)l=this.compute(s),c=p.dist(t,l),r>c&&(r=c,u=s);return l=this.compute(u),l.t=u,l.d=r,l},get:function(t){return this.compute(t)},point:function(t){return this.points[t]},compute:function(t){return p.compute(t,this.points,this._3d)},raise:function(){for(var t,e,n,i=this.points,r=[i[0]],o=i.length,t=1;o>t;t++)e=i[t],n=i[t-1],r[t]={x:(o-t)/o*e.x+t/o*n.x,y:(o-t)/o*e.y+t/o*n.y};return r[o]=i[o-1],new g(r)},derivative:function(t){var e,n,i=1-t,r=0,o=this.dpoints[0];2===this.order&&(o=[o[0],o[1],d],e=i,n=t),3===this.order&&(e=i*i,n=i*t*2,r=t*t);var s={x:e*o[0].x+n*o[1].x+r*o[2].x,y:e*o[0].y+n*o[1].y+r*o[2].y};return this._3d&&(s.z=e*o[0].z+n*o[1].z+r*o[2].z),s},curvature:function(t){
return p.curvature(t,this.points,this._3d)},inflections:function(){return p.inflections(this.points)},normal:function(t){return this._3d?this.__normal3(t):this.__normal2(t)},__normal2:function(t){var e=this.derivative(t),n=c(e.x*e.x+e.y*e.y);return{x:-e.y/n,y:e.x/n}},__normal3:function(t){var e=this.derivative(t),n=this.derivative(t+.01),i=c(e.x*e.x+e.y*e.y+e.z*e.z),r=c(n.x*n.x+n.y*n.y+n.z*n.z);e.x/=i,e.y/=i,e.z/=i,n.x/=r,n.y/=r,n.z/=r;var o={x:n.y*e.z-n.z*e.y,y:n.z*e.x-n.x*e.z,z:n.x*e.y-n.y*e.x},s=c(o.x*o.x+o.y*o.y+o.z*o.z);o.x/=s,o.y/=s,o.z/=s;var a=[o.x*o.x,o.x*o.y-o.z,o.x*o.z+o.y,o.x*o.y+o.z,o.y*o.y,o.y*o.z-o.x,o.x*o.z-o.y,o.y*o.z+o.x,o.z*o.z];return{x:a[0]*e.x+a[1]*e.y+a[2]*e.z,y:a[3]*e.x+a[4]*e.y+a[5]*e.z,z:a[6]*e.x+a[7]*e.y+a[8]*e.z}},hull:function(t){var e,n=this.points,i=[],r=[],o=0,s=0,a=0;for(r[o++]=n[0],r[o++]=n[1],r[o++]=n[2],3===this.order&&(r[o++]=n[3]);n.length>1;){for(i=[],s=0,a=n.length-1;a>s;s++)e=p.lerp(t,n[s],n[s+1]),r[o++]=e,i.push(e);n=i}return r},split:function(t,e){if(0===t&&e)return this.split(e).left;if(1===e)return this.split(t).right;var n=this.hull(t),i={left:new g(2===this.order?[n[0],n[3],n[5]]:[n[0],n[4],n[7],n[9]]),right:new g(2===this.order?[n[5],n[4],n[2]]:[n[9],n[8],n[6],n[3]]),span:n};return i.left._t1=p.map(0,0,1,this._t1,this._t2),i.left._t2=p.map(t,0,1,this._t1,this._t2),i.right._t1=p.map(t,0,1,this._t1,this._t2),i.right._t2=p.map(1,0,1,this._t1,this._t2),e?(e=p.map(e,t,1,0,1),i.right.split(e).left):i},extrema:function(){var t,e,n=this.dims,i={},r=[];return n.forEach(function(n){e=function(t){return t[n]},t=this.dpoints[0].map(e),i[n]=p.droots(t),3===this.order&&(t=this.dpoints[1].map(e),i[n]=i[n].concat(p.droots(t))),i[n]=i[n].filter(function(t){return t>=0&&1>=t}),r=r.concat(i[n].sort(p.numberSort))}.bind(this)),r=r.sort(p.numberSort).filter(function(t,e){return r.indexOf(t)===e}),i.values=r,i},bbox:function(){var t=this.extrema(),e={};return this.dims.forEach(function(n){e[n]=p.getminmax(this,n,t[n])}.bind(this)),e},overlaps:function(t){var e=this.bbox(),n=t.bbox();return p.bboxoverlap(e,n)},offset:function(t,e){if(void 0!==e){var n=this.get(t),i=this.normal(t),r={c:n,n:i,x:n.x+i.x*e,y:n.y+i.y*e};return this._3d&&(r.z=n.z+i.z*e),r}if(this._linear){var o=this.normal(0);return[new g(this.points.map(function(e){var n={x:e.x+t*o.x,y:e.y+t*o.y};return e.z&&i.z&&(n.z=e.z+t*o.z),n}))]}return this.reduce().map(function(e){return e.scale(t)})},simple:function(){if(3===this.order){var t=p.angle(this.points[0],this.points[3],this.points[1]),e=p.angle(this.points[0],this.points[3],this.points[2]);if(t>0&&0>e||0>t&&e>0)return!1}var n=this.normal(0),i=this.normal(1),o=n.x*i.x+n.y*i.y;return this._3d&&(o+=n.z*i.z),h/3>r(l(o))},reduce:function(){var t,e,n=0,i=0,o=.01,s=[],a=[],u=this.extrema().values;for(-1===u.indexOf(0)&&(u=[0].concat(u)),-1===u.indexOf(1)&&u.push(1),n=u[0],t=1;t<u.length;t++)i=u[t],e=this.split(n,i),e._t1=n,e._t2=i,s.push(e),n=i;return s.forEach(function(t){for(n=0,i=0;1>=i;)for(i=n+o;1+o>=i;i+=o)if(e=t.split(n,i),!e.simple()){if(i-=o,r(n-i)<o)return[];e=t.split(n,i),e._t1=p.map(n,0,1,t._t1,t._t2),e._t2=p.map(i,0,1,t._t1,t._t2),a.push(e),n=i;break}1>n&&(e=t.split(n,1),e._t1=p.map(n,0,1,t._t1,t._t2),e._t2=t._t2,a.push(e))}),a},scale:function(t){var e=this.order,n=!1;if("function"==typeof t&&(n=t),n&&2===e)return this.raise().scale(n);var i=this.clockwise,r=n?n(0):t,o=n?n(1):t,s=[this.offset(0,10),this.offset(1,10)],a=p.lli4(s[0],s[0].c,s[1],s[1].c);if(!a)throw new Error("cannot scale this curve. Try reducing it first.");var u=this.points,l=[];return[0,1].forEach(function(t){var n=l[t*e]=p.copy(u[t*e]);n.x+=(t?o:r)*s[t].n.x,n.y+=(t?o:r)*s[t].n.y}.bind(this)),n?([0,1].forEach(function(r){if(2!==this.order||!r){var o=u[r+1],s={x:o.x-a.x,y:o.y-a.y},h=n?n((r+1)/e):t;n&&!i&&(h=-h);var d=c(s.x*s.x+s.y*s.y);s.x/=d,s.y/=d,l[r+1]={x:o.x+h*s.x,y:o.y+h*s.y}}}.bind(this)),new g(l)):([0,1].forEach(function(t){if(2!==this.order||!t){var n=l[t*e],i=this.derivative(t),r={x:n.x+i.x,y:n.y+i.y};l[t+1]=p.lli4(n,r,a,u[t+1])}}.bind(this)),new g(l))},outline:function(t,e,n,i){function r(t,e,n,i,r){return function(o){var s=i/n,a=(i+r)/n,u=e-t;return p.map(o,0,1,t+s*u,t+a*u)}}e=void 0===e?t:e;var o,s=this.reduce(),a=s.length,u=[],l=[],c=0,h=this.length(),d=void 0!==n&&void 0!==i;s.forEach(function(o){b=o.length(),d?(u.push(o.scale(r(t,n,h,c,b))),l.push(o.scale(r(-e,-i,h,c,b)))):(u.push(o.scale(t)),l.push(o.scale(-e))),c+=b}),l=l.map(function(t){return o=t.points,o[3]?t.points=[o[3],o[2],o[1],o[0]]:t.points=[o[2],o[1],o[0]],t}).reverse();var g=u[0].points[0],m=u[a-1].points[u[a-1].points.length-1],x=l[a-1].points[l[a-1].points.length-1],v=l[0].points[0],_=p.makeline(x,g),y=p.makeline(m,v),w=[_].concat(u).concat([y]).concat(l),b=w.length;return new f(w)},outlineshapes:function(t,e,n){e=e||t;for(var i=this.outline(t,e).curves,r=[],o=1,s=i.length;s/2>o;o++){var a=p.makeshape(i[o],i[s-o],n);a.startcap.virtual=o>1,a.endcap.virtual=s/2-1>o,r.push(a)}return r},intersects:function(t,e){return t?t.p1&&t.p2?this.lineIntersects(t):(t instanceof g&&(t=t.reduce()),this.curveintersects(this.reduce(),t,e)):this.selfintersects(e)},lineIntersects:function(t){var e=o(t.p1.x,t.p2.x),n=o(t.p1.y,t.p2.y),i=s(t.p1.x,t.p2.x),r=s(t.p1.y,t.p2.y),a=this;return p.roots(this.points,t).filter(function(t){var o=a.get(t);return p.between(o.x,e,i)&&p.between(o.y,n,r)})},selfintersects:function(t){var e,n,i,r,o=this.reduce(),s=o.length-2,a=[];for(e=0;s>e;e++)i=o.slice(e,e+1),r=o.slice(e+2),n=this.curveintersects(i,r,t),a=a.concat(n);return a},curveintersects:function(t,e,n){var i=[];t.forEach(function(t){e.forEach(function(e){t.overlaps(e)&&i.push({left:t,right:e})})});var r=[];return i.forEach(function(t){var e=p.pairiteration(t.left,t.right,n);e.length>0&&(r=r.concat(e))}),r},arcs:function(t){t=t||.5;var e=[];return this._iterate(t,e)},_error:function(t,e,n,i){var o=(i-n)/4,s=this.get(n+o),a=this.get(i-o),u=p.dist(t,e),l=p.dist(t,s),c=p.dist(t,a);return r(l-u)+r(c-u)},_iterate:function(t,e){var n,i=0,r=1;do{n=0,r=1;var o,s,l,c,h,d=this.get(i),f=!1,g=!1,m=r,x=1,v=0;do{g=f,c=l,m=(i+r)/2,v++,o=this.get(m),s=this.get(r),l=p.getccenter(d,o,s),l.interval={start:i,end:r};if(f=t>=this._error(l,d,i,r),h=g&&!f,h||(x=r),f){if(r>=1){if(l.interval.end=x=1,c=l,r>1){var _={x:l.x+l.r*a(l.e),y:l.y+l.r*u(l.e)};l.e+=p.angle({x:l.x,y:l.y},_,this.get(1))}break}r+=(r-i)/2}else r=m}while(!h&&n++<100)if(n>=100)break;c=c?c:l,e.push(c),i=x}while(1>r)return e}},t.exports=g}()},function(t,e,n){"use strict";!function(){var e=Math.abs,i=Math.cos,r=Math.sin,o=Math.acos,s=Math.atan2,a=Math.sqrt,u=Math.pow,l=function(t){return 0>t?-u(-t,1/3):u(t,1/3)},c=Math.PI,h=2*c,d=c/2,p=Number.MAX_SAFE_INTEGER||9007199254740991,f=Number.MIN_SAFE_INTEGER||-9007199254740991,g={x:0,y:0,z:0},m={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(t,e){var n=e(t),i=n.x*n.x+n.y*n.y;return void 0!==n.z&&(i+=n.z*n.z),a(i)},compute:function(t,e,n){if(0===t)return e[0];var i=e.length-1;if(1===t)return e[i];var r=e,o=1-t;if(0===i)return e[0];if(1===i)return d={x:o*r[0].x+t*r[1].x,y:o*r[0].y+t*r[1].y},n&&(d.z=o*r[0].z+t*r[1].z),d;if(4>i){var s,a,u,l=o*o,c=t*t,h=0;2===i?(r=[r[0],r[1],r[2],g],s=l,a=o*t*2,u=c):3===i&&(s=l*o,a=l*t*3,u=o*c*3,h=t*c);var d={x:s*r[0].x+a*r[1].x+u*r[2].x+h*r[3].x,y:s*r[0].y+a*r[1].y+u*r[2].y+h*r[3].y};return n&&(d.z=s*r[0].z+a*r[1].z+u*r[2].z+h*r[3].z),d}for(var p=JSON.parse(JSON.stringify(e));p.length>1;){for(var f=0;f<p.length-1;f++)p[f]={x:p[f].x+(p[f+1].x-p[f].x)*t,y:p[f].y+(p[f+1].y-p[f].y)*t},void 0!==p[f].z&&(p[f]=p[f].z+(p[f+1].z-p[f].z)*t);p.splice(p.length-1,1)}return p[0]},derive:function(t,e){for(var n=[],i=t,r=i.length,o=r-1;r>1;r--,o--){for(var s,a=[],u=0;o>u;u++)s={x:o*(i[u+1].x-i[u].x),y:o*(i[u+1].y-i[u].y)},e&&(s.z=o*(i[u+1].z-i[u].z)),a.push(s);n.push(a),i=a}return n},between:function(t,e,n){return t>=e&&n>=t||m.approximately(t,e)||m.approximately(t,n)},approximately:function(t,n,i){return e(t-n)<=(i||1e-6)},length:function(t){var e,n,i=0,r=m.Tvalues.length;for(e=0;r>e;e++)n=.5*m.Tvalues[e]+.5,i+=m.Cvalues[e]*m.arcfn(n,t);return.5*i},map:function(t,e,n,i,r){return i+(t-e)/(n-e)*(r-i)},lerp:function(t,e,n){var i={x:e.x+t*(n.x-e.x),y:e.y+t*(n.y-e.y)};return e.z&&n.z&&(i.z=e.z+t*(n.z-e.z)),i},pointToString:function(t){var e=t.x+"/"+t.y;return void 0!==t.z&&(e+="/"+t.z),e},pointsToString:function(t){return"["+t.map(m.pointToString).join(", ")+"]"},copy:function(t){return JSON.parse(JSON.stringify(t))},angle:function(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=n.x-t.x,a=n.y-t.y;return s(i*a-r*o,i*o+r*a)},round:function(t,e){var n=""+t,i=n.indexOf(".");return parseFloat(n.substring(0,i+1+e))},dist:function(t,e){var n=t.x-e.x,i=t.y-e.y;return a(n*n+i*i)},closest:function(t,e){var n,i,r=u(2,63);return t.forEach(function(t,o){i=m.dist(e,t),r>i&&(r=i,n=o)}),{mdist:r,mpos:n}},abcratio:function(t,n){if(2!==n&&3!==n)return!1;if(void 0===t)t=.5;else if(0===t||1===t)return t;var i=u(t,n)+u(1-t,n);return e((i-1)/i)},projectionratio:function(t,e){if(2!==e&&3!==e)return!1;if(void 0===t)t=.5;else if(0===t||1===t)return t;var n=u(1-t,e);return n/(u(t,e)+n)},lli8:function(t,e,n,i,r,o,s,a){var u=(t*i-e*n)*(r-s)-(t-n)*(r*a-o*s),l=(t*i-e*n)*(o-a)-(e-i)*(r*a-o*s),c=(t-n)*(o-a)-(e-i)*(r-s);return 0!=c&&{x:u/c,y:l/c}},lli4:function(t,e,n,i){var r=t.x,o=t.y,s=e.x,a=e.y,u=n.x,l=n.y,c=i.x,h=i.y;return m.lli8(r,o,s,a,u,l,c,h)},lli:function(t,e){return m.lli4(t,t.c,e,e.c)},makeline:function(t,e){var i=n(1),r=t.x,o=t.y,s=e.x,a=e.y,u=(s-r)/3,l=(a-o)/3;return new i(r,o,r+u,o+l,r+2*u,o+2*l,s,a)},findbbox:function(t){var e=p,n=p,i=f,r=f;return t.forEach(function(t){var o=t.bbox();e>o.x.min&&(e=o.x.min),n>o.y.min&&(n=o.y.min),i<o.x.max&&(i=o.x.max),r<o.y.max&&(r=o.y.max)}),{x:{min:e,mid:(e+i)/2,max:i,size:i-e},y:{min:n,mid:(n+r)/2,max:r,size:r-n}}},shapeintersections:function(t,e,n,i,r){if(!m.bboxoverlap(e,i))return[];var o=[],s=[t.startcap,t.forward,t.back,t.endcap],a=[n.startcap,n.forward,n.back,n.endcap];return s.forEach(function(e){e.virtual||a.forEach(function(i){if(!i.virtual){var s=e.intersects(i,r);s.length>0&&(s.c1=e,s.c2=i,s.s1=t,s.s2=n,o.push(s))}})}),o},makeshape:function(t,e,n){var i=e.points.length,r=t.points.length,o=m.makeline(e.points[i-1],t.points[0]),s=m.makeline(t.points[r-1],e.points[0]),a={startcap:o,forward:t,back:e,endcap:s,bbox:m.findbbox([o,t,e,s])},u=m;return a.intersections=function(t){return u.shapeintersections(a,a.bbox,t,t.bbox,n)},a},getminmax:function(t,e,n){if(!n)return{min:0,max:0};var i,r,o=p,s=f;-1===n.indexOf(0)&&(n=[0].concat(n)),-1===n.indexOf(1)&&n.push(1);for(var a=0,u=n.length;u>a;a++)i=n[a],r=t.get(i),r[e]<o&&(o=r[e]),r[e]>s&&(s=r[e]);return{min:o,mid:(o+s)/2,max:s,size:s-o}},align:function(t,e){var n=e.p1.x,o=e.p1.y,a=-s(e.p2.y-o,e.p2.x-n),u=function(t){return{x:(t.x-n)*i(a)-(t.y-o)*r(a),y:(t.x-n)*r(a)+(t.y-o)*i(a)}};return t.map(u)},roots:function(t,e){e=e||{p1:{x:0,y:0},p2:{x:1,y:0}};var n=t.length-1,r=m.align(t,e),s=function(t){return t>=0&&1>=t};if(2===n){var u=r[0].y,c=r[1].y,d=r[2].y,p=u-2*c+d;if(0!==p){var f=-a(c*c-u*d),g=-u+c,x=-(f+g)/p;return[x,-(-f+g)/p].filter(s)}return c!==d&&0===p?[(2*c-d)/(2*c-2*d)].filter(s):[]}var v=r[0].y,_=r[1].y,y=r[2].y,w=r[3].y,p=3*_-v-3*y+w,u=3*v-6*_+3*y,c=-3*v+3*_,d=v;if(m.approximately(p,0)){if(m.approximately(u,0))return m.approximately(c,0)?[]:[-d/c].filter(s);var b=a(c*c-4*u*d),S=2*u;return[(b-c)/S,(-c-b)/S].filter(s)}u/=p,c/=p,d/=p;var C,x,T,F,O,r=(3*c-u*u)/3,N=r/3,b=(2*u*u*u-9*u*c+27*d)/27,E=b/2,M=E*E+N*N*N;if(0>M){var D=-r/3,V=D*D*D,I=a(V),B=-b/(2*I),L=-1>B?-1:B>1?1:B,A=o(L),P=l(I),R=2*P;return T=R*i(A/3)-u/3,F=R*i((A+h)/3)-u/3,O=R*i((A+2*h)/3)-u/3,[T,F,O].filter(s)}if(0===M)return C=0>E?l(-E):-l(E),T=2*C-u/3,F=-C-u/3,[T,F].filter(s);var k=a(M);return C=l(-E+k),x=l(E+k),[C-x-u/3].filter(s)},droots:function(t){if(3===t.length){var e=t[0],n=t[1],i=t[2],r=e-2*n+i;if(0!==r){var o=-a(n*n-e*i),s=-e+n;return[-(o+s)/r,-(-o+s)/r]}return n!==i&&0===r?[(2*n-i)/(2*(n-i))]:[]}if(2===t.length){var e=t[0],n=t[1];return e!==n?[e/(e-n)]:[]}},curvature:function(t,e,n){var i,r,o=m.derive(e),s=o[0],l=o[1],c=m.compute(t,s),h=m.compute(t,l);return n?(i=a(u(c.y*h.z-h.y*c.z,2)+u(c.z*h.x-h.z*c.x,2)+u(c.x*h.y-h.x*c.y,2)),r=u(c.x*c.x+c.y*c.y+c.z*c.z,2/3)):(i=c.x*h.y-c.y*h.x,r=u(c.x*c.x+c.y*c.y,2/3)),0===i||0===r?{k:0,r:0}:{k:i/r,r:r/i}},inflections:function(t){if(t.length<4)return[];var e=m.align(t,{p1:t[0],p2:t.slice(-1)[0]}),n=e[2].x*e[1].y,i=e[3].x*e[1].y,r=e[1].x*e[2].y,o=e[3].x*e[2].y,s=18*(-3*n+2*i+3*r-o),a=18*(3*n-i-3*r),u=18*(r-n);if(m.approximately(s,0)){if(!m.approximately(a,0)){var l=-u/a;if(l>=0&&1>=l)return[l]}return[]}var c=a*a-4*s*u,h=Math.sqrt(c),o=2*s;return m.approximately(o,0)?[]:[(h-a)/o,-(a+h)/o].filter(function(t){return t>=0&&1>=t})},bboxoverlap:function(t,n){var i,r,o,s,a,u=["x","y"],l=u.length;for(i=0;l>i;i++)if(r=u[i],o=t[r].mid,s=n[r].mid,a=(t[r].size+n[r].size)/2,e(o-s)>=a)return!1;return!0},expandbox:function(t,e){e.x.min<t.x.min&&(t.x.min=e.x.min),e.y.min<t.y.min&&(t.y.min=e.y.min),e.z&&e.z.min<t.z.min&&(t.z.min=e.z.min),e.x.max>t.x.max&&(t.x.max=e.x.max),e.y.max>t.y.max&&(t.y.max=e.y.max),e.z&&e.z.max>t.z.max&&(t.z.max=e.z.max),t.x.mid=(t.x.min+t.x.max)/2,t.y.mid=(t.y.min+t.y.max)/2,t.z&&(t.z.mid=(t.z.min+t.z.max)/2),t.x.size=t.x.max-t.x.min,t.y.size=t.y.max-t.y.min,t.z&&(t.z.size=t.z.max-t.z.min)},pairiteration:function(t,e,n){var i=t.bbox(),r=e.bbox(),o=1e5,s=n||.5;if(i.x.size+i.y.size<s&&r.x.size+r.y.size<s)return[(o*(t._t1+t._t2)/2|0)/o+"/"+(o*(e._t1+e._t2)/2|0)/o];var a=t.split(.5),u=e.split(.5),l=[{left:a.left,right:u.left},{left:a.left,right:u.right},{left:a.right,right:u.right},{left:a.right,right:u.left}];l=l.filter(function(t){return m.bboxoverlap(t.left.bbox(),t.right.bbox())});var c=[];return 0===l.length?c:(l.forEach(function(t){c=c.concat(m.pairiteration(t.left,t.right,s))}),c=c.filter(function(t,e){return c.indexOf(t)===e}))},getccenter:function(t,e,n){var o,a=e.x-t.x,u=e.y-t.y,l=n.x-e.x,c=n.y-e.y,p=a*i(d)-u*r(d),f=a*r(d)+u*i(d),g=l*i(d)-c*r(d),x=l*r(d)+c*i(d),v=(t.x+e.x)/2,_=(t.y+e.y)/2,y=(e.x+n.x)/2,w=(e.y+n.y)/2,b=v+p,S=_+f,C=y+g,T=w+x,F=m.lli8(v,_,b,S,y,w,C,T),O=m.dist(F,t),N=s(t.y-F.y,t.x-F.x),E=s(e.y-F.y,e.x-F.x),M=s(n.y-F.y,n.x-F.x);return M>N?((N>E||E>M)&&(N+=h),N>M&&(o=M,M=N,N=o)):E>M&&N>E?(o=M,M=N,N=o):M+=h,F.s=N,F.e=M,F.r=O,F},numberSort:function(t,e){return t-e}};t.exports=m}()},function(t,e,n){"use strict";!function(){var e=n(2),i=function(t){this.curves=[],this._3d=!1,t&&(this.curves=t,this._3d=this.curves[0]._3d)};i.prototype={valueOf:function(){return this.toString()},toString:function(){return"["+this.curves.map(function(t){return e.pointsToString(t.points)}).join(", ")+"]"},addCurve:function(t){this.curves.push(t),this._3d=this._3d||t._3d},length:function(){return this.curves.map(function(t){return t.length()}).reduce(function(t,e){return t+e})},curve:function(t){return this.curves[t]},bbox:function t(){for(var n=this.curves,t=n[0].bbox(),i=1;i<n.length;i++)e.expandbox(t,n[i].bbox());return t},offset:function t(e){var t=[];return this.curves.forEach(function(n){t=t.concat(n.offset(e))}),new i(t)}},t.exports=i}()},function(t,e,n){"use strict";function i(t,e,n){if("Z"!==e){if("M"===e)return void(s={x:n[0],y:n[1]});var i=[!1,s.x,s.y].concat(n),r=t.bind.apply(t,i),o=new r,a=n.slice(-2);return s={x:a[0],y:a[1]},o}}function r(t,e){for(var n,r,s,a=o(e).split(" "),u=new RegExp("[MLCQZ]",""),l=[],c={C:6,Q:4,L:2,M:2};a.length;)n=a.splice(0,1)[0],u.test(n)&&(s=a.splice(0,c[n]).map(parseFloat),(r=i(t,n,s))&&l.push(r));return new t.PolyBezier(l)}var o=n(5),s={x:!1,y:!1};t.exports=r},function(t,e){"use strict";function n(t){t=t.replace(/,/g," ").replace(/-/g," - ").replace(/-\s+/g,"-").replace(/([a-zA-Z])/g," $1 ");var e,n,i,r,o,s,a=t.replace(/([a-zA-Z])\s?/g,"|$1").split("|"),u=a.length,l=[],c=0,h=0,d=0,p=0,f=0,g=0,m=0,x=0,v="";for(e=1;u>e;e++)if(n=a[e],i=n.substring(0,1),r=i.toLowerCase(),l=n.replace(i,"").trim().split(" "),l=l.filter(function(t){return""!==t}).map(parseFloat),o=l.length,"m"===r){if(v+="M ","m"===i?(d+=l[0],p+=l[1]):(d=l[0],p=l[1]),c=d,h=p,v+=d+" "+p+" ",o>2)for(s=0;o>s;s+=2)"m"===i?(d+=l[s],p+=l[s+1]):(d=l[s],p=l[s+1]),v+=["L",d,p,""].join(" ")}else if("l"===r)for(s=0;o>s;s+=2)"l"===i?(d+=l[s],p+=l[s+1]):(d=l[s],p=l[s+1]),v+=["L",d,p,""].join(" ");else if("h"===r)for(s=0;o>s;s++)"h"===i?d+=l[s]:d=l[s],v+=["L",d,p,""].join(" ");else if("v"===r)for(s=0;o>s;s++)"v"===i?p+=l[s]:p=l[s],v+=["L",d,p,""].join(" ");else if("q"===r)for(s=0;o>s;s+=4)"q"===i?(f=d+l[s],g=p+l[s+1],d+=l[s+2],p+=l[s+3]):(f=l[s],g=l[s+1],d=l[s+2],p=l[s+3]),v+=["Q",f,g,d,p,""].join(" ");else if("t"===r)for(s=0;o>s;s+=2)f=d+(d-f),g=p+(p-g),"t"===i?(d+=l[s],p+=l[s+1]):(d=l[s],p=l[s+1]),v+=["Q",f,g,d,p,""].join(" ");else if("c"===r)for(s=0;o>s;s+=6)"c"===i?(f=d+l[s],g=p+l[s+1],m=d+l[s+2],x=p+l[s+3],d+=l[s+4],p+=l[s+5]):(f=l[s],g=l[s+1],m=l[s+2],x=l[s+3],d=l[s+4],p=l[s+5]),v+=["C",f,g,m,x,d,p,""].join(" ");else if("s"===r)for(s=0;o>s;s+=4)f=d+(d-m),g=p+(p-x),"s"===i?(m=d+l[s],x=p+l[s+1],d+=l[s+2],p+=l[s+3]):(m=l[s],x=l[s+1],d=l[s+2],p=l[s+3]),v+=["C",f,g,m,x,d,p,""].join(" ");else"z"===r&&(v+="Z ",d=c,p=h);return v.trim()}t.exports=n}]);define("bezier",["bezier/bezier"],function(t){return t}),define("bezier/bezier",function(){}),define("x_ite/Browser/Text/PolygonText",["x_ite/Fields","x_ite/Browser/Core/PrimitiveQuality","x_ite/Browser/Text/X3DTextGeometry","x_ite/Components/Rendering/X3DGeometryNode","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Triangle3","bezier"],function(t,e,n,i,r,o,s,a){"use strict";function u(t,e){n.call(this,t,e),t.transparent_=!1,this.texCoordArray=i.createArray()}return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,getTransparent:function(){return!1},getMatrix:function(){return o.Identity},build:function(){var t=new r(0,0,0),e=new r(0,0,0);return function(){var n=this.getFontStyle(),i=n.getFont();if(i){var r=this.getText(),o=this.getGlyphs(),s=this.getMinorAlignment(),a=this.getTranslations(),u=this.getCharSpacings(),l=n.getScale(),c=n.spacing_.getValue(),h=r.origin_.getValue(),d=l/i.unitsPerEm,p=this.getBrowser().getBrowserOptions().getPrimitiveQuality(),f=this.texCoordArray,g=r.getNormals(),m=r.getVertices();if(r.getMultiTexCoords().push(f),this.getBBox().getExtents(t,e),r.getMin().assign(t),r.getMax().assign(e),n.horizontal_.getValue())for(var x=0,v=o.length;x<v;++x)for(var _=o[x],y=u[x],w=a[x],b=0,S=0,C=_.length;S<C;++S){for(var T=_[S],F=this.getGlyphGeometry(i,T,p),O=0,N=F.length;O<N;++O){var E=F[O].x*l+s.x+w.x+b+S*y,M=F[O].y*l+s.y+w.y;f.push((E-h.x)/c,(M-h.y)/c,0,1),g.push(0,0,1),m.push(E,M,0,1)}var D=0;S+1<_.length&&(D=i.getKerningValue(T,_[S+1])),b+=(T.advanceWidth+D)*d}else for(var V=n.leftToRight_.getValue(),I=n.topToBottom_.getValue(),B=V?0:r.string_.length-1,L=V?r.string_.length:-1,A=V?1:-1,x=B,P=0;x!==L;x+=A)for(var _=o[x],R=_.length,k=I?0:R-1,U=I?R:-1,z=I?1:-1,S=k;S!==U;S+=z,++P)for(var w=a[P],F=this.getGlyphGeometry(i,_[S],p),O=0,N=F.length;O<N;++O){var E=F[O].x*l+s.x+w.x,M=F[O].y*l+s.y+w.y;f.push((E-h.x)/c,(M-h.y)/c,0,1),g.push(0,0,1),m.push(E,M,0,1)}}}}(),getGlyphExtents:function(t,e,n,i,r){var o=this.getBrowser().getGlyph(t,n,e.index),s=o.extents;if(s)return i.assign(s.min),void r.assign(s.max);var a=this.getGlyphGeometry(t,e,n);if(a.length){var u=a[0];i.assign(u),r.assign(u);for(var l=1,c=a.length;l<c;++l){var u=a[l];i.min(u),r.max(u)}}else i.set(0,0,0),r.set(0,0,0);var s=o.extents={};s.min=i.copy(),s.max=r.copy()},getGlyphGeometry:function(t,e,n){var i=this.getBrowser().getGlyph(t,n,e.index),r=i.geometry;return r?r:(r=i.geometry=[],this.createGlyphGeometry(e,r,n),r)},createGlyphGeometry:function(){var t=[],e=[],n=new r(0,0,0);return function(i,o,a){var u=this.getFontStyle(),l=(u.getFont(),this.getBezierDimension(a)),c=i.getPath(0,0,1),h=c.commands,d=0,p=0;t.length=0,e.length=0;for(var f=0,g=h.length;f<g;++f){var m=h[f];switch(m.type){case"M":case"Z":t.length>2&&(t[0].x===t[t.length-1].x&&t[0].y===t[t.length-1].y&&t.pop(),e.push(t)),t=[],"M"===m.type&&t.push(new r(m.x,-m.y,0));break;case"L":t.push(new r(m.x,-m.y,0));break;case"C":for(var x=new Bezier(d,-p,m.x1,-m.y1,m.x2,-m.y2,m.x,-m.y),v=x.getLUT(l),_=1,y=v.length;_<y;++_)t.push(new r(v[_].x,v[_].y,0));break;case"Q":for(var x=new Bezier(d,-p,m.x1,-m.y1,m.x,-m.y),v=x.getLUT(l),_=1,y=v.length;_<y;++_)t.push(new r(v[_].x,v[_].y,0));break;default:continue}d=m.x,p=m.y}e=e.map(function(t){return s.getPolygonNormal(t,n),n.dot(r.zAxis)>0?t:t.reverse()}),e.push(o),s.triangulatePolygon.apply(s,e)}}(),getBezierDimension:function(t){switch(t){case e.LOW:return 3;case e.HIGH:return 7;default:return 5}},display:function(t,e){},transformLine:function(t){},transformMatrix:function(t){}}),u}),define("x_ite/Components/Text/FontStyle",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Text/X3DFontStyleNode","x_ite/Browser/Text/PolygonText","x_ite/Bits/X3DConstants"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(o.FontStyle),this.size_.setUnit("length")}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOutput,"language",new t.SFString),new e(o.inputOutput,"family",new t.MFString("SERIF")),new e(o.inputOutput,"style",new t.SFString("PLAIN")),new e(o.inputOutput,"size",new t.SFFloat(1)),new e(o.inputOutput,"spacing",new t.SFFloat(1)),new e(o.inputOutput,"horizontal",new t.SFBool(!0)),new e(o.inputOutput,"leftToRight",new t.SFBool(!0)),new e(o.inputOutput,"topToBottom",new t.SFBool(!0)),new e(o.inputOutput,"justify",new t.MFString("BEGIN"))]),getTypeName:function(){return"FontStyle"},getComponentName:function(){return"Text"},getContainerField:function(){return"fontStyle"},getTextGeometry:function(t){return new r(t,this)},getScale:function(){return this.size_.getValue()}}),s}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define("opentype/dist/opentype",["exports"],e):e(t.opentype={})}(this,function(t){"use strict";function e(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function n(t,n){this.source=t,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=n,this.destLen=0,this.ltree=new e,this.dtree=new e}function i(t,e,n,i){var r,o;for(r=0;r<n;++r)t[r]=0;for(r=0;r<30-n;++r)t[r+n]=r/n|0;for(o=i,r=0;r<30;++r)e[r]=o,o+=1<<t[r]}function r(t,e,n,i){var r,o;for(r=0;r<16;++r)t.table[r]=0;for(r=0;r<i;++r)t.table[e[n+r]]++;for(t.table[0]=0,o=0,r=0;r<16;++r)io[r]=o,o+=t.table[r];for(r=0;r<i;++r)e[n+r]&&(t.trans[io[e[n+r]]++]=r)}function o(t){t.bitcount--||(t.tag=t.source[t.sourceIndex++],t.bitcount=7);var e=1&t.tag;return t.tag>>>=1,e}function s(t,e,n){if(!e)return n;for(;t.bitcount<24;)t.tag|=t.source[t.sourceIndex++]<<t.bitcount,t.bitcount+=8;var i=t.tag&65535>>>16-e;return t.tag>>>=e,t.bitcount-=e,i+n}function a(t,e){for(;t.bitcount<24;)t.tag|=t.source[t.sourceIndex++]<<t.bitcount,t.bitcount+=8;var n=0,i=0,r=0,o=t.tag;do i=2*i+(1&o),o>>>=1,++r,n+=e.table[r],i-=e.table[r];while(i>=0)return t.tag=o,t.bitcount-=r,e.trans[n+i]}function u(t,e,n){var i,o,u,l,c,h;for(i=s(t,5,257),o=s(t,5,1),u=s(t,4,4),l=0;l<19;++l)no[l]=0;for(l=0;l<u;++l){var d=s(t,3,0);no[to[l]]=d}for(r(eo,no,0,19),c=0;c<i+o;){var p=a(t,eo);switch(p){case 16:var f=no[c-1];for(h=s(t,2,3);h;--h)no[c++]=f;break;case 17:for(h=s(t,3,3);h;--h)no[c++]=0;break;case 18:for(h=s(t,7,11);h;--h)no[c++]=0;break;default:no[c++]=p}}r(e,no,0,i),r(n,no,i,o)}function l(t,e,n){for(;;){var i=a(t,e);if(256===i)return qr;if(i<256)t.dest[t.destLen++]=i;else{var r,o,u,l;for(i-=257,r=s(t,Zr[i],Qr[i]),o=a(t,n),u=t.destLen-s(t,Kr[o],Jr[o]),l=u;l<u+r;++l)t.dest[t.destLen++]=t.dest[l]}}}function c(t){for(var e,n,i;t.bitcount>8;)t.sourceIndex--,t.bitcount-=8;if(e=t.source[t.sourceIndex+1],e=256*e+t.source[t.sourceIndex],n=t.source[t.sourceIndex+3],n=256*n+t.source[t.sourceIndex+2],e!==(65535&~n))return Wr;for(t.sourceIndex+=4,i=e;i;--i)t.dest[t.destLen++]=t.source[t.sourceIndex++];return t.bitcount=0,qr}function h(t,e){var i,r,a=new n(t,e);do{switch(i=o(a),s(a,2,0)){case 0:r=c(a);break;case 1:r=l(a,Yr,$r);break;case 2:u(a,a.ltree,a.dtree),r=l(a,a.ltree,a.dtree);break;default:r=Wr}if(r!==qr)throw new Error("Data error")}while(!i)return a.destLen<a.dest.length?"function"==typeof a.dest.slice?a.dest.slice(0,a.destLen):a.dest.subarray(0,a.destLen):a.dest}function d(t,e,n,i,r){return Math.pow(1-r,3)*t+3*Math.pow(1-r,2)*r*e+3*(1-r)*Math.pow(r,2)*n+Math.pow(r,3)*i}function p(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}function f(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}function g(t){throw new Error(t)}function m(t,e){t||g(e)}function x(t){return function(){return t}}function v(t){return t>=-128&&t<=127}function _(t,e,n){for(var i=0,r=t.length;e<r&&i<64&&0===t[e];)++e,++i;return n.push(128|i-1),e}function y(t,e,n){for(var i=0,r=t.length,o=e;o<r&&i<64;){var s=t[o];if(!v(s))break;if(0===s&&o+1<r&&0===t[o+1])break;++o,++i}n.push(i-1);for(var a=e;a<o;++a)n.push(t[a]+256&255);return o}function w(t,e,n){for(var i=0,r=t.length,o=e;o<r&&i<64;){var s=t[o];if(0===s)break;if(v(s)&&o+1<r&&v(t[o+1]))break;++o,++i}n.push(64|i-1);for(var a=e;a<o;++a){var u=t[a];n.push(u+65536>>8&255,u+256&255)}return o}function b(t,e,n){for(var i=this,r=0;r<e.length;r+=1){var o=e[r];i[o.name]=o.value}if(this.tableName=t,this.fields=e,n)for(var s=Object.keys(n),a=0;a<s.length;a+=1){var u=s[a],l=n[u];void 0!==i[u]&&(i[u]=l)}}function S(t,e,n){void 0===n&&(n=e.length);var i=new Array(e.length+1);i[0]={name:t+"Count",type:"USHORT",value:n};for(var r=0;r<e.length;r++)i[r+1]={name:t+r,type:"USHORT",value:e[r]};return i}function C(t,e,n){var i=e.length,r=new Array(i+1);r[0]={name:t+"Count",type:"USHORT",value:i};for(var o=0;o<i;o++)r[o+1]={name:t+o,type:"TABLE",value:n(e[o],o)};return r}function T(t,e,n){var i=e.length,r=[];r[0]={name:t+"Count",type:"USHORT",value:i};for(var o=0;o<i;o++)r=r.concat(n(e[o],o));return r}function F(t){1===t.format?b.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(S("glyph",t.glyphs))):oo.assert(!1,"Can't create coverage table format 2 yet.")}function O(t){b.call(this,"scriptListTable",T("scriptRecord",t,function(t,e){var n=t.script,i=n.defaultLangSys;return oo.assert(!!i,"Unable to write GSUB: script "+t.tag+" has no default language system."),[{name:"scriptTag"+e,type:"TAG",value:t.tag},{name:"script"+e,type:"TABLE",value:new b("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new b("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:i.reqFeatureIndex}].concat(S("featureIndex",i.featureIndexes)))}].concat(T("langSys",n.langSysRecords,function(t,e){var n=t.langSys;return[{name:"langSysTag"+e,type:"TAG",value:t.tag},{name:"langSys"+e,type:"TABLE",value:new b("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:n.reqFeatureIndex}].concat(S("featureIndex",n.featureIndexes)))}]})))}]}))}function N(t){b.call(this,"featureListTable",T("featureRecord",t,function(t,e){var n=t.feature;return[{name:"featureTag"+e,type:"TAG",value:t.tag},{name:"feature"+e,type:"TABLE",value:new b("featureTable",[{name:"featureParams",type:"USHORT",value:n.featureParams}].concat(S("lookupListIndex",n.lookupListIndexes)))}]}))}function E(t,e){b.call(this,"lookupListTable",C("lookup",t,function(t){var n=e[t.lookupType];return oo.assert(!!n,"Unable to write GSUB lookup type "+t.lookupType+" tables."),new b("lookupTable",[{name:"lookupType",type:"USHORT",value:t.lookupType},{name:"lookupFlag",type:"USHORT",value:t.lookupFlag}].concat(C("subtable",t.subtables,n)))}))}function M(t,e){return t.getUint8(e)}function D(t,e){return t.getUint16(e,!1)}function V(t,e){return t.getInt16(e,!1)}function I(t,e){return t.getUint32(e,!1)}function B(t,e){return t.getInt16(e,!1)+t.getUint16(e+2,!1)/65535}function L(t,e){for(var n="",i=e;i<e+4;i+=1)n+=String.fromCharCode(t.getInt8(i));return n}function A(t,e,n){for(var i=0,r=0;r<n;r+=1)i<<=8,i+=t.getUint8(e+r);return i}function P(t,e,n){for(var i=[],r=e;r<n;r+=1)i.push(t.getUint8(r));return i}function R(t){for(var e="",n=0;n<t.length;n+=1)e+=String.fromCharCode(t[n]);return e}function k(t,e){this.data=t,this.offset=e,this.relativeOffset=0}function U(t,e){e.parseUShort(),t.length=e.parseULong(),t.language=e.parseULong();var n;t.groupCount=n=e.parseULong(),t.glyphIndexMap={};for(var i=0;i<n;i+=1)for(var r=e.parseULong(),o=e.parseULong(),s=e.parseULong(),a=r;a<=o;a+=1)t.glyphIndexMap[a]=s,s++}function z(t,e,n,i,r){t.length=e.parseUShort(),t.language=e.parseUShort();var o;t.segCount=o=e.parseUShort()>>1,e.skip("uShort",3),t.glyphIndexMap={};for(var s=new vo.Parser(n,i+r+14),a=new vo.Parser(n,i+r+16+2*o),u=new vo.Parser(n,i+r+16+4*o),l=new vo.Parser(n,i+r+16+6*o),c=i+r+16+8*o,h=0;h<o-1;h+=1)for(var d=void 0,p=s.parseUShort(),f=a.parseUShort(),g=u.parseShort(),m=l.parseUShort(),x=f;x<=p;x+=1)0!==m?(c=l.offset+l.relativeOffset-2,c+=m,c+=2*(x-f),0!==(d=vo.getUShort(n,c))&&(d=d+g&65535)):d=x+g&65535,t.glyphIndexMap[x]=d}function X(t,e){var n={};n.version=vo.getUShort(t,e),oo.argument(0===n.version,"cmap table version should be 0."),n.numTables=vo.getUShort(t,e+2);for(var i=-1,r=n.numTables-1;r>=0;r-=1){var o=vo.getUShort(t,e+4+8*r),s=vo.getUShort(t,e+4+8*r+2);if(3===o&&(0===s||1===s||10===s)||0===o&&(0===s||1===s||2===s||3===s||4===s)){i=vo.getULong(t,e+4+8*r+4);break}}if(i===-1)throw new Error("No valid cmap sub-tables found.");var a=new vo.Parser(t,e+i);if(n.format=a.parseUShort(),12===n.format)U(n,a);else{if(4!==n.format)throw new Error("Only format 4 and 12 cmap tables are supported (found format "+n.format+").");z(n,a,t,e,i)}return n}function j(t,e,n){t.segments.push({end:e,start:e,delta:-(e-n),offset:0,glyphIndex:n})}function G(t){t.segments.push({end:65535,start:65535,delta:1,offset:0})}function H(t){var e,n=!0;for(e=t.length-1;e>0;e-=1){if(t.get(e).unicode>65535){console.log("Adding CMAP format 12 (needed!)"),n=!1;break}}var i=[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:n?1:2},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:n?12:20}];n||(i=i.concat([{name:"cmap12PlatformID",type:"USHORT",value:3},{name:"cmap12EncodingID",type:"USHORT",value:10},{name:"cmap12Offset",type:"ULONG",value:0}])),i=i.concat([{name:"format",type:"USHORT",value:4},{name:"cmap4Length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);var r=new go.Table("cmap",i);for(r.segments=[],e=0;e<t.length;e+=1){for(var o=t.get(e),s=0;s<o.unicodes.length;s+=1)j(r,o.unicodes[s],e);r.segments=r.segments.sort(function(t,e){return t.start-e.start})}G(r);var a=r.segments.length,u=0,l=[],c=[],h=[],d=[],p=[],f=[];for(e=0;e<a;e+=1){var g=r.segments[e];g.end<=65535&&g.start<=65535?(l=l.concat({name:"end_"+e,type:"USHORT",value:g.end}),
c=c.concat({name:"start_"+e,type:"USHORT",value:g.start}),h=h.concat({name:"idDelta_"+e,type:"SHORT",value:g.delta}),d=d.concat({name:"idRangeOffset_"+e,type:"USHORT",value:g.offset}),void 0!==g.glyphId&&(p=p.concat({name:"glyph_"+e,type:"USHORT",value:g.glyphId}))):u+=1,n||void 0===g.glyphIndex||(f=f.concat({name:"cmap12Start_"+e,type:"ULONG",value:g.start}),f=f.concat({name:"cmap12End_"+e,type:"ULONG",value:g.end}),f=f.concat({name:"cmap12Glyph_"+e,type:"ULONG",value:g.glyphIndex}))}if(r.segCountX2=2*(a-u),r.searchRange=2*Math.pow(2,Math.floor(Math.log(a-u)/Math.log(2))),r.entrySelector=Math.log(r.searchRange/2)/Math.log(2),r.rangeShift=r.segCountX2-r.searchRange,r.fields=r.fields.concat(l),r.fields.push({name:"reservedPad",type:"USHORT",value:0}),r.fields=r.fields.concat(c),r.fields=r.fields.concat(h),r.fields=r.fields.concat(d),r.fields=r.fields.concat(p),r.cmap4Length=14+2*l.length+2+2*c.length+2*h.length+2*d.length+2*p.length,!n){var m=16+4*f.length;r.cmap12Offset=20+r.cmap4Length,r.fields=r.fields.concat([{name:"cmap12Format",type:"USHORT",value:12},{name:"cmap12Reserved",type:"USHORT",value:0},{name:"cmap12Length",type:"ULONG",value:m},{name:"cmap12Language",type:"ULONG",value:0},{name:"cmap12nGroups",type:"ULONG",value:f.length/3}]),r.fields=r.fields.concat(f)}return r}function q(t){this.font=t}function W(t){this.cmap=t}function Y(t,e){this.encoding=t,this.charset=e}function $(t){var e=this;switch(t.version){case 1:this.names=So.slice();break;case 2:this.names=new Array(t.numberOfGlyphs);for(var n=0;n<t.numberOfGlyphs;n++)t.glyphNameIndex[n]<So.length?e.names[n]=So[t.glyphNameIndex[n]]:e.names[n]=t.names[t.glyphNameIndex[n]-So.length];break;case 2.5:this.names=new Array(t.numberOfGlyphs);for(var i=0;i<t.numberOfGlyphs;i++)e.names[i]=So[i+t.glyphNameIndex[i]];break;case 3:this.names=[];break;default:this.names=[]}}function Z(t){for(var e,n=t.tables.cmap.glyphIndexMap,i=Object.keys(n),r=0;r<i.length;r+=1){var o=i[r],s=n[o];e=t.glyphs.get(s),e.addUnicode(parseInt(o))}for(var a=0;a<t.glyphs.length;a+=1)e=t.glyphs.get(a),t.cffEncoding?t.isCIDFont?e.name="gid"+a:e.name=t.cffEncoding.charset[a]:t.glyphNames.names&&(e.name=t.glyphNames.glyphIndexToName(a))}function Q(t,e,n,i,r){t.beginPath(),t.moveTo(e,n),t.lineTo(i,r),t.stroke()}function K(t,e){var n=e||new f;return{configurable:!0,get:function(){return"function"==typeof n&&(n=n()),n},set:function(t){n=t}}}function J(t){this.bindConstructorValues(t)}function tt(t,e,n){Object.defineProperty(t,e,{get:function(){return t.path,t[n]},set:function(e){t[n]=e},enumerable:!0,configurable:!0})}function et(t,e){var n=this;if(this.font=t,this.glyphs={},Array.isArray(e))for(var i=0;i<e.length;i++)n.glyphs[i]=e[i];this.length=e&&e.length||0}function nt(t,e){return new J({index:e,font:t})}function it(t,e,n,i,r,o){return function(){var s=new J({index:e,font:t});return s.path=function(){n(s,i,r);var e=o(t.glyphs,s);return e.unitsPerEm=t.unitsPerEm,e},tt(s,"xMin","_xMin"),tt(s,"xMax","_xMax"),tt(s,"yMin","_yMin"),tt(s,"yMax","_yMax"),s}}function rt(t,e,n,i){return function(){var r=new J({index:e,font:t});return r.path=function(){var e=n(t,r,i);return e.unitsPerEm=t.unitsPerEm,e},r}}function ot(t,e){if(t===e)return!0;if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n+=1)if(!ot(t[n],e[n]))return!1;return!0}return!1}function st(t){return t.length<1240?107:t.length<33900?1131:32768}function at(t,e,n){var i,r,o=[],s=[],a=vo.getCard16(t,e);if(0!==a){var u=vo.getByte(t,e+2);i=e+(a+1)*u+2;for(var l=e+3,c=0;c<a+1;c+=1)o.push(vo.getOffset(t,l,u)),l+=u;r=i+o[a]}else r=e+2;for(var h=0;h<o.length-1;h+=1){var d=vo.getBytes(t,i+o[h],i+o[h+1]);n&&(d=n(d)),s.push(d)}return{objects:s,startOffset:e,endOffset:r}}function ut(t){for(var e="",n=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var i=t.parseByte(),r=i>>4,o=15&i;if(15===r)break;if(e+=n[r],15===o)break;e+=n[o]}return parseFloat(e)}function lt(t,e){var n,i,r,o;if(28===e)return n=t.parseByte(),i=t.parseByte(),n<<8|i;if(29===e)return n=t.parseByte(),i=t.parseByte(),r=t.parseByte(),o=t.parseByte(),n<<24|i<<16|r<<8|o;if(30===e)return ut(t);if(e>=32&&e<=246)return e-139;if(e>=247&&e<=250)return n=t.parseByte(),256*(e-247)+n+108;if(e>=251&&e<=254)return n=t.parseByte(),256*-(e-251)-n-108;throw new Error("Invalid b0 "+e)}function ct(t){for(var e={},n=0;n<t.length;n+=1){var i=t[n][0],r=t[n][1],o=void 0;if(o=1===r.length?r[0]:r,e.hasOwnProperty(i)&&!isNaN(e[i]))throw new Error("Object "+e+" already has key "+i);e[i]=o}return e}function ht(t,e,n){e=void 0!==e?e:0;var i=new vo.Parser(t,e),r=[],o=[];for(n=void 0!==n?n:t.length;i.relativeOffset<n;){var s=i.parseByte();s<=21?(12===s&&(s=1200+i.parseByte()),r.push([s,o]),o=[]):o.push(lt(i,s))}return ct(r)}function dt(t,e){return e=e<=390?yo[e]:t[e-391]}function pt(t,e,n){for(var i,r={},o=0;o<e.length;o+=1){var s=e[o];if(Array.isArray(s.type)){var a=[];a.length=s.type.length;for(var u=0;u<s.type.length;u++)i=void 0!==t[s.op]?t[s.op][u]:void 0,void 0===i&&(i=void 0!==s.value&&void 0!==s.value[u]?s.value[u]:null),"SID"===s.type[u]&&(i=dt(n,i)),a[u]=i;r[s.name]=a}else i=t[s.op],void 0===i&&(i=void 0!==s.value?s.value:null),"SID"===s.type&&(i=dt(n,i)),r[s.name]=i}return r}function ft(t,e){var n={};return n.formatMajor=vo.getCard8(t,e),n.formatMinor=vo.getCard8(t,e+1),n.size=vo.getCard8(t,e+2),n.offsetSize=vo.getCard8(t,e+3),n.startOffset=e,n.endOffset=e+4,n}function gt(t,e){return pt(ht(t,0,t.byteLength),Fo,e)}function mt(t,e,n,i){return pt(ht(t,e,n),Oo,i)}function xt(t,e,n,i){for(var r=[],o=0;o<n.length;o+=1){var s=new DataView(new Uint8Array(n[o]).buffer),a=gt(s,i);a._subrs=[],a._subrsBias=0;var u=a.private[0],l=a.private[1];if(0!==u&&0!==l){var c=mt(t,l+e,u,i);if(a._defaultWidthX=c.defaultWidthX,a._nominalWidthX=c.nominalWidthX,0!==c.subrs){var h=l+c.subrs,d=at(t,h+e);a._subrs=d.objects,a._subrsBias=st(a._subrs)}a._privateDict=c}r.push(a)}return r}function vt(t,e,n,i){var r,o,s=new vo.Parser(t,e);n-=1;var a=[".notdef"],u=s.parseCard8();if(0===u)for(var l=0;l<n;l+=1)r=s.parseSID(),a.push(dt(i,r));else if(1===u)for(;a.length<=n;){r=s.parseSID(),o=s.parseCard8();for(var c=0;c<=o;c+=1)a.push(dt(i,r)),r+=1}else{if(2!==u)throw new Error("Unknown charset format "+u);for(;a.length<=n;){r=s.parseSID(),o=s.parseCard16();for(var h=0;h<=o;h+=1)a.push(dt(i,r)),r+=1}}return a}function _t(t,e,n){var i,r={},o=new vo.Parser(t,e),s=o.parseCard8();if(0===s)for(var a=o.parseCard8(),u=0;u<a;u+=1)i=o.parseCard8(),r[i]=u;else{if(1!==s)throw new Error("Unknown encoding format "+s);var l=o.parseCard8();i=1;for(var c=0;c<l;c+=1)for(var h=o.parseCard8(),d=o.parseCard8(),p=h;p<=h+d;p+=1)r[p]=i,i+=1}return new Y(r,n)}function yt(t,e,n){function i(t,e){_&&g.closePath(),g.moveTo(t,e),_=!0}function r(){var t;t=m.length%2!=0,t&&!v&&(C=m.shift()+p),x+=m.length>>1,m.length=0,v=!0}function o(n){for(var d,f,b,S,T,F,O,N,E,M,D,V,I=0;I<n.length;){var B=n[I];switch(I+=1,B){case 1:r();break;case 3:r();break;case 4:m.length>1&&!v&&(C=m.shift()+p,v=!0),w+=m.pop(),i(y,w);break;case 5:for(;m.length>0;)y+=m.shift(),w+=m.shift(),g.lineTo(y,w);break;case 6:for(;m.length>0&&(y+=m.shift(),g.lineTo(y,w),0!==m.length);)w+=m.shift(),g.lineTo(y,w);break;case 7:for(;m.length>0&&(w+=m.shift(),g.lineTo(y,w),0!==m.length);)y+=m.shift(),g.lineTo(y,w);break;case 8:for(;m.length>0;)s=y+m.shift(),a=w+m.shift(),u=s+m.shift(),l=a+m.shift(),y=u+m.shift(),w=l+m.shift(),g.curveTo(s,a,u,l,y,w);break;case 10:T=m.pop()+h,F=c[T],F&&o(F);break;case 11:return;case 12:switch(B=n[I],I+=1,B){case 35:s=y+m.shift(),a=w+m.shift(),u=s+m.shift(),l=a+m.shift(),O=u+m.shift(),N=l+m.shift(),E=O+m.shift(),M=N+m.shift(),D=E+m.shift(),V=M+m.shift(),y=D+m.shift(),w=V+m.shift(),m.shift(),g.curveTo(s,a,u,l,O,N),g.curveTo(E,M,D,V,y,w);break;case 34:s=y+m.shift(),a=w,u=s+m.shift(),l=a+m.shift(),O=u+m.shift(),N=l,E=O+m.shift(),M=l,D=E+m.shift(),V=w,y=D+m.shift(),g.curveTo(s,a,u,l,O,N),g.curveTo(E,M,D,V,y,w);break;case 36:s=y+m.shift(),a=w+m.shift(),u=s+m.shift(),l=a+m.shift(),O=u+m.shift(),N=l,E=O+m.shift(),M=l,D=E+m.shift(),V=M+m.shift(),y=D+m.shift(),g.curveTo(s,a,u,l,O,N),g.curveTo(E,M,D,V,y,w);break;case 37:s=y+m.shift(),a=w+m.shift(),u=s+m.shift(),l=a+m.shift(),O=u+m.shift(),N=l+m.shift(),E=O+m.shift(),M=N+m.shift(),D=E+m.shift(),V=M+m.shift(),Math.abs(D-y)>Math.abs(V-w)?y=D+m.shift():w=V+m.shift(),g.curveTo(s,a,u,l,O,N),g.curveTo(E,M,D,V,y,w);break;default:console.log("Glyph "+e.index+": unknown operator 1200"+B),m.length=0}break;case 14:m.length>0&&!v&&(C=m.shift()+p,v=!0),_&&(g.closePath(),_=!1);break;case 18:r();break;case 19:case 20:r(),I+=x+7>>3;break;case 21:m.length>2&&!v&&(C=m.shift()+p,v=!0),w+=m.pop(),y+=m.pop(),i(y,w);break;case 22:m.length>1&&!v&&(C=m.shift()+p,v=!0),y+=m.pop(),i(y,w);break;case 23:r();break;case 24:for(;m.length>2;)s=y+m.shift(),a=w+m.shift(),u=s+m.shift(),l=a+m.shift(),y=u+m.shift(),w=l+m.shift(),g.curveTo(s,a,u,l,y,w);y+=m.shift(),w+=m.shift(),g.lineTo(y,w);break;case 25:for(;m.length>6;)y+=m.shift(),w+=m.shift(),g.lineTo(y,w);s=y+m.shift(),a=w+m.shift(),u=s+m.shift(),l=a+m.shift(),y=u+m.shift(),w=l+m.shift(),g.curveTo(s,a,u,l,y,w);break;case 26:for(m.length%2&&(y+=m.shift());m.length>0;)s=y,a=w+m.shift(),u=s+m.shift(),l=a+m.shift(),y=u,w=l+m.shift(),g.curveTo(s,a,u,l,y,w);break;case 27:for(m.length%2&&(w+=m.shift());m.length>0;)s=y+m.shift(),a=w,u=s+m.shift(),l=a+m.shift(),y=u+m.shift(),w=l,g.curveTo(s,a,u,l,y,w);break;case 28:d=n[I],f=n[I+1],m.push((d<<24|f<<16)>>16),I+=2;break;case 29:T=m.pop()+t.gsubrsBias,F=t.gsubrs[T],F&&o(F);break;case 30:for(;m.length>0&&(s=y,a=w+m.shift(),u=s+m.shift(),l=a+m.shift(),y=u+m.shift(),w=l+(1===m.length?m.shift():0),g.curveTo(s,a,u,l,y,w),0!==m.length);)s=y+m.shift(),a=w,u=s+m.shift(),l=a+m.shift(),w=l+m.shift(),y=u+(1===m.length?m.shift():0),g.curveTo(s,a,u,l,y,w);break;case 31:for(;m.length>0&&(s=y+m.shift(),a=w,u=s+m.shift(),l=a+m.shift(),w=l+m.shift(),y=u+(1===m.length?m.shift():0),g.curveTo(s,a,u,l,y,w),0!==m.length);)s=y,a=w+m.shift(),u=s+m.shift(),l=a+m.shift(),y=u+m.shift(),w=l+(1===m.length?m.shift():0),g.curveTo(s,a,u,l,y,w);break;default:B<32?console.log("Glyph "+e.index+": unknown operator "+B):B<247?m.push(B-139):B<251?(d=n[I],I+=1,m.push(256*(B-247)+d+108)):B<255?(d=n[I],I+=1,m.push(256*-(B-251)-d-108)):(d=n[I],f=n[I+1],b=n[I+2],S=n[I+3],I+=4,m.push((d<<24|f<<16|b<<8|S)/65536))}}}var s,a,u,l,c,h,d,p,g=new f,m=[],x=0,v=!1,_=!1,y=0,w=0;if(t.isCIDFont){var b=t.tables.cff.topDict._fdSelect[e.index],S=t.tables.cff.topDict._fdArray[b];c=S._subrs,h=S._subrsBias,d=S._defaultWidthX,p=S._nominalWidthX}else c=t.tables.cff.topDict._subrs,h=t.tables.cff.topDict._subrsBias,d=t.tables.cff.topDict._defaultWidthX,p=t.tables.cff.topDict._nominalWidthX;var C=d;return o(n),e.advanceWidth=C,g}function wt(t,e,n,i){var r,o=[],s=new vo.Parser(t,e),a=s.parseCard8();if(0===a)for(var u=0;u<n;u++){if((r=s.parseCard8())>=i)throw new Error("CFF table CID Font FDSelect has bad FD index value "+r+" (FD count "+i+")");o.push(r)}else{if(3!==a)throw new Error("CFF Table CID Font FDSelect table has unsupported format "+a);var l=s.parseCard16(),c=s.parseCard16();if(0!==c)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+c);for(var h,d=0;d<l;d++){if(r=s.parseCard8(),h=s.parseCard16(),r>=i)throw new Error("CFF table CID Font FDSelect has bad FD index value "+r+" (FD count "+i+")");if(h>n)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+h);for(;c<h;c++)o.push(r);c=h}if(h!==n)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+h)}return o}function bt(t,e,n){n.tables.cff={};var i=ft(t,e),r=at(t,i.endOffset,vo.bytesToString),o=at(t,r.endOffset),s=at(t,o.endOffset,vo.bytesToString),a=at(t,s.endOffset);n.gsubrs=a.objects,n.gsubrsBias=st(n.gsubrs);var u=xt(t,e,o.objects,s.objects);if(1!==u.length)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+u.length);var l=u[0];if(n.tables.cff.topDict=l,l._privateDict&&(n.defaultWidthX=l._privateDict.defaultWidthX,n.nominalWidthX=l._privateDict.nominalWidthX),void 0!==l.ros[0]&&void 0!==l.ros[1]&&(n.isCIDFont=!0),n.isCIDFont){var c=l.fdArray,h=l.fdSelect;if(0===c||0===h)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");c+=e;var d=at(t,c),p=xt(t,e,d.objects,s.objects);l._fdArray=p,h+=e,l._fdSelect=wt(t,h,n.numGlyphs,p.length)}var f=e+l.private[1],g=mt(t,f,l.private[0],s.objects);if(n.defaultWidthX=g.defaultWidthX,n.nominalWidthX=g.nominalWidthX,0!==g.subrs){var m=f+g.subrs,x=at(t,m);n.subrs=x.objects,n.subrsBias=st(n.subrs)}else n.subrs=[],n.subrsBias=0;var v=at(t,e+l.charStrings);n.nGlyphs=v.objects.length;var _=vt(t,e+l.charset,n.nGlyphs,s.objects);0===l.encoding?n.cffEncoding=new Y(wo,_):1===l.encoding?n.cffEncoding=new Y(bo,_):n.cffEncoding=_t(t,e+l.encoding,_),n.encoding=n.encoding||n.cffEncoding,n.glyphs=new To.GlyphSet(n);for(var y=0;y<n.nGlyphs;y+=1){var w=v.objects[y];n.glyphs.push(y,To.cffGlyphLoader(n,y,yt,w))}}function St(t,e){var n,i=yo.indexOf(t);return i>=0&&(n=i),i=e.indexOf(t),i>=0?n=i+yo.length:(n=yo.length+e.length,e.push(t)),n}function Ct(){return new go.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}])}function Tt(t){var e=new go.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);e.names=[];for(var n=0;n<t.length;n+=1)e.names.push({name:"name_"+n,type:"NAME",value:t[n]});return e}function Ft(t,e,n){for(var i={},r=0;r<t.length;r+=1){var o=t[r],s=e[o.name];void 0===s||ot(s,o.value)||("SID"===o.type&&(s=St(s,n)),i[o.op]={name:o.name,type:o.type,value:s})}return i}function Ot(t,e){var n=new go.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return n.dict=Ft(Fo,t,e),n}function Nt(t){var e=new go.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return e.topDicts=[{name:"topDict_0",type:"TABLE",value:t}],e}function Et(t){var e=new go.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);e.strings=[];for(var n=0;n<t.length;n+=1)e.strings.push({name:"string_"+n,type:"STRING",value:t[n]});return e}function Mt(){return new go.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}])}function Dt(t,e){for(var n=new go.Record("Charsets",[{name:"format",type:"Card8",value:0}]),i=0;i<t.length;i+=1){var r=t[i],o=St(r,e);n.fields.push({name:"glyph_"+i,type:"SID",value:o})}return n}function Vt(t){var e=[],n=t.path;e.push({name:"width",type:"NUMBER",value:t.advanceWidth});for(var i=0,r=0,o=0;o<n.commands.length;o+=1){var s=void 0,a=void 0,u=n.commands[o];if("Q"===u.type){u={type:"C",x:u.x,y:u.y,x1:1/3*i+2/3*u.x1,y1:1/3*r+2/3*u.y1,x2:1/3*u.x+2/3*u.x1,y2:1/3*u.y+2/3*u.y1}}if("M"===u.type)s=Math.round(u.x-i),a=Math.round(u.y-r),e.push({name:"dx",type:"NUMBER",value:s}),e.push({name:"dy",type:"NUMBER",value:a}),e.push({name:"rmoveto",type:"OP",value:21}),i=Math.round(u.x),r=Math.round(u.y);else if("L"===u.type)s=Math.round(u.x-i),a=Math.round(u.y-r),e.push({name:"dx",type:"NUMBER",value:s}),e.push({name:"dy",type:"NUMBER",value:a}),e.push({name:"rlineto",type:"OP",value:5}),i=Math.round(u.x),r=Math.round(u.y);else if("C"===u.type){var l=Math.round(u.x1-i),c=Math.round(u.y1-r),h=Math.round(u.x2-u.x1),d=Math.round(u.y2-u.y1);s=Math.round(u.x-u.x2),a=Math.round(u.y-u.y2),e.push({name:"dx1",type:"NUMBER",value:l}),e.push({name:"dy1",type:"NUMBER",value:c}),e.push({name:"dx2",type:"NUMBER",value:h}),e.push({name:"dy2",type:"NUMBER",value:d}),e.push({name:"dx",type:"NUMBER",value:s}),e.push({name:"dy",type:"NUMBER",value:a}),e.push({name:"rrcurveto",type:"OP",value:8}),i=Math.round(u.x),r=Math.round(u.y)}}return e.push({name:"endchar",type:"OP",value:14}),e}function It(t){for(var e=new go.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),n=0;n<t.length;n+=1){var i=t.get(n),r=Vt(i);e.charStrings.push({name:i.name,type:"CHARSTRING",value:r})}return e}function Bt(t,e){var n=new go.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return n.dict=Ft(Oo,t,e),n}function Lt(t,e){for(var n,i=new go.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),r=1/e.unitsPerEm,o={version:e.version,fullName:e.fullName,familyName:e.familyName,weight:e.weightName,fontBBox:e.fontBBox||[0,0,0,0],fontMatrix:[r,0,0,r,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},s={},a=[],u=1;u<t.length;u+=1)n=t.get(u),a.push(n.name);var l=[];i.header=Ct(),i.nameIndex=Tt([e.postScriptName]);var c=Ot(o,l);i.topDictIndex=Nt(c),i.globalSubrIndex=Mt(),i.charsets=Dt(a,l),i.charStringsIndex=It(t),i.privateDict=Bt(s,l),i.stringIndex=Et(l);var h=i.header.sizeOf()+i.nameIndex.sizeOf()+i.topDictIndex.sizeOf()+i.stringIndex.sizeOf()+i.globalSubrIndex.sizeOf();return o.charset=h,o.encoding=0,o.charStrings=o.charset+i.charsets.sizeOf(),o.private[1]=o.charStrings+i.charStringsIndex.sizeOf(),c=Ot(o,l),i.topDictIndex=Nt(c),i}function At(t,e){var n={},i=new vo.Parser(t,e);return n.version=i.parseVersion(),n.fontRevision=Math.round(1e3*i.parseFixed())/1e3,n.checkSumAdjustment=i.parseULong(),n.magicNumber=i.parseULong(),oo.argument(1594834165===n.magicNumber,"Font header has wrong magic number."),n.flags=i.parseUShort(),n.unitsPerEm=i.parseUShort(),n.created=i.parseLongDateTime(),n.modified=i.parseLongDateTime(),n.xMin=i.parseShort(),n.yMin=i.parseShort(),n.xMax=i.parseShort(),n.yMax=i.parseShort(),n.macStyle=i.parseUShort(),n.lowestRecPPEM=i.parseUShort(),n.fontDirectionHint=i.parseShort(),n.indexToLocFormat=i.parseShort(),n.glyphDataFormat=i.parseShort(),n}function Pt(t){var e=Math.round((new Date).getTime()/1e3)+2082844800,n=e;return t.createdTimestamp&&(n=t.createdTimestamp+2082844800),new go.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:n},{name:"modified",type:"LONGDATETIME",value:e},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],t)}function Rt(t,e){var n={},i=new vo.Parser(t,e);return n.version=i.parseVersion(),n.ascender=i.parseShort(),n.descender=i.parseShort(),n.lineGap=i.parseShort(),n.advanceWidthMax=i.parseUShort(),n.minLeftSideBearing=i.parseShort(),n.minRightSideBearing=i.parseShort(),n.xMaxExtent=i.parseShort(),n.caretSlopeRise=i.parseShort(),n.caretSlopeRun=i.parseShort(),n.caretOffset=i.parseShort(),i.relativeOffset+=8,n.metricDataFormat=i.parseShort(),n.numberOfHMetrics=i.parseUShort(),n}function kt(t){return new go.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],t)}function Ut(t,e,n,i,r){for(var o,s,a=new vo.Parser(t,e),u=0;u<i;u+=1){u<n&&(o=a.parseUShort(),s=a.parseShort());var l=r.get(u);l.advanceWidth=o,l.leftSideBearing=s}}function zt(t){for(var e=new go.Table("hmtx",[]),n=0;n<t.length;n+=1){var i=t.get(n),r=i.advanceWidth||0,o=i.leftSideBearing||0;e.fields.push({name:"advanceWidth_"+n,type:"USHORT",value:r}),e.fields.push({name:"leftSideBearing_"+n,type:"SHORT",value:o})}return e}function Xt(t){for(var e=new go.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:t.length}]),n="",i=12+4*t.length,r=0;r<t.length;++r){var o=n.indexOf(t[r]);o<0&&(o=n.length,n+=t[r]),e.fields.push({name:"offset "+r,type:"USHORT",value:i+o}),e.fields.push({name:"length "+r,type:"USHORT",value:t[r].length})}return e.fields.push({name:"stringPool",type:"CHARARRAY",value:n}),e}function jt(t,e){var n=new vo.Parser(t,e),i=n.parseULong();oo.argument(1===i,"Unsupported ltag table version."),n.skip("uLong",1);for(var r=n.parseULong(),o=[],s=0;s<r;s++){for(var a="",u=e+n.parseUShort(),l=n.parseUShort(),c=u;c<u+l;++c)a+=String.fromCharCode(t.getInt8(c));o.push(a)}return o}function Gt(t,e){var n={},i=new vo.Parser(t,e);return n.version=i.parseVersion(),n.numGlyphs=i.parseUShort(),1===n.version&&(n.maxPoints=i.parseUShort(),n.maxContours=i.parseUShort(),n.maxCompositePoints=i.parseUShort(),n.maxCompositeContours=i.parseUShort(),n.maxZones=i.parseUShort(),n.maxTwilightPoints=i.parseUShort(),n.maxStorage=i.parseUShort(),n.maxFunctionDefs=i.parseUShort(),n.maxInstructionDefs=i.parseUShort(),n.maxStackElements=i.parseUShort(),n.maxSizeOfInstructions=i.parseUShort(),n.maxComponentElements=i.parseUShort(),n.maxComponentDepth=i.parseUShort()),n}function Ht(t){return new go.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:t}])}function qt(t,e,n){switch(t){case 0:if(65535===e)return"und";if(n)return n[e];break;case 1:return Lo[e];case 3:return Po[e]}}function Wt(t,e,n){switch(t){case 0:return Ro;case 1:return Uo[n]||ko[e];case 3:if(1===e||10===e)return Ro}}function Yt(t,e,n){for(var i={},r=new vo.Parser(t,e),o=r.parseUShort(),s=r.parseUShort(),a=r.offset+r.parseUShort(),u=0;u<s;u++){var l=r.parseUShort(),c=r.parseUShort(),h=r.parseUShort(),d=r.parseUShort(),p=Bo[d]||d,f=r.parseUShort(),g=r.parseUShort(),m=qt(l,h,n),x=Wt(l,c,h);if(void 0!==x&&void 0!==m){var v=void 0;if(v=x===Ro?so.UTF16(t,a+g,f):so.MACSTRING(t,a+g,f,x)){var _=i[p];void 0===_&&(_=i[p]={}),_[m]=v}}}return 1===o&&r.parseUShort(),i}function $t(t){var e={};for(var n in t)e[t[n]]=parseInt(n);return e}function Zt(t,e,n,i,r,o){return new go.Record("NameRecord",[{name:"platformID",type:"USHORT",value:t},{name:"encodingID",type:"USHORT",value:e},{name:"languageID",type:"USHORT",value:n},{name:"nameID",type:"USHORT",value:i},{name:"length",type:"USHORT",value:r},{name:"offset",type:"USHORT",value:o}])}function Qt(t,e){var n=t.length,i=e.length-n+1;t:for(var r=0;r<i;r++)for(;r<i;r++){for(var o=0;o<n;o++)if(e[r+o]!==t[o])continue t;return r}return-1}function Kt(t,e){var n=Qt(t,e);if(n<0){n=e.length;for(var i=0,r=t.length;i<r;++i)e.push(t[i])}return n}function Jt(t,e){var n,i=[],r={},o=$t(Bo);for(var s in t){var a=o[s];if(void 0===a&&(a=s),n=parseInt(a),isNaN(n))throw new Error('Name table entry "'+s+'" does not exist, see nameTableNames for complete list.');r[n]=t[s],i.push(n)}for(var u=$t(Lo),l=$t(Po),c=[],h=[],d=0;d<i.length;d++){n=i[d];var p=r[n];for(var f in p){var g=p[f],m=1,x=u[f],v=Ao[x],_=Wt(m,v,x),y=ao.MACSTRING(g,_);void 0===y&&(m=0,x=e.indexOf(f),x<0&&(x=e.length,e.push(f)),v=4,y=ao.UTF16(g));var w=Kt(y,h);c.push(Zt(m,v,x,n,y.length,w));var b=l[f];if(void 0!==b){var S=ao.UTF16(g),C=Kt(S,h);c.push(Zt(3,1,b,n,S.length,C))}}}c.sort(function(t,e){return t.platformID-e.platformID||t.encodingID-e.encodingID||t.languageID-e.languageID||t.nameID-e.nameID});for(var T=new go.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:c.length},{name:"stringOffset",type:"USHORT",value:6+12*c.length}]),F=0;F<c.length;F++)T.fields.push({name:"record_"+F,type:"RECORD",value:c[F]});return T.fields.push({name:"strings",type:"LITERAL",value:h}),T}function te(t){for(var e=0;e<Xo.length;e+=1){var n=Xo[e];if(t>=n.begin&&t<n.end)return e}return-1}function ee(t,e){var n={},i=new vo.Parser(t,e);n.version=i.parseUShort(),n.xAvgCharWidth=i.parseShort(),n.usWeightClass=i.parseUShort(),n.usWidthClass=i.parseUShort(),n.fsType=i.parseUShort(),n.ySubscriptXSize=i.parseShort(),n.ySubscriptYSize=i.parseShort(),n.ySubscriptXOffset=i.parseShort(),n.ySubscriptYOffset=i.parseShort(),n.ySuperscriptXSize=i.parseShort(),n.ySuperscriptYSize=i.parseShort(),n.ySuperscriptXOffset=i.parseShort(),n.ySuperscriptYOffset=i.parseShort(),n.yStrikeoutSize=i.parseShort(),n.yStrikeoutPosition=i.parseShort(),n.sFamilyClass=i.parseShort(),n.panose=[];for(var r=0;r<10;r++)n.panose[r]=i.parseByte();return n.ulUnicodeRange1=i.parseULong(),n.ulUnicodeRange2=i.parseULong(),n.ulUnicodeRange3=i.parseULong(),n.ulUnicodeRange4=i.parseULong(),n.achVendID=String.fromCharCode(i.parseByte(),i.parseByte(),i.parseByte(),i.parseByte()),n.fsSelection=i.parseUShort(),n.usFirstCharIndex=i.parseUShort(),n.usLastCharIndex=i.parseUShort(),n.sTypoAscender=i.parseShort(),n.sTypoDescender=i.parseShort(),n.sTypoLineGap=i.parseShort(),n.usWinAscent=i.parseUShort(),n.usWinDescent=i.parseUShort(),n.version>=1&&(n.ulCodePageRange1=i.parseULong(),n.ulCodePageRange2=i.parseULong()),n.version>=2&&(n.sxHeight=i.parseShort(),n.sCapHeight=i.parseShort(),n.usDefaultChar=i.parseUShort(),n.usBreakChar=i.parseUShort(),n.usMaxContent=i.parseUShort()),n}function ne(t){return new go.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],t)}function ie(t,e){var n={},i=new vo.Parser(t,e);switch(n.version=i.parseVersion(),n.italicAngle=i.parseFixed(),n.underlinePosition=i.parseShort(),n.underlineThickness=i.parseShort(),n.isFixedPitch=i.parseULong(),n.minMemType42=i.parseULong(),n.maxMemType42=i.parseULong(),n.minMemType1=i.parseULong(),n.maxMemType1=i.parseULong(),n.version){case 1:n.names=So.slice();break;case 2:n.numberOfGlyphs=i.parseUShort(),n.glyphNameIndex=new Array(n.numberOfGlyphs);for(var r=0;r<n.numberOfGlyphs;r++)n.glyphNameIndex[r]=i.parseUShort();n.names=[];for(var o=0;o<n.numberOfGlyphs;o++)if(n.glyphNameIndex[o]>=So.length){var s=i.parseChar();n.names.push(i.parseString(s))}break;case 2.5:n.numberOfGlyphs=i.parseUShort(),n.offset=new Array(n.numberOfGlyphs);for(var a=0;a<n.numberOfGlyphs;a++)n.offset[a]=i.parseChar()}return n}function re(){return new go.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}function oe(t,e){e=e||0;var n=new k(t,e),i=n.parseVersion(1);return oo.argument(1===i||1.1===i,"Unsupported GSUB table version."),1===i?{version:i,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(Ho)}:{version:i,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(Ho),variations:n.parseFeatureVariationsList()}}function se(t){return new go.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new go.ScriptList(t.scripts)},{name:"features",type:"TABLE",value:new go.FeatureList(t.features)},{name:"lookups",type:"TABLE",value:new go.LookupList(t.lookups,Wo)}])}function ae(t,e){var n=new vo.Parser(t,e),i=n.parseULong();oo.argument(1===i,"Unsupported META table version."),n.parseULong(),n.parseULong();for(var r=n.parseULong(),o={},s=0;s<r;s++){var a=n.parseTag(),u=n.parseULong(),l=n.parseULong(),c=so.UTF8(t,e+u,l);o[a]=c}return o}function ue(t){var e=Object.keys(t).length,n="",i=16+12*e,r=new go.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:i},{name:"numTags",type:"ULONG",value:e}]);for(var o in t){var s=n.length;n+=t[o],r.fields.push({name:"tag "+o,type:"TAG",value:o}),r.fields.push({name:"offset "+o,type:"ULONG",value:i+s}),r.fields.push({name:"length "+o,type:"ULONG",value:t[o].length})}return r.fields.push({name:"stringPool",type:"CHARARRAY",value:n}),r}function le(t){return Math.log(t)/Math.log(2)|0}function ce(t){for(;t.length%4!=0;)t.push(0);for(var e=0,n=0;n<t.length;n+=4)e+=(t[n]<<24)+(t[n+1]<<16)+(t[n+2]<<8)+t[n+3];return e%=Math.pow(2,32)}function he(t,e,n,i){return new go.Record("Table Record",[{name:"tag",type:"TAG",value:void 0!==t?t:""},{name:"checkSum",type:"ULONG",value:void 0!==e?e:0},{name:"offset",type:"ULONG",value:void 0!==n?n:0},{name:"length",type:"ULONG",value:void 0!==i?i:0}])}function de(t){var e=new go.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);e.tables=t,e.numTables=t.length;var n=Math.pow(2,le(e.numTables));e.searchRange=16*n,e.entrySelector=le(n),e.rangeShift=16*e.numTables-e.searchRange;for(var i=[],r=[],o=e.sizeOf()+he().sizeOf()*e.numTables;o%4!=0;)o+=1,r.push({name:"padding",type:"BYTE",value:0});for(var s=0;s<t.length;s+=1){var a=t[s];oo.argument(4===a.tableName.length,"Table name"+a.tableName+" is invalid.");var u=a.sizeOf(),l=he(a.tableName,ce(a.encode()),o,u);for(i.push({name:l.tag+" Table Record",type:"RECORD",value:l}),r.push({name:a.tableName+" table",type:"RECORD",value:a}),o+=u,oo.argument(!isNaN(o),"Something went wrong calculating the offset.");o%4!=0;)o+=1,r.push({name:"padding",type:"BYTE",value:0})}return i.sort(function(t,e){return t.value.tag>e.value.tag?1:-1}),e.fields=e.fields.concat(i),e.fields=e.fields.concat(r),e}function pe(t,e,n){for(var i=0;i<e.length;i+=1){
var r=t.charToGlyphIndex(e[i]);if(r>0){return t.glyphs.get(r).getMetrics()}}return n}function fe(t){for(var e=0,n=0;n<t.length;n+=1)e+=t[n];return e/t.length}function ge(t){for(var e,n=[],i=[],r=[],o=[],s=[],a=[],u=[],l=0,c=0,h=0,d=0,p=0,f=0;f<t.glyphs.length;f+=1){var g=t.glyphs.get(f),m=0|g.unicode;if(isNaN(g.advanceWidth))throw new Error("Glyph "+g.name+" ("+f+"): advanceWidth is not a number.");(e>m||void 0===e)&&m>0&&(e=m),l<m&&(l=m);var x=jo.getUnicodeRange(m);if(x<32)c|=1<<x;else if(x<64)h|=1<<x-32;else if(x<96)d|=1<<x-64;else{if(!(x<123))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");p|=1<<x-96}if(".notdef"!==g.name){var v=g.getMetrics();n.push(v.xMin),i.push(v.yMin),r.push(v.xMax),o.push(v.yMax),a.push(v.leftSideBearing),u.push(v.rightSideBearing),s.push(g.advanceWidth)}}var _={xMin:Math.min.apply(null,n),yMin:Math.min.apply(null,i),xMax:Math.max.apply(null,r),yMax:Math.max.apply(null,o),advanceWidthMax:Math.max.apply(null,s),advanceWidthAvg:fe(s),minLeftSideBearing:Math.min.apply(null,a),maxLeftSideBearing:Math.max.apply(null,a),minRightSideBearing:Math.min.apply(null,u)};_.ascender=t.ascender,_.descender=t.descender;var y=Eo.make({flags:3,unitsPerEm:t.unitsPerEm,xMin:_.xMin,yMin:_.yMin,xMax:_.xMax,yMax:_.yMax,lowestRecPPEM:3,createdTimestamp:t.createdTimestamp}),w=Mo.make({ascender:_.ascender,descender:_.descender,advanceWidthMax:_.advanceWidthMax,minLeftSideBearing:_.minLeftSideBearing,minRightSideBearing:_.minRightSideBearing,xMaxExtent:_.maxLeftSideBearing+(_.xMax-_.xMin),numberOfHMetrics:t.glyphs.length}),b=Io.make(t.glyphs.length),S=jo.make({xAvgCharWidth:Math.round(_.advanceWidthAvg),usWeightClass:t.tables.os2.usWeightClass,usWidthClass:t.tables.os2.usWidthClass,usFirstCharIndex:e,usLastCharIndex:l,ulUnicodeRange1:c,ulUnicodeRange2:h,ulUnicodeRange3:d,ulUnicodeRange4:p,fsSelection:t.tables.os2.fsSelection,sTypoAscender:_.ascender,sTypoDescender:_.descender,sTypoLineGap:0,usWinAscent:_.yMax,usWinDescent:Math.abs(_.yMin),ulCodePageRange1:1,sxHeight:pe(t,"xyvw",{yMax:Math.round(_.ascender/2)}).yMax,sCapHeight:pe(t,"HIKLEFJMNTZBDPRAGOQSUVWXY",_).yMax,usDefaultChar:t.hasChar(" ")?32:0,usBreakChar:t.hasChar(" ")?32:0}),C=Do.make(t.glyphs),T=_o.make(t.glyphs),F=t.getEnglishName("fontFamily"),O=t.getEnglishName("fontSubfamily"),N=F+" "+O,E=t.getEnglishName("postScriptName");E||(E=F.replace(/\s/g,"")+"-"+O);var M={};for(var D in t.names)M[D]=t.names[D];M.uniqueID||(M.uniqueID={en:t.getEnglishName("manufacturer")+":"+N}),M.postScriptName||(M.postScriptName={en:E}),M.preferredFamily||(M.preferredFamily=t.names.fontFamily),M.preferredSubfamily||(M.preferredSubfamily=t.names.fontSubfamily);var V=[],I=zo.make(M,V),B=V.length>0?Vo.make(V):void 0,L=Go.make(),A=No.make(t.glyphs,{version:t.getEnglishName("version"),fullName:N,familyName:F,weightName:O,postScriptName:E,unitsPerEm:t.unitsPerEm,fontBBox:[0,_.yMin,_.ascender,_.advanceWidthMax]}),P=t.metas&&Object.keys(t.metas).length>0?$o.make(t.metas):void 0,R=[y,w,b,S,I,T,L,A,C];B&&R.push(B),t.tables.gsub&&R.push(Yo.make(t.tables.gsub)),P&&R.push(P);for(var k=de(R),U=k.encode(),z=ce(U),X=k.fields,j=!1,G=0;G<X.length;G+=1)if("head table"===X[G].name){X[G].value.checkSumAdjustment=2981146554-z,j=!0;break}if(!j)throw new Error("Could not find head table with checkSum to adjust.");return k}function me(t,e){for(var n=0,i=t.length-1;n<=i;){var r=n+i>>>1,o=t[r].tag;if(o===e)return r;o<e?n=r+1:i=r-1}return-n-1}function xe(t,e){for(var n=0,i=t.length-1;n<=i;){var r=n+i>>>1,o=t[r];if(o===e)return r;o<e?n=r+1:i=r-1}return-n-1}function ve(t,e){for(var n,i=0,r=t.length-1;i<=r;){var o=i+r>>>1;n=t[o];var s=n.start;if(s===e)return n;s<e?i=o+1:r=o-1}if(i>0)return n=t[i-1],e>n.end?0:n}function _e(t,e){this.font=t,this.tableName=e}function ye(t){_e.call(this,t,"gpos")}function we(t){_e.call(this,t,"gsub")}function be(t,e){var n=t.length;if(n!==e.length)return!1;for(var i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}function Se(t,e,n){for(var i=t.subtables,r=0;r<i.length;r++){var o=i[r];if(o.substFormat===e)return o}if(n)return i.push(n),n}function Ce(){return"undefined"!=typeof window}function Te(t){for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),i=0;i<t.length;++i)n[i]=t[i];return e}function Fe(t){for(var e=new Buffer(t.byteLength),n=new Uint8Array(t),i=0;i<e.length;++i)e[i]=n[i];return e}function Oe(t,e){if(!t)throw e}function Ne(t,e,n,i,r){var o;return(e&i)>0?(o=t.parseByte(),0==(e&r)&&(o=-o),o=n+o):o=(e&r)>0?n:n+t.parseShort(),o}function Ee(t,e,n){var i=new vo.Parser(e,n);t.numberOfContours=i.parseShort(),t._xMin=i.parseShort(),t._yMin=i.parseShort(),t._xMax=i.parseShort(),t._yMax=i.parseShort();var r,o;if(t.numberOfContours>0){for(var s=t.endPointIndices=[],a=0;a<t.numberOfContours;a+=1)s.push(i.parseUShort());t.instructionLength=i.parseUShort(),t.instructions=[];for(var u=0;u<t.instructionLength;u+=1)t.instructions.push(i.parseByte());var l=s[s.length-1]+1;r=[];for(var c=0;c<l;c+=1)if(o=i.parseByte(),r.push(o),(8&o)>0)for(var h=i.parseByte(),d=0;d<h;d+=1)r.push(o),c+=1;if(oo.argument(r.length===l,"Bad flags."),s.length>0){var p,f=[];if(l>0){for(var g=0;g<l;g+=1)o=r[g],p={},p.onCurve=!!(1&o),p.lastPointOfContour=s.indexOf(g)>=0,f.push(p);for(var m=0,x=0;x<l;x+=1)o=r[x],p=f[x],p.x=Ne(i,o,m,2,16),m=p.x;for(var v=0,_=0;_<l;_+=1)o=r[_],p=f[_],p.y=Ne(i,o,v,4,32),v=p.y}t.points=f}else t.points=[]}else if(0===t.numberOfContours)t.points=[];else{t.isComposite=!0,t.points=[],t.components=[];for(var y=!0;y;){r=i.parseUShort();var w={glyphIndex:i.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(1&r)>0?(2&r)>0?(w.dx=i.parseShort(),w.dy=i.parseShort()):w.matchedPoints=[i.parseUShort(),i.parseUShort()]:(2&r)>0?(w.dx=i.parseChar(),w.dy=i.parseChar()):w.matchedPoints=[i.parseByte(),i.parseByte()],(8&r)>0?w.xScale=w.yScale=i.parseF2Dot14():(64&r)>0?(w.xScale=i.parseF2Dot14(),w.yScale=i.parseF2Dot14()):(128&r)>0&&(w.xScale=i.parseF2Dot14(),w.scale01=i.parseF2Dot14(),w.scale10=i.parseF2Dot14(),w.yScale=i.parseF2Dot14()),t.components.push(w),y=!!(32&r)}if(256&r){t.instructionLength=i.parseUShort(),t.instructions=[];for(var b=0;b<t.instructionLength;b+=1)t.instructions.push(i.parseByte())}}}function Me(t,e){for(var n=[],i=0;i<t.length;i+=1){var r=t[i],o={x:e.xScale*r.x+e.scale01*r.y+e.dx,y:e.scale10*r.x+e.yScale*r.y+e.dy,onCurve:r.onCurve,lastPointOfContour:r.lastPointOfContour};n.push(o)}return n}function De(t){for(var e=[],n=[],i=0;i<t.length;i+=1){var r=t[i];n.push(r),r.lastPointOfContour&&(e.push(n),n=[])}return oo.argument(0===n.length,"There are still points left in the current contour."),e}function Ve(t){var e=new f;if(!t)return e;for(var n=De(t),i=0;i<n.length;++i){var r=n[i],o=null,s=r[r.length-1],a=r[0];if(s.onCurve)e.moveTo(s.x,s.y);else if(a.onCurve)e.moveTo(a.x,a.y);else{var u={x:.5*(s.x+a.x),y:.5*(s.y+a.y)};e.moveTo(u.x,u.y)}for(var l=0;l<r.length;++l)if(o=s,s=a,a=r[(l+1)%r.length],s.onCurve)e.lineTo(s.x,s.y);else{var c=a;o.onCurve||{x:.5*(s.x+o.x),y:.5*(s.y+o.y)},a.onCurve||(c={x:.5*(s.x+a.x),y:.5*(s.y+a.y)}),e.quadraticCurveTo(s.x,s.y,c.x,c.y)}e.closePath()}return e}function Ie(t,e){if(e.isComposite)for(var n=0;n<e.components.length;n+=1){var i=e.components[n],r=t.get(i.glyphIndex);if(r.getPath(),r.points){var o=void 0;if(void 0===i.matchedPoints)o=Me(r.points,i);else{if(i.matchedPoints[0]>e.points.length-1||i.matchedPoints[1]>r.points.length-1)throw Error("Matched points out of range in "+e.name);var s=e.points[i.matchedPoints[0]],a=r.points[i.matchedPoints[1]],u={xScale:i.xScale,scale01:i.scale01,scale10:i.scale10,yScale:i.yScale,dx:0,dy:0};a=Me([a],u)[0],u.dx=s.x-a.x,u.dy=s.y-a.y,o=Me(r.points,u)}e.points=e.points.concat(o)}}return Ve(e.points)}function Be(t,e,n,i){for(var r=new To.GlyphSet(i),o=0;o<n.length-1;o+=1){var s=n[o];s!==n[o+1]?r.push(o,To.ttfGlyphLoader(i,o,Ee,t,e+s,Ie)):r.push(o,To.glyphLoader(i,o))}return r}function Le(t){this.font=t,this.getCommands=function(t){return es.getPath(t).commands},this._fpgmState=this._prepState=void 0,this._errorState=0}function Ae(t){return t}function Pe(t){return Math.sign(t)*Math.round(Math.abs(t))}function Re(t){return Math.sign(t)*Math.round(Math.abs(2*t))/2}function ke(t){return Math.sign(t)*(Math.round(Math.abs(t)+.5)-.5)}function Ue(t){return Math.sign(t)*Math.ceil(Math.abs(t))}function ze(t){return Math.sign(t)*Math.floor(Math.abs(t))}function Xe(t,e){this.x=t,this.y=e,this.axis=void 0,this.slope=e/t,this.normalSlope=-t/e,Object.freeze(this)}function je(t,e){var n=Math.sqrt(t*t+e*e);return t/=n,e/=n,1===t&&0===e?is:0===t&&1===e?rs:new Xe(t,e)}function Ge(t,e,n,i){this.x=this.xo=Math.round(64*t)/64,this.y=this.yo=Math.round(64*e)/64,this.lastPointOfContour=n,this.onCurve=i,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}function He(t,e){switch(this.env=t,this.stack=[],this.prog=e,t){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=is,this.round=Pe}}function qe(t){for(var e=t.tZone=new Array(t.gZone.length),n=0;n<e.length;n++)e[n]=new Ge(0,0)}function We(t,e){var n,i=t.prog,r=t.ip,o=1;do if(88===(n=i[++r]))o++;else if(89===n)o--;else if(64===n)r+=i[r+1]+1;else if(65===n)r+=2*i[r+1]+1;else if(n>=176&&n<=183)r+=n-176+1;else if(n>=184&&n<=191)r+=2*(n-184+1);else if(e&&1===o&&27===n)break;while(o>0)t.ip=r}function Ye(e,n){t.DEBUG&&console.log(n.step,"SVTCA["+e.axis+"]"),n.fv=n.pv=n.dpv=e}function $e(e,n){t.DEBUG&&console.log(n.step,"SPVTCA["+e.axis+"]"),n.pv=n.dpv=e}function Ze(e,n){t.DEBUG&&console.log(n.step,"SFVTCA["+e.axis+"]"),n.fv=e}function Qe(e,n){var i=n.stack,r=i.pop(),o=i.pop(),s=n.z2[r],a=n.z1[o];t.DEBUG&&console.log("SPVTL["+e+"]",r,o);var u,l;e?(u=s.y-a.y,l=a.x-s.x):(u=a.x-s.x,l=a.y-s.y),n.pv=n.dpv=je(u,l)}function Ke(e,n){var i=n.stack,r=i.pop(),o=i.pop(),s=n.z2[r],a=n.z1[o];t.DEBUG&&console.log("SFVTL["+e+"]",r,o);var u,l;e?(u=s.y-a.y,l=a.x-s.x):(u=a.x-s.x,l=a.y-s.y),n.fv=je(u,l)}function Je(e){var n=e.stack,i=n.pop(),r=n.pop();t.DEBUG&&console.log(e.step,"SPVFS[]",i,r),e.pv=e.dpv=je(r,i)}function tn(e){var n=e.stack,i=n.pop(),r=n.pop();t.DEBUG&&console.log(e.step,"SPVFS[]",i,r),e.fv=je(r,i)}function en(e){var n=e.stack,i=e.pv;t.DEBUG&&console.log(e.step,"GPV[]"),n.push(16384*i.x),n.push(16384*i.y)}function nn(e){var n=e.stack,i=e.fv;t.DEBUG&&console.log(e.step,"GFV[]"),n.push(16384*i.x),n.push(16384*i.y)}function rn(e){e.fv=e.pv,t.DEBUG&&console.log(e.step,"SFVTPV[]")}function on(e){var n=e.stack,i=n.pop(),r=n.pop(),o=n.pop(),s=n.pop(),a=n.pop(),u=e.z0,l=e.z1,c=u[i],h=u[r],d=l[o],p=l[s],f=e.z2[a];t.DEBUG&&console.log("ISECT[], ",i,r,o,s,a);var g=c.x,m=c.y,x=h.x,v=h.y,_=d.x,y=d.y,w=p.x,b=p.y,S=(g-x)*(y-b)-(m-v)*(_-w),C=g*v-m*x,T=_*b-y*w;f.x=(C*(_-w)-T*(g-x))/S,f.y=(C*(y-b)-T*(m-v))/S}function sn(e){e.rp0=e.stack.pop(),t.DEBUG&&console.log(e.step,"SRP0[]",e.rp0)}function an(e){e.rp1=e.stack.pop(),t.DEBUG&&console.log(e.step,"SRP1[]",e.rp1)}function un(e){e.rp2=e.stack.pop(),t.DEBUG&&console.log(e.step,"SRP2[]",e.rp2)}function ln(e){var n=e.stack.pop();switch(t.DEBUG&&console.log(e.step,"SZP0[]",n),e.zp0=n,n){case 0:e.tZone||qe(e),e.z0=e.tZone;break;case 1:e.z0=e.gZone;break;default:throw new Error("Invalid zone pointer")}}function cn(e){var n=e.stack.pop();switch(t.DEBUG&&console.log(e.step,"SZP1[]",n),e.zp1=n,n){case 0:e.tZone||qe(e),e.z1=e.tZone;break;case 1:e.z1=e.gZone;break;default:throw new Error("Invalid zone pointer")}}function hn(e){var n=e.stack.pop();switch(t.DEBUG&&console.log(e.step,"SZP2[]",n),e.zp2=n,n){case 0:e.tZone||qe(e),e.z2=e.tZone;break;case 1:e.z2=e.gZone;break;default:throw new Error("Invalid zone pointer")}}function dn(e){var n=e.stack.pop();switch(t.DEBUG&&console.log(e.step,"SZPS[]",n),e.zp0=e.zp1=e.zp2=n,n){case 0:e.tZone||qe(e),e.z0=e.z1=e.z2=e.tZone;break;case 1:e.z0=e.z1=e.z2=e.gZone;break;default:throw new Error("Invalid zone pointer")}}function pn(e){e.loop=e.stack.pop(),t.DEBUG&&console.log(e.step,"SLOOP[]",e.loop)}function fn(e){t.DEBUG&&console.log(e.step,"RTG[]"),e.round=Pe}function gn(e){t.DEBUG&&console.log(e.step,"RTHG[]"),e.round=ke}function mn(e){var n=e.stack.pop();t.DEBUG&&console.log(e.step,"SMD[]",n),e.minDis=n/64}function xn(e){t.DEBUG&&console.log(e.step,"ELSE[]"),We(e,!1)}function vn(e){var n=e.stack.pop();t.DEBUG&&console.log(e.step,"JMPR[]",n),e.ip+=n-1}function _n(e){var n=e.stack.pop();t.DEBUG&&console.log(e.step,"SCVTCI[]",n),e.cvCutIn=n/64}function yn(e){var n=e.stack;t.DEBUG&&console.log(e.step,"DUP[]"),n.push(n[n.length-1])}function wn(e){t.DEBUG&&console.log(e.step,"POP[]"),e.stack.pop()}function bn(e){t.DEBUG&&console.log(e.step,"CLEAR[]"),e.stack.length=0}function Sn(e){var n=e.stack,i=n.pop(),r=n.pop();t.DEBUG&&console.log(e.step,"SWAP[]"),n.push(i),n.push(r)}function Cn(e){var n=e.stack;t.DEBUG&&console.log(e.step,"DEPTH[]"),n.push(n.length)}function Tn(e){var n=e.stack,i=n.pop(),r=n.pop();t.DEBUG&&console.log(e.step,"LOOPCALL[]",i,r);var o=e.ip,s=e.prog;e.prog=e.funcs[i];for(var a=0;a<r;a++)Ko(e),t.DEBUG&&console.log(++e.step,a+1<r?"next loopcall":"done loopcall",a);e.ip=o,e.prog=s}function Fn(e){var n=e.stack.pop();t.DEBUG&&console.log(e.step,"CALL[]",n);var i=e.ip,r=e.prog;e.prog=e.funcs[n],Ko(e),e.ip=i,e.prog=r,t.DEBUG&&console.log(++e.step,"returning from",n)}function On(e){var n=e.stack,i=n.pop();t.DEBUG&&console.log(e.step,"CINDEX[]",i),n.push(n[n.length-i])}function Nn(e){var n=e.stack,i=n.pop();t.DEBUG&&console.log(e.step,"MINDEX[]",i),n.push(n.splice(n.length-i,1)[0])}function En(e){if("fpgm"!==e.env)throw new Error("FDEF not allowed here");var n=e.stack,i=e.prog,r=e.ip,o=n.pop(),s=r;for(t.DEBUG&&console.log(e.step,"FDEF[]",o);45!==i[++r];);e.ip=r,e.funcs[o]=i.slice(s+1,r)}function Mn(e,n){var i=n.stack.pop(),r=n.z0[i],o=n.fv,s=n.pv;t.DEBUG&&console.log(n.step,"MDAP["+e+"]",i);var a=s.distance(r,os);e&&(a=n.round(a)),o.setRelative(r,os,a,s),o.touch(r),n.rp0=n.rp1=i}function Dn(e,n){var i,r,o,s=n.z2,a=s.length-2;t.DEBUG&&console.log(n.step,"IUP["+e.axis+"]");for(var u=0;u<a;u++)i=s[u],e.touched(i)||(r=i.prevTouched(e))!==i&&(o=i.nextTouched(e),r===o&&e.setRelative(i,i,e.distance(r,r,!1,!0),e,!0),e.interpolate(i,r,o,e))}function Vn(e,n){for(var i=n.stack,r=e?n.rp1:n.rp2,o=(e?n.z0:n.z1)[r],s=n.fv,a=n.pv,u=n.loop,l=n.z2;u--;){var c=i.pop(),h=l[c],d=a.distance(o,o,!1,!0);s.setRelative(h,h,d,a),s.touch(h),t.DEBUG&&console.log(n.step,(n.loop>1?"loop "+(n.loop-u)+": ":"")+"SHP["+(e?"rp1":"rp2")+"]",c)}n.loop=1}function In(e,n){var i=n.stack,r=e?n.rp1:n.rp2,o=(e?n.z0:n.z1)[r],s=n.fv,a=n.pv,u=i.pop(),l=n.z2[n.contours[u]],c=l;t.DEBUG&&console.log(n.step,"SHC["+e+"]",u);var h=a.distance(o,o,!1,!0);do c!==o&&s.setRelative(c,c,h,a),c=c.nextPointOnContour;while(c!==l)}function Bn(e,n){var i=n.stack,r=e?n.rp1:n.rp2,o=(e?n.z0:n.z1)[r],s=n.fv,a=n.pv,u=i.pop();t.DEBUG&&console.log(n.step,"SHZ["+e+"]",u);var l;switch(u){case 0:l=n.tZone;break;case 1:l=n.gZone;break;default:throw new Error("Invalid zone")}for(var c,h=a.distance(o,o,!1,!0),d=l.length-2,p=0;p<d;p++)c=l[p],s.setRelative(c,c,h,a)}function Ln(e){for(var n=e.stack,i=e.loop,r=e.fv,o=n.pop()/64,s=e.z2;i--;){var a=n.pop(),u=s[a];t.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-i)+": ":"")+"SHPIX[]",a,o),r.setRelative(u,u,o),r.touch(u)}e.loop=1}function An(e){for(var n=e.stack,i=e.rp1,r=e.rp2,o=e.loop,s=e.z0[i],a=e.z1[r],u=e.fv,l=e.dpv,c=e.z2;o--;){var h=n.pop(),d=c[h];t.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-o)+": ":"")+"IP[]",h,i,"<->",r),u.interpolate(d,s,a,l),u.touch(d)}e.loop=1}function Pn(e,n){var i=n.stack,r=i.pop()/64,o=i.pop(),s=n.z1[o],a=n.z0[n.rp0],u=n.fv,l=n.pv;u.setRelative(s,a,r,l),u.touch(s),t.DEBUG&&console.log(n.step,"MSIRP["+e+"]",r,o),n.rp1=n.rp0,n.rp2=o,e&&(n.rp0=o)}function Rn(e){for(var n=e.stack,i=e.rp0,r=e.z0[i],o=e.loop,s=e.fv,a=e.pv,u=e.z1;o--;){var l=n.pop(),c=u[l];t.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-o)+": ":"")+"ALIGNRP[]",l),s.setRelative(c,r,0,a),s.touch(c)}e.loop=1}function kn(e){t.DEBUG&&console.log(e.step,"RTDG[]"),e.round=Re}function Un(e,n){var i=n.stack,r=i.pop(),o=i.pop(),s=n.z0[o],a=n.fv,u=n.pv,l=n.cvt[r];t.DEBUG&&console.log(n.step,"MIAP["+e+"]",r,"(",l,")",o);var c=u.distance(s,os);e&&(Math.abs(c-l)<n.cvCutIn&&(c=l),c=n.round(c)),a.setRelative(s,os,c,u),0===n.zp0&&(s.xo=s.x,s.yo=s.y),a.touch(s),n.rp0=n.rp1=o}function zn(e){var n=e.prog,i=e.ip,r=e.stack,o=n[++i];t.DEBUG&&console.log(e.step,"NPUSHB[]",o);for(var s=0;s<o;s++)r.push(n[++i]);e.ip=i}function Xn(e){var n=e.ip,i=e.prog,r=e.stack,o=i[++n];t.DEBUG&&console.log(e.step,"NPUSHW[]",o);for(var s=0;s<o;s++){var a=i[++n]<<8|i[++n];32768&a&&(a=-(1+(65535^a))),r.push(a)}e.ip=n}function jn(e){var n=e.stack,i=e.store;i||(i=e.store=[]);var r=n.pop(),o=n.pop();t.DEBUG&&console.log(e.step,"WS",r,o),i[o]=r}function Gn(e){var n=e.stack,i=e.store,r=n.pop();t.DEBUG&&console.log(e.step,"RS",r);var o=i&&i[r]||0;n.push(o)}function Hn(e){var n=e.stack,i=n.pop(),r=n.pop();t.DEBUG&&console.log(e.step,"WCVTP",i,r),e.cvt[r]=i/64}function qn(e){var n=e.stack,i=n.pop();t.DEBUG&&console.log(e.step,"RCVT",i),n.push(64*e.cvt[i])}function Wn(e,n){var i=n.stack,r=i.pop(),o=n.z2[r];t.DEBUG&&console.log(n.step,"GC["+e+"]",r),i.push(64*n.dpv.distance(o,os,e,!1))}function Yn(e,n){var i=n.stack,r=i.pop(),o=i.pop(),s=n.z1[r],a=n.z0[o],u=n.dpv.distance(a,s,e,e);t.DEBUG&&console.log(n.step,"MD["+e+"]",r,o,"->",u),n.stack.push(Math.round(64*u))}function $n(e){t.DEBUG&&console.log(e.step,"MPPEM[]"),e.stack.push(e.ppem)}function Zn(e){t.DEBUG&&console.log(e.step,"FLIPON[]"),e.autoFlip=!0}function Qn(e){var n=e.stack,i=n.pop(),r=n.pop();t.DEBUG&&console.log(e.step,"LT[]",i,r),n.push(r<i?1:0)}function Kn(e){var n=e.stack,i=n.pop(),r=n.pop();t.DEBUG&&console.log(e.step,"LTEQ[]",i,r),n.push(r<=i?1:0)}function Jn(e){var n=e.stack,i=n.pop(),r=n.pop();t.DEBUG&&console.log(e.step,"GT[]",i,r),n.push(r>i?1:0)}function ti(e){var n=e.stack,i=n.pop(),r=n.pop();t.DEBUG&&console.log(e.step,"GTEQ[]",i,r),n.push(r>=i?1:0)}function ei(e){var n=e.stack,i=n.pop(),r=n.pop();t.DEBUG&&console.log(e.step,"EQ[]",i,r),n.push(i===r?1:0)}function ni(e){var n=e.stack,i=n.pop(),r=n.pop();t.DEBUG&&console.log(e.step,"NEQ[]",i,r),n.push(i!==r?1:0)}function ii(e){var n=e.stack,i=n.pop();t.DEBUG&&console.log(e.step,"ODD[]",i),n.push(Math.trunc(i)%2?1:0)}function ri(e){var n=e.stack,i=n.pop();t.DEBUG&&console.log(e.step,"EVEN[]",i),n.push(Math.trunc(i)%2?0:1)}function oi(e){var n=e.stack.pop();t.DEBUG&&console.log(e.step,"IF[]",n),n||(We(e,!0),t.DEBUG&&console.log(e.step,"EIF[]"))}function si(e){t.DEBUG&&console.log(e.step,"EIF[]")}function ai(e){var n=e.stack,i=n.pop(),r=n.pop();t.DEBUG&&console.log(e.step,"AND[]",i,r),n.push(i&&r?1:0)}function ui(e){var n=e.stack,i=n.pop(),r=n.pop();t.DEBUG&&console.log(e.step,"OR[]",i,r),n.push(i||r?1:0)}function li(e){var n=e.stack,i=n.pop();t.DEBUG&&console.log(e.step,"NOT[]",i),n.push(i?0:1)}function ci(e,n){var i=n.stack,r=i.pop(),o=n.fv,s=n.pv,a=n.ppem,u=n.deltaBase+16*(e-1),l=n.deltaShift,c=n.z0;t.DEBUG&&console.log(n.step,"DELTAP["+e+"]",r,i);for(var h=0;h<r;h++){var d=i.pop(),p=i.pop();if(u+((240&p)>>4)===a){var f=(15&p)-8;f>=0&&f++,t.DEBUG&&console.log(n.step,"DELTAPFIX",d,"by",f*l);var g=c[d];o.setRelative(g,g,f*l,s)}}}function hi(e){var n=e.stack,i=n.pop();t.DEBUG&&console.log(e.step,"SDB[]",i),e.deltaBase=i}function di(e){var n=e.stack,i=n.pop();t.DEBUG&&console.log(e.step,"SDS[]",i),e.deltaShift=Math.pow(.5,i)}function pi(e){var n=e.stack,i=n.pop(),r=n.pop();t.DEBUG&&console.log(e.step,"ADD[]",i,r),n.push(r+i)}function fi(e){var n=e.stack,i=n.pop(),r=n.pop();t.DEBUG&&console.log(e.step,"SUB[]",i,r),n.push(r-i)}function gi(e){var n=e.stack,i=n.pop(),r=n.pop();t.DEBUG&&console.log(e.step,"DIV[]",i,r),n.push(64*r/i)}function mi(e){var n=e.stack,i=n.pop(),r=n.pop();t.DEBUG&&console.log(e.step,"MUL[]",i,r),n.push(r*i/64)}function xi(e){var n=e.stack,i=n.pop();t.DEBUG&&console.log(e.step,"ABS[]",i),n.push(Math.abs(i))}function vi(e){var n=e.stack,i=n.pop();t.DEBUG&&console.log(e.step,"NEG[]",i),n.push(-i)}function _i(e){var n=e.stack,i=n.pop();t.DEBUG&&console.log(e.step,"FLOOR[]",i),n.push(64*Math.floor(i/64))}function yi(e){var n=e.stack,i=n.pop();t.DEBUG&&console.log(e.step,"CEILING[]",i),n.push(64*Math.ceil(i/64))}function wi(e,n){var i=n.stack,r=i.pop();t.DEBUG&&console.log(n.step,"ROUND[]"),i.push(64*n.round(r/64))}function bi(e){var n=e.stack,i=n.pop(),r=n.pop();t.DEBUG&&console.log(e.step,"WCVTF[]",i,r),e.cvt[r]=i*e.ppem/e.font.unitsPerEm}function Si(e,n){var i=n.stack,r=i.pop(),o=n.ppem,s=n.deltaBase+16*(e-1),a=n.deltaShift;t.DEBUG&&console.log(n.step,"DELTAC["+e+"]",r,i);for(var u=0;u<r;u++){var l=i.pop(),c=i.pop();if(s+((240&c)>>4)===o){var h=(15&c)-8;h>=0&&h++;var d=h*a;t.DEBUG&&console.log(n.step,"DELTACFIX",l,"by",d),n.cvt[l]+=d}}}function Ci(e){var n=e.stack.pop();t.DEBUG&&console.log(e.step,"SROUND[]",n),e.round=ns;var i;switch(192&n){case 0:i=.5;break;case 64:i=1;break;case 128:i=2;break;default:throw new Error("invalid SROUND value")}switch(e.srPeriod=i,48&n){case 0:e.srPhase=0;break;case 16:e.srPhase=.25*i;break;case 32:e.srPhase=.5*i;break;case 48:e.srPhase=.75*i;break;default:throw new Error("invalid SROUND value")}n&=15,e.srThreshold=0===n?0:(n/8-.5)*i}function Ti(e){var n=e.stack.pop();t.DEBUG&&console.log(e.step,"S45ROUND[]",n),e.round=ns;var i;switch(192&n){case 0:i=Math.sqrt(2)/2;break;case 64:i=Math.sqrt(2);break;case 128:i=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(e.srPeriod=i,48&n){case 0:e.srPhase=0;break;case 16:e.srPhase=.25*i;break;case 32:e.srPhase=.5*i;break;case 48:e.srPhase=.75*i;break;default:throw new Error("invalid S45ROUND value")}n&=15,e.srThreshold=0===n?0:(n/8-.5)*i}function Fi(e){t.DEBUG&&console.log(e.step,"ROFF[]"),e.round=Ae}function Oi(e){t.DEBUG&&console.log(e.step,"RUTG[]"),e.round=Ue}function Ni(e){t.DEBUG&&console.log(e.step,"RDTG[]"),e.round=ze}function Ei(e){var n=e.stack.pop();t.DEBUG&&console.log(e.step,"SCANCTRL[]",n)}function Mi(e,n){var i=n.stack,r=i.pop(),o=i.pop(),s=n.z2[r],a=n.z1[o];t.DEBUG&&console.log(n.step,"SDPVTL["+e+"]",r,o);var u,l;e?(u=s.y-a.y,l=a.x-s.x):(u=a.x-s.x,l=a.y-s.y),n.dpv=je(u,l)}function Di(e){var n=e.stack,i=n.pop(),r=0;t.DEBUG&&console.log(e.step,"GETINFO[]",i),1&i&&(r=35),32&i&&(r|=4096),n.push(r)}function Vi(e){var n=e.stack,i=n.pop(),r=n.pop(),o=n.pop();t.DEBUG&&console.log(e.step,"ROLL[]"),n.push(r),n.push(i),n.push(o)}function Ii(e){var n=e.stack,i=n.pop(),r=n.pop();t.DEBUG&&console.log(e.step,"MAX[]",i,r),n.push(Math.max(r,i))}function Bi(e){var n=e.stack,i=n.pop(),r=n.pop();t.DEBUG&&console.log(e.step,"MIN[]",i,r),n.push(Math.min(r,i))}function Li(e){var n=e.stack.pop();t.DEBUG&&console.log(e.step,"SCANTYPE[]",n)}function Ai(e){var n=e.stack.pop(),i=e.stack.pop();switch(t.DEBUG&&console.log(e.step,"INSTCTRL[]",n,i),n){case 1:return void(e.inhibitGridFit=!!i);case 2:return void(e.ignoreCvt=!!i);default:throw new Error("invalid INSTCTRL[] selector")}}function Pi(e,n){var i=n.stack,r=n.prog,o=n.ip;t.DEBUG&&console.log(n.step,"PUSHB["+e+"]");for(var s=0;s<e;s++)i.push(r[++o]);n.ip=o}function Ri(e,n){var i=n.ip,r=n.prog,o=n.stack;t.DEBUG&&console.log(n.ip,"PUSHW["+e+"]");for(var s=0;s<e;s++){var a=r[++i]<<8|r[++i];32768&a&&(a=-(1+(65535^a))),o.push(a)}n.ip=i}function ki(e,n,i,r,o,s){var a,u,l,c,h=s.stack,d=e&&h.pop(),p=h.pop(),f=s.rp0,g=s.z0[f],m=s.z1[p],x=s.minDis,v=s.fv,_=s.dpv;u=a=_.distance(m,g,!0,!0),l=u>=0?1:-1,u=Math.abs(u),e&&(c=s.cvt[d],r&&Math.abs(u-c)<s.cvCutIn&&(u=c)),i&&u<x&&(u=x),r&&(u=s.round(u)),v.setRelative(m,g,l*u,_),v.touch(m),t.DEBUG&&console.log(s.step,(e?"MIRP[":"MDRP[")+(n?"M":"m")+(i?">":"_")+(r?"R":"_")+(0===o?"Gr":1===o?"Bl":2===o?"Wh":"")+"]",e?d+"("+s.cvt[d]+","+c+")":"",p,"(d =",a,"->",l*u,")"),s.rp1=s.rp0,s.rp2=p,n&&(s.rp0=p)}function Ui(t){this.char=t,this.state={},this.activeState=null}function zi(t,e,n){this.contextName=n,this.startIndex=t,this.endOffset=e}function Xi(t,e,n){this.contextName=t,this.openRange=null,this.ranges=[],this.checkStart=e,this.checkEnd=n}function ji(t,e){this.context=t,this.index=e,this.length=t.length,this.current=t[e],this.backtrack=t.slice(0,e),this.lookahead=t.slice(e+1)}function Gi(t){this.eventId=t,this.subscribers=[]}function Hi(t){var e=this,n=["start","end","next","newToken","contextStart","contextEnd","insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD","updateContextsRanges"];n.forEach(function(t){Object.defineProperty(e.events,t,{value:new Gi(t)})}),t&&n.forEach(function(n){var i=t[n];"function"==typeof i&&e.events[n].subscribe(i)}),["insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD"].forEach(function(t){e.events[t].subscribe(e.updateContextsRanges)})}function qi(t){this.tokens=[],this.registeredContexts={},this.contextCheckers=[],this.events={},this.registeredModifiers=[],Hi.call(this,t)}function Wi(t){return/[\u0600-\u065F\u066A-\u06D2\u06FA-\u06FF]/.test(t)}function Yi(t){return/[\u0630\u0690\u0621\u0631\u0661\u0671\u0622\u0632\u0672\u0692\u06C2\u0623\u0673\u0693\u06C3\u0624\u0694\u06C4\u0625\u0675\u0695\u06C5\u06E5\u0676\u0696\u06C6\u0627\u0677\u0697\u06C7\u0648\u0688\u0698\u06C8\u0689\u0699\u06C9\u068A\u06CA\u066B\u068B\u06CB\u068C\u068D\u06CD\u06FD\u068E\u06EE\u06FE\u062F\u068F\u06CF\u06EF]/.test(t)}function $i(t){return/[\u0600-\u0605\u060C-\u060E\u0610-\u061B\u061E\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED]/.test(t)}function Zi(t){return/\s/.test(t)}function Qi(t){var e=t.current,n=t.get(-1);return null===n&&Wi(e)||!Wi(n)&&Wi(e)}function Ki(t){var e=t.get(1);return null===e||!Wi(e)}function Ji(t){var e=t.current,n=t.get(-1);return(Wi(e)||$i(e))&&!Wi(n)}function tr(t){var e=t.get(1);switch(!0){case null===e:return!0;case!Wi(e)&&!$i(e):var n=Zi(e);if(!n)return!0;if(n){if(!t.lookahead.some(function(t){return Wi(t)||$i(t)}))return!0}break;default:return!1}}function er(t){for(var e=[].concat(t.backtrack),n=e.length-1;n>=0;n--){var i=e[n],r=Yi(i),o=$i(i);if(!r&&!o)return!0;if(r)return!1}return!1}function nr(t){if(Yi(t.current))return!1;for(var e=0;e<t.lookahead.length;e++){if(!$i(t.lookahead[e]))return!0}return!1}function ir(t){var e=this.features.arab,n=this.tokenizer.getRangeTokens(t);if(1!==n.length){var i=function(t){return 1===t.length&&12===t[0].id&&t[0].substitution},r=function(t,n,r){if(e.hasOwnProperty(t)){var o=e[t].lookup(r)||null,s=i(o)[0];return s>=0?n.setState(t,s):void 0}},o=new ji(n,0),s=new ji(n.map(function(t){return t.char}),0);n.forEach(function(t,e){if(!$i(t.char)){o.setCurrentIndex(e),s.setCurrentIndex(e);var n=0;switch(er(s)&&(n|=1),nr(s)&&(n|=2),n){case 0:return;case 1:r("fina",t,o);break;case 2:r("init",t,o);break;case 3:r("medi",t,o)}}})}}function rr(t){var e=this.features.arab;if(e.hasOwnProperty("rlig"))for(var n=this.tokenizer.getRangeTokens(t),i=0;i<n.length;i++){var r=new ji(n,i),o=e.rlig.lookup(r)||null,s=1===o.length&&63===o[0].id&&o[0].substitution,a=1===o.length&&41===o[0].id&&o[0].substitution[0],u=n[i];if(a){u.setState("rlig",[a.ligGlyph]);for(var l=0;l<a.components.length;l++){var c=a.components[l],h=r.get(l+1);h.activeState.value===c&&(h.state.deleted=!0)}}else if(s){var d=s&&1===s.length&&12===s[0].id&&s[0].substitution;d&&d>=0&&u.setState("rlig",d)}}}function or(t){this.baseDir=t||"ltr",this.tokenizer=new qi,this.features=[]}function sr(){var t=this.contextChecks.arabicWordCheck;return this.tokenizer.registerContextChecker("arabicWord",t.arabicWordStartCheck,t.arabicWordEndCheck)}function ar(){var t=this.contextChecks.arabicSentenceCheck;return this.tokenizer.registerContextChecker("arabicSentence",t.arabicSentenceStartCheck,t.arabicSentenceEndCheck)}function ur(){return sr.call(this),ar.call(this),this.tokenizer.tokenize(this.text)}function lr(){var t=this;this.tokenizer.getContextRanges("arabicSentence").forEach(function(e){var n=t.tokenizer.getRangeTokens(e);t.tokenizer.replaceRange(e.startIndex,e.endOffset,n.reverse())})}function cr(){if(this.tokenizer.registeredModifiers.indexOf("glyphIndex")===-1)throw new Error("glyphIndex modifier is required to apply arabic presentation features.")}function hr(){var t=this;if(this.features.hasOwnProperty("arab")){cr.call(this);this.tokenizer.getContextRanges("arabicWord").forEach(function(e){ir.call(t,e)})}}function dr(){var t=this;if(this.features.hasOwnProperty("arab")&&this.features.arab.hasOwnProperty("rlig")){cr.call(this);this.tokenizer.getContextRanges("arabicWord").forEach(function(e){rr.call(t,e)})}}function pr(t,e){this.font=t,this.features={},ls=e?e:ls}function fr(t,e,n,i){this.tag=t,this.featureRef=e,this.lookups=n.lookups,this.script=i}function gr(t){this.table=t}function mr(t){this.ligatureSets=t}function xr(t,e,n){this.lookups=t,this.subtable=n,this.lookupTable=e,n.hasOwnProperty("coverage")&&(this.coverage=new gr(n.coverage)),n.hasOwnProperty("inputCoverage")&&(this.inputCoverage=n.inputCoverage.map(function(t){return new gr(t)})),n.hasOwnProperty("backtrackCoverage")&&(this.backtrackCoverage=n.backtrackCoverage.map(function(t){return new gr(t)})),n.hasOwnProperty("lookaheadCoverage")&&(this.lookaheadCoverage=n.lookaheadCoverage.map(function(t){return new gr(t)})),n.hasOwnProperty("ligatureSets")&&(this.ligatureSets=new mr(n.ligatureSets))}function vr(t,e){this.index=t,this.subtables=e[t].subtables.map(function(n){return new xr(e,e[t],n)})}function _r(t,e){this.lookups=e.map(function(e){return new vr(e,t)})}function yr(t){var e=t.current.activeState.value;e=Array.isArray(e)?e[0]:e;var n=this.coverage.lookup(e);return n===-1?[]:[this.subtable.substitute[n]]}function wr(t,e){for(var n=[],i=0;i<t.length;i++){var r=t[i],o=e.current.activeState.value;o=Array.isArray(o)?o[0]:o;var s=r.lookup(o);s!==-1&&n.push(s)}return n.length!==t.length?-1:n}function br(t){var e=this,n=this.inputCoverage.length+this.lookaheadCoverage.length+this.backtrackCoverage.length;if(t.context.length<n)return[];var i=wr(this.inputCoverage,t);if(i===-1)return[];var r=this.inputCoverage.length-1;if(t.lookahead.length<this.lookaheadCoverage.length)return[];for(var o=t.lookahead.slice(r);o.length&&$i(o[0].char);)o.shift();var s=new ji(o,0),a=wr(this.lookaheadCoverage,s),u=[].concat(t.backtrack);for(u.reverse();u.length&&$i(u[0].char);)u.shift();if(u.length<this.backtrackCoverage.length)return[];var l=new ji(u,0),c=wr(this.backtrackCoverage,l),h=i.length===this.inputCoverage.length&&a.length===this.lookaheadCoverage.length&&c.length===this.backtrackCoverage.length,d=[];if(h)for(var p=this.subtable.lookupRecords,f=0;f<p.length;f++)for(var g=p[f],m=0;m<i.length;m++){var x=new ji([t.get(m)],0),v=g.lookupListIndex,_=new vr(v,e.lookups),y=_.lookup(x);d=d.concat(y)}return d}function Sr(t){var e=t.current.activeState.value,n=this.coverage.lookup(e);if(n===-1)return[];var i=this.ligatureSets.lookup(t,n);return i?[i]:[]}function Cr(t){t=t||{},t.empty||(Oe(t.familyName,"When creating a new Font object, familyName is required."),Oe(t.styleName,"When creating a new Font object, styleName is required."),Oe(t.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),Oe(t.ascender,"When creating a new Font object, ascender is required."),Oe(t.descender,"When creating a new Font object, descender is required."),Oe(t.descender<0,"Descender should be negative (e.g. -512)."),this.names={fontFamily:{en:t.familyName||" "},fontSubfamily:{en:t.styleName||" "},fullName:{en:t.fullName||t.familyName+" "+t.styleName},postScriptName:{en:t.postScriptName||(t.familyName+t.styleName).replace(/\s/g,"")},designer:{en:t.designer||" "},designerURL:{en:t.designerURL||" "},manufacturer:{en:t.manufacturer||" "},manufacturerURL:{en:t.manufacturerURL||" "},license:{en:t.license||" "},licenseURL:{en:t.licenseURL||" "},version:{en:t.version||"Version 0.1"},description:{en:t.description||" "},copyright:{en:t.copyright||" "},trademark:{en:t.trademark||" "}},this.unitsPerEm=t.unitsPerEm||1e3,this.ascender=t.ascender,this.descender=t.descender,this.createdTimestamp=t.createdTimestamp,this.tables={os2:{usWeightClass:t.weightClass||this.usWeightClasses.MEDIUM,
usWidthClass:t.widthClass||this.usWidthClasses.MEDIUM,fsSelection:t.fsSelection||this.fsSelectionValues.REGULAR}}),this.supported=!0,this.glyphs=new To.GlyphSet(this,t.glyphs||[]),this.encoding=new q(this),this.position=new ye(this),this.substitution=new we(this),this.tables=this.tables||{},Object.defineProperty(this,"hinting",{get:function(){return this._hinting?this._hinting:"truetype"===this.outlinesFormat?this._hinting=new Le(this):void 0}})}function Tr(t,e){var n=JSON.stringify(t),i=256;for(var r in e){var o=parseInt(r);if(o&&!(o<256)){if(JSON.stringify(e[r])===n)return o;i<=o&&(i=o+1)}}return e[i]=t,i}function Fr(t,e,n){var i=Tr(e.name,n);return[{name:"tag_"+t,type:"TAG",value:e.tag},{name:"minValue_"+t,type:"FIXED",value:e.minValue<<16},{name:"defaultValue_"+t,type:"FIXED",value:e.defaultValue<<16},{name:"maxValue_"+t,type:"FIXED",value:e.maxValue<<16},{name:"flags_"+t,type:"USHORT",value:0},{name:"nameID_"+t,type:"USHORT",value:i}]}function Or(t,e,n){var i={},r=new vo.Parser(t,e);return i.tag=r.parseTag(),i.minValue=r.parseFixed(),i.defaultValue=r.parseFixed(),i.maxValue=r.parseFixed(),r.skip("uShort",1),i.name=n[r.parseUShort()]||{},i}function Nr(t,e,n,i){for(var r=Tr(e.name,i),o=[{name:"nameID_"+t,type:"USHORT",value:r},{name:"flags_"+t,type:"USHORT",value:0}],s=0;s<n.length;++s){var a=n[s].tag;o.push({name:"axis_"+t+" "+a,type:"FIXED",value:e.coordinates[a]<<16})}return o}function Er(t,e,n,i){var r={},o=new vo.Parser(t,e);r.name=i[o.parseUShort()]||{},o.skip("uShort",1),r.coordinates={};for(var s=0;s<n.length;++s)r.coordinates[n[s].tag]=o.parseFixed();return r}function Mr(t,e){var n=new go.Table("fvar",[{name:"version",type:"ULONG",value:65536},{name:"offsetToData",type:"USHORT",value:0},{name:"countSizePairs",type:"USHORT",value:2},{name:"axisCount",type:"USHORT",value:t.axes.length},{name:"axisSize",type:"USHORT",value:20},{name:"instanceCount",type:"USHORT",value:t.instances.length},{name:"instanceSize",type:"USHORT",value:4+4*t.axes.length}]);n.offsetToData=n.sizeOf();for(var i=0;i<t.axes.length;i++)n.fields=n.fields.concat(Fr(i,t.axes[i],e));for(var r=0;r<t.instances.length;r++)n.fields=n.fields.concat(Nr(r,t.instances[r],t.axes,e));return n}function Dr(t,e,n){var i=new vo.Parser(t,e),r=i.parseULong();oo.argument(65536===r,"Unsupported fvar table version.");var o=i.parseOffset16();i.skip("uShort",1);for(var s=i.parseUShort(),a=i.parseUShort(),u=i.parseUShort(),l=i.parseUShort(),c=[],h=0;h<s;h++)c.push(Or(t,e+o+h*a,n));for(var d=[],p=e+o+s*a,f=0;f<u;f++)d.push(Er(t,p+f*l,c,n));return{axes:c,instances:d}}function Vr(t,e){e=e||0;var n=new k(t,e),i=n.parseVersion(1);return oo.argument(1===i||1.1===i,"Unsupported GPOS table version "+i),1===i?{version:i,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(hs)}:{version:i,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(hs),variations:n.parseFeatureVariationsList()}}function Ir(t){return new go.Table("GPOS",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new go.ScriptList(t.scripts)},{name:"features",type:"TABLE",value:new go.FeatureList(t.features)},{name:"lookups",type:"TABLE",value:new go.LookupList(t.lookups,ds)}])}function Br(t){var e={};t.skip("uShort");var n=t.parseUShort();oo.argument(0===n,"Unsupported kern sub-table version."),t.skip("uShort",2);var i=t.parseUShort();t.skip("uShort",3);for(var r=0;r<i;r+=1){var o=t.parseUShort(),s=t.parseUShort(),a=t.parseShort();e[o+","+s]=a}return e}function Lr(t){var e={};t.skip("uShort"),t.parseULong()>1&&console.warn("Only the first kern subtable is supported."),t.skip("uLong");var n=t.parseUShort(),i=255&n;if(t.skip("uShort"),0===i){var r=t.parseUShort();t.skip("uShort",3);for(var o=0;o<r;o+=1){var s=t.parseUShort(),a=t.parseUShort(),u=t.parseShort();e[s+","+a]=u}}return e}function Ar(t,e){var n=new vo.Parser(t,e),i=n.parseUShort();if(0===i)return Br(n);if(1===i)return Lr(n);throw new Error("Unsupported kern table version ("+i+").")}function Pr(t,e,n,i){for(var r=new vo.Parser(t,e),o=i?r.parseUShort:r.parseULong,s=[],a=0;a<n+1;a+=1){var u=o.call(r);i&&(u*=2),s.push(u)}return s}function Rr(t,e){require("fs").readFile(t,function(t,n){if(t)return e(t.message);e(null,Te(n))})}function kr(t,e){var n=new XMLHttpRequest;n.open("get",t,!0),n.responseType="arraybuffer",n.onload=function(){return n.response?e(null,n.response):e("Font could not be loaded: "+n.statusText)},n.onerror=function(){e("Font could not be loaded")},n.send()}function Ur(t,e){for(var n=[],i=12,r=0;r<e;r+=1){var o=vo.getTag(t,i),s=vo.getULong(t,i+4),a=vo.getULong(t,i+8),u=vo.getULong(t,i+12);n.push({tag:o,checksum:s,offset:a,length:u,compression:!1}),i+=16}return n}function zr(t,e){for(var n=[],i=44,r=0;r<e;r+=1){var o=vo.getTag(t,i),s=vo.getULong(t,i+4),a=vo.getULong(t,i+8),u=vo.getULong(t,i+12),l=void 0;l=a<u&&"WOFF",n.push({tag:o,offset:s,compression:l,compressedLength:a,length:u}),i+=20}return n}function Xr(t,e){if("WOFF"===e.compression){var n=new Uint8Array(t.buffer,e.offset+2,e.compressedLength-2),i=new Uint8Array(e.length);if(ro(n,i),i.byteLength!==e.length)throw new Error("Decompression error: "+e.tag+" decompressed length doesn't match recorded length");return{data:new DataView(i.buffer,0),offset:0}}return{data:t,offset:e.offset}}function jr(t){var e,n,i,r=new Cr({empty:!0}),o=new DataView(t,0),s=[],a=vo.getTag(o,0);if(a===String.fromCharCode(0,1,0,0)||"true"===a||"typ1"===a)r.outlinesFormat="truetype",i=vo.getUShort(o,4),s=Ur(o,i);else if("OTTO"===a)r.outlinesFormat="cff",i=vo.getUShort(o,4),s=Ur(o,i);else{if("wOFF"!==a)throw new Error("Unsupported OpenType signature "+a);var u=vo.getTag(o,4);if(u===String.fromCharCode(0,1,0,0))r.outlinesFormat="truetype";else{if("OTTO"!==u)throw new Error("Unsupported OpenType flavor "+a);r.outlinesFormat="cff"}i=vo.getUShort(o,12),s=zr(o,i)}for(var l,c,h,d,p,f,g,m,x,v,_,y=0;y<i;y+=1){var w=s[y],b=void 0;switch(w.tag){case"cmap":b=Xr(o,w),r.tables.cmap=_o.parse(b.data,b.offset),r.encoding=new W(r.tables.cmap);break;case"cvt ":b=Xr(o,w),_=new vo.Parser(b.data,b.offset),r.tables.cvt=_.parseShortList(w.length/2);break;case"fvar":c=w;break;case"fpgm":b=Xr(o,w),_=new vo.Parser(b.data,b.offset),r.tables.fpgm=_.parseByteList(w.length);break;case"head":b=Xr(o,w),r.tables.head=Eo.parse(b.data,b.offset),r.unitsPerEm=r.tables.head.unitsPerEm,e=r.tables.head.indexToLocFormat;break;case"hhea":b=Xr(o,w),r.tables.hhea=Mo.parse(b.data,b.offset),r.ascender=r.tables.hhea.ascender,r.descender=r.tables.hhea.descender,r.numberOfHMetrics=r.tables.hhea.numberOfHMetrics;break;case"hmtx":f=w;break;case"ltag":b=Xr(o,w),n=Vo.parse(b.data,b.offset);break;case"maxp":b=Xr(o,w),r.tables.maxp=Io.parse(b.data,b.offset),r.numGlyphs=r.tables.maxp.numGlyphs;break;case"name":x=w;break;case"OS/2":b=Xr(o,w),r.tables.os2=jo.parse(b.data,b.offset);break;case"post":b=Xr(o,w),r.tables.post=Go.parse(b.data,b.offset),r.glyphNames=new $(r.tables.post);break;case"prep":b=Xr(o,w),_=new vo.Parser(b.data,b.offset),r.tables.prep=_.parseByteList(w.length);break;case"glyf":h=w;break;case"loca":m=w;break;case"CFF ":l=w;break;case"kern":g=w;break;case"GPOS":d=w;break;case"GSUB":p=w;break;case"meta":v=w}}var S=Xr(o,x);if(r.tables.name=zo.parse(S.data,S.offset,n),r.names=r.tables.name,h&&m){var C=0===e,T=Xr(o,m),F=gs.parse(T.data,T.offset,r.numGlyphs,C),O=Xr(o,h);r.glyphs=es.parse(O.data,O.offset,F,r)}else{if(!l)throw new Error("Font doesn't contain TrueType or CFF outlines.");var N=Xr(o,l);No.parse(N.data,N.offset,r)}var E=Xr(o,f);if(Do.parse(E.data,E.offset,r.numberOfHMetrics,r.numGlyphs,r.glyphs),Z(r),g){var M=Xr(o,g);r.kerningPairs=fs.parse(M.data,M.offset)}else r.kerningPairs={};if(d){var D=Xr(o,d);r.tables.gpos=ps.parse(D.data,D.offset),r.position.init()}if(p){var V=Xr(o,p);r.tables.gsub=Yo.parse(V.data,V.offset)}if(c){var I=Xr(o,c);r.tables.fvar=cs.parse(I.data,I.offset,r.names)}if(v){var B=Xr(o,v);r.tables.meta=$o.parse(B.data,B.offset),r.metas=r.tables.meta}return r}function Gr(t,e){("undefined"==typeof window?Rr:kr)(t,function(t,n){if(t)return e(t);var i;try{i=jr(n)}catch(t){return e(t,null)}return e(null,i)})}function Hr(t){return jr(Te(require("fs").readFileSync(t)))}String.prototype.codePointAt||function(){var t=function(){try{var t={},e=Object.defineProperty,n=e(t,t,t)&&e}catch(t){}return n}(),e=function(t){if(null==this)throw TypeError();var e=String(this),n=e.length,i=t?Number(t):0;if(i!=i&&(i=0),!(i<0||i>=n)){var r,o=e.charCodeAt(i);return o>=55296&&o<=56319&&n>i+1&&(r=e.charCodeAt(i+1))>=56320&&r<=57343?1024*(o-55296)+r-56320+65536:o}};t?t(String.prototype,"codePointAt",{value:e,configurable:!0,writable:!0}):String.prototype.codePointAt=e}();var qr=0,Wr=-3,Yr=new e,$r=new e,Zr=new Uint8Array(30),Qr=new Uint16Array(30),Kr=new Uint8Array(30),Jr=new Uint16Array(30),to=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),eo=new e,no=new Uint8Array(320),io=new Uint16Array(16);!function(t,e){var n;for(n=0;n<7;++n)t.table[n]=0;for(t.table[7]=24,t.table[8]=152,t.table[9]=112,n=0;n<24;++n)t.trans[n]=256+n;for(n=0;n<144;++n)t.trans[24+n]=n;for(n=0;n<8;++n)t.trans[168+n]=280+n;for(n=0;n<112;++n)t.trans[176+n]=144+n;for(n=0;n<5;++n)e.table[n]=0;for(e.table[5]=32,n=0;n<32;++n)e.trans[n]=n}(Yr,$r),i(Zr,Qr,4,3),i(Kr,Jr,2,1),Zr[28]=0,Qr[28]=258;var ro=h;p.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)},p.prototype.addPoint=function(t,e){"number"==typeof t&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),"number"==typeof e&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=e,this.y2=e),e<this.y1&&(this.y1=e),e>this.y2&&(this.y2=e))},p.prototype.addX=function(t){this.addPoint(t,null)},p.prototype.addY=function(t){this.addPoint(null,t)},p.prototype.addBezier=function(t,e,n,i,r,o,s,a){var u=this,l=[t,e],c=[n,i],h=[r,o],p=[s,a];this.addPoint(t,e),this.addPoint(s,a);for(var f=0;f<=1;f++){var g=6*l[f]-12*c[f]+6*h[f],m=-3*l[f]+9*c[f]-9*h[f]+3*p[f],x=3*c[f]-3*l[f];if(0!==m){var v=Math.pow(g,2)-4*x*m;if(!(v<0)){var _=(-g+Math.sqrt(v))/(2*m);0<_&&_<1&&(0===f&&u.addX(d(l[f],c[f],h[f],p[f],_)),1===f&&u.addY(d(l[f],c[f],h[f],p[f],_)));var y=(-g-Math.sqrt(v))/(2*m);0<y&&y<1&&(0===f&&u.addX(d(l[f],c[f],h[f],p[f],y)),1===f&&u.addY(d(l[f],c[f],h[f],p[f],y)))}}else{if(0===g)continue;var w=-x/g;0<w&&w<1&&(0===f&&u.addX(d(l[f],c[f],h[f],p[f],w)),1===f&&u.addY(d(l[f],c[f],h[f],p[f],w)))}}},p.prototype.addQuad=function(t,e,n,i,r,o){var s=t+2/3*(n-t),a=e+2/3*(i-e),u=s+1/3*(r-t),l=a+1/3*(o-e);this.addBezier(t,e,s,a,u,l,r,o)},f.prototype.moveTo=function(t,e){this.commands.push({type:"M",x:t,y:e})},f.prototype.lineTo=function(t,e){this.commands.push({type:"L",x:t,y:e})},f.prototype.curveTo=f.prototype.bezierCurveTo=function(t,e,n,i,r,o){this.commands.push({type:"C",x1:t,y1:e,x2:n,y2:i,x:r,y:o})},f.prototype.quadTo=f.prototype.quadraticCurveTo=function(t,e,n,i){this.commands.push({type:"Q",x1:t,y1:e,x:n,y:i})},f.prototype.close=f.prototype.closePath=function(){this.commands.push({type:"Z"})},f.prototype.extend=function(t){if(t.commands)t=t.commands;else if(t instanceof p){var e=t;return this.moveTo(e.x1,e.y1),this.lineTo(e.x2,e.y1),this.lineTo(e.x2,e.y2),this.lineTo(e.x1,e.y2),void this.close()}Array.prototype.push.apply(this.commands,t)},f.prototype.getBoundingBox=function(){for(var t=this,e=new p,n=0,i=0,r=0,o=0,s=0;s<this.commands.length;s++){var a=t.commands[s];switch(a.type){case"M":e.addPoint(a.x,a.y),n=r=a.x,i=o=a.y;break;case"L":e.addPoint(a.x,a.y),r=a.x,o=a.y;break;case"Q":e.addQuad(r,o,a.x1,a.y1,a.x,a.y),r=a.x,o=a.y;break;case"C":e.addBezier(r,o,a.x1,a.y1,a.x2,a.y2,a.x,a.y),r=a.x,o=a.y;break;case"Z":r=n,o=i;break;default:throw new Error("Unexpected path command "+a.type)}}return e.isEmpty()&&e.addPoint(0,0),e},f.prototype.draw=function(t){var e=this;t.beginPath();for(var n=0;n<this.commands.length;n+=1){var i=e.commands[n];"M"===i.type?t.moveTo(i.x,i.y):"L"===i.type?t.lineTo(i.x,i.y):"C"===i.type?t.bezierCurveTo(i.x1,i.y1,i.x2,i.y2,i.x,i.y):"Q"===i.type?t.quadraticCurveTo(i.x1,i.y1,i.x,i.y):"Z"===i.type&&t.closePath()}this.fill&&(t.fillStyle=this.fill,t.fill()),this.stroke&&(t.strokeStyle=this.stroke,t.lineWidth=this.strokeWidth,t.stroke())},f.prototype.toPathData=function(t){function e(e){return Math.round(e)===e?""+Math.round(e):e.toFixed(t)}function n(){for(var t=arguments,n="",i=0;i<arguments.length;i+=1){var r=t[i];r>=0&&i>0&&(n+=" "),n+=e(r)}return n}var i=this;t=void 0!==t?t:2;for(var r="",o=0;o<this.commands.length;o+=1){var s=i.commands[o];"M"===s.type?r+="M"+n(s.x,s.y):"L"===s.type?r+="L"+n(s.x,s.y):"C"===s.type?r+="C"+n(s.x1,s.y1,s.x2,s.y2,s.x,s.y):"Q"===s.type?r+="Q"+n(s.x1,s.y1,s.x,s.y):"Z"===s.type&&(r+="Z")}return r},f.prototype.toSVG=function(t){var e='<path d="';return e+=this.toPathData(t),e+='"',this.fill&&"black"!==this.fill&&(e+=null===this.fill?' fill="none"':' fill="'+this.fill+'"'),this.stroke&&(e+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),e+="/>"},f.prototype.toDOMElement=function(t){var e=this.toPathData(t),n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("d",e),n};var oo={fail:g,argument:m,assert:m},so={},ao={},uo={};ao.BYTE=function(t){return oo.argument(t>=0&&t<=255,"Byte value should be between 0 and 255."),[t]},uo.BYTE=x(1),ao.CHAR=function(t){return[t.charCodeAt(0)]},uo.CHAR=x(1),ao.CHARARRAY=function(t){for(var e=[],n=0;n<t.length;n+=1)e[n]=t.charCodeAt(n);return e},uo.CHARARRAY=function(t){return t.length},ao.USHORT=function(t){return[t>>8&255,255&t]},uo.USHORT=x(2),ao.SHORT=function(t){return t>=32768&&(t=-(65536-t)),[t>>8&255,255&t]},uo.SHORT=x(2),ao.UINT24=function(t){return[t>>16&255,t>>8&255,255&t]},uo.UINT24=x(3),ao.ULONG=function(t){return[t>>24&255,t>>16&255,t>>8&255,255&t]},uo.ULONG=x(4),ao.LONG=function(t){return t>=2147483648&&(t=-(4294967296-t)),[t>>24&255,t>>16&255,t>>8&255,255&t]},uo.LONG=x(4),ao.FIXED=ao.ULONG,uo.FIXED=uo.ULONG,ao.FWORD=ao.SHORT,uo.FWORD=uo.SHORT,ao.UFWORD=ao.USHORT,uo.UFWORD=uo.USHORT,ao.LONGDATETIME=function(t){return[0,0,0,0,t>>24&255,t>>16&255,t>>8&255,255&t]},uo.LONGDATETIME=x(8),ao.TAG=function(t){return oo.argument(4===t.length,"Tag should be exactly 4 ASCII characters."),[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]},uo.TAG=x(4),ao.Card8=ao.BYTE,uo.Card8=uo.BYTE,ao.Card16=ao.USHORT,uo.Card16=uo.USHORT,ao.OffSize=ao.BYTE,uo.OffSize=uo.BYTE,ao.SID=ao.USHORT,uo.SID=uo.USHORT,ao.NUMBER=function(t){return t>=-107&&t<=107?[t+139]:t>=108&&t<=1131?(t-=108,[247+(t>>8),255&t]):t>=-1131&&t<=-108?(t=-t-108,[251+(t>>8),255&t]):t>=-32768&&t<=32767?ao.NUMBER16(t):ao.NUMBER32(t)},uo.NUMBER=function(t){return ao.NUMBER(t).length},ao.NUMBER16=function(t){return[28,t>>8&255,255&t]},uo.NUMBER16=x(3),ao.NUMBER32=function(t){return[29,t>>24&255,t>>16&255,t>>8&255,255&t]},uo.NUMBER32=x(5),ao.REAL=function(t){var e=t.toString(),n=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(e);if(n){var i=parseFloat("1e"+((n[2]?+n[2]:0)+n[1].length));e=(Math.round(t*i)/i).toString()}for(var r="",o=0,s=e.length;o<s;o+=1){var a=e[o];r+="e"===a?"-"===e[++o]?"c":"b":"."===a?"a":"-"===a?"e":a}r+=1&r.length?"f":"ff";for(var u=[30],l=0,c=r.length;l<c;l+=2)u.push(parseInt(r.substr(l,2),16));return u},uo.REAL=function(t){return ao.REAL(t).length},ao.NAME=ao.CHARARRAY,uo.NAME=uo.CHARARRAY,ao.STRING=ao.CHARARRAY,uo.STRING=uo.CHARARRAY,so.UTF8=function(t,e,n){for(var i=[],r=n,o=0;o<r;o++,e+=1)i[o]=t.getUint8(e);return String.fromCharCode.apply(null,i)},so.UTF16=function(t,e,n){for(var i=[],r=n/2,o=0;o<r;o++,e+=2)i[o]=t.getUint16(e);return String.fromCharCode.apply(null,i)},ao.UTF16=function(t){for(var e=[],n=0;n<t.length;n+=1){var i=t.charCodeAt(n);e[e.length]=i>>8&255,e[e.length]=255&i}return e},uo.UTF16=function(t){return 2*t.length};var lo={"x-mac-croatian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®Š™´¨≠ŽØ∞±≤≥∆µ∂∑∏š∫ªºΩžø¿¡¬√ƒ≈Ć«Č… ÀÃÕŒœĐ—“”‘’÷◊©⁄€‹›Æ»–·‚„‰ÂćÁčÈÍÎÏÌÓÔđÒÚÛÙıˆ˜¯πË˚¸Êæˇ","x-mac-cyrillic":"АБВГДЕЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ†°Ґ£§•¶І®©™Ђђ≠Ѓѓ∞±≤≥іµґЈЄєЇїЉљЊњјЅ¬√ƒ≈∆«»… ЋћЌќѕ–—“”‘’÷„ЎўЏџ№Ёёяабвгдежзийклмнопрстуфхцчшщъыьэю","x-mac-gaelic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØḂ±≤≥ḃĊċḊḋḞḟĠġṀæøṁṖṗɼƒſṠ«»… ÀÃÕŒœ–—“”‘’ṡẛÿŸṪ€‹›Ŷŷṫ·Ỳỳ⁊ÂÊÁËÈÍÎÏÌÓÔ♣ÒÚÛÙıÝýŴŵẄẅẀẁẂẃ","x-mac-greek":"Ä¹²É³ÖÜ΅àâä΄¨çéèêë£™îï•½‰ôö¦€ùûü†ΓΔΘΛΞΠß®©ΣΪ§≠°·Α±≤≥¥ΒΕΖΗΙΚΜΦΫΨΩάΝ¬ΟΡ≈Τ«»… ΥΧΆΈœ–―“”‘’÷ΉΊΌΎέήίόΏύαβψδεφγηιξκλμνοπώρστθωςχυζϊϋΐΰ­","x-mac-icelandic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûüÝ°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€ÐðÞþý·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-inuit":"ᐃᐄᐅᐆᐊᐋᐱᐲᐳᐴᐸᐹᑉᑎᑏᑐᑑᑕᑖᑦᑭᑮᑯᑰᑲᑳᒃᒋᒌᒍᒎᒐᒑ°ᒡᒥᒦ•¶ᒧ®©™ᒨᒪᒫᒻᓂᓃᓄᓅᓇᓈᓐᓯᓰᓱᓲᓴᓵᔅᓕᓖᓗᓘᓚᓛᓪᔨᔩᔪᔫᔭ… ᔮᔾᕕᕖᕗ–—“”‘’ᕘᕙᕚᕝᕆᕇᕈᕉᕋᕌᕐᕿᖀᖁᖂᖃᖄᖅᖏᖐᖑᖒᖓᖔᖕᙱᙲᙳᙴᙵᙶᖖᖠᖡᖢᖣᖤᖥᖦᕼŁł","x-mac-ce":"ÄĀāÉĄÖÜáąČäčĆćéŹźĎíďĒēĖóėôöõúĚěü†°Ę£§•¶ß®©™ę¨≠ģĮįĪ≤≥īĶ∂∑łĻļĽľĹĺŅņŃ¬√ńŇ∆«»… ňŐÕőŌ–—“”‘’÷◊ōŔŕŘ‹›řŖŗŠ‚„šŚśÁŤťÍŽžŪÓÔūŮÚůŰűŲųÝýķŻŁżĢˇ",macintosh:"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›ﬁﬂ‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-romanian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ĂȘ∞±≤≥¥µ∂∑∏π∫ªºΩăș¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›Țț‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-turkish":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸĞğİıŞş‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙˆ˜¯˘˙˚¸˝˛ˇ"};so.MACSTRING=function(t,e,n,i){var r=lo[i];if(void 0!==r){for(var o="",s=0;s<n;s++){var a=t.getUint8(e+s);o+=a<=127?String.fromCharCode(a):r[127&a]}return o}};var co,ho="function"==typeof WeakMap&&new WeakMap,po=function(t){if(!co){co={};for(var e in lo)co[e]=new String(e)}var n=co[t];if(void 0!==n){if(ho){var i=ho.get(n);if(void 0!==i)return i}var r=lo[t];if(void 0!==r){for(var o={},s=0;s<r.length;s++)o[r.charCodeAt(s)]=s+128;return ho&&ho.set(n,o),o}}};ao.MACSTRING=function(t,e){var n=po(e);if(void 0!==n){for(var i=[],r=0;r<t.length;r++){var o=t.charCodeAt(r);if(o>=128&&void 0===(o=n[o]))return;i[r]=o}return i}},uo.MACSTRING=function(t,e){var n=ao.MACSTRING(t,e);return void 0!==n?n.length:0},ao.VARDELTAS=function(t){for(var e=0,n=[];e<t.length;){var i=t[e];e=0===i?_(t,e,n):i>=-128&&i<=127?y(t,e,n):w(t,e,n)}return n},ao.INDEX=function(t){for(var e=1,n=[e],i=[],r=0;r<t.length;r+=1){var o=ao.OBJECT(t[r]);Array.prototype.push.apply(i,o),e+=o.length,n.push(e)}if(0===i.length)return[0,0];for(var s=[],a=1+Math.floor(Math.log(e)/Math.log(2))/8|0,u=[void 0,ao.BYTE,ao.USHORT,ao.UINT24,ao.ULONG][a],l=0;l<n.length;l+=1){var c=u(n[l]);Array.prototype.push.apply(s,c)}return Array.prototype.concat(ao.Card16(t.length),ao.OffSize(a),s,i)},uo.INDEX=function(t){return ao.INDEX(t).length},ao.DICT=function(t){for(var e=[],n=Object.keys(t),i=n.length,r=0;r<i;r+=1){var o=parseInt(n[r],0),s=t[o];e=e.concat(ao.OPERAND(s.value,s.type)),e=e.concat(ao.OPERATOR(o))}return e},uo.DICT=function(t){return ao.DICT(t).length},ao.OPERATOR=function(t){return t<1200?[t]:[12,t-1200]},ao.OPERAND=function(t,e){var n=[];if(Array.isArray(e))for(var i=0;i<e.length;i+=1)oo.argument(t.length===e.length,"Not enough arguments given for type"+e),n=n.concat(ao.OPERAND(t[i],e[i]));else if("SID"===e)n=n.concat(ao.NUMBER(t));else if("offset"===e)n=n.concat(ao.NUMBER32(t));else if("number"===e)n=n.concat(ao.NUMBER(t));else{if("real"!==e)throw new Error("Unknown operand type "+e);n=n.concat(ao.REAL(t))}return n},ao.OP=ao.BYTE,uo.OP=uo.BYTE;var fo="function"==typeof WeakMap&&new WeakMap;ao.CHARSTRING=function(t){if(fo){var e=fo.get(t);if(void 0!==e)return e}for(var n=[],i=t.length,r=0;r<i;r+=1){var o=t[r];n=n.concat(ao[o.type](o.value))}return fo&&fo.set(t,n),n},uo.CHARSTRING=function(t){return ao.CHARSTRING(t).length},ao.OBJECT=function(t){var e=ao[t.type];return oo.argument(void 0!==e,"No encoding function for type "+t.type),e(t.value)},uo.OBJECT=function(t){var e=uo[t.type];return oo.argument(void 0!==e,"No sizeOf function for type "+t.type),e(t.value)},ao.TABLE=function(t){for(var e=[],n=t.fields.length,i=[],r=[],o=0;o<n;o+=1){var s=t.fields[o],a=ao[s.type];oo.argument(void 0!==a,"No encoding function for field type "+s.type+" ("+s.name+")");var u=t[s.name];void 0===u&&(u=s.value);var l=a(u);"TABLE"===s.type?(r.push(e.length),e=e.concat([0,0]),i.push(l)):e=e.concat(l)}for(var c=0;c<i.length;c+=1){var h=r[c],d=e.length;oo.argument(d<65536,"Table "+t.tableName+" too big."),e[h]=d>>8,e[h+1]=255&d,e=e.concat(i[c])}return e},uo.TABLE=function(t){for(var e=0,n=t.fields.length,i=0;i<n;i+=1){var r=t.fields[i],o=uo[r.type];oo.argument(void 0!==o,"No sizeOf function for field type "+r.type+" ("+r.name+")");var s=t[r.name];void 0===s&&(s=r.value),e+=o(s),"TABLE"===r.type&&(e+=2)}return e},ao.RECORD=ao.TABLE,uo.RECORD=uo.TABLE,ao.LITERAL=function(t){return t},uo.LITERAL=function(t){return t.length},b.prototype.encode=function(){return ao.TABLE(this)},b.prototype.sizeOf=function(){return uo.TABLE(this)},F.prototype=Object.create(b.prototype),F.prototype.constructor=F,O.prototype=Object.create(b.prototype),O.prototype.constructor=O,N.prototype=Object.create(b.prototype),N.prototype.constructor=N,E.prototype=Object.create(b.prototype),E.prototype.constructor=E;var go={Table:b,Record:b,Coverage:F,ScriptList:O,FeatureList:N,LookupList:E,ushortList:S,tableList:C,recordList:T},mo={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};k.prototype.parseByte=function(){var t=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,t},k.prototype.parseChar=function(){var t=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,t},k.prototype.parseCard8=k.prototype.parseByte,k.prototype.parseUShort=function(){var t=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,t},k.prototype.parseCard16=k.prototype.parseUShort,k.prototype.parseSID=k.prototype.parseUShort,k.prototype.parseOffset16=k.prototype.parseUShort,k.prototype.parseShort=function(){var t=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,t},k.prototype.parseF2Dot14=function(){var t=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,t},k.prototype.parseULong=function(){var t=I(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,t},k.prototype.parseOffset32=k.prototype.parseULong,k.prototype.parseFixed=function(){var t=B(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,t},k.prototype.parseString=function(t){var e=this.data,n=this.offset+this.relativeOffset,i="";this.relativeOffset+=t;for(var r=0;r<t;r++)i+=String.fromCharCode(e.getUint8(n+r));return i},k.prototype.parseTag=function(){return this.parseString(4)},k.prototype.parseLongDateTime=function(){var t=I(this.data,this.offset+this.relativeOffset+4);return t-=2082844800,this.relativeOffset+=8,t},k.prototype.parseVersion=function(t){var e=D(this.data,this.offset+this.relativeOffset),n=D(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,void 0===t&&(t=4096),e+n/t/10},k.prototype.skip=function(t,e){void 0===e&&(e=1),this.relativeOffset+=mo[t]*e},k.prototype.parseULongList=function(t){void 0===t&&(t=this.parseULong());for(var e=new Array(t),n=this.data,i=this.offset+this.relativeOffset,r=0;r<t;r++)e[r]=n.getUint32(i),i+=4;return this.relativeOffset+=4*t,e},k.prototype.parseOffset16List=k.prototype.parseUShortList=function(t){void 0===t&&(t=this.parseUShort());for(var e=new Array(t),n=this.data,i=this.offset+this.relativeOffset,r=0;r<t;r++)e[r]=n.getUint16(i),i+=2;return this.relativeOffset+=2*t,e},k.prototype.parseShortList=function(t){for(var e=new Array(t),n=this.data,i=this.offset+this.relativeOffset,r=0;r<t;r++)e[r]=n.getInt16(i),i+=2;return this.relativeOffset+=2*t,e},k.prototype.parseByteList=function(t){for(var e=new Array(t),n=this.data,i=this.offset+this.relativeOffset,r=0;r<t;r++)e[r]=n.getUint8(i++);return this.relativeOffset+=t,e},k.prototype.parseList=function(t,e){var n=this;e||(e=t,t=this.parseUShort());for(var i=new Array(t),r=0;r<t;r++)i[r]=e.call(n);return i},k.prototype.parseList32=function(t,e){var n=this;e||(e=t,t=this.parseULong());for(var i=new Array(t),r=0;r<t;r++)i[r]=e.call(n);return i},k.prototype.parseRecordList=function(t,e){var n=this;e||(e=t,t=this.parseUShort());for(var i=new Array(t),r=Object.keys(e),o=0;o<t;o++){for(var s={},a=0;a<r.length;a++){var u=r[a],l=e[u];s[u]=l.call(n)}i[o]=s}return i},k.prototype.parseRecordList32=function(t,e){var n=this;e||(e=t,t=this.parseULong());for(var i=new Array(t),r=Object.keys(e),o=0;o<t;o++){for(var s={},a=0;a<r.length;a++){var u=r[a],l=e[u];s[u]=l.call(n)}i[o]=s}return i},k.prototype.parseStruct=function(t){var e=this;if("function"==typeof t)return t.call(this);for(var n=Object.keys(t),i={},r=0;r<n.length;r++){var o=n[r],s=t[o];i[o]=s.call(e)}return i},k.prototype.parseValueRecord=function(t){if(void 0===t&&(t=this.parseUShort()),0!==t){var e={};return 1&t&&(e.xPlacement=this.parseShort()),2&t&&(e.yPlacement=this.parseShort()),4&t&&(e.xAdvance=this.parseShort()),8&t&&(e.yAdvance=this.parseShort()),16&t&&(e.xPlaDevice=void 0,this.parseShort()),32&t&&(e.yPlaDevice=void 0,this.parseShort()),64&t&&(e.xAdvDevice=void 0,this.parseShort()),128&t&&(e.yAdvDevice=void 0,this.parseShort()),e}},k.prototype.parseValueRecordList=function(){for(var t=this,e=this.parseUShort(),n=this.parseUShort(),i=new Array(n),r=0;r<n;r++)i[r]=t.parseValueRecord(e);return i},k.prototype.parsePointer=function(t){var e=this.parseOffset16();if(e>0)return new k(this.data,this.offset+e).parseStruct(t)},k.prototype.parsePointer32=function(t){var e=this.parseOffset32();if(e>0)return new k(this.data,this.offset+e).parseStruct(t)},k.prototype.parseListOfLists=function(t){for(var e=this,n=this.parseOffset16List(),i=n.length,r=this.relativeOffset,o=new Array(i),s=0;s<i;s++){var a=n[s];if(0!==a)if(e.relativeOffset=a,t){for(var u=e.parseOffset16List(),l=new Array(u.length),c=0;c<u.length;c++)e.relativeOffset=a+u[c],l[c]=t.call(e);o[s]=l}else o[s]=e.parseUShortList();else o[s]=void 0}return this.relativeOffset=r,o},k.prototype.parseCoverage=function(){var t=this,e=this.offset+this.relativeOffset,n=this.parseUShort(),i=this.parseUShort();if(1===n)return{format:1,glyphs:this.parseUShortList(i)};if(2===n){for(var r=new Array(i),o=0;o<i;o++)r[o]={start:t.parseUShort(),end:t.parseUShort(),index:t.parseUShort()};return{format:2,ranges:r}}throw new Error("0x"+e.toString(16)+": Coverage format must be 1 or 2.")},k.prototype.parseClassDef=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();if(1===e)return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};if(2===e)return{format:2,ranges:this.parseRecordList({start:k.uShort,end:k.uShort,classId:k.uShort})};throw new Error("0x"+t.toString(16)+": ClassDef format must be 1 or 2.")},k.list=function(t,e){return function(){return this.parseList(t,e)}},k.list32=function(t,e){return function(){return this.parseList32(t,e)}},k.recordList=function(t,e){return function(){return this.parseRecordList(t,e)}},k.recordList32=function(t,e){return function(){return this.parseRecordList32(t,e)}},k.pointer=function(t){return function(){return this.parsePointer(t)}},k.pointer32=function(t){return function(){return this.parsePointer32(t)}},k.tag=k.prototype.parseTag,k.byte=k.prototype.parseByte,k.uShort=k.offset16=k.prototype.parseUShort,k.uShortList=k.prototype.parseUShortList,k.uLong=k.offset32=k.prototype.parseULong,k.uLongList=k.prototype.parseULongList,k.struct=k.prototype.parseStruct,k.coverage=k.prototype.parseCoverage,k.classDef=k.prototype.parseClassDef;var xo={reserved:k.uShort,reqFeatureIndex:k.uShort,featureIndexes:k.uShortList};k.prototype.parseScriptList=function(){return this.parsePointer(k.recordList({tag:k.tag,script:k.pointer({defaultLangSys:k.pointer(xo),langSysRecords:k.recordList({tag:k.tag,langSys:k.pointer(xo)})})}))||[]},k.prototype.parseFeatureList=function(){return this.parsePointer(k.recordList({tag:k.tag,feature:k.pointer({featureParams:k.offset16,lookupListIndexes:k.uShortList})}))||[]},k.prototype.parseLookupList=function(t){return this.parsePointer(k.list(k.pointer(function(){var e=this.parseUShort();oo.argument(1<=e&&e<=9,"GPOS/GSUB lookup type "+e+" unknown.");var n=this.parseUShort(),i=16&n;return{lookupType:e,lookupFlag:n,subtables:this.parseList(k.pointer(t[e])),markFilteringSet:i?this.parseUShort():void 0}})))||[]},k.prototype.parseFeatureVariationsList=function(){return this.parsePointer32(function(){var t=this.parseUShort(),e=this.parseUShort();return oo.argument(1===t&&e<1,"GPOS/GSUB feature variations table unknown."),this.parseRecordList32({conditionSetOffset:k.offset32,featureTableSubstitutionOffset:k.offset32})})||[]};var vo={getByte:M,getCard8:M,getUShort:D,getCard16:D,getShort:V,getULong:I,getFixed:B,getTag:L,getOffset:A,getBytes:P,bytesToString:R,Parser:k},_o={parse:X,make:H
},yo=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],wo=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],bo=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],So=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];q.prototype.charToGlyphIndex=function(t){var e=t.codePointAt(0),n=this.font.glyphs;if(n)for(var i=0;i<n.length;i+=1)for(var r=n.get(i),o=0;o<r.unicodes.length;o+=1)if(r.unicodes[o]===e)return i;return null},W.prototype.charToGlyphIndex=function(t){return this.cmap.glyphIndexMap[t.codePointAt(0)]||0},Y.prototype.charToGlyphIndex=function(t){var e=t.codePointAt(0),n=this.encoding[e];return this.charset.indexOf(n)},$.prototype.nameToGlyphIndex=function(t){return this.names.indexOf(t)},$.prototype.glyphIndexToName=function(t){return this.names[t]};var Co={line:Q};J.prototype.bindConstructorValues=function(t){this.index=t.index||0,this.name=t.name||null,this.unicode=t.unicode||void 0,this.unicodes=t.unicodes||void 0!==t.unicode?[t.unicode]:[],t.xMin&&(this.xMin=t.xMin),t.yMin&&(this.yMin=t.yMin),t.xMax&&(this.xMax=t.xMax),t.yMax&&(this.yMax=t.yMax),t.advanceWidth&&(this.advanceWidth=t.advanceWidth),Object.defineProperty(this,"path",K(this,t.path))},J.prototype.addUnicode=function(t){0===this.unicodes.length&&(this.unicode=t),this.unicodes.push(t)},J.prototype.getBoundingBox=function(){return this.path.getBoundingBox()},J.prototype.getPath=function(t,e,n,i,r){t=void 0!==t?t:0,e=void 0!==e?e:0,n=void 0!==n?n:72;var o,s;i||(i={});var a=i.xScale,u=i.yScale;if(i.hinting&&r&&r.hinting&&(s=this.path&&r.hinting.exec(this,n)),s)o=r.hinting.getCommands(s),t=Math.round(t),e=Math.round(e),a=u=1;else{o=this.path.commands;var l=1/this.path.unitsPerEm*n;void 0===a&&(a=l),void 0===u&&(u=l)}for(var c=new f,h=0;h<o.length;h+=1){var d=o[h];"M"===d.type?c.moveTo(t+d.x*a,e+-d.y*u):"L"===d.type?c.lineTo(t+d.x*a,e+-d.y*u):"Q"===d.type?c.quadraticCurveTo(t+d.x1*a,e+-d.y1*u,t+d.x*a,e+-d.y*u):"C"===d.type?c.curveTo(t+d.x1*a,e+-d.y1*u,t+d.x2*a,e+-d.y2*u,t+d.x*a,e+-d.y*u):"Z"===d.type&&c.closePath()}return c},J.prototype.getContours=function(){var t=this;if(void 0===this.points)return[];for(var e=[],n=[],i=0;i<this.points.length;i+=1){var r=t.points[i];n.push(r),r.lastPointOfContour&&(e.push(n),n=[])}return oo.argument(0===n.length,"There are still points left in the current contour."),e},J.prototype.getMetrics=function(){for(var t=this.path.commands,e=[],n=[],i=0;i<t.length;i+=1){var r=t[i];"Z"!==r.type&&(e.push(r.x),n.push(r.y)),"Q"!==r.type&&"C"!==r.type||(e.push(r.x1),n.push(r.y1)),"C"===r.type&&(e.push(r.x2),n.push(r.y2))}var o={xMin:Math.min.apply(null,e),yMin:Math.min.apply(null,n),xMax:Math.max.apply(null,e),yMax:Math.max.apply(null,n),leftSideBearing:this.leftSideBearing};return isFinite(o.xMin)||(o.xMin=0),isFinite(o.xMax)||(o.xMax=this.advanceWidth),isFinite(o.yMin)||(o.yMin=0),isFinite(o.yMax)||(o.yMax=0),o.rightSideBearing=this.advanceWidth-o.leftSideBearing-(o.xMax-o.xMin),o},J.prototype.draw=function(t,e,n,i,r){this.getPath(e,n,i,r).draw(t)},J.prototype.drawPoints=function(t,e,n,i){function r(e,n,i,r){var o=2*Math.PI;t.beginPath();for(var s=0;s<e.length;s+=1)t.moveTo(n+e[s].x*r,i+e[s].y*r),t.arc(n+e[s].x*r,i+e[s].y*r,2,0,o,!1);t.closePath(),t.fill()}e=void 0!==e?e:0,n=void 0!==n?n:0,i=void 0!==i?i:24;for(var o=1/this.path.unitsPerEm*i,s=[],a=[],u=this.path,l=0;l<u.commands.length;l+=1){var c=u.commands[l];void 0!==c.x&&s.push({x:c.x,y:-c.y}),void 0!==c.x1&&a.push({x:c.x1,y:-c.y1}),void 0!==c.x2&&a.push({x:c.x2,y:-c.y2})}t.fillStyle="blue",r(s,e,n,o),t.fillStyle="red",r(a,e,n,o)},J.prototype.drawMetrics=function(t,e,n,i){var r;e=void 0!==e?e:0,n=void 0!==n?n:0,i=void 0!==i?i:24,r=1/this.path.unitsPerEm*i,t.lineWidth=1,t.strokeStyle="black",Co.line(t,e,-1e4,e,1e4),Co.line(t,-1e4,n,1e4,n);var o=this.xMin||0,s=this.yMin||0,a=this.xMax||0,u=this.yMax||0,l=this.advanceWidth||0;t.strokeStyle="blue",Co.line(t,e+o*r,-1e4,e+o*r,1e4),Co.line(t,e+a*r,-1e4,e+a*r,1e4),Co.line(t,-1e4,n+-s*r,1e4,n+-s*r),Co.line(t,-1e4,n+-u*r,1e4,n+-u*r),t.strokeStyle="green",Co.line(t,e+l*r,-1e4,e+l*r,1e4)},et.prototype.get=function(t){return"function"==typeof this.glyphs[t]&&(this.glyphs[t]=this.glyphs[t]()),this.glyphs[t]},et.prototype.push=function(t,e){this.glyphs[t]=e,this.length++};var To={GlyphSet:et,glyphLoader:nt,ttfGlyphLoader:it,cffGlyphLoader:rt},Fo=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],Oo=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}],No={parse:bt,make:Lt},Eo={parse:At,make:Pt},Mo={parse:Rt,make:kt},Do={parse:Ut,make:zt},Vo={make:Xt,parse:jt},Io={parse:Gt,make:Ht},Bo=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],Lo={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},Ao={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},Po={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"},Ro="utf-16",ko={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},Uo={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"},zo={parse:Yt,make:Jt},Xo=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}],jo={parse:ee,make:ne,unicodeRanges:Xo,getUnicodeRange:te},Go={parse:ie,make:re},Ho=new Array(9);Ho[1]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();return 1===e?{substFormat:1,coverage:this.parsePointer(k.coverage),deltaGlyphId:this.parseUShort()}:2===e?{substFormat:2,coverage:this.parsePointer(k.coverage),substitute:this.parseOffset16List()}:void oo.assert(!1,"0x"+t.toString(16)+": lookup type 1 format must be 1 or 2.")},Ho[2]=function(){var t=this.parseUShort();return oo.argument(1===t,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(k.coverage),sequences:this.parseListOfLists()}},Ho[3]=function(){var t=this.parseUShort();return oo.argument(1===t,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(k.coverage),alternateSets:this.parseListOfLists()}},Ho[4]=function(){var t=this.parseUShort();return oo.argument(1===t,"GSUB ligature table identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(k.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}};var qo={sequenceIndex:k.uShort,lookupListIndex:k.uShort};Ho[5]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();if(1===e)return{substFormat:e,coverage:this.parsePointer(k.coverage),ruleSets:this.parseListOfLists(function(){var t=this.parseUShort(),e=this.parseUShort();return{input:this.parseUShortList(t-1),lookupRecords:this.parseRecordList(e,qo)}})};if(2===e)return{substFormat:e,coverage:this.parsePointer(k.coverage),classDef:this.parsePointer(k.classDef),classSets:this.parseListOfLists(function(){var t=this.parseUShort(),e=this.parseUShort();return{classes:this.parseUShortList(t-1),lookupRecords:this.parseRecordList(e,qo)}})};if(3===e){var n=this.parseUShort(),i=this.parseUShort();return{substFormat:e,coverages:this.parseList(n,k.pointer(k.coverage)),lookupRecords:this.parseRecordList(i,qo)}}oo.assert(!1,"0x"+t.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},Ho[6]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();return 1===e?{substFormat:1,coverage:this.parsePointer(k.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(qo)}})}:2===e?{substFormat:2,coverage:this.parsePointer(k.coverage),backtrackClassDef:this.parsePointer(k.classDef),inputClassDef:this.parsePointer(k.classDef),lookaheadClassDef:this.parsePointer(k.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(qo)}})}:3===e?{substFormat:3,backtrackCoverage:this.parseList(k.pointer(k.coverage)),inputCoverage:this.parseList(k.pointer(k.coverage)),lookaheadCoverage:this.parseList(k.pointer(k.coverage)),lookupRecords:this.parseRecordList(qo)}:void oo.assert(!1,"0x"+t.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},Ho[7]=function(){var t=this.parseUShort();oo.argument(1===t,"GSUB Extension Substitution subtable identifier-format must be 1");var e=this.parseUShort(),n=new k(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:e,extension:Ho[e].call(n)}},Ho[8]=function(){var t=this.parseUShort();return oo.argument(1===t,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(k.coverage),backtrackCoverage:this.parseList(k.pointer(k.coverage)),lookaheadCoverage:this.parseList(k.pointer(k.coverage)),substitutes:this.parseUShortList()}};var Wo=new Array(9);Wo[1]=function(t){return 1===t.substFormat?new go.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new go.Coverage(t.coverage)},{name:"deltaGlyphID",type:"USHORT",value:t.deltaGlyphId}]):new go.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new go.Coverage(t.coverage)}].concat(go.ushortList("substitute",t.substitute)))},Wo[3]=function(t){return oo.assert(1===t.substFormat,"Lookup type 3 substFormat must be 1."),new go.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new go.Coverage(t.coverage)}].concat(go.tableList("altSet",t.alternateSets,function(t){return new go.Table("alternateSetTable",go.ushortList("alternate",t))})))},Wo[4]=function(t){return oo.assert(1===t.substFormat,"Lookup type 4 substFormat must be 1."),new go.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new go.Coverage(t.coverage)}].concat(go.tableList("ligSet",t.ligatureSets,function(t){return new go.Table("ligatureSetTable",go.tableList("ligature",t,function(t){return new go.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:t.ligGlyph}].concat(go.ushortList("component",t.components,t.components.length+1)))}))})))};var Yo={parse:oe,make:se},$o={parse:ae,make:ue},Zo={make:de,fontToTable:ge,computeCheckSum:ce};_e.prototype={searchTag:me,binSearch:xe,getTable:function(t){var e=this.font.tables[this.tableName];return!e&&t&&(e=this.font.tables[this.tableName]=this.createDefaultTable()),e},getScriptNames:function(){var t=this.getTable();return t?t.scripts.map(function(t){return t.tag}):[]},getDefaultScriptName:function(){var t=this.getTable();if(t){for(var e=!1,n=0;n<t.scripts.length;n++){var i=t.scripts[n].tag;if("DFLT"===i)return i;"latn"===i&&(e=!0)}return e?"latn":void 0}},getScriptTable:function(t,e){var n=this.getTable(e);if(n){t=t||"DFLT";var i=n.scripts,r=me(n.scripts,t);if(r>=0)return i[r].script;if(e){var o={tag:t,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return i.splice(-1-r,0,o),o.script}}},getLangSysTable:function(t,e,n){var i=this.getScriptTable(t,n);if(i){if(!e||"dflt"===e||"DFLT"===e)return i.defaultLangSys;var r=me(i.langSysRecords,e);if(r>=0)return i.langSysRecords[r].langSys;if(n){var o={tag:e,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return i.langSysRecords.splice(-1-r,0,o),o.langSys}}},getFeatureTable:function(t,e,n,i){var r=this.getLangSysTable(t,e,i);if(r){for(var o,s=r.featureIndexes,a=this.font.tables[this.tableName].features,u=0;u<s.length;u++)if(o=a[s[u]],o.tag===n)return o.feature;if(i){var l=a.length;return oo.assert(0===l||n>=a[l-1].tag,"Features must be added in alphabetical order."),o={tag:n,feature:{params:0,lookupListIndexes:[]}},a.push(o),s.push(l),o.feature}}},getLookupTables:function(t,e,n,i,r){var o=this.getFeatureTable(t,e,n,r),s=[];if(o){for(var a,u=o.lookupListIndexes,l=this.font.tables[this.tableName].lookups,c=0;c<u.length;c++)a=l[u[c]],a.lookupType===i&&s.push(a);if(0===s.length&&r){a={lookupType:i,lookupFlag:0,subtables:[],markFilteringSet:void 0};var h=l.length;return l.push(a),u.push(h),[a]}}return s},getGlyphClass:function(t,e){switch(t.format){case 1:return t.startGlyph<=e&&e<t.startGlyph+t.classes.length?t.classes[e-t.startGlyph]:0;case 2:var n=ve(t.ranges,e);return n?n.classId:0}},getCoverageIndex:function(t,e){switch(t.format){case 1:var n=xe(t.glyphs,e);return n>=0?n:-1;case 2:var i=ve(t.ranges,e);return i?i.index+e-i.start:-1}},expandCoverage:function(t){if(1===t.format)return t.glyphs
;for(var e=[],n=t.ranges,i=0;i<n.length;i++)for(var r=n[i],o=r.start,s=r.end,a=o;a<=s;a++)e.push(a);return e}},ye.prototype=_e.prototype,ye.prototype.init=function(){var t=this.getDefaultScriptName();this.defaultKerningTables=this.getKerningTables(t)},ye.prototype.getKerningValue=function(t,e,n){for(var i=this,r=0;r<t.length;r++)for(var o=t[r].subtables,s=0;s<o.length;s++){var a=o[s],u=i.getCoverageIndex(a.coverage,e);if(!(u<0))switch(a.posFormat){case 1:for(var l=a.pairSets[u],c=0;c<l.length;c++){var h=l[c];if(h.secondGlyph===n)return h.value1&&h.value1.xAdvance||0}break;case 2:var d=i.getGlyphClass(a.classDef1,e),p=i.getGlyphClass(a.classDef2,n),f=a.classRecords[d][p];return f.value1&&f.value1.xAdvance||0}}return 0},ye.prototype.getKerningTables=function(t,e){if(this.font.tables.gpos)return this.getLookupTables(t,e,"kern",2)},we.prototype=_e.prototype,we.prototype.createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}},we.prototype.getSingle=function(t,e,n){for(var i=this,r=[],o=this.getLookupTables(e,n,t,1),s=0;s<o.length;s++)for(var a=o[s].subtables,u=0;u<a.length;u++){var l=a[u],c=i.expandCoverage(l.coverage),h=void 0;if(1===l.substFormat){var d=l.deltaGlyphId;for(h=0;h<c.length;h++){var p=c[h];r.push({sub:p,by:p+d})}}else{var f=l.substitute;for(h=0;h<c.length;h++)r.push({sub:c[h],by:f[h]})}}return r},we.prototype.getAlternates=function(t,e,n){for(var i=this,r=[],o=this.getLookupTables(e,n,t,3),s=0;s<o.length;s++)for(var a=o[s].subtables,u=0;u<a.length;u++)for(var l=a[u],c=i.expandCoverage(l.coverage),h=l.alternateSets,d=0;d<c.length;d++)r.push({sub:c[d],by:h[d]});return r},we.prototype.getLigatures=function(t,e,n){for(var i=this,r=[],o=this.getLookupTables(e,n,t,4),s=0;s<o.length;s++)for(var a=o[s].subtables,u=0;u<a.length;u++)for(var l=a[u],c=i.expandCoverage(l.coverage),h=l.ligatureSets,d=0;d<c.length;d++)for(var p=c[d],f=h[d],g=0;g<f.length;g++){var m=f[g];r.push({sub:[p].concat(m.components),by:m.ligGlyph})}return r},we.prototype.addSingle=function(t,e,n,i){var r=this.getLookupTables(n,i,t,1,!0)[0],o=Se(r,2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});oo.assert(1===o.coverage.format,"Ligature: unable to modify coverage table format "+o.coverage.format);var s=e.sub,a=this.binSearch(o.coverage.glyphs,s);a<0&&(a=-1-a,o.coverage.glyphs.splice(a,0,s),o.substitute.splice(a,0,0)),o.substitute[a]=e.by},we.prototype.addAlternate=function(t,e,n,i){var r=this.getLookupTables(n,i,t,3,!0)[0],o=Se(r,1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});oo.assert(1===o.coverage.format,"Ligature: unable to modify coverage table format "+o.coverage.format);var s=e.sub,a=this.binSearch(o.coverage.glyphs,s);a<0&&(a=-1-a,o.coverage.glyphs.splice(a,0,s),o.alternateSets.splice(a,0,0)),o.alternateSets[a]=e.by},we.prototype.addLigature=function(t,e,n,i){var r=this.getLookupTables(n,i,t,4,!0)[0],o=r.subtables[0];o||(o={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]},r.subtables[0]=o),oo.assert(1===o.coverage.format,"Ligature: unable to modify coverage table format "+o.coverage.format);var s=e.sub[0],a=e.sub.slice(1),u={ligGlyph:e.by,components:a},l=this.binSearch(o.coverage.glyphs,s);if(l>=0){for(var c=o.ligatureSets[l],h=0;h<c.length;h++)if(be(c[h].components,a))return;c.push(u)}else l=-1-l,o.coverage.glyphs.splice(l,0,s),o.ligatureSets.splice(l,0,[u])},we.prototype.getFeature=function(t,e,n){if(/ss\d\d/.test(t))return this.getSingle(t,e,n);switch(t){case"aalt":case"salt":return this.getSingle(t,e,n).concat(this.getAlternates(t,e,n));case"dlig":case"liga":case"rlig":return this.getLigatures(t,e,n)}},we.prototype.add=function(t,e,n,i){if(/ss\d\d/.test(t))return this.addSingle(t,e,n,i);switch(t){case"aalt":case"salt":return"number"==typeof e.by?this.addSingle(t,e,n,i):this.addAlternate(t,e,n,i);case"dlig":case"liga":case"rlig":return this.addLigature(t,e,n,i)}};var Qo,Ko,Jo,ts,es={getPath:Ve,parse:Be},ns=function(t){var e=this.srPeriod,n=this.srPhase,i=this.srThreshold,r=1;return t<0&&(t=-t,r=-1),t+=i-n,t=Math.trunc(t/e)*e,t+=n,t<0?n*r:t*r},is={x:1,y:0,axis:"x",distance:function(t,e,n,i){return(n?t.xo:t.x)-(i?e.xo:e.x)},interpolate:function(t,e,n,i){var r,o,s,a,u,l,c;return i&&i!==this?(r=i.distance(t,e,!0,!0),o=i.distance(t,n,!0,!0),u=i.distance(e,e,!1,!0),l=i.distance(n,n,!1,!0),s=Math.abs(r),a=Math.abs(o),0===(c=s+a)?void is.setRelative(t,t,(u+l)/2,i,!0):void is.setRelative(t,t,(u*a+l*s)/c,i,!0)):(r=t.xo-e.xo,o=t.xo-n.xo,u=e.x-e.xo,l=n.x-n.xo,s=Math.abs(r),a=Math.abs(o),0===(c=s+a)?void(t.x=t.xo+(u+l)/2):void(t.x=t.xo+(u*a+l*s)/c))},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(t,e,n,i,r){if(!i||i===this)return void(t.x=(r?e.xo:e.x)+n);var o=r?e.xo:e.x,s=r?e.yo:e.y,a=o+n*i.x,u=s+n*i.y;t.x=a+(t.y-u)/i.normalSlope},slope:0,touch:function(t){t.xTouched=!0},touched:function(t){return t.xTouched},untouch:function(t){t.xTouched=!1}},rs={x:0,y:1,axis:"y",distance:function(t,e,n,i){return(n?t.yo:t.y)-(i?e.yo:e.y)},interpolate:function(t,e,n,i){var r,o,s,a,u,l,c;return i&&i!==this?(r=i.distance(t,e,!0,!0),o=i.distance(t,n,!0,!0),u=i.distance(e,e,!1,!0),l=i.distance(n,n,!1,!0),s=Math.abs(r),a=Math.abs(o),0===(c=s+a)?void rs.setRelative(t,t,(u+l)/2,i,!0):void rs.setRelative(t,t,(u*a+l*s)/c,i,!0)):(r=t.yo-e.yo,o=t.yo-n.yo,u=e.y-e.yo,l=n.y-n.yo,s=Math.abs(r),a=Math.abs(o),0===(c=s+a)?void(t.y=t.yo+(u+l)/2):void(t.y=t.yo+(u*a+l*s)/c))},normalSlope:0,setRelative:function(t,e,n,i,r){if(!i||i===this)return void(t.y=(r?e.yo:e.y)+n);var o=r?e.xo:e.x,s=r?e.yo:e.y,a=o+n*i.x,u=s+n*i.y;t.y=u+i.normalSlope*(t.x-a)},slope:Number.POSITIVE_INFINITY,touch:function(t){t.yTouched=!0},touched:function(t){return t.yTouched},untouch:function(t){t.yTouched=!1}};Object.freeze(is),Object.freeze(rs),Xe.prototype.distance=function(t,e,n,i){return this.x*is.distance(t,e,n,i)+this.y*rs.distance(t,e,n,i)},Xe.prototype.interpolate=function(t,e,n,i){var r,o,s,a,u,l,c;if(s=i.distance(t,e,!0,!0),a=i.distance(t,n,!0,!0),r=i.distance(e,e,!1,!0),o=i.distance(n,n,!1,!0),u=Math.abs(s),l=Math.abs(a),0===(c=u+l))return void this.setRelative(t,t,(r+o)/2,i,!0);this.setRelative(t,t,(r*l+o*u)/c,i,!0)},Xe.prototype.setRelative=function(t,e,n,i,r){i=i||this;var o=r?e.xo:e.x,s=r?e.yo:e.y,a=o+n*i.x,u=s+n*i.y,l=i.normalSlope,c=this.slope,h=t.x,d=t.y;t.x=(c*h-l*a+u-d)/(c-l),t.y=c*(t.x-h)+d},Xe.prototype.touch=function(t){t.xTouched=!0,t.yTouched=!0},Ge.prototype.nextTouched=function(t){for(var e=this.nextPointOnContour;!t.touched(e)&&e!==this;)e=e.nextPointOnContour;return e},Ge.prototype.prevTouched=function(t){for(var e=this.prevPointOnContour;!t.touched(e)&&e!==this;)e=e.prevPointOnContour;return e};var os=Object.freeze(new Ge(0,0)),ss={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};Le.prototype.exec=function(e,n){if("number"!=typeof n)throw new Error("Point size is not a number!");if(!(this._errorState>2)){var i=this.font,r=this._prepState;if(!r||r.ppem!==n){var o=this._fpgmState;if(!o){He.prototype=ss,o=this._fpgmState=new He("fpgm",i.tables.fpgm),o.funcs=[],o.font=i,t.DEBUG&&(console.log("---EXEC FPGM---"),o.step=-1);try{Ko(o)}catch(t){return console.log("Hinting error in FPGM:"+t),void(this._errorState=3)}}He.prototype=o,r=this._prepState=new He("prep",i.tables.prep),r.ppem=n;var s=i.tables.cvt;if(s)for(var a=r.cvt=new Array(s.length),u=n/i.unitsPerEm,l=0;l<s.length;l++)a[l]=s[l]*u;else r.cvt=[];t.DEBUG&&(console.log("---EXEC PREP---"),r.step=-1);try{Ko(r)}catch(t){this._errorState<2&&console.log("Hinting error in PREP:"+t),this._errorState=2}}if(!(this._errorState>1))try{return Jo(e,r)}catch(t){return this._errorState<1&&(console.log("Hinting error:"+t),console.log("Note: further hinting errors are silenced")),void(this._errorState=1)}}},Jo=function(e,n){var i,r,o,s=n.ppem/n.font.unitsPerEm,a=s,u=e.components;if(He.prototype=n,u){var l=n.font;r=[],i=[];for(var c=0;c<u.length;c++){var h=u[c],d=l.glyphs.get(h.glyphIndex);o=new He("glyf",d.instructions),t.DEBUG&&(console.log("---EXEC COMP "+c+"---"),o.step=-1),ts(d,o,s,a);for(var p=Math.round(h.dx*s),f=Math.round(h.dy*a),g=o.gZone,m=o.contours,x=0;x<g.length;x++){var v=g[x];v.xTouched=v.yTouched=!1,v.xo=v.x=v.x+p,v.yo=v.y=v.y+f}var _=r.length;r.push.apply(r,g);for(var y=0;y<m.length;y++)i.push(m[y]+_)}e.instructions&&!o.inhibitGridFit&&(o=new He("glyf",e.instructions),o.gZone=o.z0=o.z1=o.z2=r,o.contours=i,r.push(new Ge(0,0),new Ge(Math.round(e.advanceWidth*s),0)),t.DEBUG&&(console.log("---EXEC COMPOSITE---"),o.step=-1),Ko(o),r.length-=2)}else o=new He("glyf",e.instructions),t.DEBUG&&(console.log("---EXEC GLYPH---"),o.step=-1),ts(e,o,s,a),r=o.gZone;return r},ts=function(e,n,i,r){for(var o,s=e.points||[],a=s.length,u=n.gZone=n.z0=n.z1=n.z2=[],l=n.contours=[],c=0;c<a;c++)o=s[c],u[c]=new Ge(o.x*i,o.y*r,o.lastPointOfContour,o.onCurve);for(var h,d,p=0;p<a;p++)o=u[p],h||(h=o,l.push(p)),o.lastPointOfContour?(o.nextPointOnContour=h,h.prevPointOnContour=o,h=void 0):(d=u[p+1],o.nextPointOnContour=d,d.prevPointOnContour=o);if(!n.inhibitGridFit){if(t.DEBUG){console.log("PROCESSING GLYPH",n.stack);for(var f=0;f<a;f++)console.log(f,u[f].x,u[f].y)}if(u.push(new Ge(0,0),new Ge(Math.round(e.advanceWidth*i),0)),Ko(n),u.length-=2,t.DEBUG){console.log("FINISHED GLYPH",n.stack);for(var g=0;g<a;g++)console.log(g,u[g].x,u[g].y)}}},Ko=function(e){var n=e.prog;if(n){var i,r=n.length;for(e.ip=0;e.ip<r;e.ip++){if(t.DEBUG&&e.step++,!(i=Qo[n[e.ip]]))throw new Error("unknown instruction: 0x"+Number(n[e.ip]).toString(16));i(e)}}},Qo=[Ye.bind(void 0,rs),Ye.bind(void 0,is),$e.bind(void 0,rs),$e.bind(void 0,is),Ze.bind(void 0,rs),Ze.bind(void 0,is),Qe.bind(void 0,0),Qe.bind(void 0,1),Ke.bind(void 0,0),Ke.bind(void 0,1),Je,tn,en,nn,rn,on,sn,an,un,ln,cn,hn,dn,pn,fn,gn,mn,xn,vn,_n,void 0,void 0,yn,wn,bn,Sn,Cn,On,Nn,void 0,void 0,void 0,Tn,Fn,En,void 0,Mn.bind(void 0,0),Mn.bind(void 0,1),Dn.bind(void 0,rs),Dn.bind(void 0,is),Vn.bind(void 0,0),Vn.bind(void 0,1),In.bind(void 0,0),In.bind(void 0,1),Bn.bind(void 0,0),Bn.bind(void 0,1),Ln,An,Pn.bind(void 0,0),Pn.bind(void 0,1),Rn,kn,Un.bind(void 0,0),Un.bind(void 0,1),zn,Xn,jn,Gn,Hn,qn,Wn.bind(void 0,0),Wn.bind(void 0,1),void 0,Yn.bind(void 0,0),Yn.bind(void 0,1),$n,void 0,Zn,void 0,void 0,Qn,Kn,Jn,ti,ei,ni,ii,ri,oi,si,ai,ui,li,ci.bind(void 0,1),hi,di,pi,fi,gi,mi,xi,vi,_i,yi,wi.bind(void 0,0),wi.bind(void 0,1),wi.bind(void 0,2),wi.bind(void 0,3),void 0,void 0,void 0,void 0,bi,ci.bind(void 0,2),ci.bind(void 0,3),Si.bind(void 0,1),Si.bind(void 0,2),Si.bind(void 0,3),Ci,Ti,void 0,void 0,Fi,void 0,Oi,Ni,wn,wn,void 0,void 0,void 0,void 0,void 0,Ei,Mi.bind(void 0,0),Mi.bind(void 0,1),Di,void 0,Vi,Ii,Bi,Li,Ai,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,Pi.bind(void 0,1),Pi.bind(void 0,2),Pi.bind(void 0,3),Pi.bind(void 0,4),Pi.bind(void 0,5),Pi.bind(void 0,6),Pi.bind(void 0,7),Pi.bind(void 0,8),Ri.bind(void 0,1),Ri.bind(void 0,2),Ri.bind(void 0,3),Ri.bind(void 0,4),Ri.bind(void 0,5),Ri.bind(void 0,6),Ri.bind(void 0,7),Ri.bind(void 0,8),ki.bind(void 0,0,0,0,0,0),ki.bind(void 0,0,0,0,0,1),ki.bind(void 0,0,0,0,0,2),ki.bind(void 0,0,0,0,0,3),ki.bind(void 0,0,0,0,1,0),ki.bind(void 0,0,0,0,1,1),ki.bind(void 0,0,0,0,1,2),ki.bind(void 0,0,0,0,1,3),ki.bind(void 0,0,0,1,0,0),ki.bind(void 0,0,0,1,0,1),ki.bind(void 0,0,0,1,0,2),ki.bind(void 0,0,0,1,0,3),ki.bind(void 0,0,0,1,1,0),ki.bind(void 0,0,0,1,1,1),ki.bind(void 0,0,0,1,1,2),ki.bind(void 0,0,0,1,1,3),ki.bind(void 0,0,1,0,0,0),ki.bind(void 0,0,1,0,0,1),ki.bind(void 0,0,1,0,0,2),ki.bind(void 0,0,1,0,0,3),ki.bind(void 0,0,1,0,1,0),ki.bind(void 0,0,1,0,1,1),ki.bind(void 0,0,1,0,1,2),ki.bind(void 0,0,1,0,1,3),ki.bind(void 0,0,1,1,0,0),ki.bind(void 0,0,1,1,0,1),ki.bind(void 0,0,1,1,0,2),ki.bind(void 0,0,1,1,0,3),ki.bind(void 0,0,1,1,1,0),ki.bind(void 0,0,1,1,1,1),ki.bind(void 0,0,1,1,1,2),ki.bind(void 0,0,1,1,1,3),ki.bind(void 0,1,0,0,0,0),ki.bind(void 0,1,0,0,0,1),ki.bind(void 0,1,0,0,0,2),ki.bind(void 0,1,0,0,0,3),ki.bind(void 0,1,0,0,1,0),ki.bind(void 0,1,0,0,1,1),ki.bind(void 0,1,0,0,1,2),ki.bind(void 0,1,0,0,1,3),ki.bind(void 0,1,0,1,0,0),ki.bind(void 0,1,0,1,0,1),ki.bind(void 0,1,0,1,0,2),ki.bind(void 0,1,0,1,0,3),ki.bind(void 0,1,0,1,1,0),ki.bind(void 0,1,0,1,1,1),ki.bind(void 0,1,0,1,1,2),ki.bind(void 0,1,0,1,1,3),ki.bind(void 0,1,1,0,0,0),ki.bind(void 0,1,1,0,0,1),ki.bind(void 0,1,1,0,0,2),ki.bind(void 0,1,1,0,0,3),ki.bind(void 0,1,1,0,1,0),ki.bind(void 0,1,1,0,1,1),ki.bind(void 0,1,1,0,1,2),ki.bind(void 0,1,1,0,1,3),ki.bind(void 0,1,1,1,0,0),ki.bind(void 0,1,1,1,0,1),ki.bind(void 0,1,1,1,0,2),ki.bind(void 0,1,1,1,0,3),ki.bind(void 0,1,1,1,1,0),ki.bind(void 0,1,1,1,1,1),ki.bind(void 0,1,1,1,1,2),ki.bind(void 0,1,1,1,1,3)],Ui.prototype.setState=function(t,e){return this.state[t]=e,this.activeState={key:t,value:this.state[t]},this.activeState},Ui.prototype.getState=function(t){return this.state[t]||null},qi.prototype.inboundIndex=function(t){return t>=0&&t<this.tokens.length},qi.prototype.composeRUD=function(t){var e=this,n=t.map(function(t){return e[t[0]].apply(e,t.slice(1).concat(!0))}),i=function(t){return"object"==typeof t&&t.hasOwnProperty("FAIL")};if(n.every(i))return{FAIL:"composeRUD: one or more operations hasn't completed successfully",report:n.filter(i)};this.dispatch("composeRUD",[n.filter(function(t){return!i(t)})])},qi.prototype.replaceRange=function(t,e,n,i){e=null!==e?e:this.tokens.length;var r=n.every(function(t){return t instanceof Ui});if(!isNaN(t)&&this.inboundIndex(t)&&r){var o=this.tokens.splice.apply(this.tokens,[t,e].concat(n));return i||this.dispatch("replaceToken",[t,e,n]),[o,n]}return{FAIL:"replaceRange: invalid tokens or startIndex."}},qi.prototype.replaceToken=function(t,e,n){if(!isNaN(t)&&this.inboundIndex(t)&&e instanceof Ui){var i=this.tokens.splice(t,1,e);return n||this.dispatch("replaceToken",[t,e]),[i[0],e]}return{FAIL:"replaceToken: invalid token or index."}},qi.prototype.removeRange=function(t,e,n){e=isNaN(e)?this.tokens.length:e;var i=this.tokens.splice(t,e);return n||this.dispatch("removeRange",[i,t,e]),i},qi.prototype.removeToken=function(t,e){if(!isNaN(t)&&this.inboundIndex(t)){var n=this.tokens.splice(t,1);return e||this.dispatch("removeToken",[n,t]),n}return{FAIL:"removeToken: invalid token index."}},qi.prototype.insertToken=function(t,e,n){return t.every(function(t){return t instanceof Ui})?(this.tokens.splice.apply(this.tokens,[e,0].concat(t)),n||this.dispatch("insertToken",[t,e]),t):{FAIL:"insertToken: invalid token(s)."}},qi.prototype.registerModifier=function(t,e,n){this.events.newToken.subscribe(function(i,r){var o=[i,r],s=null===e||e.apply(this,o)===!0,a=[i,r];if(s){var u=n.apply(this,a);i.setState(t,u)}}),this.registeredModifiers.push(t)},Gi.prototype.subscribe=function(t){return"function"==typeof t?this.subscribers.push(t)-1:{FAIL:"invalid '"+this.eventId+"' event handler"}},Gi.prototype.unsubscribe=function(t){this.subscribers.splice(t,1)},ji.prototype.setCurrentIndex=function(t){this.index=t,this.current=this.context[t],this.backtrack=this.context.slice(0,t),this.lookahead=this.context.slice(t+1)},ji.prototype.get=function(t){switch(!0){case 0===t:return this.current;case t<0&&Math.abs(t)<=this.backtrack.length:return this.backtrack.slice(t)[0];case t>0&&t<=this.lookahead.length:return this.lookahead[t-1];default:return null}},qi.prototype.rangeToText=function(t){if(t instanceof zi)return this.getRangeTokens(t).map(function(t){return t.char}).join("")},qi.prototype.getText=function(){return this.tokens.map(function(t){return t.char}).join("")},qi.prototype.getContext=function(t){var e=this.registeredContexts[t];return e?e:null},qi.prototype.on=function(t,e){var n=this.events[t];return n?n.subscribe(e):null},qi.prototype.dispatch=function(t,e){var n=this,i=this.events[t];i instanceof Gi&&i.subscribers.forEach(function(t){t.apply(n,e||[])})},qi.prototype.registerContextChecker=function(t,e,n){if(this.getContext(t))return{FAIL:"context name '"+t+"' is already registered."};if("function"!=typeof e)return{FAIL:"missing context start check."};if("function"!=typeof n)return{FAIL:"missing context end check."};var i=new Xi(t,e,n);return this.registeredContexts[t]=i,this.contextCheckers.push(i),i},qi.prototype.getRangeTokens=function(t){var e=t.startIndex+t.endOffset;return[].concat(this.tokens.slice(t.startIndex,e))},qi.prototype.getContextRanges=function(t){var e=this.getContext(t);return e?e.ranges:{FAIL:"context checker '"+t+"' is not registered."}},qi.prototype.resetContextsRanges=function(){var t=this.registeredContexts;for(var e in t)if(t.hasOwnProperty(e)){var n=t[e];n.ranges=[]}},qi.prototype.updateContextsRanges=function(){var t=this;this.resetContextsRanges();for(var e=this.tokens.map(function(t){return t.char}),n=0;n<e.length;n++){var i=new ji(e,n);t.runContextCheck(i)}this.dispatch("updateContextsRanges",[this.registeredContexts])},qi.prototype.setEndOffset=function(t,e){var n=this.getContext(e).openRange.startIndex,i=new zi(n,t,e),r=this.getContext(e).ranges;return i.rangeId=e+"."+r.length,r.push(i),this.getContext(e).openRange=null,i},qi.prototype.runContextCheck=function(t){var e=this,n=t.index;this.contextCheckers.forEach(function(i){var r=i.contextName,o=e.getContext(r).openRange;if(!o&&i.checkStart(t)&&(o=new zi(n,null,r),e.getContext(r).openRange=o,e.dispatch("contextStart",[r,n])),o&&i.checkEnd(t)){var s=n-o.startIndex+1,a=e.setEndOffset(s,r);e.dispatch("contextEnd",[r,a])}})},qi.prototype.tokenize=function(t){var e=this;this.tokens=[],this.resetContextsRanges();var n=Array.from(t);this.dispatch("start");for(var i=0;i<n.length;i++){var r=n[i],o=new ji(n,i);e.dispatch("next",[o]),e.runContextCheck(o);var s=new Ui(r);e.tokens.push(s),e.dispatch("newToken",[s,o])}return this.dispatch("end",[this.tokens]),this.tokens};var as={arabicWordStartCheck:Qi,arabicWordEndCheck:Ki},us={arabicSentenceStartCheck:Ji,arabicSentenceEndCheck:tr};or.prototype.setText=function(t){this.text=t},or.prototype.contextChecks={arabicWordCheck:as,arabicSentenceCheck:us},or.prototype.subscribeArabicForms=function(t){var e=this;this.tokenizer.events.contextEnd.subscribe(function(n,i){if("arabicWord"===n)return ir.call(e.tokenizer,i,t)})},or.prototype.applyFeatures=function(t){for(var e=this,n=0;n<t.length;n++){var i=t[n];if(i){var r=i.script;e.features[r]||(e.features[r]={}),e.features[r][i.tag]=i}}},or.prototype.registerModifier=function(t,e,n){this.tokenizer.registerModifier(t,e,n)},or.prototype.processText=function(t){this.text&&this.text===t||(this.setText(t),ur.call(this),hr.call(this),dr.call(this),lr.call(this))},or.prototype.getBidiText=function(t){return this.processText(t),this.tokenizer.getText()},or.prototype.getTextGlyphs=function(t){var e=this;this.processText(t);for(var n=[],i=0;i<this.tokenizer.tokens.length;i++){var r=e.tokenizer.tokens[i];if(!r.state.deleted){var o=r.activeState.value;n.push(Array.isArray(o)?o[0]:o)}}return n};var ls="ltr";mr.prototype.lookup=function(t,e){for(var n=this.ligatureSets[e],i=0;i<n.length;i++){var r=n[i],o=t.lookahead.map(function(t){return t.activeState.value});"rtl"===ls&&o.reverse();if(function(t,e){if(t.length>e.length)return null;for(var n=0;n<t.length;n++){if(t[n]!==e[n])return!1}return!0}(r.components,o))return r}return null},vr.prototype.lookup=function(t){for(var e=this,n=[],i=0;i<this.subtables.length;i++){var r=e.subtables[i],o=r.lookup(t);(null!==o||o.length)&&(n=n.concat(o))}return n},xr.prototype.lookup=function(t){var e=[],n=this.lookupTable.lookupType,i=this.subtable.substFormat;if(1===n&&2===i){var r=yr.call(this,t);r.length>0&&e.push({id:12,substitution:r})}if(6===n&&3===i){var o=br.call(this,t);o.length>0&&e.push({id:63,substitution:o})}if(4===n&&1===i){var s=Sr.call(this,t);s.length>0&&e.push({id:41,substitution:s})}return e},gr.prototype.lookup=function(t){if(!t)return-1;switch(this.table.format){case 1:return this.table.glyphs.indexOf(t);case 2:for(var e=this.table.ranges,n=0;n<e.length;n++){var i=e[n];if(t>=i.start&&t<=i.end){var r=t-i.start;return i.index+r}}break;default:return-1}return-1},fr.prototype.lookup=function(t){for(var e=this,n=[],i=0;i<this.lookups.length;i++){var r=e.lookups[i],o=r.lookup(t);(null!==o||o.length)&&(n=n.concat(o))}return n},pr.prototype.getScriptFeaturesIndexes=function(t){if(!t)return[];if(!this.font.tables.gsub)return[];for(var e=this.font.tables.gsub.scripts,n=0;n<e.length;n++){var i=e[n];if(i.tag===t){return i.script.defaultLangSys.featureIndexes}var r=i.langSysRecords;if(r)for(var o=0;o<r.length;o++){var s=r[o];if(s.tag===t){var a=s.langSys;return a.featureIndexes}}}return[]},pr.prototype.mapTagsToFeatures=function(t,e){for(var n=this,i={},r=0;r<t.length;r++){var o=t[r].feature,s=t[r].tag,a=n.font.tables.gsub.lookups,u=new _r(a,o.lookupListIndexes);i[s]=new fr(s,o,u,e)}this.features[e].tags=i},pr.prototype.getScriptFeatures=function(t){var e=this.features[t];if(this.features.hasOwnProperty(t))return e;var n=this.getScriptFeaturesIndexes(t);if(!n)return null;var i=this.font.tables.gsub;return e=n.map(function(t){return i.features[t]}),this.features[t]=e,this.mapTagsToFeatures(e,t),e},pr.prototype.getFeature=function(t){return this.font?(this.features.hasOwnProperty(t.script)||this.getScriptFeatures(t.script),this.features[t.script].tags[t.tag]||null):{FAIL:"No font was found"}},Cr.prototype.hasChar=function(t){return null!==this.encoding.charToGlyphIndex(t)},Cr.prototype.charToGlyphIndex=function(t){return this.encoding.charToGlyphIndex(t)},Cr.prototype.charToGlyph=function(t){var e=this.charToGlyphIndex(t),n=this.glyphs.get(e);return n||(n=this.glyphs.get(0)),n},Cr.prototype.stringToGlyphs=function(t,e){var n=this;e=e||this.defaultRenderOptions;var i=new or,r=function(t){return n.charToGlyphIndex(t.char)};i.registerModifier("glyphIndex",null,r);var o=new pr(this),s=["init","medi","fina","rlig"];i.applyFeatures(s.map(function(t){var e={tag:t,script:"arab"},n=o.getFeature(e);if(n)return n}));var a=i.getTextGlyphs(t),u=a.length;if(e.features){var l=e.script||this.substitution.getDefaultScriptName(),c=[];e.features.liga&&(c=c.concat(this.substitution.getFeature("liga",l,e.language))),e.features.rlig&&(c=c.concat(this.substitution.getFeature("rlig",l,e.language)));for(var h=0;h<u;h+=1)for(var d=0;d<c.length;d++){for(var p=c[d],f=p.sub,g=f.length,m=0;m<g&&f[m]===a[h+m];)m++;m===g&&(a.splice(h,g,p.by),u=u-g+1)}}for(var x=new Array(u),v=this.glyphs.get(0),_=0;_<u;_+=1)x[_]=n.glyphs.get(a[_])||v;return x},Cr.prototype.nameToGlyphIndex=function(t){return this.glyphNames.nameToGlyphIndex(t)},Cr.prototype.nameToGlyph=function(t){var e=this.nameToGlyphIndex(t),n=this.glyphs.get(e);return n||(n=this.glyphs.get(0)),n},Cr.prototype.glyphIndexToName=function(t){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(t):""},Cr.prototype.getKerningValue=function(t,e){t=t.index||t,e=e.index||e;var n=this.position.defaultKerningTables;return n?this.position.getKerningValue(n,t,e):this.kerningPairs[t+","+e]||0},Cr.prototype.defaultRenderOptions={kerning:!0,features:{liga:!0,rlig:!0}},Cr.prototype.forEachGlyph=function(t,e,n,i,r,o){var s=this;e=void 0!==e?e:0,n=void 0!==n?n:0,i=void 0!==i?i:72,r=r||this.defaultRenderOptions;var a,u=1/this.unitsPerEm*i,l=this.stringToGlyphs(t,r);if(r.kerning){var c=r.script||this.position.getDefaultScriptName();a=this.position.getKerningTables(c,r.language)}for(var h=0;h<l.length;h+=1){var d=l[h];if(o.call(s,d,e,n,i,r),d.advanceWidth&&(e+=d.advanceWidth*u),r.kerning&&h<l.length-1){e+=(a?s.position.getKerningValue(a,d.index,l[h+1].index):s.getKerningValue(d,l[h+1]))*u}r.letterSpacing?e+=r.letterSpacing*i:r.tracking&&(e+=r.tracking/1e3*i)}return e},Cr.prototype.getPath=function(t,e,n,i,r){var o=new f;return this.forEachGlyph(t,e,n,i,r,function(t,e,n,i){var s=t.getPath(e,n,i,r,this);o.extend(s)}),o},Cr.prototype.getPaths=function(t,e,n,i,r){var o=[];return this.forEachGlyph(t,e,n,i,r,function(t,e,n,i){var s=t.getPath(e,n,i,r,this);o.push(s)}),o},Cr.prototype.getAdvanceWidth=function(t,e,n){return this.forEachGlyph(t,0,0,e,n,function(){})},Cr.prototype.draw=function(t,e,n,i,r,o){this.getPath(e,n,i,r,o).draw(t)},Cr.prototype.drawPoints=function(t,e,n,i,r,o){this.forEachGlyph(e,n,i,r,o,function(e,n,i,r){e.drawPoints(t,n,i,r)})},Cr.prototype.drawMetrics=function(t,e,n,i,r,o){this.forEachGlyph(e,n,i,r,o,function(e,n,i,r){e.drawMetrics(t,n,i,r)})},Cr.prototype.getEnglishName=function(t){var e=this.names[t];if(e)return e.en},Cr.prototype.validate=function(){function t(t,e){}function e(e){var i=n.getEnglishName(e);t(i&&i.trim().length>0,"No English "+e+" specified.")}var n=this;e("fontFamily"),e("weightName"),e("manufacturer"),e("copyright"),e("version"),t(this.unitsPerEm>0,"No unitsPerEm specified.")},Cr.prototype.toTables=function(){return Zo.fontToTable(this)},Cr.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},Cr.prototype.toArrayBuffer=function(){for(var t=this.toTables(),e=t.encode(),n=new ArrayBuffer(e.length),i=new Uint8Array(n),r=0;r<e.length;r++)i[r]=e[r];return n},Cr.prototype.download=function(t){var e=this.getEnglishName("fontFamily"),n=this.getEnglishName("fontSubfamily");t=t||e.replace(/\s/g,"")+"-"+n+".otf";var i=this.toArrayBuffer();if(Ce())if(window.URL=window.URL||window.webkitURL,window.URL){var r=new DataView(i),o=new Blob([r],{type:"font/opentype"}),s=document.createElement("a");s.href=window.URL.createObjectURL(o),s.download=t;var a=document.createEvent("MouseEvents");a.initEvent("click",!0,!1),s.dispatchEvent(a)}else console.warn("Font file could not be downloaded. Try using a different browser.");else{var u=require("fs"),l=Fe(i);u.writeFileSync(t,l)}},Cr.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},Cr.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},Cr.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};var cs={make:Mr,parse:Dr},hs=new Array(10);hs[1]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();return 1===e?{posFormat:1,coverage:this.parsePointer(k.coverage),value:this.parseValueRecord()}:2===e?{posFormat:2,coverage:this.parsePointer(k.coverage),values:this.parseValueRecordList()}:void oo.assert(!1,"0x"+t.toString(16)+": GPOS lookup type 1 format must be 1 or 2.")},hs[2]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();oo.assert(1===e||2===e,"0x"+t.toString(16)+": GPOS lookup type 2 format must be 1 or 2.");var n=this.parsePointer(k.coverage),i=this.parseUShort(),r=this.parseUShort();if(1===e)return{posFormat:e,coverage:n,valueFormat1:i,valueFormat2:r,pairSets:this.parseList(k.pointer(k.list(function(){return{secondGlyph:this.parseUShort(),value1:this.parseValueRecord(i),value2:this.parseValueRecord(r)}})))};if(2===e){var o=this.parsePointer(k.classDef),s=this.parsePointer(k.classDef),a=this.parseUShort(),u=this.parseUShort();return{posFormat:e,coverage:n,valueFormat1:i,valueFormat2:r,classDef1:o,classDef2:s,class1Count:a,class2Count:u,classRecords:this.parseList(a,k.list(u,function(){return{value1:this.parseValueRecord(i),value2:this.parseValueRecord(r)}}))}}},hs[3]=function(){return{error:"GPOS Lookup 3 not supported"}},hs[4]=function(){return{error:"GPOS Lookup 4 not supported"}},hs[5]=function(){return{error:"GPOS Lookup 5 not supported"}},hs[6]=function(){return{error:"GPOS Lookup 6 not supported"}},hs[7]=function(){return{error:"GPOS Lookup 7 not supported"}},hs[8]=function(){return{error:"GPOS Lookup 8 not supported"}},hs[9]=function(){return{error:"GPOS Lookup 9 not supported"}};var ds=new Array(10),ps={parse:Vr,make:Ir},fs={parse:Ar},gs={parse:Pr};t.Font=Cr,t.Glyph=J,t.Path=f,t.BoundingBox=p,t._parse=vo,t.parse=jr,t.load=Gr,t.loadSync=Hr,Object.defineProperty(t,"__esModule",{value:!0})}),define("opentype",["opentype/dist/opentype"],function(t){return t}),define("x_ite/Browser/Text/X3DTextContext",["jquery","x_ite/Components/Text/FontStyle","opentype"],function(t,e,n){"use strict";function i(){this.fontCache=new Map,this.glyphCache=new Map}return i.prototype={initialize:function(){},getDefaultFontStyle:function(){return this.defaultFontStyle?this.defaultFontStyle:(this.defaultFontStyle=new e(this.getPrivateScene()),this.defaultFontStyle.setup(),this.defaultFontStyle)},getFont:function(e){e=e.toString();var i=this.fontCache.get(e);return void 0===i&&(this.fontCache.set(e,i=t.Deferred()),n.load(e,this.setFont.bind(this,i))),i},setFont:function(t,e,n){e?t.reject(e):t.resolve(n)},getGlyph:function(t,e,n){var i=this.glyphCache.get(t);i||this.glyphCache.set(t,i=[]);var r=i[e];r||(r=i[e]=[]);var o=r[n];return o||(o=r[n]={}),o}},i}),define("x_ite/Components/Texturing/X3DTextureTransformNode",["x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4"],function(t,e,n){"use strict";function i(i){t.call(this,i),this.addType(e.X3DTextureTransformNode),this.matrix=new n,this.matrixArray=new Float32Array(this.matrix)}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,setMatrix:function(t){this.matrixArray.set(t)},getMatrix:function(){return this.matrix},setShaderUniforms:function(t,e){for(var n=0,i=e.x3d_MaxTextures;n<i;++n)this.setShaderUniformsToChannel(t,e,n)},setShaderUniformsToChannel:function(t,e,n){t.uniformMatrix4fv(e.x3d_TextureMatrix[n],!1,this.matrixArray)}}),i}),define("x_ite/Components/Texturing/TextureTransform",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Texturing/X3DTextureTransformNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2","standard/Math/Numbers/Matrix3"],function(t,e,n,i,r,o,s){"use strict";function a(t){i.call(this,t),this.addType(r.TextureTransform),this.rotation_.setUnit("angle"),this.matrix3=new s}var u=new o(0,0);return a.prototype=Object.assign(Object.create(i.prototype),{constructor:a,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"translation",new t.SFVec2f),new e(r.inputOutput,"rotation",new t.SFFloat),new e(r.inputOutput,"scale",new t.SFVec2f(1,1)),new e(r.inputOutput,"center",new t.SFVec2f)]),getTypeName:function(){return"TextureTransform"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"textureTransform"},initialize:function(){i.prototype.initialize.call(this),this.addInterest("eventsProcessed",this),this.eventsProcessed()},eventsProcessed:function(){var t=this.translation_.getValue(),e=this.rotation_.getValue(),n=this.scale_.getValue(),i=this.center_.getValue(),r=this.matrix3;r.identity(),i.equals(o.Zero)||r.translate(u.assign(i).negate()),n.equals(o.One)||r.scale(n),0!==e&&r.rotate(e),i.equals(o.Zero)||r.translate(i),t.equals(o.Zero)||r.translate(t);var s=this.getMatrix();s[0]=r[0],s[1]=r[1],s[4]=r[3],s[5]=r[4],s[12]=r[6],s[13]=r[7],this.setMatrix(s)}}),a}),define("x_ite/Browser/Texturing/X3DTexturingContext",["x_ite/Components/Texturing/TextureProperties","x_ite/Components/Texturing/TextureTransform","x_ite/Components/Texturing/TextureCoordinate"],function(t,e,n){"use strict";function i(){this.combinedTextureUnits=[]}return i.prototype={initialize:function(){var t=this.getBrowser().getContext();this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.maxCombinedTextureUnits=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this.textureMemory=NaN;for(var e=this.combinedTextureUnits,n=1,i=this.maxCombinedTextureUnits;n<i;++n)e.push(n);this.shadowTextureUnit=this.getCombinedTextureUnits().pop(),this.linetypeUnit=this.getCombinedTextureUnits().pop(),this.hatchStyleUnit=this.getCombinedTextureUnits().pop(),
this.texture2DUnits=new Int32Array(this.getMaxTextures());for(var n=0,i=this.getMaxTextures();n<i;++n)this.texture2DUnits[n]=this.getCombinedTextureUnits().pop();var r=new Uint8Array([0,255,255,255]);this.defaultTexture2D=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.defaultTexture2D),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,r),t.activeTexture(t.TEXTURE0+this.shadowTextureUnit),t.bindTexture(t.TEXTURE_2D,this.defaultTexture2D),t.activeTexture(t.TEXTURE0+this.linetypeUnit),t.bindTexture(t.TEXTURE_2D,this.defaultTexture2D),t.activeTexture(t.TEXTURE0+this.hatchStyleUnit),t.bindTexture(t.TEXTURE_2D,this.defaultTexture2D);for(var n=0,i=this.texture2DUnits.length;n<i;++n)t.activeTexture(t.TEXTURE0+this.texture2DUnits[n]),t.bindTexture(t.TEXTURE_2D,this.defaultTexture2D);this.cubeMapTextureUnits=new Int32Array(this.getMaxTextures());for(var n=0,i=this.getMaxTextures();n<i;++n)this.cubeMapTextureUnits[n]=this.getCombinedTextureUnits().pop();this.defaultCubeMapTexture=t.createTexture(),t.bindTexture(t.TEXTURE_CUBE_MAP,this.defaultCubeMapTexture),t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_Z,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,r),t.texImage2D(t.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,r),t.texImage2D(t.TEXTURE_CUBE_MAP_NEGATIVE_X,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,r),t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,r),t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_Y,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,r),t.texImage2D(t.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,r);for(var n=0,i=this.cubeMapTextureUnits.length;n<i;++n)t.activeTexture(t.TEXTURE0+this.cubeMapTextureUnits[n]),t.bindTexture(t.TEXTURE_CUBE_MAP,this.defaultCubeMapTexture);t.activeTexture(t.TEXTURE0)},getMaxTextures:function(){return 2},getMinTextureSize:function(){return 16},getMaxTextureSize:function(){return this.maxTextureSize},getMaxCombinedTextureUnits:function(){return this.maxCombinedTextureUnits},getCombinedTextureUnits:function(){return this.combinedTextureUnits},getTexture2DUnits:function(){return this.texture2DUnits},getCubeMapTextureUnits:function(){return this.cubeMapTextureUnits},getShadowTextureUnit:function(){return this.shadowTextureUnit},getLinetypeUnit:function(){return this.linetypeUnit},getHatchStyleUnit:function(){return this.hatchStyleUnit},getTextureMemory:function(){return this.textureMemory},getDefaultTextureProperties:function(){return this.defaultTextureProperties?this.defaultTextureProperties:(this.defaultTextureProperties=new t(this.getPrivateScene()),this.defaultTextureProperties.magnificationFilter_="NICEST",this.defaultTextureProperties.minificationFilter_="AVG_PIXEL_AVG_MIPMAP",this.defaultTextureProperties.textureCompression_="NICEST",this.defaultTextureProperties.generateMipMaps_=!0,this.defaultTextureProperties.setup(),this.defaultTextureProperties)},getDefaultTextureTransform:function(){return this.defaultTextureTransform?this.defaultTextureTransform:(this.defaultTextureTransform=new e(this.getPrivateScene()),this.defaultTextureTransform.setup(),this.defaultTextureTransform)},getDefaultTextureCoordinate:function(){return this.defaultTextureCoordinate?this.defaultTextureCoordinate:(this.defaultTextureCoordinate=new n(this.getPrivateScene()),this.defaultTextureCoordinate.setup(),this.defaultTextureCoordinate)}},i}),define("x_ite/Browser/Time/X3DTimeContext",["standard/Math/Numbers/Vector3"],function(t){"use strict";function e(){this.currentPosition=new t(0,0,0)}var n=new t(0,0,0);return e.prototype={initialize:function(){this.advanceTime(performance.now())},getCurrentTime:function(){return this.currentTime},advanceTime:function(t){t=(t+performance.timing.navigationStart)/1e3;var e=t-this.currentTime;if(this.currentTime=t,this.currentFrameRate=e?1/e:60,this.getWorld()&&this.getActiveLayer()){var i=this.getActiveLayer().getViewpoint().getCameraSpaceMatrix();n.assign(this.currentPosition),this.currentPosition.set(i[12],i[13],i[14]),this.currentSpeed=n.subtract(this.currentPosition).abs()*this.currentFrameRate}else this.currentSpeed=0}},e}),define("x_ite/Rendering/X3DRenderObject",["jquery","x_ite/Rendering/TextureBuffer","x_ite/Bits/TraverseType","standard/Math/Algorithm","standard/Math/Algorithms/MergeSort","standard/Math/Geometry/Camera","standard/Math/Geometry/Box3","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Utility/MatrixStack"],function(t,e,n,i,r,o,s,a,u,l,c,h,d){"use strict";function p(t,e){return t.distance<e.distance}function f(t){this.cameraSpaceMatrix=new d(h),this.inverseCameraSpaceMatrix=new d(h),this.projectionMatrix=new d(h),this.modelViewMatrix=new d(h),this.viewVolumes=[],this.shaderObjects=[],this.globalLights=[],this.lights=[],this.shadow=[!1],this.localFogs=[],this.layouts=[],this.generatedCubeMapTextures=[],this.shaders=new Set,this.collisions=[],this.numOpaqueShapes=0,this.numTransparentShapes=0,this.numCollisionShapes=0,this.numDepthShapes=0,this.opaqueShapes=[],this.transparentShapes=[],this.transparencySorter=new r(this.transparentShapes,p),this.collisionShapes=[],this.activeCollisions={},this.depthShapes=[],this.speed=0;try{this.depthBuffer=new e(t.getBrowser(),g,m)}catch(t){console.error(t),this.getDepth=function(){return 0}}}var g=16,m=g;return f.prototype={constructor:f,initialize:function(){},isIndependent:function(){return!0},getCameraSpaceMatrix:function(){return this.cameraSpaceMatrix},getInverseCameraSpaceMatrix:function(){return this.inverseCameraSpaceMatrix},getProjectionMatrix:function(){return this.projectionMatrix},getModelViewMatrix:function(){return this.modelViewMatrix},getViewVolumes:function(){return this.viewVolumes},getViewVolume:function(){return this.viewVolumes[this.viewVolumes.length-1]},getShaderObjects:function(){return this.shaderObjects},getGlobalLights:function(){return this.globalLights},getLights:function(){return this.lights},pushShadow:function(t){this.shadow.unshift(t||this.shadow[0])},popShadow:function(t){this.shadow.pop()},setGlobalFog:function(){var t=new h;return function(e){var n=this.localFogs[0]||e.getFogs().pop();t.assign(e.getModelMatrix()).multRight(this.getInverseCameraSpaceMatrix().get()),n.set(e,t),this.localFog=this.localFogs[0]=n}}(),pushLocalFog:function(t){this.localFogs.push(t),this.localFog=t},popLocalFog:function(){var t=this.localFogs.pop();return this.localFog=this.localFogs[this.localFogs.length-1],t},getLayouts:function(){return this.layouts},getParentLayout:function(){return this.layouts.length?this.layouts[this.layouts.length-1]:null},getGeneratedCubeMapTextures:function(){return this.generatedCubeMapTextures},getShaders:function(){return this.shaders},getCollisions:function(){return this.collisions},setNumCollisionShapes:function(t){this.numCollisionShapes=t},getNumCollisionShapes:function(){return this.numCollisionShapes},getCollisionShapes:function(){return this.collisionShapes},setNumDepthShapes:function(t){this.numDepthShapes=t},getNumDepthShapes:function(){return this.numDepthShapes},getDepthShapes:function(){return this.depthShapes},setNumOpaqueShapes:function(t){this.numOpaqueShapes=t},getNumOpaqueShapes:function(){return this.numOpaqueShapes},getOpaqueShapes:function(){return this.opaqueShapes},setNumTransparentShapes:function(t){this.numTransparentShapes=t},getNumTransparentShapes:function(){return this.numTransparentShapes},getTransparentShapes:function(){return this.transparentShapes},constrainTranslation:function(t,e){var n=this.getDistance(t);if((n-=this.getNavigationInfo().getCollisionRadius())>0){return t.abs()>n?t.normalize().multiply(n):t}return e?this.constrainTranslation(t.normalize().multiply(n),!1):t.assign(u.Zero)},getDistance:function(){var t=new h,e=new h,n=new c(0,0,1,0),i=new u(0,0,0),r=new c(0,0,1,0);return function(s){try{var a=performance.now(),l=this.getViewpoint(),c=this.getNavigationInfo(),h=c.getCollisionRadius(),d=c.getStepHeight()-c.getAvatarHeight(),p=c.getNearValue(),f=c.getAvatarHeight();o.ortho(-h,h,Math.min(d,-h),h,p,Math.max(2*h,2*f),t),n.assign(l.orientation_.getValue()).inverse().multRight(l.getOrientation()),r.setFromToVec(u.zAxis,i.assign(s).negate()).multRight(n),l.straightenHorizon(r),e.assign(l.getModelMatrix()),e.translate(l.getUserPosition()),e.rotate(r),e.inverse(),e.multRight(t),e.multLeft(l.getCameraSpaceMatrix()),this.getProjectionMatrix().pushMatrix(e);var g=this.getDepth(t);return this.getProjectionMatrix().pop(),this.collisionTime+=performance.now()-a,-g}catch(t){console.log(t)}}}(),getDepth:function(){var t=new l(0,0,g,m),e=new a;return e.set(h.Identity,t,t),function(n){this.depthBuffer.bind(),this.viewVolumes.push(e),this.depth(this.collisionShapes,this.numCollisionShapes),this.viewVolumes.pop();var i=this.depthBuffer.getDepth(n,t);return this.depthBuffer.unbind(),i}}(),render:function(t,e,i){switch(t){case n.COLLISION:this.numCollisionShapes=0,e.call(i,t,this),this.collide(),this.gravite();break;case n.DEPTH:this.numDepthShapes=0,e.call(i,t,this),this.depth(this.depthShapes,this.numDepthShapes);break;case n.DISPLAY:this.lightIndex=0,this.numOpaqueShapes=0,this.numTransparentShapes=0,this.setGlobalFog(this.getFog()),e.call(i,t,this),this.draw(i)}},addCollisionShape:function(){var t=new u(0,0,0),e=new u(0,0,0);return function(n){var i=this.getModelViewMatrix().get();i.multDirMatrix(t.assign(n.getBBoxSize())),i.multVecMatrix(e.assign(n.getBBoxCenter()));var r=t.abs()/2,o=this.viewVolumes[this.viewVolumes.length-1];if(o.intersectsSphere(r,e)){this.numCollisionShapes===this.collisionShapes.length&&this.collisionShapes.push({renderer:this,browser:this.getBrowser(),modelViewMatrix:new Float32Array(16),collisions:[],clipPlanes:[]});var s=this.collisionShapes[this.numCollisionShapes];++this.numCollisionShapes,s.modelViewMatrix.set(i),s.shapeNode=n,s.scissor=o.getScissor();for(var a=this.collisions,u=s.collisions,l=0,c=a.length;l<c;++l)u[l]=a[l];u.length=c;for(var h=this.shaderObjects,d=s.clipPlanes,l=0,c=h.length;l<c;++l)d[l]=h[l];return d.length=c,!0}return!1}}(),addDepthShape:function(){var t=new u(0,0,0),e=new u(0,0,0);return function(n){var i=this.getModelViewMatrix().get();i.multDirMatrix(t.assign(n.getBBoxSize())),i.multVecMatrix(e.assign(n.getBBoxCenter()));var r=t.abs()/2,o=this.viewVolumes[this.viewVolumes.length-1];if(o.intersectsSphere(r,e)){this.numDepthShapes===this.depthShapes.length&&this.depthShapes.push({renderer:this,browser:this.getBrowser(),modelViewMatrix:new Float32Array(16),clipPlanes:[]});var s=this.depthShapes[this.numDepthShapes];++this.numDepthShapes,s.modelViewMatrix.set(i),s.shapeNode=n,s.scissor=o.getScissor();for(var a=this.shaderObjects,u=s.clipPlanes,l=0,c=a.length;l<c;++l)u[l]=a[l];return u.length=c,!0}return!1}}(),addDisplayShape:function(){var t=new u(0,0,0),e=new u(0,0,0);return function(n){var i=this.getModelViewMatrix().get();i.multDirMatrix(t.assign(n.getBBoxSize())),i.multVecMatrix(e.assign(n.getBBoxCenter()));var r=t.abs()/2,o=this.viewVolumes[this.viewVolumes.length-1];if(o.intersectsSphere(r,e)){if(n.getTransparent()){var s=this.numTransparentShapes;s===this.transparentShapes.length&&this.transparentShapes.push(this.createShapeContext(!0));var a=this.transparentShapes[s];++this.numTransparentShapes}else{var s=this.numOpaqueShapes;s===this.opaqueShapes.length&&this.opaqueShapes.push(this.createShapeContext(!1));var a=this.opaqueShapes[s];++this.numOpaqueShapes}a.modelViewMatrix.set(i),a.scissor.assign(o.getScissor()),a.shapeNode=n,a.distance=e.z,a.fogNode=this.localFog,a.shadow=this.shadow[0];for(var u=this.shaderObjects,l=a.shaderObjects,c=0,h=u.length;c<h;++c)l[c]=u[c];return l.length=h,!0}return!1}}(),createShapeContext:function(t){return{renderer:this,browser:this.getBrowser(),transparent:t,geometryType:3,fogCoords:!1,colorMaterial:!1,modelViewMatrix:new Float32Array(16),scissor:new l(0,0,0,0),shaderObjects:[],linePropertiesNode:null,materialNode:null,textureNode:null,textureTransformNode:null,shaderNode:null,shadow:!1}},collide:function(){var e=new h,n=new h,r=new s(u.Zero,u.Zero),o=new u(0,0,0);return function(){var s={},a=2.2*this.getNavigationInfo().getCollisionRadius();o.set(a,a,a);for(var l=0,c=this.numCollisionShapes;l<c;++l)try{var h=this.collisionShapes[l],d=h.collisions;if(d.length&&(r.set(o,u.Zero),r.multRight(e.assign(h.modelViewMatrix).inverse()),h.shapeNode.intersectsBox(r,h.clipPlanes,n.assign(h.modelViewMatrix))))for(var p=0;p<d.length;++p)s[d[p].getId()]=d[p]}catch(t){console.log(t)}if(!t.isEmptyObject(this.activeCollisions)){var f=t.isEmptyObject(s)?this.activeCollisions:i.set_difference(this.activeCollisions,s,{});for(var g in f)f[g].set_active(!1)}this.activeCollisions=s;for(var g in s)s[g].set_active(!0)}}(),gravite:function(){var t=new h,e=new h,n=new u(0,0,0),i=new c(0,0,1,0);return function(){try{if(this.getBrowser().getActiveLayer()===this){if("WALK"!==this.getBrowser().getCurrentViewer())return}else if("WALK"!==this.getNavigationInfo().getViewer())return;var r=this.getNavigationInfo(),s=this.getViewpoint(),a=r.getCollisionRadius(),l=r.getNearValue(),c=r.getAvatarHeight(),h=r.getStepHeight();o.ortho(-a,a,-a,a,l,Math.max(2*a,2*c),t);var d=s.getUpVector(),p=i.setFromToVec(u.zAxis,d);e.assign(s.getModelMatrix()),e.translate(s.getUserPosition()),e.rotate(p),e.inverse(),e.multRight(t),e.multLeft(s.getCameraSpaceMatrix()),this.getProjectionMatrix().pushMatrix(e);var f=-this.getDepth(t);this.getProjectionMatrix().pop(),f-=c;var g=i.setFromToVec(u.yAxis,d);if(f>0){var m=this.speed?this.getBrowser().getCurrentFrameRate():1e6;this.speed-=this.getBrowser().getBrowserOptions().Gravity_.getValue()/m;var x=this.speed/m;x<-f&&(x=-f,this.speed=0),s.positionOffset_=s.positionOffset_.getValue().add(g.multVecRot(n.set(0,x,0)))}else this.speed=0,(f=-f)>.01&&f<h&&(this.constrainTranslation(g.multVecRot(n.set(0,f,0)),!1),s.positionOffset_=n.add(s.positionOffset_.getValue()))}catch(t){console.log(t)}}}(),depth:function(){var t=new Float32Array(16);return function(e,n){var i=this.getBrowser(),r=i.getContext(),o=this.getViewVolume().getViewport(),s=i.getDepthShader();s.enable(r),t.set(this.getProjectionMatrix().get()),r.uniformMatrix4fv(s.x3d_ProjectionMatrix,!1,t),r.viewport(o[0],o[1],o[2],o[3]),r.scissor(o[0],o[1],o[2],o[3]),r.clearColor(1,0,0,0),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),r.enable(r.DEPTH_TEST),r.depthMask(!0),r.disable(r.BLEND),r.disable(r.CULL_FACE);for(var a=0;a<n;++a){var u=e[a],l=u.scissor;r.scissor(l.x,l.y,l.z,l.w),s.setShaderObjects(r,u.clipPlanes),r.uniformMatrix4fv(s.x3d_ModelViewMatrix,!1,u.modelViewMatrix),u.shapeNode.depth(r,u,s)}s.disable(r)}}(),draw:function(){var t=new Int32Array(4),e=new Float32Array(16),n=new Float32Array(16);return function(i){var r=this.getBrowser(),o=r.getContext(),s=this.getViewVolume().getViewport(),a=this.shaders,u=this.lights,l=this.generatedCubeMapTextures;if(this.isIndependent()){for(var c=0,h=u.length;c<h;++c)u[c].renderShadowMap(this);for(var c=0,h=l.length;c<h;++c)l[c].renderTexture(this,i)}r.getHeadlight().setGlobalVariables(this);for(var c=0,h=u.length;c<h;++c)u[c].setGlobalVariables(this);o.viewport(s[0],s[1],s[2],s[3]),o.scissor(s[0],s[1],s[2],s[3]),o.clear(o.DEPTH_BUFFER_BIT),this.getBackground().display(o,this,s),t.set(s),n.set(this.getCameraSpaceMatrix().get()),e.set(this.getProjectionMatrix().get()),r.hasPointShader()&&a.add(r.getPointShader()),r.hasLineShader()&&a.add(r.getLineShader()),r.hasShadowShader()&&a.add(r.getShadowShader()),a.forEach(function(i){i.setGlobalUniforms(o,this,n,e,t)},this),o.enable(o.DEPTH_TEST),o.depthMask(!0),o.disable(o.BLEND);for(var c=0;c<this.numOpaqueShapes;++c){var d=this.opaqueShapes[c],p=d.scissor;o.scissor(p.x,p.y,p.z,p.w),d.shapeNode.display(o,d)}o.depthMask(!1),o.enable(o.BLEND),this.transparencySorter.sort(0,this.numTransparentShapes);for(var c=0;c<this.numTransparentShapes;++c){var d=this.transparentShapes[c],p=d.scissor;o.scissor(p.x,p.y,p.z,p.w),d.shapeNode.display(o,d)}if(o.depthMask(!0),o.disable(o.BLEND),o.activeTexture(o.TEXTURE0),l.length=0,a.clear(),this.isIndependent()){for(var f=this.getBrowser().getClipPlanes(),c=0,h=f.length;c<h;++c)f[c].dispose();f.length=0;for(var u=this.globalLights,c=0,h=u.length;c<h;++c)u[c].dispose();for(var u=this.getBrowser().getLocalLights(),c=0,h=u.length;c<h;++c)u[c].dispose();u.length=0;for(var g=this.getBrowser().getLocalFogs(),c=0,h=g.length;c<h;++c)g[c].dispose();g.length=0}this.globalLights.length=0,this.lights.length=0}}()},f}),define("x_ite/Execution/BindableStack",["x_ite/Basic/X3DBaseNode"],function(t){"use strict";function e(e,n,i){t.call(this,e),this.layer=n,this.array=[i]}return e.prototype=Object.assign(Object.create(t.prototype),{constructor:e,getTypeName:function(){return"BindableStack"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"bindableStack"},get:function(){return this.array},top:function(){return this.array[this.array.length-1]},forcePush:function(t){t.isBound_=!0,t.bindTime_=this.getBrowser().getCurrentTime(),this.push(t)},push:function(t){if(0!==this.array.length&&t!==this.array[0]){var e=this.top();t!==e&&(this.pushOnTop(t),e.isBound_.getValue()&&(e.set_bind_=!1,e.isBound_=!1),t.isBound_.getValue()||(t.isBound_=!0,t.bindTime_=this.getBrowser().getCurrentTime(),t.transitionStart(e)),this.pushOnTop(t),this.addNodeEvent())}},pushOnTop:function(t){var e=this.array.indexOf(t);e>-1&&this.array.splice(e,1),this.array.push(t)},remove:function(t){if(t!==this.array[0]){if(t===this.top())return this.pop(t);var e=this.array.indexOf(t);e>-1&&this.array.splice(e,1)}},pop:function(t){if(t!==this.array[0]){var e=this.top();if(t===e){if(t.isBound_.getValue()&&(t.isBound_=!1),0===this.array.length)return;this.array.pop(),e=this.top(),e.isBound_.getValue()||(e.set_bind_=!0,e.isBound_=!0,e.bindTime_=this.getBrowser().getCurrentTime(),e.transitionStart(t)),this.addNodeEvent()}}}}),e}),define("x_ite/Execution/BindableList",["x_ite/Basic/X3DBaseNode"],function(t){"use strict";function e(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}function n(e,n,i){t.call(this,e),this.layer=n,this.collected=[i],this.array=[i]}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,getTypeName:function(){return"BindableList"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"bindableList"},get:function(){return this.array},getBound:function(t){if(this.array.length>1){var e=this.getMasterScene();if(t&&t.length)for(var n=1,i=this.array.length;n<i;++n){var r=this.array[n];if(r.getScene()===e&&r.getName()==t)return r}for(var n=1,i=this.array.length;n<i;++n){var r=this.array[n];if(r.getScene()===e&&r.isBound_.getValue())return r}for(var n=1,i=this.array.length;n<i;++n){var r=this.array[n];if(r.getScene()===e)return r}}return this.array[0]},push:function(t){return this.collected.push(t)},update:function(){if(!e(this.collected,this.array)){for(var t=0,n=this.array.length;t<n;++t){var i=this.array[t];this.collected.indexOf(i)<0&&i.isBound_.getValue()&&(i.set_bind_=!1)}var r=this.array;this.array=this.collected,this.collected=r}this.collected.length=1}}),n}),define("x_ite/Components/Navigation/NavigationInfo",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DBindableNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants"],function(t,e,n,i,r,o){"use strict";function s(e){i.call(this,e),this.addType(o.NavigationInfo),this.addChildObjects("transitionStart",new t.SFBool,"transitionActive",new t.SFBool,"availableViewers",new t.MFString,"viewer",new t.SFString("EXAMINE")),this.avatarSize_.setUnit("length"),this.speed_.setUnit("speed"),this.visibilityLimit_.setUnit("speed")}var a={TELEPORT:!0,LINEAR:!0,ANIMATE:!0};return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOnly,"set_bind",new t.SFBool),new e(o.inputOutput,"type",new t.MFString("EXAMINE","ANY")),new e(o.inputOutput,"avatarSize",new t.MFFloat(.25,1.6,.75)),new e(o.inputOutput,"speed",new t.SFFloat(1)),new e(o.inputOutput,"headlight",new t.SFBool(!0)),new e(o.inputOutput,"visibilityLimit",new t.SFFloat),new e(o.inputOutput,"transitionType",new t.MFString("LINEAR")),new e(o.inputOutput,"transitionTime",new t.SFTime(1)),new e(o.outputOnly,"transitionComplete",new t.SFBool),new e(o.outputOnly,"isBound",new t.SFBool),new e(o.outputOnly,"bindTime",new t.SFTime)]),getTypeName:function(){return"NavigationInfo"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.type_.addInterest("set_type__",this),this.headlight_.addInterest("set_headlight__",this),this.transitionStart_.addInterest("set_transitionStart__",this),this.transitionComplete_.addInterest("set_transitionComplete__",this),this.isBound_.addInterest("set_isBound__",this),this.set_type__(),this.set_headlight__()},getViewer:function(){return this.viewer_.getValue()},getCollisionRadius:function(){return this.avatarSize_.length>0&&this.avatarSize_[0]>0?this.avatarSize_[0]:.25},getAvatarHeight:function(){return this.avatarSize_.length>1?this.avatarSize_[1]:1.6},getStepHeight:function(){return this.avatarSize_.length>2?this.avatarSize_[2]:.75},getNearValue:function(){var t=this.getCollisionRadius();return 0===t?1e-5:t/2},getFarValue:function(t){return this.visibilityLimit_.getValue()?this.visibilityLimit_.getValue():t.getMaxFarValue()},getTransitionType:function(){for(var t=0,e=this.transitionType_.length;t<e;++t){var n=this.transitionType_[t];if(a[n])return n}return"LINEAR"},set_type__:function(){this.availableViewers_.length=0;var t=!1,e=!1,n=!1,i=!1,r=!1,o=!1;this.viewer_="EXAMINE";for(var s=0;s<this.type_.length;++s){var a=this.type_[s];switch(a){case"EXAMINE":case"WALK":case"FLY":case"LOOKAT":case"PLANE":case"NONE":this.viewer_=a;break;case"PLANE_create3000.de":this.viewer_="PLANE";break;default:continue}break}if(this.type_.length)for(var s=0;s<this.type_.length;++s){var a=this.type_[s];switch(a){case"EXAMINE":t=!0;continue;case"WALK":e=!0;continue;case"FLY":n=!0;continue;case"LOOKAT":o=!0;continue;case"PLANE":i=!0;continue;case"NONE":r=!0;continue}if("ANY"==a){t=!0,e=!0,n=!0,i=!0,r=!0,o=!0;break}t=!0}else t=!0,e=!0,n=!0,i=!0,r=!0,o=!0;t&&this.availableViewers_.push("EXAMINE"),e&&this.availableViewers_.push("WALK"),n&&this.availableViewers_.push("FLY"),i&&this.availableViewers_.push("PLANE"),o&&this.availableViewers_.push("LOOKAT"),r&&this.availableViewers_.push("NONE")},set_headlight__:function(){this.headlight_.getValue()?delete this.enable:this.enable=Function.prototype},set_transitionStart__:function(){this.transitionActive_.getValue()||(this.transitionActive_=!0)},set_transitionComplete__:function(){this.transitionActive_.getValue()&&(this.transitionActive_=!1)},set_isBound__:function(){this.isBound_.getValue()||this.transitionActive_.getValue()&&(this.transitionActive_=!1)},bindToLayer:function(t){t.getNavigationInfoStack().push(this)},unbindFromLayer:function(t){t.getNavigationInfoStack().pop(this)},removeFromLayer:function(t){t.getNavigationInfoStack().remove(this)},enable:function(t,e){t===r.DISPLAY&&this.headlight_.getValue()&&e.getGlobalLights().push(e.getBrowser().getHeadlight())},traverse:function(t,e){e.getLayer().getNavigationInfos().push(this)}}),s}),define("x_ite/Components/EnvironmentalEffects/X3DFogObject",["x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix3","standard/Utility/ObjectCache"],function(t,e,n){"use strict";function i(){this.fogMatrix=new Float32Array(9)}function r(e){this.addType(t.X3DFogObject),this.visibilityRange_.setUnit("length"),this.hidden=!1}var o=n(i);return i.prototype={constructor:i,set:function(t,n){this.fogNode=t;try{this.fogMatrix.set(n.submatrix.inverse())}catch(t){this.fogMatrix.set(e.Identity)}},setShaderUniforms:function(t,e){if(!e.hasFog(this)){var n=this.fogNode,i=Math.max(0,n.visibilityRange_.getValue());if(n.getHidden()||0===i)t.uniform1i(e.x3d_FogType,0);else{var r=n.color_.getValue();this.center;t.uniform1i(e.x3d_FogType,n.fogType),t.uniform3f(e.x3d_FogColor,r.r,r.g,r.b),t.uniform1f(e.x3d_FogVisibilityRange,i),t.uniformMatrix3fv(e.x3d_FogMatrix,!1,this.fogMatrix)}}},dispose:function(){o.push(this)}},r.prototype={constructor:r,initialize:function(){this.fogType_.addInterest("set_fogType__",this),this.set_fogType__()},set_fogType__:function(){switch(this.fogType_.getValue()){case"EXPONENTIAL":this.fogType=2;break;default:this.fogType=1}},setHidden:function(t){this.hidden=t,this.getBrowser().addBrowserEvent()},getHidden:function(){return this.hidden},getFogs:function(){return o}},r}),define("x_ite/Components/EnvironmentalEffects/Fog",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DBindableNode","x_ite/Components/EnvironmentalEffects/X3DFogObject","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4"],function(t,e,n,i,r,o,s,a){"use strict";function u(t){i.call(this,t),r.call(this,t),this.addType(s.Fog),this.modelMatrix=new a}return u.prototype=Object.assign(Object.create(i.prototype),r.prototype,{constructor:u,fieldDefinitions:new n([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOnly,"set_bind",new t.SFBool),new e(s.inputOutput,"fogType",new t.SFString("LINEAR")),new e(s.inputOutput,"color",new t.SFColor(1,1,1)),new e(s.inputOutput,"visibilityRange",new t.SFFloat),new e(s.outputOnly,"isBound",new t.SFBool),new e(s.outputOnly,"bindTime",new t.SFTime)]),getTypeName:function(){return"Fog"},getComponentName:function(){return"EnvironmentalEffects"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),r.prototype.initialize.call(this)},getModelMatrix:function(){return this.modelMatrix},bindToLayer:function(t){t.getFogStack().push(this)},unbindFromLayer:function(t){t.getFogStack().pop(this)},removeFromLayer:function(t){t.getFogStack().remove(this)},traverse:function(t,e){e.getLayer().getFogs().push(this),this.modelMatrix.assign(e.getModelViewMatrix().get())}}),u}),define("x_ite/Components/EnvironmentalEffects/X3DBackgroundNode",["x_ite/Components/Core/X3DBindableNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Algorithm"],function(t,e,n,i,r,o,s,a,u){"use strict";function l(e){t.call(this,e),this.addType(n.X3DBackgroundNode),this.skyAngle_.setUnit("angle"),this.groundAngle_.setUnit("angle"),this.hidden=!1,this.projectionMatrixArray=new Float32Array(16),this.modelMatrix=new a,this.modelViewMatrixArray=new Float32Array(16),this.shaderObjects=[],this.colors=[],this.sphere=[],this.textures=0}var c=Math.sqrt(.5),h=c,d=[1,1,0,1,0,1,0,1,0,0,0,1,1,1,0,1,0,0,0,1,1,0,0,1],p=[h,h,-h,1,-h,h,-h,1,-h,-h,-h,1,h,h,-h,1,-h,-h,-h,1,h,-h,-h,1],f=[-h,h,h,1,h,h,h,1,h,-h,h,1,-h,h,h,1,h,-h,h,1,-h,-h,h,1],g=[-h,h,-h,1,-h,h,h,1,-h,-h,h,1,-h,h,-h,1,-h,-h,h,1,-h,-h,-h,1],m=[h,h,h,1,h,h,-h,1,h,-h,-h,1,h,h,h,1,h,-h,-h,1,h,-h,h,1],x=[h,h,h,1,-h,h,h,1,-h,h,-h,1,h,h,h,1,-h,h,-h,1,h,h,-h,1],v=[h,-h,-h,1,-h,-h,-h,1,-h,-h,h,1,h,-h,-h,1,-h,-h,h,1,h,-h,h,1],_=new r(0,0),y=new r(0,0),w=new r(0,0),b=new r(0,0),S=new r(0,0),C=new r(0,0);return l.prototype=Object.assign(Object.create(t.prototype),{constructor:l,initialize:function(){t.prototype.initialize.call(this);var e=this.getBrowser().getContext();this.colorBuffer=e.createBuffer(),this.sphereBuffer=e.createBuffer(),this.texCoordBuffer=e.createBuffer(),this.cubeBuffer=e.createBuffer(),this.texCoordBuffers=[e.createBuffer()],this.frontBuffer=e.createBuffer(),this.backBuffer=e.createBuffer(),this.leftBuffer=e.createBuffer(),this.rightBuffer=e.createBuffer(),this.topBuffer=e.createBuffer(),this.bottomBuffer=e.createBuffer(),this.groundAngle_.addInterest("build",this),this.groundColor_.addInterest("build",this),this.skyAngle_.addInterest("build",this),this.skyColor_.addInterest("build",this),this.transparency_.addInterest("build",this),this.build(),this.transferRectangle()},set_frontTexture__:function(t){this.setTexture("frontTexture",t,0)},set_backTexture__:function(t){this.setTexture("backTexture",t,1)},set_leftTexture__:function(t){this.setTexture("leftTexture",t,2)},set_rightTexture__:function(t){this.setTexture("rightTexture",t,3)},set_topTexture__:function(t){this.setTexture("topTexture",t,4)},set_bottomTexture__:function(t){this.setTexture("bottomTexture",t,5)},setTexture:function(t,e,n){this[t]&&this[t].loadState_.removeInterest("setTextureBit",this),this[t]=e,e?(e.loadState_.addInterest("setTextureBit",this,n),this.setTextureBit(e.loadState_,n)):this.textures&=~(1<<n)},setTextureBit:function(t,e){t.getValue()===n.COMPLETE_STATE?this.textures|=1<<e:this.textures&=~(1<<e)},bindToLayer:function(t){t.getBackgroundStack().push(this)},unbindFromLayer:function(t){t.getBackgroundStack().pop(this)},removeFromLayer:function(t){t.getBackgroundStack().remove(this)},setHidden:function(t){this.hidden=t,this.getBrowser().addBrowserEvent()},getHidden:function(){return this.hidden},getTransparent:function(){return!!this.hidden||0!==this.transparency_.getValue()&&(!(this.frontTexture&&!this.frontTexture.transparent_.getValue())||(!(this.backTexture&&!this.backTexture.transparent_.getValue())||(!(this.leftTexture&&!this.leftTexture.transparent_.getValue())||(!(this.rightTexture&&!this.rightTexture.transparent_.getValue())||(!(this.topTexture&&!this.topTexture.transparent_.getValue())||!(this.bottomTexture&&!this.bottomTexture.transparent_.getValue()))))))},getColor:function(t,e,n){return e[u.upperBound(n,0,n.length,t,u.less)]},build:function(){if(this.colors.length=0,this.sphere.length=0,!(this.transparency_.getValue()>=1)){var t=1-u.clamp(this.transparency_.getValue(),0,1);if(0===this.groundColor_.length&&1==this.skyColor_.length){var e=c;this.sphere.vertices=36,this.sphere.push(e,e,-e,1,-e,e,-e,1,-e,-e,-e,1,e,e,-e,1,-e,-e,-e,1,e,-e,-e,1,-e,e,e,1,e,e,e,1,-e,-e,e,1,-e,-e,e,1,e,e,e,1,e,-e,e,1,-e,e,-e,1,-e,e,e,1,-e,-e,e,1,-e,e,-e,1,-e,-e,e,1,-e,-e,-e,1,e,e,e,1,e,e,-e,1,e,-e,e,1,e,-e,e,1,e,e,-e,1,e,-e,-e,1,e,e,e,1,-e,e,e,1,-e,e,-e,1,e,e,e,1,-e,e,-e,1,e,e,-e,1,-e,-e,e,1,e,-e,e,1,-e,-e,-e,1,-e,-e,-e,1,e,-e,e,1,e,-e,-e,1);for(var n=this.skyColor_[0],i=0,r=this.sphere.vertices;i<r;++i)this.colors.push(n.r,n.g,n.b,t)}else{if(this.skyColor_.length>this.skyAngle_.length){for(var o=[],i=0,s=this.skyAngle_.length;i<s;++i)o.push(this.skyAngle_[i]);(0===o.length||o[0]>0)&&o.unshift(0);var a=this.groundColor_.length>this.groundAngle_.length?Math.PI/2:Math.PI;o[o.length-1]<a&&o.push(a),this.buildSphere(1,o,this.skyAngle_,this.skyColor_,t,!1)}if(this.groundColor_.length>this.groundAngle_.length){for(var o=[],i=0,s=this.groundAngle_.length;i<s;++i)o.push(this.groundAngle_[i]);o.reverse(),(0===o.length||o[0]<Math.PI/2)&&o.unshift(Math.PI/2),o[o.length-1]>0&&o.push(0),this.buildSphere(1,o,this.groundAngle_,this.groundColor_,t,!0)}}this.transferSphere()}},buildSphere:function(t,e,n,i,r,o){for(var s=0,a=o?Math.PI/2:Math.PI,l=e.length-1,c=0;c<l;++c){var h=u.clamp(e[c],0,a),d=u.clamp(e[c+1],0,a);o&&(h=Math.PI-h,d=Math.PI-d),_.setPolar(t,h),y.setPolar(t,d);for(var p=this.getColor(e[c],i,n),f=this.getColor(e[c+1],i,n),g=0;g<20;++g){var m=g<19?g+1:0;s=2*Math.PI*(g/20),w.setPolar(-_.imag,s),b.setPolar(-y.imag,s),s=2*Math.PI*(m/20),S.setPolar(-y.imag,s),C.setPolar(-_.imag,s),this.colors.push(p.r,p.g,p.b,r,f.r,f.g,f.b,r,f.r,f.g,f.b,r,p.r,p.g,p.b,r,p.r,p.g,p.b,r,f.r,f.g,f.b,r),this.sphere.push(w.imag,_.real,w.real,1,S.imag,y.real,S.real,1,b.imag,y.real,b.real,1,w.imag,_.real,w.real,1,C.imag,_.real,C.real,1,S.imag,y.real,S.real,1)}}},transferSphere:function(){var t=this.getBrowser().getContext();t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),
t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.colors),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.sphereBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.sphere),t.STATIC_DRAW),this.sphereCount=this.sphere.length/4},transferRectangle:function(){var t=this.getBrowser().getContext();t.bindBuffer(t.ARRAY_BUFFER,this.texCoordBuffers[0]),t.bufferData(t.ARRAY_BUFFER,new Float32Array(d),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.frontBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(p),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.backBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(f),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.leftBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(g),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.rightBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(m),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.topBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(x),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.bottomBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(v),t.STATIC_DRAW)},traverse:function(t,n){switch(t){case e.CAMERA:return n.getLayer().getBackgrounds().push(this),void this.modelMatrix.assign(n.getModelViewMatrix().get());case e.DISPLAY:for(var i=n.getShaderObjects(),r=this.shaderObjects,o=0,s=i.length;o<s;++o)r[o]=i[o];return void(r.length=i.length)}},display:function(){var t=new a,e=new a,n=new s,r=new o(0,0,0),u=new o(0,0,0);return function(o,s,a){try{if(this.hidden)return;o.disable(o.DEPTH_TEST),o.depthMask(!1),o.enable(o.CULL_FACE),o.frontFace(o.CCW);var l=(s.getViewpoint(),s.getNavigationInfo(),.8*-i.unProjectPointMatrix(0,0,1,t.assign(s.getProjectionMatrix().get()).inverse(),a,u).z);this.projectionMatrixArray.set(s.getProjectionMatrix().get()),e.assign(this.modelMatrix),e.multRight(s.getInverseCameraSpaceMatrix().get()),e.get(null,n),e.identity(),e.rotate(n),e.scale(r.set(l,l,l)),this.modelViewMatrixArray.set(e),this.drawSphere(s),this.textures&&this.drawCube(s)}catch(t){console.log(t)}}}(),drawSphere:function(t){var e=this.transparency_.getValue();if(!(e>=1)){var n=t.getBrowser(),i=n.getContext(),r=n.getBackgroundSphereShader();r.getValid()&&(r.enable(i),r.setShaderObjects(i,this.shaderObjects),r.enableColorAttribute(i,this.colorBuffer),r.enableVertexAttribute(i,this.sphereBuffer),i.uniformMatrix4fv(r.x3d_ProjectionMatrix,!1,this.projectionMatrixArray),i.uniformMatrix4fv(r.x3d_ModelViewMatrix,!1,this.modelViewMatrixArray),e?i.enable(i.BLEND):i.disable(i.BLEND),i.drawArrays(i.TRIANGLES,0,this.sphereCount),r.disableColorAttribute(i),r.disable(i))}},drawCube:function(){var t=new Float32Array(new a);return function(e){var n=e.getBrowser(),i=n.getContext(),r=n.getGouraudShader();r.getValid()&&(r.enable(i),r.setShaderObjects(i,this.shaderObjects),r.enableTexCoordAttribute(i,this.texCoordBuffers),i.uniform1i(r.x3d_FogType,0),i.uniform1i(r.x3d_ColorMaterial,!1),i.uniform1i(r.x3d_Lighting,!1),i.uniform1i(r.x3d_NumTextures,1),i.uniform1i(r.x3d_TextureCoordinateGeneratorMode[0],0),i.uniformMatrix4fv(r.x3d_TextureMatrix[0],!1,t),i.uniformMatrix4fv(r.x3d_ProjectionMatrix,!1,this.projectionMatrixArray),i.uniformMatrix4fv(r.x3d_ModelViewMatrix,!1,this.modelViewMatrixArray),this.drawRectangle(i,r,this.frontTexture,this.frontBuffer),this.drawRectangle(i,r,this.backTexture,this.backBuffer),this.drawRectangle(i,r,this.leftTexture,this.leftBuffer),this.drawRectangle(i,r,this.rightTexture,this.rightBuffer),this.drawRectangle(i,r,this.topTexture,this.topBuffer),this.drawRectangle(i,r,this.bottomTexture,this.bottomBuffer),r.disableTexCoordAttribute(i),r.disable(i))}}(),drawRectangle:function(t,e,i,r){i&&i.checkLoadState()===n.COMPLETE_STATE&&(i.setShaderUniforms(t,e),i.transparent_.getValue()?t.enable(t.BLEND):t.disable(t.BLEND),e.enableVertexAttribute(t,r),t.drawArrays(t.TRIANGLES,0,6))}}),l}),define("x_ite/Components/EnvironmentalEffects/Background",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/EnvironmentalEffects/X3DBackgroundNode","x_ite/Components/Texturing/ImageTexture","x_ite/Bits/X3DConstants"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(o.Background)}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOnly,"set_bind",new t.SFBool),new e(o.inputOutput,"frontUrl",new t.MFString),new e(o.inputOutput,"backUrl",new t.MFString),new e(o.inputOutput,"leftUrl",new t.MFString),new e(o.inputOutput,"rightUrl",new t.MFString),new e(o.inputOutput,"topUrl",new t.MFString),new e(o.inputOutput,"bottomUrl",new t.MFString),new e(o.inputOutput,"skyAngle",new t.MFFloat),new e(o.inputOutput,"skyColor",new t.MFColor(new t.SFColor)),new e(o.inputOutput,"groundAngle",new t.MFFloat),new e(o.inputOutput,"groundColor",new t.MFColor),new e(o.inputOutput,"transparency",new t.SFFloat),new e(o.outputOnly,"isBound",new t.SFBool),new e(o.outputOnly,"bindTime",new t.SFTime)]),getTypeName:function(){return"Background"},getComponentName:function(){return"EnvironmentalEffects"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this);var t=new r(this.getExecutionContext()),e=new r(this.getExecutionContext()),n=new r(this.getExecutionContext()),o=new r(this.getExecutionContext()),s=new r(this.getExecutionContext()),a=new r(this.getExecutionContext()),u=this.getBrowser().getBackgroundTextureProperties();this.frontUrl_.addFieldInterest(t.url_),this.backUrl_.addFieldInterest(e.url_),this.leftUrl_.addFieldInterest(n.url_),this.rightUrl_.addFieldInterest(o.url_),this.topUrl_.addFieldInterest(s.url_),this.bottomUrl_.addFieldInterest(a.url_),t.url_=this.frontUrl_,e.url_=this.backUrl_,n.url_=this.leftUrl_,o.url_=this.rightUrl_,s.url_=this.topUrl_,a.url_=this.bottomUrl_,t.textureProperties_=u,e.textureProperties_=u,n.textureProperties_=u,o.textureProperties_=u,s.textureProperties_=u,a.textureProperties_=u,t.setup(),e.setup(),n.setup(),o.setup(),s.setup(),a.setup(),this.set_frontTexture__(t),this.set_backTexture__(e),this.set_leftTexture__(n),this.set_rightTexture__(o),this.set_topTexture__(s),this.set_bottomTexture__(a)}}),s}),define("x_ite/Components/Layering/X3DLayerNode",["x_ite/Components/Core/X3DNode","x_ite/Rendering/X3DRenderObject","x_ite/Components/Layering/X3DViewportNode","x_ite/Execution/BindableStack","x_ite/Execution/BindableList","x_ite/Components/Navigation/NavigationInfo","x_ite/Components/EnvironmentalEffects/Fog","x_ite/Components/EnvironmentalEffects/Background","x_ite/Bits/X3DCast","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Geometry/Camera","standard/Math/Geometry/Box3","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(t,e,n,i,r,o,s,a,u,l,c,h,d,p,f){"use strict";function g(n,u,l){t.call(this,n),e.call(this,n),this.addType(c.X3DLayerNode),this.groupNode=l,this.currentViewport=null,this.defaultBackground=new a(n),this.defaultFog=new s(n),this.defaultNavigationInfo=new o(n),this.defaultViewpoint=u,this.backgroundStack=new i(n,this,this.defaultBackground),this.fogStack=new i(n,this,this.defaultFog),this.navigationInfoStack=new i(n,this,this.defaultNavigationInfo),this.viewpointStack=new i(n,this,this.defaultViewpoint),this.backgrounds=new r(n,this,this.defaultBackground),this.fogs=new r(n,this,this.defaultFog),this.navigationInfos=new r(n,this,this.defaultNavigationInfo),this.viewpoints=new r(n,this,this.defaultViewpoint),this.defaultBackground.setHidden(!0),this.defaultFog.setHidden(!0),this.collisionTime=0}var m=new f;return g.prototype=Object.assign(Object.create(t.prototype),e.prototype,{constructor:g,layer0:!1,initialize:function(){t.prototype.initialize.call(this),e.prototype.initialize.call(this),this.groupNode.children_=this.children_,this.groupNode.setPrivate(!0),this.groupNode.setup(),this.defaultNavigationInfo.setup(),this.defaultBackground.setup(),this.defaultFog.setup(),this.defaultViewpoint.setup(),this.backgroundStack.setup(),this.fogStack.setup(),this.navigationInfoStack.setup(),this.viewpointStack.setup(),this.backgrounds.setup(),this.fogs.setup(),this.navigationInfos.setup(),this.viewpoints.setup(),this.viewport_.addInterest("set_viewport__",this),this.addChildren_.addFieldInterest(this.groupNode.addChildren_),this.removeChildren_.addFieldInterest(this.groupNode.removeChildren_),this.children_.addFieldInterest(this.groupNode.children_),this.set_viewport__()},isLayer0:function(t){this.layer0=t,this.defaultBackground.setHidden(!t)},getLayer:function(){return this},getGroup:function(){return this.groupNode},getViewport:function(){return this.currentViewport},getBackground:function(){return this.backgroundStack.top()},getFog:function(){return this.fogStack.top()},getNavigationInfo:function(){return this.navigationInfoStack.top()},getViewpoint:function(){return this.viewpointStack.top()},getBackgrounds:function(){return this.backgrounds},getFogs:function(){return this.fogs},getNavigationInfos:function(){return this.navigationInfos},getViewpoints:function(){return this.viewpoints},getUserViewpoints:function(){for(var t=[],e=0;e<this.viewpoints.get().length;++e){var n=this.viewpoints.get()[e];n.description_.length&&t.push(n)}return t},getBackgroundStack:function(){return this.backgroundStack},getFogStack:function(){return this.fogStack},getNavigationInfoStack:function(){return this.navigationInfoStack},getViewpointStack:function(){return this.viewpointStack},getBBox:function(t){return this.groupNode.getBBox(t)},lookAt:function(t,e){this.getViewpoint().lookAtBBox(this.getBBox(new d),t,e)},set_viewport__:function(){this.currentViewport=u(c.X3DViewportNode,this.viewport_),this.currentViewport||(this.currentViewport=this.getBrowser().getDefaultViewport())},bind:function(t){this.traverse(l.CAMERA,this);var e=this.navigationInfos.getBound(),n=this.backgrounds.getBound(),i=this.fogs.getBound(),r=this.viewpoints.getBound(t);this.navigationInfoStack.forcePush(e),this.backgroundStack.forcePush(n),this.fogStack.forcePush(i),this.viewpointStack.forcePush(r),e.addLayer(this),n.addLayer(this),i.addLayer(this),r.addLayer(this),r.resetUserOffsets()},traverse:function(t,e){e=e||this;var n=this.getViewpoint();switch(this.getCameraSpaceMatrix().pushMatrix(n.getCameraSpaceMatrix()),this.getInverseCameraSpaceMatrix().pushMatrix(n.getInverseCameraSpaceMatrix()),this.getProjectionMatrix().pushMatrix(n.getProjectionMatrix(this)),t){case l.POINTER:this.pointer(t,e);break;case l.CAMERA:this.camera(t,e);break;case l.PICKING:this.picking(t,e);break;case l.COLLISION:this.collision(t,e);break;case l.DEPTH:case l.DISPLAY:this.display(t,e)}this.getProjectionMatrix().pop(),this.getInverseCameraSpaceMatrix().pop(),this.getCameraSpaceMatrix().pop()},pointer:function(t,e){if(this.isPickable_.getValue()){var n=this.getBrowser(),i=this.currentViewport.getRectangle(n);if(n.getSelectedLayer()){if(n.getSelectedLayer()!==this)return}else if(!n.isPointerInRectangle(i))return;n.setHitRay(this.getProjectionMatrix().get(),i),this.getModelViewMatrix().pushMatrix(this.getInverseCameraSpaceMatrix().get()),this.currentViewport.push(this),this.groupNode.traverse(t,e),this.currentViewport.pop(this),this.getModelViewMatrix().pop()}},camera:function(t,e){this.getModelViewMatrix().pushMatrix(f.Identity),this.currentViewport.push(this),this.groupNode.traverse(t,e),this.currentViewport.pop(this),this.navigationInfos.update(),this.backgrounds.update(),this.fogs.update(),this.viewpoints.update(),this.getViewpoint().update(),this.getModelViewMatrix().pop()},picking:function(t,e){this.getModelViewMatrix().pushMatrix(f.Identity),this.currentViewport.push(this),this.groupNode.traverse(t,e),this.currentViewport.pop(this),this.getModelViewMatrix().pop()},collision:function(t,e){var n=this.getNavigationInfo();if(!n.transitionActive_.getValue()){var i=n.getCollisionRadius(),r=n.getAvatarHeight(),o=Math.max(2*i,2*r);this.collisionTime=0,h.ortho(-o,o,-o,o,-o,o,m),this.getProjectionMatrix().pushMatrix(m),this.getModelViewMatrix().pushMatrix(this.getInverseCameraSpaceMatrix().get()),this.currentViewport.push(this),e.render(t,this.groupNode.traverse,this.groupNode),this.currentViewport.pop(this),this.getModelViewMatrix().pop(),this.getProjectionMatrix().pop()}},display:function(t,e){this.getNavigationInfo().enable(t,e),this.getModelViewMatrix().pushMatrix(this.getInverseCameraSpaceMatrix().get()),this.currentViewport.push(this),e.render(t,this.groupNode.traverse,this.groupNode),this.currentViewport.pop(this),this.getModelViewMatrix().pop()}}),g}),define("x_ite/Components/Grouping/Group",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/X3DConstants"],function(t,e,n,i,r){"use strict";function o(t){i.call(this,t),this.addType(r.Group)}return o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new e(r.initializeOnly,"bboxCenter",new t.SFVec3f),new e(r.inputOnly,"addChildren",new t.MFNode),new e(r.inputOnly,"removeChildren",new t.MFNode),new e(r.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"Group"},getComponentName:function(){return"Grouping"},getContainerField:function(){return"children"}}),o}),define("x_ite/Components/Layering/Layer",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Layering/X3DLayerNode","x_ite/Components/Navigation/Viewpoint","x_ite/Components/Grouping/Group","x_ite/Bits/X3DConstants"],function(t,e,n,i,r,o,s){"use strict";function a(t){i.call(this,t,new r(t),new o(t)),this.addType(s.Layer)}return a.prototype=Object.assign(Object.create(i.prototype),{constructor:a,fieldDefinitions:new n([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"isPickable",new t.SFBool(!0)),new e(s.inputOutput,"viewport",new t.SFNode),new e(s.inputOnly,"addChildren",new t.MFNode),new e(s.inputOnly,"removeChildren",new t.MFNode),new e(s.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"Layer"},getComponentName:function(){return"Layering"},getContainerField:function(){return"layers"}}),a}),define("x_ite/Components/Layering/LayerSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Layering/Layer","x_ite/Bits/X3DCast","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants"],function(t,e,n,i,r,o,s,a){"use strict";function u(t){i.call(this,t),this.addType(a.LayerSet),this.layerNodes=[new r(t)],this.layerNode0=this.layerNodes[0],this.activeLayerNode=null}return u.prototype=Object.assign(Object.create(i.prototype),{constructor:u,fieldDefinitions:new n([new e(a.inputOutput,"metadata",new t.SFNode),new e(a.inputOutput,"activeLayer",new t.SFInt32),new e(a.inputOutput,"order",new t.MFInt32(0)),new e(a.inputOutput,"layers",new t.MFNode)]),getTypeName:function(){return"LayerSet"},getComponentName:function(){return"Layering"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.layerNode0.setPrivate(!0),this.layerNode0.setup(),this.layerNode0.isLayer0(!0),this.activeLayer_.addInterest("set_activeLayer",this),this.order_.addInterest("set_layers",this),this.layers_.addInterest("set_layers",this),this.set_layers()},getActiveLayer:function(){return this.activeLayerNode},setLayer0:function(t){this.layerNode0=t,this.set_layers()},getLayer0:function(){return this.layerNode0},getLayers:function(){return this.layerNodes},set_activeLayer:function(){if(0===this.activeLayer_.getValue())this.activeLayerNode!==this.layerNode0&&(this.activeLayerNode=this.layerNode0);else{var t=this.activeLayer_-1;t>=0&&t<this.layers_.length?this.activeLayerNode!==this.layers_[t].getValue()&&(this.activeLayerNode=o(a.X3DLayerNode,this.layers_[t])):null!==this.activeLayerNode&&(this.activeLayerNode=null)}},set_layers:function(){var t=this.layers_.getValue();this.layerNodes.length=0;for(var e=0;e<this.order_.length;++e){var n=this.order_[e];if(0===n)this.layerNodes.push(this.layerNode0);else if(--n>=0&&n<t.length){var i=o(a.X3DLayerNode,t[n]);i&&this.layerNodes.push(i)}}this.set_activeLayer()},bind:function(t){var e=this.layers_.getValue();this.layerNode0.bind(t);for(var n=0,i=e.length;n<i;++n){var r=o(a.X3DLayerNode,e[n]);r&&r.bind(t)}},traverse:function(t,e){var n=this.layerNodes;if(t===s.POINTER)for(var i=0,r=n.length;i<r;++i)this.getBrowser().setLayerNumber(i),n[i].traverse(t,e);else for(var i=0,r=n.length;i<r;++i)n[i].traverse(t,e)}}),u}),define("x_ite/Execution/World",["x_ite/Fields/SFNode","x_ite/Basic/X3DBaseNode","x_ite/Components/Layering/LayerSet","x_ite/Components/Layering/Layer","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(t,e,n,i,r,o){"use strict";function s(r){e.call(this,r),this.addChildObjects("activeLayer",new t(this.layer0)),this.layerSet=new n(r),this.defaultLayerSet=this.layerSet,this.layer0=new i(r)}return s.prototype=Object.assign(Object.create(e.prototype),{constructor:s,getTypeName:function(){return"World"},initialize:function(){e.prototype.initialize.call(this),this.layerSet.setPrivate(!0),this.layerSet.setup(),this.layerSet.setLayer0(this.layer0),this.layerSet.activeLayer_.addInterest("set_rootNodes__",this),this.getExecutionContext().getRootNodes().addInterest("set_rootNodes__",this),this.getExecutionContext().setup(),this.set_rootNodes__(),this.layer0.setPrivate(!0),this.layer0.isLayer0(!0),this.layer0.setup(),this.set_activeLayer__(),this.bind()},getLayerSet:function(){return this.layerSet},getActiveLayer:function(){return this.activeLayer_.getValue()},set_rootNodes__:function(){var t=this.layerSet;this.layerSet=this.defaultLayerSet;var e=this.getExecutionContext().getRootNodes();this.layer0.children_=e;for(var n=0;n<e.length;++n){var i=r(o.LayerSet,e[n]);i&&(i.setLayer0(this.layer0),this.layerSet=i)}this.layerSet!==t&&(t.activeLayer_.removeInterest("set_activeLayer__",this),this.layerSet.activeLayer_.addInterest("set_activeLayer__",this),this.set_activeLayer__())},set_activeLayer__:function(){this.activeLayer_=this.layerSet.getActiveLayer()},bind:function(){this.layerSet.bind(this.getExecutionContext().getURL().fragment)},traverse:function(t,e){this.layerSet.traverse(t,e)}}),s}),define("x_ite/Browser/X3DBrowserContext",["jquery","x_ite/Fields/SFTime","x_ite/Basic/X3DBaseNode","x_ite/Browser/Core/X3DCoreContext","x_ite/Routing/X3DRoutingContext","x_ite/Browser/Scripting/X3DScriptingContext","x_ite/Browser/Networking/X3DNetworkingContext","x_ite/Browser/Shaders/X3DShadersContext","x_ite/Browser/Rendering/X3DRenderingContext","x_ite/Browser/Shape/X3DShapeContext","x_ite/Browser/Geometry3D/X3DGeometry3DContext","x_ite/Browser/PointingDeviceSensor/X3DPointingDeviceSensorContext","x_ite/Browser/Navigation/X3DNavigationContext","x_ite/Browser/Layering/X3DLayeringContext","x_ite/Browser/EnvironmentalEffects/X3DEnvironmentalEffectsContext","x_ite/Browser/Lighting/X3DLightingContext","x_ite/Browser/Picking/X3DPickingContext","x_ite/Browser/Sound/X3DSoundContext","x_ite/Browser/Text/X3DTextContext","x_ite/Browser/Texturing/X3DTexturingContext","x_ite/Browser/Time/X3DTimeContext","x_ite/Execution/World","x_ite/Bits/TraverseType"],function(t,e,n,i,r,o,s,a,u,l,c,h,d,p,f,g,m,x,v,_,y,w,b){"use strict";function S(t){n.call(this,this),r.call(this),i.call(this,t),o.call(this),s.call(this),a.call(this),u.call(this),l.call(this),c.call(this),h.call(this),d.call(this),p.call(this),f.call(this),g.call(this),m.call(this),x.call(this),v.call(this),_.call(this),y.call(this),C.forEach(function(t){t.call(this)}.bind(this)),this.addChildObjects("initialized",new e,"shutdown",new e,"prepareEvents",new e,"timeEvents",new e,"sensorEvents",new e,"finished",new e),this.changedTime=0,this.renderCallback=this.traverse.bind(this),this.systemTime=0,this.systemStartTime=0,this.browserTime=0,this.cameraTime=0,this.collisionTime=0,this.displayTime=0}var C=[];return S.prototype=Object.assign(Object.create(n.prototype),r.prototype,i.prototype,o.prototype,s.prototype,a.prototype,u.prototype,l.prototype,c.prototype,h.prototype,d.prototype,p.prototype,f.prototype,g.prototype,m.prototype,x.prototype,v.prototype,_.prototype,y.prototype,{constructor:S,initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this),i.prototype.initialize.call(this),o.prototype.initialize.call(this),s.prototype.initialize.call(this),a.prototype.initialize.call(this),u.prototype.initialize.call(this),l.prototype.initialize.call(this),c.prototype.initialize.call(this),h.prototype.initialize.call(this),d.prototype.initialize.call(this),p.prototype.initialize.call(this),f.prototype.initialize.call(this),g.prototype.initialize.call(this),m.prototype.initialize.call(this),x.prototype.initialize.call(this),v.prototype.initialize.call(this),_.prototype.initialize.call(this),y.prototype.initialize.call(this),C.forEach(function(t){t.prototype.initialize&&t.prototype.initialize.call(this)}.bind(this))},initialized:function(){return this.initialized_},shutdown:function(){return this.shutdown_},prepareEvents:function(){return this.prepareEvents_},timeEvents:function(){return this.timeEvents_},sensorEvents:function(){return this.sensorEvents_},finished:function(){return this.finished_},getURL:function(){return this.getExecutionContext().getURL()},getBrowser:function(){return this},getWorld:function(){return this.world},setExecutionContext:function(t){this.world=new w(t),this.world.setup()},getExecutionContext:function(){return this.world.getExecutionContext()},addBrowserEvent:function(){this.changedTime!==this.getCurrentTime()&&(this.changedTime=this.getCurrentTime(),requestAnimationFrame(this.renderCallback))},traverse:function(t){var e=this.getContext(),n=performance.now();this.systemTime=n-this.systemStartTime,this.advanceTime(t),this.prepareEvents_.processInterests(),this.processEvents(),this.timeEvents_.processInterests(),this.processEvents();var i=performance.now();this.world.traverse(b.CAMERA,null),this.cameraTime=performance.now()-i;var r=performance.now();this.getCollisionCount()&&this.world.traverse(b.COLLISION,null),this.collisionTime=performance.now()-r,this.sensorEvents_.processInterests(),this.processEvents();var o=performance.now();e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),this.world.traverse(b.DISPLAY,null),this.displayTime=performance.now()-o,this.browserTime=performance.now()-n,this.systemStartTime=performance.now(),this.finished_.processInterests()},toStream:function(t){t.string+=Object.prototype.toString.call(this)}}),Object.assign(S,{addContext:function(e){var n=require("x_ite/X3D");C.push(e),Object.assign(S.prototype,e.prototype),t("X3DCanvas").each(function(t,i){var r=n.getBrowser(i);e.call(r),e.prototype.initialize&&e.prototype.initialize.call(r)})}}),S}),define("x_ite/Configuration/SupportedNodes",["x_ite/Bits/X3DConstants"],function(t){"use strict";function e(){this.types=new Map,this.abstractTypes=new Map}var n=0;return e.prototype={addType:function(e,i){t[e]=++n,this.types.set(e,i),this.types.set(e.toUpperCase(),i)},addAbstractType:function(e,i){t[e]=++n},getType:function(t){return this.types.get(t)}},new e}),define("x_ite/Components/Core/X3DMetadataObject",["x_ite/Bits/X3DConstants"],function(t){"use strict";function e(e){this.addType(t.X3DMetadataObject)}return e.prototype={constructor:e,initialize:function(){}},e}),define("x_ite/Components/Core/MetadataBoolean",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Bits/X3DConstants"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),r.call(this,t),this.addType(o.MetadataBoolean)}return s.prototype=Object.assign(Object.create(i.prototype),r.prototype,{constructor:s,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOutput,"name",new t.SFString),new e(o.inputOutput,"reference",new t.SFString),new e(o.inputOutput,"value",new t.MFBool)]),getTypeName:function(){return"MetadataBoolean"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),s}),define("x_ite/Components/Core/MetadataDouble",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Bits/X3DConstants"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),r.call(this,t),this.addType(o.MetadataDouble)}return s.prototype=Object.assign(Object.create(i.prototype),r.prototype,{constructor:s,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOutput,"name",new t.SFString),new e(o.inputOutput,"reference",new t.SFString),new e(o.inputOutput,"value",new t.MFDouble)]),getTypeName:function(){return"MetadataDouble"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),s}),define("x_ite/Components/Core/MetadataFloat",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Bits/X3DConstants"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),r.call(this,t),this.addType(o.MetadataFloat)}return s.prototype=Object.assign(Object.create(i.prototype),r.prototype,{constructor:s,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOutput,"name",new t.SFString),new e(o.inputOutput,"reference",new t.SFString),new e(o.inputOutput,"value",new t.MFFloat)]),getTypeName:function(){return"MetadataFloat"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),s}),define("x_ite/Components/Core/MetadataInteger",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Bits/X3DConstants"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),r.call(this,t),this.addType(o.MetadataInteger)}return s.prototype=Object.assign(Object.create(i.prototype),r.prototype,{constructor:s,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOutput,"name",new t.SFString),new e(o.inputOutput,"reference",new t.SFString),new e(o.inputOutput,"value",new t.MFInt32)]),getTypeName:function(){return"MetadataInteger"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),s}),define("x_ite/Components/Core/MetadataSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Bits/X3DConstants"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),r.call(this,t),this.addType(o.MetadataSet)}return s.prototype=Object.assign(Object.create(i.prototype),r.prototype,{constructor:s,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOutput,"name",new t.SFString),new e(o.inputOutput,"reference",new t.SFString),new e(o.inputOutput,"value",new t.MFNode)]),getTypeName:function(){return"MetadataSet"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),s}),define("x_ite/Components/Core/MetadataString",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Bits/X3DConstants"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),r.call(this,t),this.addType(o.MetadataString)}return s.prototype=Object.assign(Object.create(i.prototype),r.prototype,{constructor:s,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOutput,"name",new t.SFString),new e(o.inputOutput,"reference",new t.SFString),new e(o.inputOutput,"value",new t.MFString)]),getTypeName:function(){return"MetadataString"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),s}),define("x_ite/Components/Core/X3DInfoNode",["x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(t,e){"use strict";function n(n){t.call(this,n),this.addType(e.X3DInfoNode)}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n}),n}),define("x_ite/Components/Core/WorldInfo",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DInfoNode","x_ite/Bits/X3DConstants"],function(t,e,n,i,r){"use strict";function o(t){i.call(this,t),this.addType(r.WorldInfo)}return o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.initializeOnly,"title",new t.SFString),new e(r.initializeOnly,"info",new t.MFString)]),getTypeName:function(){return"WorldInfo"},getComponentName:function(){return"Core"},getContainerField:function(){return"children"}}),o}),define("x_ite/Components/Core",["x_ite/Configuration/SupportedNodes","x_ite/Components/Core/MetadataBoolean","x_ite/Components/Core/MetadataDouble","x_ite/Components/Core/MetadataFloat","x_ite/Components/Core/MetadataInteger","x_ite/Components/Core/MetadataSet","x_ite/Components/Core/MetadataString","x_ite/Components/Core/WorldInfo","x_ite/Components/Core/X3DBindableNode","x_ite/Components/Core/X3DChildNode","x_ite/Components/Core/X3DInfoNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DPrototypeInstance","x_ite/Components/Core/X3DSensorNode"],function(t,e,n,i,r,o,s,a,u,l,c,h,d,p,f){"use strict";var g={MetadataBoolean:e,MetadataDouble:n,MetadataFloat:i,MetadataInteger:r,MetadataSet:o,MetadataString:s,WorldInfo:a},m={X3DBindableNode:u,X3DChildNode:l,X3DInfoNode:c,X3DMetadataObject:h,X3DNode:d,X3DPrototypeInstance:p,X3DSensorNode:f};for(var x in g)t.addType(x,g[x]);for(var x in m)t.addAbstractType(x,m[x])}),define("x_ite/Components/EnvironmentalEffects/FogCoordinate",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Bits/X3DConstants"],function(t,e,n,i,r){"use strict";function o(t){i.call(this,t),this.addType(r.FogCoordinate),this.depth_.setUnit("length")}return o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"depth",new t.MFFloat)]),getTypeName:function(){return"FogCoordinate"},getComponentName:function(){return"EnvironmentalEffects"},getContainerField:function(){return"fogCoord"},initialize:function(){i.prototype.initialize.call(this),this.depth_.addInterest("set_depth__",this),this.set_depth__()},set_depth__:function(){this.depth=this.depth_.getValue(),this.length=this.depth_.length},isEmpty:function(){return 0===this.length},getSize:function(){return this.length},addDepth:function(t,e){t<this.length?e.push(this.depth[t]):this.length&&e.push(this.depth[this.length-1])},addDepths:function(t,e){var n=this.length;if(n){const o=this.depth;for(var i=0;i<n;++i)t.push(o[i]);for(var r=o[n-1],i=n;i<e;++i)t.push(r)}}}),o}),define("x_ite/Components/EnvironmentalEffects/LocalFog",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Components/EnvironmentalEffects/X3DFogObject","x_ite/Bits/X3DConstants"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),r.call(this,t),this.addType(o.LocalFog)}return s.prototype=Object.assign(Object.create(i.prototype),r.prototype,{constructor:s,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOutput,"enabled",new t.SFBool(!0)),new e(o.inputOutput,"fogType",new t.SFString("LINEAR")),new e(o.inputOutput,"color",new t.SFColor(1,1,1)),new e(o.inputOutput,"visibilityRange",new t.SFFloat)]),
getTypeName:function(){return"LocalFog"},getComponentName:function(){return"EnvironmentalEffects"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),r.prototype.initialize.call(this)},push:function(t){if(this.enabled_.getValue()){var e=this.getFogs().pop();e.set(this,t.getModelViewMatrix().get()),t.pushLocalFog(e)}},pop:function(t){this.enabled_.getValue()&&t.getBrowser().getLocalFogs().push(t.popLocalFog())}}),s}),define("x_ite/Components/EnvironmentalEffects/TextureBackground",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/EnvironmentalEffects/X3DBackgroundNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(o.TextureBackground)}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOnly,"set_bind",new t.SFBool),new e(o.inputOutput,"skyAngle",new t.MFFloat),new e(o.inputOutput,"skyColor",new t.MFColor(0,0,0)),new e(o.inputOutput,"groundAngle",new t.MFFloat),new e(o.inputOutput,"groundColor",new t.MFColor),new e(o.inputOutput,"transparency",new t.SFFloat),new e(o.outputOnly,"isBound",new t.SFBool),new e(o.outputOnly,"bindTime",new t.SFTime),new e(o.inputOutput,"frontTexture",new t.SFNode),new e(o.inputOutput,"backTexture",new t.SFNode),new e(o.inputOutput,"leftTexture",new t.SFNode),new e(o.inputOutput,"rightTexture",new t.SFNode),new e(o.inputOutput,"topTexture",new t.SFNode),new e(o.inputOutput,"bottomTexture",new t.SFNode)]),getTypeName:function(){return"TextureBackground"},getComponentName:function(){return"EnvironmentalEffects"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.frontTexture_.addInterest("set_frontTexture__",this),this.backTexture_.addInterest("set_backTexture__",this),this.leftTexture_.addInterest("set_leftTexture__",this),this.rightTexture_.addInterest("set_rightTexture__",this),this.topTexture_.addInterest("set_topTexture__",this),this.bottomTexture_.addInterest("set_bottomTexture__",this),this.set_frontTexture__(this.frontTexture_),this.set_backTexture__(this.backTexture_),this.set_leftTexture__(this.leftTexture_),this.set_rightTexture__(this.rightTexture_),this.set_topTexture__(this.topTexture_),this.set_bottomTexture__(this.bottomTexture_)},set_frontTexture__:function(){i.prototype.set_frontTexture__.call(this,r(o.X3DTextureNode,this.frontTexture_))},set_backTexture__:function(){i.prototype.set_backTexture__.call(this,r(o.X3DTextureNode,this.backTexture_))},set_leftTexture__:function(){i.prototype.set_leftTexture__.call(this,r(o.X3DTextureNode,this.leftTexture_))},set_rightTexture__:function(){i.prototype.set_rightTexture__.call(this,r(o.X3DTextureNode,this.rightTexture_))},set_topTexture__:function(){i.prototype.set_topTexture__.call(this,r(o.X3DTextureNode,this.topTexture_))},set_bottomTexture__:function(){i.prototype.set_bottomTexture__.call(this,r(o.X3DTextureNode,this.bottomTexture_))}}),s}),define("x_ite/Components/EnvironmentalEffects",["x_ite/Configuration/SupportedNodes","x_ite/Components/EnvironmentalEffects/Background","x_ite/Components/EnvironmentalEffects/Fog","x_ite/Components/EnvironmentalEffects/FogCoordinate","x_ite/Components/EnvironmentalEffects/LocalFog","x_ite/Components/EnvironmentalEffects/TextureBackground","x_ite/Components/EnvironmentalEffects/X3DBackgroundNode","x_ite/Components/EnvironmentalEffects/X3DFogObject"],function(t,e,n,i,r,o,s,a){"use strict";var u={Background:e,Fog:n,FogCoordinate:i,LocalFog:r,TextureBackground:o},l={X3DBackgroundNode:s,X3DFogObject:a};for(var c in u)t.addType(c,u[c]);for(var c in l)t.addAbstractType(c,l[c])}),define("x_ite/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode",["x_ite/Fields","x_ite/Components/Core/X3DSensorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,n,i){"use strict";function r(i){e.call(this,i),this.addType(n.X3DEnvironmentalSensorNode),this.addChildObjects("traversed",new t.SFBool(!0)),this.size_.setUnit("length"),this.center_.setUnit("length"),this.zeroTest=!1,this.currentTraversed=!0}return r.prototype=Object.assign(Object.create(e.prototype),{constructor:r,initialize:function(){e.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this),this.enabled_.addInterest("set_live__",this),this.size_.addInterest("set_live__",this),this.traversed_.addInterest("set_live__",this),this.set_live__()},set_live__:function(){!(this.traversed_.getValue()&&this.isLive().getValue()&&this.enabled_.getValue())||this.zeroTest&&this.size_.getValue().equals(i.Zero)?(this.getBrowser().sensorEvents().removeInterest("update",this),this.isActive_.getValue()&&(this.isActive_=!1,this.exitTime_=this.getBrowser().getCurrentTime())):this.getBrowser().sensorEvents().addInterest("update",this)},setZeroTest:function(t){this.zeroTest=t},getZeroTest:function(){return this.zeroTest},setTraversed:function(t){t?this.traversed_.getValue()===!1&&(this.traversed_=!0):this.currentTraversed!==this.traversed_.getValue()&&(this.traversed_=this.currentTraversed),this.currentTraversed=t},getTraversed:function(){return this.currentTraversed},update:function(){}}),r}),define("x_ite/Components/EnvironmentalSensor/ProximitySensor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(t,e,n,i,r,o,s,a,u){"use strict";function l(t){i.call(this,t),this.addType(o.ProximitySensor),this.setCameraObject(!0),this.centerOfRotation_changed_.setUnit("length"),this.position_changed_.setUnit("length"),this.setZeroTest(!0),this.viewpoint=null,this.modelMatrix=new u,this.inside=!1}return l.prototype=Object.assign(Object.create(i.prototype),{constructor:l,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOutput,"enabled",new t.SFBool(!0)),new e(o.inputOutput,"size",new t.SFVec3f),new e(o.inputOutput,"center",new t.SFVec3f),new e(o.outputOnly,"enterTime",new t.SFTime),new e(o.outputOnly,"exitTime",new t.SFTime),new e(o.outputOnly,"isActive",new t.SFBool),new e(o.outputOnly,"position_changed",new t.SFVec3f),new e(o.outputOnly,"orientation_changed",new t.SFRotation),new e(o.outputOnly,"centerOfRotation_changed",new t.SFVec3f)]),getTypeName:function(){return"ProximitySensor"},getComponentName:function(){return"EnvironmentalSensor"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.enabled_.addInterest("set_enabled__",this),this.size_.addInterest("set_extents__",this),this.center_.addInterest("set_extents__",this),this.traversed_.addFieldInterest(this.isCameraObject_),this.min=new s(0,0,0),this.max=new s(0,0,0),this.set_enabled__(),this.set_extents__()},set_enabled__:function(){this.setCameraObject(this.enabled_.getValue()),this.enabled_.getValue()?delete this.traverse:this.traverse=Function.prototype},set_extents__:function(){var t=this.size_.getValue(),e=this.center_.getValue(),n=t.x/2,i=t.y/2,r=t.z/2,o=e.x,s=e.y,a=e.z;this.min.set(o-n,s-i,a-r),this.max.set(o+n,s+i,a+r)},update:function(){var t=new u,e=new u,n=new s(0,0,0),i=new a(0,0,1,0),r=new s(0,0,0);return function(){try{if(this.inside&&this.getTraversed()){var o=this.modelMatrix;e.assign(this.viewpoint.getModelMatrix()),e.translate(this.viewpoint.getUserCenterOfRotation()),e.multRight(t.assign(o).inverse()),o.multRight(this.viewpoint.getInverseCameraSpaceMatrix()),o.get(null,i),o.inverse(),n.set(o[12],o[13],o[14]),i.inverse(),r.set(e[12],e[13],e[14]),this.isActive_.getValue()?(this.position_changed_.getValue().equals(n)||(this.position_changed_=n),this.orientation_changed_.getValue().equals(i)||(this.orientation_changed_=i),this.centerOfRotation_changed_.getValue().equals(r)||(this.centerOfRotation_changed_=r)):(this.isActive_=!0,this.enterTime_=this.getBrowser().getCurrentTime(),this.position_changed_=n,this.orientation_changed_=i,this.centerOfRotation_changed_=r),this.inside=!1}else this.isActive_.getValue()&&(this.isActive_=!1,this.exitTime_=this.getBrowser().getCurrentTime())}catch(t){}this.setTraversed(!1)}}(),traverse:function(){var t=new u,e=new s(0,0,0),n=new s(-1,-1,-1);return function(i,o){try{switch(i){case r.CAMERA:return this.viewpoint=o.getViewpoint(),void this.modelMatrix.assign(o.getModelViewMatrix().get());case r.DISPLAY:if(this.setTraversed(!0),this.inside)return;return void(this.size_.getValue().equals(n)?this.inside=!0:(t.assign(o.getModelViewMatrix().get()).inverse(),e.set(t[12],t[13],t[14]),this.inside=this.intersectsPoint(e)))}}catch(t){console.log(t)}}}(),intersectsPoint:function(t){var e=this.min,n=this.max;return e.x<=t.x&&n.x>=t.x&&e.y<=t.y&&n.y>=t.y&&e.z<=t.z&&n.z>=t.z}}),l}),define("x_ite/Components/EnvironmentalSensor/TransformSensor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","x_ite/Bits/X3DCast","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Box3","standard/Utility/ObjectCache"],function(t,e,n,i,r,o,s,a,u,l,c,h){"use strict";function d(t){i.call(this,t),this.addType(o.TransformSensor),this.position_changed_.setUnit("length"),this.setZeroTest(!0),this.bbox=new c,this.targetObjectNode=null,this.modelMatrices=[],this.targetBBoxes=[]}var p=h(l),f=h(c);return d.prototype=Object.assign(Object.create(i.prototype),{constructor:d,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOutput,"enabled",new t.SFBool(!0)),new e(o.inputOutput,"size",new t.SFVec3f),new e(o.inputOutput,"center",new t.SFVec3f),new e(o.outputOnly,"enterTime",new t.SFTime),new e(o.outputOnly,"exitTime",new t.SFTime),new e(o.outputOnly,"isActive",new t.SFBool),new e(o.outputOnly,"position_changed",new t.SFVec3f),new e(o.outputOnly,"orientation_changed",new t.SFRotation),new e(o.inputOutput,"targetObject",new t.SFNode)]),getTypeName:function(){return"TransformSensor"},getComponentName:function(){return"EnvironmentalSensor"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.isLive().addInterest("set_enabled__",this),this.enabled_.addInterest("set_enabled__",this),this.size_.addInterest("set_enabled__",this),this.size_.addInterest("set_bbox__",this),this.center_.addInterest("set_bbox__",this),this.targetObject_.addInterest("set_targetObject__",this),this.set_bbox__(),this.set_targetObject__()},set_live__:function(){},set_enabled__:function(){this.isLive().getValue()&&this.targetObjectNode&&this.enabled_.getValue()&&!this.size_.getValue().equals(a.Zero)?(this.setPickableObject(!0),this.getBrowser().addTransformSensor(this),this.targetObjectNode.addTransformSensor(this)):(this.setPickableObject(!1),this.getBrowser().removeTransformSensor(this),this.targetObjectNode&&this.targetObjectNode.removeTransformSensor(this),this.isActive_.getValue()&&(this.isActive_=!1,this.exitTime_=this.getBrowser().getCurrentTime()))},set_bbox__:function(){this.bbox.set(this.size_.getValue(),this.center_.getValue())},set_targetObject__:function(){this.targetObjectNode=null;try{for(var t=this.targetObject_.getValue().getInnerNode(),e=t.getType(),n=e.length-1;n>=0;--n)switch(e[n]){case o.X3DGroupingNode:case o.X3DShapeNode:this.targetObjectNode=t;break;default:continue}}catch(t){}this.set_enabled__()},traverse:function(t,e){t===r.PICKING&&this.getPickableObject()&&this.modelMatrices.push(p.pop().assign(e.getModelViewMatrix().get()))},collect:function(t){this.targetBBoxes.push(f.pop().assign(t))},process:function(){var t=new c,e=new a(0,0,0),n=new u(0,0,1,0),i=new a(-1,-1,-1);return function(){for(var r=this.modelMatrices,o=this.targetBBoxes,s=!1,a=0,u=r.length;a<u;++a){var l=r[a];t.assign(this.bbox).multRight(l);for(var c=0,h=o.length;c<h;++c){var d=o[c];(this.size_.getValue().equals(i)||t.intersectsBox(d))&&(s=!0,d.multRight(l.inverse()).getMatrix().get(e,n)),f.push(d)}p.push(l)}s?this.isActive_.getValue()?(this.position_changed_.getValue().equals(e)||(this.position_changed_=e),this.orientation_changed_.getValue().equals(n)||(this.orientation_changed_=n)):(this.isActive_=!0,this.enterTime_=this.getBrowser().getCurrentTime(),this.position_changed_=e,this.orientation_changed_=n):this.isActive_.getValue()&&(this.isActive_=!1,this.exitTime_=this.getBrowser().getCurrentTime()),this.modelMatrices.length=0,this.targetBBoxes.length=0}}()}),d}),define("x_ite/Components/EnvironmentalSensor/VisibilitySensor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Geometry/Box3"],function(t,e,n,i,r,o,s,a){"use strict";function u(t){i.call(this,t),this.addType(o.VisibilitySensor),this.setZeroTest(!1),this.visible=!1}return u.prototype=Object.assign(Object.create(i.prototype),{constructor:u,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOutput,"enabled",new t.SFBool(!0)),new e(o.inputOutput,"size",new t.SFVec3f),new e(o.inputOutput,"center",new t.SFVec3f),new e(o.outputOnly,"enterTime",new t.SFTime),new e(o.outputOnly,"exitTime",new t.SFTime),new e(o.outputOnly,"isActive",new t.SFBool)]),getTypeName:function(){return"VisibilitySensor"},getComponentName:function(){return"EnvironmentalSensor"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.enabled_.addInterest("set_enabled__",this),this.set_enabled__()},set_enabled__:function(){this.enabled_.getValue()?delete this.traverse:this.traverse=Function.prototype},update:function(){this.visible&&this.getTraversed()?(this.isActive_.getValue()||(this.isActive_=!0,this.enterTime_=this.getBrowser().getCurrentTime()),this.visible=!1):this.isActive_.getValue()&&(this.isActive_=!1,this.exitTime_=this.getBrowser().getCurrentTime()),this.setTraversed(!1)},traverse:function(){var t=new a,e=new s(-1,-1,-1);return function(n,i){n===r.DISPLAY&&(this.setTraversed(!0),this.visible||(this.size_.getValue().equals(e)?this.visible=!0:(t.set(this.size_.getValue(),this.center_.getValue()).multRight(i.getModelViewMatrix().get()),this.visible=i.getViewVolume().intersectsBox(t))))}}()}),u}),define("x_ite/Components/EnvironmentalSensor",["x_ite/Configuration/SupportedNodes","x_ite/Components/EnvironmentalSensor/ProximitySensor","x_ite/Components/EnvironmentalSensor/TransformSensor","x_ite/Components/EnvironmentalSensor/VisibilitySensor","x_ite/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode"],function(t,e,n,i,r){"use strict";var o={ProximitySensor:e,TransformSensor:n,VisibilitySensor:i},s={X3DEnvironmentalSensorNode:r};for(var a in o)t.addType(a,o[a]);for(var a in s)t.addAbstractType(a,s[a])}),define("x_ite/Components/Followers/ColorChaser",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Color3","standard/Math/Numbers/Vector3"],function(t,e,n,i,r,o,s){"use strict";function a(t){i.call(this,t),this.addType(r.ColorChaser)}var u=new s(0,0,0),l=new s(0,0,0),c=new s(0,0,0),h=new s(0,0,0);return a.prototype=Object.assign(Object.create(i.prototype),{constructor:a,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_value",new t.SFColor),new e(r.inputOnly,"set_destination",new t.SFColor),new e(r.initializeOnly,"initialValue",new t.SFColor(.8,.8,.8)),new e(r.initializeOnly,"initialDestination",new t.SFColor(.8,.8,.8)),new e(r.initializeOnly,"duration",new t.SFTime(1)),new e(r.outputOnly,"isActive",new t.SFBool),new e(r.outputOnly,"value_changed",new t.SFColor)]),getTypeName:function(){return"ColorChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0,0)},getValue:function(){return this.set_value_.getValue().getHSV(h)},getDestination:function(){return this.set_destination_.getValue().getHSV(h)},getInitialValue:function(){return this.initialValue_.getValue().getHSV(u)},getInitialDestination:function(){return this.initialDestination_.getValue().getHSV(l)},setValue:function(t){this.value_changed_.setHSV(t.x,t.y,t.z)},interpolate:function(t,e,n){return o.lerp(t,e,n,h)},step:function(t,e,n){c.assign(this.output).add(t).subtract(e),o.lerp(this.output,c,n,this.output)}}),a}),define("x_ite/Components/Followers/X3DDamperNode",["x_ite/Components/Followers/X3DFollowerNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(t,e,n){"use strict";function i(n){t.call(this,n),this.addType(e.X3DDamperNode)}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,initialize:function(){t.prototype.initialize.call(this),this.order_.addInterest("set_order__",this),this.set_value_.addInterest("set_value__",this),this.set_destination_.addInterest("set_destination__",this);var e=this.getBuffer(),n=this.getInitialValue(),i=this.getInitialDestination();e[0]=this.duplicate(i);for(var r=1,o=this.getOrder()+1;r<o;++r)e[r]=this.duplicate(n);this.equals(i,n,this.getTolerance())?this.setValue(i):this.set_active(!0)},getOrder:function(){return n.clamp(this.order_.getValue(),0,5)},getTolerance:function(){return this.tolerance_.getValue()<0?1e-4:this.tolerance_.getValue()},prepareEvents:function(){var t=this.getBuffer(),e=t.length-1;if(this.tau_.getValue()){for(var n=1/this.getBrowser().currentFrameRate,i=Math.exp(-n/this.tau_.getValue()),r=0;r<e;++r)try{this.assign(t,r+1,this.interpolate(t[r],t[r+1],i))}catch(t){}if(this.setValue(t[e]),!this.equals(t[e],t[0],this.getTolerance()))return}else this.setValue(t[0]),e=0;for(var r=1,o=t.length;r<o;++r)this.assign(t,r,t[e]);this.set_active(!1)},set_value__:function(){for(var t=this.getBuffer(),e=this.getValue(),n=1,i=t.length;n<i;++n)this.assign(t,n,e);this.setValue(e),this.set_active(!0)},set_destination__:function(){this.assign(this.getBuffer(),0,this.getDestination()),this.set_active(!0)},set_order__:function(){for(var t=this.getBuffer(),e=t[t.length-1],n=t.length,i=this.getOrder()+1;n<i;++n)t[n]=this.duplicate(e);t.length=i}}),i}),define("x_ite/Components/Followers/ColorDamper",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Color3","standard/Math/Numbers/Vector3"],function(t,e,n,i,r,o,s){"use strict";function a(t){i.call(this,t),this.addType(r.ColorDamper)}var u=new s(0,0,0),l=new s(0,0,0),c=new s(0,0,0),h=new s(0,0,0);return a.prototype=Object.assign(Object.create(i.prototype),{constructor:a,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_value",new t.SFColor),new e(r.inputOnly,"set_destination",new t.SFColor),new e(r.initializeOnly,"initialValue",new t.SFColor(.8,.8,.8)),new e(r.initializeOnly,"initialDestination",new t.SFColor(.8,.8,.8)),new e(r.initializeOnly,"order",new t.SFInt32(3)),new e(r.inputOutput,"tau",new t.SFTime(.3)),new e(r.inputOutput,"tolerance",new t.SFFloat(-1)),new e(r.outputOnly,"isActive",new t.SFBool),new e(r.outputOnly,"value_changed",new t.SFColor)]),getTypeName:function(){return"ColorDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0,0)},getValue:function(){return this.set_value_.getValue().getHSV(h)},getDestination:function(){return this.set_destination_.getValue().getHSV(h)},getInitialValue:function(){return this.initialValue_.getValue().getHSV(l)},getInitialDestination:function(){return this.initialDestination_.getValue().getHSV(c)},setValue:function(t){this.value_changed_.setHSV(t.x,t.y,t.z)},equals:function(t,e,n){return u.assign(t).subtract(e).abs()<n},interpolate:function(t,e,n){return o.lerp(t,e,n,h)}}),a}),define("x_ite/Browser/Followers/X3DArrayFollowerTemplate",[],function(){"use strict";return function(t){function e(){this.array=this.getArray()}return e.prototype={getValue:function(){return this.set_value_},getDestination:function(){return this.set_destination_},getInitialValue:function(){return this.initialValue_},getInitialDestination:function(){return this.initialDestination_},assign:function(t,e,n){t[e].setValue(n)},equals:function(t,e,n){for(var i=this.a,r=0,o=0,s=t.length;o<s;++o)r=Math.max(i.assign(t[o].getValue()).subtract(e[o].getValue()).abs());return r<n},interpolate:function(t,e,n){var i=this.array;i.length=t.length;for(var r=0,o=t.length;r<o;++r)i[r]=t[r].getValue().lerp(e[r].getValue(),n);return i},set_value__:function(){this.getBuffer()[0].length=this.set_value_.length,t.prototype.set_value__.call(this)},set_destination__:function(){for(var e=this.getBuffer(),n=this.set_destination_.length,i=0,r=e.length;i<r;++i)e[i].length=n;t.prototype.set_destination__.call(this)}},e}}),define("x_ite/Browser/Followers/X3DArrayChaserTemplate",["x_ite/Browser/Followers/X3DArrayFollowerTemplate"],function(t){"use strict";return function(e){function n(){this.array=this.getArray()}var i=t(e);return Object.assign(n.prototype,i.prototype,{setPreviousValue:function(t){this.previousValue.setValue(t)},step:function(t,e,n){var i=this.output,r=this.deltaOut;r.length=i.length;for(var o=0,s=i.length;o<s;++o){var a=r[o]=t[o];i[o]=i[o].getValue().add(a.getValue().subtract(e[o].getValue()).multiply(n))}}}),n}}),define("x_ite/Components/Followers/CoordinateChaser",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Browser/Followers/X3DArrayChaserTemplate","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,n,i,r,o,s){"use strict";function a(t){i.call(this,t),u.call(this,t),this.addType(o.CoordinateChaser)}var u=r(i);return a.prototype=Object.assign(Object.create(i.prototype),u.prototype,{constructor:a,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOnly,"set_value",new t.MFVec3f),new e(o.inputOnly,"set_destination",new t.MFVec3f),new e(o.initializeOnly,"initialValue",new t.MFVec3f(new s(0,0,0))),new e(o.initializeOnly,"initialDestination",new t.MFVec3f(new s(0,0,0))),new e(o.initializeOnly,"duration",new t.SFTime(1)),new e(o.outputOnly,"isActive",new t.SFBool),new e(o.outputOnly,"value_changed",new t.MFVec3f)]),getTypeName:function(){return"CoordinateChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0,0)},getArray:function(){return new t.MFVec3f}}),a}),define("x_ite/Components/Followers/CoordinateDamper",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Browser/Followers/X3DArrayFollowerTemplate","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,n,i,r,o,s){"use strict";function a(t){i.call(this,t),u.call(this,t),this.addType(o.CoordinateDamper)}var u=r(i);return a.prototype=Object.assign(Object.create(i.prototype),u.prototype,{constructor:a,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOnly,"set_value",new t.MFVec3f),new e(o.inputOnly,"set_destination",new t.MFVec3f),new e(o.initializeOnly,"initialValue",new t.MFVec3f(new s(0,0,0))),new e(o.initializeOnly,"initialDestination",new t.MFVec3f(new s(0,0,0))),new e(o.initializeOnly,"order",new t.SFInt32(3)),new e(o.inputOutput,"tau",new t.SFTime(.3)),new e(o.inputOutput,"tolerance",new t.SFFloat(-1)),new e(o.outputOnly,"isActive",new t.SFBool),new e(o.outputOnly,"value_changed",new t.MFVec3f)]),getTypeName:function(){return"CoordinateDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0,0)},getArray:function(){return new t.MFVec3f}}),a}),define("x_ite/Components/Followers/OrientationDamper",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Rotation4"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.OrientationDamper)}var a=new o(0,0,1,0),u=new o(0,0,1,0);return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_value",new t.SFRotation),new e(r.inputOnly,"set_destination",new t.SFRotation),new e(r.initializeOnly,"initialValue",new t.SFRotation),new e(r.initializeOnly,"initialDestination",new t.SFRotation),new e(r.initializeOnly,"order",new t.SFInt32(3)),new e(r.inputOutput,"tau",new t.SFTime(.3)),new e(r.inputOutput,"tolerance",new t.SFFloat(-1)),new e(r.outputOnly,"isActive",new t.SFBool),new e(r.outputOnly,"value_changed",new t.SFRotation)]),getTypeName:function(){return"OrientationDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new o(0,0,1,0)},equals:function(t,e,n){return a.assign(t).inverse().multRight(e),Math.abs(a.angle)<n},interpolate:function(t,e,n){return u.assign(t).slerp(e,n)}}),s}),define("x_ite/Components/Followers/PositionChaser2D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.PositionChaser2D)}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_value",new t.SFVec2f),new e(r.inputOnly,"set_destination",new t.SFVec2f),new e(r.initializeOnly,"initialValue",new t.SFVec2f),new e(r.initializeOnly,"initialDestination",new t.SFVec2f),new e(r.initializeOnly,"duration",new t.SFTime(1)),new e(r.outputOnly,"isActive",new t.SFBool),new e(r.outputOnly,"value_changed",new t.SFVec2f)]),getTypeName:function(){return"PositionChaser2D"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new o(0,0)}}),s}),define("x_ite/Components/Followers/PositionDamper",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.PositionDamper)}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_value",new t.SFVec3f),new e(r.inputOnly,"set_destination",new t.SFVec3f),new e(r.initializeOnly,"initialValue",new t.SFVec3f),new e(r.initializeOnly,"initialDestination",new t.SFVec3f),new e(r.initializeOnly,"order",new t.SFInt32(3)),new e(r.inputOutput,"tolerance",new t.SFFloat(-1)),new e(r.inputOutput,"tau",new t.SFTime(.3)),new e(r.outputOnly,"value_changed",new t.SFVec3f),new e(r.outputOnly,"isActive",new t.SFBool)]),getTypeName:function(){return"PositionDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new o(0,0,0)}}),s}),define("x_ite/Components/Followers/PositionDamper2D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.PositionDamper2D)}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_value",new t.SFVec2f),new e(r.inputOnly,"set_destination",new t.SFVec2f),new e(r.initializeOnly,"initialValue",new t.SFVec2f),new e(r.initializeOnly,"initialDestination",new t.SFVec2f),new e(r.initializeOnly,"order",new t.SFInt32(3)),new e(r.inputOutput,"tau",new t.SFTime(.3)),new e(r.inputOutput,"tolerance",new t.SFFloat(-1)),new e(r.outputOnly,"isActive",new t.SFBool),new e(r.outputOnly,"value_changed",new t.SFVec2f)]),getTypeName:function(){return"PositionDamper2D"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new o(0,0)}}),s}),define("x_ite/Components/Followers/ScalarChaser",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.ScalarChaser)}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_value",new t.SFFloat),new e(r.inputOnly,"set_destination",new t.SFFloat),new e(r.initializeOnly,"initialValue",new t.SFFloat),new e(r.initializeOnly,"initialDestination",new t.SFFloat),new e(r.initializeOnly,"duration",new t.SFTime(1)),new e(r.outputOnly,"isActive",new t.SFBool),new e(r.outputOnly,"value_changed",new t.SFFloat)]),getTypeName:function(){return"ScalarChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return 0},setPreviousValue:function(t){this.previousValue=t},setDestination:function(t){this.destination=t},duplicate:function(t){return t},assign:function(t,e,n){t[e]=n},equals:function(t,e,n){return Math.abs(t-e)<n},interpolate:function(t,e,n){return o.lerp(t,e,n)},step:function(t,e,n){this.output+=(t-e)*n}}),s}),define("x_ite/Components/Followers/ScalarDamper",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.ScalarDamper)}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_value",new t.SFFloat),new e(r.inputOnly,"set_destination",new t.SFFloat),new e(r.initializeOnly,"initialValue",new t.SFFloat),new e(r.initializeOnly,"initialDestination",new t.SFFloat),new e(r.initializeOnly,"order",new t.SFInt32(3)),new e(r.inputOutput,"tau",new t.SFTime(.3)),new e(r.inputOutput,"tolerance",new t.SFFloat(-1)),new e(r.outputOnly,"isActive",new t.SFBool),new e(r.outputOnly,"value_changed",new t.SFFloat)]),getTypeName:function(){return"ScalarDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return 0},duplicate:function(t){return t},assign:function(t,e,n){t[e]=n},equals:function(t,e,n){return Math.abs(t-e)<n},interpolate:function(t,e,n){return o.lerp(t,e,n)}}),s}),define("x_ite/Components/Followers/TexCoordChaser2D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Browser/Followers/X3DArrayChaserTemplate","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2"],function(t,e,n,i,r,o,s){"use strict";function a(t){i.call(this,t),u.call(this,t),this.addType(o.TexCoordChaser2D)}var u=r(i);return a.prototype=Object.assign(Object.create(i.prototype),u.prototype,{constructor:a,
fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOnly,"set_value",new t.MFVec2f),new e(o.inputOnly,"set_destination",new t.MFVec2f),new e(o.initializeOnly,"initialValue",new t.MFVec2f),new e(o.initializeOnly,"initialDestination",new t.MFVec2f),new e(o.initializeOnly,"duration",new t.SFTime(1)),new e(o.outputOnly,"isActive",new t.SFBool),new e(o.outputOnly,"value_changed",new t.MFVec2f)]),getTypeName:function(){return"TexCoordChaser2D"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0)},getArray:function(){return new t.MFVec2f}}),a}),define("x_ite/Components/Followers/TexCoordDamper2D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Browser/Followers/X3DArrayFollowerTemplate","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2"],function(t,e,n,i,r,o,s){"use strict";function a(t){i.call(this,t),u.call(this,t),this.addType(o.TexCoordDamper2D)}var u=r(i);return a.prototype=Object.assign(Object.create(i.prototype),u.prototype,{constructor:a,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOnly,"set_value",new t.MFVec2f),new e(o.inputOnly,"set_destination",new t.MFVec2f),new e(o.initializeOnly,"initialValue",new t.MFVec2f),new e(o.initializeOnly,"initialDestination",new t.MFVec2f),new e(o.initializeOnly,"order",new t.SFInt32(3)),new e(o.inputOutput,"tau",new t.SFTime(.3)),new e(o.inputOutput,"tolerance",new t.SFFloat(-1)),new e(o.outputOnly,"isActive",new t.SFBool),new e(o.outputOnly,"value_changed",new t.MFVec2f)]),getTypeName:function(){return"TexCoordDamper2D"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0,0)},getArray:function(){return new t.MFVec2f}}),a}),define("x_ite/Components/Followers",["x_ite/Configuration/SupportedNodes","x_ite/Components/Followers/ColorChaser","x_ite/Components/Followers/ColorDamper","x_ite/Components/Followers/CoordinateChaser","x_ite/Components/Followers/CoordinateDamper","x_ite/Components/Followers/OrientationChaser","x_ite/Components/Followers/OrientationDamper","x_ite/Components/Followers/PositionChaser","x_ite/Components/Followers/PositionChaser2D","x_ite/Components/Followers/PositionDamper","x_ite/Components/Followers/PositionDamper2D","x_ite/Components/Followers/ScalarChaser","x_ite/Components/Followers/ScalarDamper","x_ite/Components/Followers/TexCoordChaser2D","x_ite/Components/Followers/TexCoordDamper2D","x_ite/Components/Followers/X3DChaserNode","x_ite/Components/Followers/X3DDamperNode","x_ite/Components/Followers/X3DFollowerNode"],function(t,e,n,i,r,o,s,a,u,l,c,h,d,p,f,g,m,x){"use strict";var v={ColorChaser:e,ColorDamper:n,CoordinateChaser:i,CoordinateDamper:r,OrientationChaser:o,OrientationDamper:s,PositionChaser:a,PositionChaser2D:u,PositionDamper:l,PositionDamper2D:c,ScalarChaser:h,ScalarDamper:d,TexCoordChaser2D:p,TexCoordDamper2D:f},_={X3DChaserNode:g,X3DDamperNode:m,X3DFollowerNode:x};for(var y in v)t.addType(y,v[y]);for(var y in _)t.addAbstractType(y,_[y])}),define("x_ite/Components/Geometry3D/Box",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.Box),this.size_.setUnit("length")}var a=new o(2,2,2);return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.initializeOnly,"size",new t.SFVec3f(2,2,2)),new e(r.initializeOnly,"solid",new t.SFBool(!0))]),getTypeName:function(){return"Box"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},build:function(){var t=this.getBrowser().getBoxOptions(),e=t.getGeometry(),n=this.size_.getValue();if(this.setMultiTexCoords(e.getMultiTexCoords()),this.setNormals(e.getNormals()),n.equals(a))this.setVertices(e.getVertices()),this.getMin().assign(e.getMin()),this.getMax().assign(e.getMax());else{for(var i=o.divide(n,2),r=i.x,s=i.y,u=i.z,l=e.getVertices().getValue(),c=this.getVertices(),h=0;h<l.length;h+=4)c.push(r*l[h],s*l[h+1],u*l[h+2],1);r=Math.abs(r),s=Math.abs(s),u=Math.abs(u),this.getMin().set(-r,-s,-u),this.getMax().set(r,s,u)}this.setSolid(this.solid_.getValue())}}),s}),define("x_ite/Components/Geometry3D/Cone",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(t,e,n,i,r,o,s,a){"use strict";function u(t){i.call(this,t),this.addType(r.Cone),this.height_.setUnit("length"),this.bottomRadius_.setUnit("length")}return u.prototype=Object.assign(Object.create(i.prototype),{constructor:u,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.initializeOnly,"side",new t.SFBool(!0)),new e(r.initializeOnly,"bottom",new t.SFBool(!0)),new e(r.initializeOnly,"height",new t.SFFloat(2)),new e(r.initializeOnly,"bottomRadius",new t.SFFloat(1)),new e(r.initializeOnly,"solid",new t.SFBool(!0))]),getTypeName:function(){return"Cone"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},set_live__:function(){i.prototype.set_live__.call(this),this.isLive().getValue()?this.getBrowser().getConeOptions().addInterest("requestRebuild",this):this.getBrowser().getConeOptions().removeInterest("requestRebuild",this)},build:function(){var t=this.getBrowser().getConeOptions(),e=t.xDimension_.getValue(),n=this.height_.getValue(),i=this.bottomRadius_.getValue(),r=this.getTexCoords(),u=this.getNormals(),l=this.getVertices();this.getMultiTexCoords().push(r);var c=n/2,h=-c,d=o.Polar(1,-Math.PI/2+Math.atan(i/n));if(this.side_.getValue())for(var p=0;p<e;++p){var f=(p+.5)/e,g=2*Math.PI*f,m=o.Polar(d.imag,g),x=p/e,v=2*Math.PI*x,_=o.Polar(-i,v),y=o.Polar(d.imag,v),w=(p+1)/e,b=2*Math.PI*w,S=o.Polar(-i,b),C=o.Polar(d.imag,b);r.push(f,1,0,1),u.push(m.imag,d.real,m.real),l.push(0,c,0,1),r.push(x,0,0,1),u.push(y.imag,d.real,y.real),l.push(_.imag,h,_.real,1),r.push(w,0,0,1),u.push(C.imag,d.real,C.real),l.push(S.imag,h,S.real,1)}if(this.bottom_.getValue()){for(var T=[],F=[],p=e-1;p>-1;--p){var O=p/e,N=2*Math.PI*O,E=o.Polar(-1,N),M=o.multiply(E,i);T.push(new s((E.imag+1)/2,(E.real+1)/2)),F.push(new a(M.imag,h,M.real))}for(var D=T[0],V=F[0],p=1,I=F.length-1;p<I;++p){var B=T[p],L=T[p+1],A=F[p],_=F[p+1];r.push(D.x,D.y,0,1),u.push(0,-1,0),l.push(V.x,V.y,V.z,1),r.push(B.x,B.y,0,1),u.push(0,-1,0),l.push(A.x,A.y,A.z,1),r.push(L.x,L.y,0,1),u.push(0,-1,0),l.push(_.x,_.y,_.z,1)}}this.setSolid(this.solid_.getValue()),this.setExtents()},setExtents:function(){var t=this.bottomRadius_.getValue(),e=this.height_.getValue()/2,n=-e;this.side_.getValue()||this.bottom_.getValue()?this.side_.getValue()?(this.getMin().set(-t,n,-t),this.getMax().set(t,e,t)):(this.getMin().set(-t,n,-t),this.getMax().set(t,n,t)):(this.getMin().set(0,0,0),this.getMax().set(0,0,0))}}),u}),define("x_ite/Components/Geometry3D/Cylinder",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(t,e,n,i,r,o,s,a){"use strict";function u(t){i.call(this,t),this.addType(r.Cylinder),this.height_.setUnit("length"),this.radius_.setUnit("length")}return u.prototype=Object.assign(Object.create(i.prototype),{constructor:u,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.initializeOnly,"top",new t.SFBool(!0)),new e(r.initializeOnly,"side",new t.SFBool(!0)),new e(r.initializeOnly,"bottom",new t.SFBool(!0)),new e(r.initializeOnly,"height",new t.SFFloat(2)),new e(r.initializeOnly,"radius",new t.SFFloat(1)),new e(r.initializeOnly,"solid",new t.SFBool(!0))]),getTypeName:function(){return"Cylinder"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},set_live__:function(){i.prototype.set_live__.call(this),this.isLive().getValue()?this.getBrowser().getCylinderOptions().addInterest("requestRebuild",this):this.getBrowser().getCylinderOptions().removeInterest("requestRebuild",this)},build:function(){var t=this.getBrowser().getCylinderOptions(),e=t.xDimension_.getValue(),n=this.getTexCoords(),i=this.getNormals(),r=this.getVertices();this.getMultiTexCoords().push(n);var u=this.radius_.getValue(),l=this.height_.getValue()/2,c=-l;if(this.side_.getValue())for(var h=0;h<e;++h){var d=h/e,p=2*Math.PI*d,f=o.Polar(-1,p),g=o.multiply(f,u),m=(h+1)/e,x=2*Math.PI*m,v=o.Polar(-1,x),_=o.multiply(v,u);n.push(d,1,0,1),i.push(f.imag,0,f.real),r.push(g.imag,l,g.real,1),n.push(d,0,0,1),i.push(f.imag,0,f.real),r.push(g.imag,c,g.real,1),n.push(m,0,0,1),i.push(v.imag,0,v.real),r.push(_.imag,c,_.real,1),n.push(d,1,0,1),i.push(f.imag,0,f.real),r.push(g.imag,l,g.real,1),n.push(m,0,0,1),i.push(v.imag,0,v.real),r.push(_.imag,c,_.real,1),n.push(m,1,0,1),i.push(v.imag,0,v.real),r.push(_.imag,l,_.real,1)}if(this.top_.getValue()){for(var y=[],w=[],h=0;h<e;++h){var b=h/e,S=2*Math.PI*b,C=o.Polar(-1,S);y.push(new s((C.imag+1)/2,-(C.real-1)/2)),w.push(new a(C.imag*u,l,C.real*u))}for(var T=y[0],F=w[0],h=1,O=w.length-1;h<O;++h){var N=y[h],E=y[h+1],g=w[h],_=w[h+1];n.push(T.x,T.y,0,1),i.push(0,1,0),r.push(F.x,F.y,F.z,1),n.push(N.x,N.y,0,1),i.push(0,1,0),r.push(g.x,g.y,g.z,1),n.push(E.x,E.y,0,1),i.push(0,1,0),r.push(_.x,_.y,_.z,1)}}if(this.bottom_.getValue()){for(var y=[],w=[],h=e-1;h>-1;--h){var b=h/e,S=2*Math.PI*b,C=o.Polar(-1,S);y.push(new s((C.imag+1)/2,(C.real+1)/2)),w.push(new a(C.imag*u,c,C.real*u))}for(var T=y[0],F=w[0],h=1,O=w.length-1;h<O;++h){var N=y[h],E=y[h+1],g=w[h],_=w[h+1];n.push(T.x,T.y,0,1),i.push(0,-1,0),r.push(F.x,F.y,F.z,1),n.push(N.x,N.y,0,1),i.push(0,-1,0),r.push(g.x,g.y,g.z,1),n.push(E.x,E.y,0,1),i.push(0,-1,0),r.push(_.x,_.y,_.z,1)}}this.setSolid(this.solid_.getValue()),this.setExtents()},setExtents:function(){var t=this.radius_.getValue(),e=this.height_.getValue()/2,n=-e;this.top_.getValue()||this.side_.getValue()||this.bottom_.getValue()?this.top_.getValue()||this.side_.getValue()?this.bottom_.getValue()||this.side_.getValue()?(this.getMin().set(-t,n,-t),this.getMax().set(t,e,t)):(this.getMin().set(-t,e,-t),this.getMax().set(t,e,t)):(this.getMin().set(-t,n,-t),this.getMax().set(t,n,t)):(this.getMin().set(0,0,0),this.getMax().set(0,0,0))}}),u}),define("x_ite/Components/Geometry3D/ElevationGrid",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(t,e,n,i,r,o,s,a,u){"use strict";function l(t){i.call(this,t),this.addType(o.ElevationGrid),this.xSpacing_.setUnit("length"),this.zSpacing_.setUnit("length"),this.creaseAngle_.setUnit("angle"),this.height_.setUnit("length"),this.fogCoordNode=null,this.colorNode=null,this.texCoordNode=null,this.normalNode=null,this.coordNode=null}return l.prototype=Object.assign(Object.create(i.prototype),{constructor:l,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.initializeOnly,"xDimension",new t.SFInt32),new e(o.initializeOnly,"zDimension",new t.SFInt32),new e(o.initializeOnly,"xSpacing",new t.SFFloat(1)),new e(o.initializeOnly,"zSpacing",new t.SFFloat(1)),new e(o.initializeOnly,"solid",new t.SFBool(!0)),new e(o.initializeOnly,"ccw",new t.SFBool(!0)),new e(o.initializeOnly,"creaseAngle",new t.SFFloat),new e(o.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new e(o.initializeOnly,"normalPerVertex",new t.SFBool(!0)),new e(o.inputOutput,"attrib",new t.MFNode),new e(o.inputOutput,"fogCoord",new t.SFNode),new e(o.inputOutput,"color",new t.SFNode),new e(o.inputOutput,"texCoord",new t.SFNode),new e(o.inputOutput,"normal",new t.SFNode),new e(o.inputOutput,"height",new t.MFFloat)]),getTypeName:function(){return"ElevationGrid"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},initialize:function(){i.prototype.initialize.call(this),this.attrib_.addInterest("set_attrib__",this),this.fogCoord_.addInterest("set_fogCoord__",this),this.color_.addInterest("set_color__",this),this.texCoord_.addInterest("set_texCoord__",this),this.normal_.addInterest("set_normal__",this),this.set_attrib__(),this.set_fogCoord__(),this.set_color__(),this.set_texCoord__(),this.set_normal__()},set_attrib__:function(){for(var t=this.getAttrib(),e=0,n=t.length;e<n;++e)t[e].removeInterest("requestRebuild",this);t.length=0;for(var e=0,n=this.attrib_.length;e<n;++e){var i=r(o.X3DVertexAttributeNode,this.attrib_[e]);i&&t.push(i)}for(var e=0;e<this.attribNodes.length;++e)t[e].addInterest("requestRebuild",this)},set_fogCoord__:function(){this.fogCoordNode&&this.fogCoordNode.removeInterest("requestRebuild",this),this.fogCoordNode=r(o.FogCoordinate,this.fogCoord_),this.fogCoordNode&&this.fogCoordNode.addInterest("requestRebuild",this)},set_color__:function(){this.colorNode&&(this.colorNode.removeInterest("requestRebuild",this),this.colorNode.transparent_.removeInterest("set_transparent__",this)),this.colorNode=r(o.X3DColorNode,this.color_),this.colorNode?(this.colorNode.addInterest("requestRebuild",this),this.colorNode.transparent_.addInterest("set_transparent__",this),this.set_transparent__()):this.setTransparent(!1)},set_transparent__:function(){this.setTransparent(this.colorNode.getTransparent())},set_texCoord__:function(){this.texCoordNode&&this.texCoordNode.removeInterest("requestRebuild",this),this.texCoordNode=r(o.X3DTextureCoordinateNode,this.texCoord_),this.texCoordNode&&this.texCoordNode.addInterest("requestRebuild",this),this.setTextureCoordinate(this.texCoordNode)},set_normal__:function(){this.normalNode&&this.normalNode.removeInterest("requestRebuild",this),this.normalNode=r(o.X3DNormalNode,this.normal_),this.normalNode&&this.normalNode.addInterest("requestRebuild",this)},getColor:function(){return this.colorNode},getTexCoord:function(){return this.texCoordNode},getNormal:function(){return this.normalNode},getHeight:function(t){return t<this.height_.length?this.height_[t]:0},createTexCoords:function(){for(var t=[],e=this.xDimension_.getValue(),n=this.zDimension_.getValue(),i=e-1,r=n-1,o=0;o<n;++o)for(var s=0;s<e;++s)t.push(new a(s/i,o/r));return t},createNormals:function(t,e,n){for(var i=!this.ccw_.getValue(),r=[],o=[],a=0;a<t.length;++a)r[a]=[];for(var l=0;l<e.length;l+=3){var c=e[l],h=e[l+1],d=e[l+2];r[c].push(o.length),r[h].push(o.length+1),r[d].push(o.length+2);var p=s.normal(t[c],t[h],t[d],new u(0,0,0));i&&p.negate(),o.push(p),o.push(p),o.push(p)}return this.refineNormals(r,o,this.creaseAngle_.getValue())},createCoordIndex:function(){for(var t=[],e=this.xDimension_.getValue(),n=this.zDimension_.getValue(),i=e-1,r=n-1,o=0;o<r;++o)for(var s=0;s<i;++s){var a=o*e+s,u=(o+1)*e+s,l=(o+1)*e+(s+1),c=o*e+(s+1);t.push(a),t.push(u),t.push(l),t.push(a),t.push(l),t.push(c)}return t},createPoints:function(){for(var t=[],e=this.xDimension_.getValue(),n=this.zDimension_.getValue(),i=this.xSpacing_.getValue(),r=this.zSpacing_.getValue(),o=0;o<n;++o)for(var s=0;s<e;++s)t.push(new u(i*s,this.getHeight(s+o*e),r*o));return t},build:function(){if(!(this.xDimension_.getValue()<2||this.zDimension_.getValue()<2)){var t=this.colorPerVertex_.getValue(),e=this.normalPerVertex_.getValue(),n=this.createCoordIndex(),i=this.getAttrib(),r=i.length,o=this.getAttribs(),s=this.fogCoordNode,a=this.getColor(),u=this.getTexCoord(),l=this.getNormal(),c=this.createPoints(),h=this.getFogDepths(),d=this.getColors(),p=this.getMultiTexCoords(),f=this.getNormals(),g=this.getVertices(),m=0;if(u)u.init(p);else{var x=this.createTexCoords(),v=this.getTexCoords();p.push(v)}for(var _=0,y=n.length;_<y;++m)for(var w=0;w<6;++w,++_){for(var b=n[_],S=c[b],C=0;C<r;++C)i[C].addValue(b,o[C]);if(s&&s.addDepth(b,h),a&&(t?a.addColor(b,d):a.addColor(m,d)),u)u.addTexCoord(b,p);else{var T=x[b];v.push(T.x,T.y,0,1)}l&&(e?l.addVector(b,f):l.addVector(m,f)),g.push(S.x,S.y,S.z,1)}if(!l)for(var F=this.createNormals(c,n),O=0;O<F.length;++O){var N=F[O];f.push(N.x,N.y,N.z)}this.setSolid(this.solid_.getValue()),this.setCCW(this.ccw_.getValue())}}}),l}),define("x_ite/Components/Geometry3D/Extrusion",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(t,e,n,i,r,o,s,a,u,l){"use strict";function c(t){i.call(this,t),this.addType(r.Extrusion),this.creaseAngle_.setUnit("angle"),this.crossSection_.setUnit("length"),this.spine_.setUnit("length")}return c.prototype=Object.assign(Object.create(i.prototype),{constructor:c,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.initializeOnly,"beginCap",new t.SFBool(!0)),new e(r.initializeOnly,"endCap",new t.SFBool(!0)),new e(r.initializeOnly,"solid",new t.SFBool(!0)),new e(r.initializeOnly,"ccw",new t.SFBool(!0)),new e(r.initializeOnly,"convex",new t.SFBool(!0)),new e(r.initializeOnly,"creaseAngle",new t.SFFloat),new e(r.inputOutput,"crossSection",new t.MFVec2f(new s(1,1),new s(1,-1),new s(-1,-1),new s(-1,1),new s(1,1))),new e(r.inputOutput,"orientation",new t.MFRotation(new u)),new e(r.inputOutput,"scale",new t.MFVec2f(new s(1,1))),new e(r.inputOutput,"spine",new t.MFVec3f(new a(0,0,0),new a(0,1,0)))]),getTypeName:function(){return"Extrusion"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},getClosedOrientation:function(){var t=this.orientation_;if(t.length){var e=t[0].getValue(),n=t[t.length-1].getValue();return e.equals(n)}return!0},createPoints:function(){var t=new a(1,1,1);return function(){for(var e=this.crossSection_,n=this.orientation_,i=this.scale_,r=this.spine_,o=[],s=this.createRotations(),u=0,l=r.length;u<l;++u){var c=s[u];if(n.length&&c.rotate(n[Math.min(u,n.length-1)].getValue()),i.length){var h=i[Math.min(u,i.length-1)].getValue();c.scale(t.set(h.x,1,h.y))}for(var d=0,p=e.length;d<p;++d){var f=e[d].getValue();o.push(c.multVecMatrix(new a(f.x,0,f.y)))}}return o}}(),createRotations:function(){var t=[],e=new a(0,0,0),n=new a(0,0,0),i=new a(0,0,0),r=new a(0,0,0),o=new a(0,0,0),s=new a(0,0,0),c=new u(0,0,1,0);return function(){for(var u=this.spine_,h=u.length,d=u[0].getValue(),p=u[u.length-1].getValue(),f=d.equals(p)&&this.getClosedOrientation(),g=t.length;g<h;++g)t[g]=new l;if(t.length=h,e.set(0,0,0),n.set(0,0,0),i.set(0,0,0),f){for(var g=1,m=h-2;g<m&&(n.assign(u[g].getValue()).subtract(u[m].getValue()).normalize(),n.equals(a.Zero));++g);for(var g=0,m=h-2;g<m&&(i.assign(u[g+1].getValue()).subtract(u[g].getValue()).cross(s.assign(u[m].getValue()).subtract(u[g].getValue())).normalize(),i.equals(a.Zero));++g);}else{for(var g=0,m=h-1;g<m&&(n.assign(u[g+1].getValue()).subtract(u[g].getValue()).normalize(),n.equals(a.Zero));++g);for(var g=1,m=h-1;g<m&&(i.assign(u[g+1].getValue()).subtract(u[g].getValue()).cross(s.assign(u[g-1].getValue()).subtract(u[g].getValue())).normalize(),i.equals(a.Zero));++g);}n.equals(a.Zero)&&n.set(0,1,0),i.equals(a.Zero)&&c.setFromToVec(a.yAxis,n).multVecRot(i.assign(a.zAxis)),e.assign(n).cross(i);var x=d;t[0].set(e.x,e.y,e.z,0,n.x,n.y,n.z,0,i.x,i.y,i.z,0,x.x,x.y,x.z,1),r.assign(n),o.assign(i);for(var g=1,m=h-1;g<m;++g){var x=u[g].getValue();n.assign(u[g+1].getValue()).subtract(u[g-1].getValue()).normalize(),i.assign(u[g+1].getValue()).subtract(x).cross(s.assign(u[g-1].getValue()).subtract(x)).normalize(),o.dot(i)<0&&i.negate(),n.equals(a.Zero)?n.assign(r):r.assign(n),i.equals(a.Zero)?i.assign(o):o.assign(i),e.assign(n).cross(i),t[g].set(e.x,e.y,e.z,0,n.x,n.y,n.z,0,i.x,i.y,i.z,0,x.x,x.y,x.z,1)}if(f)t[h-1].assign(t[0]);else{var x=p;n.assign(x).subtract(u[h-2].getValue()).normalize(),h>2&&i.assign(x).subtract(u[h-2].getValue()).cross(s.assign(u[h-3].getValue()).subtract(u[h-2].getValue())).normalize(),o.dot(i)<0&&i.negate(),n.equals(a.Zero)&&n.assign(r),i.equals(a.Zero)&&i.assign(o),e.assign(n).cross(i),t[h-1].set(e.x,e.y,e.z,0,n.x,n.y,n.z,0,i.x,i.y,i.z,0,x.x,x.y,x.z,1)}return t}}(),build:function(){var t=new s(0,0,0),e=new s(0,0,0),n=new s(0,0,0);return function(){function i(t,e){return t*d+e}var r=!this.ccw_.getValue(),u=this.crossSection_,l=this.spine_,c=l.length,h=this.getTexCoords();if(!(c<2||u.length<2)){this.getMultiTexCoords().push(h);var d=u.length,p=l[0].getValue(),f=l[c-1].getValue(),g=p.equals(f)&&this.getClosedOrientation(),m=u[0].getValue(),x=u[u.length-1].getValue(),v=m.equals(x);t.assign(u[0].getValue()),e.assign(u[0].getValue());for(var _=1,y=u.length;_<y;++_)t.min(u[_].getValue()),e.max(u[_].getValue());for(var w=n.assign(e).subtract(t),b=Math.max(w.x,w.y),S=v?u.length-1:u.length,C=[],T=[],F=this.createPoints(),O=0,y=F.length;O<y;++O)C[O]=[];for(var N=this.getNormals(),E=this.getVertices(),M=u.length-1,D=c-1,V=i(0,0),I=i(0,v?0:M),B=0;B<D;++B)for(var _=0;_<M;++_){var L=g&&B===c-2?0:B+1,A=v&&_===u.length-2?0:_+1,P=i(B,_),R=i(B,A),k=i(L,A),U=i(L,_),z=F[P],X=F[R],j=F[k],G=F[U],H=X.distance(j)>=1e-7,q=G.distance(z)>=1e-7;if(r)var W=o.normal(j,X,z,new a(0,0,0)),Y=o.normal(G,j,z,new a(0,0,0));else var W=o.normal(z,X,j,new a(0,0,0)),Y=o.normal(z,j,G,new a(0,0,0));if(0==_&&(q?V=P:(P=V,z=F[P])),_==u.length-2&&(H?I=R:(k=I,j=F[k])),H){if(q)h.push(_/M,B/D,0,1);else{var $=(B/D+(B+1)/D)/2;h.push(_/M,$,0,1)}C[P].push(T.length),T.push(W),E.push(z.x,z.y,z.z,1),h.push((_+1)/M,B/D,0,1),C[R].push(T.length),T.push(W),E.push(X.x,X.y,X.z,1),h.push((_+1)/M,(B+1)/D,0,1),C[k].push(T.length),T.push(W),E.push(j.x,j.y,j.z,1)}if(q){if(h.push(_/M,B/D,0,1),C[P].push(T.length),T.push(Y),E.push(z.x,z.y,z.z,1),H)h.push((_+1)/M,(B+1)/D,0,1);else{var $=((B+1)/D+B/D)/2;h.push((_+1)/M,$,0,1)}C[k].push(T.length),T.push(Y),E.push(j.x,j.y,j.z,1),h.push(_/M,(B+1)/D,0,1),C[U].push(T.length),T.push(Y),E.push(G.x,G.y,G.z,1)}}T=this.refineNormals(C,T,this.creaseAngle_.getValue());for(var Z=0;Z<T.length;++Z){var Q=T[Z];N.push(Q.x,Q.y,Q.z)}if(b&&u.length>2){if(this.beginCap_.getValue()){for(var K=0,J=[],tt=[],_=0;_<S;++_){var et=i(K,S-1-_),nt=F[et].copy();nt.index=et,nt.texCoord=s.subtract(u[S-1-_].getValue(),t).divide(b),J.push(nt)}if(this.convex_.getValue()?o.triangulateConvexPolygon(J,tt):o.triangulatePolygon(J,tt),tt.length>=3){var Q=o.normal(F[tt[0].index],F[tt[1].index],F[tt[2].index],new a(0,0,0));r&&Q.negate(),this.addCap(h,Q,F,tt)}}if(this.endCap_.getValue()){for(var K=c-1,J=[],tt=[],_=0;_<S;++_){var et=i(K,_),nt=F[et].copy();nt.index=et,nt.texCoord=s.subtract(u[_].getValue(),t).divide(b),J.push(nt)}if(this.convex_.getValue()?o.triangulateConvexPolygon(J,tt):o.triangulatePolygon(J,tt),tt.length>=3){var Q=o.normal(F[tt[0].index],F[tt[1].index],F[tt[2].index],new a(0,0,0));r&&Q.negate(),this.addCap(h,Q,F,tt)}}}this.setSolid(this.solid_.getValue()),this.setCCW(this.ccw_.getValue())}}}(),addCap:function(t,e,n,i){for(var r=this.getNormals(),o=this.getVertices(),s=0;s<i.length;s+=3){var a=n[i[s].index],u=n[i[s+1].index],l=n[i[s+2].index],c=i[s].texCoord,h=i[s+1].texCoord,d=i[s+2].texCoord;t.push(c.x,c.y,0,1),t.push(h.x,h.y,0,1),t.push(d.x,d.y,0,1),r.push(e.x,e.y,e.z,e.x,e.y,e.z,e.x,e.y,e.z),o.push(a.x,a.y,a.z,1,u.x,u.y,u.z,1,l.x,l.y,l.z,1)}}}),c}),define("x_ite/Components/Geometry3D/Sphere",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DConstants"],function(t,e,n,i,r){"use strict";function o(t){i.call(this,t),this.addType(r.Sphere),this.radius_.setUnit("length")}return o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.initializeOnly,"radius",new t.SFFloat(1)),new e(r.initializeOnly,"solid",new t.SFBool(!0))]),getTypeName:function(){return"Sphere"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},set_live__:function(){i.prototype.set_live__.call(this),this.isLive().getValue()?this.getBrowser().getSphereOptions().addInterest("requestRebuild",this):this.getBrowser().getSphereOptions().removeInterest("requestRebuild",this)},build:function(){var t=this.getBrowser().getSphereOptions(),e=t.getGeometry(),n=this.radius_.getValue();if(this.setMultiTexCoords(e.getMultiTexCoords()),this.setNormals(e.getNormals()),1===n)this.setVertices(e.getVertices()),this.getMin().assign(e.getMin()),this.getMax().assign(e.getMax());else{for(var i=e.getVertices().getValue(),r=this.getVertices(),o=0;o<i.length;o+=4)r.push(n*i[o],n*i[o+1],n*i[o+2],1);n=Math.abs(n),this.getMin().set(-n,-n,-n),this.getMax().set(n,n,n)}this.setSolid(this.solid_.getValue())}}),o}),define("x_ite/Components/Geometry3D",["x_ite/Configuration/SupportedNodes","x_ite/Components/Geometry3D/Box","x_ite/Components/Geometry3D/Cone","x_ite/Components/Geometry3D/Cylinder","x_ite/Components/Geometry3D/ElevationGrid","x_ite/Components/Geometry3D/Extrusion","x_ite/Components/Geometry3D/IndexedFaceSet","x_ite/Components/Geometry3D/Sphere"],function(t,e,n,i,r,o,s,a){"use strict";var u={Box:e,Cone:n,Cylinder:i,ElevationGrid:r,Extrusion:o,IndexedFaceSet:s,Sphere:a},l={};for(var c in u)t.addType(c,u[c]);for(var c in l)t.addAbstractType(c,l[c])}),define("x_ite/Components/Grouping/StaticGroup",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Components/Grouping/Group","x_ite/Bits/X3DConstants","x_ite/Bits/TraverseType","standard/Math/Geometry/Box3","standard/Math/Geometry/ViewVolume"],function(t,e,n,i,r,o,s,a,u,l){"use strict";function c(t){i.call(this,t),r.call(this,t),this.addType(s.StaticGroup),this.group=new o(this.getExecutionContext()),this.collisionShapes=null,this.depthShapes=null,this.opaqueShapes=null,this.transparentShapes=null,this.bbox=new u}return c.prototype=Object.assign(Object.create(i.prototype),r.prototype,{constructor:c,fieldDefinitions:new n([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new e(s.initializeOnly,"bboxCenter",new t.SFVec3f),new e(s.initializeOnly,"children",new t.MFNode)]),getTypeName:function(){return"StaticGroup"},getComponentName:function(){return"Grouping"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),r.prototype.initialize.call(this),this.bboxSize_.addFieldInterest(this.group.bboxSize_),this.bboxCenter_.addFieldInterest(this.group.bboxCenter_),this.children_.addFieldInterest(this.group.children_),this.group.bboxSize_=this.bboxSize_,this.group.bboxCenter_=this.bboxCenter_,this.group.children_=this.children_,this.group.setPrivate(!0),this.group.setup(),this.group.isCameraObject_.addFieldInterest(this.isCameraObject_),this.group.isPickableObject_.addFieldInterest(this.isPickableObject_),this.group.children_.addInterest("set_children__",this),this.setCameraObject(this.group.getCameraObject()),this.setPickableObject(this.group.getPickableObject()),this.set_children__()},getBBox:function(t){return t.assign(this.bbox)},set_children__:function(){this.group.getBBox(this.bbox),this.collisionShapes=null,this.depthShapes=null,this.opaqueShapes=null,this.transparentShapes=null},traverse:function(){var t=new l;return t.intersectsSphere=function(){return!0},function(e,n){switch(e){case a.CAMERA:return;case a.POINTER:case a.COLLISION:if(!this.collisionShapes){var i=n.getViewVolumes(),r=n.getViewport(),o=n.getProjectionMatrix(),s=n.getModelViewMatrix(),u=n.getNumCollisionShapes();i.push(t.set(o,r,r)),s.push(),s.identity(),this.group.traverse(e,n),s.pop(),i.pop();var l=n.getNumCollisionShapes();this.collisionShapes=n.getCollisionShapes().splice(u,l-u),n.setNumCollisionShapes(u)}for(var c=this.collisionShapes,s=n.getModelViewMatrix(),h=0,d=c.length;h<d;++h){var p=c[h];s.push(),s.multLeft(p.modelViewMatrix),p.shapeNode.traverse(e,n),s.pop()}return;case a.DEPTH:if(!this.depthShapes){var i=n.getViewVolumes(),r=n.getViewport(),o=n.getProjectionMatrix(),s=n.getModelViewMatrix(),f=n.getNumDepthShapes();i.push(t.set(o,r,r)),s.push(),s.identity(),this.group.traverse(e,n),s.pop(),i.pop();var g=n.getNumDepthShapes();this.depthShapes=n.getDepthShapes().splice(f,g-f),n.setNumDepthShapes(f)}for(var m=this.depthShapes,s=n.getModelViewMatrix(),h=0,d=m.length;h<d;++h){var x=m[h];s.push(),s.multLeft(x.modelViewMatrix),x.shapeNode.traverse(e,n),s.pop()}return;case a.DISPLAY:if(!this.opaqueShapes){var i=n.getViewVolumes(),r=n.getViewport(),o=n.getProjectionMatrix(),s=n.getModelViewMatrix(),v=n.getNumOpaqueShapes(),_=n.getNumTransparentShapes();i.push(t.set(o,r,r)),s.push(),s.identity(),this.group.traverse(e,n),s.pop(),i.pop();var y=n.getNumOpaqueShapes(),w=n.getNumTransparentShapes();this.opaqueShapes=n.getOpaqueShapes().splice(v,y-v),this.transparentShapes=n.getTransparentShapes().splice(_,w-_),n.setNumOpaqueShapes(v),n.setNumTransparentShapes(_)}for(var b=this.opaqueShapes,S=this.transparentShapes,s=n.getModelViewMatrix(),h=0,d=b.length;h<d;++h){var C=b[h];s.push(),s.multLeft(C.modelViewMatrix),C.shapeNode.traverse(e,n),s.pop()}for(var h=0,d=S.length;h<d;++h){var T=S[h];s.push(),s.multLeft(T.modelViewMatrix),T.shapeNode.traverse(e,n),s.pop()}return}}}()}),c}),define("x_ite/Components/Grouping/Switch",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants","standard/Math/Geometry/Box3"],function(t,e,n,i,r,o,s,a){"use strict";function u(t){i.call(this,t),this.addType(s.Switch),"2.0"==t.getSpecificationVersion()&&this.addAlias("choice",this.children_)}return u.prototype=Object.assign(Object.create(i.prototype),{constructor:u,fieldDefinitions:new n([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"whichChoice",new t.SFInt32(-1)),new e(s.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new e(s.initializeOnly,"bboxCenter",new t.SFVec3f),new e(s.inputOnly,"addChildren",new t.MFNode),new e(s.inputOnly,"removeChildren",new t.MFNode),new e(s.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"Switch"},getComponentName:function(){return"Grouping"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.whichChoice_.addInterest("set_whichChoice__",this),this.set_whichChoice__()},getBBox:function(t){if(this.bboxSize_.getValue().equals(this.getDefaultBBoxSize())){var e=o(s.X3DBoundedObject,this.child);return e?e.getBBox(t):t.set()}return t.set(this.bboxSize_.getValue(),this.bboxCenter_.getValue())},getSubBBox:function(t){return this.getBBox(t)},set_whichChoice__:function(){this.child=this.getChild(this.whichChoice_.getValue()),this.set_cameraObjects__()},set_cameraObjects__:function(){this.child&&this.child.getCameraObject?this.setCameraObject(this.child.getCameraObject()):this.setCameraObject(!1)},set_pickableObjects__:function(){this.getTransformSensors().size?this.setPickableObject(!0):this.child&&this.child.getPickableObject?this.setPickableObject(this.child.getPickableObject()):this.setPickableObject(!1)},traverse:function(){var t=new a;return function(e,n){var i=this.child;if(i)if(e===r.PICKING){if(this.getTransformSensors().size&&(this.getSubBBox(t).multRight(n.getModelViewMatrix().get()),this.getTransformSensors().forEach(function(e){e.collect(t)})),i){var o=n.getBrowser(),s=o.getPickingHierarchy();s.push(this),i.traverse(e,n),s.pop()}}else i.traverse(e,n)}}()}),u}),
define("x_ite/Components/Grouping/X3DTransformMatrix3DNode",["x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(t,e,n,i,r){"use strict";function o(n){t.call(this,n),this.addType(e.X3DTransformMatrix3DNode),this.matrix=new r,this.traverse=this.getGroupTraverse()}return o.prototype=Object.assign(Object.create(t.prototype),{constructor:o,getBBox:function(e){var e=t.prototype.getBBox.call(this,e);return this.traverse===this.getGroupTraverse()?e:e.multRight(this.matrix)},getSubBBox:function(e){return t.prototype.getBBox.call(this,e)},setMatrix:function(t){t.equals(r.Identity)?(this.matrix.identity(),this.traverse=this.getGroupTraverse()):(this.matrix.assign(t),this.traverse=this.getTraverse())},getMatrix:function(){return this.matrix},setTransform:function(t,e,r,o,s){t.equals(n.Zero)&&e.equals(i.Identity)&&r.equals(n.One)?(this.matrix.identity(),this.traverse=this.getGroupTraverse()):(this.matrix.set(t,e,r,o,s),this.traverse=this.getTraverse())},getTraverse:function(){function e(e,n){var i=n.getModelViewMatrix();i.push(),i.multLeft(this.matrix),t.prototype.traverse.call(this,e,n),i.pop()}return function(){return e}}(),getGroupTraverse:function(){return t.prototype.traverse}}),o}),define("x_ite/Components/Grouping/X3DTransformNode",["x_ite/Components/Grouping/X3DTransformMatrix3DNode","x_ite/Bits/X3DConstants"],function(t,e){"use strict";function n(n){t.call(this,n),this.addType(e.X3DTransformNode),this.translation_.setUnit("length"),this.center_.setUnit("length")}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,initialize:function(){t.prototype.initialize.call(this),this.addInterest("eventsProcessed",this),this.eventsProcessed()},eventsProcessed:function(){this.setHidden(0===this.scale_.x||0===this.scale_.y||0===this.scale_.z),this.setTransform(this.translation_.getValue(),this.rotation_.getValue(),this.scale_.getValue(),this.scaleOrientation_.getValue(),this.center_.getValue())}}),n}),define("x_ite/Components/Grouping/Transform",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DTransformNode","x_ite/Bits/X3DConstants"],function(t,e,n,i,r){"use strict";function o(t){i.call(this,t),this.addType(r.Transform)}return o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"translation",new t.SFVec3f),new e(r.inputOutput,"rotation",new t.SFRotation),new e(r.inputOutput,"scale",new t.SFVec3f(1,1,1)),new e(r.inputOutput,"scaleOrientation",new t.SFRotation),new e(r.inputOutput,"center",new t.SFVec3f),new e(r.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new e(r.initializeOnly,"bboxCenter",new t.SFVec3f),new e(r.inputOnly,"addChildren",new t.MFNode),new e(r.inputOnly,"removeChildren",new t.MFNode),new e(r.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"Transform"},getComponentName:function(){return"Grouping"},getContainerField:function(){return"children"}}),o}),define("x_ite/Components/Grouping",["x_ite/Configuration/SupportedNodes","x_ite/Components/Grouping/Group","x_ite/Components/Grouping/StaticGroup","x_ite/Components/Grouping/Switch","x_ite/Components/Grouping/Transform","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Components/Grouping/X3DTransformMatrix3DNode","x_ite/Components/Grouping/X3DTransformNode"],function(t,e,n,i,r,o,s,a,u){"use strict";var l={Group:e,StaticGroup:n,Switch:i,Transform:r},c={X3DBoundedObject:o,X3DGroupingNode:s,X3DTransformMatrix3DNode:a,X3DTransformNode:u};for(var h in l)t.addType(h,l[h]);for(var h in c)t.addAbstractType(h,c[h])}),define("x_ite/Components/Interpolation/ColorInterpolator",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Color3"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.ColorInterpolator),this.hsv=[]}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_fraction",new t.SFFloat),new e(r.inputOutput,"key",new t.MFFloat),new e(r.inputOutput,"keyValue",new t.MFColor),new e(r.outputOnly,"value_changed",new t.SFColor)]),getTypeName:function(){return"ColorInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){var e=this.keyValue_;e.length<this.key_.length&&this.keyValue_.resize(this.key_.length,e.length?e[this.keyValue_.length-1]:new t.SFColor),this.hsv.length=0;for(var n=0,i=e.length;n<i;++n)this.hsv.push(e[n].getHSV([]))},interpolate:function(){var t=[];return function(e,n,i){o.lerp(this.hsv[e],this.hsv[n],i,t),this.value_changed_.setHSV(t[0],t[1],t[2])}}()}),s}),define("x_ite/Components/Interpolation/CoordinateInterpolator",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.CoordinateInterpolator)}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_fraction",new t.SFFloat),new e(r.inputOutput,"key",new t.MFFloat),new e(r.inputOutput,"keyValue",new t.MFVec3f),new e(r.outputOnly,"value_changed",new t.MFVec3f)]),getTypeName:function(){return"CoordinateInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},set_keyValue__:function(){},interpolate:function(t,e,n){var i=this.keyValue_.getValue(),r=this.key_.length?Math.floor(this.keyValue_.length/this.key_.length):0;this.value_changed_.length=r;var s=this.value_changed_.getValue();t*=r,e=t+(this.key_.length>1?r:0),t*=3,e*=3,r*=3;for(var a=0;a<r;a+=3){var u=a+1,l=a+2;s[a]=o.lerp(i[t+a],i[e+a],n),s[u]=o.lerp(i[t+u],i[e+u],n),s[l]=o.lerp(i[t+l],i[e+l],n)}this.value_changed_.addEvent()}}),s}),define("x_ite/Components/Interpolation/CoordinateInterpolator2D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.CoordinateInterpolator2D)}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_fraction",new t.SFFloat),new e(r.inputOutput,"key",new t.MFFloat),new e(r.inputOutput,"keyValue",new t.MFVec2f),new e(r.outputOnly,"value_changed",new t.MFVec2f)]),getTypeName:function(){return"CoordinateInterpolator2D"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},set_keyValue__:function(){},interpolate:function(t,e,n){var i=this.keyValue_.getValue(),r=this.key_.length?Math.floor(this.keyValue_.length/this.key_.length):0;this.value_changed_.length=r;var s=this.value_changed_.getValue();t*=r,e=t+(this.key_.length>1?r:0),t*=2,e*=2,r*=2;for(var a=0;a<r;a+=2){var u=a+1;s[a]=o.lerp(i[t+a],i[e+a],n),s[u]=o.lerp(i[t+u],i[e+u],n)}this.value_changed_.addEvent()}}),s}),define("x_ite/Components/Interpolation/NormalInterpolator",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(t,e,n,i,r,o,s){"use strict";function a(t){i.call(this,t),this.addType(r.NormalInterpolator)}var u=new o(0,0,0),l=new o(0,0,0);return a.prototype=Object.assign(Object.create(i.prototype),{constructor:a,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_fraction",new t.SFFloat),new e(r.inputOutput,"key",new t.MFFloat),new e(r.inputOutput,"keyValue",new t.MFVec3f),new e(r.outputOnly,"value_changed",new t.MFVec3f)]),getTypeName:function(){return"NormalInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){},interpolate:function(t,e,n){var i=this.keyValue_.getValue(),r=this.key_.length>1?Math.floor(this.keyValue_.length/this.key_.length):0;this.value_changed_.length=r;var o=this.value_changed_.getValue();t*=r,e=t+r,t*=3,e*=3,r*=3;for(var a=0;a<r;a+=3)try{var c=a+1,h=a+2;u.set(i[t+a],i[t+c],i[t+h]),l.set(i[e+a],i[e+c],i[e+h]);var d=s.simpleSlerp(u,l,n);o[a]=d[0],o[c]=d[1],o[h]=d[2]}catch(t){}this.value_changed_.addEvent()}}),a}),define("x_ite/Components/Interpolation/PositionInterpolator2D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector2"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.PositionInterpolator2D)}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_fraction",new t.SFFloat),new e(r.inputOutput,"key",new t.MFFloat),new e(r.inputOutput,"keyValue",new t.MFVec2f),new e(r.outputOnly,"value_changed",new t.SFVec2f)]),getTypeName:function(){return"PositionInterpolator2D"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){var e=this.key_,n=this.keyValue_;n.length<e.length&&n.resize(e.length,n.length?n[n.length-1]:new t.SFVec2f)},interpolate:function(){var t=new o(0,0);return function(e,n,i){this.value_changed_=t.assign(this.keyValue_[e].getValue()).lerp(this.keyValue_[n].getValue(),i)}}()}),s}),define("x_ite/Browser/Interpolation/CatmullRomSplineInterpolator",["standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4"],function(t,e){"use strict";function n(){this.T0=[],this.T1=[]}var i=[],r=[],o=[],s=new t(0,0,0,0),a=new e(2,-2,1,1,-3,3,-2,-1,0,0,1,0,1,0,0,0);return n.prototype={constructor:n,generate:function(t,e,n,s,a){var u=this.T0,l=this.T1;if(u.length=0,l.length=0,i.length=0,r.length=0,o.length=0,e.length>1){if(0===s.length){t?i.push(this.divide(this.subtract(n[1],n[n.length-2]),2)):i.push(this.create());for(var c=1,h=n.length-1;c<h;++c)i.push(this.divide(this.subtract(n[c+1],n[c-1]),2));i.push(this.copy(i[0]))}else{for(var c=0,h=s.length;c<h;++c)i.push(this.copy(s[c]));if(a){for(var d=0,c=0,h=n.length-1;c<h;++c)d+=this.abs(this.subtract(n[c],n[c+1]));for(var c=0,h=i.length-1;c<h;++c){var p=this.abs(i[c]);p&&(i[c]=this.multiply(i[c],d/p))}}}if(t){var f=e.length-1,g=e.length-2,m=e[1]-e[0]+e[f]-e[g];o.push(2*(e[1]-e[0])/m),r.push(2*(e[f]-e[g])/m)}else o.push(1),r.push(1);for(var c=1,h=e.length-1;c<h;++c){var m=e[c+1]-e[c-1];o.push(2*(e[c+1]-e[c])/m),r.push(2*(e[c]-e[c-1])/m)}o.push(o[0]),r.push(r[0]);for(var c=0,h=i.length;c<h;++c)u.push(this.multiply(i[c],r[c])),l.push(this.multiply(i[c],o[c]))}else u.push(this.create()),l.push(this.create())},interpolate:function(t,e,n,i){return s.set(Math.pow(n,3),Math.pow(n,2),n,1),this.dot(a.multVecMatrix(s),i[t],i[e],this.T0[t],this.T1[e])}},n}),define("x_ite/Browser/Interpolation/CatmullRomSplineInterpolatorTemplate",["x_ite/Browser/Interpolation/CatmullRomSplineInterpolator"],function(t){"use strict";return function(e){function n(){this.T0=[],this.T1=[]}var i=new e(0,0,0,0),r=new e(0,0,0,0),o=new e(0,0,0,0),s=new e(0,0,0,0);return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,create:function(){return new e(0,0,0,0)},copy:function(t){return t.copy()},subtract:function(t,n){return e.subtract(t,n)},multiply:function(t,n){return e.multiply(t,n)},divide:function(t,n){return e.divide(t,n)},abs:function(t){return t.abs()},dot:function(t,e,n,a,u){return i.assign(e).multiply(t[0]),r.assign(n).multiply(t[1]),o.assign(a).multiply(t[2]),s.assign(u).multiply(t[3]),i.add(r).add(o).add(s)}}),n}}),define("x_ite/Browser/Interpolation/CatmullRomSplineInterpolator3",["x_ite/Browser/Interpolation/CatmullRomSplineInterpolatorTemplate","standard/Math/Numbers/Vector3"],function(t,e){"use strict";return t(e)}),define("x_ite/Components/Interpolation/SplinePositionInterpolator",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Browser/Interpolation/CatmullRomSplineInterpolator3","x_ite/Bits/X3DConstants"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(o.SplinePositionInterpolator),this.spline=new r}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOnly,"set_fraction",new t.SFFloat),new e(o.inputOutput,"closed",new t.SFBool),new e(o.inputOutput,"key",new t.MFFloat),new e(o.inputOutput,"keyValue",new t.MFVec3f),new e(o.inputOutput,"keyVelocity",new t.MFVec3f),new e(o.inputOutput,"normalizeVelocity",new t.SFBool),new e(o.outputOnly,"value_changed",new t.SFVec3f)]),getTypeName:function(){return"SplinePositionInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this),this.keyVelocity_.addInterest("set_keyVelocity__",this),this.normalizeVelocity_.addInterest("set_normalizeVelocity__",this)},set_keyValue__:function(){var e=this.key_,n=this.keyValue_;n.length<e.length&&n.resize(e.length,n.length?n[n.length-1]:new t.SFVec3f),this.set_keyVelocity__()},set_keyVelocity__:function(){this.keyVelocity_.length&&this.keyVelocity_.length<this.key_.length&&this.keyVelocity_.resize(this.key_.length,new t.SFVec3f),this.set_normalizeVelocity__()},set_normalizeVelocity__:function(){this.spline.generate(this.closed_.getValue(),this.key_,this.keyValue_,this.keyVelocity_,this.normalizeVelocity_.getValue())},interpolate:function(t,e,n){this.value_changed_=this.spline.interpolate(t,e,n,this.keyValue_)}}),s}),define("x_ite/Browser/Interpolation/CatmullRomSplineInterpolator2",["x_ite/Browser/Interpolation/CatmullRomSplineInterpolatorTemplate","standard/Math/Numbers/Vector2"],function(t,e){"use strict";return t(e)}),define("x_ite/Components/Interpolation/SplinePositionInterpolator2D",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Browser/Interpolation/CatmullRomSplineInterpolator2","x_ite/Bits/X3DConstants"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(o.SplinePositionInterpolator2D),this.spline=new r}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOnly,"set_fraction",new t.SFFloat),new e(o.inputOutput,"closed",new t.SFBool),new e(o.inputOutput,"key",new t.MFFloat),new e(o.inputOutput,"keyValue",new t.MFVec2f),new e(o.inputOutput,"keyVelocity",new t.MFVec2f),new e(o.inputOutput,"normalizeVelocity",new t.SFBool),new e(o.outputOnly,"value_changed",new t.SFVec2f)]),getTypeName:function(){return"SplinePositionInterpolator2D"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this),this.keyVelocity_.addInterest("set_keyVelocity__",this),this.normalizeVelocity_.addInterest("set_normalizeVelocity__",this)},set_keyValue__:function(){var e=this.key_,n=this.keyValue_;n.length<e.length&&n.resize(e.length,n.length?n[n.length-1]:new t.SFVec2f),this.set_keyVelocity__()},set_keyVelocity__:function(){this.keyVelocity_.length&&this.keyVelocity_.length<this.key_.length&&this.keyVelocity_.resize(this.key_.length,new t.SFVec2f),this.set_normalizeVelocity__()},set_normalizeVelocity__:function(){this.spline.generate(this.closed_.getValue(),this.key_,this.keyValue_,this.keyVelocity_,this.normalizeVelocity_.getValue())},interpolate:function(t,e,n){this.value_changed_=this.spline.interpolate(t,e,n,this.keyValue_)}}),s}),define("x_ite/Browser/Interpolation/CatmullRomSplineInterpolator1",["x_ite/Browser/Interpolation/CatmullRomSplineInterpolator"],function(t){"use strict";function e(){this.T0=[],this.T1=[]}return e.prototype=Object.assign(Object.create(t.prototype),{constructor:e,create:function(){return 0},copy:function(t){return t},subtract:function(t,e){return t-e},multiply:function(t,e){return t*e},divide:function(t,e){return t/e},abs:function(t){return Math.abs(t)},dot:function(t,e,n,i,r){return e*t[0]+n*t[1]+i*t[2]+r*t[3]}}),e}),define("x_ite/Components/Interpolation/SplineScalarInterpolator",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Browser/Interpolation/CatmullRomSplineInterpolator1","x_ite/Bits/X3DConstants"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(o.SplineScalarInterpolator),this.spline=new r}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOnly,"set_fraction",new t.SFFloat),new e(o.inputOutput,"closed",new t.SFBool),new e(o.inputOutput,"key",new t.MFFloat),new e(o.inputOutput,"keyValue",new t.MFFloat),new e(o.inputOutput,"keyVelocity",new t.MFFloat),new e(o.inputOutput,"normalizeVelocity",new t.SFBool),new e(o.outputOnly,"value_changed",new t.SFFloat)]),getTypeName:function(){return"SplineScalarInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this),this.keyVelocity_.addInterest("set_keyVelocity__",this),this.normalizeVelocity_.addInterest("set_normalizeVelocity__",this)},set_keyValue__:function(){var e=this.key_,n=this.keyValue_;n.length<e.length&&n.resize(e.length,n.length?n[n.length-1]:new t.SFFloat),this.set_keyVelocity__()},set_keyVelocity__:function(){this.keyVelocity_.length&&this.keyVelocity_.length<this.key_.length&&this.keyVelocity_.resize(this.key_.length,new t.SFFloat),this.set_normalizeVelocity__()},set_normalizeVelocity__:function(){this.spline.generate(this.closed_.getValue(),this.key_,this.keyValue_,this.keyVelocity_,this.normalizeVelocity_.getValue())},interpolate:function(t,e,n){this.value_changed_=this.spline.interpolate(t,e,n,this.keyValue_)}}),s}),define("x_ite/Browser/Interpolation/SquatInterpolator",["standard/Math/Numbers/Rotation4"],function(t){"use strict";function e(){this.s=[]}var n=new t(0,0,1,0);return e.prototype={constructor:e,generate:function(e,n,i){var r=this.s;if(r.length=0,n.length>1){e?r.push(t.spline(i[n.length-2].getValue(),i[0].getValue(),i[1].getValue())):r.push(i[0].getValue());for(var o=1,s=n.length-1;o<s;++o)r.push(t.spline(i[o-1].getValue(),i[o].getValue(),i[o+1].getValue()));e?r.push(t.spline(i[n.length-2].getValue(),i[n.length-1].getValue(),i[1].getValue())):r.push(i[n.length-1].getValue())}else n.length>0&&r.push(i[0].getValue().copy())},interpolate:function(t,e,i,r){return n.assign(r[t].getValue()).squad(this.s[t],this.s[e],r[e].getValue(),i)}},e}),define("x_ite/Components/Interpolation/SquadOrientationInterpolator",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Browser/Interpolation/SquatInterpolator","x_ite/Bits/X3DConstants"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(o.SquadOrientationInterpolator),this.squad=new r}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOnly,"set_fraction",new t.SFFloat),new e(o.inputOutput,"closed",new t.SFBool),new e(o.inputOutput,"key",new t.MFFloat),new e(o.inputOutput,"keyValue",new t.MFRotation),new e(o.outputOnly,"value_changed",new t.SFRotation)]),getTypeName:function(){return"SquadOrientationInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){var e=this.key_,n=this.keyValue_;n.length<e.length&&n.resize(e.length,n.length?n[n.length-1]:new t.SFRotation),this.squad.generate(this.closed_.getValue(),this.key_,this.keyValue_)},interpolate:function(t,e,n){try{this.value_changed_=this.squad.interpolate(t,e,n,this.keyValue_)}catch(t){console.log(t)}}}),s}),define("x_ite/Components/Interpolation",["x_ite/Configuration/SupportedNodes","x_ite/Components/Interpolation/ColorInterpolator","x_ite/Components/Interpolation/CoordinateInterpolator","x_ite/Components/Interpolation/CoordinateInterpolator2D","x_ite/Components/Interpolation/EaseInEaseOut","x_ite/Components/Interpolation/NormalInterpolator","x_ite/Components/Interpolation/OrientationInterpolator","x_ite/Components/Interpolation/PositionInterpolator","x_ite/Components/Interpolation/PositionInterpolator2D","x_ite/Components/Interpolation/ScalarInterpolator","x_ite/Components/Interpolation/SplinePositionInterpolator","x_ite/Components/Interpolation/SplinePositionInterpolator2D","x_ite/Components/Interpolation/SplineScalarInterpolator","x_ite/Components/Interpolation/SquadOrientationInterpolator","x_ite/Components/Interpolation/X3DInterpolatorNode"],function(t,e,n,i,r,o,s,a,u,l,c,h,d,p,f){"use strict";var g={ColorInterpolator:e,CoordinateInterpolator:n,CoordinateInterpolator2D:i,EaseInEaseOut:r,NormalInterpolator:o,OrientationInterpolator:s,PositionInterpolator:a,PositionInterpolator2D:u,ScalarInterpolator:l,SplinePositionInterpolator:c,SplinePositionInterpolator2D:h,SplineScalarInterpolator:d,SquadOrientationInterpolator:p},m={X3DInterpolatorNode:f};for(var x in g)t.addType(x,g[x]);for(var x in m)t.addAbstractType(x,m[x])}),define("x_ite/Components/Layering",["x_ite/Configuration/SupportedNodes","x_ite/Components/Layering/Layer","x_ite/Components/Layering/LayerSet","x_ite/Components/Layering/Viewport","x_ite/Components/Layering/X3DLayerNode","x_ite/Components/Layering/X3DViewportNode"],function(t,e,n,i,r,o){"use strict";var s={Layer:e,LayerSet:n,Viewport:i},a={X3DLayerNode:r,X3DViewportNode:o};for(var u in s)t.addType(u,s[u]);for(var u in a)t.addAbstractType(u,a[u])}),define("x_ite/Components/Lighting/PointLight",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Lighting/X3DLightNode","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Geometry/Box3","standard/Math/Geometry/Camera","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix3","standard/Math/Numbers/Matrix4","standard/Math/Utility/MatrixStack","standard/Math/Algorithm","standard/Utility/ObjectCache"],function(t,e,n,i,r,o,s,a,u,l,c,h,d,p,f,g,m,x){"use strict";function v(){this.location=new c(0,0,0),this.matrixArray=new Float32Array(9),this.shadowBuffer=null,this.viewVolume=new l,this.viewport=new h(0,0,0,0),this.projectionMatrix=new f,this.modelViewMatrix=new g(f),this.modelMatrix=new f,this.invLightSpaceMatrix=new f,this.invLightSpaceProjectionMatrix=new f,this.shadowMatrix=new f,this.shadowMatrixArray=new Float32Array(16),this.rotation=new d,this.rotationMatrix=new f,this.textureUnit=0}function _(t){i.call(this,t),this.addType(s.PointLight),this.location_.setUnit("length"),this.radius_.setUnit("length")}var y=[(new f).setRotation(new d(new c(1,0,0),c.zAxis)),(new f).setRotation(new d(new c(-1,0,0),c.zAxis)),(new f).setRotation(new d(new c(0,0,-1),c.zAxis)),(new f).setRotation(new d(new c(0,0,1),c.zAxis)),(new f).setRotation(new d(new c(0,1,0),c.zAxis)),(new f).setRotation(new d(new c(0,-1,0),c.zAxis))],w=[new h(0,.5,.25,.5),new h(.5,.5,.25,.5),new h(.75,.5,.25,.5),new h(.25,.5,.25,.5),new h(0,0,.5,.5),new h(.5,0,.5,.5)],b=x(v);return v.prototype={constructor:v,getModelViewMatrix:function(){return this.modelViewMatrix},set:function(t,e,n,i){var r=t.getContext(),o=e.getShadowMapSize();this.browser=t,this.lightNode=e,this.groupNode=n;try{this.matrixArray.set(i.submatrix.inverse())}catch(t){this.matrixArray.set(p.Identity)}this.modelViewMatrix.pushMatrix(i),e.getShadowIntensity()>0&&o>0&&(this.shadowBuffer=t.popShadowBuffer(o),this.shadowBuffer?t.getCombinedTextureUnits().length?(this.textureUnit=t.getCombinedTextureUnits().pop(),r.activeTexture(r.TEXTURE0+this.textureUnit),r.getVersion()>=2||t.getExtension("WEBGL_depth_texture")?r.bindTexture(r.TEXTURE_2D,this.shadowBuffer.getDepthTexture()):r.bindTexture(r.TEXTURE_2D,this.shadowBuffer.getColorTexture()),r.activeTexture(r.TEXTURE0)):console.warn("Not enough combined texture units for shadow map available."):console.warn("Couldn't create shadow buffer."))},renderShadowMap:function(t){try{if(!this.shadowBuffer)return;var e=this.lightNode,n=t.getCameraSpaceMatrix().get(),i=this.modelMatrix.assign(this.modelViewMatrix.get()).multRight(n),s=this.invLightSpaceMatrix.assign(e.getGlobal()?i:f.Identity);s.translate(e.getLocation()),s.inverse();var a=e.getShadowMapSize();this.shadowBuffer.bind();for(var l=0;l<6;++l){var c=w[l],h=this.viewport.set(c[0]*a,c[1]*a,c[2]*a,c[3]*a),d=u.perspective2(m.radians(90),.125,1e4,h[2],h[3],this.projectionMatrix);t.getViewVolumes().push(this.viewVolume.set(d,h,h)),t.getProjectionMatrix().pushMatrix(this.projectionMatrix),t.getModelViewMatrix().pushMatrix(y[l]),t.getModelViewMatrix().multLeft(s),t.render(o.DEPTH,r.prototype.traverse,this.groupNode),t.getModelViewMatrix().pop(),t.getProjectionMatrix().pop(),t.getViewVolumes().pop()}this.shadowBuffer.unbind(),e.getGlobal()||s.multLeft(i.inverse()),this.invLightSpaceProjectionMatrix.assign(s)}catch(t){console.log(t)}},setGlobalVariables:function(t){this.modelViewMatrix.get().multVecMatrix(this.location.assign(this.lightNode.location_.getValue())),this.shadowMatrix.assign(t.getCameraSpaceMatrix().get()).multRight(this.invLightSpaceProjectionMatrix),this.shadowMatrixArray.set(this.shadowMatrix)},setShaderUniforms:function(t,e){var n=e.numLights++;if(!e.hasLight(n,this)){var i=this.lightNode,r=i.getColor(),o=i.getAttenuation(),s=this.location;if(t.uniform1i(e.x3d_LightType[n],2),t.uniform3f(e.x3d_LightColor[n],r.r,r.g,r.b),t.uniform1f(e.x3d_LightIntensity[n],i.getIntensity()),t.uniform1f(e.x3d_LightAmbientIntensity[n],i.getAmbientIntensity()),t.uniform3f(e.x3d_LightAttenuation[n],Math.max(0,o.x),Math.max(0,o.y),Math.max(0,o.z)),t.uniform3f(e.x3d_LightLocation[n],s.x,s.y,s.z),t.uniform1f(e.x3d_LightRadius[n],i.getRadius()),t.uniformMatrix3fv(e.x3d_LightMatrix[n],!1,this.matrixArray),this.textureUnit){var a=i.getShadowColor();t.uniform3f(e.x3d_ShadowColor[n],a.r,a.g,a.b),t.uniform1f(e.x3d_ShadowIntensity[n],i.getShadowIntensity()),t.uniform1f(e.x3d_ShadowBias[n],i.getShadowBias()),t.uniformMatrix4fv(e.x3d_ShadowMatrix[n],!1,this.shadowMatrixArray),t.uniform1i(e.x3d_ShadowMapSize[n],i.getShadowMapSize()),t.uniform1i(e.x3d_ShadowMap[n],this.textureUnit)}else t.uniform1f(e.x3d_ShadowIntensity[n],0)}},dispose:function(){this.textureUnit&&this.browser.getCombinedTextureUnits().push(this.textureUnit),this.browser.pushShadowBuffer(this.shadowBuffer),this.modelViewMatrix.clear(),this.browser=null,this.lightNode=null,this.groupNode=null,this.shadowBuffer=null,this.textureUnit=0,b.push(this)}},_.prototype=Object.assign(Object.create(i.prototype),{constructor:_,fieldDefinitions:new n([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"global",new t.SFBool(!0)),new e(s.inputOutput,"on",new t.SFBool(!0)),new e(s.inputOutput,"color",new t.SFColor(1,1,1)),new e(s.inputOutput,"intensity",new t.SFFloat(1)),new e(s.inputOutput,"ambientIntensity",new t.SFFloat),new e(s.inputOutput,"attenuation",new t.SFVec3f(1,0,0)),new e(s.inputOutput,"location",new t.SFVec3f),new e(s.inputOutput,"radius",new t.SFFloat(100)),new e(s.inputOutput,"shadowColor",new t.SFColor),new e(s.inputOutput,"shadowIntensity",new t.SFFloat),new e(s.inputOutput,"shadowBias",new t.SFFloat(.005)),new e(s.initializeOnly,"shadowMapSize",new t.SFInt32(1024))]),getTypeName:function(){return"PointLight"},getComponentName:function(){return"Lighting"},getContainerField:function(){return"children"},getAttenuation:function(){return this.attenuation_.getValue()},getLocation:function(){return this.location_.getValue()},getRadius:function(){return Math.max(0,this.radius_.getValue())},getLights:function(){return b}}),_}),define("x_ite/Components/Lighting/SpotLight",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Lighting/X3DLightNode","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Geometry/Box3","standard/Math/Geometry/Camera","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix3","standard/Math/Numbers/Matrix4","standard/Math/Utility/MatrixStack","standard/Math/Algorithm","standard/Utility/ObjectCache"],function(t,e,n,i,r,o,s,a,u,l,c,h,d,p,f,g,m,x){"use strict";function v(){this.location=new c(0,0,0),this.direction=new c(0,0,0),this.matrixArray=new Float32Array(9),this.renderShadow=!0,this.shadowBuffer=null,this.bbox=new a,this.viewVolume=new l,this.viewport=new h(0,0,0,0),this.projectionMatrix=new f,this.modelViewMatrix=new g(f),this.modelMatrix=new f,this.invLightSpaceMatrix=new f,this.invLightSpaceProjectionMatrix=new f,this.shadowMatrix=new f,this.shadowMatrixArray=new Float32Array(16),this.rotation=new d,this.lightBBoxMin=new c(0,0,0),this.lightBBoxMax=new c(0,0,0),this.textureUnit=0}function _(t){i.call(this,t),this.addType(s.SpotLight),this.location_.setUnit("length"),this.radius_.setUnit("length"),this.beamWidth_.setUnit("angle"),this.cutOffAngle_.setUnit("angle")}var y=x(v);return v.prototype={constructor:v,getModelViewMatrix:function(){return this.modelViewMatrix},set:function(t,e,n,i){var r=t.getContext(),o=e.getShadowMapSize();this.browser=t,this.lightNode=e,this.groupNode=n;try{this.matrixArray.set(i.submatrix.inverse())}catch(t){this.matrixArray.set(p.Identity)}this.modelViewMatrix.pushMatrix(i),e.getShadowIntensity()>0&&o>0&&(this.shadowBuffer=t.popShadowBuffer(o),this.shadowBuffer?t.getCombinedTextureUnits().length?(this.textureUnit=t.getCombinedTextureUnits().pop(),r.activeTexture(r.TEXTURE0+this.textureUnit),r.getVersion()>=2||t.getExtension("WEBGL_depth_texture")?r.bindTexture(r.TEXTURE_2D,this.shadowBuffer.getDepthTexture()):r.bindTexture(r.TEXTURE_2D,this.shadowBuffer.getColorTexture()),r.activeTexture(r.TEXTURE0)):console.warn("Not enough combined texture units for shadow map available."):console.warn("Couldn't create shadow buffer."))},renderShadowMap:function(t){try{if(!this.shadowBuffer)return;var e=this.lightNode,n=t.getCameraSpaceMatrix().get(),i=this.modelMatrix.assign(this.modelViewMatrix.get()).multRight(n),s=this.invLightSpaceMatrix.assign(e.getGlobal()?i:f.Identity);s.translate(e.getLocation()),
s.rotate(this.rotation.setFromToVec(c.zAxis,this.direction.assign(e.getDirection()).negate())),s.inverse();var a=r.prototype.getBBox.call(this.groupNode,this.bbox),l=a.multRight(s),h=(l.getExtents(this.lightBBoxMin,this.lightBBoxMax),e.getShadowMapSize()),d=Math.min(e.getRadius(),-this.lightBBoxMin.z),p=this.viewport.set(0,0,h,h),g=u.perspective(2*e.getCutOffAngle(),.125,Math.max(1e4,d),h,h,this.projectionMatrix);this.renderShadow=d>0,this.shadowBuffer.bind(),t.getViewVolumes().push(this.viewVolume.set(g,p,p)),t.getProjectionMatrix().pushMatrix(g),t.getModelViewMatrix().pushMatrix(s),t.render(o.DEPTH,r.prototype.traverse,this.groupNode),t.getModelViewMatrix().pop(),t.getProjectionMatrix().pop(),t.getViewVolumes().pop(),this.shadowBuffer.unbind(),e.getGlobal()||s.multLeft(i.inverse()),this.invLightSpaceProjectionMatrix.assign(s).multRight(g).multRight(e.getBiasMatrix())}catch(t){console.log(t)}},setGlobalVariables:function(t){var e=this.lightNode,n=this.modelViewMatrix.get();n.multVecMatrix(this.location.assign(e.location_.getValue())),n.multDirMatrix(this.direction.assign(e.direction_.getValue())).normalize(),this.shadowMatrix.assign(t.getCameraSpaceMatrix().get()).multRight(this.invLightSpaceProjectionMatrix),this.shadowMatrixArray.set(this.shadowMatrix)},setShaderUniforms:function(t,e){var n=e.numLights++;if(!e.hasLight(n,this)){var i=this.lightNode,r=i.getColor(),o=i.getAttenuation(),s=this.location,a=this.direction;if(t.uniform1i(e.x3d_LightType[n],3),t.uniform3f(e.x3d_LightColor[n],r.r,r.g,r.b),t.uniform1f(e.x3d_LightIntensity[n],i.getIntensity()),t.uniform1f(e.x3d_LightAmbientIntensity[n],i.getAmbientIntensity()),t.uniform3f(e.x3d_LightAttenuation[n],Math.max(0,o.x),Math.max(0,o.y),Math.max(0,o.z)),t.uniform3f(e.x3d_LightLocation[n],s.x,s.y,s.z),t.uniform3f(e.x3d_LightDirection[n],a.x,a.y,a.z),t.uniform1f(e.x3d_LightRadius[n],i.getRadius()),t.uniform1f(e.x3d_LightBeamWidth[n],i.getBeamWidth()),t.uniform1f(e.x3d_LightCutOffAngle[n],i.getCutOffAngle()),t.uniformMatrix3fv(e.x3d_LightMatrix[n],!1,this.matrixArray),this.renderShadow&&this.textureUnit){var u=i.getShadowColor();t.uniform3f(e.x3d_ShadowColor[n],u.r,u.g,u.b),t.uniform1f(e.x3d_ShadowIntensity[n],i.getShadowIntensity()),t.uniform1f(e.x3d_ShadowBias[n],i.getShadowBias()),t.uniformMatrix4fv(e.x3d_ShadowMatrix[n],!1,this.shadowMatrixArray),t.uniform1i(e.x3d_ShadowMapSize[n],i.getShadowMapSize()),t.uniform1i(e.x3d_ShadowMap[n],this.textureUnit)}else t.uniform1f(e.x3d_ShadowIntensity[n],0)}},dispose:function(){this.textureUnit&&this.browser.getCombinedTextureUnits().push(this.textureUnit),this.browser.pushShadowBuffer(this.shadowBuffer),this.modelViewMatrix.clear(),this.browser=null,this.lightNode=null,this.groupNode=null,this.shadowBuffer=null,this.textureUnit=0,y.push(this)}},_.prototype=Object.assign(Object.create(i.prototype),{constructor:_,fieldDefinitions:new n([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"global",new t.SFBool(!0)),new e(s.inputOutput,"on",new t.SFBool(!0)),new e(s.inputOutput,"color",new t.SFColor(1,1,1)),new e(s.inputOutput,"intensity",new t.SFFloat(1)),new e(s.inputOutput,"ambientIntensity",new t.SFFloat),new e(s.inputOutput,"attenuation",new t.SFVec3f(1,0,0)),new e(s.inputOutput,"location",new t.SFVec3f),new e(s.inputOutput,"direction",new t.SFVec3f(0,0,-1)),new e(s.inputOutput,"radius",new t.SFFloat(100)),new e(s.inputOutput,"beamWidth",new t.SFFloat(.785398)),new e(s.inputOutput,"cutOffAngle",new t.SFFloat(1.5708)),new e(s.inputOutput,"shadowColor",new t.SFColor),new e(s.inputOutput,"shadowIntensity",new t.SFFloat),new e(s.inputOutput,"shadowBias",new t.SFFloat(.005)),new e(s.initializeOnly,"shadowMapSize",new t.SFInt32(1024))]),getTypeName:function(){return"SpotLight"},getComponentName:function(){return"Lighting"},getContainerField:function(){return"children"},getAttenuation:function(){return this.attenuation_.getValue()},getLocation:function(){return this.location_.getValue()},getRadius:function(){return Math.max(0,this.radius_.getValue())},getBeamWidth:function(){var t=this.beamWidth_.getValue(),e=this.getCutOffAngle();return t>e?e:m.clamp(t,0,Math.PI/2)},getCutOffAngle:function(){return m.clamp(this.cutOffAngle_.getValue(),0,Math.PI/2)},getLights:function(){return y}}),_}),define("x_ite/Components/Lighting",["x_ite/Configuration/SupportedNodes","x_ite/Components/Lighting/DirectionalLight","x_ite/Components/Lighting/PointLight","x_ite/Components/Lighting/SpotLight","x_ite/Components/Lighting/X3DLightNode"],function(t,e,n,i,r){"use strict";var o={DirectionalLight:e,PointLight:n,SpotLight:i},s={X3DLightNode:r};for(var a in o)t.addType(a,o[a]);for(var a in s)t.addAbstractType(a,s[a])}),define("x_ite/Components/Navigation/Billboard",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/X3DConstants","x_ite/Bits/TraverseType","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(t,e,n,i,r,o,s,a,u){"use strict";function l(t){i.call(this,t),this.addType(r.Billboard),this.matrix=new u}var c=new u,h=new s(0,1,0),d=new s(0,0,1),p=new s(0,0,0),f=new s(0,0,0),g=new s(0,0,0),m=new s(0,0,0),x=new s(0,0,0),v=new a(0,0,1,0);return l.prototype=Object.assign(Object.create(i.prototype),{constructor:l,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"axisOfRotation",new t.SFVec3f(0,1,0)),new e(r.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new e(r.initializeOnly,"bboxCenter",new t.SFVec3f),new e(r.inputOnly,"addChildren",new t.MFNode),new e(r.inputOnly,"removeChildren",new t.MFNode),new e(r.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"Billboard"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},getBBox:function(t){return i.prototype.getBBox.call(this,t).multRight(this.matrix)},getMatrix:function(){return this.matrix},rotate:function(t){c.assign(t).inverse();var e=c.origin.normalize();if(this.axisOfRotation_.getValue().equals(s.Zero)){c.multDirMatrix(p.assign(h)).normalize(),f.assign(p).cross(e),g.assign(e).cross(f);var n=e;f.normalize(),g.normalize(),this.matrix.set(f[0],f[1],f[2],0,g[0],g[1],g[2],0,n[0],n[1],n[2],0,0,0,0,1)}else m.assign(this.axisOfRotation_.getValue()).cross(e),x.assign(this.axisOfRotation_.getValue()).cross(d),this.matrix.setRotation(v.setFromToVec(x,m));return this.matrix},traverse:function(t,e){var n=e.getModelViewMatrix();n.push();try{switch(t){case o.CAMERA:case o.PICKING:case o.DEPTH:n.multLeft(this.matrix);break;default:n.multLeft(this.rotate(n.get()))}i.prototype.traverse.call(this,t,e)}catch(t){console.log(t)}n.pop()}}),l}),define("x_ite/Components/Navigation/Collision",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Components/Core/X3DSensorNode","x_ite/Bits/X3DCast","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants"],function(t,e,n,i,r,o,s,a){"use strict";function u(t){i.call(this,t),r.call(this,t),this.addType(a.Collision),"2.0"==t.getSpecificationVersion()&&this.addAlias("collide",this.enabled_)}return u.prototype=Object.assign(Object.create(i.prototype),r.prototype,{constructor:u,fieldDefinitions:new n([new e(a.inputOutput,"metadata",new t.SFNode),new e(a.inputOutput,"enabled",new t.SFBool(!0)),new e(a.outputOnly,"isActive",new t.SFBool),new e(a.outputOnly,"collideTime",new t.SFTime),new e(a.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new e(a.initializeOnly,"bboxCenter",new t.SFVec3f),new e(a.initializeOnly,"proxy",new t.SFNode),new e(a.inputOnly,"addChildren",new t.MFNode),new e(a.inputOnly,"removeChildren",new t.MFNode),new e(a.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"Collision"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this),this.enabled_.addInterest("set_live__",this),this.proxy_.addInterest("set_proxy__",this),this.set_live__(),this.set_proxy__()},set_live__:function(){this.isLive().getValue()&&this.enabled_.getValue()?this.getBrowser().addCollision(this):this.getBrowser().removeCollision(this)},set_active:function(t){this.isActive_.getValue()!==t&&(this.isActive_=t,t&&(this.collideTime_=this.getBrowser().getCurrentTime()))},set_proxy__:function(){this.proxyNode=o(a.X3DChildNode,this.proxy_)},traverse:function(t,e){switch(t){case s.COLLISION:if(this.enabled_.getValue()){var n=e.getCollisions();n.push(this),this.proxyNode?this.proxyNode.traverse(t,e):i.prototype.traverse.call(this,t,e),n.pop()}return;default:return void i.prototype.traverse.call(this,t,e)}}}),u}),define("x_ite/Components/Navigation/LOD",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/X3DCast","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Box3","standard/Math/Algorithm"],function(t,e,n,i,r,o,s,a,u,l){"use strict";function c(t){i.call(this,t),this.addType(s.LOD),"2.0"==t.getSpecificationVersion()&&this.addAlias("level",this.children_),this.center_.setUnit("length"),this.range_.setUnit("length"),this.frameRate=60,this.keepCurrentLevel=!1}return c.prototype=Object.assign(Object.create(i.prototype),{constructor:c,fieldDefinitions:new n([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.initializeOnly,"forceTransitions",new t.SFBool),new e(s.initializeOnly,"center",new t.SFVec3f),new e(s.initializeOnly,"range",new t.MFFloat),new e(s.outputOnly,"level_changed",new t.SFInt32(-1)),new e(s.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new e(s.initializeOnly,"bboxCenter",new t.SFVec3f),new e(s.inputOnly,"addChildren",new t.MFNode),new e(s.inputOnly,"removeChildren",new t.MFNode),new e(s.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"LOD"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.child=this.getChild(this.level_changed_.getValue()),this.set_cameraObjects__()},getBBox:function(t){if(this.bboxSize_.getValue().equals(this.getDefaultBBoxSize())){var e=r(s.X3DBoundedObject,this.child);return e?e.getBBox(t):t.set()}return t.set(this.bboxSize_.getValue(),this.bboxCenter_.getValue())},getSubBBox:function(t){return this.getBBox(t)},set_cameraObjects__:function(){this.child&&this.child.getCameraObject?this.setCameraObject(this.child.getCameraObject()):this.setCameraObject(!1)},set_pickableObjects__:function(){this.getTransformSensors().size?this.setPickableObject(!0):this.child&&this.child.getPickableObject?this.setPickableObject(this.child.getPickableObject()):this.setPickableObject(!1)},getLevel:function(){return function(t,e){if(0===this.range_.length){var n=this.children_.length;if(n<2)return 0;if(this.frameRate=(179*this.frameRate+t.currentFrameRate)/180,2===n)return 1*(this.frameRate>55);var i=1-l.clamp((this.frameRate-20)/35,0,1);return Math.min(Math.floor(i*n),n-1)}var r=this.getDistance(e);return l.upperBound(this.range_,0,this.range_.length,r,l.less)}}(),getDistance:function(t){return t.translate(this.center_.getValue()),t.origin.abs()},traverse:function(){var t=new a,e=new u;return function(n,i){var r=this.child;switch(n){case o.PICKING:if(this.getTransformSensors().size&&(this.getSubBBox(e).multRight(i.getModelViewMatrix().get()),this.getTransformSensors().forEach(function(t){t.collect(e)})),r){var s=i.getBrowser(),a=s.getPickingHierarchy();a.push(this),r.traverse(n,i),a.pop()}return;case o.DISPLAY:if(!this.keepCurrentLevel){var u=this.getLevel(i.getBrowser(),t.assign(i.getModelViewMatrix().get())),l=this.level_changed_.getValue();this.forceTransitions_.getValue()&&(u>l?u=l+1:u<l&&(u=l-1)),u!==l&&(this.level_changed_=u,r=this.child=this.getChild(Math.min(u,this.children_.length-1)),this.set_cameraObjects__())}return void(r&&r.traverse(n,i));default:return void(r&&r.traverse(n,i))}}}()}),c}),define("x_ite/Components/Navigation/ViewpointGroup",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Components/EnvironmentalSensor/ProximitySensor","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,n,i,r,o,s,a){"use strict";function u(t){i.call(this,t),this.addType(s.ViewpointGroup),this.size_.setUnit("length"),this.center_.setUnit("length"),this.proximitySensor=new r(t),this.cameraObjects=[],this.viewpointGroups=[]}function l(t,e){switch(t){case o.CAMERA:if(this.proximitySensor.traverse(t,e),this.proximitySensor.isActive_.getValue())for(var n=0,i=this.cameraObjects.length;n<i;++n)this.cameraObjects[n].traverse(t,e);return;case o.DISPLAY:if(this.proximitySensor.traverse(t,e),this.proximitySensor.isActive_.getValue())for(var n=0,i=this.viewpointGroups.length;n<i;++n)this.viewpointGroups[n].traverse(t,e);return}}function c(t,e){switch(t){case o.CAMERA:for(var n=0,i=this.cameraObjects.length;n<i;++n)this.cameraObjects[n].traverse(t,e);return;case o.DISPLAY:for(var n=0,i=this.viewpointGroups.length;n<i;++n)this.viewpointGroups[n].traverse(t,e);return}}return u.prototype=Object.assign(Object.create(i.prototype),{constructor:u,fieldDefinitions:new n([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"displayed",new t.SFBool(!0)),new e(s.inputOutput,"description",new t.SFString),new e(s.inputOutput,"retainUserOffsets",new t.SFBool),new e(s.inputOutput,"size",new t.SFVec3f),new e(s.inputOutput,"center",new t.SFVec3f),new e(s.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"ViewpointGroup"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.proximitySensor.setup(),this.size_.addFieldInterest(this.proximitySensor.size_),this.center_.addFieldInterest(this.proximitySensor.center_),this.proximitySensor.size_=this.size_,this.proximitySensor.center_=this.center_,this.displayed_.addInterest("set_displayed__",this),this.size_.addInterest("set_displayed__",this),this.children_.addInterest("set_children__",this),this.set_displayed__(),this.set_children__()},isActive:function(){return this.proximitySensor.isActive_.getValue()},set_displayed__:function(){var t=!this.size_.getValue().equals(a.Zero),e=this.displayed_.getValue();this.proximitySensor.enabled_=e&&t,e&&t?(this.proximitySensor.isCameraObject_.addFieldInterest(this.isCameraObject_),this.proximitySensor.isPickableObject_.addFieldInterest(this.isPickableObject_),this.setCameraObject(this.proximitySensor.getCameraObject()),this.setPickableObject(this.proximitySensor.getPickableObject()),this.traverse=l):(this.proximitySensor.isCameraObject_.removeFieldInterest(this.isCameraObject_),this.proximitySensor.isPickableObject_.removeFieldInterest(this.isPickableObject_),this.setCameraObject(e),this.setPickableObject(!1),e?this.traverse=c:delete this.traverse)},set_children__:function(){this.cameraObjects.length=0,this.viewpointGroups.length=0;for(var t=this.children_,e=0,n=t.length;e<n;++e)try{for(var i=t[e].getValue().getInnerNode(),r=i.getType(),o=r.length-1;o>=0;--o)switch(r[o]){case s.X3DViewpointNode:this.cameraObjects.push(i);break;case s.ViewpointGroup:this.cameraObjects.push(i),this.viewpointGroups.push(i)}}catch(t){}},traverse:function(){}}),u}),define("x_ite/Components/Navigation",["x_ite/Configuration/SupportedNodes","x_ite/Components/Navigation/Billboard","x_ite/Components/Navigation/Collision","x_ite/Components/Navigation/LOD","x_ite/Components/Navigation/NavigationInfo","x_ite/Components/Navigation/OrthoViewpoint","x_ite/Components/Navigation/Viewpoint","x_ite/Components/Navigation/ViewpointGroup","x_ite/Components/Navigation/X3DViewpointNode"],function(t,e,n,i,r,o,s,a,u){"use strict";var l={Billboard:e,Collision:n,LOD:i,NavigationInfo:r,OrthoViewpoint:o,Viewpoint:s,ViewpointGroup:a},c={X3DViewpointNode:u};for(var h in l)t.addType(h,l[h]);for(var h in c)t.addAbstractType(h,c[h])}),define("x_ite/Browser/PointingDeviceSensor/PointingDeviceSensorContainer",["standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4"],function(t,e){"use strict";function n(n,i,r,o){this.node=null,this.modelViewMatrix=new e,this.projectionMatrix=new e,this.viewport=new t(0,0,0,0),this.set(n,i,r,o)}return n.prototype={set:function(t,e,n,i){this.node=t,this.modelViewMatrix.assign(e),this.projectionMatrix.assign(n),this.viewport.assign(i)},set_over__:function(t,e){this.node.set_over__(t,e,this.modelViewMatrix,this.projectionMatrix,this.viewport)},set_active__:function(t,e){this.node.set_active__(t,e,this.modelViewMatrix,this.projectionMatrix,this.viewport)},set_motion__:function(t){this.node.set_motion__(t,this.modelViewMatrix,this.projectionMatrix,this.viewport)}},n}),define("x_ite/Components/PointingDeviceSensor/X3DPointingDeviceSensorNode",["x_ite/Components/Core/X3DSensorNode","x_ite/Browser/PointingDeviceSensor/PointingDeviceSensorContainer","x_ite/Bits/X3DConstants"],function(t,e,n){"use strict";function i(e){t.call(this,e),this.addType(n.X3DPointingDeviceSensorNode)}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,initialize:function(){t.prototype.initialize.call(this),this.enabled_.addInterest("set_enabled__",this)},getMatrices:function(){return this.matrices},set_enabled__:function(){this.enabled_.getValue()||(this.isActive_.getValue()&&(this.isActive_=!1),this.isOver_.getValue()&&(this.isOver_=!1))},set_over__:function(t,e){t!==this.isOver_.getValue()&&(this.isOver_=t,t&&(this.getBrowser().getNotification().string_=this.description_))},set_active__:function(t,e){t!==this.isActive_.getValue()&&(this.isActive_=t)},set_motion__:function(t){},push:function(t,n){this.enabled_.getValue()&&(n[this.getId()]=new e(this,t.getModelViewMatrix().get(),t.getProjectionMatrix().get(),t.getViewVolume().getViewport()))}}),i}),define("x_ite/Components/PointingDeviceSensor/X3DTouchSensorNode",["x_ite/Components/PointingDeviceSensor/X3DPointingDeviceSensorNode","x_ite/Bits/X3DConstants"],function(t,e){"use strict";function n(n){t.call(this,n),this.addType(e.X3DTouchSensorNode)}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,set_active__:function(e,n){t.prototype.set_active__.call(this,e,n),this.enabled_.getValue()&&this.isOver_.getValue()&&!e&&(this.touchTime_=this.getBrowser().getCurrentTime())}}),n}),define("x_ite/Components/PointingDeviceSensor/TouchSensor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/PointingDeviceSensor/X3DTouchSensorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.TouchSensor),this.hitPoint_changed_.setUnit("length")}var a=new o;return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"enabled",new t.SFBool(!0)),new e(r.inputOutput,"description",new t.SFString),new e(r.outputOnly,"hitTexCoord_changed",new t.SFVec2f),new e(r.outputOnly,"hitNormal_changed",new t.SFVec3f),new e(r.outputOnly,"hitPoint_changed",new t.SFVec3f),new e(r.outputOnly,"isOver",new t.SFBool),new e(r.outputOnly,"isActive",new t.SFBool),new e(r.outputOnly,"touchTime",new t.SFTime)]),getTypeName:function(){return"TouchSensor"},getComponentName:function(){return"PointingDeviceSensor"},getContainerField:function(){return"children"},set_over__:function(t,e,n,r,o){try{if(i.prototype.set_over__.call(this,t,e,n,r,o),this.isOver_.getValue()){var s=e.intersection;a.assign(n).inverse(),this.hitTexCoord_changed_=s.texCoord,this.hitNormal_changed_=n.multMatrixDir(s.normal.copy()).normalize(),this.hitPoint_changed_=a.multVecMatrix(s.point.copy())}}catch(t){console.log(t)}}}),s}),define("x_ite/Components/Networking/Anchor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Components/PointingDeviceSensor/TouchSensor","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","x_ite/InputOutput/FileLoader"],function(t,e,n,i,r,o,s,a,u){"use strict";function l(t){i.call(this,t),r.call(this,t),this.addType(a.Anchor),this.touchSensorNode=new o(t)}return l.prototype=Object.assign(Object.create(i.prototype),r.prototype,{constructor:l,fieldDefinitions:new n([new e(a.inputOutput,"metadata",new t.SFNode),new e(a.inputOutput,"description",new t.SFString),new e(a.inputOutput,"url",new t.MFString),new e(a.inputOutput,"parameter",new t.MFString),new e(a.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new e(a.initializeOnly,"bboxCenter",new t.SFVec3f),new e(a.inputOnly,"addChildren",new t.MFNode),new e(a.inputOnly,"removeChildren",new t.MFNode),new e(a.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"Anchor"},getComponentName:function(){return"Networking"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),r.prototype.initialize.call(this),this.description_.addFieldInterest(this.touchSensorNode.description_),this.touchSensorNode.description_=this.description_,this.touchSensorNode.setup();var t=this,e=this.touchSensorNode.set_active__;this.touchSensorNode.set_active__=function(n,i){e.call(this,n,i),this.isOver_.getValue()&&!n&&t.requestAsyncLoad()}},requestAsyncLoad:function(){this.setLoadState(a.IN_PROGRESS_STATE,!1),new u(this).createX3DFromURL(this.url_,this.parameter_,function(t){t?(this.getBrowser().replaceWorld(t),this.setLoadState(a.COMPLETE_STATE,!1)):this.setLoadState(a.FAILED_STATE,!1)}.bind(this),function(t){try{this.getExecutionContext().changeViewpoint(t)}catch(t){}this.setLoadState(a.COMPLETE_STATE,!1)}.bind(this),function(t,e){e?window.open(t,e):location=t,this.setLoadState(a.COMPLETE_STATE,!1)}.bind(this))},traverse:function(t,e){if(t===s.POINTER){var n={};e.getBrowser().getSensors().push(n),this.touchSensorNode.push(e,n),i.prototype.traverse.call(this,t,e),e.getBrowser().getSensors().pop()}else i.prototype.traverse.call(this,t,e)}}),l}),define("x_ite/Components/Networking/Inline",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Components/Grouping/Group","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","x_ite/InputOutput/FileLoader"],function(t,e,n,i,r,o,s,a,u,l){"use strict";function c(e){i.call(this,e),r.call(this,e),o.call(this,e),this.addType(u.Inline),this.addChildObjects("buffer",new t.SFTime),this.scene=this.getBrowser().getDefaultScene(),this.group=new s(e),this.group.addParent(this)}return c.prototype=Object.assign(Object.create(i.prototype),r.prototype,o.prototype,{constructor:c,fieldDefinitions:new n([new e(u.inputOutput,"metadata",new t.SFNode),new e(u.inputOutput,"load",new t.SFBool(!0)),new e(u.inputOutput,"url",new t.MFString),new e(u.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new e(u.initializeOnly,"bboxCenter",new t.SFVec3f)]),getTypeName:function(){return"Inline"},getComponentName:function(){return"Networking"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),r.prototype.initialize.call(this),o.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this),this.group.setPrivate(!0),this.group.setup(),this.group.isCameraObject_.addFieldInterest(this.isCameraObject_),this.group.isPickableObject_.addFieldInterest(this.isPickableObject_),this.load_.addInterest("set_load__",this),this.url_.addInterest("set_url__",this),this.buffer_.addInterest("set_buffer__",this),this.set_url__()},getBBox:function(t){return this.group.getBBox(t)},set_live__:function(){this.getPrivate()||this.scene.setLive(this.isLive().getValue())},set_load__:function(){this.load_.getValue()?(this.setLoadState(u.NOT_STARTED_STATE),this.requestAsyncLoad()):this.requestUnload()},set_url__:function(){this.load_.getValue()&&(this.setLoadState(u.NOT_STARTED_STATE),this.requestAsyncLoad())},requestImmediateLoad:function(){try{if(this.checkLoadState()===u.COMPLETE_STATE||this.checkLoadState()===u.IN_PROGRESS_STATE)return;this.setLoadState(u.IN_PROGRESS_STATE),this.setInternalScene(new l(this).createX3DFromURL(this.url_,null))}catch(t){console.log(t),this.setInternalScene(this.getBrowser().getDefaultScene())}},requestAsyncLoad:function(){this.checkLoadState()!==u.COMPLETE_STATE&&this.checkLoadState()!==u.IN_PROGRESS_STATE&&(this.setLoadState(u.IN_PROGRESS_STATE),this.buffer_.addEvent())},set_buffer__:function(){new l(this).createX3DFromURL(this.url_,null,this.setInternalSceneAsync.bind(this))},requestUnload:function(){this.checkLoadState()!==u.NOT_STARTED_STATE&&this.checkLoadState()!==u.FAILED_STATE&&(this.setLoadState(u.NOT_STARTED_STATE),this.setInternalScene(this.getBrowser().getDefaultScene()))},setInternalSceneAsync:function(t){t?(this.setLoadState(u.COMPLETE_STATE),this.setInternalScene(t)):(this.setLoadState(u.FAILED_STATE),this.setInternalScene(this.getBrowser().getDefaultScene()))},setInternalScene:function(t){this.scene.setLive(!1),this.scene.rootNodes.removeFieldInterest(this.group.children_),this.scene=t,this.scene.setExecutionContext(this.getExecutionContext()),this.scene.setPrivate(this.getExecutionContext().getPrivate()),this.scene.setup(),this.scene.rootNodes.addFieldInterest(this.group.children_),this.group.children_=this.scene.rootNodes,this.set_live__(),this.getBrowser().addBrowserEvent()},getInternalScene:function(){return this.scene},traverse:function(t,e){switch(t){case a.PICKING:var n=e.getBrowser(),i=n.getPickingHierarchy();return i.push(this),this.group.traverse(t,e),void i.pop();default:return void this.group.traverse(t,e)}}}),c}),define("x_ite/Components/Networking",["x_ite/Configuration/SupportedNodes","x_ite/Components/Networking/Anchor","x_ite/Components/Networking/Inline","x_ite/Components/Networking/LoadSensor","x_ite/Components/Networking/X3DNetworkSensorNode","x_ite/Components/Networking/X3DUrlObject"],function(t,e,n,i,r,o){"use strict";var s={Anchor:e,Inline:n,LoadSensor:i},a={X3DNetworkSensorNode:r,X3DUrlObject:o};for(var u in s)t.addType(u,s[u]);for(var u in a)t.addAbstractType(u,a[u])}),define("x_ite/Components/PointingDeviceSensor/X3DDragSensorNode",["x_ite/Components/PointingDeviceSensor/X3DPointingDeviceSensorNode","x_ite/Bits/X3DConstants"],function(t,e){"use strict";function n(n){t.call(this,n),this.addType(e.X3DDragSensorNode),this.trackPoint_changed_.setUnit("length")}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n}),n}),define("standard/Math/Geometry/Cylinder3",["standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Line3"],function(t,e,n,i){"use strict";function r(t,e){this.axis=t.copy(),this.radius=e}return r.prototype={constructor:r,intersectsLine:function(r,o,s){var a=new e(this.axis.direction,new t(0,1,0)),u=n.Rotation(a),l=1/this.radius,c=new n;c.scale(new t(l,l,l)),c.multLeft(u);var h=t.subtract(r.point,this.axis.point),d=new i(h,r.direction),p=d.multLineMatrix(c),f=this.unitCylinderIntersectsLine(p,o,s);if(f){var g=c.inverse();g.multVecMatrix(o),o.add(this.axis.point),g.multVecMatrix(s),s.add(this.axis.point)}return f},unitCylinderIntersectsLine:function(t,e,n){var i,r,o=t.point,s=t.direction,a=s[0]*s[0]+s[2]*s[2],u=2*(o[0]*s[0]+o[2]*s[2]),l=o[0]*o[0]+o[2]*o[2]-1,c=u*u-4*a*l;if(c<0)return!1;var h=Math.sqrt(c);return u>0?(i=-(2*l)/(h+u),r=-(h+u)/(2*a)):(i=2*l/(h-u),r=(h-u)/(2*a)),e.assign(s).multiply(i).add(o),n.assign(s).multiply(r).add(o),!0},toString:function(){return this.axis.toString()+" "+this.radius}},r}),define("x_ite/Components/PointingDeviceSensor/CylinderSensor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/PointingDeviceSensor/X3DDragSensorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Line3","standard/Math/Geometry/Plane3","standard/Math/Geometry/Cylinder3","standard/Math/Algorithm"],function(t,e,n,i,r,o,s,a,u,l,c,h){"use strict";function d(t){i.call(this,t),this.addType(r.CylinderSensor),this.diskAngle_.setUnit("angle"),this.minAngle_.setUnit("angle"),this.maxAngle_.setUnit("angle"),this.offset_.setUnit("angle")}return d.prototype=Object.assign(Object.create(i.prototype),{constructor:d,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"enabled",new t.SFBool(!0)),new e(r.inputOutput,"description",new t.SFString),new e(r.inputOutput,"axisRotation",new t.SFRotation),new e(r.inputOutput,"diskAngle",new t.SFFloat(.261792)),new e(r.inputOutput,"minAngle",new t.SFFloat),new e(r.inputOutput,"maxAngle",new t.SFFloat(-1)),new e(r.inputOutput,"offset",new t.SFFloat),new e(r.inputOutput,"autoOffset",new t.SFBool(!0)),new e(r.outputOnly,"trackPoint_changed",new t.SFVec3f),new e(r.outputOnly,"rotation_changed",new t.SFRotation),new e(r.outputOnly,"isOver",new t.SFBool),new e(r.outputOnly,"isActive",new t.SFBool)]),getTypeName:function(){return"CylinderSensor"},getComponentName:function(){return"PointingDeviceSensor"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.modelViewMatrix=new a,this.invModelViewMatrix=new a,this.cylinder=new c(new u(new o(0,0,0),new o(0,0,0)),0),this.disk=!1,this.yPlane=null,this.zPlane=null,this.sxPlane=null,this.szNormal=null,this.behind=!1,this.fromVector=new o(0,0,0),this.startOffset=new s(0,0,1,0)},isBehind:function(t,e){var n=new o(0,0,0),i=new o(0,0,0);return this.cylinder.intersectsLine(t,n,i),o.subtract(e,n).abs()>o.subtract(e,i).abs()},getTrackPoint:function(t,e){var n=new o(0,0,0);this.zPlane.intersectsLine(t,n);var i=o.add(n,this.cylinder.axis.getPerpendicularVector(n)),r=this.sxPlane.getDistanceToPoint(n)/this.cylinder.radius,a=Math.floor((r+1)/2),u=h.interval(r,-1,1),l=0===a?Math.asin(u):u*Math.PI/2,c=l+a*Math.PI;new s(this.cylinder.axis.direction,c).multVecRot(e.assign(this.szNormal).multiply(this.cylinder.radius)),e.add(i)},getAngle:function(t){return o.dot(t.getAxis(),this.cylinder.axis.direction)>0?t.angle:-t.angle},set_active__:function(t,e,n,r,a){i.prototype.set_active__.call(this,t,e,n,r,a);try{if(this.isActive_.getValue()){this.modelViewMatrix.assign(n),this.invModelViewMatrix.assign(n).inverse();var h=e.hitRay.copy().multLineMatrix(this.invModelViewMatrix),d=this.invModelViewMatrix.multVecMatrix(e.intersection.point.copy()),p=this.axisRotation_.getValue().multVecRot(new o(0,1,0)),f=this.invModelViewMatrix.multDirMatrix(new o(0,0,1)).normalize(),g=new u(new o(0,0,0),p),m=g.getPerpendicularVector(d).abs();this.cylinder=new c(g,m),this.disk=Math.abs(o.dot(f,p))>Math.cos(this.diskAngle_.getValue()),this.behind=this.isBehind(h,d),this.yPlane=new l(d,p),this.zPlane=new l(d,f);var x=this.invModelViewMatrix.origin,v=o.cross(p,x).normalize();this.sxPlane=new l(new o(0,0,0),v),this.szNormal=o.cross(v,p).normalize();var _=new o(0,0,0);this.disk?this.yPlane.intersectsLine(h,_):this.getTrackPoint(h,_),this.fromVector=this.cylinder.axis.getPerpendicularVector(_).negate(),this.startOffset=new s(p,this.offset_.getValue()),this.trackPoint_changed_=_,this.rotation_changed_=this.startOffset}else this.autoOffset_.getValue()&&(this.offset_=this.getAngle(this.rotation_changed_.getValue()))}catch(t){}},set_motion__:function(t){try{var e=t.hitRay.copy().multLineMatrix(this.invModelViewMatrix),n=new o(0,0,0);this.disk?this.yPlane.intersectsLine(e,n):this.getTrackPoint(e,n),this.trackPoint_changed_=n;var i=this.cylinder.axis.getPerpendicularVector(n).negate(),r=new s(this.fromVector,i);if(this.disk){
this.modelViewMatrix.multVecMatrix(n.copy()).z>0&&r.multRight(new s(this.yPlane.normal,Math.PI))}else this.behind&&r.inverse();if(r.multLeft(this.startOffset),this.minAngle_.getValue()>this.maxAngle_.getValue())this.rotation_changed_=r;else{var a=h.interval(this.getAngle(r),-Math.PI,Math.PI),u=h.interval(this.minAngle_.getValue(),-Math.PI,Math.PI),l=h.interval(this.maxAngle_.getValue(),-Math.PI,Math.PI);a<u?r.setAxisAngle(this.cylinder.axis.direction,u):a>l&&r.setAxisAngle(this.cylinder.axis.direction,l),this.rotation_changed_.getValue().equals(r)||(this.rotation_changed_=r)}}catch(t){this.trackPoint_changed_.addEvent(),this.rotation_changed_.addEvent()}}}),d}),define("x_ite/Components/PointingDeviceSensor/PlaneSensor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/PointingDeviceSensor/X3DDragSensorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Line3","standard/Math/Geometry/Plane3","standard/Math/Geometry/ViewVolume","standard/Math/Algorithm"],function(t,e,n,i,r,o,s,a,u,l,c,h,d){"use strict";function p(t){i.call(this,t),this.addType(r.PlaneSensor),this.offset_.setUnit("length"),this.minPosition_.setUnit("length"),this.maxPosition_.setUnit("length"),this.translation_changed_.setUnit("length")}var f=new l(s.Zero,s.Zero),g=new s(0,0,0),m=new l(s.Zero,s.Zero);return p.prototype=Object.assign(Object.create(i.prototype),{constructor:p,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"enabled",new t.SFBool(!0)),new e(r.inputOutput,"description",new t.SFString),new e(r.inputOutput,"axisRotation",new t.SFRotation),new e(r.inputOutput,"autoOffset",new t.SFBool(!0)),new e(r.inputOutput,"offset",new t.SFVec3f),new e(r.inputOutput,"minPosition",new t.SFVec2f),new e(r.inputOutput,"maxPosition",new t.SFVec2f(-1,-1)),new e(r.outputOnly,"trackPoint_changed",new t.SFVec3f),new e(r.outputOnly,"translation_changed",new t.SFVec3f),new e(r.outputOnly,"isOver",new t.SFBool),new e(r.outputOnly,"isActive",new t.SFBool)]),getTypeName:function(){return"PlaneSensor"},getComponentName:function(){return"PointingDeviceSensor"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.modelViewMatrix=new u,this.invModelViewMatrix=new u,this.projectionMatrix=new u,this.viewport=new a,this.planeSensor=!0,this.plane=null,this.line=null,this.startOffset=new s(0,0,0),this.startPoint=new s(0,0,0)},getLineTrackPoint:function(t,e,n){return h.projectLine(e,this.modelViewMatrix,this.projectionMatrix,this.viewport,f),f.getClosestPointToPoint(new s(t.pointer.x,t.pointer.y,0),g),h.unProjectRay(g.x,g.y,this.modelViewMatrix,this.projectionMatrix,this.viewport,m),e.getClosestPointToLine(m,n)},set_active__:function(t,e,n,r,o){i.prototype.set_active__.call(this,t,e,n,r,o);try{if(this.isActive_.getValue()){this.modelViewMatrix.assign(n),this.projectionMatrix.assign(r),this.viewport.assign(o),this.invModelViewMatrix.assign(n).inverse();var a=e.hitRay.copy().multLineMatrix(this.invModelViewMatrix),u=this.invModelViewMatrix.multVecMatrix(e.intersection.point.copy()),h=this.axisRotation_.getValue();if(this.minPosition_.x===this.maxPosition_.x){this.planeSensor=!1;var d=h.multVecRot(new s(0,Math.abs(this.maxPosition_.y-this.minPosition_.y),0));this.line=new l(u,d.normalize())}else if(this.minPosition_.y===this.maxPosition_.y){this.planeSensor=!1;var d=h.multVecRot(new s(Math.abs(this.maxPosition_.x-this.minPosition_.x),0,0));this.line=new l(u,d.normalize())}else this.planeSensor=!0,this.plane=new c(u,h.multVecRot(new s(0,0,1)));if(this.planeSensor)this.plane.intersectsLine(a,this.startPoint)&&this.trackStart(this.startPoint);else if(this.getLineTrackPoint(e,this.line,this.startPoint)){var p=new s(0,0,0);try{this.getLineTrackPoint(e,new l(this.line.direction,this.line.direction),p)}catch(t){p=this.startPoint}this.trackStart(p)}}else this.autoOffset_.getValue()&&(this.offset_=this.translation_changed_)}catch(t){console.log(t)}},trackStart:function(t){this.startOffset.assign(this.offset_.getValue()),this.trackPoint_changed_=t,this.translation_changed_=this.offset_.getValue()},set_motion__:function(t){try{if(this.planeSensor){var e=t.hitRay.copy().multLineMatrix(this.invModelViewMatrix),n=new s(0,0,0);if(!this.plane.intersectsLine(e,n))throw new Error("Plane and line are parallel.");this.track(n,n.copy())}else{var n=new s(0,0,0),i=new s(0,0,0);if(!this.getLineTrackPoint(t,this.line,n))throw new Error("Lines are parallel.");try{this.getLineTrackPoint(t,new l(s.Zero,this.line.direction),i)}catch(t){i.assign(n)}this.track(n,i)}}catch(t){this.trackPoint_changed_.addEvent(),this.translation_changed_.addEvent()}},track:function(t,e){var n=this.axisRotation_.getValue(),i=o.inverse(n).multVecRot(t.add(this.startOffset).subtract(this.startPoint));this.minPosition_.x>this.maxPosition_.x||(i.x=d.clamp(i.x,this.minPosition_.x,this.maxPosition_.x)),this.minPosition_.y>this.maxPosition_.y||(i.y=d.clamp(i.y,this.minPosition_.y,this.maxPosition_.y)),n.multVecRot(i),this.trackPoint_changed_.getValue().equals(e)||(this.trackPoint_changed_=e),this.translation_changed_.getValue().equals(i)||(this.translation_changed_=i)}}),p}),define("standard/Math/Geometry/Sphere3",["standard/Math/Numbers/Vector3"],function(t){"use strict";function e(t,e){this.radius=t,this.center=e.copy()}var n=new t(0,0,0),i=new t(0,0,0),r=new t(0,0,0),o=new t(0,0,0),s=new t(0,0,0),a=new t(0,0,0),u=new t(0,0,0),l=new t(0,0,0);return e.prototype={constructor:e,set:function(t,e){this.radius=t,this.center.assign(e)},intersectsLine:function(e,i,r){n.assign(this.center).subtract(e.point);var o=t.dot(n,e.direction);if(o<0)return!1;var s=t.dot(n,n)-Math.pow(o,2),a=Math.pow(this.radius,2);if(s>a)return!1;var u=Math.sqrt(a-s),l=o-u,c=o+u;return i.assign(e.direction).multiply(l).add(e.point),r.assign(e.direction).multiply(c).add(e.point),!0},intersectsTriangle:function(e,n,c){var h=this.center,d=this.radius;e.subtract(h),n.subtract(h),c.subtract(h),i.assign(n).subtract(e),r.assign(c).subtract(e);var p=d*d,f=i.cross(r),g=t.dot(e,f);if(g*g>p*t.dot(f,f))return!1;var m=t.dot(e,e),x=t.dot(e,n),v=t.dot(e,c),_=t.dot(n,n),y=t.dot(n,c),w=t.dot(c,c),b=m>p&&x>m&&v>m,S=_>p&&x>_&&y>_,C=w>p&&v>w&&y>w;if(b||S||C)return!1;i.assign(n).subtract(e),o.assign(c).subtract(n),s.assign(e).subtract(c);var T=x-m,F=y-_,O=v-w,N=t.dot(i,i),E=t.dot(o,o),M=t.dot(s,s);a.assign(e).multiply(N).subtract(i.multiply(T)),u.assign(n).multiply(E).subtract(o.multiply(F)),l.assign(c).multiply(M).subtract(s.multiply(O));var D=c.multiply(N).subtract(a),V=e.multiply(E).subtract(u),I=n.multiply(M).subtract(l),B=t.dot(a,a)>p*N*N&&t.dot(a,D)>0,L=t.dot(u,u)>p*E*E&&t.dot(u,V)>0,A=t.dot(l,l)>p*M*M&&t.dot(l,I)>0;return!(B||L||A)},toString:function(){return this.radius+" "+this.center.toString()}},e}),define("x_ite/Components/PointingDeviceSensor/SphereSensor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/PointingDeviceSensor/X3DDragSensorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Triangle3","standard/Math/Geometry/Line3","standard/Math/Geometry/Plane3","standard/Math/Geometry/Sphere3"],function(t,e,n,i,r,o,s,a,u,l,c,h){"use strict";function d(t){i.call(this,t),this.addType(r.SphereSensor)}return d.prototype=Object.assign(Object.create(i.prototype),{constructor:d,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"enabled",new t.SFBool(!0)),new e(r.inputOutput,"description",new t.SFString),new e(r.inputOutput,"autoOffset",new t.SFBool(!0)),new e(r.inputOutput,"offset",new t.SFRotation),new e(r.outputOnly,"trackPoint_changed",new t.SFVec3f),new e(r.outputOnly,"rotation_changed",new t.SFRotation),new e(r.outputOnly,"isOver",new t.SFBool),new e(r.outputOnly,"isActive",new t.SFBool)]),getTypeName:function(){return"SphereSensor"},getComponentName:function(){return"PointingDeviceSensor"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.modelViewMatrix=new a,this.invModelViewMatrix=new a,this.sphere=null,this.zPlane=null,this.behind=!1,this.fromVector=new o(0,0,0),this.startPoint=new o(0,0,0),this.startOffset=new s(0,0,1,0)},getTrackPoint:function(t,e,n){var i=new o(0,0,0);return!!this.sphere.intersectsLine(t,e,i)&&((o.subtract(t.point,i).abs()<o.subtract(t.point,e).abs())-n&&e.assign(i),!0)},set_active__:function(t,e,n,r,s){i.prototype.set_active__.call(this,t,e,n,r,s);try{if(this.isActive_.getValue()){this.modelViewMatrix.assign(n),this.invModelViewMatrix.assign(n).inverse();var a=this.invModelViewMatrix.multVecMatrix(e.intersection.point.copy()),u=new o(0,0,0);this.zPlane=new c(u,this.invModelViewMatrix.multDirMatrix(new o(0,0,1)).normalize()),this.sphere=new h(a.abs(),u),this.behind=this.zPlane.getDistanceToPoint(a)<0,this.fromVector.assign(a),this.startPoint.assign(a),this.startOffset.assign(this.offset_.getValue()),this.trackPoint_changed_=a,this.rotation_changed_=this.offset_.getValue()}else this.autoOffset_.getValue()&&(this.offset_=this.rotation_changed_)}catch(t){}},set_motion__:function(t){try{var e=t.hitRay.copy().multLineMatrix(this.invModelViewMatrix),n=new o(0,0,0);if(this.getTrackPoint(e,n,this.behind)){var i=this.invModelViewMatrix.multDirMatrix(new o(0,0,1)).normalize();this.zPlane=new c(n,i)}else{var r=new o(0,0,0);this.zPlane.intersectsLine(e,r),e=new l(r,o.subtract(this.sphere.center,r).normalize()),this.getTrackPoint(e,n,!1);var a=u.normal(this.sphere.center,n,this.startPoint,new o(0,0,0)),h=o.subtract(n,this.sphere.center).normalize(),d=o.cross(a,h).normalize(),p=o.subtract(n,d.multiply(o.subtract(r,n).abs()));e=new l(p,o.subtract(this.sphere.center,p).normalize()),this.getTrackPoint(e,n,!1)}this.trackPoint_changed_=n;var f=o.subtract(n,this.sphere.center),g=new s(this.fromVector,f);this.behind&&g.inverse(),this.rotation_changed_=s.multRight(this.startOffset,g)}catch(t){this.trackPoint_changed_.addEvent(),this.rotation_changed_.addEvent()}}}),d}),define("x_ite/Components/PointingDeviceSensor",["x_ite/Configuration/SupportedNodes","x_ite/Components/PointingDeviceSensor/CylinderSensor","x_ite/Components/PointingDeviceSensor/PlaneSensor","x_ite/Components/PointingDeviceSensor/SphereSensor","x_ite/Components/PointingDeviceSensor/TouchSensor","x_ite/Components/PointingDeviceSensor/X3DDragSensorNode","x_ite/Components/PointingDeviceSensor/X3DPointingDeviceSensorNode","x_ite/Components/PointingDeviceSensor/X3DTouchSensorNode"],function(t,e,n,i,r,o,s,a){"use strict";var u={CylinderSensor:e,PlaneSensor:n,SphereSensor:i,TouchSensor:r},l={X3DDragSensorNode:o,X3DPointingDeviceSensorNode:s,X3DTouchSensorNode:a};for(var c in u)t.addType(c,u[c]);for(var c in l)t.addAbstractType(c,l[c])}),define("x_ite/Components/Rendering/ClipPlane",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Geometry/Plane3","standard/Utility/ObjectCache"],function(t,e,n,i,r,o,s,a,u){"use strict";function l(){this.plane=new a(o.Zero,o.Zero)}function c(t){i.call(this,t),this.addType(r.ClipPlane),this.enabled=!1,this.plane=new s(0,0,0,0)}var h=u(l);return l.prototype={constructor:l,isClipped:function(t){return this.plane.getDistanceToPoint(t)<0},set:function(t,e){var n=this.plane,i=t.plane;try{n.normal.assign(i),n.distanceFromOrigin=-i.w,n.multRight(e)}catch(t){n.normal.set(0,0,0),n.distanceFromOrigin=0}},setShaderUniforms:function(t,e){var n=this.plane,i=n.normal;t.uniform4f(e.x3d_ClipPlane[e.numClipPlanes++],i.x,i.y,i.z,n.distanceFromOrigin)},dispose:function(){h.push(this)}},c.prototype=Object.assign(Object.create(i.prototype),{constructor:c,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"enabled",new t.SFBool(!0)),new e(r.inputOutput,"plane",new t.SFVec4f(0,1,0,0))]),getTypeName:function(){return"ClipPlane"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.enabled_.addInterest("set_enabled__",this),this.plane_.addInterest("set_enabled__",this),this.set_enabled__()},set_enabled__:function(){this.plane.assign(this.plane_.getValue()),this.enabled=this.enabled_.getValue()&&!this.plane.equals(s.Zero)},push:function(t){if(this.enabled){var e=h.pop();e.set(this,t.getModelViewMatrix().get()),t.getShaderObjects().push(e)}},pop:function(t){this.enabled&&t.getBrowser().getClipPlanes().push(t.getShaderObjects().pop())}}),c}),define("x_ite/Components/Rendering/X3DColorNode",["x_ite/Fields","x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Bits/X3DConstants"],function(t,e,n){"use strict";function i(i){e.call(this,i),this.addType(n.X3DColorNode),this.addChildObjects("transparent",new t.SFBool),this.transparent_.setAccessType(n.outputOnly)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,setTransparent:function(t){t!==this.transparent_.getValue()&&(this.transparent_=t)},getTransparent:function(){return this.transparent_.getValue()}}),i}),define("x_ite/Components/Rendering/Color",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DColorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector4"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.Color)}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"color",new t.MFColor)]),getTypeName:function(){return"Color"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"color"},initialize:function(){i.prototype.initialize.call(this),this.color_.addInterest("set_color__",this),this.set_color__()},set_color__:function(){this.color=this.color_.getValue(),this.length=this.color_.length},addColor:function(t,e){if(t>=0&&t<this.length){const n=this.color;t*=3,e.push(n[t],n[t+1],n[t+2],1)}else if(this.length){const n=this.color;t=3*(this.length-1),e.push(n[t],n[t+1],n[t+2],1)}else e.push(1,1,1,1)},addColors:function(t,e){const n=this.color;for(var i=0,r=3*this.length;i<r;i+=3)t.push(n[i],n[i+1],n[i+2],1);for(var i=r,r=3*e;i<r;i+=3)t.push(1,1,1,1)},getVectors:function(t){for(var e=this.color_,n=0,i=e.length;n<i;++n){var r=e[n];t[n]=new o(r.r,r.g,r.b,1)}return t.length=i,t}}),s}),define("x_ite/Components/Rendering/ColorRGBA",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DColorNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector4"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.ColorRGBA),this.setTransparent(!0)}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"color",new t.MFColorRGBA)]),getTypeName:function(){return"ColorRGBA"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"color"},initialize:function(){i.prototype.initialize.call(this),this.color_.addInterest("set_color__",this),this.set_color__()},set_color__:function(){this.color=this.color_.getValue(),this.length=this.color_.length},addColor:function(t,e){if(t>=0&&t<this.length){const n=this.color;t*=4,e.push(n[t],n[t+1],n[t+2],n[t+3])}else if(this.color_.length){const n=this.color;t=4*(this.color_.length-1),e.push(n[t],n[t+1],n[t+2],n[t+3])}else e.push(1,1,1,1)},addColors:function(t,e){const n=this.color;for(var i=0,r=4*this.length;i<r;i+=4)t.push(n[i],n[i+1],n[i+2],n[i+3]);for(var i=r,r=4*e;i<r;i+=4)t.push(1,1,1,1)},getVectors:function(t){for(var e=this.color_,n=0,i=e.length;n<i;++n){var r=e[n];t[n]=new o(r.r,r.g,r.b,r.a)}return t.length=i,t}}),s}),define("x_ite/Components/Rendering/X3DLineGeometryNode",["x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4"],function(t,e,n){"use strict";function i(e){t.call(this,e)}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,getShader:function(t){return t.getLineShader()},intersectsLine:function(t,e,n,i){return!1},intersectsBox:function(t,e,n){return!1},transfer:function(){if(1===this.getGeometryType()){var e=this.getTexCoords(),n=this.getVertices();this.getMultiTexCoords().push(e);for(var i=0,r=n.length;i<r;i+=8)e.push(n[i],n[i+1],n[i+2],n[i+3],n[i],n[i+1],n[i+2],n[i+3]);e.shrinkToFit()}t.prototype.transfer.call(this)},display:function(t,e){try{var n=e.browser,i=e.shaderNode;if(i.getCustom()||(i=this.getShader(n)),i.getValid()){var r=this.attribNodes,o=this.attribBuffers;e.geometryType=this.getGeometryType(),e.fogCoords=this.fogCoords,e.colorMaterial=this.colorMaterial,e.textureCoordinateNode=n.getDefaultTextureCoordinate(),i.enable(t),i.setLocalUniforms(t,e);for(var s=0,a=r.length;s<a;++s)r[s].enable(t,i,o[s]);this.fogCoords&&i.enableFogDepthAttribute(t,this.fogDepthBuffer),this.colorMaterial&&i.enableColorAttribute(t,this.colorBuffer),this.getMultiTexCoords().length&&i.enableTexCoordAttribute(t,this.texCoordBuffers,!0),i.enableVertexAttribute(t,this.vertexBuffer),t.drawArrays(i.primitiveMode===t.POINTS?t.POINTS:this.primitiveMode,0,this.vertexCount);for(var s=0,a=r.length;s<a;++s)r[s].disable(t,i);this.fogCoords&&i.disableFogDepthAttribute(t),this.colorMaterial&&i.disableColorAttribute(t),i.disableTexCoordAttribute(t),i.disable(t)}}catch(t){console.log(t)}},displayParticles:function(t,e,i,r){try{var o=e.browser,s=e.shaderNode;if(s.getCustom()||(s=this.getShader(o)),s.getValid()){var a=this.attribNodes,u=this.attribBuffers;e.geometryType=this.getGeometryType(),e.fogCoords=this.fogCoords,e.colorMaterial=this.colorMaterial,e.textureCoordinateNode=o.getDefaultTextureCoordinate(),s.enable(t),s.setLocalUniforms(t,e);for(var l=0,c=a.length;l<c;++l)a[l].enable(t,s,u[l]);this.fogCoords&&s.enableFogDepthAttribute(t,this.fogDepthBuffer),this.colorMaterial&&s.enableColorAttribute(t,this.colorBuffer),this.getMultiTexCoords().length&&s.enableTexCoordAttribute(t,this.texCoordBuffers),s.enableVertexAttribute(t,this.vertexBuffer);for(var h=e.modelViewMatrix,d=h[12],p=h[13],f=h[14],g=s.primitiveMode===t.POINTS?t.POINTS:this.primitiveMode,m=0;m<r;++m)h[12]=d,h[13]=p,h[14]=f,n.prototype.translate.call(h,i[m].position),t.uniformMatrix4fv(s.x3d_ModelViewMatrix,!1,h),t.drawArrays(g,0,this.vertexCount);for(var l=0,c=a.length;l<c;++l)a[l].disable(t,s);this.fogCoords&&s.disableFogDepthAttribute(t),this.colorMaterial&&s.disableColorAttribute(t),s.disableTexCoordAttribute(t),s.disable(t)}}catch(t){console.log(t)}}}),i}),define("x_ite/Components/Rendering/IndexedLineSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DLineGeometryNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(o.IndexedLineSet),this.setGeometryType(1),this.fogCoordNode=null,this.colorNode=null,this.coordNode=null}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new e(o.inputOutput,"colorIndex",new t.MFInt32),new e(o.inputOutput,"coordIndex",new t.MFInt32),new e(o.inputOutput,"attrib",new t.MFNode),new e(o.inputOutput,"fogCoord",new t.SFNode),new e(o.inputOutput,"color",new t.SFNode),new e(o.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"IndexedLineSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){i.prototype.initialize.call(this),this.attrib_.addInterest("set_attrib__",this),this.fogCoord_.addInterest("set_fogCoord__",this),this.color_.addInterest("set_color__",this),this.coord_.addInterest("set_coord__",this),this.setPrimitiveMode(this.getBrowser().getContext().LINES),this.setSolid(!1),this.set_attrib__(),this.set_fogCoord__(),this.set_color__(),this.set_coord__()},set_attrib__:function(){for(var t=this.getAttrib(),e=0,n=t.length;e<n;++e)t[e].removeInterest("requestRebuild",this);t.length=0;for(var e=0,n=this.attrib_.length;e<n;++e){var i=r(o.X3DVertexAttributeNode,this.attrib_[e]);i&&t.push(i)}for(var e=0;e<this.attribNodes.length;++e)t[e].addInterest("requestRebuild",this)},set_fogCoord__:function(){this.fogCoordNode&&this.fogCoordNode.removeInterest("requestRebuild",this),this.fogCoordNode=r(o.FogCoordinate,this.fogCoord_),this.fogCoordNode&&this.fogCoordNode.addInterest("requestRebuild",this)},set_color__:function(){this.colorNode&&(this.colorNode.removeInterest("requestRebuild",this),this.colorNode.transparent_.removeInterest("set_transparent__",this)),this.colorNode=r(o.X3DColorNode,this.color_),this.colorNode?(this.colorNode.addInterest("requestRebuild",this),this.colorNode.transparent_.addInterest("set_transparent__",this),this.set_transparent__()):this.setTransparent(!1)},set_transparent__:function(){this.setTransparent(this.colorNode.getTransparent())},set_coord__:function(){this.coordNode&&this.coordNode.removeInterest("requestRebuild",this),this.coordNode=r(o.X3DCoordinateNode,this.coord_),this.coordNode&&this.coordNode.addInterest("requestRebuild",this)},getColorPerVertexIndex:function(t){return t<this.colorIndex_.length?this.colorIndex_[t]:this.coordIndex_[t]},getColorIndex:function(t){return t<this.colorIndex_.length?this.colorIndex_[t]:t},getPolylineIndices:function(){var t=this.coordIndex_,e=[],n=[];if(t.length){for(var i=0,i=0,r=t.length;i<r;++i){t[i]>=0?n.push(i):(e.push(n),n=[])}t[t.length-1]>=0&&e.push(n)}return e},build:function(){if(this.coordNode&&!this.coordNode.isEmpty())for(var t=this.coordIndex_,e=this.getPolylineIndices(),n=this.colorPerVertex_.getValue(),i=this.getAttrib(),r=i.length,o=this.getAttribs(),s=this.fogCoordNode,a=this.colorNode,u=this.coordNode,l=this.getFogDepths(),c=this.getColors(),h=this.getVertices(),d=0,p=0,f=e.length;p<f;++p){var g=e[p];if(g.length>1)for(var m=0,x=g.length-1;m<x;++m)for(var v=m,_=m+2;v<_;++v){for(var y=g[v],w=t[y],b=0;b<r;++b)i[b].addValue(w,o[b]);s&&s.addDepth(w,l),a&&(n?a.addColor(this.getColorPerVertexIndex(y),c):a.addColor(this.getColorIndex(d),c)),u.addPoint(w,h)}++d}}}),s}),define("x_ite/Components/Rendering/IndexedTriangleFanSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Bits/X3DConstants"],function(t,e,n,i,r){"use strict";function o(t){i.call(this,t),this.addType(r.IndexedTriangleFanSet),this.triangleIndex=[]}return o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.initializeOnly,"solid",new t.SFBool(!0)),new e(r.initializeOnly,"ccw",new t.SFBool(!0)),new e(r.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new e(r.initializeOnly,"normalPerVertex",new t.SFBool(!0)),new e(r.inputOutput,"index",new t.MFInt32),new e(r.inputOutput,"attrib",new t.MFNode),new e(r.inputOutput,"fogCoord",new t.SFNode),new e(r.inputOutput,"color",new t.SFNode),new e(r.inputOutput,"texCoord",new t.SFNode),new e(r.inputOutput,"normal",new t.SFNode),new e(r.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"IndexedTriangleFanSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){i.prototype.initialize.call(this),this.index_.addInterest("set_index__",this),this.set_index__()},set_index__:function(){var t=this.index_,e=this.triangleIndex;e.length=0;for(var n=0,i=t.length;n<i;++n){var r=t[n];if(++n<i){var o=t[n];if(o<0)continue;for(++n;n<i;++n){var s=t[n];if(s<0)break;e.push(r,o,s),o=s}}}},getPolygonIndex:function(t){return this.triangleIndex[t]},build:function(){i.prototype.build.call(this,3,this.triangleIndex.length,3,this.triangleIndex.length)}}),o}),define("x_ite/Components/Rendering/IndexedTriangleSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Bits/X3DConstants"],function(t,e,n,i,r){"use strict";function o(t){i.call(this,t),this.addType(r.IndexedTriangleSet)}return o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.initializeOnly,"solid",new t.SFBool(!0)),new e(r.initializeOnly,"ccw",new t.SFBool(!0)),new e(r.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new e(r.initializeOnly,"normalPerVertex",new t.SFBool(!0)),new e(r.inputOutput,"index",new t.MFInt32),new e(r.inputOutput,"attrib",new t.MFNode),new e(r.inputOutput,"fogCoord",new t.SFNode),new e(r.inputOutput,"color",new t.SFNode),new e(r.inputOutput,"texCoord",new t.SFNode),new e(r.inputOutput,"normal",new t.SFNode),new e(r.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"IndexedTriangleSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},getPolygonIndex:function(t){return this.index_[t]},build:function(){i.prototype.build.call(this,3,this.index_.length,3,this.index_.length)}}),o}),define("x_ite/Components/Rendering/IndexedTriangleStripSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Bits/X3DConstants"],function(t,e,n,i,r){"use strict";function o(t){i.call(this,t),this.addType(r.IndexedTriangleStripSet),this.triangleIndex=[]}return o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.initializeOnly,"solid",new t.SFBool(!0)),new e(r.initializeOnly,"ccw",new t.SFBool(!0)),new e(r.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new e(r.initializeOnly,"normalPerVertex",new t.SFBool(!0)),new e(r.inputOutput,"index",new t.MFInt32),new e(r.inputOutput,"attrib",new t.MFNode),new e(r.inputOutput,"fogCoord",new t.SFNode),new e(r.inputOutput,"color",new t.SFNode),new e(r.inputOutput,"texCoord",new t.SFNode),new e(r.inputOutput,"normal",new t.SFNode),new e(r.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"IndexedTriangleStripSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){i.prototype.initialize.call(this),this.index_.addInterest("set_index__",this),this.set_index__()},set_index__:function(){var t=this.index_,e=this.triangleIndex;e.length=0;for(var n=0,i=t.length;n<i;++n){var r=t[n];if(!(r<0)&&++n<i){var o=t[n];if(o<0)continue;++n;for(var s=0;n<i;++n,++s){var a=t[n];if(a<0)break;e.push(r,o,a),1&s?o=a:r=a}}}},getPolygonIndex:function(t){return this.triangleIndex[t]},build:function(){i.prototype.build.call(this,3,this.triangleIndex.length,3,this.triangleIndex.length)}}),o}),define("x_ite/Components/Rendering/LineSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DLineGeometryNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(o.LineSet),this.setGeometryType(1),this.fogCoordNode=null,this.colorNode=null,this.coordNode=null}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOutput,"vertexCount",new t.MFInt32),new e(o.inputOutput,"attrib",new t.MFNode),new e(o.inputOutput,"fogCoord",new t.SFNode),new e(o.inputOutput,"color",new t.SFNode),new e(o.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"LineSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){i.prototype.initialize.call(this),this.attrib_.addInterest("set_attrib__",this),this.fogCoord_.addInterest("set_fogCoord__",this),this.color_.addInterest("set_color__",this),this.coord_.addInterest("set_coord__",this),this.setPrimitiveMode(this.getBrowser().getContext().LINES),this.setSolid(!1),this.set_attrib__(),this.set_fogCoord__(),this.set_color__(),this.set_coord__()},set_attrib__:function(){for(var t=this.getAttrib(),e=0,n=t.length;e<n;++e)t[e].removeInterest("requestRebuild",this);t.length=0;for(var e=0,n=this.attrib_.length;e<n;++e){var i=r(o.X3DVertexAttributeNode,this.attrib_[e]);i&&t.push(i)}for(var e=0;e<this.attribNodes.length;++e)t[e].addInterest("requestRebuild",this)},set_fogCoord__:function(){this.fogCoordNode&&this.fogCoordNode.removeInterest("requestRebuild",this),this.fogCoordNode=r(o.FogCoordinate,this.fogCoord_),this.fogCoordNode&&this.fogCoordNode.addInterest("requestRebuild",this)},set_color__:function(){this.colorNode&&(this.colorNode.removeInterest("requestRebuild",this),this.colorNode.transparent_.removeInterest("set_transparent__",this)),this.colorNode=r(o.X3DColorNode,this.color_),this.colorNode?(this.colorNode.addInterest("requestRebuild",this),this.colorNode.transparent_.addInterest("set_transparent__",this),this.set_transparent__()):this.setTransparent(!1)},set_transparent__:function(){this.setTransparent(this.colorNode.getTransparent())},set_coord__:function(){this.coordNode&&this.coordNode.removeInterest("requestRebuild",this),this.coordNode=r(o.X3DCoordinateNode,this.coord_),this.coordNode&&this.coordNode.addInterest("requestRebuild",this)},build:function(){if(this.coordNode&&!this.coordNode.isEmpty())for(var t=this.vertexCount_,e=this.getAttrib(),n=e.length,i=this.getAttribs(),r=this.fogCoordNode,o=this.colorNode,s=this.coordNode,a=this.getFogDepths(),u=this.getColors(),l=this.getVertices(),c=s.getSize(),h=0,d=0,p=t.length;d<p;++d){var f=t[d];if(h+f>c)break;if(f>1){f=2*f-2;for(var g=0;g<f;++g,h+=1&g){for(var m=0;m<n;++m)e[m].addValue(h,i[m]);r&&r.addDepth(h,a),o&&o.addColor(h,u),s.addPoint(h,l)}++h}else h+=f}}}),s}),define("x_ite/Components/Rendering/X3DNormalNode",["x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Bits/X3DConstants"],function(t,e){"use strict";function n(n){t.call(this,n),this.addType(e.X3DNormalNode)}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n}),n}),define("x_ite/Components/Rendering/Normal",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DNormalNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.Normal)}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"vector",new t.MFVec3f)]),getTypeName:function(){return"Normal"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"normal"},initialize:function(){i.prototype.initialize.call(this),this.vector_.addInterest("set_vector__",this),this.set_vector__()},set_vector__:function(){this.vector=this.vector_.getValue(),this.length=this.vector_.length},set1Vector:function(t,e){this.vector_[t]=e},get1Vector:function(t,e){if(t<this.length){const n=this.vector;return t*=3,e.set(n[t],n[t+1],n[t+2])}return e.set(0,0,0)},addVector:function(t,e){if(!(t>=0&&t<this.length))return e.push(0,0,0);{const n=this.vector;t*=3,e.push(n[t],n[t+1],n[t+2])}}}),s}),define("x_ite/Components/Rendering/PointSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DLineGeometryNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(o.PointSet),
this.setGeometryType(0),this.setTransparent(!0),this.fogCoordNode=null,this.colorNode=null,this.coordNode=null}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOutput,"attrib",new t.MFNode),new e(o.inputOutput,"fogCoord",new t.SFNode),new e(o.inputOutput,"color",new t.SFNode),new e(o.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"PointSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){i.prototype.initialize.call(this),this.attrib_.addInterest("set_attrib__",this),this.fogCoord_.addInterest("set_fogCoord__",this),this.color_.addInterest("set_color__",this),this.coord_.addInterest("set_coord__",this);var t=this.getBrowser();this.setPrimitiveMode(t.getContext().POINTS),this.setSolid(!1),this.set_attrib__(),this.set_fogCoord__(),this.set_color__(),this.set_coord__()},getShader:function(t){return t.getPointShader()},getCoord:function(){return this.coordNode},set_attrib__:function(){for(var t=this.getAttrib(),e=0,n=t.length;e<n;++e)t[e].removeInterest("requestRebuild",this);t.length=0;for(var e=0,n=this.attrib_.length;e<n;++e){var i=r(o.X3DVertexAttributeNode,this.attrib_[e]);i&&t.push(i)}for(var e=0;e<this.attribNodes.length;++e)t[e].addInterest("requestRebuild",this)},set_fogCoord__:function(){this.fogCoordNode&&this.fogCoordNode.removeInterest("requestRebuild",this),this.fogCoordNode=r(o.FogCoordinate,this.fogCoord_),this.fogCoordNode&&this.fogCoordNode.addInterest("requestRebuild",this)},set_color__:function(){this.colorNode&&this.colorNode.removeInterest("requestRebuild",this),this.colorNode=r(o.X3DColorNode,this.color_),this.colorNode&&this.colorNode.addInterest("requestRebuild",this)},set_coord__:function(){this.coordNode&&this.coordNode.removeInterest("requestRebuild",this),this.coordNode=r(o.X3DCoordinateNode,this.coord_),this.coordNode&&this.coordNode.addInterest("requestRebuild",this)},build:function(){if(this.coordNode&&!this.coordNode.isEmpty()){for(var t=this.getAttrib(),e=t.length,n=this.getAttribs(),i=this.fogCoordNode,r=this.colorNode,o=this.coordNode,s=this.getFogDepths(),a=this.getColors(),u=this.getVertices(),l=o.point_.length,c=0;c<e;++c)for(var h=0;h<l;++h)t[c].addValue(h,n[c]);i&&i.addDepths(s,l),r&&r.addColors(a,l),o.addPoints(u,l)}}}),s}),define("x_ite/Components/Rendering/TriangleFanSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Bits/X3DConstants"],function(t,e,n,i,r){"use strict";function o(t){i.call(this,t),this.addType(r.TriangleFanSet),this.triangleIndex=[]}return o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.initializeOnly,"solid",new t.SFBool(!0)),new e(r.initializeOnly,"ccw",new t.SFBool(!0)),new e(r.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new e(r.initializeOnly,"normalPerVertex",new t.SFBool(!0)),new e(r.inputOutput,"fanCount",new t.MFInt32),new e(r.inputOutput,"attrib",new t.MFNode),new e(r.inputOutput,"fogCoord",new t.SFNode),new e(r.inputOutput,"color",new t.SFNode),new e(r.inputOutput,"texCoord",new t.SFNode),new e(r.inputOutput,"normal",new t.SFNode),new e(r.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"TriangleFanSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){i.prototype.initialize.call(this),this.fanCount_.addInterest("set_fanCount__",this),this.set_fanCount__()},set_fanCount__:function(){var t=this.fanCount_,e=this.triangleIndex;e.length=0;for(var n=0,i=t.length,r=0;n<i;++n){for(var o=t[n],s=1,a=o-1;s<a;++s)e.push(r,r+s,r+s+1);r+=o}},getPolygonIndex:function(t){return this.triangleIndex[t]},build:function(){i.prototype.build.call(this,3,this.triangleIndex.length,3,this.triangleIndex.length)}}),o}),define("x_ite/Components/Rendering/TriangleSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Bits/X3DConstants"],function(t,e,n,i,r){"use strict";function o(t){i.call(this,t),this.addType(r.TriangleSet)}return o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.initializeOnly,"solid",new t.SFBool(!0)),new e(r.initializeOnly,"ccw",new t.SFBool(!0)),new e(r.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new e(r.initializeOnly,"normalPerVertex",new t.SFBool(!0)),new e(r.inputOutput,"attrib",new t.MFNode),new e(r.inputOutput,"fogCoord",new t.SFNode),new e(r.inputOutput,"color",new t.SFNode),new e(r.inputOutput,"texCoord",new t.SFNode),new e(r.inputOutput,"normal",new t.SFNode),new e(r.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"TriangleSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},build:function(){this.getCoord()&&i.prototype.build.call(this,3,this.getCoord().getSize(),3,this.getCoord().getSize())},createNormals:function(t,e){return this.createFaceNormals(t,e)}}),o}),define("x_ite/Components/Rendering/TriangleStripSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Bits/X3DConstants"],function(t,e,n,i,r){"use strict";function o(t){i.call(this,t),this.addType(r.TriangleStripSet),this.triangleIndex=[]}return o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.initializeOnly,"solid",new t.SFBool(!0)),new e(r.initializeOnly,"ccw",new t.SFBool(!0)),new e(r.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new e(r.initializeOnly,"normalPerVertex",new t.SFBool(!0)),new e(r.inputOutput,"stripCount",new t.MFInt32),new e(r.inputOutput,"attrib",new t.MFNode),new e(r.inputOutput,"fogCoord",new t.SFNode),new e(r.inputOutput,"color",new t.SFNode),new e(r.inputOutput,"texCoord",new t.SFNode),new e(r.inputOutput,"normal",new t.SFNode),new e(r.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"TriangleStripSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){i.prototype.initialize.call(this),this.stripCount_.addInterest("set_stripCount__",this),this.set_stripCount__()},set_stripCount__:function(){var t=this.stripCount_,e=this.triangleIndex;e.length=0;for(var n=0,i=t.length,r=0;n<i;++n){for(var o=t[n],s=0,a=o-2;s<a;++s){var u=1&s;e.push(r+(u?s+1:s),r+(u?s:s+1),r+(s+2))}r+=o}},getPolygonIndex:function(t){return this.triangleIndex[t]},build:function(){i.prototype.build.call(this,3,this.triangleIndex.length,3,this.triangleIndex.length)}}),o}),define("x_ite/Components/Rendering",["x_ite/Configuration/SupportedNodes","x_ite/Components/Rendering/ClipPlane","x_ite/Components/Rendering/Color","x_ite/Components/Rendering/ColorRGBA","x_ite/Components/Rendering/Coordinate","x_ite/Components/Rendering/IndexedLineSet","x_ite/Components/Rendering/IndexedTriangleFanSet","x_ite/Components/Rendering/IndexedTriangleSet","x_ite/Components/Rendering/IndexedTriangleStripSet","x_ite/Components/Rendering/LineSet","x_ite/Components/Rendering/Normal","x_ite/Components/Rendering/PointSet","x_ite/Components/Rendering/TriangleFanSet","x_ite/Components/Rendering/TriangleSet","x_ite/Components/Rendering/TriangleStripSet","x_ite/Components/Rendering/X3DColorNode","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Components/Rendering/X3DCoordinateNode","x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Components/Rendering/X3DLineGeometryNode","x_ite/Components/Rendering/X3DNormalNode"],function(t,e,n,i,r,o,s,a,u,l,c,h,d,p,f,g,m,x,v,_,y,w){"use strict";var b={ClipPlane:e,Color:n,ColorRGBA:i,Coordinate:r,IndexedLineSet:o,IndexedTriangleFanSet:s,IndexedTriangleSet:a,IndexedTriangleStripSet:u,LineSet:l,Normal:c,PointSet:h,TriangleFanSet:d,TriangleSet:p,TriangleStripSet:f},S={X3DColorNode:g,X3DComposedGeometryNode:m,X3DCoordinateNode:x,X3DGeometricPropertyNode:v,X3DGeometryNode:_,X3DLineGeometryNode:y,X3DNormalNode:w};for(var C in b)t.addType(C,b[C]);for(var C in S)t.addAbstractType(C,S[C])}),define("x_ite/Components/Shaders/X3DVertexAttributeNode",["x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Bits/X3DConstants"],function(t,e){"use strict";function n(n){t.call(this,n),this.addType(e.X3DVertexAttributeNode)}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n}),n}),define("x_ite/Components/Shaders/FloatVertexAttribute",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shaders/X3DVertexAttributeNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.FloatVertexAttribute)}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.initializeOnly,"name",new t.SFString),new e(r.initializeOnly,"numComponents",new t.SFInt32(4)),new e(r.inputOutput,"value",new t.MFFloat)]),getTypeName:function(){return"FloatVertexAttribute"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"attrib"},initialize:function(){i.prototype.initialize.call(this),this.numComponents_.addInterest("set_numComponents",this),this.value_.addInterest("set_value",this),this.set_numComponents(),this.set_value()},set_numComponents:function(){this.numComponents=o.clamp(this.numComponents_.getValue(),1,4)},set_value:function(){this.value=this.value_.getValue(),this.length=this.value_.length},addValue:function(t,e){var n=this.value,i=t*this.numComponents,r=i+this.numComponents;if(r<=this.length)for(;i<r;++i)e.push(n[i]);else for(;i<r;++i)e.push(0)},enable:function(t,e,n){e.enableFloatAttrib(t,this.name_.getValue(),n,this.numComponents)},disable:function(t,e){e.disableFloatAttrib(t,this.name_.getValue())}}),s}),define("x_ite/Components/Shaders/Matrix3VertexAttribute",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shaders/X3DVertexAttributeNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix3"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.Matrix3VertexAttribute)}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.initializeOnly,"name",new t.SFString),new e(r.inputOutput,"value",new t.MFMatrix3f)]),getTypeName:function(){return"Matrix3VertexAttribute"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"attrib"},initialize:function(){i.prototype.initialize.call(this),this.value_.addInterest("set_value",this),this.set_value()},set_value:function(){this.value=this.value_.getValue(),this.length=this.value_.length},addValue:function(t,e){if(t<this.length)for(var n=this.value,i=9*t,r=i+9;i<r;++i)e.push(n[i]);else for(var n=o.Identity,i=0;i<9;++i)e.push(n[i])},enable:function(t,e,n){e.enableMatrix3Attrib(t,this.name_.getValue(),n)},disable:function(t,e){e.disableMatrix3Attrib(t,this.name_.getValue())}}),s}),define("x_ite/Components/Shaders/Matrix4VertexAttribute",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shaders/X3DVertexAttributeNode","x_ite/Bits/X3DConstants"],function(t,e,n,i,r){"use strict";function o(t){i.call(this,t),this.addType(r.Matrix4VertexAttribute)}return o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.initializeOnly,"name",new t.SFString),new e(r.inputOutput,"value",new t.MFMatrix4f)]),getTypeName:function(){return"Matrix4VertexAttribute"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"attrib"},initialize:function(){i.prototype.initialize.call(this),this.value_.addInterest("set_value",this),this.set_value()},set_value:function(){this.value=this.value_.getValue(),this.length=this.value_.length},addValue:function(t,e){if(t<this.length)for(var n=this.value,i=16*t,r=i+16;i<r;++i)e.push(n[i]);else for(var n=Matrix4.Identity,i=0;i<16;++i)e.push(n[i])},enable:function(t,e,n){e.enableMatrix4Attrib(t,this.name_.getValue(),n)},disable:function(t,e){e.disableMatrix4Attrib(t,this.name_.getValue())}}),o}),define("x_ite/Components/Shaders",["x_ite/Configuration/SupportedNodes","x_ite/Components/Shaders/ComposedShader","x_ite/Components/Shaders/FloatVertexAttribute","x_ite/Components/Shaders/Matrix3VertexAttribute","x_ite/Components/Shaders/Matrix4VertexAttribute","x_ite/Components/Shaders/ShaderPart","x_ite/Components/Shaders/X3DProgrammableShaderObject","x_ite/Components/Shaders/X3DShaderNode","x_ite/Components/Shaders/X3DVertexAttributeNode"],function(t,e,n,i,r,o,s,a,u){"use strict";var l={ComposedShader:e,FloatVertexAttribute:n,Matrix3VertexAttribute:i,Matrix4VertexAttribute:r,ShaderPart:o},c={X3DProgrammableShaderObject:s,X3DShaderNode:a,X3DVertexAttributeNode:u};for(var h in l)t.addType(h,l[h]);for(var h in c)t.addAbstractType(h,c[h])}),define("x_ite/Components/Shape/X3DMaterialNode",["x_ite/Fields","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Bits/X3DConstants"],function(t,e,n){"use strict";function i(i){e.call(this,i),this.addType(n.X3DMaterialNode),this.addChildObjects("transparent",new t.SFBool),this.transparent_.setAccessType(n.outputOnly)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,setTransparent:function(t){t!==this.transparent_.getValue()&&(this.transparent_=t)},getTransparent:function(){return this.transparent_.getValue()}}),i}),define("x_ite/Components/Shape/Material",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shape/X3DMaterialNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.Material),this.diffuseColor=new Float32Array(3),this.specularColor=new Float32Array(3),this.emissiveColor=new Float32Array(3)}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"ambientIntensity",new t.SFFloat(.2)),new e(r.inputOutput,"diffuseColor",new t.SFColor(.8,.8,.8)),new e(r.inputOutput,"specularColor",new t.SFColor),new e(r.inputOutput,"emissiveColor",new t.SFColor),new e(r.inputOutput,"shininess",new t.SFFloat(.2)),new e(r.inputOutput,"transparency",new t.SFFloat)]),getTypeName:function(){return"Material"},getComponentName:function(){return"Shape"},getContainerField:function(){return"material"},initialize:function(){i.prototype.initialize.call(this),this.ambientIntensity_.addInterest("set_ambientIntensity__",this),this.diffuseColor_.addInterest("set_diffuseColor__",this),this.specularColor_.addInterest("set_specularColor__",this),this.emissiveColor_.addInterest("set_emissiveColor__",this),this.shininess_.addInterest("set_shininess__",this),this.transparency_.addInterest("set_transparency__",this),this.set_ambientIntensity__(),this.set_diffuseColor__(),this.set_specularColor__(),this.set_emissiveColor__(),this.set_shininess__(),this.set_transparency__()},set_ambientIntensity__:function(){this.ambientIntensity=Math.max(this.ambientIntensity_.getValue(),0)},set_diffuseColor__:function(){var t=this.diffuseColor,e=this.diffuseColor_.getValue();t[0]=e.r,t[1]=e.g,t[2]=e.b},set_specularColor__:function(){var t=this.specularColor,e=this.specularColor_.getValue();t[0]=e.r,t[1]=e.g,t[2]=e.b},set_emissiveColor__:function(){var t=this.emissiveColor,e=this.emissiveColor_.getValue();t[0]=e.r,t[1]=e.g,t[2]=e.b},set_shininess__:function(){this.shininess=o.clamp(this.shininess_.getValue(),0,1)},set_transparency__:function(){var t=o.clamp(this.transparency_.getValue(),0,1);this.transparency=t,this.setTransparent(Boolean(t))},setShaderUniforms:function(t,e){t.uniform1i(e.x3d_SeparateBackColor,!1),t.uniform1f(e.x3d_AmbientIntensity,this.ambientIntensity),t.uniform3fv(e.x3d_DiffuseColor,this.diffuseColor),t.uniform3fv(e.x3d_SpecularColor,this.specularColor),t.uniform3fv(e.x3d_EmissiveColor,this.emissiveColor),t.uniform1f(e.x3d_Shininess,this.shininess),t.uniform1f(e.x3d_Transparency,this.transparency)}}),s}),define("x_ite/Components/Shape/X3DShapeNode",["x_ite/Components/Core/X3DChildNode","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants","standard/Math/Geometry/Box3","standard/Math/Numbers/Vector3"],function(t,e,n,i,r,o){"use strict";function s(n){t.call(this,n),e.call(this,n),this.addType(i.X3DShapeNode),this.bbox=new r,this.bboxSize=new o(0,0,0),this.bboxCenter=new o(0,0,0)}return s.prototype=Object.assign(Object.create(t.prototype),e.prototype,{constructor:s,initialize:function(){t.prototype.initialize.call(this),e.prototype.initialize.call(this),this.bboxSize_.addInterest("set_bbox__",this),this.bboxCenter_.addInterest("set_bbox__",this),this.appearance_.addInterest("set_apparance__",this),this.geometry_.addInterest("set_geometry__",this),this.set_apparance__(),this.set_geometry__()},getBBox:function(t){return t.assign(this.bbox)},getBBoxSize:function(){return this.bboxSize},getBBoxCenter:function(){return this.bboxCenter},getAppearance:function(){return this.apparanceNode},getGeometry:function(){return this.geometryNode},setTransparent:function(t){this.transparent=t},getTransparent:function(){return this.transparent},set_bbox__:function(){this.bboxSize_.getValue().equals(this.getDefaultBBoxSize())?this.getGeometry()?this.bbox.assign(this.getGeometry().getBBox()):this.bbox.set():this.bbox.set(this.bboxSize_.getValue(),this.bboxCenter_.getValue()),this.bboxSize.assign(this.bbox.size),this.bboxCenter.assign(this.bbox.center)},set_apparance__:function(){this.apparanceNode&&this.apparanceNode.transparent_.removeInterest("set_transparent__",this),this.apparanceNode=n(i.X3DAppearanceNode,this.appearance_),this.apparanceNode?this.apparanceNode.transparent_.addInterest("set_transparent__",this):this.apparanceNode=this.getBrowser().getDefaultAppearance(),this.set_transparent__()},set_geometry__:function(){this.geometryNode&&(this.geometryNode.transparent_.addInterest("set_transparent__",this),this.geometryNode.bbox_changed_.addInterest("set_bbox__",this)),this.geometryNode=n(i.X3DGeometryNode,this.geometry_),this.geometryNode&&(this.geometryNode.transparent_.addInterest("set_transparent__",this),this.geometryNode.bbox_changed_.addInterest("set_bbox__",this)),this.set_transparent__(),this.set_bbox__()},set_transparent__:function(){this.transparent=this.apparanceNode&&this.apparanceNode.getTransparent()||this.geometryNode&&this.geometryNode.getTransparent()}}),s}),define("standard/Math/Algorithms/QuickSort",[],function(){"use strict";function t(t,e){this.array=t,e&&(this.compare=e)}return t.prototype={compare:function(t,e){return t<e},sort:function(t,e){e-t>1&&this.quicksort(t,e-1)},quicksort:function(t,e){for(var n=t,i=e,r=this.array,o=this.compare,s=r[t+e>>>1];;){for(;o(r[n],s);)++n;for(;o(s,r[i]);)--i;if(!(n<i)){n===i&&(++n,--i);break}var a=r[n];r[n]=r[i],r[i]=a,n++,i--}t<i&&this.quicksort(t,i),n<e&&this.quicksort(n,e)}},t}),define("x_ite/Components/Shape/Shape",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shape/X3DShapeNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Algorithm","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Box3","standard/Math/Geometry/Line3","standard/Math/Algorithms/QuickSort"],function(t,e,n,i,r,o,s,a,u,l,c,h){"use strict";function d(t){i.call(this,t),this.addType(o.Shape)}return d.prototype=Object.assign(Object.create(i.prototype),{constructor:d,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new e(o.initializeOnly,"bboxCenter",new t.SFVec3f),new e(o.inputOutput,"appearance",new t.SFNode),new e(o.inputOutput,"geometry",new t.SFNode)]),getTypeName:function(){return"Shape"},getComponentName:function(){return"Shape"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.transformSensors_changed_.addInterest("set_transformSensors__",this),this.set_transformSensors__()},set_geometry__:function(){i.prototype.set_geometry__.call(this),this.getGeometry()?delete this.traverse:this.traverse=Function.prototype},set_transformSensors__:function(){this.setPickableObject(this.getTransformSensors().size)},intersectsBox:function(t,e,n){return this.getGeometry().intersectsBox(t,e,n)},traverse:function(t,e){switch(t){case r.POINTER:this.pointer(e);break;case r.PICKING:this.picking(e);break;case r.COLLISION:e.addCollisionShape(this);break;case r.DEPTH:e.addDepthShape(this);break;case r.DISPLAY:e.addDisplayShape(this)&&this.getAppearance().traverse(t,e)}this.getGeometry().traverse(t,e)},pointer:function(){var t=new u,e=new u,n=new c(new a(0,0,0),new a(0,0,0)),i=[],r=new h(i,function(t,e){return t.point.z>e.point.z});return function(o){try{var a=this.getGeometry();if(a.getGeometryType()<2)return;var u=o.getBrowser();if(t.assign(o.getModelViewMatrix().get()),e.assign(t).inverse(),n.assign(u.getHitRay()).multLineMatrix(e),a.intersectsLine(n,o.getShaderObjects(),t,i)){for(var l=0;l<i.length;++l)t.multVecMatrix(i[l].point);r.sort(0,i.length);var c=s.lowerBound(i,0,i.length,-o.getNavigationInfo().getNearValue(),function(t,e){return t.point.z>e});c!==i.length&&(e.multMatrixDir(i[c].normal).normalize(),u.addHit(i[c],o.getLayer(),this,t.multRight(o.getCameraSpaceMatrix().get()))),i.length=0}}catch(t){console.log(t)}}}(),picking:function(){var t=new l;return function(e){this.getTransformSensors().size&&(this.getBBox(t).multRight(e.getModelViewMatrix().get()),this.getTransformSensors().forEach(function(e){e.collect(t)}));var n=e.getBrowser(),i=n.getPickSensors(),r=n.getPickingHierarchy();r.push(this),i[i.length-1].forEach(function(t){t.collect(this.getGeometry(),e.getModelViewMatrix().get(),n.getPickingHierarchy())},this),r.pop()}}(),depth:function(t,e,n){this.getGeometry().depth(t,e,n)},display:function(t,e){this.getAppearance().enable(t,e),this.getGeometry().display(t,e),this.getAppearance().disable(t,e)}}),d}),define("x_ite/Components/Shape/TwoSidedMaterial",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Shape/X3DMaterialNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.TwoSidedMaterial),this.diffuseColor=new Float32Array(3),this.specularColor=new Float32Array(3),this.emissiveColor=new Float32Array(3),this.backDiffuseColor=new Float32Array(3),this.backSpecularColor=new Float32Array(3),this.backEmissiveColor=new Float32Array(3)}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"separateBackColor",new t.SFBool),new e(r.inputOutput,"ambientIntensity",new t.SFFloat(.2)),new e(r.inputOutput,"diffuseColor",new t.SFColor(.8,.8,.8)),new e(r.inputOutput,"specularColor",new t.SFColor),new e(r.inputOutput,"emissiveColor",new t.SFColor),new e(r.inputOutput,"shininess",new t.SFFloat(.2)),new e(r.inputOutput,"transparency",new t.SFFloat),new e(r.inputOutput,"backAmbientIntensity",new t.SFFloat(.2)),new e(r.inputOutput,"backDiffuseColor",new t.SFColor(.8,.8,.8)),new e(r.inputOutput,"backSpecularColor",new t.SFColor),new e(r.inputOutput,"backEmissiveColor",new t.SFColor),new e(r.inputOutput,"backShininess",new t.SFFloat(.2)),new e(r.inputOutput,"backTransparency",new t.SFFloat)]),getTypeName:function(){return"TwoSidedMaterial"},getComponentName:function(){return"Shape"},getContainerField:function(){return"material"},initialize:function(){i.prototype.initialize.call(this),this.separateBackColor_.addInterest("set_transparent__",this),this.ambientIntensity_.addInterest("set_ambientIntensity__",this),this.diffuseColor_.addInterest("set_diffuseColor__",this),this.specularColor_.addInterest("set_specularColor__",this),this.emissiveColor_.addInterest("set_emissiveColor__",this),this.shininess_.addInterest("set_shininess__",this),this.transparency_.addInterest("set_transparency__",this),this.backAmbientIntensity_.addInterest("set_backAmbientIntensity__",this),this.backDiffuseColor_.addInterest("set_backDiffuseColor__",this),this.backSpecularColor_.addInterest("set_backSpecularColor__",this),this.backEmissiveColor_.addInterest("set_backEmissiveColor__",this),this.backShininess_.addInterest("set_backShininess__",this),this.backTransparency_.addInterest("set_backTransparency__",this),this.set_ambientIntensity__(),this.set_diffuseColor__(),this.set_specularColor__(),this.set_emissiveColor__(),this.set_shininess__(),this.set_transparency__(),this.set_backAmbientIntensity__(),this.set_backDiffuseColor__(),this.set_backSpecularColor__(),this.set_backEmissiveColor__(),this.set_backShininess__(),this.set_backTransparency__()},set_ambientIntensity__:function(){this.ambientIntensity=Math.max(this.ambientIntensity_.getValue(),0)},set_diffuseColor__:function(){var t=this.diffuseColor,e=this.diffuseColor_.getValue();t[0]=e.r,t[1]=e.g,t[2]=e.b},set_specularColor__:function(){var t=this.specularColor,e=this.specularColor_.getValue();t[0]=e.r,t[1]=e.g,t[2]=e.b},set_emissiveColor__:function(){var t=this.emissiveColor,e=this.emissiveColor_.getValue();t[0]=e.r,t[1]=e.g,t[2]=e.b},set_shininess__:function(){this.shininess=o.clamp(this.shininess_.getValue(),0,1)},set_transparency__:function(){this.transparency=o.clamp(this.transparency_.getValue(),0,1),this.set_transparent__()},set_backAmbientIntensity__:function(){this.backAmbientIntensity=Math.max(this.backAmbientIntensity_.getValue(),0)},set_backDiffuseColor__:function(){var t=this.backDiffuseColor,e=this.backDiffuseColor_.getValue();t[0]=e.r,t[1]=e.g,t[2]=e.b},set_backSpecularColor__:function(){var t=this.backSpecularColor,e=this.backSpecularColor_.getValue();t[0]=e.r,t[1]=e.g,t[2]=e.b},set_backEmissiveColor__:function(){var t=this.backEmissiveColor,e=this.backEmissiveColor_.getValue();t[0]=e.r,t[1]=e.g,t[2]=e.b},set_backShininess__:function(){this.backShininess=o.clamp(this.backShininess_.getValue(),0,1)},set_backTransparency__:function(){this.backTransparency=o.clamp(this.backTransparency_.getValue(),0,1),this.set_transparent__()},set_transparent__:function(){this.setTransparent(Boolean(this.transparency_.getValue()||this.separateBackColor_.getValue()&&this.backTransparency_.getValue()))},setShaderUniforms:function(t,e){t.uniform1f(e.x3d_AmbientIntensity,this.ambientIntensity),t.uniform3fv(e.x3d_DiffuseColor,this.diffuseColor),t.uniform3fv(e.x3d_SpecularColor,this.specularColor),t.uniform3fv(e.x3d_EmissiveColor,this.emissiveColor),t.uniform1f(e.x3d_Shininess,this.shininess),t.uniform1f(e.x3d_Transparency,this.transparency),this.separateBackColor_.getValue()?(t.uniform1i(e.x3d_SeparateBackColor,!0),t.uniform1f(e.x3d_BackAmbientIntensity,this.backAmbientIntensity),t.uniform3fv(e.x3d_BackDiffuseColor,this.backDiffuseColor),t.uniform3fv(e.x3d_BackSpecularColor,this.backSpecularColor),t.uniform3fv(e.x3d_BackEmissiveColor,this.backEmissiveColor),t.uniform1f(e.x3d_BackShininess,this.backShininess),t.uniform1f(e.x3d_BackTransparency,this.backTransparency)):t.uniform1i(e.x3d_SeparateBackColor,!1)}}),s}),define("x_ite/Components/Shape",["x_ite/Configuration/SupportedNodes","x_ite/Components/Shape/Appearance","x_ite/Components/Shape/FillProperties","x_ite/Components/Shape/LineProperties","x_ite/Components/Shape/Material","x_ite/Components/Shape/Shape","x_ite/Components/Shape/TwoSidedMaterial","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Components/Shape/X3DAppearanceNode","x_ite/Components/Shape/X3DMaterialNode","x_ite/Components/Shape/X3DShapeNode"],function(t,e,n,i,r,o,s,a,u,l,c){"use strict";var h={Appearance:e,FillProperties:n,LineProperties:i,Material:r,Shape:o,TwoSidedMaterial:s},d={X3DAppearanceChildNode:a,X3DAppearanceNode:u,X3DMaterialNode:l,X3DShapeNode:c};for(var p in h)t.addType(p,h[p]);for(var p in d)t.addAbstractType(p,d[p])}),define("x_ite/Components/Sound/X3DSoundSourceNode",["x_ite/Components/Core/X3DChildNode","x_ite/Components/Time/X3DTimeDependentNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm"],function(t,e,n,i){"use strict";function r(i){t.call(this,i),e.call(this,i),this.addType(n.X3DSoundSourceNode),this.volume=0,this.media=null}return r.prototype=Object.assign(Object.create(t.prototype),e.prototype,{constructor:r,initialize:function(){t.prototype.initialize.call(this),e.prototype.initialize.call(this)},set_browser_live__:function(){e.prototype.set_browser_live__.call(this),this.getDisabled()?(this.getBrowser().volume_.removeInterest("set_volume__",this),this.getBrowser().mute_.removeInterest("set_volume__",this)):(this.getBrowser().volume_.addInterest("set_volume__",this),this.getBrowser().mute_.addInterest("set_volume__",this),this.set_volume__())},setMedia:function(t){if(this.media&&(this.media[0].volume=0,this.media[0].pause(),this.media.unbind("ended")),this.media=t,t){var e=t[0];this.setVolume(0),this.duration_changed_=e.duration,this.isActive_.getValue()?this.isPaused_.getValue()?this.set_pause():this.set_start():this.set_stop()}},getMedia:function(){return this.media},setVolume:function(t){this.volume=i.clamp(t,0,1),this.set_volume__()},set_volume__:function(){if(this.media){var t=this.getBrowser().mute_.getValue(),e=i.clamp(this.getBrowser().volume_.getValue(),0,1),n=!t*e*this.volume;this.media[0].volume=n}},set_speed:function(){},set_pitch:function(){},set_start:function(){this.media&&this.speed_.getValue()&&(this.media[0].currentTime=0,this.media[0].play())},set_pause:function(){this.media&&(this.media.unbind("ended"),this.media[0].pause())},set_resume:function(){this.media&&this.speed_.getValue()&&this.media[0].play()},set_stop:function(){this.media&&(this.media.unbind("ended"),this.media[0].pause())},set_ended:function(){if(this.media){var t=this.media[0];if(t.currentTime<t.duration)return;this.loop_.getValue()?(this.speed_.getValue()&&t.play(),this.elapsedTime_=this.getElapsedTime(),this.cycleTime_=this.getBrowser().getCurrentTime()):this.stop()}},set_time:function(){this.set_ended(),this.elapsedTime_=this.getElapsedTime()}}),r}),define("x_ite/Components/Sound/AudioClip",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Sound/X3DSoundSourceNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Bits/X3DConstants","x_ite/Browser/Networking/urls","standard/Networking/URI","x_ite/DEBUG"],function(t,e,n,i,r,o,s,a,u,l){"use strict";function c(n){r.call(this,n),o.call(this,n),this.addType(s.AudioClip),this.addChildObjects("buffer",new e.SFTime),this.audio=t("<audio></audio>"),this.urlStack=new e.MFString}return c.prototype=Object.assign(Object.create(r.prototype),o.prototype,{constructor:c,
fieldDefinitions:new i([new n(s.inputOutput,"metadata",new e.SFNode),new n(s.inputOutput,"enabled",new e.SFBool(!0)),new n(s.inputOutput,"description",new e.SFString),new n(s.inputOutput,"url",new e.MFString),new n(s.inputOutput,"speed",new e.SFFloat(1)),new n(s.inputOutput,"pitch",new e.SFFloat(1)),new n(s.inputOutput,"loop",new e.SFBool),new n(s.inputOutput,"startTime",new e.SFTime),new n(s.inputOutput,"resumeTime",new e.SFTime),new n(s.inputOutput,"pauseTime",new e.SFTime),new n(s.inputOutput,"stopTime",new e.SFTime),new n(s.outputOnly,"isPaused",new e.SFBool),new n(s.outputOnly,"isActive",new e.SFBool),new n(s.outputOnly,"cycleTime",new e.SFTime),new n(s.outputOnly,"elapsedTime",new e.SFTime),new n(s.outputOnly,"duration_changed",new e.SFTime(-1))]),getTypeName:function(){return"AudioClip"},getComponentName:function(){return"Sound"},getContainerField:function(){return"source"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this),this.url_.addInterest("set_url__",this),this.buffer_.addInterest("set_buffer__",this),this.audio.on("error",this.setError.bind(this)),this.audio[0].preload="auto",this.audio[0].volume=0,this.audio[0].crossOrigin="Anonymous",this.set_url__()},getElement:function(){return this.audio[0]},set_url__:function(){this.setLoadState(s.NOT_STARTED_STATE),this.requestAsyncLoad()},requestAsyncLoad:function(){this.checkLoadState()!==s.COMPLETE_STATE&&this.checkLoadState()!==s.IN_PROGRESS_STATE&&(this.setLoadState(s.IN_PROGRESS_STATE),this.buffer_.addEvent())},set_buffer__:function(){this.setMedia(null),this.urlStack.setValue(this.url_),this.audio.bind("canplaythrough",this.setAudio.bind(this)),this.loadNext()},loadNext:function(){if(0===this.urlStack.length)return this.audio.unbind("canplaythrough"),this.duration_changed_=-1,this.setLoadState(s.FAILED_STATE),void this.stop();this.URL=new u(this.urlStack.shift()),this.URL=this.getExecutionContext().getURL().transform(this.URL),this.audio.attr("src",this.URL)},setError:function(){var t=this.URL.toString();l&&(this.URL.isLocal()||"localhost"===this.URL.host||t.match(a.getFallbackExpression())||this.urlStack.unshift(a.getFallbackUrl(t))),"data"!==this.URL.scheme&&console.warn("Error loading audio:",this.URL.toString()),this.loadNext()},setAudio:function(){l&&"data"!==this.URL.scheme&&console.info("Done loading audio:",this.URL.toString()),this.audio.unbind("canplaythrough"),this.setMedia(this.audio),this.setLoadState(s.COMPLETE_STATE)}}),c}),define("x_ite/Components/Sound/X3DSoundNode",["x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(t,e){"use strict";function n(n){t.call(this,n),this.addType(e.X3DSoundNode)}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n}),n}),define("x_ite/Components/Sound/Sound",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Sound/X3DSoundNode","x_ite/Bits/X3DCast","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Line3","standard/Math/Geometry/Sphere3","standard/Math/Algorithm"],function(t,e,n,i,r,o,s,a,u,l,c,h,d){"use strict";function p(e){i.call(this,e),this.addType(s.Sound),this.addChildObjects("traversed",new t.SFBool(!0)),this.location_.setUnit("length"),this.minBack_.setUnit("length"),this.minFront_.setUnit("length"),this.maxBack_.setUnit("length"),this.maxFront_.setUnit("length"),this.currentTraversed=!0}return p.prototype=Object.assign(Object.create(i.prototype),{constructor:p,fieldDefinitions:new n([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"intensity",new t.SFFloat(1)),new e(s.initializeOnly,"spatialize",new t.SFBool(!0)),new e(s.inputOutput,"location",new t.SFVec3f),new e(s.inputOutput,"direction",new t.SFVec3f(0,0,1)),new e(s.inputOutput,"minBack",new t.SFFloat(1)),new e(s.inputOutput,"minFront",new t.SFFloat(1)),new e(s.inputOutput,"maxBack",new t.SFFloat(10)),new e(s.inputOutput,"maxFront",new t.SFFloat(10)),new e(s.inputOutput,"priority",new t.SFFloat),new e(s.inputOutput,"source",new t.SFNode)]),getTypeName:function(){return"Sound"},getComponentName:function(){return"Sound"},getContainerField:function(){return"children"},initialize:function(){i.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this),this.traversed_.addInterest("set_live__",this),this.source_.addInterest("set_source__",this),this.set_live__(),this.set_source__()},setTraversed:function(t){t?this.traversed_.getValue()===!1&&(this.traversed_=!0):this.currentTraversed!==this.traversed_.getValue()&&(this.traversed_=this.currentTraversed),this.currentTraversed=t},getTraversed:function(){return this.currentTraversed},set_live__:function(){this.isLive().getValue()&&this.traversed_.getValue()?this.getBrowser().sensorEvents().addInterest("update",this):this.getBrowser().sensorEvents().removeInterest("update",this)},set_source__:function(){this.sourceNode&&this.sourceNode.setVolume(0),this.sourceNode=r(s.X3DSoundSourceNode,this.source_)},update:function(){this.getTraversed()||this.sourceNode&&this.sourceNode.setVolume(0),this.setTraversed(!1)},traverse:function(){var t={distance:0,intersection:new a(0,0,0)},e={distance:0,intersection:new a(0,0,0)};return function(n,i){try{if(n!==o.DISPLAY)return;if(!this.sourceNode)return;if(!this.sourceNode.isActive_.getValue()||this.sourceNode.isPaused_.getValue())return;this.setTraversed(!0);var r=i.getModelViewMatrix().get();if(this.getEllipsoidParameter(r,Math.max(this.maxBack_.getValue(),0),Math.max(this.maxFront_.getValue(),0),e),e.distance<1)if(this.getEllipsoidParameter(r,Math.max(this.minBack_.getValue(),0),Math.max(this.minFront_.getValue(),0),t),t.distance<1)this.sourceNode.setVolume(this.intensity_.getValue());else{var s=e.intersection.abs(),a=e.intersection.distance(t.intersection),u=Math.min(s/a,1),l=d.clamp(this.intensity_.getValue(),0,1),c=l*u;this.sourceNode.setVolume(c)}else this.sourceNode.setVolume(0)}catch(t){this.sourceNode&&this.sourceNode.setVolume(0)}}}(),getEllipsoidParameter:function(){var t=new a(0,0,0),e=new l,n=new l,i=new u,r=new a(1,1,1),o=new h(1,a.Zero),s=new c(a.Zero,a.zAxis),d=new a(0,0,0),p=new a(0,0,0);return function(u,l,c,h){var f=(l+c)/2,g=f-l,m=Math.sqrt(f*f-g*g);t.set(0,0,g),r.set(m,m,f),i.setFromToVec(a.zAxis,this.direction_.getValue()),e.assign(u),e.translate(this.location_.getValue()),e.rotate(i),e.translate(t),e.scale(r),n.assign(e),n.inverse();var x=n.origin;t.negate().divVec(r),s.set(x,t.subtract(x).normalize()),o.intersectsLine(s,d,p),x.distance(d)<x.distance(p)?h.intersection.assign(e.multVecMatrix(d)):h.intersection.assign(e.multVecMatrix(p)),h.distance=x.abs()}}()}),p}),define("x_ite/Components/Sound",["x_ite/Configuration/SupportedNodes","x_ite/Components/Sound/AudioClip","x_ite/Components/Sound/Sound","x_ite/Components/Sound/X3DSoundNode","x_ite/Components/Sound/X3DSoundSourceNode"],function(t,e,n,i,r){"use strict";var o={AudioClip:e,Sound:n},s={X3DSoundNode:i,X3DSoundSourceNode:r};for(var a in o)t.addType(a,o[a]);for(var a in s)t.addAbstractType(a,s[a])}),define("x_ite/Components/Text/Text",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(o.Text),this.length_.setUnit("length"),this.maxExtent_.setUnit("length"),this.origin_.setUnit("length"),this.textBounds_.setUnit("length"),this.lineBounds_.setUnit("length")}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOutput,"string",new t.MFString),new e(o.inputOutput,"length",new t.MFFloat),new e(o.inputOutput,"maxExtent",new t.SFFloat),new e(o.initializeOnly,"solid",new t.SFBool),new e(o.outputOnly,"origin",new t.SFVec3f),new e(o.outputOnly,"textBounds",new t.SFVec2f),new e(o.outputOnly,"lineBounds",new t.MFVec2f),new e(o.inputOutput,"fontStyle",new t.SFNode)]),getTypeName:function(){return"Text"},getComponentName:function(){return"Text"},getContainerField:function(){return"geometry"},initialize:function(){i.prototype.initialize.call(this),this.fontStyle_.addInterest("set_fontStyle__",this),this.set_fontStyle__()},getMatrix:function(){return this.textGeometry.getMatrix()},getLength:function(t){return t<this.length_.length?Math.max(0,this.length_[t]):0},set_live__:function(){i.prototype.set_live__.call(this),this.isLive().getValue()?this.getBrowser().getBrowserOptions().PrimitiveQuality_.addInterest("requestRebuild",this):this.getBrowser().getBrowserOptions().PrimitiveQuality_.removeInterest("requestRebuild",this)},set_fontStyle__:function(){this.fontStyleNode&&this.fontStyleNode.removeInterest("requestRebuild",this),this.fontStyleNode=r(o.X3DFontStyleNode,this.fontStyle_),this.fontStyleNode||(this.fontStyleNode=this.getBrowser().getDefaultFontStyle()),this.fontStyleNode.addInterest("requestRebuild",this),this.textGeometry=this.fontStyleNode.getTextGeometry(this),this.setTransparent(this.textGeometry.getTransparent())},build:function(){this.textGeometry.update(),this.textGeometry.build(),this.setSolid(this.solid_.getValue())},traverse:function(t,e){try{this.textGeometry.traverse(t,e),i.prototype.traverse.call(this,t,e)}catch(t){console.log(t)}},display:function(t,e){try{this.textGeometry.display(t,e),i.prototype.display.call(this,t,e)}catch(t){console.log(t)}},transformLine:function(t){return this.textGeometry.transformLine(t)},transformMatrix:function(t){return this.textGeometry.transformMatrix(t)}}),s}),define("x_ite/Components/Text",["x_ite/Configuration/SupportedNodes","x_ite/Components/Text/FontStyle","x_ite/Components/Text/Text","x_ite/Components/Text/X3DFontStyleNode"],function(t,e,n,i){"use strict";var r={FontStyle:e,Text:n},o={X3DFontStyleNode:i};for(var s in r)t.addType(s,r[s]);for(var s in o)t.addAbstractType(s,o[s])}),define("x_ite/Components/Texturing/MovieTexture",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Texturing/X3DTexture2DNode","x_ite/Components/Sound/X3DSoundSourceNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Bits/X3DConstants","x_ite/Browser/Networking/urls","standard/Networking/URI","standard/Math/Algorithm","x_ite/DEBUG"],function(t,e,n,i,r,o,s,a,u,l,c,h){"use strict";function d(n){r.call(this,n),o.call(this,n),s.call(this,n),this.addType(a.MovieTexture),this.addChildObjects("buffer",new e.SFTime),this.canvas=t("<canvas></canvas>"),this.video=t("<video></video>"),this.urlStack=new e.MFString}return d.prototype=Object.assign(Object.create(r.prototype),o.prototype,s.prototype,{constructor:d,fieldDefinitions:new i([new n(a.inputOutput,"metadata",new e.SFNode),new n(a.inputOutput,"enabled",new e.SFBool(!0)),new n(a.inputOutput,"description",new e.SFString),new n(a.inputOutput,"url",new e.MFString),new n(a.inputOutput,"speed",new e.SFFloat(1)),new n(a.inputOutput,"pitch",new e.SFFloat(1)),new n(a.inputOutput,"loop",new e.SFBool),new n(a.inputOutput,"startTime",new e.SFTime),new n(a.inputOutput,"resumeTime",new e.SFTime),new n(a.inputOutput,"pauseTime",new e.SFTime),new n(a.inputOutput,"stopTime",new e.SFTime),new n(a.outputOnly,"isPaused",new e.SFBool),new n(a.outputOnly,"isActive",new e.SFBool),new n(a.outputOnly,"cycleTime",new e.SFTime),new n(a.outputOnly,"elapsedTime",new e.SFTime),new n(a.outputOnly,"duration_changed",new e.SFTime(-1)),new n(a.initializeOnly,"repeatS",new e.SFBool(!0)),new n(a.initializeOnly,"repeatT",new e.SFBool(!0)),new n(a.initializeOnly,"textureProperties",new e.SFNode)]),getTypeName:function(){return"MovieTexture"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texture"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this),s.prototype.initialize.call(this),this.url_.addInterest("set_url__",this),this.buffer_.addInterest("set_buffer__",this),this.video.on("error",this.setError.bind(this)),this.video[0].preload="auto",this.video[0].volume=0,this.video[0].crossOrigin="Anonymous",this.set_url__()},getElement:function(){return this.video[0]},set_url__:function(){this.setLoadState(a.NOT_STARTED_STATE),this.requestAsyncLoad()},requestAsyncLoad:function(){this.checkLoadState()!==a.COMPLETE_STATE&&this.checkLoadState()!==a.IN_PROGRESS_STATE&&(this.setLoadState(a.IN_PROGRESS_STATE),this.buffer_.addEvent())},set_buffer__:function(){this.setMedia(null),this.urlStack.setValue(this.url_),this.video.bind("canplaythrough",this.setVideo.bind(this)),this.loadNext()},loadNext:function(){if(0===this.urlStack.length)return this.video.unbind("canplaythrough"),this.duration_changed_=-1,this.clearTexture(),this.setLoadState(a.FAILED_STATE),void this.stop();this.URL=new l(this.urlStack.shift()),this.URL=this.getExecutionContext().getURL().transform(this.URL),this.video.attr("src",this.URL)},setError:function(){var t=this.URL.toString();h&&(this.URL.isLocal()||"localhost"===this.URL.host||t.match(u.getFallbackExpression())||this.urlStack.unshift(u.getFallbackUrl(t))),"data"!==this.URL.scheme&&console.warn("Error loading movie:",this.URL.toString()),this.loadNext()},setVideo:function(){h&&"data"!==this.URL.scheme&&console.info("Done loading movie:",this.URL.toString());try{this.video.unbind("canplaythrough");var t=this.video[0],e=t.videoWidth,n=t.videoHeight,i=this.canvas[0],r=i.getContext("2d");if(!c.isPowerOfTwo(e)||!c.isPowerOfTwo(n))throw new Error("The movie texture is a non power-of-two texture.");i.width=e,i.height=n,r.drawImage(t,0,0);var o=r.getImageData(0,0,e,n).data;setTimeout(function(){this.setMedia(this.video),this.setTexture(e,n,!1,new Uint8Array(o),!0),this.setLoadState(a.COMPLETE_STATE)}.bind(this),16)}catch(t){console.log(t.message),this.setError()}},set_time:function(){o.prototype.set_time.call(this),this.checkLoadState()===a.COMPLETE_STATE&&this.updateTexture(this.getMedia()[0],!0)},traverse:r.prototype.traverse}),d}),define("x_ite/Components/Texturing/MultiTexture",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Texturing/X3DTextureNode","x_ite/Bits/X3DConstants","x_ite/Bits/X3DCast","x_ite/Browser/Texturing/MultiTextureModeType","x_ite/Browser/Texturing/MultiTextureSourceType","x_ite/Browser/Texturing/MultiTextureFunctionType"],function(t,e,n,i,r,o,s,a,u){"use strict";function l(e){i.call(this,e),this.addType(r.MultiTexture),this.addChildObjects("loadState",new t.SFInt32(r.NOT_STARTED_STATE)),this.color=new Float32Array(4),this.modes=[],this.alphaModes=[],this.sources=[],this.functions=[],this.textureNodes=[],this.setTransparent(!1)}return l.prototype=Object.assign(Object.create(i.prototype),{constructor:l,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"color",new t.SFColor(1,1,1)),new e(r.inputOutput,"alpha",new t.SFFloat(1)),new e(r.inputOutput,"mode",new t.MFString),new e(r.inputOutput,"source",new t.MFString),new e(r.inputOutput,"function",new t.MFString),new e(r.inputOutput,"texture",new t.MFNode)]),getTypeName:function(){return"MultiTexture"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texture"},initialize:function(){i.prototype.initialize.call(this),this.color_.addInterest("set_color__",this),this.alpha_.addInterest("set_alpha__",this),this.mode_.addInterest("set_mode__",this),this.source_.addInterest("set_source__",this),this.function_.addInterest("set_function__",this),this.texture_.addInterest("set_texture__",this),this.set_color__(),this.set_alpha__(),this.set_mode__(),this.set_source__(),this.set_function__(),this.set_texture__(),this.loadState_=r.COMPLETE_STATE},getMode:function(t){return t<this.modes.length?this.modes[t]:s.MODULATE},getAlphaMode:function(t){return t<this.alphaModes.length?this.alphaModes[t]:s.MODULATE},getSource:function(t){return t<this.sources.length?this.sources[t]:a.DEFAULT},getFunction:function(t){return t<this.functions.length?this.functions[t]:u.DEFAULT},set_color__:function(){this.color[0]=this.color_.r,this.color[1]=this.color_.g,this.color[2]=this.color_.b},set_alpha__:function(){this.color[3]=this.alpha_},set_mode__:function(){var t=new Map([["REPLACE",s.REPLACE],["MODULATE",s.MODULATE],["MODULATE2X",s.MODULATE2X],["MODULATE4X",s.MODULATE4X],["ADD",s.ADD],["ADDSIGNED",s.ADDSIGNED],["ADDSIGNED2X",s.ADDSIGNED2X],["ADDSMOOTH",s.ADDSMOOTH],["SUBTRACT",s.SUBTRACT],["BLENDDIFFUSEALPHA",s.BLENDDIFFUSEALPHA],["BLENDTEXTUREALPHA",s.BLENDTEXTUREALPHA],["BLENDFACTORALPHA",s.BLENDFACTORALPHA],["BLENDCURRENTALPHA",s.BLENDCURRENTALPHA],["MODULATEALPHA_ADDCOLOR",s.MODULATEALPHA_ADDCOLOR],["MODULATEINVALPHA_ADDCOLOR",s.MODULATEINVALPHA_ADDCOLOR],["MODULATEINVCOLOR_ADDALPHA",s.MODULATEINVCOLOR_ADDALPHA],["DOTPRODUCT3",s.DOTPRODUCT3],["SELECTARG1",s.SELECTARG1],["SELECTARG2",s.SELECTARG2],["OFF",s.OFF]]);return function(){this.modes.length=0,this.alphaModes.length=0;for(var e=0,n=this.mode_.length;e<n;++e){for(var i=this.mode_[e].split(","),r=0,o=i.length;r<o;++r)i[r]=i[r].trim();0===i.length&&i.push("MODULATE"),i.length<2&&i.push(i[0]);var a=t.get(i[0]);void 0!==a?this.modes.push(a):this.modes.push(s.MODULATE);var a=t.get(i[1]);void 0!==a?this.alphaModes.push(a):this.alphaModes.push(s.MODULATE)}}}(),set_source__:function(){var t=new Map([["DIFFUSE",a.DIFFUSE],["SPECULAR",a.SPECULAR],["FACTOR",a.FACTOR]]);return function(){this.sources.length=0;for(var e=0,n=this.source_.length;e<n;++e){var i=t.get(this.source_[e]);void 0!==i?this.sources.push(i):this.sources.push(a.DEFAULT)}}}(),set_function__:function(){var t=new Map([["COMPLEMENT",u.COMPLEMENT],["ALPHAREPLICATE",u.ALPHAREPLICATE]]);return function(){this.functions.length=0;for(var e=0,n=this.function_.length;e<n;++e){var i=t.get(this.function_[e]);void 0!==i?this.functions.push(i):this.functions.push(u.DEFAULT)}}}(),set_texture__:function(){this.textureNodes.length=0;for(var t=0,e=this.texture_.length;t<e;++t){var n=this.texture_[t];if(!o(r.MultiTexture,n)){var i=o(r.X3DTextureNode,n);i&&this.textureNodes.push(i)}}},traverse:function(t,e){for(var n=this.textureNodes,i=0,r=n.length;i<r;++i)n[i].traverse(t,e)},setShaderUniforms:function(t,e){var n=this.textureNodes,i=Math.min(e.getBrowser().getMaxTextures(),n.length);t.uniform1i(e.x3d_NumTextures,i),t.uniform4fv(e.x3d_MultiTextureColor,this.color);for(var r=0;r<i;++r)n[r].setShaderUniformsToChannel(t,e,r),t.uniform1i(e.x3d_MultiTextureMode[r],this.getMode(r)),t.uniform1i(e.x3d_MultiTextureAlphaMode[r],this.getAlphaMode(r)),t.uniform1i(e.x3d_MultiTextureSource[r],this.getSource(r)),t.uniform1i(e.x3d_MultiTextureFunction[r],this.getFunction(r))}}),l}),define("x_ite/Components/Texturing/MultiTextureCoordinate",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Texturing/X3DTextureCoordinateNode","x_ite/Bits/X3DConstants","x_ite/Bits/X3DCast"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.MultiTextureCoordinate),this.textureCoordinateNodes=[]}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"texCoord",new t.MFNode)]),getTypeName:function(){return"MultiTextureCoordinate"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texCoord"},initialize:function(){i.prototype.initialize.call(this),this.texCoord_.addInterest("set_texCoord__",this),this.set_texCoord__()},set_texCoord__:function(){for(var t=this.textureCoordinateNodes,e=0,n=t.length;e<n;++e)t[e].removeInterest("addNodeEvent",this);t.length=0;for(var e=0,n=this.texCoord_.length;e<n;++e){var i=this.texCoord_[e];if(!o(r.MultiTextureCoordinate,i)){var s=o(r.X3DTextureCoordinateNode,i);s&&t.push(s)}}for(var e=0,n=t.length;e<n;++e)t[e].addInterest("addNodeEvent",this)},isEmpty:function(){return!0},getSize:function(){return 0},get1Point:function(t,e){for(var n=this.textureCoordinateNodes,i=0,r=n.length;i<r;++i)return n[i].get1Point(t,e);return e.set(0,0,0,1)},init:function(t){for(var e=this.textureCoordinateNodes,n=0,i=e.length;n<i;++n)e[n].init(t)},addTexCoord:function(t,e){for(var n=this.textureCoordinateNodes,i=0,r=n.length;i<r;++i)n[i].addTexCoordToChannel(t,e[i])},addTexCoordToChannel:function(t,e){},getTexCoord:function(t){for(var e=this.textureCoordinateNodes,n=0,i=e.length;n<i;++n)return e[n].getTexCoord(t);return t},setShaderUniforms:function(t,e){for(var n=this.textureCoordinateNodes,i=Math.min(e.x3d_MaxTextures,n.length),r=0;r<i;++r)n[r].setShaderUniformsToChannel(t,e,r);if(i)for(var o=i-1,r=i,i=e.x3d_MaxTextures;r<i;++r)n[o].setShaderUniformsToChannel(t,e,r);else for(var r=0,i=e.x3d_MaxTextures;r<i;++r)this.setShaderUniformsToChannel(t,e,r)}}),s}),define("x_ite/Components/Texturing/MultiTextureTransform",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Texturing/X3DTextureTransformNode","x_ite/Bits/X3DConstants","x_ite/Bits/X3DCast"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.MultiTextureTransform),this.textureTransformNodes=[]}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"textureTransform",new t.MFNode)]),getTypeName:function(){return"MultiTextureTransform"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"textureTransform"},initialize:function(){i.prototype.initialize.call(this),this.textureTransform_.addInterest("set_textureTransform_",this),this.set_textureTransform__()},set_textureTransform__:function(){var t=this.textureTransformNodes;t.length=0;for(var e=0,n=this.textureTransform_.length;e<n;++e){var i=this.textureTransform_[e];if(!o(r.MultiTextureTransform,i)){var s=o(r.X3DTextureTransformNode,i);s&&t.push(s)}}},setShaderUniforms:function(t,e){for(var n=this.textureTransformNodes,i=Math.min(e.x3d_MaxTextures,n.length),r=0;r<i;++r)n[r].setShaderUniformsToChannel(t,e,r);if(i)for(var o=i-1,r=i,i=e.x3d_MaxTextures;r<i;++r)n[o].setShaderUniformsToChannel(t,e,r);else for(var r=0,i=e.x3d_MaxTextures;r<i;++r)this.setShaderUniformsToChannel(t,e,r)}}),s}),define("x_ite/Components/Texturing/PixelTexture",["jquery","x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Texturing/X3DTexture2DNode","x_ite/Bits/X3DConstants","standard/Math/Algorithm","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix3"],function(t,e,n,i,r,o,s){"use strict";function a(t){r.call(this,t),this.addType(o.PixelTexture),this.addChildObjects("loadState",new e.SFInt32(o.NOT_STARTED_STATE))}return a.prototype=Object.assign(Object.create(r.prototype),{constructor:a,fieldDefinitions:new i([new n(o.inputOutput,"metadata",new e.SFNode),new n(o.inputOutput,"image",new e.SFImage(0,0,0,new e.MFInt32)),new n(o.initializeOnly,"repeatS",new e.SFBool(!0)),new n(o.initializeOnly,"repeatT",new e.SFBool(!0)),new n(o.initializeOnly,"textureProperties",new e.SFNode)]),getTypeName:function(){return"PixelTexture"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texture"},initialize:function(){r.prototype.initialize.call(this),this.image_.addInterest("set_image__",this),this.canvas1=t("<canvas></canvas>"),this.canvas2=t("<canvas></canvas>"),this.set_image__()},checkLoadState:function(){return this.loadState_.getValue()},convert:function(t,e,n,i){switch(e){case 1:for(var r=0,o=0;r<i;++r,o+=4){var s=n[r];t[o]=t[o+1]=t[o+2]=255&s,t[o+3]=255}break;case 2:for(var r=0,o=0;r<i;++r,o+=4){var s=n[r];t[o]=t[o+1]=t[o+2]=s>>>8&255,t[o+3]=255&s}break;case 3:for(var r=0,o=0;r<i;++r,o+=4){var s=n[r];t[o]=s>>>16&255,t[o+1]=s>>>8&255,t[o+2]=255&s,t[o+3]=255}break;case 4:for(var r=0,o=0;r<i;++r,o+=4){var s=n[r];t[o]=s>>>24,t[o+1]=s>>>16&255,t[o+2]=s>>>8&255,t[o+3]=255&s}}},set_image__:function(){var t=this.getBrowser().getContext(),e=this.image_.width,n=this.image_.height,i=this.image_.comp,r=this.image_.array,a=!(i%2),u=null;if(e>0&&n>0&&i>0&&i<5){if(t.getVersion()>=2||s.isPowerOfTwo(e)&&s.isPowerOfTwo(n))u=new Uint8Array(e*n*4),this.convert(u,i,r.getValue(),r.length);else if(Math.max(e,n)<this.getBrowser().getMinTextureSize()&&!this.textureProperties_.getValue()){u=new Uint8Array(e*n*4),this.convert(u,i,r.getValue(),r.length);var l=e,c=n;e=4*s.nextPowerOfTwo(l),n=4*s.nextPowerOfTwo(c),u=this.resize(u,l,c,e,n)}else{var h=this.canvas1[0],d=this.canvas2[0],p=h.getContext("2d"),f=d.getContext("2d"),g=p.createImageData(e,n);h.width=e,h.height=n,this.convert(g.data,i,r,r.length),p.putImageData(g,0,0),e=s.nextPowerOfTwo(e),n=s.nextPowerOfTwo(n),d.width=e,d.height=n,f.clearRect(0,0,e,n),f.drawImage(h,0,0,h.width,h.height,0,0,e,n),u=f.getImageData(0,0,e,n).data}this.setTexture(e,n,a,new Uint8Array(u),!1),this.loadState_=o.COMPLETE_STATE}else this.clearTexture(),this.loadState_=o.FAILED_STATE}}),a}),define("x_ite/Components/Texturing/TextureCoordinateGenerator",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Texturing/X3DTextureCoordinateNode","x_ite/Bits/X3DConstants","x_ite/Browser/Texturing/TextureCoordinateGeneratorModeType"],function(t,e,n,i,r,o){"use strict";function s(t){i.call(this,t),this.addType(r.TextureCoordinateGenerator),this.mode=o.SPHERE,this.parameter=new Float32Array(6)}return s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,fieldDefinitions:new n([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"mode",new t.SFString("SPHERE")),new e(r.inputOutput,"parameter",new t.MFFloat)]),getTypeName:function(){return"TextureCoordinateGenerator"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texCoord"},getTexCoord:function(t){return t},initialize:function(){i.prototype.initialize.call(this),this.mode_.addInterest("set_mode__",this),this.parameter_.addInterest("set_parameter__",this),this.set_mode__(),this.set_parameter__()},set_mode__:function(){var t=new Map([["SPHERE",o.SPHERE],["CAMERASPACENORMAL",o.CAMERASPACENORMAL],["CAMERASPACEPOSITION",o.CAMERASPACEPOSITION],["CAMERASPACEREFLECTIONVECTOR",o.CAMERASPACEREFLECTIONVECTOR],["SPHERE-LOCAL",o.SPHERE_LOCAL],["COORD",o.COORD],["COORD-EYE",o.COORD_EYE],["NOISE",o.NOISE],["NOISE-EYE",o.NOISE_EYE],["SPHERE-REFLECT",o.SPHERE_REFLECT],["SPHERE-REFLECT-LOCAL",o.SPHERE_REFLECT_LOCAL]]);return function(){this.mode=t.get(this.mode_.getValue()),void 0===this.mode&&(this.mode=o.SPHERE)}}(),set_parameter__:function(){for(var t=0,e=Math.min(this.parameter.length,this.parameter_.length);t<e;++t)this.parameter[t]=this.parameter_[t];this.parameter.fill(0,e)},get1Point:function(t,e){return e},addTexCoordToChannel:function(t,e){e.push(0,0,0,1)},getTexCoord:function(t){return arrray},setShaderUniformsToChannel:function(t,e,n){t.uniform1i(e.x3d_TextureCoordinateGeneratorMode[n],this.mode),t.uniform1fv(e.x3d_TextureCoordinateGeneratorParameter[n],this.parameter)}}),s}),define("x_ite/Components/Texturing",["x_ite/Configuration/SupportedNodes","x_ite/Components/Texturing/ImageTexture","x_ite/Components/Texturing/MovieTexture","x_ite/Components/Texturing/MultiTexture","x_ite/Components/Texturing/MultiTextureCoordinate","x_ite/Components/Texturing/MultiTextureTransform","x_ite/Components/Texturing/PixelTexture","x_ite/Components/Texturing/TextureCoordinate","x_ite/Components/Texturing/TextureCoordinateGenerator","x_ite/Components/Texturing/TextureProperties","x_ite/Components/Texturing/TextureTransform","x_ite/Components/Texturing/X3DTexture2DNode","x_ite/Components/Texturing/X3DTextureCoordinateNode","x_ite/Components/Texturing/X3DTextureNode","x_ite/Components/Texturing/X3DTextureTransformNode"],function(t,e,n,i,r,o,s,a,u,l,c,h,d,p,f){"use strict";var g={ImageTexture:e,MovieTexture:n,MultiTexture:i,MultiTextureCoordinate:r,MultiTextureTransform:o,PixelTexture:s,TextureCoordinate:a,TextureCoordinateGenerator:u,TextureProperties:l,TextureTransform:c},m={X3DTexture2DNode:h,X3DTextureCoordinateNode:d,X3DTextureNode:p,X3DTextureTransformNode:f};for(var x in g)t.addType(x,g[x]);for(var x in m)t.addAbstractType(x,m[x])}),define("x_ite/Components/Time",["x_ite/Configuration/SupportedNodes","x_ite/Components/Time/TimeSensor","x_ite/Components/Time/X3DTimeDependentNode"],function(t,e,n){"use strict";var i={TimeSensor:e},r={X3DTimeDependentNode:n};for(var o in i)t.addType(o,i[o]);for(var o in r)t.addAbstractType(o,r[o])}),define("x_ite/Components",["x_ite/DEBUG","x_ite/Browser/X3DBrowserContext","x_ite/Configuration/SupportedNodes","x_ite/Components/Core","x_ite/Components/EnvironmentalEffects","x_ite/Components/EnvironmentalSensor","x_ite/Components/Followers","x_ite/Components/Geometry3D","x_ite/Components/Grouping","x_ite/Components/Interpolation","x_ite/Components/Layering","x_ite/Components/Lighting","x_ite/Components/Navigation","x_ite/Components/Networking","x_ite/Components/PointingDeviceSensor","x_ite/Components/Rendering","x_ite/Components/Shaders","x_ite/Components/Shape","x_ite/Components/Sound","x_ite/Components/Text","x_ite/Components/Texturing","x_ite/Components/Time"],function(t,e,n){"use strict";function i(){}return i.prototype={addComponent:function(i){if(i.types)for(var r in i.types)n.addType(r,i.types[r]);if(i.abstractTypes)for(var r in i.abstractTypes)n.addAbstractType(r,i.abstractTypes[r]);i.browser&&e.addContext(i.browser),i.name&&t&&console.log("Done loading external component '"+i.name+"'.")}},new i}),define("x_ite/Configuration/ProfileInfo",[],function(){"use strict";function t(t,e,n,i){this.name=t,this.title=e,this.providerUrl=n,this.components=i,Object.preventExtensions(this),Object.freeze(this),Object.seal(this)}return Object.assign(t.prototype,{constructor:t,toVRMLStream:function(t){t.string+="PROFILE",t.string+=" ",t.string+=this.name},toXMLStream:function(t){t.string+=this.name}}),t}),define("x_ite/Configuration/ProfileInfoArray",["x_ite/Configuration/ComponentInfoArray","x_ite/Configuration/ProfileInfo","x_ite/Configuration/X3DInfoArray"],function(t,e,n){"use strict";function i(){return n.call(this)}return i.prototype=Object.assign(Object.create(n.prototype),{constructor:i,addProfile:function(n){this.add(n.name,new e(n.name,n.title,n.providerUrl,new t(n.components)))}}),i}),define("x_ite/Configuration/SupportedComponents",["x_ite/Configuration/ComponentInfoArray","x_ite/Browser/Networking/urls"],function(t,e){"use strict";var n=new t;return n.addBaseComponent({title:"Computer-Aided Design (CAD) model geometry",name:"CADGeometry",level:2,providerUrl:e.getProviderUrl("cad-geometry")}),n.addBaseComponent({title:"Core",name:"Core",level:2,providerUrl:e.getProviderUrl()}),n.addBaseComponent({title:"Cube map environmental texturing",name:"CubeMapTexturing",level:3,providerUrl:e.getProviderUrl("cube-map-texturing")}),n.addBaseComponent({title:"Distributed interactive simulation (DIS)",name:"DIS",level:2,providerUrl:e.getProviderUrl("dis")}),n.addBaseComponent({title:"Environmental effects",name:"EnvironmentalEffects",level:4,providerUrl:e.getProviderUrl()}),n.addBaseComponent({title:"Environmental sensor",name:"EnvironmentalSensor",level:4,providerUrl:e.getProviderUrl()}),n.addBaseComponent({title:"Event utilities",name:"EventUtilities",level:4,providerUrl:e.getProviderUrl("event-utilities")}),n.addBaseComponent({title:"Followers",name:"Followers",level:4,providerUrl:e.getProviderUrl()}),n.addBaseComponent({title:"Geometry2D",name:"Geometry2D",level:2,providerUrl:e.getProviderUrl("geometry2d")}),n.addBaseComponent({title:"Geometry3D",name:"Geometry3D",level:4,providerUrl:e.getProviderUrl()}),n.addBaseComponent({title:"Geospatial",name:"Geospatial",level:2,providerUrl:e.getProviderUrl("geospatial")}),n.addBaseComponent({title:"Grouping",name:"Grouping",level:3,providerUrl:e.getProviderUrl()}),n.addBaseComponent({
title:"Humanoid animation (H-Anim)",name:"H-Anim",level:3,providerUrl:e.getProviderUrl("h-anim")}),n.addBaseComponent({title:"Interpolation",name:"Interpolation",level:5,providerUrl:e.getProviderUrl()}),n.addBaseComponent({title:"Key device sensor",name:"KeyDeviceSensor",level:2,providerUrl:e.getProviderUrl("key-device-sensor")}),n.addBaseComponent({title:"Layering",name:"Layering",level:1,providerUrl:e.getProviderUrl()}),n.addBaseComponent({title:"Layout",name:"Layout",level:1,providerUrl:e.getProviderUrl("layout")}),n.addBaseComponent({title:"Lighting",name:"Lighting",level:3,providerUrl:e.getProviderUrl()}),n.addBaseComponent({title:"Navigation",name:"Navigation",level:3,providerUrl:e.getProviderUrl()}),n.addBaseComponent({title:"Networking",name:"Networking",level:4,providerUrl:e.getProviderUrl()}),n.addBaseComponent({title:"Non-uniform Rational B-Spline (NURBS)",name:"NURBS",level:4,providerUrl:e.getProviderUrl("nurbs")}),n.addBaseComponent({title:"Particle systems",name:"ParticleSystems",level:3,providerUrl:e.getProviderUrl("particle-systems")}),n.addBaseComponent({title:"Picking sensor",name:"Picking",level:3,providerUrl:e.getProviderUrl("picking")}),n.addBaseComponent({title:"Pointing device sensor",name:"PointingDeviceSensor",level:1,providerUrl:e.getProviderUrl()}),n.addBaseComponent({title:"Programmable shaders",name:"Shaders",level:1,providerUrl:e.getProviderUrl()}),n.addBaseComponent({title:"Rendering",name:"Rendering",level:5,providerUrl:e.getProviderUrl()}),n.addBaseComponent({title:"Rigid body physics",name:"RigidBodyPhysics",level:5,providerUrl:e.getProviderUrl("rigid-body-physics")}),n.addBaseComponent({title:"Scripting",name:"Scripting",level:1,providerUrl:e.getProviderUrl("scripting")}),n.addBaseComponent({title:"Shape",name:"Shape",level:4,providerUrl:e.getProviderUrl()}),n.addBaseComponent({title:"Sound",name:"Sound",level:1,providerUrl:e.getProviderUrl()}),n.addBaseComponent({title:"Text",name:"Text",level:1,providerUrl:e.getProviderUrl()}),n.addBaseComponent({title:"Texturing",name:"Texturing",level:3,providerUrl:e.getProviderUrl()}),n.addBaseComponent({title:"Texturing3D",name:"Texturing3D",level:3,providerUrl:e.getProviderUrl("texturing-3d")}),n.addBaseComponent({title:"Time",name:"Time",level:2,providerUrl:e.getProviderUrl()}),n.addBaseComponent({title:"Volume rendering",name:"VolumeRendering",level:2,providerUrl:e.getProviderUrl("volume-rendering")}),n.addBaseComponent({title:"X_ITE",name:"X_ITE",level:1,providerUrl:e.getProviderUrl("x_ite")}),n}),define("x_ite/Configuration/SupportedProfiles",["x_ite/Configuration/ProfileInfo","x_ite/Configuration/ProfileInfoArray","x_ite/Configuration/ComponentInfoArray","x_ite/Configuration/SupportedComponents","x_ite/Browser/Networking/urls"],function(t,e,n,i,r){"use strict";var o=new e;return o.addProfile({title:"Computer-Aided Design (CAD) interchange",name:"CADInterchange",providerUrl:r.getProviderUrl(),components:[i.Core,i.Networking,i.Grouping,i.Rendering,i.Shape,i.Lighting,i.Texturing,i.Navigation,i.Shaders,i.CADGeometry]}),o.addProfile({title:"Core",name:"Core",providerUrl:r.getProviderUrl(),components:[i.Core]}),o.addProfile({title:"Full",name:"Full",providerUrl:r.getProviderUrl(),components:[i.Core,i.Time,i.Networking,i.Grouping,i.Rendering,i.Shape,i.Geometry3D,i.Geometry2D,i.Text,i.Sound,i.Lighting,i.Texturing,i.Interpolation,i.PointingDeviceSensor,i.KeyDeviceSensor,i.EnvironmentalSensor,i.Navigation,i.EnvironmentalEffects,i.Geospatial,i["H-Anim"],i.NURBS,i.DIS,i.Scripting,i.EventUtilities,i.Shaders,i.CADGeometry,i.Texturing3D,i.CubeMapTexturing,i.Layering,i.Layout,i.RigidBodyPhysics,i.Picking,i.Followers,i.ParticleSystems,i.VolumeRendering]}),o.addProfile({title:"Immersive",name:"Immersive",providerUrl:r.getProviderUrl(),components:[i.Core,i.Time,i.Networking,i.Grouping,i.Rendering,i.Shape,i.Geometry3D,i.Geometry2D,i.Text,i.Sound,i.Lighting,i.Texturing,i.Interpolation,i.PointingDeviceSensor,i.KeyDeviceSensor,i.EnvironmentalSensor,i.Navigation,i.EnvironmentalEffects,i.Scripting,i.EventUtilities]}),o.addProfile({title:"Interactive",name:"Interactive",providerUrl:r.getProviderUrl(),components:[i.Core,i.Time,i.Networking,i.Grouping,i.Rendering,i.Shape,i.Geometry3D,i.Lighting,i.Texturing,i.Interpolation,i.PointingDeviceSensor,i.KeyDeviceSensor,i.EnvironmentalSensor,i.Navigation,i.EnvironmentalEffects,i.EventUtilities]}),o.addProfile({title:"Interchange",name:"Interchange",providerUrl:r.getProviderUrl(),components:[i.Core,i.Time,i.Networking,i.Grouping,i.Rendering,i.Shape,i.Geometry3D,i.Lighting,i.Texturing,i.Interpolation,i.Navigation,i.EnvironmentalEffects]}),o.addProfile({title:"Medical interchange",name:"MedicalInterchange",providerUrl:r.getProviderUrl(),components:[i.Core,i.Time,i.Networking,i.Grouping,i.Rendering,i.Shape,i.Geometry3D,i.Geometry2D,i.Text,i.Lighting,i.Texturing,i.Interpolation,i.Navigation,i.EnvironmentalEffects,i.EventUtilities,i.Texturing3D,i.VolumeRendering]}),o.addProfile({title:"MPEG-4 interactive",name:"MPEG-4",providerUrl:r.getProviderUrl(),components:[i.Core,i.Time,i.Networking,i.Grouping,i.Rendering,i.Shape,i.Geometry3D,i.Lighting,i.Texturing,i.Interpolation,i.PointingDeviceSensor,i.EnvironmentalSensor,i.Navigation,i.EnvironmentalEffects]}),o}),define("x_ite/Browser/X3DBrowser",["jquery","x_ite/Browser/VERSION","x_ite/Base/Events","x_ite/Fields","x_ite/Components","x_ite/Browser/X3DBrowserContext","x_ite/Configuration/ComponentInfo","x_ite/Configuration/SupportedProfiles","x_ite/Configuration/SupportedComponents","x_ite/Configuration/SupportedNodes","x_ite/Execution/Scene","x_ite/Execution/X3DScene","x_ite/InputOutput/FileLoader","x_ite/Parser/XMLParser","x_ite/Parser/JSONParser","x_ite/Bits/X3DConstants","locale/gettext"],function(t,e,n,i,r,o,s,a,u,l,c,h,d,p,f,g,m){"use strict";function x(t){o.call(this,t),this.currentSpeed=0,this.currentFrameRate=60,this.components={},this.browserCallbacks=new Map,this.replaceWorld(this.createScene())}return x.prototype=Object.assign(Object.create(o.prototype),{constructor:x,getTypeName:function(){return"X3DBrowser"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"browser"},initialize:function(){o.prototype.initialize.call(this);var t=this.getElement().attr("src");t=t?'"'+t+'"':this.getElement().attr("url"),t?(this.initialized().set(this.getCurrentTime()),this.load(t)):(this.initialized().setValue(this.getCurrentTime()),this.callBrowserCallbacks(g.INITIALIZED_EVENT),this.callBrowserEventHandler("onload")),this.print("Welcome to "+this.name+" X3D Browser "+this.version+":\n   Current Graphics Renderer\n      Name: "+this.getVendor()+" "+this.getRenderer()+"\n      WebGL version: "+this.getWebGLVersion()+"\n      Shading language: "+this.getShadingLanguageVersion()+"\n   Rendering Properties\n      Antialiased: "+this.getAntialiased()+"\n      Depth size: "+this.getDepthSize()+" bits\n      Color depth: "+this.getColorDepth()+" bits\n      Max clip planes: "+this.getMaxClipPlanes()+"\n      Max lights: "+this.getMaxLights()+"\n      Max textures: "+this.getMaxTextures()+"\n      Texture units: "+this.getMaxCombinedTextureUnits()+"\n      Max texture size: "+this.getMaxTextureSize()+" × "+this.getMaxTextureSize()+" pixel\n      Texture memory: "+this.getTextureMemory()+"\n      Max vertex uniform vectors: "+this.getMaxVertexUniformVectors()+"\n      Max fragment uniform vectors: "+this.getMaxFragmentUniformVectors()+"\n      Max vertex attribs: "+this.getMaxVertexAttribs()+"\n")},getName:function(){return this.name},getVersion:function(){return this.version},getCurrentSpeed:function(){return this.currentSpeed},getCurrentFrameRate:function(){return this.currentFrameRate},setDescription:function(t){this.description=t},getWorldURL:function(){return this.currentScene.worldURL},getProfile:function(t){var e=a.get(t);if(e)return e;throw Error("Profile '"+t+"' is not supported.")},getComponent:function(t,e){var n=u.get(t);if(n&&(n.level,!0))return new s(t,e,n.title,n.providerUrl);throw Error("Component '"+t+"' at level '"+e+"' is not supported.")},getSupportedNode:function(t){return l.getType(t)},createScene:function(t,e){var n=new c(this);if(arguments.length){n.setProfile(t);for(var i=1,r=arguments.length;i<r;++i)n.addComponent(arguments[i])}return n.setup(),this.isExternal()?n:(n.setLive(!0),n)},replaceWorld:function(t){if(this.loadCount_.removeInterest("set_loadCount__",this),this.prepareEvents().removeInterest("bind",this),this.loader&&this.loader.abort(),this.getWorld()&&(this.getExecutionContext().setLive(!1),this.shutdown().processInterests(),this.callBrowserCallbacks(g.SHUTDOWN_EVENT),this.callBrowserEventHandler("onshutdown")),n.clear(),t instanceof i.MFNode){var e=t;t=this.createScene();for(var r=0,o=e.length;r<o;++r)t.isLive().addInterest(e[r].getValue().getExecutionContext().isLive());t.setRootNodes(e)}t instanceof h||(t=this.createScene()),this.description="",this.getBrowserOptions().configure(),this.setBrowserLoading(!0),this.loadCount_.addInterest("set_loadCount__",this),this.prepareEvents().removeInterest("bind",this);for(var s in t.getLoadingObjects())this.addLoadCount(t.getLoadingObjects()[s]);t.setLive(this.isLive().getValue()),this.setExecutionContext(t)},set_loadCount__:function(t){t.getValue()||(this.loadCount_.removeInterest("set_loadCount__",this),this.prepareEvents().addInterest("bind",this),this.addBrowserEvent())},bind:function(){this.prepareEvents().removeInterest("bind",this),this.setBrowserLoading(!1),this.initialized().getValue()&&(this.initialized().setValue(this.getCurrentTime()),this.callBrowserCallbacks(g.INITIALIZED_EVENT),this.callBrowserEventHandler("onload"))},createVrmlFromString:function(t){return this.createX3DFromString(t).rootNodes},createX3DFromString:function(t){var e=this.currentScene,n=this.isExternal(),i=new d(this.getWorld()).createX3DFromString(this.currentScene.getURL(),t);return n||(i.setExecutionContext(e),e.isLive().addInterest("setLive",i),e.isLive().getValue()&&i.setLive(!0)),i.setup(),i},createVrmlFromURL:function(t,e,n){if(!(e instanceof i.SFNode))throw new Error("Browser.createVrmlFromURL: node must be of type SFNode.");if(!e.getValue())throw new Error("Browser.createVrmlFromURL: node IS NULL.");var r=e.getValue().getField(n);if(!r.isInput())throw new Error("Browser.createVrmlFromURL: event named '"+n+"' must be a input field.");if(r.getType()!==g.MFNode)throw new Error("Browser.createVrmlFromURL: event named '"+n+"' must be of type MFNode.");var o=this.currentScene,s=this.isExternal(),a=new d(this.getWorld());this.addLoadCount(a),a.createX3DFromURL(t,null,function(t){this.removeLoadCount(a),t&&(s||(t.setExecutionContext(o),o.isLive().addInterest("setLive",t),o.isLive().getValue()&&t.setLive(!0)),t.setup(),r.setValue(t.rootNodes))}.bind(this))},createX3DFromURL:function(t,e,n){if(3===arguments.length)return this.createVrmlFromURL(t,e,n);var i=this.currentScene,r=this.isExternal(),o=new d(this.getWorld()).createX3DFromURL(t,null);return r||(o.setExecutionContext(i),i.isLive().addInterest("setLive",o),i.isLive().getValue()&&o.setLive(!0)),o.setup(),o},loadURL:function(t,e){this.loadCount_.removeInterest("set_loadCount__",this),this.prepareEvents().removeInterest("bind",this),this.loader&&this.loader.abort(),this.setBrowserLoading(!0),this.addLoadCount(this),this.loader=new d(this.getWorld()),this.loader.createX3DFromURL(t,e,function(t){this.getBrowserOptions().getSplashScreen()||this.getCanvas().fadeIn(0),t?this.replaceWorld(t):(this.callBrowserCallbacks(g.CONNECTION_ERROR),this.callBrowserEventHandler("onerror"),setTimeout(function(){this.getSplashScreen().find(".x_ite-private-spinner-text").text(m("Failed loading world."))}.bind(this),31))}.bind(this),function(t){this.currentScene.changeViewpoint(t),this.removeLoadCount(this),this.setBrowserLoading(!1)}.bind(this),function(t,e){e?window.open(t,e):location=t,this.removeLoadCount(this),this.setBrowserLoading(!1)}.bind(this))},addBrowserListener:function(t,e){},removeBrowserListener:function(t){},addBrowserCallback:function(t,e){this.browserCallbacks.set(t,e)},removeBrowserCallback:function(t){this.browserCallbacks.delete(t)},getBrowserCallbacks:function(){return this.browserCallbacks},callBrowserCallbacks:function(t){this.browserCallbacks.size&&this.browserCallbacks.forEach(function(e){e(t)})},importDocument:function(t,e,n){if(t){var i=this.createScene(),r=this.currentScene,o=this.isExternal();if(!e)return new p(i).parseIntoScene(t),o||(i.setExecutionContext(r),r.isLive().addInterest("setLive",i),r.isLive().getValue()&&i.setLive(!0)),i;new p(i).parseIntoScene(t,function(){o||(i.setExecutionContext(r),r.isLive().addInterest("setLive",i),r.isLive().getValue()&&i.setLive(!0)),e(i)},function(t){n&&n(t)})}},importJS:function(t,e,n){if(t){var i=this.createScene(),r=this.currentScene,o=this.isExternal();if(!e)return new f(i).parseJavaScript(t),o||(i.setExecutionContext(r),r.isLive().addInterest("setLive",i),r.isLive().getValue()&&i.setLive(!0)),i;new f(i).parseJavaScript(t,function(){o||(i.setExecutionContext(r),r.isLive().addInterest("setLive",i),r.isLive().getValue()&&i.setLive(!0)),e(i)},function(t){n&&n(t)})}},getBrowserProperty:function(t){return this.getBrowserProperties().getField(t).getValue()},setBrowserOption:function(t,e){this.getBrowserOptions().getField(t).setValue(e)},getBrowserOption:function(t){return this.getBrowserOptions().getField(t).getValue()},getRenderingProperty:function(t){return this.getRenderingProperties().getField(t).getValue()},firstViewpoint:function(t){if(t||(t=this.getActiveLayer()),t){var e=t.getUserViewpoints();e.length&&this.bindViewpoint(e[0])}},previousViewpoint:function(t){if(t||(t=this.getActiveLayer()),t){var e=t.getUserViewpoints();if(0===e.length)return;for(var n=0,i=0;i<e.length&&!e[i].isBound_.getValue();++i)++n;n<e.length?0===n?this.bindViewpoint(e[e.length-1]):this.bindViewpoint(e[n-1]):this.bindViewpoint(e[e.length-1])}},nextViewpoint:function(t){if(t||(t=this.getActiveLayer()),t){var e=t.getUserViewpoints();if(0===e.length)return;for(var n=0,i=0;i<e.length&&!e[i].isBound_.getValue();++i)++n;n<e.length?n===e.length-1?this.bindViewpoint(e[0]):this.bindViewpoint(e[n+1]):this.bindViewpoint(e[0])}},lastViewpoint:function(t){if(t||(t=this.getActiveLayer()),t){var e=t.getUserViewpoints();e.length&&this.bindViewpoint(e[e.length-1])}},changeViewpoint:function(t){try{this.currentScene.changeViewpoint(t)}catch(t){console.log(t.message)}},bindViewpoint:function(t){t.setAnimate(!0),t.isBound_.getValue()?t.transitionStart(t):t.set_bind_=!0},addRoute:function(t,e,n,i){this.currentScene.addRoute(t,e,n,i)},deleteRoute:function(t,e,n,i){try{var r=this.currentScene.getRoute(t,e,n,i);r&&this.currentScene.deleteRoute(r)}catch(t){console.log(t)}},beginUpdate:function(){this.setLive(!0),this.getExecutionContext().setLive(!0),this.advanceTime(performance.now())},endUpdate:function(){this.setLive(!1),this.getExecutionContext().setLive(!1)},print:function(){for(var e="",n=0;n<arguments.length;++n)e+=arguments[n];console.log(e);var i=t(".x_ite-console");i.length&&i.append(document.createTextNode(e))},println:function(){for(var e="",n=0;n<arguments.length;++n)e+=arguments[n];console.log(e),e+="\n";var i=t(".x_ite-console");i.length&&i.append(document.createTextNode(e))}}),Object.defineProperty(x.prototype,"name",{get:function(){return"X_ITE"},enumerable:!0,configurable:!1}),Object.defineProperty(x.prototype,"version",{get:function(){return e},enumerable:!0,configurable:!1}),Object.defineProperty(x.prototype,"description",{get:function(){return this.getNotification().string_.getValue()},set:function(t){this.getNotification().string_=t},enumerable:!0,configurable:!1}),Object.defineProperty(x.prototype,"currentScene",{get:function(){return this.getScriptStack()[this.getScriptStack().length-1].getExecutionContext()},enumerable:!0,configurable:!1}),x}),define("x_ite/X3D",["jquery","x_ite/Error","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Basic/X3DField","x_ite/Basic/X3DArrayField","x_ite/Fields","x_ite/Browser/X3DBrowser","x_ite/Configuration/ComponentInfo","x_ite/Configuration/ComponentInfoArray","x_ite/Configuration/ProfileInfo","x_ite/Configuration/ProfileInfoArray","x_ite/Configuration/UnitInfo","x_ite/Configuration/UnitInfoArray","x_ite/Execution/X3DExecutionContext","x_ite/Execution/X3DScene","x_ite/Prototype/ExternProtoDeclarationArray","x_ite/Prototype/ProtoDeclarationArray","x_ite/Prototype/X3DExternProtoDeclaration","x_ite/Prototype/X3DProtoDeclaration","x_ite/Routing/RouteArray","x_ite/Routing/X3DRoute","x_ite/Bits/X3DConstants","x_ite/Browser/Networking/urls"],function(t,e,n,i,r,o,s,a,u,l,c,h,d,p,f,g,m,x,v,_,y,w,b,S){"use strict";function C(e,n){var i=t("<X3DCanvas></X3DCanvas>");return e instanceof s.MFString&&i.attr("url",e.toString()),F(i),i[0]}function T(e){return t(e||"X3DCanvas").data("browser")}function F(e){if(e=t(e),!e.find(".x_ite-private-browser").length){var n=new a(e);return e.data("browser",n),n.setup(),n}}function O(n,i){"function"==typeof n&&M.done(n),"function"==typeof i&&D.done(i),E||(E=!0,t(function(){var n=t("X3DCanvas");n.children().hide();try{t.map(n,F),M.resolve()}catch(t){e.fallback(n,t),D.resolve(t)}}))}function N(t){return S.getProviderUrl(t)}console||(console={}),console.log||(console.log=function(){}),console.info||(console.info=console.log),console.warn||(console.warn=console.log),console.error||(console.error=console.log);var E=!1,M=t.Deferred(),D=t.Deferred();return Object.assign(O,{require:require,define:define,getComponentUrl:N,getBrowser:T,createBrowser:C,X3DConstants:b,X3DBrowser:a,X3DExecutionContext:f,X3DScene:g,ComponentInfo:u,ComponentInfoArray:l,ProfileInfo:c,ProfileInfoArray:h,UnitInfo:d,UnitInfoArray:p,ExternProtoDeclarationArray:m,ProtoDeclarationArray:x,X3DExterProtonDeclaration:v,X3DProtoDeclaration:_,RouteArray:y,X3DRoute:w,X3DFieldDefinition:n,FieldDefinitionArray:i,X3DField:r,X3DArrayField:o,SFColor:s.SFColor,SFColorRGBA:s.SFColorRGBA,SFImage:s.SFImage,SFMatrix3d:s.SFMatrix3d,SFMatrix3f:s.SFMatrix3f,SFMatrix4d:s.SFMatrix4d,SFMatrix4f:s.SFMatrix4f,SFNode:s.SFNode,SFRotation:s.SFRotation,SFVec2d:s.SFVec2d,SFVec2f:s.SFVec2f,SFVec3d:s.SFVec3d,SFVec3f:s.SFVec3f,SFVec4d:s.SFVec4d,SFVec4f:s.SFVec4f,VrmlMatrix:s.VrmlMatrix,MFBool:s.MFBool,MFColor:s.MFColor,MFColorRGBA:s.MFColorRGBA,MFDouble:s.MFDouble,MFFloat:s.MFFloat,MFImage:s.MFImage,MFInt32:s.MFInt32,MFMatrix3d:s.MFMatrix3d,MFMatrix3f:s.MFMatrix3f,MFMatrix4d:s.MFMatrix4d,MFMatrix4f:s.MFMatrix4f,MFNode:s.MFNode,MFRotation:s.MFRotation,MFString:s.MFString,MFTime:s.MFTime,MFVec2d:s.MFVec2d,MFVec2f:s.MFVec2f,MFVec3d:s.MFVec3d,MFVec3f:s.MFVec3f,MFVec4d:s.MFVec4d,MFVec4f:s.MFVec4f}),O}),require.config({waitSeconds:0});var getScriptURL=function(){var t=document.getElementsByTagName("script"),e=t[t.length-1].src;return function(){return e}}();!function(){"use strict";function t(t,e){r?r(t,e):(o.push(t),s.push(e))}function e(t){require(["x_ite/Error"],function(e){e(t,s)})}function n(){return window.X3D===t&&(void 0===i?delete window.X3D:window.X3D=i),t}var i=window.X3D,r=null;if(t.noConflict=n,t.require=require,t.define=define,window.X3D=t,document.createElement("X3DCanvas"),void 0===window.Proxy)return e("Proxy is not defined");var o=[],s=[];require(["jquery","x_ite/X3D"],function(e,n){e.noConflict(!0),r=n,Object.assign(t,n),n();for(var i=0;i<o.length;++i)n(o[i],s[i])},e)}(),define("x_ite",function(){});for(var key in x_iteNoConfict)void 0===x_iteNoConfict[key]?delete window[key]:window[key]=x_iteNoConfict[key]}();
