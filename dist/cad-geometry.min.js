!function(){var t=X3D.define,e=X3D.require;t("x_ite/Bits/TraverseType",[],function(){"use strict";var t=0,e={POINTER:t++,CAMERA:t++,COLLISION:t++,DEPTH:t++,DISPLAY:t++};return Object.preventExtensions(e),Object.freeze(e),Object.seal(e),e}),t("x_ite/Components/Grouping/X3DGroupingNode",["x_ite/Fields","x_ite/Components/Core/X3DChildNode","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","standard/Math/Numbers/Matrix4"],function(t,e,i,r,n,s){"use strict";function o(t){return t?t.getValue().getId():-1}function a(t,e,i,r,n,s){function a(t){return h[o(t)]}for(var h={},l=n;l<s;++l)h[o(r[l])]=!0;return t.remove(e,i,a)}function h(t){e.call(this,t),i.call(this,t),this.addType(n.X3DGroupingNode),this.hidden=!1,this.pointingDeviceSensors=[],this.maybeCameraObjects=[],this.cameraObjects=[],this.clipPlanes=[],this.localFogs=[],this.lights=[],this.displayNodes=[],this.childNodes=[]}var l=new t.MFBool;return h.prototype=Object.assign(Object.create(e.prototype),i.prototype,{constructor:h,initialize:function(){e.prototype.initialize.call(this),i.prototype.initialize.call(this),this.addChildren_.addInterest("set_addChildren__",this),this.removeChildren_.addInterest("set_removeChildren__",this),this.children_.addInterest("set_children__",this),this.set_children__()},getBBox:function(t){return this.bboxSize_.getValue().equals(this.defaultBBoxSize)?i.prototype.getBBox.call(this,this.children_.getValue(),t):t.set(this.bboxSize_.getValue(),this.bboxCenter_.getValue())},getMatrix:function(){return s.Identity},setHidden:function(t){t!==this.hidden&&(this.hidden=t,this.set_children__())},getVisible:function(){return l},getChild:function(t){try{if(t>=0&&t<this.children_.length){var e=this.children_[t];if(e)return e.getValue().getInnerNode()}}catch(t){}return null},set_addChildren__:function(){if(0!==this.addChildren_.length){this.addChildren_.setTainted(!0),this.addChildren_.erase(a(this.addChildren_,0,this.addChildren_.length,this.children_,0,this.children_.length),this.addChildren_.length),this.children_.getTainted()||(this.children_.removeInterest("set_children__",this),this.children_.addInterest("connectChildren",this));var t=this.children_.length;this.children_.insert(this.children_.length,this.addChildren_,0,this.addChildren_.length),this.add(t,this.addChildren_),this.addChildren_.set([]),this.addChildren_.setTainted(!1)}},set_removeChildren__:function(){0!==this.removeChildren_.length&&0!==this.children_.length&&(this.children_.getTainted()||(this.children_.removeInterest("set_children__",this),this.children_.addInterest("connectChildren",this)),this.children_.erase(a(this.children_,0,this.children_.length,this.removeChildren_,0,this.removeChildren_.length),this.children_.length),this.remove(this.removeChildren_),this.removeChildren_.set([]))},set_children__:function(){this.clear(),this.add(0,this.children_)},connectChildren:function(){this.children_.removeInterest("connectChildren",this),this.children_.addInterest("set_children__",this)},add:function(t,e){if(!this.hidden){for(var i=this.getVisible(),r=i.length,s=0,o=t,a=e.length;s<a;++s,++o){var h=e[s];if(h&&(o>=r||i[o]))try{for(var l=h.getValue().getInnerNode(),d=l.getType(),c=d.length-1;c>=0;--c){switch(d[c]){case n.X3DPointingDeviceSensorNode:this.pointingDeviceSensors.push(l);break;case n.ClipPlane:this.clipPlanes.push(l);break;case n.LocalFog:this.localFogs.push(l);break;case n.X3DLightNode:this.lights.push(l);break;case n.X3DBindableNode:this.maybeCameraObjects.push(l);break;case n.X3DBackgroundNode:case n.X3DChildNode:l.isCameraObject_.addInterest("set_cameraObjects__",this),this.maybeCameraObjects.push(l),this.childNodes.push(l);break;case n.BooleanFilter:case n.BooleanToggle:case n.NurbsOrientationInterpolator:case n.NurbsPositionInterpolator:case n.NurbsSurfaceInterpolator:case n.TimeSensor:case n.X3DFollowerNode:case n.X3DInfoNode:case n.X3DInterpolatorNode:case n.X3DLayoutNode:case n.X3DScriptNode:case n.X3DSequencerNode:case n.X3DTriggerNode:break;default:continue}break}}catch(t){}}this.set_cameraObjects__(),this.set_display_nodes()}},remove:function(t){for(var e=0,i=t.length;e<i;++e){var r=t[e];if(r)try{for(var s=r.getValue().getInnerNode(),o=s.getType(),a=o.length-1;a>=0;--a){switch(o[a]){case n.X3DPointingDeviceSensorNode:var h=this.pointingDeviceSensors.indexOf(s);h>=0&&this.pointingDeviceSensors.splice(h,1);break;case n.ClipPlane:var h=this.clipPlanes.indexOf(s);h>=0&&this.clipPlanes.splice(h,1);break;case n.LocalFog:var h=this.localFogs.indexOf(s);h>=0&&this.localFogs.splice(h,1);break;case n.X3DLightNode:var h=this.lights.indexOf(s);h>=0&&this.lights.splice(h,1);break;case n.X3DBindableNode:var h=this.maybeCameraObjects.indexOf(s);h>=0&&this.maybeCameraObjects.splice(h,1);break;case n.X3DBackgroundNode:case n.X3DChildNode:s.isCameraObject_.removeInterest("set_cameraObjects__",this);var h=this.maybeCameraObjects.indexOf(s);h>=0&&this.maybeCameraObjects.splice(h,1);var h=this.childNodes.indexOf(s);h>=0&&this.childNodes.splice(h,1);break;case n.BooleanFilter:case n.BooleanToggle:case n.NurbsOrientationInterpolator:case n.NurbsPositionInterpolator:case n.NurbsSurfaceInterpolator:case n.TimeSensor:case n.X3DFollowerNode:case n.X3DInfoNode:case n.X3DInterpolatorNode:case n.X3DLayoutNode:case n.X3DScriptNode:case n.X3DSequencerNode:case n.X3DTriggerNode:break;default:continue}break}}catch(t){}}this.set_cameraObjects__(),this.set_display_nodes()},clear:function(){for(var t=0,e=this.childNodes.length;t<e;++t)this.childNodes[t].isCameraObject_.removeInterest("set_cameraObjects__",this);this.pointingDeviceSensors.length=0,this.maybeCameraObjects.length=0,this.cameraObjects.length=0,this.clipPlanes.length=0,this.localFogs.length=0,this.lights.length=0,this.childNodes.length=0},set_cameraObjects__:function(){this.cameraObjects.length=0;for(var t=0,e=this.maybeCameraObjects.length;t<e;++t){var i=this.maybeCameraObjects[t];i.getCameraObject()&&this.cameraObjects.push(i)}this.setCameraObject(this.cameraObjects.length)},set_display_nodes:function(){var t=this.clipPlanes,e=this.localFogs,i=this.lights,r=this.displayNodes;r.length=0;for(var n=0,s=t.length;n<s;++n)r.push(t[n]);for(var n=0,s=e.length;n<s;++n)r.push(e[n]);for(var n=0,s=i.length;n<s;++n)r.push(i[n])},traverse:function(t,e){switch(t){case r.POINTER:var i=this.pointingDeviceSensors,n=this.clipPlanes,s=this.childNodes;if(i.length){var o={};e.getBrowser().getSensors().push(o);for(var a=0,h=i.length;a<h;++a)i[a].push(e,o)}for(var a=0,h=n.length;a<h;++a)n[a].push(e);for(var a=0,h=s.length;a<h;++a)s[a].traverse(t,e);for(var a=n.length-1;a>=0;--a)n[a].pop(e);return void(i.length&&e.getBrowser().getSensors().pop());case r.CAMERA:for(var l=this.cameraObjects,a=0,h=l.length;a<h;++a)l[a].traverse(t,e);return;case r.COLLISION:case r.DEPTH:for(var n=this.clipPlanes,s=this.childNodes,a=0,h=n.length;a<h;++a)n[a].push(e);for(var a=0,h=s.length;a<h;++a)s[a].traverse(t,e);for(var a=n.length-1;a>=0;--a)n[a].pop(e);return;case r.DISPLAY:for(var d=this.displayNodes,s=this.childNodes,a=0,h=d.length;a<h;++a)d[a].push(e,this);for(var a=0,h=s.length;a<h;++a)s[a].traverse(t,e);for(var a=d.length-1;a>=0;--a)d[a].pop(e);return}}}),h}),t("x_ite/Components/CADGeometry/X3DProductStructureChildNode",["x_ite/Components/Core/X3DChildNode","x_ite/Bits/X3DConstants"],function(t,e){"use strict";function i(i){t.call(this,i),this.addType(e.X3DProductStructureChildNode)}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i}),i}),t("x_ite/Components/CADGeometry/CADAssembly",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Components/CADGeometry/X3DProductStructureChildNode","x_ite/Bits/X3DConstants"],function(t,e,i,r,n,s){"use strict";function o(t){r.call(this,t),n.call(this,t),this.addType(s.CADAssembly)}return o.prototype=Object.assign(Object.create(r.prototype),{constructor:o,fieldDefinitions:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"name",new t.SFString),new e(s.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new e(s.initializeOnly,"bboxCenter",new t.SFVec3f),new e(s.inputOnly,"addChildren",new t.MFNode),new e(s.inputOnly,"removeChildren",new t.MFNode),new e(s.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"CADAssembly"},getComponentName:function(){return"CADGeometry"},getContainerField:function(){return"children"}}),o}),t("x_ite/Components/CADGeometry/CADFace",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/CADGeometry/X3DProductStructureChildNode","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,i,r,n,s,o){"use strict";function a(t){r.call(this,t),n.call(this,t),this.addType(o.CADFace),this.shapeNode=null}return a.prototype=Object.assign(Object.create(r.prototype),n.prototype,{constructor:a,fieldDefinitions:new i([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOutput,"name",new t.SFString),new e(o.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new e(o.initializeOnly,"bboxCenter",new t.SFVec3f),new e(o.inputOutput,"shape",new t.SFNode)]),getTypeName:function(){return"CADFace"},getComponentName:function(){return"CADGeometry"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),n.prototype.initialize.call(this),this.shape_.addInterest("set_shape__",this),this.set_shape__()},getBBox:function(t){if(this.bboxSize_.getValue().equals(this.defaultBBoxSize)){var e=s(o.X3DBoundedObject,this.shape_);return e?e.getBBox(t):t.set()}return t.set(this.bboxSize_.getValue(),this.bboxCenter_.getValue())},set_shape__:function(){this.shapeNode&&this.shapeNode.isCameraObject_.removeFieldInterest(this.isCameraObject_),this.shapeNode=null;try{for(var t=this.shape_.getValue().getInnerNode(),e=t.getType(),i=e.length-1;i>=0;--i)switch(e[i]){case o.LOD:case o.Transform:case o.X3DShapeNode:t.isCameraObject_.addFieldInterest(this.isCameraObject_),this.setCameraObject(t.getCameraObject()),this.shapeNode=t;break;default:continue}}catch(t){}this.shapeNode?delete this.traverse:this.traverse=Function.prototype},traverse:function(t,e){this.shapeNode.traverse(t,e)}}),a}),t("x_ite/Components/CADGeometry/CADLayer",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/X3DConstants"],function(t,e,i,r,n){"use strict";function s(t){r.call(this,t),this.addType(n.CADLayer)}return s.prototype=Object.assign(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new e(n.inputOutput,"metadata",new t.SFNode),new e(n.inputOutput,"name",new t.SFString),new e(n.inputOutput,"visible",new t.MFBool),new e(n.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new e(n.initializeOnly,"bboxCenter",new t.SFVec3f),new e(n.inputOnly,"addChildren",new t.MFNode),new e(n.inputOnly,"removeChildren",new t.MFNode),new e(n.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"CADLayer"},getComponentName:function(){return"CADGeometry"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this),this.visible_.addInterest("set_children__",this)},getVisible:function(){return this.visible_},remove:function(){this.set_children__()}}),s}),t("x_ite/Components/Grouping/X3DTransformMatrix3DNode",["x_ite/Components/Grouping/X3DGroupingNode","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(t,e,i,r,n){"use strict";function s(i){t.call(this,i),this.addType(e.X3DTransformMatrix3DNode),this.matrix=new n}return s.prototype=Object.assign(Object.create(t.prototype),{constructor:s,getBBox:function(e){var e=t.prototype.getBBox.call(this,e);return this.traverse===s.prototype.traverse?e.multRight(this.matrix):e},setMatrix:function(e){e.equals(n.Identity)?(this.matrix.identity(),this.traverse=t.prototype.traverse):(this.matrix.assign(e),delete this.traverse)},getMatrix:function(){return this.matrix},setTransform:function(e,n,s,o,a){e.equals(i.Zero)&&n.equals(r.Identity)&&s.equals(i.One)?(this.matrix.identity(),this.traverse=t.prototype.traverse):(this.matrix.set(e,n,s,o,a),delete this.traverse)},traverse:function(e,i){var r=i.getModelViewMatrix();r.push(),r.multLeft(this.matrix),t.prototype.traverse.call(this,e,i),r.pop()}}),s}),t("x_ite/Components/Grouping/X3DTransformNode",["x_ite/Components/Grouping/X3DTransformMatrix3DNode","x_ite/Bits/X3DConstants"],function(t,e){"use strict";function i(i){t.call(this,i),this.addType(e.X3DTransformNode),this.translation_.setUnit("length"),this.center_.setUnit("length")}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,initialize:function(){t.prototype.initialize.call(this),this.addInterest("eventsProcessed",this),this.eventsProcessed()},eventsProcessed:function(){this.setHidden(0===this.scale_.x||0===this.scale_.y||0===this.scale_.z),this.setTransform(this.translation_.getValue(),this.rotation_.getValue(),this.scale_.getValue(),this.scaleOrientation_.getValue(),this.center_.getValue())}}),i}),t("x_ite/Components/CADGeometry/CADPart",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DTransformNode","x_ite/Components/CADGeometry/X3DProductStructureChildNode","x_ite/Bits/X3DConstants"],function(t,e,i,r,n,s){"use strict";function o(t){r.call(this,t),n.call(this,t),this.addType(s.CADPart)}return o.prototype=Object.assign(Object.create(r.prototype),{constructor:o,fieldDefinitions:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"name",new t.SFString),new e(s.inputOutput,"translation",new t.SFVec3f),new e(s.inputOutput,"rotation",new t.SFRotation),new e(s.inputOutput,"scale",new t.SFVec3f(1,1,1)),new e(s.inputOutput,"scaleOrientation",new t.SFRotation),new e(s.inputOutput,"center",new t.SFVec3f),new e(s.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new e(s.initializeOnly,"bboxCenter",new t.SFVec3f),new e(s.inputOnly,"addChildren",new t.MFNode),new e(s.inputOnly,"removeChildren",new t.MFNode),new e(s.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"CADPart"},getComponentName:function(){return"CADGeometry"},getContainerField:function(){return"children"},initialize:function(){r.prototype.initialize.call(this)}}),o}),t("x_ite/Browser/Core/Shading",[],function(){"use strict";var t=0,e={POINT:t++,WIREFRAME:t++,FLAT:t++,GOURAUD:t++,PHONG:t++};return Object.preventExtensions(e),Object.freeze(e),Object.seal(e),e}),t("standard/Math/Geometry/Plane3",["standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(t,e){"use strict";function i(t,e){this.normal=e.copy(),this.distanceFromOrigin=e.dot(t)}var r=new t(0,0,0),n=new t(0,0,0),s=new e;return i.prototype={constructor:i,copy:function(){var t=Object.create(i.prototype);return t.normal=this.normal.copy(),t.distanceFromOrigin=this.distanceFromOrigin,t},assign:function(t){return this.normal.assign(t.normal),this.distanceFromOrigin=t.distanceFromOrigin,this},set:function(t,e){return this.normal.assign(e),this.distanceFromOrigin=e.dot(t),this},multRight:function(t){return n.assign(this.normal).multiply(this.distanceFromOrigin),s.assign(t).inverse(),s.multMatrixDir(r.assign(this.normal)).normalize(),t.multVecMatrix(n),this.normal.assign(r),this.distanceFromOrigin=r.dot(n),this},multLeft:function(t){return n.assign(this.normal).multiply(this.distanceFromOrigin),s.assign(t).inverse(),s.multDirMatrix(r.assign(this.normal)).normalize(),t.multMatrixVec(n),this.normal.assign(r),this.distanceFromOrigin=r.dot(n),this},getDistanceToPoint:function(e){return t.dot(e,this.normal)-this.distanceFromOrigin},intersectsLine:function(t,e){var i=t.point,r=t.direction,n=r.dot(this.normal);if(0===n)return!1;var s=(this.distanceFromOrigin-this.normal.dot(i))/n;return e.x=i.x+r.x*s,e.y=i.y+r.y*s,e.z=i.z+r.z*s,!0},toString:function(){return this.normal.toString()+" "+this.distanceFromOrigin}},i}),t("x_ite/Components/Rendering/X3DGeometryNode",["x_ite/Fields","x_ite/Components/Core/X3DNode","x_ite/Bits/X3DConstants","x_ite/Browser/Core/Shading","standard/Math/Numbers/Color3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Box3","standard/Math/Geometry/Plane3","standard/Math/Geometry/Triangle3","standard/Math/Algorithm"],function(t,e,i,r,n,s,o,a,h,l,d,c,u){"use strict";function p(r){e.call(this,r),this.addType(i.X3DGeometryNode),this.addChildObjects("transparent",new t.SFBool,"bbox_changed",new t.SFTime,"rebuild",new t.SFTime),this.transparent_.setAccessType(i.outputOnly),this.bbox_changed_.setAccessType(i.outputOnly),this.rebuild_.setAccessType(i.outputOnly),this.min=new o(0,0,0),this.max=new o(0,0,0),this.bbox=new l(this.min,this.max,!0),this.solid=!0,this.geometryType=3,this.flatShading=void 0,this.colorMaterial=!1,this.attribNodes=[],this.attribs=[],this.currentTexCoordNode=this.getBrowser().getDefaultTextureCoordinate(),this.texCoordParams={min:new o(0,0,0)},this.multiTexCoords=[],this.texCoords=p.createArray(),this.colors=p.createArray(),this.normals=p.createArray(),this.flatNormals=p.createArray(),this.vertices=p.createArray(),this.vertexCount=0,this.depth=Function.prototype,this.display=Function.prototype,this.displayParticles=Function.prototype}const f=new o(0,0,0),g=new o(0,0,0),m=new h,_=new h,C=[new o(0,0,1),new o(0,0,-1),new o(0,1,0),new o(0,-1,0),new o(1,0,0)];return p.createArray=function(){var t=[];return t.typedArray=new Float32Array,t.assign=function(t){this.length=0,Array.prototype.push.apply(this,t)},t.getValue=function(){return this.typedArray},t.shrinkToFit=function(){this.length!==this.typedArray.length?this.typedArray=new Float32Array(this):this.typedArray.set(this)},t},p.prototype=Object.assign(Object.create(e.prototype),{constructor:p,intersection:new o(0,0,0),uvt:{u:0,v:0,t:0},v0:new o(0,0,0),v1:new o(0,0,0),v2:new o(0,0,0),normal:new o(0,0,0),setup:function(){e.prototype.setup.call(this),this.addInterest("requestRebuild",this),this.rebuild_.addInterest("rebuild",this),this.rebuild()},initialize:function(){e.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this);var t=this.getBrowser().getContext();if(this.primitiveMode=t.TRIANGLES,this.frontFace=t.CCW,this.attribBuffers=[],this.texCoordBuffers=[],this.colorBuffer=t.createBuffer(),this.normalBuffer=t.createBuffer(),this.vertexBuffer=t.createBuffer(),this.planes=[],this.geometryType>1)for(var i=0;i<5;++i)this.planes[i]=new d(o.Zero,C[0]);this.set_live__()},setGeometryType:function(t){this.geometryType=t},getGeometryType:function(){return this.geometryType},getBBox:function(){return this.bbox},setBBox:function(t){if(!t.equals(this.bbox)){t.getExtents(this.min,this.max),this.bbox.assign(t);for(var e=0;e<5;++e)this.planes[e].set(e%2?this.min:this.max,C[e]);this.bbox_changed_.addEvent()}},getMin:function(){return this.min},getMax:function(){return this.max},getMatrix:function(){return h.Identity},setPrimitiveMode:function(t){this.primitiveMode=t},getPrimitiveMode:function(){return this.primitiveMode},setSolid:function(t){this.solid=t},setCCW:function(t){this.frontFace=t?this.getBrowser().getContext().CCW:this.getBrowser().getContext().CW},getAttrib:function(){return this.attribNodes},getAttribs:function(){return this.attribs},setColors:function(t){this.colors.assign(t)},getColors:function(){return this.colors},setMultiTexCoords:function(t){var e=this.multiTexCoords;e.length=0,Array.prototype.push.apply(e,t)},getMultiTexCoords:function(){return this.multiTexCoords},getTexCoords:function(){return this.texCoords},setCurrentTexCoord:function(t){this.currentTexCoordNode=t||this.getBrowser().getDefaultTextureCoordinate()},setNormals:function(t){this.normals.assign(t)},getNormals:function(){return this.normals},setVertices:function(t){this.vertices.assign(t)},getVertices:function(){return this.vertices},buildTexCoords:function(){for(var t=this.getTexCoordParams(),e=t.min,i=t.Sindex,r=t.Tindex,n=t.Ssize,s=e[i],o=e[r],a=this.texCoords,h=this.vertices.getValue(),l=0,d=h.length;l<d;l+=4)a.push((h[l+i]-s)/n,(h[l+r]-o)/n,0,1);this.multiTexCoords.push(a)},getTexCoordParams:function(){var t=this.texCoordParams,e=this.getBBox(),i=e.size,r=i.x,n=i.y,s=i.z;return t.min.assign(e.center).subtract(i.divide(2)),r>=n&&r>=s?(t.Ssize=r,t.Sindex=0,t.Tindex=n>=s?1:2):n>=r&&n>=s?(t.Ssize=n,t.Sindex=1,t.Tindex=r>=s?0:2):(t.Ssize=s,t.Sindex=2,t.Tindex=r>=n?0:1),t},refineNormals:function(t,e,i){if(0===i)return e;var r=Math.cos(u.clamp(i,0,Math.PI)),n=[];for(var s in t)for(var a=t[s],h=0,l=a.length;h<l;++h){for(var d=a[h],c=e[d],p=new o(0,0,0),f=0;f<l;++f){var g=e[a[f]];g.dot(c)>=r&&p.add(g)}n[d]=p.normalize()}return n},isClipped:function(t,e){return e.some(function(e){return e.isClipped(t)})},transformLine:function(t){},transformMatrix:function(t){},intersectsLine:function(t,e,i,r){try{var n=!1;if(this.intersectsBBox(t)){this.transformLine(t),this.transformMatrix(m.assign(i));for(var a=this.multiTexCoords[0].getValue(),h=this.normals.getValue(),l=this.vertices.getValue(),d=this.uvt,c=this.v0,u=this.v1,p=this.v2,f=0,_=this.vertexCount;f<_;f+=3){var C=4*f;if(c.x=l[C],c.y=l[C+1],c.z=l[C+2],u.x=l[C+4],u.y=l[C+5],u.z=l[C+6],p.x=l[C+8],p.y=l[C+9],p.z=l[C+10],t.intersectsTriangle(c,u,p,d)){var x=d.u,y=d.v,b=d.t,v=new o(b*l[C]+x*l[C+4]+y*l[C+8],b*l[C+1]+x*l[C+5]+y*l[C+9],b*l[C+2]+x*l[C+6]+y*l[C+10]);if(this.isClipped(m.multVecMatrix(g.assign(v)),e))continue;var N=new s(b*a[C]+x*a[C+4]+y*a[C+8],b*a[C+1]+x*a[C+5]+y*a[C+9]),w=3*f,F=new o(b*h[w]+x*h[w+3]+y*h[w+6],b*h[w+1]+x*h[w+4]+y*h[w+7],b*h[w+2]+x*h[w+5]+y*h[w+8]);r.push({texCoord:N,normal:F,point:this.getMatrix().multVecMatrix(v)}),n=!0}}}return n}catch(t){return console.log(t),!1}},intersectsBBox:function(t){var e=this.planes,i=this.min,r=this.max,n=i.x,s=r.x,o=i.y,a=r.y,h=i.z,l=r.z,d=this.intersection;return!!(e[0].intersectsLine(t,d)&&d.x>=n&&d.x<=s&&d.y>=o&&d.y<=a)||(!!(e[1].intersectsLine(t,d)&&d.x>=n&&d.x<=s&&d.y>=o&&d.y<=a)||(!!(e[2].intersectsLine(t,d)&&d.x>=n&&d.x<=s&&d.z>=h&&d.z<=l)||(!!(e[3].intersectsLine(t,d)&&d.x>=n&&d.x<=s&&d.z>=h&&d.z<=l)||!!(e[4].intersectsLine(t,d)&&d.y>=o&&d.y<=a&&d.z>=h&&d.z<=l))))},intersectsBox:function(t,e,i){try{if(t.intersectsBox(this.bbox)){t.multRight(_.assign(this.getMatrix()).inverse()),this.transformMatrix(i);for(var r=this.vertices.getValue(),n=this.v0,s=this.v1,o=this.v2,a=0,h=this.vertexCount;a<h;a+=3){var l=4*a;if(n.x=r[l],n.y=r[l+1],n.z=r[l+2],s.x=r[l+4],s.y=r[l+5],s.z=r[l+6],o.x=r[l+8],o.y=r[l+9],o.z=r[l+10],t.intersectsTriangle(n,s,o)){if(e.length){if(this.isClipped(i.multVecMatrix(g.assign(n)),e))continue;if(this.isClipped(i.multVecMatrix(g.assign(s)),e))continue;if(this.isClipped(i.multVecMatrix(g.assign(o)),e))continue}return!0}}}return!1}catch(t){return console.log(t),!1}},set_live__:function(){this.isLive().getValue()?this.getBrowser().getBrowserOptions().Shading_.addInterest("set_shading__",this):this.getBrowser().getBrowserOptions().Shading_.removeInterest("set_shading__",this)},set_shading__:function(t){if(!(this.geometryType<2)){var e=this.getBrowser().getBrowserOptions().getShading()===r.FLAT;if(e!==this.flatShading){this.flatShading=e;var i=this.getBrowser().getContext();if(e&&!this.flatNormals.length){for(var n=this.frontFace===i.CW,s=this.flatNormals,o=this.vertices.getValue(),a=this.v0,h=this.v1,l=this.v2,d=this.normal,u=0,p=o.length;u<p;u+=12)c.normal(a.set(o[u],o[u+1],o[u+2]),h.set(o[u+4],o[u+5],o[u+6]),l.set(o[u+8],o[u+9],o[u+10]),d),n&&d.negate(),s.push(d.x,d.y,d.z,d.x,d.y,d.z,d.x,d.y,d.z);s.shrinkToFit()}i.bindBuffer(i.ARRAY_BUFFER,this.normalBuffer),i.bufferData(i.ARRAY_BUFFER,e?this.flatNormals.getValue():this.normals.getValue(),i.STATIC_DRAW)}}},requestRebuild:function(){this.rebuild_.addEvent()},rebuild:function(){this.clear(),this.build();for(var t=0,e=this.attribs.length;t<e;++t)this.attribs[t].shrinkToFit();for(var t=0,e=this.multiTexCoords.length;t<e;++t)this.multiTexCoords[t].shrinkToFit();this.colors.shrinkToFit(),this.normals.shrinkToFit(),this.vertices.shrinkToFit();var i=this.min,r=this.max,n=this.vertices.getValue();if(n.length){if(i.x===Number.POSITIVE_INFINITY)for(var t=0,e=n.length;t<e;t+=4)f.set(n[t],n[t+1],n[t+2]),i.min(f),r.max(f);this.bbox.setExtents(i,r)}else this.bbox.setExtents(i.set(0,0,0),r.set(0,0,0));if(this.bbox_changed_.addEvent(),this.geometryType>1){for(var t=0;t<5;++t)this.planes[t].set(t%2?i:r,C[t]);0===this.multiTexCoords.length&&(this.buildTexCoords(),this.texCoords.shrinkToFit())}this.set_shading__(this.getBrowser().getBrowserOptions().Shading_),this.transfer()},clear:function(){this.min.set(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),this.max.set(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(var t=this.attribs,e=0,i=t.length;e<i;++e)t[e].length=0;for(var e=t.length,i=this.attribNodes.length;e<i;++e)t[e]=p.createArray();t.length=i,this.flatShading=void 0,this.colors.length=0,this.multiTexCoords.length=0,this.texCoords.length=0,this.normals.length=0,this.flatNormals.length=0,this.vertices.length=0},transfer:function(){for(var t=this.getBrowser().getContext(),e=this.vertices.length/4,i=this.attribBuffers.length,r=this.attribs.length;i<r;++i)this.attribBuffers.push(t.createBuffer());for(var i=0,r=this.attribs.length;i<r;++i)t.bindBuffer(t.ARRAY_BUFFER,this.attribBuffers[i]),t.bufferData(t.ARRAY_BUFFER,this.attribs[i].getValue(),t.STATIC_DRAW);for(var i=this.texCoordBuffers.length,r=this.multiTexCoords.length;i<r;++i)this.texCoordBuffers.push(t.createBuffer());for(var i=0,r=this.multiTexCoords.length;i<r;++i)t.bindBuffer(t.ARRAY_BUFFER,this.texCoordBuffers[i]),t.bufferData(t.ARRAY_BUFFER,this.multiTexCoords[i].getValue(),t.STATIC_DRAW);t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,this.colors.getValue(),t.STATIC_DRAW),this.colorMaterial=Boolean(this.colors.length),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices.getValue(),t.STATIC_DRAW),this.vertexCount=e,this.vertexCount?(delete this.depth,delete this.display,delete this.displayParticles):(this.depth=Function.prototype,this.display=Function.prototype,this.displayParticles=Function.prototype)},traverse:function(t,e){},depth:function(t,e,i){i.enableVertexAttribute(t,this.vertexBuffer),t.drawArrays(this.primitiveMode,0,this.vertexCount)},display:function(t,e){try{var i=e.shaderNode,r=this.attribNodes,n=this.attribBuffers;e.geometryType=this.geometryType,e.colorMaterial=this.colorMaterial,i.enable(t),i.setLocalUniforms(t,e);for(var s=0,o=r.length;s<o;++s)r[s].enable(t,i,n[s]);if(this.colorMaterial&&i.enableColorAttribute(t,this.colorBuffer),i.enableTexCoordAttribute(t,this.texCoordBuffers),i.enableNormalAttribute(t,this.normalBuffer),i.enableVertexAttribute(t,this.vertexBuffer),i.wireframe)for(var s=0,o=this.vertexCount;s<o;s+=3)t.drawArrays(i.primitiveMode,s,3);else{var a=h.prototype.determinant3.call(e.modelViewMatrix)>0;t.frontFace(a?this.frontFace:this.frontFace===t.CCW?t.CW:t.CCW),e.transparent&&!this.solid?(t.enable(t.CULL_FACE),t.cullFace(t.FRONT),t.drawArrays(i.primitiveMode,0,this.vertexCount),t.cullFace(t.BACK),t.drawArrays(i.primitiveMode,0,this.vertexCount)):(this.solid?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),t.drawArrays(i.primitiveMode,0,this.vertexCount))}for(var s=0,o=r.length;s<o;++s)r[s].disable(t,i);i.disableColorAttribute(t),i.disableTexCoordAttribute(t),i.disableNormalAttribute(t),i.disable(t)}catch(t){console.log(t)}},displayParticlesDepth:function(t,e,i,r,n){var t=e.renderer.getBrowser().getContext();i.enableVertexAttribute(t,this.vertexBuffer);for(var s=e.modelViewMatrix,o=s[12],a=s[13],l=s[14],d=0;d<n;++d){var c=r[d];s[12]=o,s[13]=a,s[14]=l,h.prototype.translate.call(s,c.position),i.setParticle(t,d,c,s,!1),t.drawArrays(i.primitiveMode,0,this.vertexCount)}},displayParticles:function(t,e,i,r){try{var n=e.shaderNode,s=this.attribNodes,o=this.attribBuffers;e.geometryType=this.geometryType,e.colorMaterial=this.colorMaterial,n.enable(t),n.setLocalUniforms(t,e);for(var a=0,l=s.length;a<l;++a)s[a].enable(t,n,o[a]);this.colorMaterial&&n.enableColorAttribute(t,this.colorBuffer),n.enableTexCoordAttribute(t,this.texCoordBuffers),n.enableNormalAttribute(t,this.normalBuffer),n.enableVertexAttribute(t,this.vertexBuffer);var d=e.materialNode,c=d||n.getCustom(),u=e.modelViewMatrix,p=u[12],f=u[13],g=u[14];if(n.wireframe)for(var m=0;m<r;++m){var _=i[m];u[12]=p,u[13]=f,u[14]=g,h.prototype.translate.call(u,_.position),n.setParticle(t,m,_,u,c);for(var a=0,l=this.vertexCount;a<l;a+=3)t.drawArrays(n.primitiveMode,a,3)}else{var C=h.prototype.determinant3.call(e.modelViewMatrix)>0;if(t.frontFace(C?this.frontFace:this.frontFace===t.CCW?t.CW:t.CCW),e.transparent&&!this.solid)for(var m=0;m<r;++m){var _=i[m];u[12]=p,u[13]=f,u[14]=g,h.prototype.translate.call(u,_.position),n.setParticle(t,m,_,u,c),t.enable(t.CULL_FACE),t.cullFace(t.FRONT),t.drawArrays(n.primitiveMode,0,this.vertexCount),t.cullFace(t.BACK),t.drawArrays(n.primitiveMode,0,this.vertexCount)}else{this.solid?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE);for(var m=0;m<r;++m){var _=i[m];u[12]=p,u[13]=f,u[14]=g,h.prototype.translate.call(u,_.position),n.setParticle(t,m,_,u,c),t.drawArrays(n.primitiveMode,0,this.vertexCount)}}}for(var a=0,l=s.length;a<l;++a)s[a].disable(t,n);n.disableColorAttribute(t),n.disableTexCoordAttribute(t),n.disableNormalAttribute(t),n.disable(t)}catch(t){console.log(t)}}}),p}),t("x_ite/Components/Rendering/X3DComposedGeometryNode",["x_ite/Components/Rendering/X3DGeometryNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants","standard/Math/Numbers/Vector3"],function(t,e,i,r){"use strict";function n(e){t.call(this,e),this.addType(i.X3DComposedGeometryNode),this.colorNode=null,this.texCoordNode=null,this.normalNode=null,this.coordNode=null}var s=new r(0,0,0),o=new r(0,0,0);return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,initialize:function(){t.prototype.initialize.call(this),this.attrib_.addInterest("set_attrib__",this),this.color_.addInterest("set_color__",this),this.texCoord_.addInterest("set_texCoord__",this),this.normal_.addInterest("set_normal__",this),this.coord_.addInterest("set_coord__",this),this.set_attrib__(),this.set_color__(),this.set_texCoord__(),this.set_normal__(),this.set_coord__()},getColor:function(){return this.colorNode},getTexCoord:function(){return this.texCoordNode},getNormal:function(){return this.normalNode},getCoord:function(){return this.coordNode},set_attrib__:function(){for(var t=this.getAttrib(),r=0,n=t.length;r<n;++r)t[r].removeInterest("requestRebuild",this);t.length=0;for(var r=0,n=this.attrib_.length;r<n;++r){var s=e(i.X3DVertexAttributeNode,this.attrib_[r]);s&&t.push(s)}for(var r=0;r<this.attribNodes.length;++r)t[r].addInterest("requestRebuild",this)},set_color__:function(){this.colorNode&&(this.colorNode.removeInterest("requestRebuild",this),this.colorNode.removeInterest("set_transparent__",this)),this.colorNode=e(i.X3DColorNode,this.color_),this.colorNode?(this.colorNode.addInterest("requestRebuild",this),this.colorNode.addInterest("set_transparent__",this),this.set_transparent__()):this.transparent_=!1},set_transparent__:function(){this.transparent_=this.colorNode.isTransparent()},set_texCoord__:function(){this.texCoordNode&&this.texCoordNode.removeInterest("requestRebuild",this),this.texCoordNode=e(i.X3DTextureCoordinateNode,this.texCoord_),this.texCoordNode&&this.texCoordNode.addInterest("requestRebuild",this),this.setCurrentTexCoord(this.texCoordNode)},set_normal__:function(){this.normalNode&&this.normalNode.removeInterest("requestRebuild",this),this.normalNode=e(i.X3DNormalNode,this.normal_),this.normalNode&&this.normalNode.addInterest("requestRebuild",this)},set_coord__:function(){
this.coordNode&&this.coordNode.removeInterest("requestRebuild",this),this.coordNode=e(i.X3DCoordinateNode,this.coord_),this.coordNode&&this.coordNode.addInterest("requestRebuild",this)},getPolygonIndex:function(t){return t},getTriangleIndex:function(t){return t},build:function(t,e,i,r){if(this.coordNode&&!this.coordNode.isEmpty()){e-=e%t,r-=r%i;var n=this.colorPerVertex_.getValue(),s=this.normalPerVertex_.getValue(),o=this.getAttrib(),a=o.length,h=this.getAttribs(),l=this.getColor(),d=this.getTexCoord(),c=this.getNormal(),u=this.getCoord(),p=this.getColors(),f=this.getMultiTexCoords(),g=this.getNormals(),m=this.getVertices(),_=0;d&&d.init(f);for(var C=0;C<r;++C){_=Math.floor(C/i);for(var x=this.getPolygonIndex(this.getTriangleIndex(C)),y=0;y<a;++y)o[y].addValue(x,h[y]);l&&(n?l.addColor(x,p):l.addColor(_,p)),d&&d.addTexCoord(x,f),c&&(s?c.addVector(x,g):c.addVector(_,g)),u.addPoint(x,m)}this.getNormal()||this.buildNormals(t,e,r),this.setSolid(this.solid_.getValue()),this.setCCW(this.ccw_.getValue())}},buildNormals:function(t,e,i){for(var r=this.createNormals(t,e),n=this.getNormals(),s=0;s<i;++s){var o=r[this.getTriangleIndex(s)];n.push(o.x,o.y,o.z)}},createNormals:function(t,e){var i=this.createFaceNormals(t,e);if(this.normalPerVertex_.getValue()){for(var r=[],n=0;n<e;++n){var s=this.getPolygonIndex(n);r[s]||(r[s]=[]),r[s].push(n)}return this.refineNormals(r,i,Math.PI)}return i},createFaceNormals:function(t,e){for(var i=!this.ccw_.getValue(),r=this.coordNode,n=[],s=0;s<e;s+=t){var o=this.getPolygonNormal(s,t,r);i&&o.negate();for(var a=0;a<t;++a)n.push(o)}return n},getPolygonNormal:function(t,e,i){var n=new r(0,0,0);i.get1Point(this.getPolygonIndex(t),o);for(var a=0;a<e;++a){var h=s;s=o,o=h,i.get1Point(this.getPolygonIndex(t+(a+1)%e),o),n.x+=(s.y-o.y)*(s.z+o.z),n.y+=(s.z-o.z)*(s.x+o.x),n.z+=(s.x-o.x)*(s.y+o.y)}return n.normalize()}}),n}),t("x_ite/Components/CADGeometry/IndexedQuadSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Bits/X3DConstants"],function(t,e,i,r,n){"use strict";function s(t){r.call(this,t),this.addType(n.IndexedQuadSet)}var o=[0,1,2,0,2,3];return s.prototype=Object.assign(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new e(n.inputOutput,"metadata",new t.SFNode),new e(n.initializeOnly,"solid",new t.SFBool(!0)),new e(n.initializeOnly,"ccw",new t.SFBool(!0)),new e(n.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new e(n.initializeOnly,"normalPerVertex",new t.SFBool(!0)),new e(n.inputOutput,"index",new t.MFInt32),new e(n.inputOutput,"attrib",new t.MFNode),new e(n.inputOutput,"fogCoord",new t.SFNode),new e(n.inputOutput,"color",new t.SFNode),new e(n.inputOutput,"texCoord",new t.SFNode),new e(n.inputOutput,"normal",new t.SFNode),new e(n.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"IndexedQuadSet"},getComponentName:function(){return"CADGeometry"},getContainerField:function(){return"geometry"},getTriangleIndex:function(t){var e=t%6;return(t-e)/6*4+o[e]},getPolygonIndex:function(t){return this.index_[t]},build:function(){var t=this.index_.length;t-=t%4,r.prototype.build.call(this,4,t,6,t/4*6)}}),s}),t("x_ite/Components/CADGeometry/QuadSet",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Bits/X3DConstants"],function(t,e,i,r,n){"use strict";function s(t){r.call(this,t),this.addType(n.QuadSet)}var o=[0,1,2,0,2,3];return s.prototype=Object.assign(Object.create(r.prototype),{constructor:s,fieldDefinitions:new i([new e(n.inputOutput,"metadata",new t.SFNode),new e(n.initializeOnly,"solid",new t.SFBool(!0)),new e(n.initializeOnly,"ccw",new t.SFBool(!0)),new e(n.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new e(n.initializeOnly,"normalPerVertex",new t.SFBool(!0)),new e(n.inputOutput,"attrib",new t.MFNode),new e(n.inputOutput,"fogCoord",new t.SFNode),new e(n.inputOutput,"color",new t.SFNode),new e(n.inputOutput,"texCoord",new t.SFNode),new e(n.inputOutput,"normal",new t.SFNode),new e(n.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"QuadSet"},getComponentName:function(){return"CADGeometry"},getContainerField:function(){return"geometry"},getTriangleIndex:function(t){var e=t%6;return(t-e)/6*4+o[e]},build:function(){if(this.getCoord()){var t=this.getCoord().getSize();t-=t%4,r.prototype.build.call(this,4,t,6,t/4*6)}},createNormals:function(t,e){return this.createFaceNormals(t,e)}}),s}),e(["x_ite/Configuration/SupportedNodes","x_ite/Components/CADGeometry/CADAssembly","x_ite/Components/CADGeometry/CADFace","x_ite/Components/CADGeometry/CADLayer","x_ite/Components/CADGeometry/CADPart","x_ite/Components/CADGeometry/IndexedQuadSet","x_ite/Components/CADGeometry/QuadSet","x_ite/Components/CADGeometry/X3DProductStructureChildNode"],function(t,e,i,r,n,s,o,a){"use strict";var h={CADAssembly:e,CADFace:i,CADLayer:r,CADPart:n,IndexedQuadSet:s,QuadSet:o},l={X3DProductStructureChildNode:a};for(var d in h)t.addType(d,h[d]);for(var d in l)t.addAbstractType(d,l[d]);return h}),t("components/cad-geometry",function(){})}();
